const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-CrUiACa7.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/lz4-B_Exjfmr.js","assets/zstd-u5eweWyS.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();function v2(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var sm={exports:{}},qu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y5;function r8(){if(y5)return qu;y5=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,s){var o=null;if(s!==void 0&&(o=""+s),a.key!==void 0&&(o=""+a.key),"key"in a){s={};for(var l in a)l!=="key"&&(s[l]=a[l])}else s=a;return a=s.ref,{$$typeof:r,type:i,key:o,ref:a!==void 0?a:null,props:s}}return qu.Fragment=e,qu.jsx=n,qu.jsxs=n,qu}var A5;function n8(){return A5||(A5=1,sm.exports=r8()),sm.exports}var J=n8(),om={exports:{}},lt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x5;function i8(){if(x5)return lt;x5=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),v=Symbol.iterator;function m(G){return G===null||typeof G!="object"?null:(G=v&&G[v]||G["@@iterator"],typeof G=="function"?G:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,x={};function A(G,K,$){this.props=G,this.context=K,this.refs=x,this.updater=$||y}A.prototype.isReactComponent={},A.prototype.setState=function(G,K){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,K,"setState")},A.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function C(){}C.prototype=A.prototype;function E(G,K,$){this.props=G,this.context=K,this.refs=x,this.updater=$||y}var S=E.prototype=new C;S.constructor=E,b(S,A.prototype),S.isPureReactComponent=!0;var M=Array.isArray;function R(){}var T={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function F(G,K,$){var te=$.ref;return{$$typeof:r,type:G,key:K,ref:te!==void 0?te:null,props:$}}function I(G,K){return F(G.type,K,G.props)}function U(G){return typeof G=="object"&&G!==null&&G.$$typeof===r}function k(G){var K={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function($){return K[$]})}var O=/\/+/g;function V(G,K){return typeof G=="object"&&G!==null&&G.key!=null?k(""+G.key):K.toString(36)}function L(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(R,R):(G.status="pending",G.then(function(K){G.status==="pending"&&(G.status="fulfilled",G.value=K)},function(K){G.status==="pending"&&(G.status="rejected",G.reason=K)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function P(G,K,$,te,ae){var ue=typeof G;(ue==="undefined"||ue==="boolean")&&(G=null);var re=!1;if(G===null)re=!0;else switch(ue){case"bigint":case"string":case"number":re=!0;break;case"object":switch(G.$$typeof){case r:case e:re=!0;break;case h:return re=G._init,P(re(G._payload),K,$,te,ae)}}if(re)return ae=ae(G),re=te===""?"."+V(G,0):te,M(ae)?($="",re!=null&&($=re.replace(O,"$&/")+"/"),P(ae,K,$,"",function(ie){return ie})):ae!=null&&(U(ae)&&(ae=I(ae,$+(ae.key==null||G&&G.key===ae.key?"":(""+ae.key).replace(O,"$&/")+"/")+re)),K.push(ae)),1;re=0;var ve=te===""?".":te+":";if(M(G))for(var le=0;le<G.length;le++)te=G[le],ue=ve+V(te,le),re+=P(te,K,$,ue,ae);else if(le=m(G),typeof le=="function")for(G=le.call(G),le=0;!(te=G.next()).done;)te=te.value,ue=ve+V(te,le++),re+=P(te,K,$,ue,ae);else if(ue==="object"){if(typeof G.then=="function")return P(L(G),K,$,te,ae);throw K=String(G),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return re}function _(G,K,$){if(G==null)return G;var te=[],ae=0;return P(G,te,"","",function(ue){return K.call($,ue,ae++)}),te}function q(G){if(G._status===-1){var K=G._result;K=K(),K.then(function($){(G._status===0||G._status===-1)&&(G._status=1,G._result=$)},function($){(G._status===0||G._status===-1)&&(G._status=2,G._result=$)}),G._status===-1&&(G._status=0,G._result=K)}if(G._status===1)return G._result.default;throw G._result}var H=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},W={map:_,forEach:function(G,K,$){_(G,function(){K.apply(this,arguments)},$)},count:function(G){var K=0;return _(G,function(){K++}),K},toArray:function(G){return _(G,function(K){return K})||[]},only:function(G){if(!U(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return lt.Activity=g,lt.Children=W,lt.Component=A,lt.Fragment=n,lt.Profiler=a,lt.PureComponent=E,lt.StrictMode=i,lt.Suspense=c,lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,lt.__COMPILER_RUNTIME={__proto__:null,c:function(G){return T.H.useMemoCache(G)}},lt.cache=function(G){return function(){return G.apply(null,arguments)}},lt.cacheSignal=function(){return null},lt.cloneElement=function(G,K,$){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var te=b({},G.props),ae=G.key;if(K!=null)for(ue in K.key!==void 0&&(ae=""+K.key),K)!B.call(K,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&K.ref===void 0||(te[ue]=K[ue]);var ue=arguments.length-2;if(ue===1)te.children=$;else if(1<ue){for(var re=Array(ue),ve=0;ve<ue;ve++)re[ve]=arguments[ve+2];te.children=re}return F(G.type,ae,te)},lt.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:s,_context:G},G},lt.createElement=function(G,K,$){var te,ae={},ue=null;if(K!=null)for(te in K.key!==void 0&&(ue=""+K.key),K)B.call(K,te)&&te!=="key"&&te!=="__self"&&te!=="__source"&&(ae[te]=K[te]);var re=arguments.length-2;if(re===1)ae.children=$;else if(1<re){for(var ve=Array(re),le=0;le<re;le++)ve[le]=arguments[le+2];ae.children=ve}if(G&&G.defaultProps)for(te in re=G.defaultProps,re)ae[te]===void 0&&(ae[te]=re[te]);return F(G,ue,ae)},lt.createRef=function(){return{current:null}},lt.forwardRef=function(G){return{$$typeof:l,render:G}},lt.isValidElement=U,lt.lazy=function(G){return{$$typeof:h,_payload:{_status:-1,_result:G},_init:q}},lt.memo=function(G,K){return{$$typeof:u,type:G,compare:K===void 0?null:K}},lt.startTransition=function(G){var K=T.T,$={};T.T=$;try{var te=G(),ae=T.S;ae!==null&&ae($,te),typeof te=="object"&&te!==null&&typeof te.then=="function"&&te.then(R,H)}catch(ue){H(ue)}finally{K!==null&&$.types!==null&&(K.types=$.types),T.T=K}},lt.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},lt.use=function(G){return T.H.use(G)},lt.useActionState=function(G,K,$){return T.H.useActionState(G,K,$)},lt.useCallback=function(G,K){return T.H.useCallback(G,K)},lt.useContext=function(G){return T.H.useContext(G)},lt.useDebugValue=function(){},lt.useDeferredValue=function(G,K){return T.H.useDeferredValue(G,K)},lt.useEffect=function(G,K){return T.H.useEffect(G,K)},lt.useEffectEvent=function(G){return T.H.useEffectEvent(G)},lt.useId=function(){return T.H.useId()},lt.useImperativeHandle=function(G,K,$){return T.H.useImperativeHandle(G,K,$)},lt.useInsertionEffect=function(G,K){return T.H.useInsertionEffect(G,K)},lt.useLayoutEffect=function(G,K){return T.H.useLayoutEffect(G,K)},lt.useMemo=function(G,K){return T.H.useMemo(G,K)},lt.useOptimistic=function(G,K){return T.H.useOptimistic(G,K)},lt.useReducer=function(G,K,$){return T.H.useReducer(G,K,$)},lt.useRef=function(G){return T.H.useRef(G)},lt.useState=function(G){return T.H.useState(G)},lt.useSyncExternalStore=function(G,K,$){return T.H.useSyncExternalStore(G,K,$)},lt.useTransition=function(){return T.H.useTransition()},lt.version="19.2.0",lt}var b5;function m2(){return b5||(b5=1,om.exports=i8()),om.exports}var Ne=m2();const bd=v2(Ne);var lm={exports:{}},Yu={},um={exports:{}},cm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w5;function a8(){return w5||(w5=1,(function(r){function e(P,_){var q=P.length;P.push(_);e:for(;0<q;){var H=q-1>>>1,W=P[H];if(0<a(W,_))P[H]=_,P[q]=W,q=H;else break e}}function n(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var _=P[0],q=P.pop();if(q!==_){P[0]=q;e:for(var H=0,W=P.length,G=W>>>1;H<G;){var K=2*(H+1)-1,$=P[K],te=K+1,ae=P[te];if(0>a($,q))te<W&&0>a(ae,$)?(P[H]=ae,P[te]=q,H=te):(P[H]=$,P[K]=q,H=K);else if(te<W&&0>a(ae,q))P[H]=ae,P[te]=q,H=te;else break e}}return _}function a(P,_){var q=P.sortIndex-_.sortIndex;return q!==0?q:P.id-_.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();r.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,g=null,v=3,m=!1,y=!1,b=!1,x=!1,A=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function S(P){for(var _=n(u);_!==null;){if(_.callback===null)i(u);else if(_.startTime<=P)i(u),_.sortIndex=_.expirationTime,e(c,_);else break;_=n(u)}}function M(P){if(b=!1,S(P),!y)if(n(c)!==null)y=!0,R||(R=!0,k());else{var _=n(u);_!==null&&L(M,_.startTime-P)}}var R=!1,T=-1,B=5,F=-1;function I(){return x?!0:!(r.unstable_now()-F<B)}function U(){if(x=!1,R){var P=r.unstable_now();F=P;var _=!0;try{e:{y=!1,b&&(b=!1,C(T),T=-1),m=!0;var q=v;try{t:{for(S(P),g=n(c);g!==null&&!(g.expirationTime>P&&I());){var H=g.callback;if(typeof H=="function"){g.callback=null,v=g.priorityLevel;var W=H(g.expirationTime<=P);if(P=r.unstable_now(),typeof W=="function"){g.callback=W,S(P),_=!0;break t}g===n(c)&&i(c),S(P)}else i(c);g=n(c)}if(g!==null)_=!0;else{var G=n(u);G!==null&&L(M,G.startTime-P),_=!1}}break e}finally{g=null,v=q,m=!1}_=void 0}}finally{_?k():R=!1}}}var k;if(typeof E=="function")k=function(){E(U)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,V=O.port2;O.port1.onmessage=U,k=function(){V.postMessage(null)}}else k=function(){A(U,0)};function L(P,_){T=A(function(){P(r.unstable_now())},_)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(P){P.callback=null},r.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<P?Math.floor(1e3/P):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_next=function(P){switch(v){case 1:case 2:case 3:var _=3;break;default:_=v}var q=v;v=_;try{return P()}finally{v=q}},r.unstable_requestPaint=function(){x=!0},r.unstable_runWithPriority=function(P,_){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var q=v;v=P;try{return _()}finally{v=q}},r.unstable_scheduleCallback=function(P,_,q){var H=r.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?H+q:H):q=H,P){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=q+W,P={id:h++,callback:_,priorityLevel:P,startTime:q,expirationTime:W,sortIndex:-1},q>H?(P.sortIndex=q,e(u,P),n(c)===null&&P===n(u)&&(b?(C(T),T=-1):b=!0,L(M,q-H))):(P.sortIndex=W,e(c,P),y||m||(y=!0,R||(R=!0,k()))),P},r.unstable_shouldYield=I,r.unstable_wrapCallback=function(P){var _=v;return function(){var q=v;v=_;try{return P.apply(this,arguments)}finally{v=q}}}})(cm)),cm}var C5;function s8(){return C5||(C5=1,um.exports=a8()),um.exports}var fm={exports:{}},hn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E5;function o8(){if(E5)return hn;E5=1;var r=m2();function e(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(c,u,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:c,containerInfo:u,implementation:h}}var o=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return hn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,hn.createPortal=function(c,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return s(c,u,null,h)},hn.flushSync=function(c){var u=o.T,h=i.p;try{if(o.T=null,i.p=2,c)return c()}finally{o.T=u,i.p=h,i.d.f()}},hn.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,i.d.C(c,u))},hn.prefetchDNS=function(c){typeof c=="string"&&i.d.D(c)},hn.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var h=u.as,g=l(h,u.crossOrigin),v=typeof u.integrity=="string"?u.integrity:void 0,m=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?i.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:m}):h==="script"&&i.d.X(c,{crossOrigin:g,integrity:v,fetchPriority:m,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},hn.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=l(u.as,u.crossOrigin);i.d.M(c,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&i.d.M(c)},hn.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,g=l(h,u.crossOrigin);i.d.L(c,h,{crossOrigin:g,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},hn.preloadModule=function(c,u){if(typeof c=="string")if(u){var h=l(u.as,u.crossOrigin);i.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else i.d.m(c)},hn.requestFormReset=function(c){i.d.r(c)},hn.unstable_batchedUpdates=function(c,u){return c(u)},hn.useFormState=function(c,u,h){return o.H.useFormState(c,u,h)},hn.useFormStatus=function(){return o.H.useHostTransitionStatus()},hn.version="19.2.0",hn}var S5;function l8(){if(S5)return fm.exports;S5=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),fm.exports=o8(),fm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T5;function u8(){if(T5)return Yu;T5=1;var r=s8(),e=m2(),n=l8();function i(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function s(f){var d=f,p=f;if(f.alternate)for(;d.return;)d=d.return;else{f=d;do d=f,(d.flags&4098)!==0&&(p=d.return),f=d.return;while(f)}return d.tag===3?p:null}function o(f){if(f.tag===13){var d=f.memoizedState;if(d===null&&(f=f.alternate,f!==null&&(d=f.memoizedState)),d!==null)return d.dehydrated}return null}function l(f){if(f.tag===31){var d=f.memoizedState;if(d===null&&(f=f.alternate,f!==null&&(d=f.memoizedState)),d!==null)return d.dehydrated}return null}function c(f){if(s(f)!==f)throw Error(i(188))}function u(f){var d=f.alternate;if(!d){if(d=s(f),d===null)throw Error(i(188));return d!==f?null:f}for(var p=f,w=d;;){var D=p.return;if(D===null)break;var N=D.alternate;if(N===null){if(w=D.return,w!==null){p=w;continue}break}if(D.child===N.child){for(N=D.child;N;){if(N===p)return c(D),f;if(N===w)return c(D),d;N=N.sibling}throw Error(i(188))}if(p.return!==w.return)p=D,w=N;else{for(var z=!1,Y=D.child;Y;){if(Y===p){z=!0,p=D,w=N;break}if(Y===w){z=!0,w=D,p=N;break}Y=Y.sibling}if(!z){for(Y=N.child;Y;){if(Y===p){z=!0,p=N,w=D;break}if(Y===w){z=!0,w=N,p=D;break}Y=Y.sibling}if(!z)throw Error(i(189))}}if(p.alternate!==w)throw Error(i(190))}if(p.tag!==3)throw Error(i(188));return p.stateNode.current===p?f:d}function h(f){var d=f.tag;if(d===5||d===26||d===27||d===6)return f;for(f=f.child;f!==null;){if(d=h(f),d!==null)return d;f=f.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),E=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function k(f){return f===null||typeof f!="object"?null:(f=U&&f[U]||f["@@iterator"],typeof f=="function"?f:null)}var O=Symbol.for("react.client.reference");function V(f){if(f==null)return null;if(typeof f=="function")return f.$$typeof===O?null:f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case b:return"Fragment";case A:return"Profiler";case x:return"StrictMode";case M:return"Suspense";case R:return"SuspenseList";case F:return"Activity"}if(typeof f=="object")switch(f.$$typeof){case y:return"Portal";case E:return f.displayName||"Context";case C:return(f._context.displayName||"Context")+".Consumer";case S:var d=f.render;return f=f.displayName,f||(f=d.displayName||d.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case T:return d=f.displayName||null,d!==null?d:V(f.type)||"Memo";case B:d=f._payload,f=f._init;try{return V(f(d))}catch{}}return null}var L=Array.isArray,P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q={pending:!1,data:null,method:null,action:null},H=[],W=-1;function G(f){return{current:f}}function K(f){0>W||(f.current=H[W],H[W]=null,W--)}function $(f,d){W++,H[W]=f.current,f.current=d}var te=G(null),ae=G(null),ue=G(null),re=G(null);function ve(f,d){switch($(ue,d),$(ae,f),$(te,null),d.nodeType){case 9:case 11:f=(f=d.documentElement)&&(f=f.namespaceURI)?zb(f):0;break;default:if(f=d.tagName,d=d.namespaceURI)d=zb(d),f=Gb(d,f);else switch(f){case"svg":f=1;break;case"math":f=2;break;default:f=0}}K(te),$(te,f)}function le(){K(te),K(ae),K(ue)}function ie(f){f.memoizedState!==null&&$(re,f);var d=te.current,p=Gb(d,f.type);d!==p&&($(ae,f),$(te,p))}function se(f){ae.current===f&&(K(te),K(ae)),re.current===f&&(K(re),Lu._currentValue=q)}var fe,xe;function De(f){if(fe===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);fe=d&&d[1]||"",xe=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+fe+f+xe}var ze=!1;function gt(f,d){if(!f||ze)return"";ze=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(d){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(ye){var ge=ye}Reflect.construct(f,[],Ee)}else{try{Ee.call()}catch(ye){ge=ye}f.call(Ee.prototype)}}else{try{throw Error()}catch(ye){ge=ye}(Ee=f())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(ye){if(ye&&ge&&typeof ye.stack=="string")return[ye.stack,ge.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=w.DetermineComponentFrameRoot(),z=N[0],Y=N[1];if(z&&Y){var ee=z.split(`
`),de=Y.split(`
`);for(D=w=0;w<ee.length&&!ee[w].includes("DetermineComponentFrameRoot");)w++;for(;D<de.length&&!de[D].includes("DetermineComponentFrameRoot");)D++;if(w===ee.length||D===de.length)for(w=ee.length-1,D=de.length-1;1<=w&&0<=D&&ee[w]!==de[D];)D--;for(;1<=w&&0<=D;w--,D--)if(ee[w]!==de[D]){if(w!==1||D!==1)do if(w--,D--,0>D||ee[w]!==de[D]){var Ae=`
`+ee[w].replace(" at new "," at ");return f.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",f.displayName)),Ae}while(1<=w&&0<=D);break}}}finally{ze=!1,Error.prepareStackTrace=p}return(p=f?f.displayName||f.name:"")?De(p):""}function it(f,d){switch(f.tag){case 26:case 27:case 5:return De(f.type);case 16:return De("Lazy");case 13:return f.child!==d&&d!==null?De("Suspense Fallback"):De("Suspense");case 19:return De("SuspenseList");case 0:case 15:return gt(f.type,!1);case 11:return gt(f.type.render,!1);case 1:return gt(f.type,!0);case 31:return De("Activity");default:return""}}function $e(f){try{var d="",p=null;do d+=it(f,p),p=f,f=f.return;while(f);return d}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}var Xe=Object.prototype.hasOwnProperty,Ie=r.unstable_scheduleCallback,Ye=r.unstable_cancelCallback,Ke=r.unstable_shouldYield,at=r.unstable_requestPaint,ke=r.unstable_now,ft=r.unstable_getCurrentPriorityLevel,pt=r.unstable_ImmediatePriority,Tt=r.unstable_UserBlockingPriority,Et=r.unstable_NormalPriority,Rt=r.unstable_LowPriority,nt=r.unstable_IdlePriority,Oe=r.log,be=r.unstable_setDisableYieldValue,X=null,ce=null;function pe(f){if(typeof Oe=="function"&&be(f),ce&&typeof ce.setStrictMode=="function")try{ce.setStrictMode(X,f)}catch{}}var me=Math.clz32?Math.clz32:Se,we=Math.log,Ve=Math.LN2;function Se(f){return f>>>=0,f===0?32:31-(we(f)/Ve|0)|0}var Ge=256,Ue=262144,Qe=4194304;function st(f){var d=f&42;if(d!==0)return d;switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return f&261888;case 262144:case 524288:case 1048576:case 2097152:return f&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return f&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return f}}function ot(f,d,p){var w=f.pendingLanes;if(w===0)return 0;var D=0,N=f.suspendedLanes,z=f.pingedLanes;f=f.warmLanes;var Y=w&134217727;return Y!==0?(w=Y&~N,w!==0?D=st(w):(z&=Y,z!==0?D=st(z):p||(p=Y&~f,p!==0&&(D=st(p))))):(Y=w&~N,Y!==0?D=st(Y):z!==0?D=st(z):p||(p=w&~f,p!==0&&(D=st(p)))),D===0?0:d!==0&&d!==D&&(d&N)===0&&(N=D&-D,p=d&-d,N>=p||N===32&&(p&4194048)!==0)?d:D}function Le(f,d){return(f.pendingLanes&~(f.suspendedLanes&~f.pingedLanes)&d)===0}function vt(f,d){switch(f){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ht(){var f=Qe;return Qe<<=1,(Qe&62914560)===0&&(Qe=4194304),f}function fr(f){for(var d=[],p=0;31>p;p++)d.push(f);return d}function zt(f,d){f.pendingLanes|=d,d!==268435456&&(f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0)}function Jr(f,d,p,w,D,N){var z=f.pendingLanes;f.pendingLanes=p,f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0,f.expiredLanes&=p,f.entangledLanes&=p,f.errorRecoveryDisabledLanes&=p,f.shellSuspendCounter=0;var Y=f.entanglements,ee=f.expirationTimes,de=f.hiddenUpdates;for(p=z&~p;0<p;){var Ae=31-me(p),Ee=1<<Ae;Y[Ae]=0,ee[Ae]=-1;var ge=de[Ae];if(ge!==null)for(de[Ae]=null,Ae=0;Ae<ge.length;Ae++){var ye=ge[Ae];ye!==null&&(ye.lane&=-536870913)}p&=~Ee}w!==0&&hr(f,w,0),N!==0&&D===0&&f.tag!==0&&(f.suspendedLanes|=N&~(z&~d))}function hr(f,d,p){f.pendingLanes|=d,f.suspendedLanes&=~d;var w=31-me(d);f.entangledLanes|=d,f.entanglements[w]=f.entanglements[w]|1073741824|p&261930}function xr(f,d){var p=f.entangledLanes|=d;for(f=f.entanglements;p;){var w=31-me(p),D=1<<w;D&d|f[w]&d&&(f[w]|=d),p&=~D}}function vr(f,d){var p=d&-d;return p=(p&42)!==0?1:br(p),(p&(f.suspendedLanes|d))!==0?0:p}function br(f){switch(f){case 2:f=1;break;case 8:f=4;break;case 32:f=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:f=128;break;case 268435456:f=134217728;break;default:f=0}return f}function ei(f){return f&=-f,2<f?8<f?(f&134217727)!==0?32:268435456:8:2}function dr(){var f=_.p;return f!==0?f:(f=window.event,f===void 0?32:f5(f.type))}function ti(f,d){var p=_.p;try{return _.p=f,d()}finally{_.p=p}}var Lr=Math.random().toString(36).slice(2),ar="__reactFiber$"+Lr,Nr="__reactProps$"+Lr,Sn="__reactContainer$"+Lr,_r="__reactEvents$"+Lr,zr="__reactListeners$"+Lr,cn="__reactHandles$"+Lr,ka="__reactResources$"+Lr,Gr="__reactMarker$"+Lr;function Fo(f){delete f[ar],delete f[Nr],delete f[_r],delete f[zr],delete f[cn]}function Ua(f){var d=f[ar];if(d)return d;for(var p=f.parentNode;p;){if(d=p[Sn]||p[ar]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(f=Qb(f);f!==null;){if(p=f[ar])return p;f=Qb(f)}return d}f=p,p=f.parentNode}return null}function Va(f){if(f=f[ar]||f[Sn]){var d=f.tag;if(d===5||d===6||d===13||d===31||d===26||d===27||d===3)return f}return null}function Ps(f){var d=f.tag;if(d===5||d===26||d===27||d===6)return f.stateNode;throw Error(i(33))}function Oa(f){var d=f[ka];return d||(d=f[ka]={hoistableStyles:new Map,hoistableScripts:new Map}),d}function Sr(f){f[Gr]=!0}var Sf=new Set,Tf={};function _n(f,d){Ui(f,d),Ui(f+"Capture",d)}function Ui(f,d){for(Tf[f]=d,f=0;f<d.length;f++)Sf.add(d[f])}var ko=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),eu={},tu={};function J0(f){return Xe.call(tu,f)?!0:Xe.call(eu,f)?!1:ko.test(f)?tu[f]=!0:(eu[f]=!0,!1)}function fn(f,d,p){if(J0(d))if(p===null)f.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":f.removeAttribute(d);return;case"boolean":var w=d.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){f.removeAttribute(d);return}}f.setAttribute(d,""+p)}}function Pa(f,d,p){if(p===null)f.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(d);return}f.setAttribute(d,""+p)}}function ri(f,d,p,w){if(w===null)f.removeAttribute(p);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(p);return}f.setAttributeNS(d,p,""+w)}}function qr(f){switch(typeof f){case"bigint":case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function Tn(f){var d=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function $0(f,d,p){var w=Object.getOwnPropertyDescriptor(f.constructor.prototype,d);if(!f.hasOwnProperty(d)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var D=w.get,N=w.set;return Object.defineProperty(f,d,{configurable:!0,get:function(){return D.call(this)},set:function(z){p=""+z,N.call(this,z)}}),Object.defineProperty(f,d,{enumerable:w.enumerable}),{getValue:function(){return p},setValue:function(z){p=""+z},stopTracking:function(){f._valueTracker=null,delete f[d]}}}}function Mf(f){if(!f._valueTracker){var d=Tn(f)?"checked":"value";f._valueTracker=$0(f,d,""+f[d])}}function Df(f){if(!f)return!1;var d=f._valueTracker;if(!d)return!0;var p=d.getValue(),w="";return f&&(w=Tn(f)?f.checked?"true":"false":f.value),f=w,f!==p?(d.setValue(f),!0):!1}function Rf(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}var ZT=/[\n"\\]/g;function ni(f){return f.replace(ZT,function(d){return"\\"+d.charCodeAt(0).toString(16)+" "})}function eg(f,d,p,w,D,N,z,Y){f.name="",z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?f.type=z:f.removeAttribute("type"),d!=null?z==="number"?(d===0&&f.value===""||f.value!=d)&&(f.value=""+qr(d)):f.value!==""+qr(d)&&(f.value=""+qr(d)):z!=="submit"&&z!=="reset"||f.removeAttribute("value"),d!=null?tg(f,z,qr(d)):p!=null?tg(f,z,qr(p)):w!=null&&f.removeAttribute("value"),D==null&&N!=null&&(f.defaultChecked=!!N),D!=null&&(f.checked=D&&typeof D!="function"&&typeof D!="symbol"),Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?f.name=""+qr(Y):f.removeAttribute("name")}function Uy(f,d,p,w,D,N,z,Y){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(f.type=N),d!=null||p!=null){if(!(N!=="submit"&&N!=="reset"||d!=null)){Mf(f);return}p=p!=null?""+qr(p):"",d=d!=null?""+qr(d):p,Y||d===f.value||(f.value=d),f.defaultValue=d}w=w??D,w=typeof w!="function"&&typeof w!="symbol"&&!!w,f.checked=Y?f.checked:!!w,f.defaultChecked=!!w,z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(f.name=z),Mf(f)}function tg(f,d,p){d==="number"&&Rf(f.ownerDocument)===f||f.defaultValue===""+p||(f.defaultValue=""+p)}function Uo(f,d,p,w){if(f=f.options,d){d={};for(var D=0;D<p.length;D++)d["$"+p[D]]=!0;for(p=0;p<f.length;p++)D=d.hasOwnProperty("$"+f[p].value),f[p].selected!==D&&(f[p].selected=D),D&&w&&(f[p].defaultSelected=!0)}else{for(p=""+qr(p),d=null,D=0;D<f.length;D++){if(f[D].value===p){f[D].selected=!0,w&&(f[D].defaultSelected=!0);return}d!==null||f[D].disabled||(d=f[D])}d!==null&&(d.selected=!0)}}function Vy(f,d,p){if(d!=null&&(d=""+qr(d),d!==f.value&&(f.value=d),p==null)){f.defaultValue!==d&&(f.defaultValue=d);return}f.defaultValue=p!=null?""+qr(p):""}function Oy(f,d,p,w){if(d==null){if(w!=null){if(p!=null)throw Error(i(92));if(L(w)){if(1<w.length)throw Error(i(93));w=w[0]}p=w}p==null&&(p=""),d=p}p=qr(d),f.defaultValue=p,w=f.textContent,w===p&&w!==""&&w!==null&&(f.value=w),Mf(f)}function Vo(f,d){if(d){var p=f.firstChild;if(p&&p===f.lastChild&&p.nodeType===3){p.nodeValue=d;return}}f.textContent=d}var WT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Py(f,d,p){var w=d.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?w?f.setProperty(d,""):d==="float"?f.cssFloat="":f[d]="":w?f.setProperty(d,p):typeof p!="number"||p===0||WT.has(d)?d==="float"?f.cssFloat=p:f[d]=(""+p).trim():f[d]=p+"px"}function Ly(f,d,p){if(d!=null&&typeof d!="object")throw Error(i(62));if(f=f.style,p!=null){for(var w in p)!p.hasOwnProperty(w)||d!=null&&d.hasOwnProperty(w)||(w.indexOf("--")===0?f.setProperty(w,""):w==="float"?f.cssFloat="":f[w]="");for(var D in d)w=d[D],d.hasOwnProperty(D)&&p[D]!==w&&Py(f,D,w)}else for(var N in d)d.hasOwnProperty(N)&&Py(f,N,d[N])}function rg(f){if(f.indexOf("-")===-1)return!1;switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JT=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$T=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Bf(f){return $T.test(""+f)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":f}function ta(){}var ng=null;function ig(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Oo=null,Po=null;function _y(f){var d=Va(f);if(d&&(f=d.stateNode)){var p=f[Nr]||null;e:switch(f=d.stateNode,d.type){case"input":if(eg(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),d=p.name,p.type==="radio"&&d!=null){for(p=f;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+ni(""+d)+'"][type="radio"]'),d=0;d<p.length;d++){var w=p[d];if(w!==f&&w.form===f.form){var D=w[Nr]||null;if(!D)throw Error(i(90));eg(w,D.value,D.defaultValue,D.defaultValue,D.checked,D.defaultChecked,D.type,D.name)}}for(d=0;d<p.length;d++)w=p[d],w.form===f.form&&Df(w)}break e;case"textarea":Vy(f,p.value,p.defaultValue);break e;case"select":d=p.value,d!=null&&Uo(f,!!p.multiple,d,!1)}}}var ag=!1;function zy(f,d,p){if(ag)return f(d,p);ag=!0;try{var w=f(d);return w}finally{if(ag=!1,(Oo!==null||Po!==null)&&(ph(),Oo&&(d=Oo,f=Po,Po=Oo=null,_y(d),f)))for(d=0;d<f.length;d++)_y(f[d])}}function ru(f,d){var p=f.stateNode;if(p===null)return null;var w=p[Nr]||null;if(w===null)return null;p=w[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(f=f.type,w=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!w;break e;default:f=!1}if(f)return null;if(p&&typeof p!="function")throw Error(i(231,d,typeof p));return p}var ra=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sg=!1;if(ra)try{var nu={};Object.defineProperty(nu,"passive",{get:function(){sg=!0}}),window.addEventListener("test",nu,nu),window.removeEventListener("test",nu,nu)}catch{sg=!1}var La=null,og=null,If=null;function Gy(){if(If)return If;var f,d=og,p=d.length,w,D="value"in La?La.value:La.textContent,N=D.length;for(f=0;f<p&&d[f]===D[f];f++);var z=p-f;for(w=1;w<=z&&d[p-w]===D[N-w];w++);return If=D.slice(f,1<w?1-w:void 0)}function Nf(f){var d=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&d===13&&(f=13)):f=d,f===10&&(f=13),32<=f||f===13?f:0}function Ff(){return!0}function qy(){return!1}function Mn(f){function d(p,w,D,N,z){this._reactName=p,this._targetInst=D,this.type=w,this.nativeEvent=N,this.target=z,this.currentTarget=null;for(var Y in f)f.hasOwnProperty(Y)&&(p=f[Y],this[Y]=p?p(N):N[Y]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?Ff:qy,this.isPropagationStopped=qy,this}return g(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Ff)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Ff)},persist:function(){},isPersistent:Ff}),d}var Ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kf=Mn(Ls),iu=g({},Ls,{view:0,detail:0}),eM=Mn(iu),lg,ug,au,Uf=g({},iu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fg,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==au&&(au&&f.type==="mousemove"?(lg=f.screenX-au.screenX,ug=f.screenY-au.screenY):ug=lg=0,au=f),lg)},movementY:function(f){return"movementY"in f?f.movementY:ug}}),Yy=Mn(Uf),tM=g({},Uf,{dataTransfer:0}),rM=Mn(tM),nM=g({},iu,{relatedTarget:0}),cg=Mn(nM),iM=g({},Ls,{animationName:0,elapsedTime:0,pseudoElement:0}),aM=Mn(iM),sM=g({},Ls,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),oM=Mn(sM),lM=g({},Ls,{data:0}),jy=Mn(lM),uM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hM(f){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(f):(f=fM[f])?!!d[f]:!1}function fg(){return hM}var dM=g({},iu,{key:function(f){if(f.key){var d=uM[f.key]||f.key;if(d!=="Unidentified")return d}return f.type==="keypress"?(f=Nf(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?cM[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fg,charCode:function(f){return f.type==="keypress"?Nf(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?Nf(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),gM=Mn(dM),vM=g({},Uf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hy=Mn(vM),mM=g({},iu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fg}),pM=Mn(mM),yM=g({},Ls,{propertyName:0,elapsedTime:0,pseudoElement:0}),AM=Mn(yM),xM=g({},Uf,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),bM=Mn(xM),wM=g({},Ls,{newState:0,oldState:0}),CM=Mn(wM),EM=[9,13,27,32],hg=ra&&"CompositionEvent"in window,su=null;ra&&"documentMode"in document&&(su=document.documentMode);var SM=ra&&"TextEvent"in window&&!su,Ky=ra&&(!hg||su&&8<su&&11>=su),Xy=" ",Qy=!1;function Zy(f,d){switch(f){case"keyup":return EM.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wy(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Lo=!1;function TM(f,d){switch(f){case"compositionend":return Wy(d);case"keypress":return d.which!==32?null:(Qy=!0,Xy);case"textInput":return f=d.data,f===Xy&&Qy?null:f;default:return null}}function MM(f,d){if(Lo)return f==="compositionend"||!hg&&Zy(f,d)?(f=Gy(),If=og=La=null,Lo=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return Ky&&d.locale!=="ko"?null:d.data;default:return null}}var DM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jy(f){var d=f&&f.nodeName&&f.nodeName.toLowerCase();return d==="input"?!!DM[f.type]:d==="textarea"}function $y(f,d,p,w){Oo?Po?Po.push(w):Po=[w]:Oo=w,d=Eh(d,"onChange"),0<d.length&&(p=new kf("onChange","change",null,p,w),f.push({event:p,listeners:d}))}var ou=null,lu=null;function RM(f){Ub(f,0)}function Vf(f){var d=Ps(f);if(Df(d))return f}function eA(f,d){if(f==="change")return d}var tA=!1;if(ra){var dg;if(ra){var gg="oninput"in document;if(!gg){var rA=document.createElement("div");rA.setAttribute("oninput","return;"),gg=typeof rA.oninput=="function"}dg=gg}else dg=!1;tA=dg&&(!document.documentMode||9<document.documentMode)}function nA(){ou&&(ou.detachEvent("onpropertychange",iA),lu=ou=null)}function iA(f){if(f.propertyName==="value"&&Vf(lu)){var d=[];$y(d,lu,f,ig(f)),zy(RM,d)}}function BM(f,d,p){f==="focusin"?(nA(),ou=d,lu=p,ou.attachEvent("onpropertychange",iA)):f==="focusout"&&nA()}function IM(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return Vf(lu)}function NM(f,d){if(f==="click")return Vf(d)}function FM(f,d){if(f==="input"||f==="change")return Vf(d)}function kM(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var zn=typeof Object.is=="function"?Object.is:kM;function uu(f,d){if(zn(f,d))return!0;if(typeof f!="object"||f===null||typeof d!="object"||d===null)return!1;var p=Object.keys(f),w=Object.keys(d);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var D=p[w];if(!Xe.call(d,D)||!zn(f[D],d[D]))return!1}return!0}function aA(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function sA(f,d){var p=aA(f);f=0;for(var w;p;){if(p.nodeType===3){if(w=f+p.textContent.length,f<=d&&w>=d)return{node:p,offset:d-f};f=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=aA(p)}}function oA(f,d){return f&&d?f===d?!0:f&&f.nodeType===3?!1:d&&d.nodeType===3?oA(f,d.parentNode):"contains"in f?f.contains(d):f.compareDocumentPosition?!!(f.compareDocumentPosition(d)&16):!1:!1}function lA(f){f=f!=null&&f.ownerDocument!=null&&f.ownerDocument.defaultView!=null?f.ownerDocument.defaultView:window;for(var d=Rf(f.document);d instanceof f.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)f=d.contentWindow;else break;d=Rf(f.document)}return d}function vg(f){var d=f&&f.nodeName&&f.nodeName.toLowerCase();return d&&(d==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||d==="textarea"||f.contentEditable==="true")}var UM=ra&&"documentMode"in document&&11>=document.documentMode,_o=null,mg=null,cu=null,pg=!1;function uA(f,d,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;pg||_o==null||_o!==Rf(w)||(w=_o,"selectionStart"in w&&vg(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),cu&&uu(cu,w)||(cu=w,w=Eh(mg,"onSelect"),0<w.length&&(d=new kf("onSelect","select",null,d,p),f.push({event:d,listeners:w}),d.target=_o)))}function _s(f,d){var p={};return p[f.toLowerCase()]=d.toLowerCase(),p["Webkit"+f]="webkit"+d,p["Moz"+f]="moz"+d,p}var zo={animationend:_s("Animation","AnimationEnd"),animationiteration:_s("Animation","AnimationIteration"),animationstart:_s("Animation","AnimationStart"),transitionrun:_s("Transition","TransitionRun"),transitionstart:_s("Transition","TransitionStart"),transitioncancel:_s("Transition","TransitionCancel"),transitionend:_s("Transition","TransitionEnd")},yg={},cA={};ra&&(cA=document.createElement("div").style,"AnimationEvent"in window||(delete zo.animationend.animation,delete zo.animationiteration.animation,delete zo.animationstart.animation),"TransitionEvent"in window||delete zo.transitionend.transition);function zs(f){if(yg[f])return yg[f];if(!zo[f])return f;var d=zo[f],p;for(p in d)if(d.hasOwnProperty(p)&&p in cA)return yg[f]=d[p];return f}var fA=zs("animationend"),hA=zs("animationiteration"),dA=zs("animationstart"),VM=zs("transitionrun"),OM=zs("transitionstart"),PM=zs("transitioncancel"),gA=zs("transitionend"),vA=new Map,Ag="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ag.push("scrollEnd");function xi(f,d){vA.set(f,d),_n(d,[f])}var Of=typeof reportError=="function"?reportError:function(f){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof f=="object"&&f!==null&&typeof f.message=="string"?String(f.message):String(f),error:f});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",f);return}console.error(f)},ii=[],Go=0,xg=0;function Pf(){for(var f=Go,d=xg=Go=0;d<f;){var p=ii[d];ii[d++]=null;var w=ii[d];ii[d++]=null;var D=ii[d];ii[d++]=null;var N=ii[d];if(ii[d++]=null,w!==null&&D!==null){var z=w.pending;z===null?D.next=D:(D.next=z.next,z.next=D),w.pending=D}N!==0&&mA(p,D,N)}}function Lf(f,d,p,w){ii[Go++]=f,ii[Go++]=d,ii[Go++]=p,ii[Go++]=w,xg|=w,f.lanes|=w,f=f.alternate,f!==null&&(f.lanes|=w)}function bg(f,d,p,w){return Lf(f,d,p,w),_f(f)}function Gs(f,d){return Lf(f,null,null,d),_f(f)}function mA(f,d,p){f.lanes|=p;var w=f.alternate;w!==null&&(w.lanes|=p);for(var D=!1,N=f.return;N!==null;)N.childLanes|=p,w=N.alternate,w!==null&&(w.childLanes|=p),N.tag===22&&(f=N.stateNode,f===null||f._visibility&1||(D=!0)),f=N,N=N.return;return f.tag===3?(N=f.stateNode,D&&d!==null&&(D=31-me(p),f=N.hiddenUpdates,w=f[D],w===null?f[D]=[d]:w.push(d),d.lane=p|536870912),N):null}function _f(f){if(50<Nu)throw Nu=0,Bv=null,Error(i(185));for(var d=f.return;d!==null;)f=d,d=f.return;return f.tag===3?f.stateNode:null}var qo={};function LM(f,d,p,w){this.tag=f,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(f,d,p,w){return new LM(f,d,p,w)}function wg(f){return f=f.prototype,!(!f||!f.isReactComponent)}function na(f,d){var p=f.alternate;return p===null?(p=Gn(f.tag,d,f.key,f.mode),p.elementType=f.elementType,p.type=f.type,p.stateNode=f.stateNode,p.alternate=f,f.alternate=p):(p.pendingProps=d,p.type=f.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=f.flags&65011712,p.childLanes=f.childLanes,p.lanes=f.lanes,p.child=f.child,p.memoizedProps=f.memoizedProps,p.memoizedState=f.memoizedState,p.updateQueue=f.updateQueue,d=f.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=f.sibling,p.index=f.index,p.ref=f.ref,p.refCleanup=f.refCleanup,p}function pA(f,d){f.flags&=65011714;var p=f.alternate;return p===null?(f.childLanes=0,f.lanes=d,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=p.childLanes,f.lanes=p.lanes,f.child=p.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=p.memoizedProps,f.memoizedState=p.memoizedState,f.updateQueue=p.updateQueue,f.type=p.type,d=p.dependencies,f.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),f}function zf(f,d,p,w,D,N){var z=0;if(w=f,typeof f=="function")wg(f)&&(z=1);else if(typeof f=="string")z=YD(f,p,te.current)?26:f==="html"||f==="head"||f==="body"?27:5;else e:switch(f){case F:return f=Gn(31,p,d,D),f.elementType=F,f.lanes=N,f;case b:return qs(p.children,D,N,d);case x:z=8,D|=24;break;case A:return f=Gn(12,p,d,D|2),f.elementType=A,f.lanes=N,f;case M:return f=Gn(13,p,d,D),f.elementType=M,f.lanes=N,f;case R:return f=Gn(19,p,d,D),f.elementType=R,f.lanes=N,f;default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case E:z=10;break e;case C:z=9;break e;case S:z=11;break e;case T:z=14;break e;case B:z=16,w=null;break e}z=29,p=Error(i(130,f===null?"null":typeof f,"")),w=null}return d=Gn(z,p,d,D),d.elementType=f,d.type=w,d.lanes=N,d}function qs(f,d,p,w){return f=Gn(7,f,w,d),f.lanes=p,f}function Cg(f,d,p){return f=Gn(6,f,null,d),f.lanes=p,f}function yA(f){var d=Gn(18,null,null,0);return d.stateNode=f,d}function Eg(f,d,p){return d=Gn(4,f.children!==null?f.children:[],f.key,d),d.lanes=p,d.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},d}var AA=new WeakMap;function ai(f,d){if(typeof f=="object"&&f!==null){var p=AA.get(f);return p!==void 0?p:(d={value:f,source:d,stack:$e(d)},AA.set(f,d),d)}return{value:f,source:d,stack:$e(d)}}var Yo=[],jo=0,Gf=null,fu=0,si=[],oi=0,_a=null,Vi=1,Oi="";function ia(f,d){Yo[jo++]=fu,Yo[jo++]=Gf,Gf=f,fu=d}function xA(f,d,p){si[oi++]=Vi,si[oi++]=Oi,si[oi++]=_a,_a=f;var w=Vi;f=Oi;var D=32-me(w)-1;w&=~(1<<D),p+=1;var N=32-me(d)+D;if(30<N){var z=D-D%5;N=(w&(1<<z)-1).toString(32),w>>=z,D-=z,Vi=1<<32-me(d)+D|p<<D|w,Oi=N+f}else Vi=1<<N|p<<D|w,Oi=f}function Sg(f){f.return!==null&&(ia(f,1),xA(f,1,0))}function Tg(f){for(;f===Gf;)Gf=Yo[--jo],Yo[jo]=null,fu=Yo[--jo],Yo[jo]=null;for(;f===_a;)_a=si[--oi],si[oi]=null,Oi=si[--oi],si[oi]=null,Vi=si[--oi],si[oi]=null}function bA(f,d){si[oi++]=Vi,si[oi++]=Oi,si[oi++]=_a,Vi=d.id,Oi=d.overflow,_a=f}var $r=null,er=null,St=!1,za=null,li=!1,Mg=Error(i(519));function Ga(f){var d=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw hu(ai(d,f)),Mg}function wA(f){var d=f.stateNode,p=f.type,w=f.memoizedProps;switch(d[ar]=f,d[Nr]=w,p){case"dialog":At("cancel",d),At("close",d);break;case"iframe":case"object":case"embed":At("load",d);break;case"video":case"audio":for(p=0;p<ku.length;p++)At(ku[p],d);break;case"source":At("error",d);break;case"img":case"image":case"link":At("error",d),At("load",d);break;case"details":At("toggle",d);break;case"input":At("invalid",d),Uy(d,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0);break;case"select":At("invalid",d);break;case"textarea":At("invalid",d),Oy(d,w.value,w.defaultValue,w.children)}p=w.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||d.textContent===""+p||w.suppressHydrationWarning===!0||Lb(d.textContent,p)?(w.popover!=null&&(At("beforetoggle",d),At("toggle",d)),w.onScroll!=null&&At("scroll",d),w.onScrollEnd!=null&&At("scrollend",d),w.onClick!=null&&(d.onclick=ta),d=!0):d=!1,d||Ga(f,!0)}function CA(f){for($r=f.return;$r;)switch($r.tag){case 5:case 31:case 13:li=!1;return;case 27:case 3:li=!0;return;default:$r=$r.return}}function Ho(f){if(f!==$r)return!1;if(!St)return CA(f),St=!0,!1;var d=f.tag,p;if((p=d!==3&&d!==27)&&((p=d===5)&&(p=f.type,p=!(p!=="form"&&p!=="button")||jv(f.type,f.memoizedProps)),p=!p),p&&er&&Ga(f),CA(f),d===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));er=Xb(f)}else if(d===31){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));er=Xb(f)}else d===27?(d=er,rs(f.type)?(f=Zv,Zv=null,er=f):er=d):er=$r?ci(f.stateNode.nextSibling):null;return!0}function Ys(){er=$r=null,St=!1}function Dg(){var f=za;return f!==null&&(In===null?In=f:In.push.apply(In,f),za=null),f}function hu(f){za===null?za=[f]:za.push(f)}var Rg=G(null),js=null,aa=null;function qa(f,d,p){$(Rg,d._currentValue),d._currentValue=p}function sa(f){f._currentValue=Rg.current,K(Rg)}function Bg(f,d,p){for(;f!==null;){var w=f.alternate;if((f.childLanes&d)!==d?(f.childLanes|=d,w!==null&&(w.childLanes|=d)):w!==null&&(w.childLanes&d)!==d&&(w.childLanes|=d),f===p)break;f=f.return}}function Ig(f,d,p,w){var D=f.child;for(D!==null&&(D.return=f);D!==null;){var N=D.dependencies;if(N!==null){var z=D.child;N=N.firstContext;e:for(;N!==null;){var Y=N;N=D;for(var ee=0;ee<d.length;ee++)if(Y.context===d[ee]){N.lanes|=p,Y=N.alternate,Y!==null&&(Y.lanes|=p),Bg(N.return,p,f),w||(z=null);break e}N=Y.next}}else if(D.tag===18){if(z=D.return,z===null)throw Error(i(341));z.lanes|=p,N=z.alternate,N!==null&&(N.lanes|=p),Bg(z,p,f),z=null}else z=D.child;if(z!==null)z.return=D;else for(z=D;z!==null;){if(z===f){z=null;break}if(D=z.sibling,D!==null){D.return=z.return,z=D;break}z=z.return}D=z}}function Ko(f,d,p,w){f=null;for(var D=d,N=!1;D!==null;){if(!N){if((D.flags&524288)!==0)N=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var z=D.alternate;if(z===null)throw Error(i(387));if(z=z.memoizedProps,z!==null){var Y=D.type;zn(D.pendingProps.value,z.value)||(f!==null?f.push(Y):f=[Y])}}else if(D===re.current){if(z=D.alternate,z===null)throw Error(i(387));z.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(f!==null?f.push(Lu):f=[Lu])}D=D.return}f!==null&&Ig(d,f,p,w),d.flags|=262144}function qf(f){for(f=f.firstContext;f!==null;){if(!zn(f.context._currentValue,f.memoizedValue))return!0;f=f.next}return!1}function Hs(f){js=f,aa=null,f=f.dependencies,f!==null&&(f.firstContext=null)}function en(f){return EA(js,f)}function Yf(f,d){return js===null&&Hs(f),EA(f,d)}function EA(f,d){var p=d._currentValue;if(d={context:d,memoizedValue:p,next:null},aa===null){if(f===null)throw Error(i(308));aa=d,f.dependencies={lanes:0,firstContext:d},f.flags|=524288}else aa=aa.next=d;return p}var _M=typeof AbortController<"u"?AbortController:function(){var f=[],d=this.signal={aborted:!1,addEventListener:function(p,w){f.push(w)}};this.abort=function(){d.aborted=!0,f.forEach(function(p){return p()})}},zM=r.unstable_scheduleCallback,GM=r.unstable_NormalPriority,Tr={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ng(){return{controller:new _M,data:new Map,refCount:0}}function du(f){f.refCount--,f.refCount===0&&zM(GM,function(){f.controller.abort()})}var gu=null,Fg=0,Xo=0,Qo=null;function qM(f,d){if(gu===null){var p=gu=[];Fg=0,Xo=Vv(),Qo={status:"pending",value:void 0,then:function(w){p.push(w)}}}return Fg++,d.then(SA,SA),d}function SA(){if(--Fg===0&&gu!==null){Qo!==null&&(Qo.status="fulfilled");var f=gu;gu=null,Xo=0,Qo=null;for(var d=0;d<f.length;d++)(0,f[d])()}}function YM(f,d){var p=[],w={status:"pending",value:null,reason:null,then:function(D){p.push(D)}};return f.then(function(){w.status="fulfilled",w.value=d;for(var D=0;D<p.length;D++)(0,p[D])(d)},function(D){for(w.status="rejected",w.reason=D,D=0;D<p.length;D++)(0,p[D])(void 0)}),w}var TA=P.S;P.S=function(f,d){ub=ke(),typeof d=="object"&&d!==null&&typeof d.then=="function"&&qM(f,d),TA!==null&&TA(f,d)};var Ks=G(null);function kg(){var f=Ks.current;return f!==null?f:Ht.pooledCache}function jf(f,d){d===null?$(Ks,Ks.current):$(Ks,d.pool)}function MA(){var f=kg();return f===null?null:{parent:Tr._currentValue,pool:f}}var Zo=Error(i(460)),Ug=Error(i(474)),Hf=Error(i(542)),Kf={then:function(){}};function DA(f){return f=f.status,f==="fulfilled"||f==="rejected"}function RA(f,d,p){switch(p=f[p],p===void 0?f.push(d):p!==d&&(d.then(ta,ta),d=p),d.status){case"fulfilled":return d.value;case"rejected":throw f=d.reason,IA(f),f;default:if(typeof d.status=="string")d.then(ta,ta);else{if(f=Ht,f!==null&&100<f.shellSuspendCounter)throw Error(i(482));f=d,f.status="pending",f.then(function(w){if(d.status==="pending"){var D=d;D.status="fulfilled",D.value=w}},function(w){if(d.status==="pending"){var D=d;D.status="rejected",D.reason=w}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw f=d.reason,IA(f),f}throw Qs=d,Zo}}function Xs(f){try{var d=f._init;return d(f._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(Qs=p,Zo):p}}var Qs=null;function BA(){if(Qs===null)throw Error(i(459));var f=Qs;return Qs=null,f}function IA(f){if(f===Zo||f===Hf)throw Error(i(483))}var Wo=null,vu=0;function Xf(f){var d=vu;return vu+=1,Wo===null&&(Wo=[]),RA(Wo,f,d)}function mu(f,d){d=d.props.ref,f.ref=d!==void 0?d:null}function Qf(f,d){throw d.$$typeof===v?Error(i(525)):(f=Object.prototype.toString.call(d),Error(i(31,f==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":f)))}function NA(f){function d(oe,ne){if(f){var he=oe.deletions;he===null?(oe.deletions=[ne],oe.flags|=16):he.push(ne)}}function p(oe,ne){if(!f)return null;for(;ne!==null;)d(oe,ne),ne=ne.sibling;return null}function w(oe){for(var ne=new Map;oe!==null;)oe.key!==null?ne.set(oe.key,oe):ne.set(oe.index,oe),oe=oe.sibling;return ne}function D(oe,ne){return oe=na(oe,ne),oe.index=0,oe.sibling=null,oe}function N(oe,ne,he){return oe.index=he,f?(he=oe.alternate,he!==null?(he=he.index,he<ne?(oe.flags|=67108866,ne):he):(oe.flags|=67108866,ne)):(oe.flags|=1048576,ne)}function z(oe){return f&&oe.alternate===null&&(oe.flags|=67108866),oe}function Y(oe,ne,he,Ce){return ne===null||ne.tag!==6?(ne=Cg(he,oe.mode,Ce),ne.return=oe,ne):(ne=D(ne,he),ne.return=oe,ne)}function ee(oe,ne,he,Ce){var Je=he.type;return Je===b?Ae(oe,ne,he.props.children,Ce,he.key):ne!==null&&(ne.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===B&&Xs(Je)===ne.type)?(ne=D(ne,he.props),mu(ne,he),ne.return=oe,ne):(ne=zf(he.type,he.key,he.props,null,oe.mode,Ce),mu(ne,he),ne.return=oe,ne)}function de(oe,ne,he,Ce){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==he.containerInfo||ne.stateNode.implementation!==he.implementation?(ne=Eg(he,oe.mode,Ce),ne.return=oe,ne):(ne=D(ne,he.children||[]),ne.return=oe,ne)}function Ae(oe,ne,he,Ce,Je){return ne===null||ne.tag!==7?(ne=qs(he,oe.mode,Ce,Je),ne.return=oe,ne):(ne=D(ne,he),ne.return=oe,ne)}function Ee(oe,ne,he){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=Cg(""+ne,oe.mode,he),ne.return=oe,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case m:return he=zf(ne.type,ne.key,ne.props,null,oe.mode,he),mu(he,ne),he.return=oe,he;case y:return ne=Eg(ne,oe.mode,he),ne.return=oe,ne;case B:return ne=Xs(ne),Ee(oe,ne,he)}if(L(ne)||k(ne))return ne=qs(ne,oe.mode,he,null),ne.return=oe,ne;if(typeof ne.then=="function")return Ee(oe,Xf(ne),he);if(ne.$$typeof===E)return Ee(oe,Yf(oe,ne),he);Qf(oe,ne)}return null}function ge(oe,ne,he,Ce){var Je=ne!==null?ne.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return Je!==null?null:Y(oe,ne,""+he,Ce);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case m:return he.key===Je?ee(oe,ne,he,Ce):null;case y:return he.key===Je?de(oe,ne,he,Ce):null;case B:return he=Xs(he),ge(oe,ne,he,Ce)}if(L(he)||k(he))return Je!==null?null:Ae(oe,ne,he,Ce,null);if(typeof he.then=="function")return ge(oe,ne,Xf(he),Ce);if(he.$$typeof===E)return ge(oe,ne,Yf(oe,he),Ce);Qf(oe,he)}return null}function ye(oe,ne,he,Ce,Je){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return oe=oe.get(he)||null,Y(ne,oe,""+Ce,Je);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case m:return oe=oe.get(Ce.key===null?he:Ce.key)||null,ee(ne,oe,Ce,Je);case y:return oe=oe.get(Ce.key===null?he:Ce.key)||null,de(ne,oe,Ce,Je);case B:return Ce=Xs(Ce),ye(oe,ne,he,Ce,Je)}if(L(Ce)||k(Ce))return oe=oe.get(he)||null,Ae(ne,oe,Ce,Je,null);if(typeof Ce.then=="function")return ye(oe,ne,he,Xf(Ce),Je);if(Ce.$$typeof===E)return ye(oe,ne,he,Yf(ne,Ce),Je);Qf(ne,Ce)}return null}function _e(oe,ne,he,Ce){for(var Je=null,Bt=null,je=ne,dt=ne=0,Ct=null;je!==null&&dt<he.length;dt++){je.index>dt?(Ct=je,je=null):Ct=je.sibling;var It=ge(oe,je,he[dt],Ce);if(It===null){je===null&&(je=Ct);break}f&&je&&It.alternate===null&&d(oe,je),ne=N(It,ne,dt),Bt===null?Je=It:Bt.sibling=It,Bt=It,je=Ct}if(dt===he.length)return p(oe,je),St&&ia(oe,dt),Je;if(je===null){for(;dt<he.length;dt++)je=Ee(oe,he[dt],Ce),je!==null&&(ne=N(je,ne,dt),Bt===null?Je=je:Bt.sibling=je,Bt=je);return St&&ia(oe,dt),Je}for(je=w(je);dt<he.length;dt++)Ct=ye(je,oe,dt,he[dt],Ce),Ct!==null&&(f&&Ct.alternate!==null&&je.delete(Ct.key===null?dt:Ct.key),ne=N(Ct,ne,dt),Bt===null?Je=Ct:Bt.sibling=Ct,Bt=Ct);return f&&je.forEach(function(os){return d(oe,os)}),St&&ia(oe,dt),Je}function tt(oe,ne,he,Ce){if(he==null)throw Error(i(151));for(var Je=null,Bt=null,je=ne,dt=ne=0,Ct=null,It=he.next();je!==null&&!It.done;dt++,It=he.next()){je.index>dt?(Ct=je,je=null):Ct=je.sibling;var os=ge(oe,je,It.value,Ce);if(os===null){je===null&&(je=Ct);break}f&&je&&os.alternate===null&&d(oe,je),ne=N(os,ne,dt),Bt===null?Je=os:Bt.sibling=os,Bt=os,je=Ct}if(It.done)return p(oe,je),St&&ia(oe,dt),Je;if(je===null){for(;!It.done;dt++,It=he.next())It=Ee(oe,It.value,Ce),It!==null&&(ne=N(It,ne,dt),Bt===null?Je=It:Bt.sibling=It,Bt=It);return St&&ia(oe,dt),Je}for(je=w(je);!It.done;dt++,It=he.next())It=ye(je,oe,dt,It.value,Ce),It!==null&&(f&&It.alternate!==null&&je.delete(It.key===null?dt:It.key),ne=N(It,ne,dt),Bt===null?Je=It:Bt.sibling=It,Bt=It);return f&&je.forEach(function(t8){return d(oe,t8)}),St&&ia(oe,dt),Je}function Yt(oe,ne,he,Ce){if(typeof he=="object"&&he!==null&&he.type===b&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case m:e:{for(var Je=he.key;ne!==null;){if(ne.key===Je){if(Je=he.type,Je===b){if(ne.tag===7){p(oe,ne.sibling),Ce=D(ne,he.props.children),Ce.return=oe,oe=Ce;break e}}else if(ne.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===B&&Xs(Je)===ne.type){p(oe,ne.sibling),Ce=D(ne,he.props),mu(Ce,he),Ce.return=oe,oe=Ce;break e}p(oe,ne);break}else d(oe,ne);ne=ne.sibling}he.type===b?(Ce=qs(he.props.children,oe.mode,Ce,he.key),Ce.return=oe,oe=Ce):(Ce=zf(he.type,he.key,he.props,null,oe.mode,Ce),mu(Ce,he),Ce.return=oe,oe=Ce)}return z(oe);case y:e:{for(Je=he.key;ne!==null;){if(ne.key===Je)if(ne.tag===4&&ne.stateNode.containerInfo===he.containerInfo&&ne.stateNode.implementation===he.implementation){p(oe,ne.sibling),Ce=D(ne,he.children||[]),Ce.return=oe,oe=Ce;break e}else{p(oe,ne);break}else d(oe,ne);ne=ne.sibling}Ce=Eg(he,oe.mode,Ce),Ce.return=oe,oe=Ce}return z(oe);case B:return he=Xs(he),Yt(oe,ne,he,Ce)}if(L(he))return _e(oe,ne,he,Ce);if(k(he)){if(Je=k(he),typeof Je!="function")throw Error(i(150));return he=Je.call(he),tt(oe,ne,he,Ce)}if(typeof he.then=="function")return Yt(oe,ne,Xf(he),Ce);if(he.$$typeof===E)return Yt(oe,ne,Yf(oe,he),Ce);Qf(oe,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,ne!==null&&ne.tag===6?(p(oe,ne.sibling),Ce=D(ne,he),Ce.return=oe,oe=Ce):(p(oe,ne),Ce=Cg(he,oe.mode,Ce),Ce.return=oe,oe=Ce),z(oe)):p(oe,ne)}return function(oe,ne,he,Ce){try{vu=0;var Je=Yt(oe,ne,he,Ce);return Wo=null,Je}catch(je){if(je===Zo||je===Hf)throw je;var Bt=Gn(29,je,null,oe.mode);return Bt.lanes=Ce,Bt.return=oe,Bt}finally{}}}var Zs=NA(!0),FA=NA(!1),Ya=!1;function Vg(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Og(f,d){f=f.updateQueue,d.updateQueue===f&&(d.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,callbacks:null})}function ja(f){return{lane:f,tag:0,payload:null,callback:null,next:null}}function Ha(f,d,p){var w=f.updateQueue;if(w===null)return null;if(w=w.shared,(kt&2)!==0){var D=w.pending;return D===null?d.next=d:(d.next=D.next,D.next=d),w.pending=d,d=_f(f),mA(f,null,p),d}return Lf(f,w,d,p),_f(f)}function pu(f,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194048)!==0)){var w=d.lanes;w&=f.pendingLanes,p|=w,d.lanes=p,xr(f,p)}}function Pg(f,d){var p=f.updateQueue,w=f.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var D=null,N=null;if(p=p.firstBaseUpdate,p!==null){do{var z={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};N===null?D=N=z:N=N.next=z,p=p.next}while(p!==null);N===null?D=N=d:N=N.next=d}else D=N=d;p={baseState:w.baseState,firstBaseUpdate:D,lastBaseUpdate:N,shared:w.shared,callbacks:w.callbacks},f.updateQueue=p;return}f=p.lastBaseUpdate,f===null?p.firstBaseUpdate=d:f.next=d,p.lastBaseUpdate=d}var Lg=!1;function yu(){if(Lg){var f=Qo;if(f!==null)throw f}}function Au(f,d,p,w){Lg=!1;var D=f.updateQueue;Ya=!1;var N=D.firstBaseUpdate,z=D.lastBaseUpdate,Y=D.shared.pending;if(Y!==null){D.shared.pending=null;var ee=Y,de=ee.next;ee.next=null,z===null?N=de:z.next=de,z=ee;var Ae=f.alternate;Ae!==null&&(Ae=Ae.updateQueue,Y=Ae.lastBaseUpdate,Y!==z&&(Y===null?Ae.firstBaseUpdate=de:Y.next=de,Ae.lastBaseUpdate=ee))}if(N!==null){var Ee=D.baseState;z=0,Ae=de=ee=null,Y=N;do{var ge=Y.lane&-536870913,ye=ge!==Y.lane;if(ye?(wt&ge)===ge:(w&ge)===ge){ge!==0&&ge===Xo&&(Lg=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:Y.tag,payload:Y.payload,callback:null,next:null});e:{var _e=f,tt=Y;ge=d;var Yt=p;switch(tt.tag){case 1:if(_e=tt.payload,typeof _e=="function"){Ee=_e.call(Yt,Ee,ge);break e}Ee=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=tt.payload,ge=typeof _e=="function"?_e.call(Yt,Ee,ge):_e,ge==null)break e;Ee=g({},Ee,ge);break e;case 2:Ya=!0}}ge=Y.callback,ge!==null&&(f.flags|=64,ye&&(f.flags|=8192),ye=D.callbacks,ye===null?D.callbacks=[ge]:ye.push(ge))}else ye={lane:ge,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},Ae===null?(de=Ae=ye,ee=Ee):Ae=Ae.next=ye,z|=ge;if(Y=Y.next,Y===null){if(Y=D.shared.pending,Y===null)break;ye=Y,Y=ye.next,ye.next=null,D.lastBaseUpdate=ye,D.shared.pending=null}}while(!0);Ae===null&&(ee=Ee),D.baseState=ee,D.firstBaseUpdate=de,D.lastBaseUpdate=Ae,N===null&&(D.shared.lanes=0),Wa|=z,f.lanes=z,f.memoizedState=Ee}}function kA(f,d){if(typeof f!="function")throw Error(i(191,f));f.call(d)}function UA(f,d){var p=f.callbacks;if(p!==null)for(f.callbacks=null,f=0;f<p.length;f++)kA(p[f],d)}var Jo=G(null),Zf=G(0);function VA(f,d){f=va,$(Zf,f),$(Jo,d),va=f|d.baseLanes}function _g(){$(Zf,va),$(Jo,Jo.current)}function zg(){va=Zf.current,K(Jo),K(Zf)}var qn=G(null),ui=null;function Ka(f){var d=f.alternate;$(wr,wr.current&1),$(qn,f),ui===null&&(d===null||Jo.current!==null||d.memoizedState!==null)&&(ui=f)}function Gg(f){$(wr,wr.current),$(qn,f),ui===null&&(ui=f)}function OA(f){f.tag===22?($(wr,wr.current),$(qn,f),ui===null&&(ui=f)):Xa()}function Xa(){$(wr,wr.current),$(qn,qn.current)}function Yn(f){K(qn),ui===f&&(ui=null),K(wr)}var wr=G(0);function Wf(f){for(var d=f;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Xv(p)||Qv(p)))return d}else if(d.tag===19&&(d.memoizedProps.revealOrder==="forwards"||d.memoizedProps.revealOrder==="backwards"||d.memoizedProps.revealOrder==="unstable_legacy-backwards"||d.memoizedProps.revealOrder==="together")){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===f)break;for(;d.sibling===null;){if(d.return===null||d.return===f)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var oa=0,ct=null,Gt=null,Mr=null,Jf=!1,$o=!1,Ws=!1,$f=0,xu=0,el=null,jM=0;function mr(){throw Error(i(321))}function qg(f,d){if(d===null)return!1;for(var p=0;p<d.length&&p<f.length;p++)if(!zn(f[p],d[p]))return!1;return!0}function Yg(f,d,p,w,D,N){return oa=N,ct=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,P.H=f===null||f.memoizedState===null?xx:av,Ws=!1,N=p(w,D),Ws=!1,$o&&(N=LA(d,p,w,D)),PA(f),N}function PA(f){P.H=Cu;var d=Gt!==null&&Gt.next!==null;if(oa=0,Mr=Gt=ct=null,Jf=!1,xu=0,el=null,d)throw Error(i(300));f===null||Dr||(f=f.dependencies,f!==null&&qf(f)&&(Dr=!0))}function LA(f,d,p,w){ct=f;var D=0;do{if($o&&(el=null),xu=0,$o=!1,25<=D)throw Error(i(301));if(D+=1,Mr=Gt=null,f.updateQueue!=null){var N=f.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}P.H=bx,N=d(p,w)}while($o);return N}function HM(){var f=P.H,d=f.useState()[0];return d=typeof d.then=="function"?bu(d):d,f=f.useState()[0],(Gt!==null?Gt.memoizedState:null)!==f&&(ct.flags|=1024),d}function jg(){var f=$f!==0;return $f=0,f}function Hg(f,d,p){d.updateQueue=f.updateQueue,d.flags&=-2053,f.lanes&=~p}function Kg(f){if(Jf){for(f=f.memoizedState;f!==null;){var d=f.queue;d!==null&&(d.pending=null),f=f.next}Jf=!1}oa=0,Mr=Gt=ct=null,$o=!1,xu=$f=0,el=null}function pn(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mr===null?ct.memoizedState=Mr=f:Mr=Mr.next=f,Mr}function Cr(){if(Gt===null){var f=ct.alternate;f=f!==null?f.memoizedState:null}else f=Gt.next;var d=Mr===null?ct.memoizedState:Mr.next;if(d!==null)Mr=d,Gt=f;else{if(f===null)throw ct.alternate===null?Error(i(467)):Error(i(310));Gt=f,f={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Mr===null?ct.memoizedState=Mr=f:Mr=Mr.next=f}return Mr}function eh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bu(f){var d=xu;return xu+=1,el===null&&(el=[]),f=RA(el,f,d),d=ct,(Mr===null?d.memoizedState:Mr.next)===null&&(d=d.alternate,P.H=d===null||d.memoizedState===null?xx:av),f}function th(f){if(f!==null&&typeof f=="object"){if(typeof f.then=="function")return bu(f);if(f.$$typeof===E)return en(f)}throw Error(i(438,String(f)))}function Xg(f){var d=null,p=ct.updateQueue;if(p!==null&&(d=p.memoCache),d==null){var w=ct.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(d={data:w.data.map(function(D){return D.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),p===null&&(p=eh(),ct.updateQueue=p),p.memoCache=d,p=d.data[d.index],p===void 0)for(p=d.data[d.index]=Array(f),w=0;w<f;w++)p[w]=I;return d.index++,p}function la(f,d){return typeof d=="function"?d(f):d}function rh(f){var d=Cr();return Qg(d,Gt,f)}function Qg(f,d,p){var w=f.queue;if(w===null)throw Error(i(311));w.lastRenderedReducer=p;var D=f.baseQueue,N=w.pending;if(N!==null){if(D!==null){var z=D.next;D.next=N.next,N.next=z}d.baseQueue=D=N,w.pending=null}if(N=f.baseState,D===null)f.memoizedState=N;else{d=D.next;var Y=z=null,ee=null,de=d,Ae=!1;do{var Ee=de.lane&-536870913;if(Ee!==de.lane?(wt&Ee)===Ee:(oa&Ee)===Ee){var ge=de.revertLane;if(ge===0)ee!==null&&(ee=ee.next={lane:0,revertLane:0,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),Ee===Xo&&(Ae=!0);else if((oa&ge)===ge){de=de.next,ge===Xo&&(Ae=!0);continue}else Ee={lane:0,revertLane:de.revertLane,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},ee===null?(Y=ee=Ee,z=N):ee=ee.next=Ee,ct.lanes|=ge,Wa|=ge;Ee=de.action,Ws&&p(N,Ee),N=de.hasEagerState?de.eagerState:p(N,Ee)}else ge={lane:Ee,revertLane:de.revertLane,gesture:de.gesture,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},ee===null?(Y=ee=ge,z=N):ee=ee.next=ge,ct.lanes|=Ee,Wa|=Ee;de=de.next}while(de!==null&&de!==d);if(ee===null?z=N:ee.next=Y,!zn(N,f.memoizedState)&&(Dr=!0,Ae&&(p=Qo,p!==null)))throw p;f.memoizedState=N,f.baseState=z,f.baseQueue=ee,w.lastRenderedState=N}return D===null&&(w.lanes=0),[f.memoizedState,w.dispatch]}function Zg(f){var d=Cr(),p=d.queue;if(p===null)throw Error(i(311));p.lastRenderedReducer=f;var w=p.dispatch,D=p.pending,N=d.memoizedState;if(D!==null){p.pending=null;var z=D=D.next;do N=f(N,z.action),z=z.next;while(z!==D);zn(N,d.memoizedState)||(Dr=!0),d.memoizedState=N,d.baseQueue===null&&(d.baseState=N),p.lastRenderedState=N}return[N,w]}function _A(f,d,p){var w=ct,D=Cr(),N=St;if(N){if(p===void 0)throw Error(i(407));p=p()}else p=d();var z=!zn((Gt||D).memoizedState,p);if(z&&(D.memoizedState=p,Dr=!0),D=D.queue,$g(qA.bind(null,w,D,f),[f]),D.getSnapshot!==d||z||Mr!==null&&Mr.memoizedState.tag&1){if(w.flags|=2048,tl(9,{destroy:void 0},GA.bind(null,w,D,p,d),null),Ht===null)throw Error(i(349));N||(oa&127)!==0||zA(w,d,p)}return p}function zA(f,d,p){f.flags|=16384,f={getSnapshot:d,value:p},d=ct.updateQueue,d===null?(d=eh(),ct.updateQueue=d,d.stores=[f]):(p=d.stores,p===null?d.stores=[f]:p.push(f))}function GA(f,d,p,w){d.value=p,d.getSnapshot=w,YA(d)&&jA(f)}function qA(f,d,p){return p(function(){YA(d)&&jA(f)})}function YA(f){var d=f.getSnapshot;f=f.value;try{var p=d();return!zn(f,p)}catch{return!0}}function jA(f){var d=Gs(f,2);d!==null&&Nn(d,f,2)}function Wg(f){var d=pn();if(typeof f=="function"){var p=f;if(f=p(),Ws){pe(!0);try{p()}finally{pe(!1)}}}return d.memoizedState=d.baseState=f,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:la,lastRenderedState:f},d}function HA(f,d,p,w){return f.baseState=p,Qg(f,Gt,typeof w=="function"?w:la)}function KM(f,d,p,w,D){if(ah(f))throw Error(i(485));if(f=d.action,f!==null){var N={payload:D,action:f,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(z){N.listeners.push(z)}};P.T!==null?p(!0):N.isTransition=!1,w(N),p=d.pending,p===null?(N.next=d.pending=N,KA(d,N)):(N.next=p.next,d.pending=p.next=N)}}function KA(f,d){var p=d.action,w=d.payload,D=f.state;if(d.isTransition){var N=P.T,z={};P.T=z;try{var Y=p(D,w),ee=P.S;ee!==null&&ee(z,Y),XA(f,d,Y)}catch(de){Jg(f,d,de)}finally{N!==null&&z.types!==null&&(N.types=z.types),P.T=N}}else try{N=p(D,w),XA(f,d,N)}catch(de){Jg(f,d,de)}}function XA(f,d,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(w){QA(f,d,w)},function(w){return Jg(f,d,w)}):QA(f,d,p)}function QA(f,d,p){d.status="fulfilled",d.value=p,ZA(d),f.state=p,d=f.pending,d!==null&&(p=d.next,p===d?f.pending=null:(p=p.next,d.next=p,KA(f,p)))}function Jg(f,d,p){var w=f.pending;if(f.pending=null,w!==null){w=w.next;do d.status="rejected",d.reason=p,ZA(d),d=d.next;while(d!==w)}f.action=null}function ZA(f){f=f.listeners;for(var d=0;d<f.length;d++)(0,f[d])()}function WA(f,d){return d}function JA(f,d){if(St){var p=Ht.formState;if(p!==null){e:{var w=ct;if(St){if(er){t:{for(var D=er,N=li;D.nodeType!==8;){if(!N){D=null;break t}if(D=ci(D.nextSibling),D===null){D=null;break t}}N=D.data,D=N==="F!"||N==="F"?D:null}if(D){er=ci(D.nextSibling),w=D.data==="F!";break e}}Ga(w)}w=!1}w&&(d=p[0])}}return p=pn(),p.memoizedState=p.baseState=d,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:WA,lastRenderedState:d},p.queue=w,p=px.bind(null,ct,w),w.dispatch=p,w=Wg(!1),N=iv.bind(null,ct,!1,w.queue),w=pn(),D={state:d,dispatch:null,action:f,pending:null},w.queue=D,p=KM.bind(null,ct,D,N,p),D.dispatch=p,w.memoizedState=f,[d,p,!1]}function $A(f){var d=Cr();return ex(d,Gt,f)}function ex(f,d,p){if(d=Qg(f,d,WA)[0],f=rh(la)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var w=bu(d)}catch(z){throw z===Zo?Hf:z}else w=d;d=Cr();var D=d.queue,N=D.dispatch;return p!==d.memoizedState&&(ct.flags|=2048,tl(9,{destroy:void 0},XM.bind(null,D,p),null)),[w,N,f]}function XM(f,d){f.action=d}function tx(f){var d=Cr(),p=Gt;if(p!==null)return ex(d,p,f);Cr(),d=d.memoizedState,p=Cr();var w=p.queue.dispatch;return p.memoizedState=f,[d,w,!1]}function tl(f,d,p,w){return f={tag:f,create:p,deps:w,inst:d,next:null},d=ct.updateQueue,d===null&&(d=eh(),ct.updateQueue=d),p=d.lastEffect,p===null?d.lastEffect=f.next=f:(w=p.next,p.next=f,f.next=w,d.lastEffect=f),f}function rx(){return Cr().memoizedState}function nh(f,d,p,w){var D=pn();ct.flags|=f,D.memoizedState=tl(1|d,{destroy:void 0},p,w===void 0?null:w)}function ih(f,d,p,w){var D=Cr();w=w===void 0?null:w;var N=D.memoizedState.inst;Gt!==null&&w!==null&&qg(w,Gt.memoizedState.deps)?D.memoizedState=tl(d,N,p,w):(ct.flags|=f,D.memoizedState=tl(1|d,N,p,w))}function nx(f,d){nh(8390656,8,f,d)}function $g(f,d){ih(2048,8,f,d)}function QM(f){ct.flags|=4;var d=ct.updateQueue;if(d===null)d=eh(),ct.updateQueue=d,d.events=[f];else{var p=d.events;p===null?d.events=[f]:p.push(f)}}function ix(f){var d=Cr().memoizedState;return QM({ref:d,nextImpl:f}),function(){if((kt&2)!==0)throw Error(i(440));return d.impl.apply(void 0,arguments)}}function ax(f,d){return ih(4,2,f,d)}function sx(f,d){return ih(4,4,f,d)}function ox(f,d){if(typeof d=="function"){f=f();var p=d(f);return function(){typeof p=="function"?p():d(null)}}if(d!=null)return f=f(),d.current=f,function(){d.current=null}}function lx(f,d,p){p=p!=null?p.concat([f]):null,ih(4,4,ox.bind(null,d,f),p)}function ev(){}function ux(f,d){var p=Cr();d=d===void 0?null:d;var w=p.memoizedState;return d!==null&&qg(d,w[1])?w[0]:(p.memoizedState=[f,d],f)}function cx(f,d){var p=Cr();d=d===void 0?null:d;var w=p.memoizedState;if(d!==null&&qg(d,w[1]))return w[0];if(w=f(),Ws){pe(!0);try{f()}finally{pe(!1)}}return p.memoizedState=[w,d],w}function tv(f,d,p){return p===void 0||(oa&1073741824)!==0&&(wt&261930)===0?f.memoizedState=d:(f.memoizedState=p,f=fb(),ct.lanes|=f,Wa|=f,p)}function fx(f,d,p,w){return zn(p,d)?p:Jo.current!==null?(f=tv(f,p,w),zn(f,d)||(Dr=!0),f):(oa&42)===0||(oa&1073741824)!==0&&(wt&261930)===0?(Dr=!0,f.memoizedState=p):(f=fb(),ct.lanes|=f,Wa|=f,d)}function hx(f,d,p,w,D){var N=_.p;_.p=N!==0&&8>N?N:8;var z=P.T,Y={};P.T=Y,iv(f,!1,d,p);try{var ee=D(),de=P.S;if(de!==null&&de(Y,ee),ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var Ae=YM(ee,w);wu(f,d,Ae,Kn(f))}else wu(f,d,w,Kn(f))}catch(Ee){wu(f,d,{then:function(){},status:"rejected",reason:Ee},Kn())}finally{_.p=N,z!==null&&Y.types!==null&&(z.types=Y.types),P.T=z}}function ZM(){}function rv(f,d,p,w){if(f.tag!==5)throw Error(i(476));var D=dx(f).queue;hx(f,D,d,q,p===null?ZM:function(){return gx(f),p(w)})}function dx(f){var d=f.memoizedState;if(d!==null)return d;d={memoizedState:q,baseState:q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:la,lastRenderedState:q},next:null};var p={};return d.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:la,lastRenderedState:p},next:null},f.memoizedState=d,f=f.alternate,f!==null&&(f.memoizedState=d),d}function gx(f){var d=dx(f);d.next===null&&(d=f.alternate.memoizedState),wu(f,d.next.queue,{},Kn())}function nv(){return en(Lu)}function vx(){return Cr().memoizedState}function mx(){return Cr().memoizedState}function WM(f){for(var d=f.return;d!==null;){switch(d.tag){case 24:case 3:var p=Kn();f=ja(p);var w=Ha(d,f,p);w!==null&&(Nn(w,d,p),pu(w,d,p)),d={cache:Ng()},f.payload=d;return}d=d.return}}function JM(f,d,p){var w=Kn();p={lane:w,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},ah(f)?yx(d,p):(p=bg(f,d,p,w),p!==null&&(Nn(p,f,w),Ax(p,d,w)))}function px(f,d,p){var w=Kn();wu(f,d,p,w)}function wu(f,d,p,w){var D={lane:w,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(ah(f))yx(d,D);else{var N=f.alternate;if(f.lanes===0&&(N===null||N.lanes===0)&&(N=d.lastRenderedReducer,N!==null))try{var z=d.lastRenderedState,Y=N(z,p);if(D.hasEagerState=!0,D.eagerState=Y,zn(Y,z))return Lf(f,d,D,0),Ht===null&&Pf(),!1}catch{}finally{}if(p=bg(f,d,D,w),p!==null)return Nn(p,f,w),Ax(p,d,w),!0}return!1}function iv(f,d,p,w){if(w={lane:2,revertLane:Vv(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},ah(f)){if(d)throw Error(i(479))}else d=bg(f,p,w,2),d!==null&&Nn(d,f,2)}function ah(f){var d=f.alternate;return f===ct||d!==null&&d===ct}function yx(f,d){$o=Jf=!0;var p=f.pending;p===null?d.next=d:(d.next=p.next,p.next=d),f.pending=d}function Ax(f,d,p){if((p&4194048)!==0){var w=d.lanes;w&=f.pendingLanes,p|=w,d.lanes=p,xr(f,p)}}var Cu={readContext:en,use:th,useCallback:mr,useContext:mr,useEffect:mr,useImperativeHandle:mr,useLayoutEffect:mr,useInsertionEffect:mr,useMemo:mr,useReducer:mr,useRef:mr,useState:mr,useDebugValue:mr,useDeferredValue:mr,useTransition:mr,useSyncExternalStore:mr,useId:mr,useHostTransitionStatus:mr,useFormState:mr,useActionState:mr,useOptimistic:mr,useMemoCache:mr,useCacheRefresh:mr};Cu.useEffectEvent=mr;var xx={readContext:en,use:th,useCallback:function(f,d){return pn().memoizedState=[f,d===void 0?null:d],f},useContext:en,useEffect:nx,useImperativeHandle:function(f,d,p){p=p!=null?p.concat([f]):null,nh(4194308,4,ox.bind(null,d,f),p)},useLayoutEffect:function(f,d){return nh(4194308,4,f,d)},useInsertionEffect:function(f,d){nh(4,2,f,d)},useMemo:function(f,d){var p=pn();d=d===void 0?null:d;var w=f();if(Ws){pe(!0);try{f()}finally{pe(!1)}}return p.memoizedState=[w,d],w},useReducer:function(f,d,p){var w=pn();if(p!==void 0){var D=p(d);if(Ws){pe(!0);try{p(d)}finally{pe(!1)}}}else D=d;return w.memoizedState=w.baseState=D,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:D},w.queue=f,f=f.dispatch=JM.bind(null,ct,f),[w.memoizedState,f]},useRef:function(f){var d=pn();return f={current:f},d.memoizedState=f},useState:function(f){f=Wg(f);var d=f.queue,p=px.bind(null,ct,d);return d.dispatch=p,[f.memoizedState,p]},useDebugValue:ev,useDeferredValue:function(f,d){var p=pn();return tv(p,f,d)},useTransition:function(){var f=Wg(!1);return f=hx.bind(null,ct,f.queue,!0,!1),pn().memoizedState=f,[!1,f]},useSyncExternalStore:function(f,d,p){var w=ct,D=pn();if(St){if(p===void 0)throw Error(i(407));p=p()}else{if(p=d(),Ht===null)throw Error(i(349));(wt&127)!==0||zA(w,d,p)}D.memoizedState=p;var N={value:p,getSnapshot:d};return D.queue=N,nx(qA.bind(null,w,N,f),[f]),w.flags|=2048,tl(9,{destroy:void 0},GA.bind(null,w,N,p,d),null),p},useId:function(){var f=pn(),d=Ht.identifierPrefix;if(St){var p=Oi,w=Vi;p=(w&~(1<<32-me(w)-1)).toString(32)+p,d="_"+d+"R_"+p,p=$f++,0<p&&(d+="H"+p.toString(32)),d+="_"}else p=jM++,d="_"+d+"r_"+p.toString(32)+"_";return f.memoizedState=d},useHostTransitionStatus:nv,useFormState:JA,useActionState:JA,useOptimistic:function(f){var d=pn();d.memoizedState=d.baseState=f;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=p,d=iv.bind(null,ct,!0,p),p.dispatch=d,[f,d]},useMemoCache:Xg,useCacheRefresh:function(){return pn().memoizedState=WM.bind(null,ct)},useEffectEvent:function(f){var d=pn(),p={impl:f};return d.memoizedState=p,function(){if((kt&2)!==0)throw Error(i(440));return p.impl.apply(void 0,arguments)}}},av={readContext:en,use:th,useCallback:ux,useContext:en,useEffect:$g,useImperativeHandle:lx,useInsertionEffect:ax,useLayoutEffect:sx,useMemo:cx,useReducer:rh,useRef:rx,useState:function(){return rh(la)},useDebugValue:ev,useDeferredValue:function(f,d){var p=Cr();return fx(p,Gt.memoizedState,f,d)},useTransition:function(){var f=rh(la)[0],d=Cr().memoizedState;return[typeof f=="boolean"?f:bu(f),d]},useSyncExternalStore:_A,useId:vx,useHostTransitionStatus:nv,useFormState:$A,useActionState:$A,useOptimistic:function(f,d){var p=Cr();return HA(p,Gt,f,d)},useMemoCache:Xg,useCacheRefresh:mx};av.useEffectEvent=ix;var bx={readContext:en,use:th,useCallback:ux,useContext:en,useEffect:$g,useImperativeHandle:lx,useInsertionEffect:ax,useLayoutEffect:sx,useMemo:cx,useReducer:Zg,useRef:rx,useState:function(){return Zg(la)},useDebugValue:ev,useDeferredValue:function(f,d){var p=Cr();return Gt===null?tv(p,f,d):fx(p,Gt.memoizedState,f,d)},useTransition:function(){var f=Zg(la)[0],d=Cr().memoizedState;return[typeof f=="boolean"?f:bu(f),d]},useSyncExternalStore:_A,useId:vx,useHostTransitionStatus:nv,useFormState:tx,useActionState:tx,useOptimistic:function(f,d){var p=Cr();return Gt!==null?HA(p,Gt,f,d):(p.baseState=f,[f,p.queue.dispatch])},useMemoCache:Xg,useCacheRefresh:mx};bx.useEffectEvent=ix;function sv(f,d,p,w){d=f.memoizedState,p=p(w,d),p=p==null?d:g({},d,p),f.memoizedState=p,f.lanes===0&&(f.updateQueue.baseState=p)}var ov={enqueueSetState:function(f,d,p){f=f._reactInternals;var w=Kn(),D=ja(w);D.payload=d,p!=null&&(D.callback=p),d=Ha(f,D,w),d!==null&&(Nn(d,f,w),pu(d,f,w))},enqueueReplaceState:function(f,d,p){f=f._reactInternals;var w=Kn(),D=ja(w);D.tag=1,D.payload=d,p!=null&&(D.callback=p),d=Ha(f,D,w),d!==null&&(Nn(d,f,w),pu(d,f,w))},enqueueForceUpdate:function(f,d){f=f._reactInternals;var p=Kn(),w=ja(p);w.tag=2,d!=null&&(w.callback=d),d=Ha(f,w,p),d!==null&&(Nn(d,f,p),pu(d,f,p))}};function wx(f,d,p,w,D,N,z){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(w,N,z):d.prototype&&d.prototype.isPureReactComponent?!uu(p,w)||!uu(D,N):!0}function Cx(f,d,p,w){f=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,w),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,w),d.state!==f&&ov.enqueueReplaceState(d,d.state,null)}function Js(f,d){var p=d;if("ref"in d){p={};for(var w in d)w!=="ref"&&(p[w]=d[w])}if(f=f.defaultProps){p===d&&(p=g({},p));for(var D in f)p[D]===void 0&&(p[D]=f[D])}return p}function Ex(f){Of(f)}function Sx(f){console.error(f)}function Tx(f){Of(f)}function sh(f,d){try{var p=f.onUncaughtError;p(d.value,{componentStack:d.stack})}catch(w){setTimeout(function(){throw w})}}function Mx(f,d,p){try{var w=f.onCaughtError;w(p.value,{componentStack:p.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function lv(f,d,p){return p=ja(p),p.tag=3,p.payload={element:null},p.callback=function(){sh(f,d)},p}function Dx(f){return f=ja(f),f.tag=3,f}function Rx(f,d,p,w){var D=p.type.getDerivedStateFromError;if(typeof D=="function"){var N=w.value;f.payload=function(){return D(N)},f.callback=function(){Mx(d,p,w)}}var z=p.stateNode;z!==null&&typeof z.componentDidCatch=="function"&&(f.callback=function(){Mx(d,p,w),typeof D!="function"&&(Ja===null?Ja=new Set([this]):Ja.add(this));var Y=w.stack;this.componentDidCatch(w.value,{componentStack:Y!==null?Y:""})})}function $M(f,d,p,w,D){if(p.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(d=p.alternate,d!==null&&Ko(d,p,D,!0),p=qn.current,p!==null){switch(p.tag){case 31:case 13:return ui===null?yh():p.alternate===null&&pr===0&&(pr=3),p.flags&=-257,p.flags|=65536,p.lanes=D,w===Kf?p.flags|=16384:(d=p.updateQueue,d===null?p.updateQueue=new Set([w]):d.add(w),Fv(f,w,D)),!1;case 22:return p.flags|=65536,w===Kf?p.flags|=16384:(d=p.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([w])},p.updateQueue=d):(p=d.retryQueue,p===null?d.retryQueue=new Set([w]):p.add(w)),Fv(f,w,D)),!1}throw Error(i(435,p.tag))}return Fv(f,w,D),yh(),!1}if(St)return d=qn.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=D,w!==Mg&&(f=Error(i(422),{cause:w}),hu(ai(f,p)))):(w!==Mg&&(d=Error(i(423),{cause:w}),hu(ai(d,p))),f=f.current.alternate,f.flags|=65536,D&=-D,f.lanes|=D,w=ai(w,p),D=lv(f.stateNode,w,D),Pg(f,D),pr!==4&&(pr=2)),!1;var N=Error(i(520),{cause:w});if(N=ai(N,p),Iu===null?Iu=[N]:Iu.push(N),pr!==4&&(pr=2),d===null)return!0;w=ai(w,p),p=d;do{switch(p.tag){case 3:return p.flags|=65536,f=D&-D,p.lanes|=f,f=lv(p.stateNode,w,f),Pg(p,f),!1;case 1:if(d=p.type,N=p.stateNode,(p.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Ja===null||!Ja.has(N))))return p.flags|=65536,D&=-D,p.lanes|=D,D=Dx(D),Rx(D,f,p,w),Pg(p,D),!1}p=p.return}while(p!==null);return!1}var uv=Error(i(461)),Dr=!1;function tn(f,d,p,w){d.child=f===null?FA(d,null,p,w):Zs(d,f.child,p,w)}function Bx(f,d,p,w,D){p=p.render;var N=d.ref;if("ref"in w){var z={};for(var Y in w)Y!=="ref"&&(z[Y]=w[Y])}else z=w;return Hs(d),w=Yg(f,d,p,z,N,D),Y=jg(),f!==null&&!Dr?(Hg(f,d,D),ua(f,d,D)):(St&&Y&&Sg(d),d.flags|=1,tn(f,d,w,D),d.child)}function Ix(f,d,p,w,D){if(f===null){var N=p.type;return typeof N=="function"&&!wg(N)&&N.defaultProps===void 0&&p.compare===null?(d.tag=15,d.type=N,Nx(f,d,N,w,D)):(f=zf(p.type,null,w,d,d.mode,D),f.ref=d.ref,f.return=d,d.child=f)}if(N=f.child,!pv(f,D)){var z=N.memoizedProps;if(p=p.compare,p=p!==null?p:uu,p(z,w)&&f.ref===d.ref)return ua(f,d,D)}return d.flags|=1,f=na(N,w),f.ref=d.ref,f.return=d,d.child=f}function Nx(f,d,p,w,D){if(f!==null){var N=f.memoizedProps;if(uu(N,w)&&f.ref===d.ref)if(Dr=!1,d.pendingProps=w=N,pv(f,D))(f.flags&131072)!==0&&(Dr=!0);else return d.lanes=f.lanes,ua(f,d,D)}return cv(f,d,p,w,D)}function Fx(f,d,p,w){var D=w.children,N=f!==null?f.memoizedState:null;if(f===null&&d.stateNode===null&&(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((d.flags&128)!==0){if(N=N!==null?N.baseLanes|p:p,f!==null){for(w=d.child=f.child,D=0;w!==null;)D=D|w.lanes|w.childLanes,w=w.sibling;w=D&~N}else w=0,d.child=null;return kx(f,d,N,p,w)}if((p&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},f!==null&&jf(d,N!==null?N.cachePool:null),N!==null?VA(d,N):_g(),OA(d);else return w=d.lanes=536870912,kx(f,d,N!==null?N.baseLanes|p:p,p,w)}else N!==null?(jf(d,N.cachePool),VA(d,N),Xa(),d.memoizedState=null):(f!==null&&jf(d,null),_g(),Xa());return tn(f,d,D,p),d.child}function Eu(f,d){return f!==null&&f.tag===22||d.stateNode!==null||(d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.sibling}function kx(f,d,p,w,D){var N=kg();return N=N===null?null:{parent:Tr._currentValue,pool:N},d.memoizedState={baseLanes:p,cachePool:N},f!==null&&jf(d,null),_g(),OA(d),f!==null&&Ko(f,d,w,!0),d.childLanes=D,null}function oh(f,d){return d=uh({mode:d.mode,children:d.children},f.mode),d.ref=f.ref,f.child=d,d.return=f,d}function Ux(f,d,p){return Zs(d,f.child,null,p),f=oh(d,d.pendingProps),f.flags|=2,Yn(d),d.memoizedState=null,f}function eD(f,d,p){var w=d.pendingProps,D=(d.flags&128)!==0;if(d.flags&=-129,f===null){if(St){if(w.mode==="hidden")return f=oh(d,w),d.lanes=536870912,Eu(null,f);if(Gg(d),(f=er)?(f=Kb(f,li),f=f!==null&&f.data==="&"?f:null,f!==null&&(d.memoizedState={dehydrated:f,treeContext:_a!==null?{id:Vi,overflow:Oi}:null,retryLane:536870912,hydrationErrors:null},p=yA(f),p.return=d,d.child=p,$r=d,er=null)):f=null,f===null)throw Ga(d);return d.lanes=536870912,null}return oh(d,w)}var N=f.memoizedState;if(N!==null){var z=N.dehydrated;if(Gg(d),D)if(d.flags&256)d.flags&=-257,d=Ux(f,d,p);else if(d.memoizedState!==null)d.child=f.child,d.flags|=128,d=null;else throw Error(i(558));else if(Dr||Ko(f,d,p,!1),D=(p&f.childLanes)!==0,Dr||D){if(w=Ht,w!==null&&(z=vr(w,p),z!==0&&z!==N.retryLane))throw N.retryLane=z,Gs(f,z),Nn(w,f,z),uv;yh(),d=Ux(f,d,p)}else f=N.treeContext,er=ci(z.nextSibling),$r=d,St=!0,za=null,li=!1,f!==null&&bA(d,f),d=oh(d,w),d.flags|=4096;return d}return f=na(f.child,{mode:w.mode,children:w.children}),f.ref=d.ref,d.child=f,f.return=d,f}function lh(f,d){var p=d.ref;if(p===null)f!==null&&f.ref!==null&&(d.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(i(284));(f===null||f.ref!==p)&&(d.flags|=4194816)}}function cv(f,d,p,w,D){return Hs(d),p=Yg(f,d,p,w,void 0,D),w=jg(),f!==null&&!Dr?(Hg(f,d,D),ua(f,d,D)):(St&&w&&Sg(d),d.flags|=1,tn(f,d,p,D),d.child)}function Vx(f,d,p,w,D,N){return Hs(d),d.updateQueue=null,p=LA(d,w,p,D),PA(f),w=jg(),f!==null&&!Dr?(Hg(f,d,N),ua(f,d,N)):(St&&w&&Sg(d),d.flags|=1,tn(f,d,p,N),d.child)}function Ox(f,d,p,w,D){if(Hs(d),d.stateNode===null){var N=qo,z=p.contextType;typeof z=="object"&&z!==null&&(N=en(z)),N=new p(w,N),d.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=ov,d.stateNode=N,N._reactInternals=d,N=d.stateNode,N.props=w,N.state=d.memoizedState,N.refs={},Vg(d),z=p.contextType,N.context=typeof z=="object"&&z!==null?en(z):qo,N.state=d.memoizedState,z=p.getDerivedStateFromProps,typeof z=="function"&&(sv(d,p,z,w),N.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(z=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),z!==N.state&&ov.enqueueReplaceState(N,N.state,null),Au(d,w,N,D),yu(),N.state=d.memoizedState),typeof N.componentDidMount=="function"&&(d.flags|=4194308),w=!0}else if(f===null){N=d.stateNode;var Y=d.memoizedProps,ee=Js(p,Y);N.props=ee;var de=N.context,Ae=p.contextType;z=qo,typeof Ae=="object"&&Ae!==null&&(z=en(Ae));var Ee=p.getDerivedStateFromProps;Ae=typeof Ee=="function"||typeof N.getSnapshotBeforeUpdate=="function",Y=d.pendingProps!==Y,Ae||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(Y||de!==z)&&Cx(d,N,w,z),Ya=!1;var ge=d.memoizedState;N.state=ge,Au(d,w,N,D),yu(),de=d.memoizedState,Y||ge!==de||Ya?(typeof Ee=="function"&&(sv(d,p,Ee,w),de=d.memoizedState),(ee=Ya||wx(d,p,ee,w,ge,de,z))?(Ae||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(d.flags|=4194308)):(typeof N.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=w,d.memoizedState=de),N.props=w,N.state=de,N.context=z,w=ee):(typeof N.componentDidMount=="function"&&(d.flags|=4194308),w=!1)}else{N=d.stateNode,Og(f,d),z=d.memoizedProps,Ae=Js(p,z),N.props=Ae,Ee=d.pendingProps,ge=N.context,de=p.contextType,ee=qo,typeof de=="object"&&de!==null&&(ee=en(de)),Y=p.getDerivedStateFromProps,(de=typeof Y=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(z!==Ee||ge!==ee)&&Cx(d,N,w,ee),Ya=!1,ge=d.memoizedState,N.state=ge,Au(d,w,N,D),yu();var ye=d.memoizedState;z!==Ee||ge!==ye||Ya||f!==null&&f.dependencies!==null&&qf(f.dependencies)?(typeof Y=="function"&&(sv(d,p,Y,w),ye=d.memoizedState),(Ae=Ya||wx(d,p,Ae,w,ge,ye,ee)||f!==null&&f.dependencies!==null&&qf(f.dependencies))?(de||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(w,ye,ee),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(w,ye,ee)),typeof N.componentDidUpdate=="function"&&(d.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof N.componentDidUpdate!="function"||z===f.memoizedProps&&ge===f.memoizedState||(d.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||z===f.memoizedProps&&ge===f.memoizedState||(d.flags|=1024),d.memoizedProps=w,d.memoizedState=ye),N.props=w,N.state=ye,N.context=ee,w=Ae):(typeof N.componentDidUpdate!="function"||z===f.memoizedProps&&ge===f.memoizedState||(d.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||z===f.memoizedProps&&ge===f.memoizedState||(d.flags|=1024),w=!1)}return N=w,lh(f,d),w=(d.flags&128)!==0,N||w?(N=d.stateNode,p=w&&typeof p.getDerivedStateFromError!="function"?null:N.render(),d.flags|=1,f!==null&&w?(d.child=Zs(d,f.child,null,D),d.child=Zs(d,null,p,D)):tn(f,d,p,D),d.memoizedState=N.state,f=d.child):f=ua(f,d,D),f}function Px(f,d,p,w){return Ys(),d.flags|=256,tn(f,d,p,w),d.child}var fv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hv(f){return{baseLanes:f,cachePool:MA()}}function dv(f,d,p){return f=f!==null?f.childLanes&~p:0,d&&(f|=Hn),f}function Lx(f,d,p){var w=d.pendingProps,D=!1,N=(d.flags&128)!==0,z;if((z=N)||(z=f!==null&&f.memoizedState===null?!1:(wr.current&2)!==0),z&&(D=!0,d.flags&=-129),z=(d.flags&32)!==0,d.flags&=-33,f===null){if(St){if(D?Ka(d):Xa(),(f=er)?(f=Kb(f,li),f=f!==null&&f.data!=="&"?f:null,f!==null&&(d.memoizedState={dehydrated:f,treeContext:_a!==null?{id:Vi,overflow:Oi}:null,retryLane:536870912,hydrationErrors:null},p=yA(f),p.return=d,d.child=p,$r=d,er=null)):f=null,f===null)throw Ga(d);return Qv(f)?d.lanes=32:d.lanes=536870912,null}var Y=w.children;return w=w.fallback,D?(Xa(),D=d.mode,Y=uh({mode:"hidden",children:Y},D),w=qs(w,D,p,null),Y.return=d,w.return=d,Y.sibling=w,d.child=Y,w=d.child,w.memoizedState=hv(p),w.childLanes=dv(f,z,p),d.memoizedState=fv,Eu(null,w)):(Ka(d),gv(d,Y))}var ee=f.memoizedState;if(ee!==null&&(Y=ee.dehydrated,Y!==null)){if(N)d.flags&256?(Ka(d),d.flags&=-257,d=vv(f,d,p)):d.memoizedState!==null?(Xa(),d.child=f.child,d.flags|=128,d=null):(Xa(),Y=w.fallback,D=d.mode,w=uh({mode:"visible",children:w.children},D),Y=qs(Y,D,p,null),Y.flags|=2,w.return=d,Y.return=d,w.sibling=Y,d.child=w,Zs(d,f.child,null,p),w=d.child,w.memoizedState=hv(p),w.childLanes=dv(f,z,p),d.memoizedState=fv,d=Eu(null,w));else if(Ka(d),Qv(Y)){if(z=Y.nextSibling&&Y.nextSibling.dataset,z)var de=z.dgst;z=de,w=Error(i(419)),w.stack="",w.digest=z,hu({value:w,source:null,stack:null}),d=vv(f,d,p)}else if(Dr||Ko(f,d,p,!1),z=(p&f.childLanes)!==0,Dr||z){if(z=Ht,z!==null&&(w=vr(z,p),w!==0&&w!==ee.retryLane))throw ee.retryLane=w,Gs(f,w),Nn(z,f,w),uv;Xv(Y)||yh(),d=vv(f,d,p)}else Xv(Y)?(d.flags|=192,d.child=f.child,d=null):(f=ee.treeContext,er=ci(Y.nextSibling),$r=d,St=!0,za=null,li=!1,f!==null&&bA(d,f),d=gv(d,w.children),d.flags|=4096);return d}return D?(Xa(),Y=w.fallback,D=d.mode,ee=f.child,de=ee.sibling,w=na(ee,{mode:"hidden",children:w.children}),w.subtreeFlags=ee.subtreeFlags&65011712,de!==null?Y=na(de,Y):(Y=qs(Y,D,p,null),Y.flags|=2),Y.return=d,w.return=d,w.sibling=Y,d.child=w,Eu(null,w),w=d.child,Y=f.child.memoizedState,Y===null?Y=hv(p):(D=Y.cachePool,D!==null?(ee=Tr._currentValue,D=D.parent!==ee?{parent:ee,pool:ee}:D):D=MA(),Y={baseLanes:Y.baseLanes|p,cachePool:D}),w.memoizedState=Y,w.childLanes=dv(f,z,p),d.memoizedState=fv,Eu(f.child,w)):(Ka(d),p=f.child,f=p.sibling,p=na(p,{mode:"visible",children:w.children}),p.return=d,p.sibling=null,f!==null&&(z=d.deletions,z===null?(d.deletions=[f],d.flags|=16):z.push(f)),d.child=p,d.memoizedState=null,p)}function gv(f,d){return d=uh({mode:"visible",children:d},f.mode),d.return=f,f.child=d}function uh(f,d){return f=Gn(22,f,null,d),f.lanes=0,f}function vv(f,d,p){return Zs(d,f.child,null,p),f=gv(d,d.pendingProps.children),f.flags|=2,d.memoizedState=null,f}function _x(f,d,p){f.lanes|=d;var w=f.alternate;w!==null&&(w.lanes|=d),Bg(f.return,d,p)}function mv(f,d,p,w,D,N){var z=f.memoizedState;z===null?f.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:D,treeForkCount:N}:(z.isBackwards=d,z.rendering=null,z.renderingStartTime=0,z.last=w,z.tail=p,z.tailMode=D,z.treeForkCount=N)}function zx(f,d,p){var w=d.pendingProps,D=w.revealOrder,N=w.tail;w=w.children;var z=wr.current,Y=(z&2)!==0;if(Y?(z=z&1|2,d.flags|=128):z&=1,$(wr,z),tn(f,d,w,p),w=St?fu:0,!Y&&f!==null&&(f.flags&128)!==0)e:for(f=d.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&_x(f,p,d);else if(f.tag===19)_x(f,p,d);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===d)break e;for(;f.sibling===null;){if(f.return===null||f.return===d)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}switch(D){case"forwards":for(p=d.child,D=null;p!==null;)f=p.alternate,f!==null&&Wf(f)===null&&(D=p),p=p.sibling;p=D,p===null?(D=d.child,d.child=null):(D=p.sibling,p.sibling=null),mv(d,!1,D,p,N,w);break;case"backwards":case"unstable_legacy-backwards":for(p=null,D=d.child,d.child=null;D!==null;){if(f=D.alternate,f!==null&&Wf(f)===null){d.child=D;break}f=D.sibling,D.sibling=p,p=D,D=f}mv(d,!0,p,null,N,w);break;case"together":mv(d,!1,null,null,void 0,w);break;default:d.memoizedState=null}return d.child}function ua(f,d,p){if(f!==null&&(d.dependencies=f.dependencies),Wa|=d.lanes,(p&d.childLanes)===0)if(f!==null){if(Ko(f,d,p,!1),(p&d.childLanes)===0)return null}else return null;if(f!==null&&d.child!==f.child)throw Error(i(153));if(d.child!==null){for(f=d.child,p=na(f,f.pendingProps),d.child=p,p.return=d;f.sibling!==null;)f=f.sibling,p=p.sibling=na(f,f.pendingProps),p.return=d;p.sibling=null}return d.child}function pv(f,d){return(f.lanes&d)!==0?!0:(f=f.dependencies,!!(f!==null&&qf(f)))}function tD(f,d,p){switch(d.tag){case 3:ve(d,d.stateNode.containerInfo),qa(d,Tr,f.memoizedState.cache),Ys();break;case 27:case 5:ie(d);break;case 4:ve(d,d.stateNode.containerInfo);break;case 10:qa(d,d.type,d.memoizedProps.value);break;case 31:if(d.memoizedState!==null)return d.flags|=128,Gg(d),null;break;case 13:var w=d.memoizedState;if(w!==null)return w.dehydrated!==null?(Ka(d),d.flags|=128,null):(p&d.child.childLanes)!==0?Lx(f,d,p):(Ka(d),f=ua(f,d,p),f!==null?f.sibling:null);Ka(d);break;case 19:var D=(f.flags&128)!==0;if(w=(p&d.childLanes)!==0,w||(Ko(f,d,p,!1),w=(p&d.childLanes)!==0),D){if(w)return zx(f,d,p);d.flags|=128}if(D=d.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),$(wr,wr.current),w)break;return null;case 22:return d.lanes=0,Fx(f,d,p,d.pendingProps);case 24:qa(d,Tr,f.memoizedState.cache)}return ua(f,d,p)}function Gx(f,d,p){if(f!==null)if(f.memoizedProps!==d.pendingProps)Dr=!0;else{if(!pv(f,p)&&(d.flags&128)===0)return Dr=!1,tD(f,d,p);Dr=(f.flags&131072)!==0}else Dr=!1,St&&(d.flags&1048576)!==0&&xA(d,fu,d.index);switch(d.lanes=0,d.tag){case 16:e:{var w=d.pendingProps;if(f=Xs(d.elementType),d.type=f,typeof f=="function")wg(f)?(w=Js(f,w),d.tag=1,d=Ox(null,d,f,w,p)):(d.tag=0,d=cv(null,d,f,w,p));else{if(f!=null){var D=f.$$typeof;if(D===S){d.tag=11,d=Bx(null,d,f,w,p);break e}else if(D===T){d.tag=14,d=Ix(null,d,f,w,p);break e}}throw d=V(f)||f,Error(i(306,d,""))}}return d;case 0:return cv(f,d,d.type,d.pendingProps,p);case 1:return w=d.type,D=Js(w,d.pendingProps),Ox(f,d,w,D,p);case 3:e:{if(ve(d,d.stateNode.containerInfo),f===null)throw Error(i(387));w=d.pendingProps;var N=d.memoizedState;D=N.element,Og(f,d),Au(d,w,null,p);var z=d.memoizedState;if(w=z.cache,qa(d,Tr,w),w!==N.cache&&Ig(d,[Tr],p,!0),yu(),w=z.element,N.isDehydrated)if(N={element:w,isDehydrated:!1,cache:z.cache},d.updateQueue.baseState=N,d.memoizedState=N,d.flags&256){d=Px(f,d,w,p);break e}else if(w!==D){D=ai(Error(i(424)),d),hu(D),d=Px(f,d,w,p);break e}else{switch(f=d.stateNode.containerInfo,f.nodeType){case 9:f=f.body;break;default:f=f.nodeName==="HTML"?f.ownerDocument.body:f}for(er=ci(f.firstChild),$r=d,St=!0,za=null,li=!0,p=FA(d,null,w,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Ys(),w===D){d=ua(f,d,p);break e}tn(f,d,w,p)}d=d.child}return d;case 26:return lh(f,d),f===null?(p=$b(d.type,null,d.pendingProps,null))?d.memoizedState=p:St||(p=d.type,f=d.pendingProps,w=Sh(ue.current).createElement(p),w[ar]=d,w[Nr]=f,rn(w,p,f),Sr(w),d.stateNode=w):d.memoizedState=$b(d.type,f.memoizedProps,d.pendingProps,f.memoizedState),null;case 27:return ie(d),f===null&&St&&(w=d.stateNode=Zb(d.type,d.pendingProps,ue.current),$r=d,li=!0,D=er,rs(d.type)?(Zv=D,er=ci(w.firstChild)):er=D),tn(f,d,d.pendingProps.children,p),lh(f,d),f===null&&(d.flags|=4194304),d.child;case 5:return f===null&&St&&((D=w=er)&&(w=ID(w,d.type,d.pendingProps,li),w!==null?(d.stateNode=w,$r=d,er=ci(w.firstChild),li=!1,D=!0):D=!1),D||Ga(d)),ie(d),D=d.type,N=d.pendingProps,z=f!==null?f.memoizedProps:null,w=N.children,jv(D,N)?w=null:z!==null&&jv(D,z)&&(d.flags|=32),d.memoizedState!==null&&(D=Yg(f,d,HM,null,null,p),Lu._currentValue=D),lh(f,d),tn(f,d,w,p),d.child;case 6:return f===null&&St&&((f=p=er)&&(p=ND(p,d.pendingProps,li),p!==null?(d.stateNode=p,$r=d,er=null,f=!0):f=!1),f||Ga(d)),null;case 13:return Lx(f,d,p);case 4:return ve(d,d.stateNode.containerInfo),w=d.pendingProps,f===null?d.child=Zs(d,null,w,p):tn(f,d,w,p),d.child;case 11:return Bx(f,d,d.type,d.pendingProps,p);case 7:return tn(f,d,d.pendingProps,p),d.child;case 8:return tn(f,d,d.pendingProps.children,p),d.child;case 12:return tn(f,d,d.pendingProps.children,p),d.child;case 10:return w=d.pendingProps,qa(d,d.type,w.value),tn(f,d,w.children,p),d.child;case 9:return D=d.type._context,w=d.pendingProps.children,Hs(d),D=en(D),w=w(D),d.flags|=1,tn(f,d,w,p),d.child;case 14:return Ix(f,d,d.type,d.pendingProps,p);case 15:return Nx(f,d,d.type,d.pendingProps,p);case 19:return zx(f,d,p);case 31:return eD(f,d,p);case 22:return Fx(f,d,p,d.pendingProps);case 24:return Hs(d),w=en(Tr),f===null?(D=kg(),D===null&&(D=Ht,N=Ng(),D.pooledCache=N,N.refCount++,N!==null&&(D.pooledCacheLanes|=p),D=N),d.memoizedState={parent:w,cache:D},Vg(d),qa(d,Tr,D)):((f.lanes&p)!==0&&(Og(f,d),Au(d,null,null,p),yu()),D=f.memoizedState,N=d.memoizedState,D.parent!==w?(D={parent:w,cache:w},d.memoizedState=D,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=D),qa(d,Tr,w)):(w=N.cache,qa(d,Tr,w),w!==D.cache&&Ig(d,[Tr],p,!0))),tn(f,d,d.pendingProps.children,p),d.child;case 29:throw d.pendingProps}throw Error(i(156,d.tag))}function ca(f){f.flags|=4}function yv(f,d,p,w,D){if((d=(f.mode&32)!==0)&&(d=!1),d){if(f.flags|=16777216,(D&335544128)===D)if(f.stateNode.complete)f.flags|=8192;else if(vb())f.flags|=8192;else throw Qs=Kf,Ug}else f.flags&=-16777217}function qx(f,d){if(d.type!=="stylesheet"||(d.state.loading&4)!==0)f.flags&=-16777217;else if(f.flags|=16777216,!i5(d))if(vb())f.flags|=8192;else throw Qs=Kf,Ug}function ch(f,d){d!==null&&(f.flags|=4),f.flags&16384&&(d=f.tag!==22?ht():536870912,f.lanes|=d,al|=d)}function Su(f,d){if(!St)switch(f.tailMode){case"hidden":d=f.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?f.tail=null:p.sibling=null;break;case"collapsed":p=f.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?d||f.tail===null?f.tail=null:f.tail.sibling=null:w.sibling=null}}function tr(f){var d=f.alternate!==null&&f.alternate.child===f.child,p=0,w=0;if(d)for(var D=f.child;D!==null;)p|=D.lanes|D.childLanes,w|=D.subtreeFlags&65011712,w|=D.flags&65011712,D.return=f,D=D.sibling;else for(D=f.child;D!==null;)p|=D.lanes|D.childLanes,w|=D.subtreeFlags,w|=D.flags,D.return=f,D=D.sibling;return f.subtreeFlags|=w,f.childLanes=p,d}function rD(f,d,p){var w=d.pendingProps;switch(Tg(d),d.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tr(d),null;case 1:return tr(d),null;case 3:return p=d.stateNode,w=null,f!==null&&(w=f.memoizedState.cache),d.memoizedState.cache!==w&&(d.flags|=2048),sa(Tr),le(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(f===null||f.child===null)&&(Ho(d)?ca(d):f===null||f.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Dg())),tr(d),null;case 26:var D=d.type,N=d.memoizedState;return f===null?(ca(d),N!==null?(tr(d),qx(d,N)):(tr(d),yv(d,D,null,w,p))):N?N!==f.memoizedState?(ca(d),tr(d),qx(d,N)):(tr(d),d.flags&=-16777217):(f=f.memoizedProps,f!==w&&ca(d),tr(d),yv(d,D,f,w,p)),null;case 27:if(se(d),p=ue.current,D=d.type,f!==null&&d.stateNode!=null)f.memoizedProps!==w&&ca(d);else{if(!w){if(d.stateNode===null)throw Error(i(166));return tr(d),null}f=te.current,Ho(d)?wA(d):(f=Zb(D,w,p),d.stateNode=f,ca(d))}return tr(d),null;case 5:if(se(d),D=d.type,f!==null&&d.stateNode!=null)f.memoizedProps!==w&&ca(d);else{if(!w){if(d.stateNode===null)throw Error(i(166));return tr(d),null}if(N=te.current,Ho(d))wA(d);else{var z=Sh(ue.current);switch(N){case 1:N=z.createElementNS("http://www.w3.org/2000/svg",D);break;case 2:N=z.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;default:switch(D){case"svg":N=z.createElementNS("http://www.w3.org/2000/svg",D);break;case"math":N=z.createElementNS("http://www.w3.org/1998/Math/MathML",D);break;case"script":N=z.createElement("div"),N.innerHTML="<script><\/script>",N=N.removeChild(N.firstChild);break;case"select":N=typeof w.is=="string"?z.createElement("select",{is:w.is}):z.createElement("select"),w.multiple?N.multiple=!0:w.size&&(N.size=w.size);break;default:N=typeof w.is=="string"?z.createElement(D,{is:w.is}):z.createElement(D)}}N[ar]=d,N[Nr]=w;e:for(z=d.child;z!==null;){if(z.tag===5||z.tag===6)N.appendChild(z.stateNode);else if(z.tag!==4&&z.tag!==27&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===d)break e;for(;z.sibling===null;){if(z.return===null||z.return===d)break e;z=z.return}z.sibling.return=z.return,z=z.sibling}d.stateNode=N;e:switch(rn(N,D,w),D){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}w&&ca(d)}}return tr(d),yv(d,d.type,f===null?null:f.memoizedProps,d.pendingProps,p),null;case 6:if(f&&d.stateNode!=null)f.memoizedProps!==w&&ca(d);else{if(typeof w!="string"&&d.stateNode===null)throw Error(i(166));if(f=ue.current,Ho(d)){if(f=d.stateNode,p=d.memoizedProps,w=null,D=$r,D!==null)switch(D.tag){case 27:case 5:w=D.memoizedProps}f[ar]=d,f=!!(f.nodeValue===p||w!==null&&w.suppressHydrationWarning===!0||Lb(f.nodeValue,p)),f||Ga(d,!0)}else f=Sh(f).createTextNode(w),f[ar]=d,d.stateNode=f}return tr(d),null;case 31:if(p=d.memoizedState,f===null||f.memoizedState!==null){if(w=Ho(d),p!==null){if(f===null){if(!w)throw Error(i(318));if(f=d.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(557));f[ar]=d}else Ys(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;tr(d),f=!1}else p=Dg(),f!==null&&f.memoizedState!==null&&(f.memoizedState.hydrationErrors=p),f=!0;if(!f)return d.flags&256?(Yn(d),d):(Yn(d),null);if((d.flags&128)!==0)throw Error(i(558))}return tr(d),null;case 13:if(w=d.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(D=Ho(d),w!==null&&w.dehydrated!==null){if(f===null){if(!D)throw Error(i(318));if(D=d.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(i(317));D[ar]=d}else Ys(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;tr(d),D=!1}else D=Dg(),f!==null&&f.memoizedState!==null&&(f.memoizedState.hydrationErrors=D),D=!0;if(!D)return d.flags&256?(Yn(d),d):(Yn(d),null)}return Yn(d),(d.flags&128)!==0?(d.lanes=p,d):(p=w!==null,f=f!==null&&f.memoizedState!==null,p&&(w=d.child,D=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(D=w.alternate.memoizedState.cachePool.pool),N=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(N=w.memoizedState.cachePool.pool),N!==D&&(w.flags|=2048)),p!==f&&p&&(d.child.flags|=8192),ch(d,d.updateQueue),tr(d),null);case 4:return le(),f===null&&_v(d.stateNode.containerInfo),tr(d),null;case 10:return sa(d.type),tr(d),null;case 19:if(K(wr),w=d.memoizedState,w===null)return tr(d),null;if(D=(d.flags&128)!==0,N=w.rendering,N===null)if(D)Su(w,!1);else{if(pr!==0||f!==null&&(f.flags&128)!==0)for(f=d.child;f!==null;){if(N=Wf(f),N!==null){for(d.flags|=128,Su(w,!1),f=N.updateQueue,d.updateQueue=f,ch(d,f),d.subtreeFlags=0,f=p,p=d.child;p!==null;)pA(p,f),p=p.sibling;return $(wr,wr.current&1|2),St&&ia(d,w.treeForkCount),d.child}f=f.sibling}w.tail!==null&&ke()>vh&&(d.flags|=128,D=!0,Su(w,!1),d.lanes=4194304)}else{if(!D)if(f=Wf(N),f!==null){if(d.flags|=128,D=!0,f=f.updateQueue,d.updateQueue=f,ch(d,f),Su(w,!0),w.tail===null&&w.tailMode==="hidden"&&!N.alternate&&!St)return tr(d),null}else 2*ke()-w.renderingStartTime>vh&&p!==536870912&&(d.flags|=128,D=!0,Su(w,!1),d.lanes=4194304);w.isBackwards?(N.sibling=d.child,d.child=N):(f=w.last,f!==null?f.sibling=N:d.child=N,w.last=N)}return w.tail!==null?(f=w.tail,w.rendering=f,w.tail=f.sibling,w.renderingStartTime=ke(),f.sibling=null,p=wr.current,$(wr,D?p&1|2:p&1),St&&ia(d,w.treeForkCount),f):(tr(d),null);case 22:case 23:return Yn(d),zg(),w=d.memoizedState!==null,f!==null?f.memoizedState!==null!==w&&(d.flags|=8192):w&&(d.flags|=8192),w?(p&536870912)!==0&&(d.flags&128)===0&&(tr(d),d.subtreeFlags&6&&(d.flags|=8192)):tr(d),p=d.updateQueue,p!==null&&ch(d,p.retryQueue),p=null,f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(p=f.memoizedState.cachePool.pool),w=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(w=d.memoizedState.cachePool.pool),w!==p&&(d.flags|=2048),f!==null&&K(Ks),null;case 24:return p=null,f!==null&&(p=f.memoizedState.cache),d.memoizedState.cache!==p&&(d.flags|=2048),sa(Tr),tr(d),null;case 25:return null;case 30:return null}throw Error(i(156,d.tag))}function nD(f,d){switch(Tg(d),d.tag){case 1:return f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 3:return sa(Tr),le(),f=d.flags,(f&65536)!==0&&(f&128)===0?(d.flags=f&-65537|128,d):null;case 26:case 27:case 5:return se(d),null;case 31:if(d.memoizedState!==null){if(Yn(d),d.alternate===null)throw Error(i(340));Ys()}return f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 13:if(Yn(d),f=d.memoizedState,f!==null&&f.dehydrated!==null){if(d.alternate===null)throw Error(i(340));Ys()}return f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 19:return K(wr),null;case 4:return le(),null;case 10:return sa(d.type),null;case 22:case 23:return Yn(d),zg(),f!==null&&K(Ks),f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 24:return sa(Tr),null;case 25:return null;default:return null}}function Yx(f,d){switch(Tg(d),d.tag){case 3:sa(Tr),le();break;case 26:case 27:case 5:se(d);break;case 4:le();break;case 31:d.memoizedState!==null&&Yn(d);break;case 13:Yn(d);break;case 19:K(wr);break;case 10:sa(d.type);break;case 22:case 23:Yn(d),zg(),f!==null&&K(Ks);break;case 24:sa(Tr)}}function Tu(f,d){try{var p=d.updateQueue,w=p!==null?p.lastEffect:null;if(w!==null){var D=w.next;p=D;do{if((p.tag&f)===f){w=void 0;var N=p.create,z=p.inst;w=N(),z.destroy=w}p=p.next}while(p!==D)}}catch(Y){_t(d,d.return,Y)}}function Qa(f,d,p){try{var w=d.updateQueue,D=w!==null?w.lastEffect:null;if(D!==null){var N=D.next;w=N;do{if((w.tag&f)===f){var z=w.inst,Y=z.destroy;if(Y!==void 0){z.destroy=void 0,D=d;var ee=p,de=Y;try{de()}catch(Ae){_t(D,ee,Ae)}}}w=w.next}while(w!==N)}}catch(Ae){_t(d,d.return,Ae)}}function jx(f){var d=f.updateQueue;if(d!==null){var p=f.stateNode;try{UA(d,p)}catch(w){_t(f,f.return,w)}}}function Hx(f,d,p){p.props=Js(f.type,f.memoizedProps),p.state=f.memoizedState;try{p.componentWillUnmount()}catch(w){_t(f,d,w)}}function Mu(f,d){try{var p=f.ref;if(p!==null){switch(f.tag){case 26:case 27:case 5:var w=f.stateNode;break;case 30:w=f.stateNode;break;default:w=f.stateNode}typeof p=="function"?f.refCleanup=p(w):p.current=w}}catch(D){_t(f,d,D)}}function Pi(f,d){var p=f.ref,w=f.refCleanup;if(p!==null)if(typeof w=="function")try{w()}catch(D){_t(f,d,D)}finally{f.refCleanup=null,f=f.alternate,f!=null&&(f.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(D){_t(f,d,D)}else p.current=null}function Kx(f){var d=f.type,p=f.memoizedProps,w=f.stateNode;try{e:switch(d){case"button":case"input":case"select":case"textarea":p.autoFocus&&w.focus();break e;case"img":p.src?w.src=p.src:p.srcSet&&(w.srcset=p.srcSet)}}catch(D){_t(f,f.return,D)}}function Av(f,d,p){try{var w=f.stateNode;SD(w,f.type,p,d),w[Nr]=d}catch(D){_t(f,f.return,D)}}function Xx(f){return f.tag===5||f.tag===3||f.tag===26||f.tag===27&&rs(f.type)||f.tag===4}function xv(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||Xx(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.tag===27&&rs(f.type)||f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function bv(f,d,p){var w=f.tag;if(w===5||w===6)f=f.stateNode,d?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(f,d):(d=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,d.appendChild(f),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=ta));else if(w!==4&&(w===27&&rs(f.type)&&(p=f.stateNode,d=null),f=f.child,f!==null))for(bv(f,d,p),f=f.sibling;f!==null;)bv(f,d,p),f=f.sibling}function fh(f,d,p){var w=f.tag;if(w===5||w===6)f=f.stateNode,d?p.insertBefore(f,d):p.appendChild(f);else if(w!==4&&(w===27&&rs(f.type)&&(p=f.stateNode),f=f.child,f!==null))for(fh(f,d,p),f=f.sibling;f!==null;)fh(f,d,p),f=f.sibling}function Qx(f){var d=f.stateNode,p=f.memoizedProps;try{for(var w=f.type,D=d.attributes;D.length;)d.removeAttributeNode(D[0]);rn(d,w,p),d[ar]=f,d[Nr]=p}catch(N){_t(f,f.return,N)}}var fa=!1,Rr=!1,wv=!1,Zx=typeof WeakSet=="function"?WeakSet:Set,Yr=null;function iD(f,d){if(f=f.containerInfo,qv=Nh,f=lA(f),vg(f)){if("selectionStart"in f)var p={start:f.selectionStart,end:f.selectionEnd};else e:{p=(p=f.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var D=w.anchorOffset,N=w.focusNode;w=w.focusOffset;try{p.nodeType,N.nodeType}catch{p=null;break e}var z=0,Y=-1,ee=-1,de=0,Ae=0,Ee=f,ge=null;t:for(;;){for(var ye;Ee!==p||D!==0&&Ee.nodeType!==3||(Y=z+D),Ee!==N||w!==0&&Ee.nodeType!==3||(ee=z+w),Ee.nodeType===3&&(z+=Ee.nodeValue.length),(ye=Ee.firstChild)!==null;)ge=Ee,Ee=ye;for(;;){if(Ee===f)break t;if(ge===p&&++de===D&&(Y=z),ge===N&&++Ae===w&&(ee=z),(ye=Ee.nextSibling)!==null)break;Ee=ge,ge=Ee.parentNode}Ee=ye}p=Y===-1||ee===-1?null:{start:Y,end:ee}}else p=null}p=p||{start:0,end:0}}else p=null;for(Yv={focusedElem:f,selectionRange:p},Nh=!1,Yr=d;Yr!==null;)if(d=Yr,f=d.child,(d.subtreeFlags&1028)!==0&&f!==null)f.return=d,Yr=f;else for(;Yr!==null;){switch(d=Yr,N=d.alternate,f=d.flags,d.tag){case 0:if((f&4)!==0&&(f=d.updateQueue,f=f!==null?f.events:null,f!==null))for(p=0;p<f.length;p++)D=f[p],D.ref.impl=D.nextImpl;break;case 11:case 15:break;case 1:if((f&1024)!==0&&N!==null){f=void 0,p=d,D=N.memoizedProps,N=N.memoizedState,w=p.stateNode;try{var _e=Js(p.type,D);f=w.getSnapshotBeforeUpdate(_e,N),w.__reactInternalSnapshotBeforeUpdate=f}catch(tt){_t(p,p.return,tt)}}break;case 3:if((f&1024)!==0){if(f=d.stateNode.containerInfo,p=f.nodeType,p===9)Kv(f);else if(p===1)switch(f.nodeName){case"HEAD":case"HTML":case"BODY":Kv(f);break;default:f.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(i(163))}if(f=d.sibling,f!==null){f.return=d.return,Yr=f;break}Yr=d.return}}function Wx(f,d,p){var w=p.flags;switch(p.tag){case 0:case 11:case 15:da(f,p),w&4&&Tu(5,p);break;case 1:if(da(f,p),w&4)if(f=p.stateNode,d===null)try{f.componentDidMount()}catch(z){_t(p,p.return,z)}else{var D=Js(p.type,d.memoizedProps);d=d.memoizedState;try{f.componentDidUpdate(D,d,f.__reactInternalSnapshotBeforeUpdate)}catch(z){_t(p,p.return,z)}}w&64&&jx(p),w&512&&Mu(p,p.return);break;case 3:if(da(f,p),w&64&&(f=p.updateQueue,f!==null)){if(d=null,p.child!==null)switch(p.child.tag){case 27:case 5:d=p.child.stateNode;break;case 1:d=p.child.stateNode}try{UA(f,d)}catch(z){_t(p,p.return,z)}}break;case 27:d===null&&w&4&&Qx(p);case 26:case 5:da(f,p),d===null&&w&4&&Kx(p),w&512&&Mu(p,p.return);break;case 12:da(f,p);break;case 31:da(f,p),w&4&&eb(f,p);break;case 13:da(f,p),w&4&&tb(f,p),w&64&&(f=p.memoizedState,f!==null&&(f=f.dehydrated,f!==null&&(p=dD.bind(null,p),FD(f,p))));break;case 22:if(w=p.memoizedState!==null||fa,!w){d=d!==null&&d.memoizedState!==null||Rr,D=fa;var N=Rr;fa=w,(Rr=d)&&!N?ga(f,p,(p.subtreeFlags&8772)!==0):da(f,p),fa=D,Rr=N}break;case 30:break;default:da(f,p)}}function Jx(f){var d=f.alternate;d!==null&&(f.alternate=null,Jx(d)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(d=f.stateNode,d!==null&&Fo(d)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}var sr=null,Dn=!1;function ha(f,d,p){for(p=p.child;p!==null;)$x(f,d,p),p=p.sibling}function $x(f,d,p){if(ce&&typeof ce.onCommitFiberUnmount=="function")try{ce.onCommitFiberUnmount(X,p)}catch{}switch(p.tag){case 26:Rr||Pi(p,d),ha(f,d,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Rr||Pi(p,d);var w=sr,D=Dn;rs(p.type)&&(sr=p.stateNode,Dn=!1),ha(f,d,p),Vu(p.stateNode),sr=w,Dn=D;break;case 5:Rr||Pi(p,d);case 6:if(w=sr,D=Dn,sr=null,ha(f,d,p),sr=w,Dn=D,sr!==null)if(Dn)try{(sr.nodeType===9?sr.body:sr.nodeName==="HTML"?sr.ownerDocument.body:sr).removeChild(p.stateNode)}catch(N){_t(p,d,N)}else try{sr.removeChild(p.stateNode)}catch(N){_t(p,d,N)}break;case 18:sr!==null&&(Dn?(f=sr,jb(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,p.stateNode),dl(f)):jb(sr,p.stateNode));break;case 4:w=sr,D=Dn,sr=p.stateNode.containerInfo,Dn=!0,ha(f,d,p),sr=w,Dn=D;break;case 0:case 11:case 14:case 15:Qa(2,p,d),Rr||Qa(4,p,d),ha(f,d,p);break;case 1:Rr||(Pi(p,d),w=p.stateNode,typeof w.componentWillUnmount=="function"&&Hx(p,d,w)),ha(f,d,p);break;case 21:ha(f,d,p);break;case 22:Rr=(w=Rr)||p.memoizedState!==null,ha(f,d,p),Rr=w;break;default:ha(f,d,p)}}function eb(f,d){if(d.memoizedState===null&&(f=d.alternate,f!==null&&(f=f.memoizedState,f!==null))){f=f.dehydrated;try{dl(f)}catch(p){_t(d,d.return,p)}}}function tb(f,d){if(d.memoizedState===null&&(f=d.alternate,f!==null&&(f=f.memoizedState,f!==null&&(f=f.dehydrated,f!==null))))try{dl(f)}catch(p){_t(d,d.return,p)}}function aD(f){switch(f.tag){case 31:case 13:case 19:var d=f.stateNode;return d===null&&(d=f.stateNode=new Zx),d;case 22:return f=f.stateNode,d=f._retryCache,d===null&&(d=f._retryCache=new Zx),d;default:throw Error(i(435,f.tag))}}function hh(f,d){var p=aD(f);d.forEach(function(w){if(!p.has(w)){p.add(w);var D=gD.bind(null,f,w);w.then(D,D)}})}function Rn(f,d){var p=d.deletions;if(p!==null)for(var w=0;w<p.length;w++){var D=p[w],N=f,z=d,Y=z;e:for(;Y!==null;){switch(Y.tag){case 27:if(rs(Y.type)){sr=Y.stateNode,Dn=!1;break e}break;case 5:sr=Y.stateNode,Dn=!1;break e;case 3:case 4:sr=Y.stateNode.containerInfo,Dn=!0;break e}Y=Y.return}if(sr===null)throw Error(i(160));$x(N,z,D),sr=null,Dn=!1,N=D.alternate,N!==null&&(N.return=null),D.return=null}if(d.subtreeFlags&13886)for(d=d.child;d!==null;)rb(d,f),d=d.sibling}var bi=null;function rb(f,d){var p=f.alternate,w=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:Rn(d,f),Bn(f),w&4&&(Qa(3,f,f.return),Tu(3,f),Qa(5,f,f.return));break;case 1:Rn(d,f),Bn(f),w&512&&(Rr||p===null||Pi(p,p.return)),w&64&&fa&&(f=f.updateQueue,f!==null&&(w=f.callbacks,w!==null&&(p=f.shared.hiddenCallbacks,f.shared.hiddenCallbacks=p===null?w:p.concat(w))));break;case 26:var D=bi;if(Rn(d,f),Bn(f),w&512&&(Rr||p===null||Pi(p,p.return)),w&4){var N=p!==null?p.memoizedState:null;if(w=f.memoizedState,p===null)if(w===null)if(f.stateNode===null){e:{w=f.type,p=f.memoizedProps,D=D.ownerDocument||D;t:switch(w){case"title":N=D.getElementsByTagName("title")[0],(!N||N[Gr]||N[ar]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=D.createElement(w),D.head.insertBefore(N,D.querySelector("head > title"))),rn(N,w,p),N[ar]=f,Sr(N),w=N;break e;case"link":var z=r5("link","href",D).get(w+(p.href||""));if(z){for(var Y=0;Y<z.length;Y++)if(N=z[Y],N.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&N.getAttribute("rel")===(p.rel==null?null:p.rel)&&N.getAttribute("title")===(p.title==null?null:p.title)&&N.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){z.splice(Y,1);break t}}N=D.createElement(w),rn(N,w,p),D.head.appendChild(N);break;case"meta":if(z=r5("meta","content",D).get(w+(p.content||""))){for(Y=0;Y<z.length;Y++)if(N=z[Y],N.getAttribute("content")===(p.content==null?null:""+p.content)&&N.getAttribute("name")===(p.name==null?null:p.name)&&N.getAttribute("property")===(p.property==null?null:p.property)&&N.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&N.getAttribute("charset")===(p.charSet==null?null:p.charSet)){z.splice(Y,1);break t}}N=D.createElement(w),rn(N,w,p),D.head.appendChild(N);break;default:throw Error(i(468,w))}N[ar]=f,Sr(N),w=N}f.stateNode=w}else n5(D,f.type,f.stateNode);else f.stateNode=t5(D,w,f.memoizedProps);else N!==w?(N===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):N.count--,w===null?n5(D,f.type,f.stateNode):t5(D,w,f.memoizedProps)):w===null&&f.stateNode!==null&&Av(f,f.memoizedProps,p.memoizedProps)}break;case 27:Rn(d,f),Bn(f),w&512&&(Rr||p===null||Pi(p,p.return)),p!==null&&w&4&&Av(f,f.memoizedProps,p.memoizedProps);break;case 5:if(Rn(d,f),Bn(f),w&512&&(Rr||p===null||Pi(p,p.return)),f.flags&32){D=f.stateNode;try{Vo(D,"")}catch(_e){_t(f,f.return,_e)}}w&4&&f.stateNode!=null&&(D=f.memoizedProps,Av(f,D,p!==null?p.memoizedProps:D)),w&1024&&(wv=!0);break;case 6:if(Rn(d,f),Bn(f),w&4){if(f.stateNode===null)throw Error(i(162));w=f.memoizedProps,p=f.stateNode;try{p.nodeValue=w}catch(_e){_t(f,f.return,_e)}}break;case 3:if(Dh=null,D=bi,bi=Th(d.containerInfo),Rn(d,f),bi=D,Bn(f),w&4&&p!==null&&p.memoizedState.isDehydrated)try{dl(d.containerInfo)}catch(_e){_t(f,f.return,_e)}wv&&(wv=!1,nb(f));break;case 4:w=bi,bi=Th(f.stateNode.containerInfo),Rn(d,f),Bn(f),bi=w;break;case 12:Rn(d,f),Bn(f);break;case 31:Rn(d,f),Bn(f),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,hh(f,w)));break;case 13:Rn(d,f),Bn(f),f.child.flags&8192&&f.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(gh=ke()),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,hh(f,w)));break;case 22:D=f.memoizedState!==null;var ee=p!==null&&p.memoizedState!==null,de=fa,Ae=Rr;if(fa=de||D,Rr=Ae||ee,Rn(d,f),Rr=Ae,fa=de,Bn(f),w&8192)e:for(d=f.stateNode,d._visibility=D?d._visibility&-2:d._visibility|1,D&&(p===null||ee||fa||Rr||$s(f)),p=null,d=f;;){if(d.tag===5||d.tag===26){if(p===null){ee=p=d;try{if(N=ee.stateNode,D)z=N.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none";else{Y=ee.stateNode;var Ee=ee.memoizedProps.style,ge=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;Y.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(_e){_t(ee,ee.return,_e)}}}else if(d.tag===6){if(p===null){ee=d;try{ee.stateNode.nodeValue=D?"":ee.memoizedProps}catch(_e){_t(ee,ee.return,_e)}}}else if(d.tag===18){if(p===null){ee=d;try{var ye=ee.stateNode;D?Hb(ye,!0):Hb(ee.stateNode,!1)}catch(_e){_t(ee,ee.return,_e)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===f)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===f)break e;for(;d.sibling===null;){if(d.return===null||d.return===f)break e;p===d&&(p=null),d=d.return}p===d&&(p=null),d.sibling.return=d.return,d=d.sibling}w&4&&(w=f.updateQueue,w!==null&&(p=w.retryQueue,p!==null&&(w.retryQueue=null,hh(f,p))));break;case 19:Rn(d,f),Bn(f),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,hh(f,w)));break;case 30:break;case 21:break;default:Rn(d,f),Bn(f)}}function Bn(f){var d=f.flags;if(d&2){try{for(var p,w=f.return;w!==null;){if(Xx(w)){p=w;break}w=w.return}if(p==null)throw Error(i(160));switch(p.tag){case 27:var D=p.stateNode,N=xv(f);fh(f,N,D);break;case 5:var z=p.stateNode;p.flags&32&&(Vo(z,""),p.flags&=-33);var Y=xv(f);fh(f,Y,z);break;case 3:case 4:var ee=p.stateNode.containerInfo,de=xv(f);bv(f,de,ee);break;default:throw Error(i(161))}}catch(Ae){_t(f,f.return,Ae)}f.flags&=-3}d&4096&&(f.flags&=-4097)}function nb(f){if(f.subtreeFlags&1024)for(f=f.child;f!==null;){var d=f;nb(d),d.tag===5&&d.flags&1024&&d.stateNode.reset(),f=f.sibling}}function da(f,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)Wx(f,d.alternate,d),d=d.sibling}function $s(f){for(f=f.child;f!==null;){var d=f;switch(d.tag){case 0:case 11:case 14:case 15:Qa(4,d,d.return),$s(d);break;case 1:Pi(d,d.return);var p=d.stateNode;typeof p.componentWillUnmount=="function"&&Hx(d,d.return,p),$s(d);break;case 27:Vu(d.stateNode);case 26:case 5:Pi(d,d.return),$s(d);break;case 22:d.memoizedState===null&&$s(d);break;case 30:$s(d);break;default:$s(d)}f=f.sibling}}function ga(f,d,p){for(p=p&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var w=d.alternate,D=f,N=d,z=N.flags;switch(N.tag){case 0:case 11:case 15:ga(D,N,p),Tu(4,N);break;case 1:if(ga(D,N,p),w=N,D=w.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(de){_t(w,w.return,de)}if(w=N,D=w.updateQueue,D!==null){var Y=w.stateNode;try{var ee=D.shared.hiddenCallbacks;if(ee!==null)for(D.shared.hiddenCallbacks=null,D=0;D<ee.length;D++)kA(ee[D],Y)}catch(de){_t(w,w.return,de)}}p&&z&64&&jx(N),Mu(N,N.return);break;case 27:Qx(N);case 26:case 5:ga(D,N,p),p&&w===null&&z&4&&Kx(N),Mu(N,N.return);break;case 12:ga(D,N,p);break;case 31:ga(D,N,p),p&&z&4&&eb(D,N);break;case 13:ga(D,N,p),p&&z&4&&tb(D,N);break;case 22:N.memoizedState===null&&ga(D,N,p),Mu(N,N.return);break;case 30:break;default:ga(D,N,p)}d=d.sibling}}function Cv(f,d){var p=null;f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(p=f.memoizedState.cachePool.pool),f=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(f=d.memoizedState.cachePool.pool),f!==p&&(f!=null&&f.refCount++,p!=null&&du(p))}function Ev(f,d){f=null,d.alternate!==null&&(f=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==f&&(d.refCount++,f!=null&&du(f))}function wi(f,d,p,w){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)ib(f,d,p,w),d=d.sibling}function ib(f,d,p,w){var D=d.flags;switch(d.tag){case 0:case 11:case 15:wi(f,d,p,w),D&2048&&Tu(9,d);break;case 1:wi(f,d,p,w);break;case 3:wi(f,d,p,w),D&2048&&(f=null,d.alternate!==null&&(f=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==f&&(d.refCount++,f!=null&&du(f)));break;case 12:if(D&2048){wi(f,d,p,w),f=d.stateNode;try{var N=d.memoizedProps,z=N.id,Y=N.onPostCommit;typeof Y=="function"&&Y(z,d.alternate===null?"mount":"update",f.passiveEffectDuration,-0)}catch(ee){_t(d,d.return,ee)}}else wi(f,d,p,w);break;case 31:wi(f,d,p,w);break;case 13:wi(f,d,p,w);break;case 23:break;case 22:N=d.stateNode,z=d.alternate,d.memoizedState!==null?N._visibility&2?wi(f,d,p,w):Du(f,d):N._visibility&2?wi(f,d,p,w):(N._visibility|=2,rl(f,d,p,w,(d.subtreeFlags&10256)!==0||!1)),D&2048&&Cv(z,d);break;case 24:wi(f,d,p,w),D&2048&&Ev(d.alternate,d);break;default:wi(f,d,p,w)}}function rl(f,d,p,w,D){for(D=D&&((d.subtreeFlags&10256)!==0||!1),d=d.child;d!==null;){var N=f,z=d,Y=p,ee=w,de=z.flags;switch(z.tag){case 0:case 11:case 15:rl(N,z,Y,ee,D),Tu(8,z);break;case 23:break;case 22:var Ae=z.stateNode;z.memoizedState!==null?Ae._visibility&2?rl(N,z,Y,ee,D):Du(N,z):(Ae._visibility|=2,rl(N,z,Y,ee,D)),D&&de&2048&&Cv(z.alternate,z);break;case 24:rl(N,z,Y,ee,D),D&&de&2048&&Ev(z.alternate,z);break;default:rl(N,z,Y,ee,D)}d=d.sibling}}function Du(f,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var p=f,w=d,D=w.flags;switch(w.tag){case 22:Du(p,w),D&2048&&Cv(w.alternate,w);break;case 24:Du(p,w),D&2048&&Ev(w.alternate,w);break;default:Du(p,w)}d=d.sibling}}var Ru=8192;function nl(f,d,p){if(f.subtreeFlags&Ru)for(f=f.child;f!==null;)ab(f,d,p),f=f.sibling}function ab(f,d,p){switch(f.tag){case 26:nl(f,d,p),f.flags&Ru&&f.memoizedState!==null&&jD(p,bi,f.memoizedState,f.memoizedProps);break;case 5:nl(f,d,p);break;case 3:case 4:var w=bi;bi=Th(f.stateNode.containerInfo),nl(f,d,p),bi=w;break;case 22:f.memoizedState===null&&(w=f.alternate,w!==null&&w.memoizedState!==null?(w=Ru,Ru=16777216,nl(f,d,p),Ru=w):nl(f,d,p));break;default:nl(f,d,p)}}function sb(f){var d=f.alternate;if(d!==null&&(f=d.child,f!==null)){d.child=null;do d=f.sibling,f.sibling=null,f=d;while(f!==null)}}function Bu(f){var d=f.deletions;if((f.flags&16)!==0){if(d!==null)for(var p=0;p<d.length;p++){var w=d[p];Yr=w,lb(w,f)}sb(f)}if(f.subtreeFlags&10256)for(f=f.child;f!==null;)ob(f),f=f.sibling}function ob(f){switch(f.tag){case 0:case 11:case 15:Bu(f),f.flags&2048&&Qa(9,f,f.return);break;case 3:Bu(f);break;case 12:Bu(f);break;case 22:var d=f.stateNode;f.memoizedState!==null&&d._visibility&2&&(f.return===null||f.return.tag!==13)?(d._visibility&=-3,dh(f)):Bu(f);break;default:Bu(f)}}function dh(f){var d=f.deletions;if((f.flags&16)!==0){if(d!==null)for(var p=0;p<d.length;p++){var w=d[p];Yr=w,lb(w,f)}sb(f)}for(f=f.child;f!==null;){switch(d=f,d.tag){case 0:case 11:case 15:Qa(8,d,d.return),dh(d);break;case 22:p=d.stateNode,p._visibility&2&&(p._visibility&=-3,dh(d));break;default:dh(d)}f=f.sibling}}function lb(f,d){for(;Yr!==null;){var p=Yr;switch(p.tag){case 0:case 11:case 15:Qa(8,p,d);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var w=p.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:du(p.memoizedState.cache)}if(w=p.child,w!==null)w.return=p,Yr=w;else e:for(p=f;Yr!==null;){w=Yr;var D=w.sibling,N=w.return;if(Jx(w),w===p){Yr=null;break e}if(D!==null){D.return=N,Yr=D;break e}Yr=N}}}var sD={getCacheForType:function(f){var d=en(Tr),p=d.data.get(f);return p===void 0&&(p=f(),d.data.set(f,p)),p},cacheSignal:function(){return en(Tr).controller.signal}},oD=typeof WeakMap=="function"?WeakMap:Map,kt=0,Ht=null,yt=null,wt=0,Lt=0,jn=null,Za=!1,il=!1,Sv=!1,va=0,pr=0,Wa=0,eo=0,Tv=0,Hn=0,al=0,Iu=null,In=null,Mv=!1,gh=0,ub=0,vh=1/0,mh=null,Ja=null,Fr=0,$a=null,sl=null,ma=0,Dv=0,Rv=null,cb=null,Nu=0,Bv=null;function Kn(){return(kt&2)!==0&&wt!==0?wt&-wt:P.T!==null?Vv():dr()}function fb(){if(Hn===0)if((wt&536870912)===0||St){var f=Ue;Ue<<=1,(Ue&3932160)===0&&(Ue=262144),Hn=f}else Hn=536870912;return f=qn.current,f!==null&&(f.flags|=32),Hn}function Nn(f,d,p){(f===Ht&&(Lt===2||Lt===9)||f.cancelPendingCommit!==null)&&(ol(f,0),es(f,wt,Hn,!1)),zt(f,p),((kt&2)===0||f!==Ht)&&(f===Ht&&((kt&2)===0&&(eo|=p),pr===4&&es(f,wt,Hn,!1)),Li(f))}function hb(f,d,p){if((kt&6)!==0)throw Error(i(327));var w=!p&&(d&127)===0&&(d&f.expiredLanes)===0||Le(f,d),D=w?cD(f,d):Nv(f,d,!0),N=w;do{if(D===0){il&&!w&&es(f,d,0,!1);break}else{if(p=f.current.alternate,N&&!lD(p)){D=Nv(f,d,!1),N=!1;continue}if(D===2){if(N=d,f.errorRecoveryDisabledLanes&N)var z=0;else z=f.pendingLanes&-536870913,z=z!==0?z:z&536870912?536870912:0;if(z!==0){d=z;e:{var Y=f;D=Iu;var ee=Y.current.memoizedState.isDehydrated;if(ee&&(ol(Y,z).flags|=256),z=Nv(Y,z,!1),z!==2){if(Sv&&!ee){Y.errorRecoveryDisabledLanes|=N,eo|=N,D=4;break e}N=In,In=D,N!==null&&(In===null?In=N:In.push.apply(In,N))}D=z}if(N=!1,D!==2)continue}}if(D===1){ol(f,0),es(f,d,0,!0);break}e:{switch(w=f,N=D,N){case 0:case 1:throw Error(i(345));case 4:if((d&4194048)!==d)break;case 6:es(w,d,Hn,!Za);break e;case 2:In=null;break;case 3:case 5:break;default:throw Error(i(329))}if((d&62914560)===d&&(D=gh+300-ke(),10<D)){if(es(w,d,Hn,!Za),ot(w,0,!0)!==0)break e;ma=d,w.timeoutHandle=qb(db.bind(null,w,p,In,mh,Mv,d,Hn,eo,al,Za,N,"Throttled",-0,0),D);break e}db(w,p,In,mh,Mv,d,Hn,eo,al,Za,N,null,-0,0)}}break}while(!0);Li(f)}function db(f,d,p,w,D,N,z,Y,ee,de,Ae,Ee,ge,ye){if(f.timeoutHandle=-1,Ee=d.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ta},ab(d,N,Ee);var _e=(N&62914560)===N?gh-ke():(N&4194048)===N?ub-ke():0;if(_e=HD(Ee,_e),_e!==null){ma=N,f.cancelPendingCommit=_e(bb.bind(null,f,d,N,p,w,D,z,Y,ee,Ae,Ee,null,ge,ye)),es(f,N,z,!de);return}}bb(f,d,N,p,w,D,z,Y,ee)}function lD(f){for(var d=f;;){var p=d.tag;if((p===0||p===11||p===15)&&d.flags&16384&&(p=d.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var w=0;w<p.length;w++){var D=p[w],N=D.getSnapshot;D=D.value;try{if(!zn(N(),D))return!1}catch{return!1}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===f)break;for(;d.sibling===null;){if(d.return===null||d.return===f)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function es(f,d,p,w){d&=~Tv,d&=~eo,f.suspendedLanes|=d,f.pingedLanes&=~d,w&&(f.warmLanes|=d),w=f.expirationTimes;for(var D=d;0<D;){var N=31-me(D),z=1<<N;w[N]=-1,D&=~z}p!==0&&hr(f,p,d)}function ph(){return(kt&6)===0?(Fu(0),!1):!0}function Iv(){if(yt!==null){if(Lt===0)var f=yt.return;else f=yt,aa=js=null,Kg(f),Wo=null,vu=0,f=yt;for(;f!==null;)Yx(f.alternate,f),f=f.return;yt=null}}function ol(f,d){var p=f.timeoutHandle;p!==-1&&(f.timeoutHandle=-1,DD(p)),p=f.cancelPendingCommit,p!==null&&(f.cancelPendingCommit=null,p()),ma=0,Iv(),Ht=f,yt=p=na(f.current,null),wt=d,Lt=0,jn=null,Za=!1,il=Le(f,d),Sv=!1,al=Hn=Tv=eo=Wa=pr=0,In=Iu=null,Mv=!1,(d&8)!==0&&(d|=d&32);var w=f.entangledLanes;if(w!==0)for(f=f.entanglements,w&=d;0<w;){var D=31-me(w),N=1<<D;d|=f[D],w&=~N}return va=d,Pf(),p}function gb(f,d){ct=null,P.H=Cu,d===Zo||d===Hf?(d=BA(),Lt=3):d===Ug?(d=BA(),Lt=4):Lt=d===uv?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,jn=d,yt===null&&(pr=1,sh(f,ai(d,f.current)))}function vb(){var f=qn.current;return f===null?!0:(wt&4194048)===wt?ui===null:(wt&62914560)===wt||(wt&536870912)!==0?f===ui:!1}function mb(){var f=P.H;return P.H=Cu,f===null?Cu:f}function pb(){var f=P.A;return P.A=sD,f}function yh(){pr=4,Za||(wt&4194048)!==wt&&qn.current!==null||(il=!0),(Wa&134217727)===0&&(eo&134217727)===0||Ht===null||es(Ht,wt,Hn,!1)}function Nv(f,d,p){var w=kt;kt|=2;var D=mb(),N=pb();(Ht!==f||wt!==d)&&(mh=null,ol(f,d)),d=!1;var z=pr;e:do try{if(Lt!==0&&yt!==null){var Y=yt,ee=jn;switch(Lt){case 8:Iv(),z=6;break e;case 3:case 2:case 9:case 6:qn.current===null&&(d=!0);var de=Lt;if(Lt=0,jn=null,ll(f,Y,ee,de),p&&il){z=0;break e}break;default:de=Lt,Lt=0,jn=null,ll(f,Y,ee,de)}}uD(),z=pr;break}catch(Ae){gb(f,Ae)}while(!0);return d&&f.shellSuspendCounter++,aa=js=null,kt=w,P.H=D,P.A=N,yt===null&&(Ht=null,wt=0,Pf()),z}function uD(){for(;yt!==null;)yb(yt)}function cD(f,d){var p=kt;kt|=2;var w=mb(),D=pb();Ht!==f||wt!==d?(mh=null,vh=ke()+500,ol(f,d)):il=Le(f,d);e:do try{if(Lt!==0&&yt!==null){d=yt;var N=jn;t:switch(Lt){case 1:Lt=0,jn=null,ll(f,d,N,1);break;case 2:case 9:if(DA(N)){Lt=0,jn=null,Ab(d);break}d=function(){Lt!==2&&Lt!==9||Ht!==f||(Lt=7),Li(f)},N.then(d,d);break e;case 3:Lt=7;break e;case 4:Lt=5;break e;case 7:DA(N)?(Lt=0,jn=null,Ab(d)):(Lt=0,jn=null,ll(f,d,N,7));break;case 5:var z=null;switch(yt.tag){case 26:z=yt.memoizedState;case 5:case 27:var Y=yt;if(z?i5(z):Y.stateNode.complete){Lt=0,jn=null;var ee=Y.sibling;if(ee!==null)yt=ee;else{var de=Y.return;de!==null?(yt=de,Ah(de)):yt=null}break t}}Lt=0,jn=null,ll(f,d,N,5);break;case 6:Lt=0,jn=null,ll(f,d,N,6);break;case 8:Iv(),pr=6;break e;default:throw Error(i(462))}}fD();break}catch(Ae){gb(f,Ae)}while(!0);return aa=js=null,P.H=w,P.A=D,kt=p,yt!==null?0:(Ht=null,wt=0,Pf(),pr)}function fD(){for(;yt!==null&&!Ke();)yb(yt)}function yb(f){var d=Gx(f.alternate,f,va);f.memoizedProps=f.pendingProps,d===null?Ah(f):yt=d}function Ab(f){var d=f,p=d.alternate;switch(d.tag){case 15:case 0:d=Vx(p,d,d.pendingProps,d.type,void 0,wt);break;case 11:d=Vx(p,d,d.pendingProps,d.type.render,d.ref,wt);break;case 5:Kg(d);default:Yx(p,d),d=yt=pA(d,va),d=Gx(p,d,va)}f.memoizedProps=f.pendingProps,d===null?Ah(f):yt=d}function ll(f,d,p,w){aa=js=null,Kg(d),Wo=null,vu=0;var D=d.return;try{if($M(f,D,d,p,wt)){pr=1,sh(f,ai(p,f.current)),yt=null;return}}catch(N){if(D!==null)throw yt=D,N;pr=1,sh(f,ai(p,f.current)),yt=null;return}d.flags&32768?(St||w===1?f=!0:il||(wt&536870912)!==0?f=!1:(Za=f=!0,(w===2||w===9||w===3||w===6)&&(w=qn.current,w!==null&&w.tag===13&&(w.flags|=16384))),xb(d,f)):Ah(d)}function Ah(f){var d=f;do{if((d.flags&32768)!==0){xb(d,Za);return}f=d.return;var p=rD(d.alternate,d,va);if(p!==null){yt=p;return}if(d=d.sibling,d!==null){yt=d;return}yt=d=f}while(d!==null);pr===0&&(pr=5)}function xb(f,d){do{var p=nD(f.alternate,f);if(p!==null){p.flags&=32767,yt=p;return}if(p=f.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!d&&(f=f.sibling,f!==null)){yt=f;return}yt=f=p}while(f!==null);pr=6,yt=null}function bb(f,d,p,w,D,N,z,Y,ee){f.cancelPendingCommit=null;do xh();while(Fr!==0);if((kt&6)!==0)throw Error(i(327));if(d!==null){if(d===f.current)throw Error(i(177));if(N=d.lanes|d.childLanes,N|=xg,Jr(f,p,N,z,Y,ee),f===Ht&&(yt=Ht=null,wt=0),sl=d,$a=f,ma=p,Dv=N,Rv=D,cb=w,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(f.callbackNode=null,f.callbackPriority=0,vD(Et,function(){return Tb(),null})):(f.callbackNode=null,f.callbackPriority=0),w=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||w){w=P.T,P.T=null,D=_.p,_.p=2,z=kt,kt|=4;try{iD(f,d,p)}finally{kt=z,_.p=D,P.T=w}}Fr=1,wb(),Cb(),Eb()}}function wb(){if(Fr===1){Fr=0;var f=$a,d=sl,p=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||p){p=P.T,P.T=null;var w=_.p;_.p=2;var D=kt;kt|=4;try{rb(d,f);var N=Yv,z=lA(f.containerInfo),Y=N.focusedElem,ee=N.selectionRange;if(z!==Y&&Y&&Y.ownerDocument&&oA(Y.ownerDocument.documentElement,Y)){if(ee!==null&&vg(Y)){var de=ee.start,Ae=ee.end;if(Ae===void 0&&(Ae=de),"selectionStart"in Y)Y.selectionStart=de,Y.selectionEnd=Math.min(Ae,Y.value.length);else{var Ee=Y.ownerDocument||document,ge=Ee&&Ee.defaultView||window;if(ge.getSelection){var ye=ge.getSelection(),_e=Y.textContent.length,tt=Math.min(ee.start,_e),Yt=ee.end===void 0?tt:Math.min(ee.end,_e);!ye.extend&&tt>Yt&&(z=Yt,Yt=tt,tt=z);var oe=sA(Y,tt),ne=sA(Y,Yt);if(oe&&ne&&(ye.rangeCount!==1||ye.anchorNode!==oe.node||ye.anchorOffset!==oe.offset||ye.focusNode!==ne.node||ye.focusOffset!==ne.offset)){var he=Ee.createRange();he.setStart(oe.node,oe.offset),ye.removeAllRanges(),tt>Yt?(ye.addRange(he),ye.extend(ne.node,ne.offset)):(he.setEnd(ne.node,ne.offset),ye.addRange(he))}}}}for(Ee=[],ye=Y;ye=ye.parentNode;)ye.nodeType===1&&Ee.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof Y.focus=="function"&&Y.focus(),Y=0;Y<Ee.length;Y++){var Ce=Ee[Y];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}Nh=!!qv,Yv=qv=null}finally{kt=D,_.p=w,P.T=p}}f.current=d,Fr=2}}function Cb(){if(Fr===2){Fr=0;var f=$a,d=sl,p=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||p){p=P.T,P.T=null;var w=_.p;_.p=2;var D=kt;kt|=4;try{Wx(f,d.alternate,d)}finally{kt=D,_.p=w,P.T=p}}Fr=3}}function Eb(){if(Fr===4||Fr===3){Fr=0,at();var f=$a,d=sl,p=ma,w=cb;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?Fr=5:(Fr=0,sl=$a=null,Sb(f,f.pendingLanes));var D=f.pendingLanes;if(D===0&&(Ja=null),ei(p),d=d.stateNode,ce&&typeof ce.onCommitFiberRoot=="function")try{ce.onCommitFiberRoot(X,d,void 0,(d.current.flags&128)===128)}catch{}if(w!==null){d=P.T,D=_.p,_.p=2,P.T=null;try{for(var N=f.onRecoverableError,z=0;z<w.length;z++){var Y=w[z];N(Y.value,{componentStack:Y.stack})}}finally{P.T=d,_.p=D}}(ma&3)!==0&&xh(),Li(f),D=f.pendingLanes,(p&261930)!==0&&(D&42)!==0?f===Bv?Nu++:(Nu=0,Bv=f):Nu=0,Fu(0)}}function Sb(f,d){(f.pooledCacheLanes&=d)===0&&(d=f.pooledCache,d!=null&&(f.pooledCache=null,du(d)))}function xh(){return wb(),Cb(),Eb(),Tb()}function Tb(){if(Fr!==5)return!1;var f=$a,d=Dv;Dv=0;var p=ei(ma),w=P.T,D=_.p;try{_.p=32>p?32:p,P.T=null,p=Rv,Rv=null;var N=$a,z=ma;if(Fr=0,sl=$a=null,ma=0,(kt&6)!==0)throw Error(i(331));var Y=kt;if(kt|=4,ob(N.current),ib(N,N.current,z,p),kt=Y,Fu(0,!1),ce&&typeof ce.onPostCommitFiberRoot=="function")try{ce.onPostCommitFiberRoot(X,N)}catch{}return!0}finally{_.p=D,P.T=w,Sb(f,d)}}function Mb(f,d,p){d=ai(p,d),d=lv(f.stateNode,d,2),f=Ha(f,d,2),f!==null&&(zt(f,2),Li(f))}function _t(f,d,p){if(f.tag===3)Mb(f,f,p);else for(;d!==null;){if(d.tag===3){Mb(d,f,p);break}else if(d.tag===1){var w=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Ja===null||!Ja.has(w))){f=ai(p,f),p=Dx(2),w=Ha(d,p,2),w!==null&&(Rx(p,w,d,f),zt(w,2),Li(w));break}}d=d.return}}function Fv(f,d,p){var w=f.pingCache;if(w===null){w=f.pingCache=new oD;var D=new Set;w.set(d,D)}else D=w.get(d),D===void 0&&(D=new Set,w.set(d,D));D.has(p)||(Sv=!0,D.add(p),f=hD.bind(null,f,d,p),d.then(f,f))}function hD(f,d,p){var w=f.pingCache;w!==null&&w.delete(d),f.pingedLanes|=f.suspendedLanes&p,f.warmLanes&=~p,Ht===f&&(wt&p)===p&&(pr===4||pr===3&&(wt&62914560)===wt&&300>ke()-gh?(kt&2)===0&&ol(f,0):Tv|=p,al===wt&&(al=0)),Li(f)}function Db(f,d){d===0&&(d=ht()),f=Gs(f,d),f!==null&&(zt(f,d),Li(f))}function dD(f){var d=f.memoizedState,p=0;d!==null&&(p=d.retryLane),Db(f,p)}function gD(f,d){var p=0;switch(f.tag){case 31:case 13:var w=f.stateNode,D=f.memoizedState;D!==null&&(p=D.retryLane);break;case 19:w=f.stateNode;break;case 22:w=f.stateNode._retryCache;break;default:throw Error(i(314))}w!==null&&w.delete(d),Db(f,p)}function vD(f,d){return Ie(f,d)}var bh=null,ul=null,kv=!1,wh=!1,Uv=!1,ts=0;function Li(f){f!==ul&&f.next===null&&(ul===null?bh=ul=f:ul=ul.next=f),wh=!0,kv||(kv=!0,pD())}function Fu(f,d){if(!Uv&&wh){Uv=!0;do for(var p=!1,w=bh;w!==null;){if(f!==0){var D=w.pendingLanes;if(D===0)var N=0;else{var z=w.suspendedLanes,Y=w.pingedLanes;N=(1<<31-me(42|f)+1)-1,N&=D&~(z&~Y),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(p=!0,Nb(w,N))}else N=wt,N=ot(w,w===Ht?N:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(N&3)===0||Le(w,N)||(p=!0,Nb(w,N));w=w.next}while(p);Uv=!1}}function mD(){Rb()}function Rb(){wh=kv=!1;var f=0;ts!==0&&MD()&&(f=ts);for(var d=ke(),p=null,w=bh;w!==null;){var D=w.next,N=Bb(w,d);N===0?(w.next=null,p===null?bh=D:p.next=D,D===null&&(ul=p)):(p=w,(f!==0||(N&3)!==0)&&(wh=!0)),w=D}Fr!==0&&Fr!==5||Fu(f),ts!==0&&(ts=0)}function Bb(f,d){for(var p=f.suspendedLanes,w=f.pingedLanes,D=f.expirationTimes,N=f.pendingLanes&-62914561;0<N;){var z=31-me(N),Y=1<<z,ee=D[z];ee===-1?((Y&p)===0||(Y&w)!==0)&&(D[z]=vt(Y,d)):ee<=d&&(f.expiredLanes|=Y),N&=~Y}if(d=Ht,p=wt,p=ot(f,f===d?p:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),w=f.callbackNode,p===0||f===d&&(Lt===2||Lt===9)||f.cancelPendingCommit!==null)return w!==null&&w!==null&&Ye(w),f.callbackNode=null,f.callbackPriority=0;if((p&3)===0||Le(f,p)){if(d=p&-p,d===f.callbackPriority)return d;switch(w!==null&&Ye(w),ei(p)){case 2:case 8:p=Tt;break;case 32:p=Et;break;case 268435456:p=nt;break;default:p=Et}return w=Ib.bind(null,f),p=Ie(p,w),f.callbackPriority=d,f.callbackNode=p,d}return w!==null&&w!==null&&Ye(w),f.callbackPriority=2,f.callbackNode=null,2}function Ib(f,d){if(Fr!==0&&Fr!==5)return f.callbackNode=null,f.callbackPriority=0,null;var p=f.callbackNode;if(xh()&&f.callbackNode!==p)return null;var w=wt;return w=ot(f,f===Ht?w:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),w===0?null:(hb(f,w,d),Bb(f,ke()),f.callbackNode!=null&&f.callbackNode===p?Ib.bind(null,f):null)}function Nb(f,d){if(xh())return null;hb(f,d,!0)}function pD(){RD(function(){(kt&6)!==0?Ie(pt,mD):Rb()})}function Vv(){if(ts===0){var f=Xo;f===0&&(f=Ge,Ge<<=1,(Ge&261888)===0&&(Ge=256)),ts=f}return ts}function Fb(f){return f==null||typeof f=="symbol"||typeof f=="boolean"?null:typeof f=="function"?f:Bf(""+f)}function kb(f,d){var p=d.ownerDocument.createElement("input");return p.name=d.name,p.value=d.value,f.id&&p.setAttribute("form",f.id),d.parentNode.insertBefore(p,d),f=new FormData(f),p.parentNode.removeChild(p),f}function yD(f,d,p,w,D){if(d==="submit"&&p&&p.stateNode===D){var N=Fb((D[Nr]||null).action),z=w.submitter;z&&(d=(d=z[Nr]||null)?Fb(d.formAction):z.getAttribute("formAction"),d!==null&&(N=d,z=null));var Y=new kf("action","action",null,w,D);f.push({event:Y,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(ts!==0){var ee=z?kb(D,z):new FormData(D);rv(p,{pending:!0,data:ee,method:D.method,action:N},null,ee)}}else typeof N=="function"&&(Y.preventDefault(),ee=z?kb(D,z):new FormData(D),rv(p,{pending:!0,data:ee,method:D.method,action:N},N,ee))},currentTarget:D}]})}}for(var Ov=0;Ov<Ag.length;Ov++){var Pv=Ag[Ov],AD=Pv.toLowerCase(),xD=Pv[0].toUpperCase()+Pv.slice(1);xi(AD,"on"+xD)}xi(fA,"onAnimationEnd"),xi(hA,"onAnimationIteration"),xi(dA,"onAnimationStart"),xi("dblclick","onDoubleClick"),xi("focusin","onFocus"),xi("focusout","onBlur"),xi(VM,"onTransitionRun"),xi(OM,"onTransitionStart"),xi(PM,"onTransitionCancel"),xi(gA,"onTransitionEnd"),Ui("onMouseEnter",["mouseout","mouseover"]),Ui("onMouseLeave",["mouseout","mouseover"]),Ui("onPointerEnter",["pointerout","pointerover"]),Ui("onPointerLeave",["pointerout","pointerover"]),_n("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_n("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_n("onBeforeInput",["compositionend","keypress","textInput","paste"]),_n("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ku));function Ub(f,d){d=(d&4)!==0;for(var p=0;p<f.length;p++){var w=f[p],D=w.event;w=w.listeners;e:{var N=void 0;if(d)for(var z=w.length-1;0<=z;z--){var Y=w[z],ee=Y.instance,de=Y.currentTarget;if(Y=Y.listener,ee!==N&&D.isPropagationStopped())break e;N=Y,D.currentTarget=de;try{N(D)}catch(Ae){Of(Ae)}D.currentTarget=null,N=ee}else for(z=0;z<w.length;z++){if(Y=w[z],ee=Y.instance,de=Y.currentTarget,Y=Y.listener,ee!==N&&D.isPropagationStopped())break e;N=Y,D.currentTarget=de;try{N(D)}catch(Ae){Of(Ae)}D.currentTarget=null,N=ee}}}}function At(f,d){var p=d[_r];p===void 0&&(p=d[_r]=new Set);var w=f+"__bubble";p.has(w)||(Vb(d,f,2,!1),p.add(w))}function Lv(f,d,p){var w=0;d&&(w|=4),Vb(p,f,w,d)}var Ch="_reactListening"+Math.random().toString(36).slice(2);function _v(f){if(!f[Ch]){f[Ch]=!0,Sf.forEach(function(p){p!=="selectionchange"&&(bD.has(p)||Lv(p,!1,f),Lv(p,!0,f))});var d=f.nodeType===9?f:f.ownerDocument;d===null||d[Ch]||(d[Ch]=!0,Lv("selectionchange",!1,d))}}function Vb(f,d,p,w){switch(f5(d)){case 2:var D=QD;break;case 8:D=ZD;break;default:D=tm}p=D.bind(null,d,p,f),D=void 0,!sg||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(D=!0),w?D!==void 0?f.addEventListener(d,p,{capture:!0,passive:D}):f.addEventListener(d,p,!0):D!==void 0?f.addEventListener(d,p,{passive:D}):f.addEventListener(d,p,!1)}function zv(f,d,p,w,D){var N=w;if((d&1)===0&&(d&2)===0&&w!==null)e:for(;;){if(w===null)return;var z=w.tag;if(z===3||z===4){var Y=w.stateNode.containerInfo;if(Y===D)break;if(z===4)for(z=w.return;z!==null;){var ee=z.tag;if((ee===3||ee===4)&&z.stateNode.containerInfo===D)return;z=z.return}for(;Y!==null;){if(z=Ua(Y),z===null)return;if(ee=z.tag,ee===5||ee===6||ee===26||ee===27){w=N=z;continue e}Y=Y.parentNode}}w=w.return}zy(function(){var de=N,Ae=ig(p),Ee=[];e:{var ge=vA.get(f);if(ge!==void 0){var ye=kf,_e=f;switch(f){case"keypress":if(Nf(p)===0)break e;case"keydown":case"keyup":ye=gM;break;case"focusin":_e="focus",ye=cg;break;case"focusout":_e="blur",ye=cg;break;case"beforeblur":case"afterblur":ye=cg;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=Yy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=rM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=pM;break;case fA:case hA:case dA:ye=aM;break;case gA:ye=AM;break;case"scroll":case"scrollend":ye=eM;break;case"wheel":ye=bM;break;case"copy":case"cut":case"paste":ye=oM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=Hy;break;case"toggle":case"beforetoggle":ye=CM}var tt=(d&4)!==0,Yt=!tt&&(f==="scroll"||f==="scrollend"),oe=tt?ge!==null?ge+"Capture":null:ge;tt=[];for(var ne=de,he;ne!==null;){var Ce=ne;if(he=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||he===null||oe===null||(Ce=ru(ne,oe),Ce!=null&&tt.push(Uu(ne,Ce,he))),Yt)break;ne=ne.return}0<tt.length&&(ge=new ye(ge,_e,null,p,Ae),Ee.push({event:ge,listeners:tt}))}}if((d&7)===0){e:{if(ge=f==="mouseover"||f==="pointerover",ye=f==="mouseout"||f==="pointerout",ge&&p!==ng&&(_e=p.relatedTarget||p.fromElement)&&(Ua(_e)||_e[Sn]))break e;if((ye||ge)&&(ge=Ae.window===Ae?Ae:(ge=Ae.ownerDocument)?ge.defaultView||ge.parentWindow:window,ye?(_e=p.relatedTarget||p.toElement,ye=de,_e=_e?Ua(_e):null,_e!==null&&(Yt=s(_e),tt=_e.tag,_e!==Yt||tt!==5&&tt!==27&&tt!==6)&&(_e=null)):(ye=null,_e=de),ye!==_e)){if(tt=Yy,Ce="onMouseLeave",oe="onMouseEnter",ne="mouse",(f==="pointerout"||f==="pointerover")&&(tt=Hy,Ce="onPointerLeave",oe="onPointerEnter",ne="pointer"),Yt=ye==null?ge:Ps(ye),he=_e==null?ge:Ps(_e),ge=new tt(Ce,ne+"leave",ye,p,Ae),ge.target=Yt,ge.relatedTarget=he,Ce=null,Ua(Ae)===de&&(tt=new tt(oe,ne+"enter",_e,p,Ae),tt.target=he,tt.relatedTarget=Yt,Ce=tt),Yt=Ce,ye&&_e)t:{for(tt=wD,oe=ye,ne=_e,he=0,Ce=oe;Ce;Ce=tt(Ce))he++;Ce=0;for(var Je=ne;Je;Je=tt(Je))Ce++;for(;0<he-Ce;)oe=tt(oe),he--;for(;0<Ce-he;)ne=tt(ne),Ce--;for(;he--;){if(oe===ne||ne!==null&&oe===ne.alternate){tt=oe;break t}oe=tt(oe),ne=tt(ne)}tt=null}else tt=null;ye!==null&&Ob(Ee,ge,ye,tt,!1),_e!==null&&Yt!==null&&Ob(Ee,Yt,_e,tt,!0)}}e:{if(ge=de?Ps(de):window,ye=ge.nodeName&&ge.nodeName.toLowerCase(),ye==="select"||ye==="input"&&ge.type==="file")var Bt=eA;else if(Jy(ge))if(tA)Bt=FM;else{Bt=IM;var je=BM}else ye=ge.nodeName,!ye||ye.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?de&&rg(de.elementType)&&(Bt=eA):Bt=NM;if(Bt&&(Bt=Bt(f,de))){$y(Ee,Bt,p,Ae);break e}je&&je(f,ge,de),f==="focusout"&&de&&ge.type==="number"&&de.memoizedProps.value!=null&&tg(ge,"number",ge.value)}switch(je=de?Ps(de):window,f){case"focusin":(Jy(je)||je.contentEditable==="true")&&(_o=je,mg=de,cu=null);break;case"focusout":cu=mg=_o=null;break;case"mousedown":pg=!0;break;case"contextmenu":case"mouseup":case"dragend":pg=!1,uA(Ee,p,Ae);break;case"selectionchange":if(UM)break;case"keydown":case"keyup":uA(Ee,p,Ae)}var dt;if(hg)e:{switch(f){case"compositionstart":var Ct="onCompositionStart";break e;case"compositionend":Ct="onCompositionEnd";break e;case"compositionupdate":Ct="onCompositionUpdate";break e}Ct=void 0}else Lo?Zy(f,p)&&(Ct="onCompositionEnd"):f==="keydown"&&p.keyCode===229&&(Ct="onCompositionStart");Ct&&(Ky&&p.locale!=="ko"&&(Lo||Ct!=="onCompositionStart"?Ct==="onCompositionEnd"&&Lo&&(dt=Gy()):(La=Ae,og="value"in La?La.value:La.textContent,Lo=!0)),je=Eh(de,Ct),0<je.length&&(Ct=new jy(Ct,f,null,p,Ae),Ee.push({event:Ct,listeners:je}),dt?Ct.data=dt:(dt=Wy(p),dt!==null&&(Ct.data=dt)))),(dt=SM?TM(f,p):MM(f,p))&&(Ct=Eh(de,"onBeforeInput"),0<Ct.length&&(je=new jy("onBeforeInput","beforeinput",null,p,Ae),Ee.push({event:je,listeners:Ct}),je.data=dt)),yD(Ee,f,de,p,Ae)}Ub(Ee,d)})}function Uu(f,d,p){return{instance:f,listener:d,currentTarget:p}}function Eh(f,d){for(var p=d+"Capture",w=[];f!==null;){var D=f,N=D.stateNode;if(D=D.tag,D!==5&&D!==26&&D!==27||N===null||(D=ru(f,p),D!=null&&w.unshift(Uu(f,D,N)),D=ru(f,d),D!=null&&w.push(Uu(f,D,N))),f.tag===3)return w;f=f.return}return[]}function wD(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5&&f.tag!==27);return f||null}function Ob(f,d,p,w,D){for(var N=d._reactName,z=[];p!==null&&p!==w;){var Y=p,ee=Y.alternate,de=Y.stateNode;if(Y=Y.tag,ee!==null&&ee===w)break;Y!==5&&Y!==26&&Y!==27||de===null||(ee=de,D?(de=ru(p,N),de!=null&&z.unshift(Uu(p,de,ee))):D||(de=ru(p,N),de!=null&&z.push(Uu(p,de,ee)))),p=p.return}z.length!==0&&f.push({event:d,listeners:z})}var CD=/\r\n?/g,ED=/\u0000|\uFFFD/g;function Pb(f){return(typeof f=="string"?f:""+f).replace(CD,`
`).replace(ED,"")}function Lb(f,d){return d=Pb(d),Pb(f)===d}function qt(f,d,p,w,D,N){switch(p){case"children":typeof w=="string"?d==="body"||d==="textarea"&&w===""||Vo(f,w):(typeof w=="number"||typeof w=="bigint")&&d!=="body"&&Vo(f,""+w);break;case"className":Pa(f,"class",w);break;case"tabIndex":Pa(f,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":Pa(f,p,w);break;case"style":Ly(f,w,N);break;case"data":if(d!=="object"){Pa(f,"data",w);break}case"src":case"href":if(w===""&&(d!=="a"||p!=="href")){f.removeAttribute(p);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){f.removeAttribute(p);break}w=Bf(""+w),f.setAttribute(p,w);break;case"action":case"formAction":if(typeof w=="function"){f.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(p==="formAction"?(d!=="input"&&qt(f,d,"name",D.name,D,null),qt(f,d,"formEncType",D.formEncType,D,null),qt(f,d,"formMethod",D.formMethod,D,null),qt(f,d,"formTarget",D.formTarget,D,null)):(qt(f,d,"encType",D.encType,D,null),qt(f,d,"method",D.method,D,null),qt(f,d,"target",D.target,D,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){f.removeAttribute(p);break}w=Bf(""+w),f.setAttribute(p,w);break;case"onClick":w!=null&&(f.onclick=ta);break;case"onScroll":w!=null&&At("scroll",f);break;case"onScrollEnd":w!=null&&At("scrollend",f);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(i(61));if(p=w.__html,p!=null){if(D.children!=null)throw Error(i(60));f.innerHTML=p}}break;case"multiple":f.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":f.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){f.removeAttribute("xlink:href");break}p=Bf(""+w),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?f.setAttribute(p,""+w):f.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?f.setAttribute(p,""):f.removeAttribute(p);break;case"capture":case"download":w===!0?f.setAttribute(p,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?f.setAttribute(p,w):f.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?f.setAttribute(p,w):f.removeAttribute(p);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?f.removeAttribute(p):f.setAttribute(p,w);break;case"popover":At("beforetoggle",f),At("toggle",f),fn(f,"popover",w);break;case"xlinkActuate":ri(f,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":ri(f,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":ri(f,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":ri(f,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":ri(f,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":ri(f,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":ri(f,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":ri(f,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":ri(f,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":fn(f,"is",w);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=JT.get(p)||p,fn(f,p,w))}}function Gv(f,d,p,w,D,N){switch(p){case"style":Ly(f,w,N);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(i(61));if(p=w.__html,p!=null){if(D.children!=null)throw Error(i(60));f.innerHTML=p}}break;case"children":typeof w=="string"?Vo(f,w):(typeof w=="number"||typeof w=="bigint")&&Vo(f,""+w);break;case"onScroll":w!=null&&At("scroll",f);break;case"onScrollEnd":w!=null&&At("scrollend",f);break;case"onClick":w!=null&&(f.onclick=ta);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Tf.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(D=p.endsWith("Capture"),d=p.slice(2,D?p.length-7:void 0),N=f[Nr]||null,N=N!=null?N[p]:null,typeof N=="function"&&f.removeEventListener(d,N,D),typeof w=="function")){typeof N!="function"&&N!==null&&(p in f?f[p]=null:f.hasAttribute(p)&&f.removeAttribute(p)),f.addEventListener(d,w,D);break e}p in f?f[p]=w:w===!0?f.setAttribute(p,""):fn(f,p,w)}}}function rn(f,d,p){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":At("error",f),At("load",f);var w=!1,D=!1,N;for(N in p)if(p.hasOwnProperty(N)){var z=p[N];if(z!=null)switch(N){case"src":w=!0;break;case"srcSet":D=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,d));default:qt(f,d,N,z,p,null)}}D&&qt(f,d,"srcSet",p.srcSet,p,null),w&&qt(f,d,"src",p.src,p,null);return;case"input":At("invalid",f);var Y=N=z=D=null,ee=null,de=null;for(w in p)if(p.hasOwnProperty(w)){var Ae=p[w];if(Ae!=null)switch(w){case"name":D=Ae;break;case"type":z=Ae;break;case"checked":ee=Ae;break;case"defaultChecked":de=Ae;break;case"value":N=Ae;break;case"defaultValue":Y=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(i(137,d));break;default:qt(f,d,w,Ae,p,null)}}Uy(f,N,Y,ee,de,z,D,!1);return;case"select":At("invalid",f),w=z=N=null;for(D in p)if(p.hasOwnProperty(D)&&(Y=p[D],Y!=null))switch(D){case"value":N=Y;break;case"defaultValue":z=Y;break;case"multiple":w=Y;default:qt(f,d,D,Y,p,null)}d=N,p=z,f.multiple=!!w,d!=null?Uo(f,!!w,d,!1):p!=null&&Uo(f,!!w,p,!0);return;case"textarea":At("invalid",f),N=D=w=null;for(z in p)if(p.hasOwnProperty(z)&&(Y=p[z],Y!=null))switch(z){case"value":w=Y;break;case"defaultValue":D=Y;break;case"children":N=Y;break;case"dangerouslySetInnerHTML":if(Y!=null)throw Error(i(91));break;default:qt(f,d,z,Y,p,null)}Oy(f,w,D,N);return;case"option":for(ee in p)if(p.hasOwnProperty(ee)&&(w=p[ee],w!=null))switch(ee){case"selected":f.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:qt(f,d,ee,w,p,null)}return;case"dialog":At("beforetoggle",f),At("toggle",f),At("cancel",f),At("close",f);break;case"iframe":case"object":At("load",f);break;case"video":case"audio":for(w=0;w<ku.length;w++)At(ku[w],f);break;case"image":At("error",f),At("load",f);break;case"details":At("toggle",f);break;case"embed":case"source":case"link":At("error",f),At("load",f);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in p)if(p.hasOwnProperty(de)&&(w=p[de],w!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,d));default:qt(f,d,de,w,p,null)}return;default:if(rg(d)){for(Ae in p)p.hasOwnProperty(Ae)&&(w=p[Ae],w!==void 0&&Gv(f,d,Ae,w,p,void 0));return}}for(Y in p)p.hasOwnProperty(Y)&&(w=p[Y],w!=null&&qt(f,d,Y,w,p,null))}function SD(f,d,p,w){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var D=null,N=null,z=null,Y=null,ee=null,de=null,Ae=null;for(ye in p){var Ee=p[ye];if(p.hasOwnProperty(ye)&&Ee!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":ee=Ee;default:w.hasOwnProperty(ye)||qt(f,d,ye,null,w,Ee)}}for(var ge in w){var ye=w[ge];if(Ee=p[ge],w.hasOwnProperty(ge)&&(ye!=null||Ee!=null))switch(ge){case"type":N=ye;break;case"name":D=ye;break;case"checked":de=ye;break;case"defaultChecked":Ae=ye;break;case"value":z=ye;break;case"defaultValue":Y=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(i(137,d));break;default:ye!==Ee&&qt(f,d,ge,ye,w,Ee)}}eg(f,z,Y,ee,de,Ae,N,D);return;case"select":ye=z=Y=ge=null;for(N in p)if(ee=p[N],p.hasOwnProperty(N)&&ee!=null)switch(N){case"value":break;case"multiple":ye=ee;default:w.hasOwnProperty(N)||qt(f,d,N,null,w,ee)}for(D in w)if(N=w[D],ee=p[D],w.hasOwnProperty(D)&&(N!=null||ee!=null))switch(D){case"value":ge=N;break;case"defaultValue":Y=N;break;case"multiple":z=N;default:N!==ee&&qt(f,d,D,N,w,ee)}d=Y,p=z,w=ye,ge!=null?Uo(f,!!p,ge,!1):!!w!=!!p&&(d!=null?Uo(f,!!p,d,!0):Uo(f,!!p,p?[]:"",!1));return;case"textarea":ye=ge=null;for(Y in p)if(D=p[Y],p.hasOwnProperty(Y)&&D!=null&&!w.hasOwnProperty(Y))switch(Y){case"value":break;case"children":break;default:qt(f,d,Y,null,w,D)}for(z in w)if(D=w[z],N=p[z],w.hasOwnProperty(z)&&(D!=null||N!=null))switch(z){case"value":ge=D;break;case"defaultValue":ye=D;break;case"children":break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(i(91));break;default:D!==N&&qt(f,d,z,D,w,N)}Vy(f,ge,ye);return;case"option":for(var _e in p)if(ge=p[_e],p.hasOwnProperty(_e)&&ge!=null&&!w.hasOwnProperty(_e))switch(_e){case"selected":f.selected=!1;break;default:qt(f,d,_e,null,w,ge)}for(ee in w)if(ge=w[ee],ye=p[ee],w.hasOwnProperty(ee)&&ge!==ye&&(ge!=null||ye!=null))switch(ee){case"selected":f.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:qt(f,d,ee,ge,w,ye)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tt in p)ge=p[tt],p.hasOwnProperty(tt)&&ge!=null&&!w.hasOwnProperty(tt)&&qt(f,d,tt,null,w,ge);for(de in w)if(ge=w[de],ye=p[de],w.hasOwnProperty(de)&&ge!==ye&&(ge!=null||ye!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,d));break;default:qt(f,d,de,ge,w,ye)}return;default:if(rg(d)){for(var Yt in p)ge=p[Yt],p.hasOwnProperty(Yt)&&ge!==void 0&&!w.hasOwnProperty(Yt)&&Gv(f,d,Yt,void 0,w,ge);for(Ae in w)ge=w[Ae],ye=p[Ae],!w.hasOwnProperty(Ae)||ge===ye||ge===void 0&&ye===void 0||Gv(f,d,Ae,ge,w,ye);return}}for(var oe in p)ge=p[oe],p.hasOwnProperty(oe)&&ge!=null&&!w.hasOwnProperty(oe)&&qt(f,d,oe,null,w,ge);for(Ee in w)ge=w[Ee],ye=p[Ee],!w.hasOwnProperty(Ee)||ge===ye||ge==null&&ye==null||qt(f,d,Ee,ge,w,ye)}function _b(f){switch(f){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function TD(){if(typeof performance.getEntriesByType=="function"){for(var f=0,d=0,p=performance.getEntriesByType("resource"),w=0;w<p.length;w++){var D=p[w],N=D.transferSize,z=D.initiatorType,Y=D.duration;if(N&&Y&&_b(z)){for(z=0,Y=D.responseEnd,w+=1;w<p.length;w++){var ee=p[w],de=ee.startTime;if(de>Y)break;var Ae=ee.transferSize,Ee=ee.initiatorType;Ae&&_b(Ee)&&(ee=ee.responseEnd,z+=Ae*(ee<Y?1:(Y-de)/(ee-de)))}if(--w,d+=8*(N+z)/(D.duration/1e3),f++,10<f)break}}if(0<f)return d/f/1e6}return navigator.connection&&(f=navigator.connection.downlink,typeof f=="number")?f:5}var qv=null,Yv=null;function Sh(f){return f.nodeType===9?f:f.ownerDocument}function zb(f){switch(f){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gb(f,d){if(f===0)switch(d){case"svg":return 1;case"math":return 2;default:return 0}return f===1&&d==="foreignObject"?0:f}function jv(f,d){return f==="textarea"||f==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.children=="bigint"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var Hv=null;function MD(){var f=window.event;return f&&f.type==="popstate"?f===Hv?!1:(Hv=f,!0):(Hv=null,!1)}var qb=typeof setTimeout=="function"?setTimeout:void 0,DD=typeof clearTimeout=="function"?clearTimeout:void 0,Yb=typeof Promise=="function"?Promise:void 0,RD=typeof queueMicrotask=="function"?queueMicrotask:typeof Yb<"u"?function(f){return Yb.resolve(null).then(f).catch(BD)}:qb;function BD(f){setTimeout(function(){throw f})}function rs(f){return f==="head"}function jb(f,d){var p=d,w=0;do{var D=p.nextSibling;if(f.removeChild(p),D&&D.nodeType===8)if(p=D.data,p==="/$"||p==="/&"){if(w===0){f.removeChild(D),dl(d);return}w--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")w++;else if(p==="html")Vu(f.ownerDocument.documentElement);else if(p==="head"){p=f.ownerDocument.head,Vu(p);for(var N=p.firstChild;N;){var z=N.nextSibling,Y=N.nodeName;N[Gr]||Y==="SCRIPT"||Y==="STYLE"||Y==="LINK"&&N.rel.toLowerCase()==="stylesheet"||p.removeChild(N),N=z}}else p==="body"&&Vu(f.ownerDocument.body);p=D}while(p);dl(d)}function Hb(f,d){var p=f;f=0;do{var w=p.nextSibling;if(p.nodeType===1?d?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(d?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),w&&w.nodeType===8)if(p=w.data,p==="/$"){if(f===0)break;f--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||f++;p=w}while(p)}function Kv(f){var d=f.firstChild;for(d&&d.nodeType===10&&(d=d.nextSibling);d;){var p=d;switch(d=d.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Kv(p),Fo(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}f.removeChild(p)}}function ID(f,d,p,w){for(;f.nodeType===1;){var D=p;if(f.nodeName.toLowerCase()!==d.toLowerCase()){if(!w&&(f.nodeName!=="INPUT"||f.type!=="hidden"))break}else if(w){if(!f[Gr])switch(d){case"meta":if(!f.hasAttribute("itemprop"))break;return f;case"link":if(N=f.getAttribute("rel"),N==="stylesheet"&&f.hasAttribute("data-precedence"))break;if(N!==D.rel||f.getAttribute("href")!==(D.href==null||D.href===""?null:D.href)||f.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin)||f.getAttribute("title")!==(D.title==null?null:D.title))break;return f;case"style":if(f.hasAttribute("data-precedence"))break;return f;case"script":if(N=f.getAttribute("src"),(N!==(D.src==null?null:D.src)||f.getAttribute("type")!==(D.type==null?null:D.type)||f.getAttribute("crossorigin")!==(D.crossOrigin==null?null:D.crossOrigin))&&N&&f.hasAttribute("async")&&!f.hasAttribute("itemprop"))break;return f;default:return f}}else if(d==="input"&&f.type==="hidden"){var N=D.name==null?null:""+D.name;if(D.type==="hidden"&&f.getAttribute("name")===N)return f}else return f;if(f=ci(f.nextSibling),f===null)break}return null}function ND(f,d,p){if(d==="")return null;for(;f.nodeType!==3;)if((f.nodeType!==1||f.nodeName!=="INPUT"||f.type!=="hidden")&&!p||(f=ci(f.nextSibling),f===null))return null;return f}function Kb(f,d){for(;f.nodeType!==8;)if((f.nodeType!==1||f.nodeName!=="INPUT"||f.type!=="hidden")&&!d||(f=ci(f.nextSibling),f===null))return null;return f}function Xv(f){return f.data==="$?"||f.data==="$~"}function Qv(f){return f.data==="$!"||f.data==="$?"&&f.ownerDocument.readyState!=="loading"}function FD(f,d){var p=f.ownerDocument;if(f.data==="$~")f._reactRetry=d;else if(f.data!=="$?"||p.readyState!=="loading")d();else{var w=function(){d(),p.removeEventListener("DOMContentLoaded",w)};p.addEventListener("DOMContentLoaded",w),f._reactRetry=w}}function ci(f){for(;f!=null;f=f.nextSibling){var d=f.nodeType;if(d===1||d===3)break;if(d===8){if(d=f.data,d==="$"||d==="$!"||d==="$?"||d==="$~"||d==="&"||d==="F!"||d==="F")break;if(d==="/$"||d==="/&")return null}}return f}var Zv=null;function Xb(f){f=f.nextSibling;for(var d=0;f;){if(f.nodeType===8){var p=f.data;if(p==="/$"||p==="/&"){if(d===0)return ci(f.nextSibling);d--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||d++}f=f.nextSibling}return null}function Qb(f){f=f.previousSibling;for(var d=0;f;){if(f.nodeType===8){var p=f.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(d===0)return f;d--}else p!=="/$"&&p!=="/&"||d++}f=f.previousSibling}return null}function Zb(f,d,p){switch(d=Sh(p),f){case"html":if(f=d.documentElement,!f)throw Error(i(452));return f;case"head":if(f=d.head,!f)throw Error(i(453));return f;case"body":if(f=d.body,!f)throw Error(i(454));return f;default:throw Error(i(451))}}function Vu(f){for(var d=f.attributes;d.length;)f.removeAttributeNode(d[0]);Fo(f)}var fi=new Map,Wb=new Set;function Th(f){return typeof f.getRootNode=="function"?f.getRootNode():f.nodeType===9?f:f.ownerDocument}var pa=_.d;_.d={f:kD,r:UD,D:VD,C:OD,L:PD,m:LD,X:zD,S:_D,M:GD};function kD(){var f=pa.f(),d=ph();return f||d}function UD(f){var d=Va(f);d!==null&&d.tag===5&&d.type==="form"?gx(d):pa.r(f)}var cl=typeof document>"u"?null:document;function Jb(f,d,p){var w=cl;if(w&&typeof d=="string"&&d){var D=ni(d);D='link[rel="'+f+'"][href="'+D+'"]',typeof p=="string"&&(D+='[crossorigin="'+p+'"]'),Wb.has(D)||(Wb.add(D),f={rel:f,crossOrigin:p,href:d},w.querySelector(D)===null&&(d=w.createElement("link"),rn(d,"link",f),Sr(d),w.head.appendChild(d)))}}function VD(f){pa.D(f),Jb("dns-prefetch",f,null)}function OD(f,d){pa.C(f,d),Jb("preconnect",f,d)}function PD(f,d,p){pa.L(f,d,p);var w=cl;if(w&&f&&d){var D='link[rel="preload"][as="'+ni(d)+'"]';d==="image"&&p&&p.imageSrcSet?(D+='[imagesrcset="'+ni(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(D+='[imagesizes="'+ni(p.imageSizes)+'"]')):D+='[href="'+ni(f)+'"]';var N=D;switch(d){case"style":N=fl(f);break;case"script":N=hl(f)}fi.has(N)||(f=g({rel:"preload",href:d==="image"&&p&&p.imageSrcSet?void 0:f,as:d},p),fi.set(N,f),w.querySelector(D)!==null||d==="style"&&w.querySelector(Ou(N))||d==="script"&&w.querySelector(Pu(N))||(d=w.createElement("link"),rn(d,"link",f),Sr(d),w.head.appendChild(d)))}}function LD(f,d){pa.m(f,d);var p=cl;if(p&&f){var w=d&&typeof d.as=="string"?d.as:"script",D='link[rel="modulepreload"][as="'+ni(w)+'"][href="'+ni(f)+'"]',N=D;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=hl(f)}if(!fi.has(N)&&(f=g({rel:"modulepreload",href:f},d),fi.set(N,f),p.querySelector(D)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(Pu(N)))return}w=p.createElement("link"),rn(w,"link",f),Sr(w),p.head.appendChild(w)}}}function _D(f,d,p){pa.S(f,d,p);var w=cl;if(w&&f){var D=Oa(w).hoistableStyles,N=fl(f);d=d||"default";var z=D.get(N);if(!z){var Y={loading:0,preload:null};if(z=w.querySelector(Ou(N)))Y.loading=5;else{f=g({rel:"stylesheet",href:f,"data-precedence":d},p),(p=fi.get(N))&&Wv(f,p);var ee=z=w.createElement("link");Sr(ee),rn(ee,"link",f),ee._p=new Promise(function(de,Ae){ee.onload=de,ee.onerror=Ae}),ee.addEventListener("load",function(){Y.loading|=1}),ee.addEventListener("error",function(){Y.loading|=2}),Y.loading|=4,Mh(z,d,w)}z={type:"stylesheet",instance:z,count:1,state:Y},D.set(N,z)}}}function zD(f,d){pa.X(f,d);var p=cl;if(p&&f){var w=Oa(p).hoistableScripts,D=hl(f),N=w.get(D);N||(N=p.querySelector(Pu(D)),N||(f=g({src:f,async:!0},d),(d=fi.get(D))&&Jv(f,d),N=p.createElement("script"),Sr(N),rn(N,"link",f),p.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},w.set(D,N))}}function GD(f,d){pa.M(f,d);var p=cl;if(p&&f){var w=Oa(p).hoistableScripts,D=hl(f),N=w.get(D);N||(N=p.querySelector(Pu(D)),N||(f=g({src:f,async:!0,type:"module"},d),(d=fi.get(D))&&Jv(f,d),N=p.createElement("script"),Sr(N),rn(N,"link",f),p.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},w.set(D,N))}}function $b(f,d,p,w){var D=(D=ue.current)?Th(D):null;if(!D)throw Error(i(446));switch(f){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(d=fl(p.href),p=Oa(D).hoistableStyles,w=p.get(d),w||(w={type:"style",instance:null,count:0,state:null},p.set(d,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){f=fl(p.href);var N=Oa(D).hoistableStyles,z=N.get(f);if(z||(D=D.ownerDocument||D,z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(f,z),(N=D.querySelector(Ou(f)))&&!N._p&&(z.instance=N,z.state.loading=5),fi.has(f)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},fi.set(f,p),N||qD(D,f,p,z.state))),d&&w===null)throw Error(i(528,""));return z}if(d&&w!==null)throw Error(i(529,""));return null;case"script":return d=p.async,p=p.src,typeof p=="string"&&d&&typeof d!="function"&&typeof d!="symbol"?(d=hl(p),p=Oa(D).hoistableScripts,w=p.get(d),w||(w={type:"script",instance:null,count:0,state:null},p.set(d,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,f))}}function fl(f){return'href="'+ni(f)+'"'}function Ou(f){return'link[rel="stylesheet"]['+f+"]"}function e5(f){return g({},f,{"data-precedence":f.precedence,precedence:null})}function qD(f,d,p,w){f.querySelector('link[rel="preload"][as="style"]['+d+"]")?w.loading=1:(d=f.createElement("link"),w.preload=d,d.addEventListener("load",function(){return w.loading|=1}),d.addEventListener("error",function(){return w.loading|=2}),rn(d,"link",p),Sr(d),f.head.appendChild(d))}function hl(f){return'[src="'+ni(f)+'"]'}function Pu(f){return"script[async]"+f}function t5(f,d,p){if(d.count++,d.instance===null)switch(d.type){case"style":var w=f.querySelector('style[data-href~="'+ni(p.href)+'"]');if(w)return d.instance=w,Sr(w),w;var D=g({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return w=(f.ownerDocument||f).createElement("style"),Sr(w),rn(w,"style",D),Mh(w,p.precedence,f),d.instance=w;case"stylesheet":D=fl(p.href);var N=f.querySelector(Ou(D));if(N)return d.state.loading|=4,d.instance=N,Sr(N),N;w=e5(p),(D=fi.get(D))&&Wv(w,D),N=(f.ownerDocument||f).createElement("link"),Sr(N);var z=N;return z._p=new Promise(function(Y,ee){z.onload=Y,z.onerror=ee}),rn(N,"link",w),d.state.loading|=4,Mh(N,p.precedence,f),d.instance=N;case"script":return N=hl(p.src),(D=f.querySelector(Pu(N)))?(d.instance=D,Sr(D),D):(w=p,(D=fi.get(N))&&(w=g({},p),Jv(w,D)),f=f.ownerDocument||f,D=f.createElement("script"),Sr(D),rn(D,"link",w),f.head.appendChild(D),d.instance=D);case"void":return null;default:throw Error(i(443,d.type))}else d.type==="stylesheet"&&(d.state.loading&4)===0&&(w=d.instance,d.state.loading|=4,Mh(w,p.precedence,f));return d.instance}function Mh(f,d,p){for(var w=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),D=w.length?w[w.length-1]:null,N=D,z=0;z<w.length;z++){var Y=w[z];if(Y.dataset.precedence===d)N=Y;else if(N!==D)break}N?N.parentNode.insertBefore(f,N.nextSibling):(d=p.nodeType===9?p.head:p,d.insertBefore(f,d.firstChild))}function Wv(f,d){f.crossOrigin==null&&(f.crossOrigin=d.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=d.referrerPolicy),f.title==null&&(f.title=d.title)}function Jv(f,d){f.crossOrigin==null&&(f.crossOrigin=d.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=d.referrerPolicy),f.integrity==null&&(f.integrity=d.integrity)}var Dh=null;function r5(f,d,p){if(Dh===null){var w=new Map,D=Dh=new Map;D.set(p,w)}else D=Dh,w=D.get(p),w||(w=new Map,D.set(p,w));if(w.has(f))return w;for(w.set(f,null),p=p.getElementsByTagName(f),D=0;D<p.length;D++){var N=p[D];if(!(N[Gr]||N[ar]||f==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var z=N.getAttribute(d)||"";z=f+z;var Y=w.get(z);Y?Y.push(N):w.set(z,[N])}}return w}function n5(f,d,p){f=f.ownerDocument||f,f.head.insertBefore(p,d==="title"?f.querySelector("head > title"):null)}function YD(f,d,p){if(p===1||d.itemProp!=null)return!1;switch(f){case"meta":case"title":return!0;case"style":if(typeof d.precedence!="string"||typeof d.href!="string"||d.href==="")break;return!0;case"link":if(typeof d.rel!="string"||typeof d.href!="string"||d.href===""||d.onLoad||d.onError)break;switch(d.rel){case"stylesheet":return f=d.disabled,typeof d.precedence=="string"&&f==null;default:return!0}case"script":if(d.async&&typeof d.async!="function"&&typeof d.async!="symbol"&&!d.onLoad&&!d.onError&&d.src&&typeof d.src=="string")return!0}return!1}function i5(f){return!(f.type==="stylesheet"&&(f.state.loading&3)===0)}function jD(f,d,p,w){if(p.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var D=fl(w.href),N=d.querySelector(Ou(D));if(N){d=N._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(f.count++,f=Rh.bind(f),d.then(f,f)),p.state.loading|=4,p.instance=N,Sr(N);return}N=d.ownerDocument||d,w=e5(w),(D=fi.get(D))&&Wv(w,D),N=N.createElement("link"),Sr(N);var z=N;z._p=new Promise(function(Y,ee){z.onload=Y,z.onerror=ee}),rn(N,"link",w),p.instance=N}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(p,d),(d=p.state.preload)&&(p.state.loading&3)===0&&(f.count++,p=Rh.bind(f),d.addEventListener("load",p),d.addEventListener("error",p))}}var $v=0;function HD(f,d){return f.stylesheets&&f.count===0&&Ih(f,f.stylesheets),0<f.count||0<f.imgCount?function(p){var w=setTimeout(function(){if(f.stylesheets&&Ih(f,f.stylesheets),f.unsuspend){var N=f.unsuspend;f.unsuspend=null,N()}},6e4+d);0<f.imgBytes&&$v===0&&($v=62500*TD());var D=setTimeout(function(){if(f.waitingForImages=!1,f.count===0&&(f.stylesheets&&Ih(f,f.stylesheets),f.unsuspend)){var N=f.unsuspend;f.unsuspend=null,N()}},(f.imgBytes>$v?50:800)+d);return f.unsuspend=p,function(){f.unsuspend=null,clearTimeout(w),clearTimeout(D)}}:null}function Rh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ih(this,this.stylesheets);else if(this.unsuspend){var f=this.unsuspend;this.unsuspend=null,f()}}}var Bh=null;function Ih(f,d){f.stylesheets=null,f.unsuspend!==null&&(f.count++,Bh=new Map,d.forEach(KD,f),Bh=null,Rh.call(f))}function KD(f,d){if(!(d.state.loading&4)){var p=Bh.get(f);if(p)var w=p.get(null);else{p=new Map,Bh.set(f,p);for(var D=f.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<D.length;N++){var z=D[N];(z.nodeName==="LINK"||z.getAttribute("media")!=="not all")&&(p.set(z.dataset.precedence,z),w=z)}w&&p.set(null,w)}D=d.instance,z=D.getAttribute("data-precedence"),N=p.get(z)||w,N===w&&p.set(null,D),p.set(z,D),this.count++,w=Rh.bind(this),D.addEventListener("load",w),D.addEventListener("error",w),N?N.parentNode.insertBefore(D,N.nextSibling):(f=f.nodeType===9?f.head:f,f.insertBefore(D,f.firstChild)),d.state.loading|=4}}var Lu={$$typeof:E,Provider:null,Consumer:null,_currentValue:q,_currentValue2:q,_threadCount:0};function XD(f,d,p,w,D,N,z,Y,ee){this.tag=1,this.containerInfo=f,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fr(0),this.hiddenUpdates=fr(null),this.identifierPrefix=w,this.onUncaughtError=D,this.onCaughtError=N,this.onRecoverableError=z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map}function a5(f,d,p,w,D,N,z,Y,ee,de,Ae,Ee){return f=new XD(f,d,p,z,ee,de,Ae,Ee,Y),d=1,N===!0&&(d|=24),N=Gn(3,null,null,d),f.current=N,N.stateNode=f,d=Ng(),d.refCount++,f.pooledCache=d,d.refCount++,N.memoizedState={element:w,isDehydrated:p,cache:d},Vg(N),f}function s5(f){return f?(f=qo,f):qo}function o5(f,d,p,w,D,N){D=s5(D),w.context===null?w.context=D:w.pendingContext=D,w=ja(d),w.payload={element:p},N=N===void 0?null:N,N!==null&&(w.callback=N),p=Ha(f,w,d),p!==null&&(Nn(p,f,d),pu(p,f,d))}function l5(f,d){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var p=f.retryLane;f.retryLane=p!==0&&p<d?p:d}}function em(f,d){l5(f,d),(f=f.alternate)&&l5(f,d)}function u5(f){if(f.tag===13||f.tag===31){var d=Gs(f,67108864);d!==null&&Nn(d,f,67108864),em(f,67108864)}}function c5(f){if(f.tag===13||f.tag===31){var d=Kn();d=br(d);var p=Gs(f,d);p!==null&&Nn(p,f,d),em(f,d)}}var Nh=!0;function QD(f,d,p,w){var D=P.T;P.T=null;var N=_.p;try{_.p=2,tm(f,d,p,w)}finally{_.p=N,P.T=D}}function ZD(f,d,p,w){var D=P.T;P.T=null;var N=_.p;try{_.p=8,tm(f,d,p,w)}finally{_.p=N,P.T=D}}function tm(f,d,p,w){if(Nh){var D=rm(w);if(D===null)zv(f,d,w,Fh,p),h5(f,w);else if(JD(D,f,d,p,w))w.stopPropagation();else if(h5(f,w),d&4&&-1<WD.indexOf(f)){for(;D!==null;){var N=Va(D);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var z=st(N.pendingLanes);if(z!==0){var Y=N;for(Y.pendingLanes|=2,Y.entangledLanes|=2;z;){var ee=1<<31-me(z);Y.entanglements[1]|=ee,z&=~ee}Li(N),(kt&6)===0&&(vh=ke()+500,Fu(0))}}break;case 31:case 13:Y=Gs(N,2),Y!==null&&Nn(Y,N,2),ph(),em(N,2)}if(N=rm(w),N===null&&zv(f,d,w,Fh,p),N===D)break;D=N}D!==null&&w.stopPropagation()}else zv(f,d,w,null,p)}}function rm(f){return f=ig(f),nm(f)}var Fh=null;function nm(f){if(Fh=null,f=Ua(f),f!==null){var d=s(f);if(d===null)f=null;else{var p=d.tag;if(p===13){if(f=o(d),f!==null)return f;f=null}else if(p===31){if(f=l(d),f!==null)return f;f=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;f=null}else d!==f&&(f=null)}}return Fh=f,null}function f5(f){switch(f){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ft()){case pt:return 2;case Tt:return 8;case Et:case Rt:return 32;case nt:return 268435456;default:return 32}default:return 32}}var im=!1,ns=null,is=null,as=null,_u=new Map,zu=new Map,ss=[],WD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function h5(f,d){switch(f){case"focusin":case"focusout":ns=null;break;case"dragenter":case"dragleave":is=null;break;case"mouseover":case"mouseout":as=null;break;case"pointerover":case"pointerout":_u.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":zu.delete(d.pointerId)}}function Gu(f,d,p,w,D,N){return f===null||f.nativeEvent!==N?(f={blockedOn:d,domEventName:p,eventSystemFlags:w,nativeEvent:N,targetContainers:[D]},d!==null&&(d=Va(d),d!==null&&u5(d)),f):(f.eventSystemFlags|=w,d=f.targetContainers,D!==null&&d.indexOf(D)===-1&&d.push(D),f)}function JD(f,d,p,w,D){switch(d){case"focusin":return ns=Gu(ns,f,d,p,w,D),!0;case"dragenter":return is=Gu(is,f,d,p,w,D),!0;case"mouseover":return as=Gu(as,f,d,p,w,D),!0;case"pointerover":var N=D.pointerId;return _u.set(N,Gu(_u.get(N)||null,f,d,p,w,D)),!0;case"gotpointercapture":return N=D.pointerId,zu.set(N,Gu(zu.get(N)||null,f,d,p,w,D)),!0}return!1}function d5(f){var d=Ua(f.target);if(d!==null){var p=s(d);if(p!==null){if(d=p.tag,d===13){if(d=o(p),d!==null){f.blockedOn=d,ti(f.priority,function(){c5(p)});return}}else if(d===31){if(d=l(p),d!==null){f.blockedOn=d,ti(f.priority,function(){c5(p)});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){f.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}f.blockedOn=null}function kh(f){if(f.blockedOn!==null)return!1;for(var d=f.targetContainers;0<d.length;){var p=rm(f.nativeEvent);if(p===null){p=f.nativeEvent;var w=new p.constructor(p.type,p);ng=w,p.target.dispatchEvent(w),ng=null}else return d=Va(p),d!==null&&u5(d),f.blockedOn=p,!1;d.shift()}return!0}function g5(f,d,p){kh(f)&&p.delete(d)}function $D(){im=!1,ns!==null&&kh(ns)&&(ns=null),is!==null&&kh(is)&&(is=null),as!==null&&kh(as)&&(as=null),_u.forEach(g5),zu.forEach(g5)}function Uh(f,d){f.blockedOn===d&&(f.blockedOn=null,im||(im=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,$D)))}var Vh=null;function v5(f){Vh!==f&&(Vh=f,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Vh===f&&(Vh=null);for(var d=0;d<f.length;d+=3){var p=f[d],w=f[d+1],D=f[d+2];if(typeof w!="function"){if(nm(w||p)===null)continue;break}var N=Va(p);N!==null&&(f.splice(d,3),d-=3,rv(N,{pending:!0,data:D,method:p.method,action:w},w,D))}}))}function dl(f){function d(ee){return Uh(ee,f)}ns!==null&&Uh(ns,f),is!==null&&Uh(is,f),as!==null&&Uh(as,f),_u.forEach(d),zu.forEach(d);for(var p=0;p<ss.length;p++){var w=ss[p];w.blockedOn===f&&(w.blockedOn=null)}for(;0<ss.length&&(p=ss[0],p.blockedOn===null);)d5(p),p.blockedOn===null&&ss.shift();if(p=(f.ownerDocument||f).$$reactFormReplay,p!=null)for(w=0;w<p.length;w+=3){var D=p[w],N=p[w+1],z=D[Nr]||null;if(typeof N=="function")z||v5(p);else if(z){var Y=null;if(N&&N.hasAttribute("formAction")){if(D=N,z=N[Nr]||null)Y=z.formAction;else if(nm(D)!==null)continue}else Y=z.action;typeof Y=="function"?p[w+1]=Y:(p.splice(w,3),w-=3),v5(p)}}}function m5(){function f(N){N.canIntercept&&N.info==="react-transition"&&N.intercept({handler:function(){return new Promise(function(z){return D=z})},focusReset:"manual",scroll:"manual"})}function d(){D!==null&&(D(),D=null),w||setTimeout(p,20)}function p(){if(!w&&!navigation.transition){var N=navigation.currentEntry;N&&N.url!=null&&navigation.navigate(N.url,{state:N.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var w=!1,D=null;return navigation.addEventListener("navigate",f),navigation.addEventListener("navigatesuccess",d),navigation.addEventListener("navigateerror",d),setTimeout(p,100),function(){w=!0,navigation.removeEventListener("navigate",f),navigation.removeEventListener("navigatesuccess",d),navigation.removeEventListener("navigateerror",d),D!==null&&(D(),D=null)}}}function am(f){this._internalRoot=f}Oh.prototype.render=am.prototype.render=function(f){var d=this._internalRoot;if(d===null)throw Error(i(409));var p=d.current,w=Kn();o5(p,w,f,d,null,null)},Oh.prototype.unmount=am.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var d=f.containerInfo;o5(f.current,2,null,f,null,null),ph(),d[Sn]=null}};function Oh(f){this._internalRoot=f}Oh.prototype.unstable_scheduleHydration=function(f){if(f){var d=dr();f={blockedOn:null,target:f,priority:d};for(var p=0;p<ss.length&&d!==0&&d<ss[p].priority;p++);ss.splice(p,0,f),p===0&&d5(f)}};var p5=e.version;if(p5!=="19.2.0")throw Error(i(527,p5,"19.2.0"));_.findDOMNode=function(f){var d=f._reactInternals;if(d===void 0)throw typeof f.render=="function"?Error(i(188)):(f=Object.keys(f).join(","),Error(i(268,f)));return f=u(d),f=f!==null?h(f):null,f=f===null?null:f.stateNode,f};var e8={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ph=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ph.isDisabled&&Ph.supportsFiber)try{X=Ph.inject(e8),ce=Ph}catch{}}return Yu.createRoot=function(f,d){if(!a(f))throw Error(i(299));var p=!1,w="",D=Ex,N=Sx,z=Tx;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(w=d.identifierPrefix),d.onUncaughtError!==void 0&&(D=d.onUncaughtError),d.onCaughtError!==void 0&&(N=d.onCaughtError),d.onRecoverableError!==void 0&&(z=d.onRecoverableError)),d=a5(f,1,!1,null,null,p,w,null,D,N,z,m5),f[Sn]=d.current,_v(f),new am(d)},Yu.hydrateRoot=function(f,d,p){if(!a(f))throw Error(i(299));var w=!1,D="",N=Ex,z=Sx,Y=Tx,ee=null;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(D=p.identifierPrefix),p.onUncaughtError!==void 0&&(N=p.onUncaughtError),p.onCaughtError!==void 0&&(z=p.onCaughtError),p.onRecoverableError!==void 0&&(Y=p.onRecoverableError),p.formState!==void 0&&(ee=p.formState)),d=a5(f,1,!0,d,p??null,w,D,ee,N,z,Y,m5),d.context=s5(null),p=d.current,w=Kn(),w=br(w),D=ja(w),D.callback=null,Ha(p,D,w),p=w,d.current.lanes=p,zt(d,p),Li(d),f[Sn]=d.current,_v(f),new Oh(d)},Yu.version="19.2.0",Yu}var M5;function c8(){if(M5)return lm.exports;M5=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),lm.exports=u8(),lm.exports}var f8=c8(),hm={exports:{}},dm,D5;function h8(){if(D5)return dm;D5=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return dm=r,dm}var gm,R5;function d8(){if(R5)return gm;R5=1;var r=h8();function e(){}function n(){}return n.resetWarningCache=e,gm=function(){function i(o,l,c,u,h,g){if(g!==r){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}i.isRequired=i;function a(){return i}var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:a,element:i,elementType:i,instanceOf:a,node:i,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},gm}var B5;function g8(){return B5||(B5=1,hm.exports=d8()()),hm.exports}var v8=g8();const Q=v2(v8);function p2({onExpand:r,status:e,error:n,nodes:i,onSelectNode:a}){const[s,o]=Ne.useState("DRD2"),[l,c]=Ne.useState(1),[u,h]=Ne.useState(25);Ne.useEffect(()=>{i.length&&!i.some(v=>v.id===s)&&o(i[0].id)},[i,s]);const g=v=>{v.preventDefault(),s&&r({node_id:s,depth:Number(l),limit:Number(u)})};return J.jsxs("section",{className:"panel","data-testid":"graph-explorer",children:[J.jsxs("header",{children:[J.jsx("h2",{children:"Knowledge graph explorer"}),J.jsx("p",{className:"panel-subtitle",children:"Expand the neighbourhood around a node to drive atlas overlays."})]}),J.jsxs("form",{className:"form-grid",onSubmit:g,children:[J.jsx("label",{htmlFor:"node-id",children:"Node identifier"}),J.jsx("input",{id:"node-id",name:"node",value:s,onChange:v=>o(v.target.value),placeholder:"e.g. DRD2","data-testid":"graph-node-input"}),J.jsx("label",{htmlFor:"depth",children:"Depth"}),J.jsx("input",{id:"depth",type:"number",min:"1",max:"4",value:l,onChange:v=>c(v.target.value),"data-testid":"graph-depth-input"}),J.jsx("label",{htmlFor:"limit",children:"Max nodes"}),J.jsx("input",{id:"limit",type:"number",min:"1",max:"200",value:u,onChange:v=>h(v.target.value),"data-testid":"graph-limit-input"}),J.jsx("button",{type:"submit",className:"primary",disabled:e==="loading","data-testid":"graph-expand-button",children:e==="loading"?"Expanding…":"Expand neighbourhood"})]}),n&&J.jsx("p",{className:"form-error",role:"alert",children:n.message}),i.length>0&&J.jsx("div",{className:"node-palette","data-testid":"graph-node-palette",children:i.slice(0,12).map(v=>J.jsxs("button",{type:"button",className:"node-chip",onClick:()=>{o(v.id),a&&a(v.id)},children:[J.jsx("span",{className:"node-name",children:v.name||v.id}),J.jsx("span",{className:"node-category",children:v.category})]},v.id))})]})}p2.propTypes={onExpand:Q.func.isRequired,status:Q.string,error:Q.instanceOf(Error),nodes:Q.arrayOf(Q.shape({id:Q.string.isRequired,name:Q.string,category:Q.string})),onSelectNode:Q.func};p2.defaultProps={status:"idle",error:null,nodes:[],onSelectNode:void 0};function bp(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function m8(r){if(Array.isArray(r))return r}function p8(r){if(Array.isArray(r))return bp(r)}function Fs(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function y8(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,nE(i.key),i)}}function ks(r,e,n){return e&&y8(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function On(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=y2(r))||e){n&&(r=n);var i=0,a=function(){};return{s:a,n:function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}},e:function(c){throw c},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,l=!1;return{s:function(){n=n.call(r)},n:function(){var c=n.next();return o=c.done,c},e:function(c){l=!0,s=c},f:function(){try{o||n.return==null||n.return()}finally{if(l)throw s}}}}function rE(r,e,n){return(e=nE(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function A8(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function x8(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,a=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function b8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ir(r,e){return m8(r)||x8(r,e)||y2(r,e)||b8()}function Hd(r){return p8(r)||A8(r)||y2(r)||w8()}function C8(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function nE(r){var e=C8(r,"string");return typeof e=="symbol"?e:e+""}function Or(r){"@babel/helpers - typeof";return Or=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or(r)}function y2(r,e){if(r){if(typeof r=="string")return bp(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bp(r,e):void 0}}var kr=typeof window>"u"?null:window,I5=kr?kr.navigator:null;kr&&kr.document;var E8=Or(""),iE=Or({}),S8=Or(function(){}),T8=typeof HTMLElement>"u"?"undefined":Or(HTMLElement),tf=function(e){return e&&e.instanceString&&gr(e.instanceString)?e.instanceString():null},We=function(e){return e!=null&&Or(e)==E8},gr=function(e){return e!=null&&Or(e)===S8},Qt=function(e){return!Jn(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},Dt=function(e){return e!=null&&Or(e)===iE&&!Qt(e)&&e.constructor===Object},M8=function(e){return e!=null&&Or(e)===iE},Be=function(e){return e!=null&&Or(e)===Or(1)&&!isNaN(e)},D8=function(e){return Be(e)&&Math.floor(e)===e},Kd=function(e){if(T8!=="undefined")return e!=null&&e instanceof HTMLElement},Jn=function(e){return rf(e)||aE(e)},rf=function(e){return tf(e)==="collection"&&e._private.single},aE=function(e){return tf(e)==="collection"&&!e._private.single},A2=function(e){return tf(e)==="core"},sE=function(e){return tf(e)==="stylesheet"},R8=function(e){return tf(e)==="event"},Ms=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},B8=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},I8=function(e){return Dt(e)&&Be(e.x1)&&Be(e.x2)&&Be(e.y1)&&Be(e.y2)},N8=function(e){return M8(e)&&gr(e.then)},F8=function(){return I5&&I5.userAgent.match(/msie|trident|edge/i)},Gl=function(e,n){n||(n=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var s=[],o=0;o<arguments.length;o++)s.push(arguments[o]);return s.join("$")});var i=function(){var s=this,o=arguments,l,c=n.apply(s,o),u=i.cache;return(l=u[c])||(l=u[c]=e.apply(s,o)),l};return i.cache={},i},x2=Gl(function(r){return r.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),b0=Gl(function(r){return r.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),oE=Gl(function(r,e){return r+e[0].toUpperCase()+e.substring(1)},function(r,e){return r+"$"+e}),N5=function(e){return Ms(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},As=function(e,n){return e.slice(-1*n.length)===n},Ur="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",k8="rgb[a]?\\(("+Ur+"[%]?)\\s*,\\s*("+Ur+"[%]?)\\s*,\\s*("+Ur+"[%]?)(?:\\s*,\\s*("+Ur+"))?\\)",U8="rgb[a]?\\((?:"+Ur+"[%]?)\\s*,\\s*(?:"+Ur+"[%]?)\\s*,\\s*(?:"+Ur+"[%]?)(?:\\s*,\\s*(?:"+Ur+"))?\\)",V8="hsl[a]?\\(("+Ur+")\\s*,\\s*("+Ur+"[%])\\s*,\\s*("+Ur+"[%])(?:\\s*,\\s*("+Ur+"))?\\)",O8="hsl[a]?\\((?:"+Ur+")\\s*,\\s*(?:"+Ur+"[%])\\s*,\\s*(?:"+Ur+"[%])(?:\\s*,\\s*(?:"+Ur+"))?\\)",P8="\\#[0-9a-fA-F]{3}",L8="\\#[0-9a-fA-F]{6}",lE=function(e,n){return e<n?-1:e>n?1:0},_8=function(e,n){return-1*lE(e,n)},et=Object.assign!=null?Object.assign.bind(Object):function(r){for(var e=arguments,n=1;n<e.length;n++){var i=e[n];if(i!=null)for(var a=Object.keys(i),s=0;s<a.length;s++){var o=a[s];r[o]=i[o]}}return r},z8=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var n=e.length===4,i,a,s,o=16;return n?(i=parseInt(e[1]+e[1],o),a=parseInt(e[2]+e[2],o),s=parseInt(e[3]+e[3],o)):(i=parseInt(e[1]+e[2],o),a=parseInt(e[3]+e[4],o),s=parseInt(e[5]+e[6],o)),[i,a,s]}},G8=function(e){var n,i,a,s,o,l,c,u;function h(y,b,x){return x<0&&(x+=1),x>1&&(x-=1),x<1/6?y+(b-y)*6*x:x<1/2?b:x<2/3?y+(b-y)*(2/3-x)*6:y}var g=new RegExp("^"+V8+"$").exec(e);if(g){if(i=parseInt(g[1]),i<0?i=(360- -1*i%360)%360:i>360&&(i=i%360),i/=360,a=parseFloat(g[2]),a<0||a>100||(a=a/100,s=parseFloat(g[3]),s<0||s>100)||(s=s/100,o=g[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(a===0)l=c=u=Math.round(s*255);else{var v=s<.5?s*(1+a):s+a-s*a,m=2*s-v;l=Math.round(255*h(m,v,i+1/3)),c=Math.round(255*h(m,v,i)),u=Math.round(255*h(m,v,i-1/3))}n=[l,c,u,o]}return n},q8=function(e){var n,i=new RegExp("^"+k8+"$").exec(e);if(i){n=[];for(var a=[],s=1;s<=3;s++){var o=i[s];if(o[o.length-1]==="%"&&(a[s]=!0),o=parseFloat(o),a[s]&&(o=o/100*255),o<0||o>255)return;n.push(Math.floor(o))}var l=a[1]||a[2]||a[3],c=a[1]&&a[2]&&a[3];if(l&&!c)return;var u=i[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;n.push(u)}}return n},Y8=function(e){return j8[e.toLowerCase()]},uE=function(e){return(Qt(e)?e:null)||Y8(e)||z8(e)||q8(e)||G8(e)},j8={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},cE=function(e){for(var n=e.map,i=e.keys,a=i.length,s=0;s<a;s++){var o=i[s];if(Dt(o))throw Error("Tried to set map with object key");s<i.length-1?(n[o]==null&&(n[o]={}),n=n[o]):n[o]=e.value}},fE=function(e){for(var n=e.map,i=e.keys,a=i.length,s=0;s<a;s++){var o=i[s];if(Dt(o))throw Error("Tried to get map with object key");if(n=n[o],n==null)return n}return n},Lh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var vm,F5;function af(){if(F5)return vm;F5=1;function r(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}return vm=r,vm}var mm,k5;function H8(){if(k5)return mm;k5=1;var r=typeof Lh=="object"&&Lh&&Lh.Object===Object&&Lh;return mm=r,mm}var pm,U5;function w0(){if(U5)return pm;U5=1;var r=H8(),e=typeof self=="object"&&self&&self.Object===Object&&self,n=r||e||Function("return this")();return pm=n,pm}var ym,V5;function K8(){if(V5)return ym;V5=1;var r=w0(),e=function(){return r.Date.now()};return ym=e,ym}var Am,O5;function X8(){if(O5)return Am;O5=1;var r=/\s/;function e(n){for(var i=n.length;i--&&r.test(n.charAt(i)););return i}return Am=e,Am}var xm,P5;function Q8(){if(P5)return xm;P5=1;var r=X8(),e=/^\s+/;function n(i){return i&&i.slice(0,r(i)+1).replace(e,"")}return xm=n,xm}var bm,L5;function b2(){if(L5)return bm;L5=1;var r=w0(),e=r.Symbol;return bm=e,bm}var wm,_5;function Z8(){if(_5)return wm;_5=1;var r=b2(),e=Object.prototype,n=e.hasOwnProperty,i=e.toString,a=r?r.toStringTag:void 0;function s(o){var l=n.call(o,a),c=o[a];try{o[a]=void 0;var u=!0}catch{}var h=i.call(o);return u&&(l?o[a]=c:delete o[a]),h}return wm=s,wm}var Cm,z5;function W8(){if(z5)return Cm;z5=1;var r=Object.prototype,e=r.toString;function n(i){return e.call(i)}return Cm=n,Cm}var Em,G5;function hE(){if(G5)return Em;G5=1;var r=b2(),e=Z8(),n=W8(),i="[object Null]",a="[object Undefined]",s=r?r.toStringTag:void 0;function o(l){return l==null?l===void 0?a:i:s&&s in Object(l)?e(l):n(l)}return Em=o,Em}var Sm,q5;function J8(){if(q5)return Sm;q5=1;function r(e){return e!=null&&typeof e=="object"}return Sm=r,Sm}var Tm,Y5;function sf(){if(Y5)return Tm;Y5=1;var r=hE(),e=J8(),n="[object Symbol]";function i(a){return typeof a=="symbol"||e(a)&&r(a)==n}return Tm=i,Tm}var Mm,j5;function $8(){if(j5)return Mm;j5=1;var r=Q8(),e=af(),n=sf(),i=NaN,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function c(u){if(typeof u=="number")return u;if(n(u))return i;if(e(u)){var h=typeof u.valueOf=="function"?u.valueOf():u;u=e(h)?h+"":h}if(typeof u!="string")return u===0?u:+u;u=r(u);var g=s.test(u);return g||o.test(u)?l(u.slice(2),g?2:8):a.test(u)?i:+u}return Mm=c,Mm}var Dm,H5;function eR(){if(H5)return Dm;H5=1;var r=af(),e=K8(),n=$8(),i="Expected a function",a=Math.max,s=Math.min;function o(l,c,u){var h,g,v,m,y,b,x=0,A=!1,C=!1,E=!0;if(typeof l!="function")throw new TypeError(i);c=n(c)||0,r(u)&&(A=!!u.leading,C="maxWait"in u,v=C?a(n(u.maxWait)||0,c):v,E="trailing"in u?!!u.trailing:E);function S(O){var V=h,L=g;return h=g=void 0,x=O,m=l.apply(L,V),m}function M(O){return x=O,y=setTimeout(B,c),A?S(O):m}function R(O){var V=O-b,L=O-x,P=c-V;return C?s(P,v-L):P}function T(O){var V=O-b,L=O-x;return b===void 0||V>=c||V<0||C&&L>=v}function B(){var O=e();if(T(O))return F(O);y=setTimeout(B,R(O))}function F(O){return y=void 0,E&&h?S(O):(h=g=void 0,m)}function I(){y!==void 0&&clearTimeout(y),x=0,h=b=g=y=void 0}function U(){return y===void 0?m:F(e())}function k(){var O=e(),V=T(O);if(h=arguments,g=this,b=O,V){if(y===void 0)return M(b);if(C)return clearTimeout(y),y=setTimeout(B,c),S(b)}return y===void 0&&(y=setTimeout(B,c)),m}return k.cancel=I,k.flush=U,k}return Dm=o,Dm}var tR=eR(),of=nf(tR),Rm=kr?kr.performance:null,dE=Rm&&Rm.now?function(){return Rm.now()}:function(){return Date.now()},rR=(function(){if(kr){if(kr.requestAnimationFrame)return function(r){kr.requestAnimationFrame(r)};if(kr.mozRequestAnimationFrame)return function(r){kr.mozRequestAnimationFrame(r)};if(kr.webkitRequestAnimationFrame)return function(r){kr.webkitRequestAnimationFrame(r)};if(kr.msRequestAnimationFrame)return function(r){kr.msRequestAnimationFrame(r)}}return function(r){r&&setTimeout(function(){r(dE())},1e3/60)}})(),Xd=function(e){return rR(e)},Ra=dE,uo=9261,gE=65599,Dl=5381,vE=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uo,i=n,a;a=e.next(),!a.done;)i=i*gE+a.value|0;return i},Vc=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uo;return n*gE+e|0},Oc=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Dl;return(n<<5)+n+e|0},nR=function(e,n){return e*2097152+n},ls=function(e){return e[0]*2097152+e[1]},_h=function(e,n){return[Vc(e[0],n[0]),Oc(e[1],n[1])]},K5=function(e,n){var i={value:0,done:!1},a=0,s=e.length,o={next:function(){return a<s?i.value=e[a++]:i.done=!0,i}};return vE(o,n)},bo=function(e,n){var i={value:0,done:!1},a=0,s=e.length,o={next:function(){return a<s?i.value=e.charCodeAt(a++):i.done=!0,i}};return vE(o,n)},mE=function(){return iR(arguments)},iR=function(e){for(var n,i=0;i<e.length;i++){var a=e[i];i===0?n=bo(a):n=bo(a,n)}return n};function aR(r,e,n,i,a){var s=a*Math.PI/180,o=Math.cos(s)*(r-n)-Math.sin(s)*(e-i)+n,l=Math.sin(s)*(r-n)+Math.cos(s)*(e-i)+i;return{x:o,y:l}}var sR=function(e,n,i,a,s,o){return{x:(e-i)*s+i,y:(n-a)*o+a}};function oR(r,e,n){if(n===0)return r;var i=(e.x1+e.x2)/2,a=(e.y1+e.y2)/2,s=e.w/e.h,o=1/s,l=aR(r.x,r.y,i,a,n),c=sR(l.x,l.y,i,a,s,o);return{x:c.x,y:c.y}}var X5=!0,lR=console.warn!=null,uR=console.trace!=null,w2=Number.MAX_SAFE_INTEGER||9007199254740991,pE=function(){return!0},Qd=function(){return!1},Q5=function(){return 0},C2=function(){},ur=function(e){throw new Error(e)},yE=function(e){if(e!==void 0)X5=!!e;else return X5},Pt=function(e){yE()&&(lR?console.warn(e):(console.log(e),uR&&console.trace()))},cR=function(e){return et({},e)},Hi=function(e){return e==null?e:Qt(e)?e.slice():Dt(e)?cR(e):e},fR=function(e){return e.slice()},AE=function(e,n){for(n=e="";e++<36;n+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return n},hR={},xE=function(){return hR},on=function(e){var n=Object.keys(e);return function(i){for(var a={},s=0;s<n.length;s++){var o=n[s],l=i?.[o];a[o]=l===void 0?e[o]:l}return a}},Ds=function(e,n,i){for(var a=e.length-1;a>=0;a--)e[a]===n&&e.splice(a,1)},E2=function(e){e.splice(0,e.length)},dR=function(e,n){for(var i=0;i<n.length;i++){var a=n[i];e.push(a)}},Un=function(e,n,i){return i&&(n=oE(i,n)),e[n]},Ca=function(e,n,i,a){i&&(n=oE(i,n)),e[n]=a},gR=(function(){function r(){Fs(this,r),this._obj={}}return ks(r,[{key:"set",value:function(n,i){return this._obj[n]=i,this}},{key:"delete",value:function(n){return this._obj[n]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(n){return this._obj[n]!==void 0}},{key:"get",value:function(n){return this._obj[n]}}])})(),Sa=typeof Map<"u"?Map:gR,vR="undefined",mR=(function(){function r(e){if(Fs(this,r),this._obj=Object.create(null),this.size=0,e!=null){var n;e.instanceString!=null&&e.instanceString()===this.instanceString()?n=e.toArray():n=e;for(var i=0;i<n.length;i++)this.add(n[i])}}return ks(r,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(n){var i=this._obj;i[n]!==1&&(i[n]=1,this.size++)}},{key:"delete",value:function(n){var i=this._obj;i[n]===1&&(i[n]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(n){return this._obj[n]===1}},{key:"toArray",value:function(){var n=this;return Object.keys(this._obj).filter(function(i){return n.has(i)})}},{key:"forEach",value:function(n,i){return this.toArray().forEach(n,i)}}])})(),Xl=(typeof Set>"u"?"undefined":Or(Set))!==vR?Set:mR,C0=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||n===void 0||!A2(e)){ur("An element must have a core reference and parameters set");return}var a=n.group;if(a==null&&(n.data&&n.data.source!=null&&n.data.target!=null?a="edges":a="nodes"),a!=="nodes"&&a!=="edges"){ur("An element must be of type `nodes` or `edges`; you specified `"+a+"`");return}this.length=1,this[0]=this;var s=this._private={cy:e,single:!0,data:n.data||{},position:n.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:a,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!n.selected,selectable:n.selectable===void 0?!0:!!n.selectable,locked:!!n.locked,grabbed:!1,grabbable:n.grabbable===void 0?!0:!!n.grabbable,pannable:n.pannable===void 0?a==="edges":!!n.pannable,active:!1,classes:new Xl,animation:{current:[],queue:[]},rscratch:{},scratch:n.scratch||{},edges:[],children:[],parent:n.parent&&n.parent.isNode()?n.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(s.position.x==null&&(s.position.x=0),s.position.y==null&&(s.position.y=0),n.renderedPosition){var o=n.renderedPosition,l=e.pan(),c=e.zoom();s.position={x:(o.x-l.x)/c,y:(o.y-l.y)/c}}var u=[];Qt(n.classes)?u=n.classes:We(n.classes)&&(u=n.classes.split(/\s+/));for(var h=0,g=u.length;h<g;h++){var v=u[h];!v||v===""||s.classes.add(v)}this.createEmitter(),(i===void 0||i)&&this.restore();var m=n.style||n.css;m&&(Pt("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(m))},Z5=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(i,a,s){var o;Dt(i)&&!Jn(i)&&(o=i,i=o.roots||o.root,a=o.visit,s=o.directed),s=arguments.length===2&&!gr(a)?a:s,a=gr(a)?a:function(){};for(var l=this._private.cy,c=i=We(i)?this.filter(i):i,u=[],h=[],g={},v={},m={},y=0,b,x=this.byGroup(),A=x.nodes,C=x.edges,E=0;E<c.length;E++){var S=c[E],M=S.id();S.isNode()&&(u.unshift(S),e.bfs&&(m[M]=!0,h.push(S)),v[M]=0)}for(var R=function(){var O=e.bfs?u.shift():u.pop(),V=O.id();if(e.dfs){if(m[V])return 0;m[V]=!0,h.push(O)}var L=v[V],P=g[V],_=P!=null?P.source():null,q=P!=null?P.target():null,H=P==null?void 0:O.same(_)?q[0]:_[0],W;if(W=a(O,P,H,y++,L),W===!0)return b=O,1;if(W===!1)return 1;for(var G=O.connectedEdges().filter(function(ue){return(!s||ue.source().same(O))&&C.has(ue)}),K=0;K<G.length;K++){var $=G[K],te=$.connectedNodes().filter(function(ue){return!ue.same(O)&&A.has(ue)}),ae=te.id();te.length!==0&&!m[ae]&&(te=te[0],u.push(te),e.bfs&&(m[ae]=!0,h.push(te)),g[ae]=$,v[ae]=v[V]+1)}},T;u.length!==0&&(T=R(),!(T!==0&&T===1)););for(var B=l.collection(),F=0;F<h.length;F++){var I=h[F],U=g[I.id()];U!=null&&B.push(U),B.push(I)}return{path:l.collection(B),found:l.collection(b)}}},Pc={breadthFirstSearch:Z5({bfs:!0}),depthFirstSearch:Z5({dfs:!0})};Pc.bfs=Pc.breadthFirstSearch;Pc.dfs=Pc.depthFirstSearch;var wd={exports:{}},pR=wd.exports,W5;function yR(){return W5||(W5=1,(function(r,e){(function(){var n,i,a,s,o,l,c,u,h,g,v,m,y,b,x;a=Math.floor,g=Math.min,i=function(A,C){return A<C?-1:A>C?1:0},h=function(A,C,E,S,M){var R;if(E==null&&(E=0),M==null&&(M=i),E<0)throw new Error("lo must be non-negative");for(S==null&&(S=A.length);E<S;)R=a((E+S)/2),M(C,A[R])<0?S=R:E=R+1;return[].splice.apply(A,[E,E-E].concat(C)),C},l=function(A,C,E){return E==null&&(E=i),A.push(C),b(A,0,A.length-1,E)},o=function(A,C){var E,S;return C==null&&(C=i),E=A.pop(),A.length?(S=A[0],A[0]=E,x(A,0,C)):S=E,S},u=function(A,C,E){var S;return E==null&&(E=i),S=A[0],A[0]=C,x(A,0,E),S},c=function(A,C,E){var S;return E==null&&(E=i),A.length&&E(A[0],C)<0&&(S=[A[0],C],C=S[0],A[0]=S[1],x(A,0,E)),C},s=function(A,C){var E,S,M,R,T,B;for(C==null&&(C=i),R=(function(){B=[];for(var F=0,I=a(A.length/2);0<=I?F<I:F>I;0<=I?F++:F--)B.push(F);return B}).apply(this).reverse(),T=[],S=0,M=R.length;S<M;S++)E=R[S],T.push(x(A,E,C));return T},y=function(A,C,E){var S;if(E==null&&(E=i),S=A.indexOf(C),S!==-1)return b(A,0,S,E),x(A,S,E)},v=function(A,C,E){var S,M,R,T,B;if(E==null&&(E=i),M=A.slice(0,C),!M.length)return M;for(s(M,E),B=A.slice(C),R=0,T=B.length;R<T;R++)S=B[R],c(M,S,E);return M.sort(E).reverse()},m=function(A,C,E){var S,M,R,T,B,F,I,U,k;if(E==null&&(E=i),C*10<=A.length){if(R=A.slice(0,C).sort(E),!R.length)return R;for(M=R[R.length-1],I=A.slice(C),T=0,F=I.length;T<F;T++)S=I[T],E(S,M)<0&&(h(R,S,0,null,E),R.pop(),M=R[R.length-1]);return R}for(s(A,E),k=[],B=0,U=g(C,A.length);0<=U?B<U:B>U;0<=U?++B:--B)k.push(o(A,E));return k},b=function(A,C,E,S){var M,R,T;for(S==null&&(S=i),M=A[E];E>C;){if(T=E-1>>1,R=A[T],S(M,R)<0){A[E]=R,E=T;continue}break}return A[E]=M},x=function(A,C,E){var S,M,R,T,B;for(E==null&&(E=i),M=A.length,B=C,R=A[C],S=2*C+1;S<M;)T=S+1,T<M&&!(E(A[S],A[T])<0)&&(S=T),A[C]=A[S],C=S,S=2*C+1;return A[C]=R,b(A,B,C,E)},n=(function(){A.push=l,A.pop=o,A.replace=u,A.pushpop=c,A.heapify=s,A.updateItem=y,A.nlargest=v,A.nsmallest=m;function A(C){this.cmp=C??i,this.nodes=[]}return A.prototype.push=function(C){return l(this.nodes,C,this.cmp)},A.prototype.pop=function(){return o(this.nodes,this.cmp)},A.prototype.peek=function(){return this.nodes[0]},A.prototype.contains=function(C){return this.nodes.indexOf(C)!==-1},A.prototype.replace=function(C){return u(this.nodes,C,this.cmp)},A.prototype.pushpop=function(C){return c(this.nodes,C,this.cmp)},A.prototype.heapify=function(){return s(this.nodes,this.cmp)},A.prototype.updateItem=function(C){return y(this.nodes,C,this.cmp)},A.prototype.clear=function(){return this.nodes=[]},A.prototype.empty=function(){return this.nodes.length===0},A.prototype.size=function(){return this.nodes.length},A.prototype.clone=function(){var C;return C=new A,C.nodes=this.nodes.slice(0),C},A.prototype.toArray=function(){return this.nodes.slice(0)},A.prototype.insert=A.prototype.push,A.prototype.top=A.prototype.peek,A.prototype.front=A.prototype.peek,A.prototype.has=A.prototype.contains,A.prototype.copy=A.prototype.clone,A})(),(function(A,C){return r.exports=C()})(this,function(){return n})}).call(pR)})(wd)),wd.exports}var Bm,J5;function AR(){return J5||(J5=1,Bm=yR()),Bm}var xR=AR(),lf=nf(xR),bR=on({root:null,weight:function(e){return 1},directed:!1}),wR={dijkstra:function(e){if(!Dt(e)){var n=arguments;e={root:n[0],weight:n[1],directed:n[2]}}var i=bR(e),a=i.root,s=i.weight,o=i.directed,l=this,c=s,u=We(a)?this.filter(a)[0]:a[0],h={},g={},v={},m=this.byGroup(),y=m.nodes,b=m.edges;b.unmergeBy(function(L){return L.isLoop()});for(var x=function(P){return h[P.id()]},A=function(P,_){h[P.id()]=_,C.updateItem(P)},C=new lf(function(L,P){return x(L)-x(P)}),E=0;E<y.length;E++){var S=y[E];h[S.id()]=S.same(u)?0:1/0,C.push(S)}for(var M=function(P,_){for(var q=(o?P.edgesTo(_):P.edgesWith(_)).intersect(b),H=1/0,W,G=0;G<q.length;G++){var K=q[G],$=c(K);($<H||!W)&&(H=$,W=K)}return{edge:W,dist:H}};C.size()>0;){var R=C.pop(),T=x(R),B=R.id();if(v[B]=T,T!==1/0)for(var F=R.neighborhood().intersect(y),I=0;I<F.length;I++){var U=F[I],k=U.id(),O=M(R,U),V=T+O.dist;V<x(U)&&(A(U,V),g[k]={node:R,edge:O.edge})}}return{distanceTo:function(P){var _=We(P)?y.filter(P)[0]:P[0];return v[_.id()]},pathTo:function(P){var _=We(P)?y.filter(P)[0]:P[0],q=[],H=_,W=H.id();if(_.length>0)for(q.unshift(_);g[W];){var G=g[W];q.unshift(G.edge),q.unshift(G.node),H=G.node,W=H.id()}return l.spawn(q)}}}},CR={kruskal:function(e){e=e||function(E){return 1};for(var n=this.byGroup(),i=n.nodes,a=n.edges,s=i.length,o=new Array(s),l=i,c=function(S){for(var M=0;M<o.length;M++){var R=o[M];if(R.has(S))return M}},u=0;u<s;u++)o[u]=this.spawn(i[u]);for(var h=a.sort(function(E,S){return e(E)-e(S)}),g=0;g<h.length;g++){var v=h[g],m=v.source()[0],y=v.target()[0],b=c(m),x=c(y),A=o[b],C=o[x];b!==x&&(l.merge(v),A.merge(C),o.splice(x,1))}return l}},ER=on({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),SR={aStar:function(e){var n=this.cy(),i=ER(e),a=i.root,s=i.goal,o=i.heuristic,l=i.directed,c=i.weight;a=n.collection(a)[0],s=n.collection(s)[0];var u=a.id(),h=s.id(),g={},v={},m={},y=new lf(function(W,G){return v[W.id()]-v[G.id()]}),b=new Xl,x={},A={},C=function(G,K){y.push(G),b.add(K)},E,S,M=function(){E=y.pop(),S=E.id(),b.delete(S)},R=function(G){return b.has(G)};C(a,u),g[u]=0,v[u]=o(a);for(var T=0;y.size()>0;){if(M(),T++,S===h){for(var B=[],F=s,I=h,U=A[I];B.unshift(F),U!=null&&B.unshift(U),F=x[I],F!=null;)I=F.id(),U=A[I];return{found:!0,distance:g[S],path:this.spawn(B),steps:T}}m[S]=!0;for(var k=E._private.edges,O=0;O<k.length;O++){var V=k[O];if(this.hasElementWithId(V.id())&&!(l&&V.data("source")!==S)){var L=V.source(),P=V.target(),_=L.id()!==S?L:P,q=_.id();if(this.hasElementWithId(q)&&!m[q]){var H=g[S]+c(V);if(!R(q)){g[q]=H,v[q]=H+o(_),C(_,q),x[q]=E,A[q]=V;continue}H<g[q]&&(g[q]=H,v[q]=H+o(_),x[q]=E,A[q]=V)}}}}return{found:!1,distance:void 0,path:void 0,steps:T}}},TR=on({weight:function(e){return 1},directed:!1}),MR={floydWarshall:function(e){for(var n=this.cy(),i=TR(e),a=i.weight,s=i.directed,o=a,l=this.byGroup(),c=l.nodes,u=l.edges,h=c.length,g=h*h,v=function($){return c.indexOf($)},m=function($){return c[$]},y=new Array(g),b=0;b<g;b++){var x=b%h,A=(b-x)/h;A===x?y[b]=0:y[b]=1/0}for(var C=new Array(g),E=new Array(g),S=0;S<u.length;S++){var M=u[S],R=M.source()[0],T=M.target()[0];if(R!==T){var B=v(R),F=v(T),I=B*h+F,U=o(M);if(y[I]>U&&(y[I]=U,C[I]=F,E[I]=M),!s){var k=F*h+B;!s&&y[k]>U&&(y[k]=U,C[k]=B,E[k]=M)}}}for(var O=0;O<h;O++)for(var V=0;V<h;V++)for(var L=V*h+O,P=0;P<h;P++){var _=V*h+P,q=O*h+P;y[L]+y[q]<y[_]&&(y[_]=y[L]+y[q],C[_]=C[L])}var H=function($){return(We($)?n.filter($):$)[0]},W=function($){return v(H($))},G={distance:function($,te){var ae=W($),ue=W(te);return y[ae*h+ue]},path:function($,te){var ae=W($),ue=W(te),re=m(ae);if(ae===ue)return re.collection();if(C[ae*h+ue]==null)return n.collection();var ve=n.collection(),le=ae,ie;for(ve.merge(re);ae!==ue;)le=ae,ae=C[ae*h+ue],ie=E[le*h+ae],ve.merge(ie),ve.merge(m(ae));return ve}};return G}},DR=on({weight:function(e){return 1},directed:!1,root:null}),RR={bellmanFord:function(e){var n=this,i=DR(e),a=i.weight,s=i.directed,o=i.root,l=a,c=this,u=this.cy(),h=this.byGroup(),g=h.edges,v=h.nodes,m=v.length,y=new Sa,b=!1,x=[];o=u.collection(o)[0],g.unmergeBy(function(it){return it.isLoop()});for(var A=g.length,C=function($e){var Xe=y.get($e.id());return Xe||(Xe={},y.set($e.id(),Xe)),Xe},E=function($e){return(We($e)?u.$($e):$e)[0]},S=function($e){return C(E($e)).dist},M=function($e){for(var Xe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,Ie=E($e),Ye=[],Ke=Ie;;){if(Ke==null)return n.spawn();var at=C(Ke),ke=at.edge,ft=at.pred;if(Ye.unshift(Ke[0]),Ke.same(Xe)&&Ye.length>0)break;ke!=null&&Ye.unshift(ke),Ke=ft}return c.spawn(Ye)},R=0;R<m;R++){var T=v[R],B=C(T);T.same(o)?B.dist=0:B.dist=1/0,B.pred=null,B.edge=null}for(var F=!1,I=function($e,Xe,Ie,Ye,Ke,at){var ke=Ye.dist+at;ke<Ke.dist&&!Ie.same(Ye.edge)&&(Ke.dist=ke,Ke.pred=$e,Ke.edge=Ie,F=!0)},U=1;U<m;U++){F=!1;for(var k=0;k<A;k++){var O=g[k],V=O.source(),L=O.target(),P=l(O),_=C(V),q=C(L);I(V,L,O,_,q,P),s||I(L,V,O,q,_,P)}if(!F)break}if(F)for(var H=[],W=0;W<A;W++){var G=g[W],K=G.source(),$=G.target(),te=l(G),ae=C(K).dist,ue=C($).dist;if(ae+te<ue||!s&&ue+te<ae)if(b||(Pt("Graph contains a negative weight cycle for Bellman-Ford"),b=!0),e.findNegativeWeightCycles!==!1){var re=[];ae+te<ue&&re.push(K),!s&&ue+te<ae&&re.push($);for(var ve=re.length,le=0;le<ve;le++){var ie=re[le],se=[ie];se.push(C(ie).edge);for(var fe=C(ie).pred;se.indexOf(fe)===-1;)se.push(fe),se.push(C(fe).edge),fe=C(fe).pred;se=se.slice(se.indexOf(fe));for(var xe=se[0].id(),De=0,ze=2;ze<se.length;ze+=2)se[ze].id()<xe&&(xe=se[ze].id(),De=ze);se=se.slice(De).concat(se.slice(0,De)),se.push(se[0]);var gt=se.map(function(it){return it.id()}).join(",");H.indexOf(gt)===-1&&(x.push(c.spawn(se)),H.push(gt))}}else break}return{distanceTo:S,pathTo:M,hasNegativeWeightCycle:b,negativeWeightCycles:x}}},BR=Math.sqrt(2),IR=function(e,n,i){i.length===0&&ur("Karger-Stein must be run on a connected (sub)graph");for(var a=i[e],s=a[1],o=a[2],l=n[s],c=n[o],u=i,h=u.length-1;h>=0;h--){var g=u[h],v=g[1],m=g[2];(n[v]===l&&n[m]===c||n[v]===c&&n[m]===l)&&u.splice(h,1)}for(var y=0;y<u.length;y++){var b=u[y];b[1]===c?(u[y]=b.slice(),u[y][1]=l):b[2]===c&&(u[y]=b.slice(),u[y][2]=l)}for(var x=0;x<n.length;x++)n[x]===c&&(n[x]=l);return u},Im=function(e,n,i,a){for(;i>a;){var s=Math.floor(Math.random()*n.length);n=IR(s,e,n),i--}return n},NR={kargerStein:function(){var e=this,n=this.byGroup(),i=n.nodes,a=n.edges;a.unmergeBy(function(q){return q.isLoop()});var s=i.length,o=a.length,l=Math.ceil(Math.pow(Math.log(s)/Math.LN2,2)),c=Math.floor(s/BR);if(s<2){ur("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],h=0;h<o;h++){var g=a[h];u.push([h,i.indexOf(g.source()),i.indexOf(g.target())])}for(var v=1/0,m=[],y=new Array(s),b=new Array(s),x=new Array(s),A=function(H,W){for(var G=0;G<s;G++)W[G]=H[G]},C=0;C<=l;C++){for(var E=0;E<s;E++)b[E]=E;var S=Im(b,u.slice(),s,c),M=S.slice();A(b,x);var R=Im(b,S,c,2),T=Im(x,M,c,2);R.length<=T.length&&R.length<v?(v=R.length,m=R,A(b,y)):T.length<=R.length&&T.length<v&&(v=T.length,m=T,A(x,y))}for(var B=this.spawn(m.map(function(q){return a[q[0]]})),F=this.spawn(),I=this.spawn(),U=y[0],k=0;k<y.length;k++){var O=y[k],V=i[k];O===U?F.merge(V):I.merge(V)}var L=function(H){var W=e.spawn();return H.forEach(function(G){W.merge(G),G.connectedEdges().forEach(function(K){e.contains(K)&&!B.contains(K)&&W.merge(K)})}),W},P=[L(F),L(I)],_={cut:B,components:P,partition1:F,partition2:I};return _}},Nm,FR=function(e){return{x:e.x,y:e.y}},E0=function(e,n,i){return{x:e.x*n+i.x,y:e.y*n+i.y}},bE=function(e,n,i){return{x:(e.x-i.x)/n,y:(e.y-i.y)/n}},Nl=function(e){return{x:e[0],y:e[1]}},kR=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=1/0,s=n;s<i;s++){var o=e[s];isFinite(o)&&(a=Math.min(o,a))}return a},UR=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=-1/0,s=n;s<i;s++){var o=e[s];isFinite(o)&&(a=Math.max(o,a))}return a},VR=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=0,s=0,o=n;o<i;o++){var l=e[o];isFinite(l)&&(a+=l,s++)}return a/s},OR=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;a?e=e.slice(n,i):(i<e.length&&e.splice(i,e.length-i),n>0&&e.splice(0,n));for(var l=0,c=e.length-1;c>=0;c--){var u=e[c];o?isFinite(u)||(e[c]=-1/0,l++):e.splice(c,1)}s&&e.sort(function(v,m){return v-m});var h=e.length,g=Math.floor(h/2);return h%2!==0?e[g+1+l]:(e[g-1+l]+e[g+l])/2},PR=function(e){return Math.PI*e/180},zh=function(e,n){return Math.atan2(n,e)-Math.PI/2},S2=Math.log2||function(r){return Math.log(r)/Math.log(2)},T2=function(e){return e>0?1:e<0?-1:0},wo=function(e,n){return Math.sqrt(oo(e,n))},oo=function(e,n){var i=n.x-e.x,a=n.y-e.y;return i*i+a*a},LR=function(e){for(var n=e.length,i=0,a=0;a<n;a++)i+=e[a];for(var s=0;s<n;s++)e[s]=e[s]/i;return e},Hr=function(e,n,i,a){return(1-a)*(1-a)*e+2*(1-a)*a*n+a*a*i},Vl=function(e,n,i,a){return{x:Hr(e.x,n.x,i.x,a),y:Hr(e.y,n.y,i.y,a)}},_R=function(e,n,i,a){var s={x:n.x-e.x,y:n.y-e.y},o=wo(e,n),l={x:s.x/o,y:s.y/o};return i=i??0,a=a??i*o,{x:e.x+l.x*a,y:e.y+l.y*a}},Lc=function(e,n,i){return Math.max(e,Math.min(i,n))},wn=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},zR=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},GR=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},qR=function(e,n){e.x1=Math.min(e.x1,n.x1),e.x2=Math.max(e.x2,n.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n.y1),e.y2=Math.max(e.y2,n.y2),e.h=e.y2-e.y1},wE=function(e,n,i){e.x1=Math.min(e.x1,n),e.x2=Math.max(e.x2,n),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,i),e.y2=Math.max(e.y2,i),e.h=e.y2-e.y1},Cd=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=n,e.x2+=n,e.y1-=n,e.y2+=n,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Ed=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],i,a,s,o;if(n.length===1)i=a=s=o=n[0];else if(n.length===2)i=s=n[0],o=a=n[1];else if(n.length===4){var l=Ir(n,4);i=l[0],a=l[1],s=l[2],o=l[3]}return e.x1-=o,e.x2+=a,e.y1-=i,e.y2+=s,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},$5=function(e,n){e.x1=n.x1,e.y1=n.y1,e.x2=n.x2,e.y2=n.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},M2=function(e,n){return!(e.x1>n.x2||n.x1>e.x2||e.x2<n.x1||n.x2<e.x1||e.y2<n.y1||n.y2<e.y1||e.y1>n.y2||n.y1>e.y2)},xs=function(e,n,i){return e.x1<=n&&n<=e.x2&&e.y1<=i&&i<=e.y2},ew=function(e,n){return xs(e,n.x,n.y)},CE=function(e,n){return xs(e,n.x1,n.y1)&&xs(e,n.x2,n.y2)},YR=(Nm=Math.hypot)!==null&&Nm!==void 0?Nm:function(r,e){return Math.sqrt(r*r+e*e)};function jR(r,e){if(r.length<3)throw new Error("Need at least 3 vertices");var n=function(B,F){return{x:B.x+F.x,y:B.y+F.y}},i=function(B,F){return{x:B.x-F.x,y:B.y-F.y}},a=function(B,F){return{x:B.x*F,y:B.y*F}},s=function(B,F){return B.x*F.y-B.y*F.x},o=function(B){var F=YR(B.x,B.y);return F===0?{x:0,y:0}:{x:B.x/F,y:B.y/F}},l=function(B){for(var F=0,I=0;I<B.length;I++){var U=B[I],k=B[(I+1)%B.length];F+=U.x*k.y-k.x*U.y}return F/2},c=function(B,F,I,U){var k=i(F,B),O=i(U,I),V=s(k,O);if(Math.abs(V)<1e-9)return n(B,a(k,.5));var L=s(i(I,B),O)/V;return n(B,a(k,L))},u=r.map(function(T){return{x:T.x,y:T.y}});l(u)<0&&u.reverse();for(var h=u.length,g=[],v=0;v<h;v++){var m=u[v],y=u[(v+1)%h],b=i(y,m),x=o({x:b.y,y:-b.x});g.push(x)}for(var A=g.map(function(T,B){var F=n(u[B],a(T,e)),I=n(u[(B+1)%h],a(T,e));return{p1:F,p2:I}}),C=[],E=0;E<h;E++){var S=A[(E-1+h)%h],M=A[E],R=c(S.p1,S.p2,M.p1,M.p2);C.push(R)}return C}function HR(r,e,n,i,a,s){var o=tB(r,e,n,i,a),l=jR(o,s),c=wn();return l.forEach(function(u){return wE(c,u.x,u.y)}),c}var EE=function(e,n,i,a,s,o,l){var c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",u=c==="auto"?Rs(s,o):c,h=s/2,g=o/2;u=Math.min(u,h,g);var v=u!==h,m=u!==g,y;if(v){var b=i-h+u-l,x=a-g-l,A=i+h-u+l,C=x;if(y=bs(e,n,i,a,b,x,A,C,!1),y.length>0)return y}if(m){var E=i+h+l,S=a-g+u-l,M=E,R=a+g-u+l;if(y=bs(e,n,i,a,E,S,M,R,!1),y.length>0)return y}if(v){var T=i-h+u-l,B=a+g+l,F=i+h-u+l,I=B;if(y=bs(e,n,i,a,T,B,F,I,!1),y.length>0)return y}if(m){var U=i-h-l,k=a-g+u-l,O=U,V=a+g-u+l;if(y=bs(e,n,i,a,U,k,O,V,!1),y.length>0)return y}var L;{var P=i-h+u,_=a-g+u;if(L=vc(e,n,i,a,P,_,u+l),L.length>0&&L[0]<=P&&L[1]<=_)return[L[0],L[1]]}{var q=i+h-u,H=a-g+u;if(L=vc(e,n,i,a,q,H,u+l),L.length>0&&L[0]>=q&&L[1]<=H)return[L[0],L[1]]}{var W=i+h-u,G=a+g-u;if(L=vc(e,n,i,a,W,G,u+l),L.length>0&&L[0]>=W&&L[1]>=G)return[L[0],L[1]]}{var K=i-h+u,$=a+g-u;if(L=vc(e,n,i,a,K,$,u+l),L.length>0&&L[0]<=K&&L[1]>=$)return[L[0],L[1]]}return[]},KR=function(e,n,i,a,s,o,l){var c=l,u=Math.min(i,s),h=Math.max(i,s),g=Math.min(a,o),v=Math.max(a,o);return u-c<=e&&e<=h+c&&g-c<=n&&n<=v+c},XR=function(e,n,i,a,s,o,l,c,u){var h={x1:Math.min(i,l,s)-u,x2:Math.max(i,l,s)+u,y1:Math.min(a,c,o)-u,y2:Math.max(a,c,o)+u};return!(e<h.x1||e>h.x2||n<h.y1||n>h.y2)},QR=function(e,n,i,a){i-=a;var s=n*n-4*e*i;if(s<0)return[];var o=Math.sqrt(s),l=2*e,c=(-n+o)/l,u=(-n-o)/l;return[c,u]},ZR=function(e,n,i,a,s){var o=1e-5;e===0&&(e=o),n/=e,i/=e,a/=e;var l,c,u,h,g,v,m,y;if(c=(3*i-n*n)/9,u=-(27*a)+n*(9*i-2*(n*n)),u/=54,l=c*c*c+u*u,s[1]=0,m=n/3,l>0){g=u+Math.sqrt(l),g=g<0?-Math.pow(-g,1/3):Math.pow(g,1/3),v=u-Math.sqrt(l),v=v<0?-Math.pow(-v,1/3):Math.pow(v,1/3),s[0]=-m+g+v,m+=(g+v)/2,s[4]=s[2]=-m,m=Math.sqrt(3)*(-v+g)/2,s[3]=m,s[5]=-m;return}if(s[5]=s[3]=0,l===0){y=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),s[0]=-m+2*y,s[4]=s[2]=-(y+m);return}c=-c,h=c*c*c,h=Math.acos(u/Math.sqrt(h)),y=2*Math.sqrt(c),s[0]=-m+y*Math.cos(h/3),s[2]=-m+y*Math.cos((h+2*Math.PI)/3),s[4]=-m+y*Math.cos((h+4*Math.PI)/3)},WR=function(e,n,i,a,s,o,l,c){var u=1*i*i-4*i*s+2*i*l+4*s*s-4*s*l+l*l+a*a-4*a*o+2*a*c+4*o*o-4*o*c+c*c,h=9*i*s-3*i*i-3*i*l-6*s*s+3*s*l+9*a*o-3*a*a-3*a*c-6*o*o+3*o*c,g=3*i*i-6*i*s+i*l-i*e+2*s*s+2*s*e-l*e+3*a*a-6*a*o+a*c-a*n+2*o*o+2*o*n-c*n,v=1*i*s-i*i+i*e-s*e+a*o-a*a+a*n-o*n,m=[];ZR(u,h,g,v,m);for(var y=1e-7,b=[],x=0;x<6;x+=2)Math.abs(m[x+1])<y&&m[x]>=0&&m[x]<=1&&b.push(m[x]);b.push(1),b.push(0);for(var A=-1,C,E,S,M=0;M<b.length;M++)C=Math.pow(1-b[M],2)*i+2*(1-b[M])*b[M]*s+b[M]*b[M]*l,E=Math.pow(1-b[M],2)*a+2*(1-b[M])*b[M]*o+b[M]*b[M]*c,S=Math.pow(C-e,2)+Math.pow(E-n,2),A>=0?S<A&&(A=S):A=S;return A},JR=function(e,n,i,a,s,o){var l=[e-i,n-a],c=[s-i,o-a],u=c[0]*c[0]+c[1]*c[1],h=l[0]*l[0]+l[1]*l[1],g=l[0]*c[0]+l[1]*c[1],v=g*g/u;return g<0?h:v>u?(e-s)*(e-s)+(n-o)*(n-o):h-v},Vn=function(e,n,i){for(var a,s,o,l,c,u=0,h=0;h<i.length/2;h++)if(a=i[h*2],s=i[h*2+1],h+1<i.length/2?(o=i[(h+1)*2],l=i[(h+1)*2+1]):(o=i[(h+1-i.length/2)*2],l=i[(h+1-i.length/2)*2+1]),!(a==e&&o==e))if(a>=e&&e>=o||a<=e&&e<=o)c=(e-a)/(o-a)*(l-s)+s,c>n&&u++;else continue;return u%2!==0},Ba=function(e,n,i,a,s,o,l,c,u){var h=new Array(i.length),g;c[0]!=null?(g=Math.atan(c[1]/c[0]),c[0]<0?g=g+Math.PI/2:g=-g-Math.PI/2):g=c;for(var v=Math.cos(-g),m=Math.sin(-g),y=0;y<h.length/2;y++)h[y*2]=o/2*(i[y*2]*v-i[y*2+1]*m),h[y*2+1]=l/2*(i[y*2+1]*v+i[y*2]*m),h[y*2]+=a,h[y*2+1]+=s;var b;if(u>0){var x=Wd(h,-u);b=Zd(x)}else b=h;return Vn(e,n,b)},$R=function(e,n,i,a,s,o,l,c){for(var u=new Array(i.length*2),h=0;h<c.length;h++){var g=c[h];u[h*4+0]=g.startX,u[h*4+1]=g.startY,u[h*4+2]=g.stopX,u[h*4+3]=g.stopY;var v=Math.pow(g.cx-e,2)+Math.pow(g.cy-n,2);if(v<=Math.pow(g.radius,2))return!0}return Vn(e,n,u)},Zd=function(e){for(var n=new Array(e.length/2),i,a,s,o,l,c,u,h,g=0;g<e.length/4;g++){i=e[g*4],a=e[g*4+1],s=e[g*4+2],o=e[g*4+3],g<e.length/4-1?(l=e[(g+1)*4],c=e[(g+1)*4+1],u=e[(g+1)*4+2],h=e[(g+1)*4+3]):(l=e[0],c=e[1],u=e[2],h=e[3]);var v=bs(i,a,s,o,l,c,u,h,!0);n[g*2]=v[0],n[g*2+1]=v[1]}return n},Wd=function(e,n){for(var i=new Array(e.length*2),a,s,o,l,c=0;c<e.length/2;c++){a=e[c*2],s=e[c*2+1],c<e.length/2-1?(o=e[(c+1)*2],l=e[(c+1)*2+1]):(o=e[0],l=e[1]);var u=l-s,h=-(o-a),g=Math.sqrt(u*u+h*h),v=u/g,m=h/g;i[c*4]=a+v*n,i[c*4+1]=s+m*n,i[c*4+2]=o+v*n,i[c*4+3]=l+m*n}return i},eB=function(e,n,i,a,s,o){var l=i-e,c=a-n;l/=s,c/=o;var u=Math.sqrt(l*l+c*c),h=u-1;if(h<0)return[];var g=h/u;return[(i-e)*g+e,(a-n)*g+n]},go=function(e,n,i,a,s,o,l){return e-=s,n-=o,e/=i/2+l,n/=a/2+l,e*e+n*n<=1},vc=function(e,n,i,a,s,o,l){var c=[i-e,a-n],u=[e-s,n-o],h=c[0]*c[0]+c[1]*c[1],g=2*(u[0]*c[0]+u[1]*c[1]),v=u[0]*u[0]+u[1]*u[1]-l*l,m=g*g-4*h*v;if(m<0)return[];var y=(-g+Math.sqrt(m))/(2*h),b=(-g-Math.sqrt(m))/(2*h),x=Math.min(y,b),A=Math.max(y,b),C=[];if(x>=0&&x<=1&&C.push(x),A>=0&&A<=1&&C.push(A),C.length===0)return[];var E=C[0]*c[0]+e,S=C[0]*c[1]+n;if(C.length>1){if(C[0]==C[1])return[E,S];var M=C[1]*c[0]+e,R=C[1]*c[1]+n;return[E,S,M,R]}else return[E,S]},Fm=function(e,n,i){return n<=e&&e<=i||i<=e&&e<=n?e:e<=n&&n<=i||i<=n&&n<=e?n:i},bs=function(e,n,i,a,s,o,l,c,u){var h=e-s,g=i-e,v=l-s,m=n-o,y=a-n,b=c-o,x=v*m-b*h,A=g*m-y*h,C=b*g-v*y;if(C!==0){var E=x/C,S=A/C,M=.001,R=0-M,T=1+M;return R<=E&&E<=T&&R<=S&&S<=T?[e+E*g,n+E*y]:u?[e+E*g,n+E*y]:[]}else return x===0||A===0?Fm(e,i,l)===l?[l,c]:Fm(e,i,s)===s?[s,o]:Fm(s,l,i)===i?[i,a]:[]:[]},tB=function(e,n,i,a,s){var o=[],l=a/2,c=s/2,u=n,h=i;o.push({x:u+l*e[0],y:h+c*e[1]});for(var g=1;g<e.length/2;g++)o.push({x:u+l*e[g*2],y:h+c*e[g*2+1]});return o},_c=function(e,n,i,a,s,o,l,c){var u=[],h,g=new Array(i.length),v=!0;o==null&&(v=!1);var m;if(v){for(var y=0;y<g.length/2;y++)g[y*2]=i[y*2]*o+a,g[y*2+1]=i[y*2+1]*l+s;if(c>0){var b=Wd(g,-c);m=Zd(b)}else m=g}else m=i;for(var x,A,C,E,S=0;S<m.length/2;S++)x=m[S*2],A=m[S*2+1],S<m.length/2-1?(C=m[(S+1)*2],E=m[(S+1)*2+1]):(C=m[0],E=m[1]),h=bs(e,n,a,s,x,A,C,E),h.length!==0&&u.push(h[0],h[1]);return u},rB=function(e,n,i,a,s,o,l,c,u){var h=[],g,v=new Array(i.length*2);u.forEach(function(C,E){E===0?(v[v.length-2]=C.startX,v[v.length-1]=C.startY):(v[E*4-2]=C.startX,v[E*4-1]=C.startY),v[E*4]=C.stopX,v[E*4+1]=C.stopY,g=vc(e,n,a,s,C.cx,C.cy,C.radius),g.length!==0&&h.push(g[0],g[1])});for(var m=0;m<v.length/4;m++)g=bs(e,n,a,s,v[m*4],v[m*4+1],v[m*4+2],v[m*4+3],!1),g.length!==0&&h.push(g[0],g[1]);if(h.length>2){for(var y=[h[0],h[1]],b=Math.pow(y[0]-e,2)+Math.pow(y[1]-n,2),x=1;x<h.length/2;x++){var A=Math.pow(h[x*2]-e,2)+Math.pow(h[x*2+1]-n,2);A<=b&&(y[0]=h[x*2],y[1]=h[x*2+1],b=A)}return y}return h},Gh=function(e,n,i){var a=[e[0]-n[0],e[1]-n[1]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=(s-i)/s;return o<0&&(o=1e-5),[n[0]+o*a[0],n[1]+o*a[1]]},An=function(e,n){var i=wp(e,n);return i=SE(i),i},SE=function(e){for(var n,i,a=e.length/2,s=1/0,o=1/0,l=-1/0,c=-1/0,u=0;u<a;u++)n=e[2*u],i=e[2*u+1],s=Math.min(s,n),l=Math.max(l,n),o=Math.min(o,i),c=Math.max(c,i);for(var h=2/(l-s),g=2/(c-o),v=0;v<a;v++)n=e[2*v]=e[2*v]*h,i=e[2*v+1]=e[2*v+1]*g,s=Math.min(s,n),l=Math.max(l,n),o=Math.min(o,i),c=Math.max(c,i);if(o<-1)for(var m=0;m<a;m++)i=e[2*m+1]=e[2*m+1]+(-1-o);return e},wp=function(e,n){var i=1/e*2*Math.PI,a=e%2===0?Math.PI/2+i/2:Math.PI/2;a+=n;for(var s=new Array(e*2),o,l=0;l<e;l++)o=l*i+a,s[2*l]=Math.cos(o),s[2*l+1]=Math.sin(-o);return s},Rs=function(e,n){return Math.min(e/4,n/4,8)},TE=function(e,n){return Math.min(e/10,n/10,8)},D2=function(){return 8},nB=function(e,n,i){return[e-2*n+i,2*(n-e),e]},Cp=function(e,n){return{heightOffset:Math.min(15,.05*n),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function km(r,e){function n(g){for(var v=[],m=0;m<g.length;m++){var y=g[m],b=g[(m+1)%g.length],x={x:b.x-y.x,y:b.y-y.y},A={x:-x.y,y:x.x},C=Math.sqrt(A.x*A.x+A.y*A.y);v.push({x:A.x/C,y:A.y/C})}return v}function i(g,v){var m=1/0,y=-1/0,b=On(g),x;try{for(b.s();!(x=b.n()).done;){var A=x.value,C=A.x*v.x+A.y*v.y;m=Math.min(m,C),y=Math.max(y,C)}}catch(E){b.e(E)}finally{b.f()}return{min:m,max:y}}function a(g,v){return!(g.max<v.min||v.max<g.min)}var s=[].concat(Hd(n(r)),Hd(n(e))),o=On(s),l;try{for(o.s();!(l=o.n()).done;){var c=l.value,u=i(r,c),h=i(e,c);if(!a(u,h))return!1}}catch(g){o.e(g)}finally{o.f()}return!0}var iB=on({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),aB={pageRank:function(e){for(var n=iB(e),i=n.dampingFactor,a=n.precision,s=n.iterations,o=n.weight,l=this._private.cy,c=this.byGroup(),u=c.nodes,h=c.edges,g=u.length,v=g*g,m=h.length,y=new Array(v),b=new Array(g),x=(1-i)/g,A=0;A<g;A++){for(var C=0;C<g;C++){var E=A*g+C;y[E]=0}b[A]=0}for(var S=0;S<m;S++){var M=h[S],R=M.data("source"),T=M.data("target");if(R!==T){var B=u.indexOfId(R),F=u.indexOfId(T),I=o(M),U=F*g+B;y[U]+=I,b[B]+=I}}for(var k=1/g+x,O=0;O<g;O++)if(b[O]===0)for(var V=0;V<g;V++){var L=V*g+O;y[L]=k}else for(var P=0;P<g;P++){var _=P*g+O;y[_]=y[_]/b[O]+x}for(var q=new Array(g),H=new Array(g),W,G=0;G<g;G++)q[G]=1;for(var K=0;K<s;K++){for(var $=0;$<g;$++)H[$]=0;for(var te=0;te<g;te++)for(var ae=0;ae<g;ae++){var ue=te*g+ae;H[te]+=y[ue]*q[ae]}LR(H),W=q,q=H,H=W;for(var re=0,ve=0;ve<g;ve++){var le=W[ve]-q[ve];re+=le*le}if(re<a)break}var ie={rank:function(fe){return fe=l.collection(fe)[0],q[u.indexOf(fe)]}};return ie}},tw=on({root:null,weight:function(e){return 1},directed:!1,alpha:0}),Ol={degreeCentralityNormalized:function(e){e=tw(e);var n=this.cy(),i=this.nodes(),a=i.length;if(e.directed){for(var h={},g={},v=0,m=0,y=0;y<a;y++){var b=i[y],x=b.id();e.root=b;var A=this.degreeCentrality(e);v<A.indegree&&(v=A.indegree),m<A.outdegree&&(m=A.outdegree),h[x]=A.indegree,g[x]=A.outdegree}return{indegree:function(E){return v==0?0:(We(E)&&(E=n.filter(E)),h[E.id()]/v)},outdegree:function(E){return m===0?0:(We(E)&&(E=n.filter(E)),g[E.id()]/m)}}}else{for(var s={},o=0,l=0;l<a;l++){var c=i[l];e.root=c;var u=this.degreeCentrality(e);o<u.degree&&(o=u.degree),s[c.id()]=u.degree}return{degree:function(E){return o===0?0:(We(E)&&(E=n.filter(E)),s[E.id()]/o)}}}},degreeCentrality:function(e){e=tw(e);var n=this.cy(),i=this,a=e,s=a.root,o=a.weight,l=a.directed,c=a.alpha;if(s=n.collection(s)[0],l){for(var m=s.connectedEdges(),y=m.filter(function(R){return R.target().same(s)&&i.has(R)}),b=m.filter(function(R){return R.source().same(s)&&i.has(R)}),x=y.length,A=b.length,C=0,E=0,S=0;S<y.length;S++)C+=o(y[S]);for(var M=0;M<b.length;M++)E+=o(b[M]);return{indegree:Math.pow(x,1-c)*Math.pow(C,c),outdegree:Math.pow(A,1-c)*Math.pow(E,c)}}else{for(var u=s.connectedEdges().intersection(i),h=u.length,g=0,v=0;v<u.length;v++)g+=o(u[v]);return{degree:Math.pow(h,1-c)*Math.pow(g,c)}}}};Ol.dc=Ol.degreeCentrality;Ol.dcn=Ol.degreeCentralityNormalised=Ol.degreeCentralityNormalized;var rw=on({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),Pl={closenessCentralityNormalized:function(e){for(var n=rw(e),i=n.harmonic,a=n.weight,s=n.directed,o=this.cy(),l={},c=0,u=this.nodes(),h=this.floydWarshall({weight:a,directed:s}),g=0;g<u.length;g++){for(var v=0,m=u[g],y=0;y<u.length;y++)if(g!==y){var b=h.distance(m,u[y]);i?v+=1/b:v+=b}i||(v=1/v),c<v&&(c=v),l[m.id()]=v}return{closeness:function(A){return c==0?0:(We(A)?A=o.filter(A)[0].id():A=A.id(),l[A]/c)}}},closenessCentrality:function(e){var n=rw(e),i=n.root,a=n.weight,s=n.directed,o=n.harmonic;i=this.filter(i)[0];for(var l=this.dijkstra({root:i,weight:a,directed:s}),c=0,u=this.nodes(),h=0;h<u.length;h++){var g=u[h];if(!g.same(i)){var v=l.distanceTo(g);o?c+=1/v:c+=v}}return o?c:1/c}};Pl.cc=Pl.closenessCentrality;Pl.ccn=Pl.closenessCentralityNormalised=Pl.closenessCentralityNormalized;var sB=on({weight:null,directed:!1}),Ep={betweennessCentrality:function(e){for(var n=sB(e),i=n.directed,a=n.weight,s=a!=null,o=this.cy(),l=this.nodes(),c={},u={},h=0,g={set:function(E,S){u[E]=S,S>h&&(h=S)},get:function(E){return u[E]}},v=0;v<l.length;v++){var m=l[v],y=m.id();i?c[y]=m.outgoers().nodes():c[y]=m.openNeighborhood().nodes(),g.set(y,0)}for(var b=function(){for(var E=l[x].id(),S=[],M={},R={},T={},B=new lf(function(te,ae){return T[te]-T[ae]}),F=0;F<l.length;F++){var I=l[F].id();M[I]=[],R[I]=0,T[I]=1/0}for(R[E]=1,T[E]=0,B.push(E);!B.empty();){var U=B.pop();if(S.push(U),s)for(var k=0;k<c[U].length;k++){var O=c[U][k],V=o.getElementById(U),L=void 0;V.edgesTo(O).length>0?L=V.edgesTo(O)[0]:L=O.edgesTo(V)[0];var P=a(L);O=O.id(),T[O]>T[U]+P&&(T[O]=T[U]+P,B.nodes.indexOf(O)<0?B.push(O):B.updateItem(O),R[O]=0,M[O]=[]),T[O]==T[U]+P&&(R[O]=R[O]+R[U],M[O].push(U))}else for(var _=0;_<c[U].length;_++){var q=c[U][_].id();T[q]==1/0&&(B.push(q),T[q]=T[U]+1),T[q]==T[U]+1&&(R[q]=R[q]+R[U],M[q].push(U))}}for(var H={},W=0;W<l.length;W++)H[l[W].id()]=0;for(;S.length>0;){for(var G=S.pop(),K=0;K<M[G].length;K++){var $=M[G][K];H[$]=H[$]+R[$]/R[G]*(1+H[G])}G!=l[x].id()&&g.set(G,g.get(G)+H[G])}},x=0;x<l.length;x++)b();var A={betweenness:function(E){var S=o.collection(E).id();return g.get(S)},betweennessNormalized:function(E){if(h==0)return 0;var S=o.collection(E).id();return g.get(S)/h}};return A.betweennessNormalised=A.betweennessNormalized,A}};Ep.bc=Ep.betweennessCentrality;var oB=on({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(r){return 1}]}),lB=function(e){return oB(e)},uB=function(e,n){for(var i=0,a=0;a<n.length;a++)i+=n[a](e);return i},cB=function(e,n,i){for(var a=0;a<n;a++)e[a*n+a]=i},ME=function(e,n){for(var i,a=0;a<n;a++){i=0;for(var s=0;s<n;s++)i+=e[s*n+a];for(var o=0;o<n;o++)e[o*n+a]=e[o*n+a]/i}},fB=function(e,n,i){for(var a=new Array(i*i),s=0;s<i;s++){for(var o=0;o<i;o++)a[s*i+o]=0;for(var l=0;l<i;l++)for(var c=0;c<i;c++)a[s*i+c]+=e[s*i+l]*n[l*i+c]}return a},hB=function(e,n,i){for(var a=e.slice(0),s=1;s<i;s++)e=fB(e,a,n);return e},dB=function(e,n,i){for(var a=new Array(n*n),s=0;s<n*n;s++)a[s]=Math.pow(e[s],i);return ME(a,n),a},gB=function(e,n,i,a){for(var s=0;s<i;s++){var o=Math.round(e[s]*Math.pow(10,a))/Math.pow(10,a),l=Math.round(n[s]*Math.pow(10,a))/Math.pow(10,a);if(o!==l)return!1}return!0},vB=function(e,n,i,a){for(var s=[],o=0;o<n;o++){for(var l=[],c=0;c<n;c++)Math.round(e[o*n+c]*1e3)/1e3>0&&l.push(i[c]);l.length!==0&&s.push(a.collection(l))}return s},mB=function(e,n){for(var i=0;i<e.length;i++)if(!n[i]||e[i].id()!==n[i].id())return!1;return!0},pB=function(e){for(var n=0;n<e.length;n++)for(var i=0;i<e.length;i++)n!=i&&mB(e[n],e[i])&&e.splice(i,1);return e},nw=function(e){for(var n=this.nodes(),i=this.edges(),a=this.cy(),s=lB(e),o={},l=0;l<n.length;l++)o[n[l].id()]=l;for(var c=n.length,u=c*c,h=new Array(u),g,v=0;v<u;v++)h[v]=0;for(var m=0;m<i.length;m++){var y=i[m],b=o[y.source().id()],x=o[y.target().id()],A=uB(y,s.attributes);h[b*c+x]+=A,h[x*c+b]+=A}cB(h,c,s.multFactor),ME(h,c);for(var C=!0,E=0;C&&E<s.maxIterations;)C=!1,g=hB(h,c,s.expandFactor),h=dB(g,c,s.inflateFactor),gB(h,g,u,4)||(C=!0),E++;var S=vB(h,c,n,a);return S=pB(S),S},yB={markovClustering:nw,mcl:nw},AB=function(e){return e},DE=function(e,n){return Math.abs(n-e)},iw=function(e,n,i){return e+DE(n,i)},aw=function(e,n,i){return e+Math.pow(i-n,2)},xB=function(e){return Math.sqrt(e)},bB=function(e,n,i){return Math.max(e,DE(n,i))},ju=function(e,n,i,a,s){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:AB,l=a,c,u,h=0;h<e;h++)c=n(h),u=i(h),l=s(l,c,u);return o(l)},ql={euclidean:function(e,n,i){return e>=2?ju(e,n,i,0,aw,xB):ju(e,n,i,0,iw)},squaredEuclidean:function(e,n,i){return ju(e,n,i,0,aw)},manhattan:function(e,n,i){return ju(e,n,i,0,iw)},max:function(e,n,i){return ju(e,n,i,-1/0,bB)}};ql["squared-euclidean"]=ql.squaredEuclidean;ql.squaredeuclidean=ql.squaredEuclidean;function S0(r,e,n,i,a,s){var o;return gr(r)?o=r:o=ql[r]||ql.euclidean,e===0&&gr(r)?o(a,s):o(e,n,i,a,s)}var wB=on({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),R2=function(e){return wB(e)},Jd=function(e,n,i,a,s){var o=s!=="kMedoids",l=o?function(g){return i[g]}:function(g){return a[g](i)},c=function(v){return a[v](n)},u=i,h=n;return S0(e,a.length,l,c,u,h)},Um=function(e,n,i){for(var a=i.length,s=new Array(a),o=new Array(a),l=new Array(n),c=null,u=0;u<a;u++)s[u]=e.min(i[u]).value,o[u]=e.max(i[u]).value;for(var h=0;h<n;h++){c=[];for(var g=0;g<a;g++)c[g]=Math.random()*(o[g]-s[g])+s[g];l[h]=c}return l},RE=function(e,n,i,a,s){for(var o=1/0,l=0,c=0;c<n.length;c++){var u=Jd(i,e,n[c],a,s);u<o&&(o=u,l=c)}return l},BE=function(e,n,i){for(var a=[],s=null,o=0;o<n.length;o++)s=n[o],i[s.id()]===e&&a.push(s);return a},CB=function(e,n,i){return Math.abs(n-e)<=i},EB=function(e,n,i){for(var a=0;a<e.length;a++)for(var s=0;s<e[a].length;s++){var o=Math.abs(e[a][s]-n[a][s]);if(o>i)return!1}return!0},SB=function(e,n,i){for(var a=0;a<i;a++)if(e===n[a])return!0;return!1},sw=function(e,n){var i=new Array(n);if(e.length<50)for(var a=0;a<n;a++){for(var s=e[Math.floor(Math.random()*e.length)];SB(s,i,a);)s=e[Math.floor(Math.random()*e.length)];i[a]=s}else for(var o=0;o<n;o++)i[o]=e[Math.floor(Math.random()*e.length)];return i},ow=function(e,n,i){for(var a=0,s=0;s<n.length;s++)a+=Jd("manhattan",n[s],e,i,"kMedoids");return a},TB=function(e){var n=this.cy(),i=this.nodes(),a=null,s=R2(e),o=new Array(s.k),l={},c;s.testMode?typeof s.testCentroids=="number"?(s.testCentroids,c=Um(i,s.k,s.attributes)):Or(s.testCentroids)==="object"?c=s.testCentroids:c=Um(i,s.k,s.attributes):c=Um(i,s.k,s.attributes);for(var u=!0,h=0;u&&h<s.maxIterations;){for(var g=0;g<i.length;g++)a=i[g],l[a.id()]=RE(a,c,s.distance,s.attributes,"kMeans");u=!1;for(var v=0;v<s.k;v++){var m=BE(v,i,l);if(m.length!==0){for(var y=s.attributes.length,b=c[v],x=new Array(y),A=new Array(y),C=0;C<y;C++){A[C]=0;for(var E=0;E<m.length;E++)a=m[E],A[C]+=s.attributes[C](a);x[C]=A[C]/m.length,CB(x[C],b[C],s.sensitivityThreshold)||(u=!0)}c[v]=x,o[v]=n.collection(m)}}h++}return o},MB=function(e){var n=this.cy(),i=this.nodes(),a=null,s=R2(e),o=new Array(s.k),l,c={},u,h=new Array(s.k);s.testMode?typeof s.testCentroids=="number"||(Or(s.testCentroids)==="object"?l=s.testCentroids:l=sw(i,s.k)):l=sw(i,s.k);for(var g=!0,v=0;g&&v<s.maxIterations;){for(var m=0;m<i.length;m++)a=i[m],c[a.id()]=RE(a,l,s.distance,s.attributes,"kMedoids");g=!1;for(var y=0;y<l.length;y++){var b=BE(y,i,c);if(b.length!==0){h[y]=ow(l[y],b,s.attributes);for(var x=0;x<b.length;x++)u=ow(b[x],b,s.attributes),u<h[y]&&(h[y]=u,l[y]=b[x],g=!0);o[y]=n.collection(b)}}v++}return o},DB=function(e,n,i,a,s){for(var o,l,c=0;c<n.length;c++)for(var u=0;u<e.length;u++)a[c][u]=Math.pow(i[c][u],s.m);for(var h=0;h<e.length;h++)for(var g=0;g<s.attributes.length;g++){o=0,l=0;for(var v=0;v<n.length;v++)o+=a[v][h]*s.attributes[g](n[v]),l+=a[v][h];e[h][g]=o/l}},RB=function(e,n,i,a,s){for(var o=0;o<e.length;o++)n[o]=e[o].slice();for(var l,c,u,h=2/(s.m-1),g=0;g<i.length;g++)for(var v=0;v<a.length;v++){l=0;for(var m=0;m<i.length;m++)c=Jd(s.distance,a[v],i[g],s.attributes,"cmeans"),u=Jd(s.distance,a[v],i[m],s.attributes,"cmeans"),l+=Math.pow(c/u,h);e[v][g]=1/l}},BB=function(e,n,i,a){for(var s=new Array(i.k),o=0;o<s.length;o++)s[o]=[];for(var l,c,u=0;u<n.length;u++){l=-1/0,c=-1;for(var h=0;h<n[0].length;h++)n[u][h]>l&&(l=n[u][h],c=h);s[c].push(e[u])}for(var g=0;g<s.length;g++)s[g]=a.collection(s[g]);return s},lw=function(e){var n=this.cy(),i=this.nodes(),a=R2(e),s,o,l,c,u;c=new Array(i.length);for(var h=0;h<i.length;h++)c[h]=new Array(a.k);l=new Array(i.length);for(var g=0;g<i.length;g++)l[g]=new Array(a.k);for(var v=0;v<i.length;v++){for(var m=0,y=0;y<a.k;y++)l[v][y]=Math.random(),m+=l[v][y];for(var b=0;b<a.k;b++)l[v][b]=l[v][b]/m}o=new Array(a.k);for(var x=0;x<a.k;x++)o[x]=new Array(a.attributes.length);u=new Array(i.length);for(var A=0;A<i.length;A++)u[A]=new Array(a.k);for(var C=!0,E=0;C&&E<a.maxIterations;)C=!1,DB(o,i,l,u,a),RB(l,c,o,i,a),EB(l,c,a.sensitivityThreshold)||(C=!0),E++;return s=BB(i,l,a,n),{clusters:s,degreeOfMembership:l}},IB={kMeans:TB,kMedoids:MB,fuzzyCMeans:lw,fcm:lw},NB=on({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),FB={single:"min",complete:"max"},kB=function(e){var n=NB(e),i=FB[n.linkage];return i!=null&&(n.linkage=i),n},uw=function(e,n,i,a,s){for(var o=0,l=1/0,c,u=s.attributes,h=function(F,I){return S0(s.distance,u.length,function(U){return u[U](F)},function(U){return u[U](I)},F,I)},g=0;g<e.length;g++){var v=e[g].key,m=i[v][a[v]];m<l&&(o=v,l=m)}if(s.mode==="threshold"&&l>=s.threshold||s.mode==="dendrogram"&&e.length===1)return!1;var y=n[o],b=n[a[o]],x;s.mode==="dendrogram"?x={left:y,right:b,key:y.key}:x={value:y.value.concat(b.value),key:y.key},e[y.index]=x,e.splice(b.index,1),n[y.key]=x;for(var A=0;A<e.length;A++){var C=e[A];y.key===C.key?c=1/0:s.linkage==="min"?(c=i[y.key][C.key],i[y.key][C.key]>i[b.key][C.key]&&(c=i[b.key][C.key])):s.linkage==="max"?(c=i[y.key][C.key],i[y.key][C.key]<i[b.key][C.key]&&(c=i[b.key][C.key])):s.linkage==="mean"?c=(i[y.key][C.key]*y.size+i[b.key][C.key]*b.size)/(y.size+b.size):s.mode==="dendrogram"?c=h(C.value,y.value):c=h(C.value[0],y.value[0]),i[y.key][C.key]=i[C.key][y.key]=c}for(var E=0;E<e.length;E++){var S=e[E].key;if(a[S]===y.key||a[S]===b.key){for(var M=S,R=0;R<e.length;R++){var T=e[R].key;i[S][T]<i[S][M]&&(M=T)}a[S]=M}e[E].index=E}return y.key=b.key=y.index=b.index=null,!0},Fl=function(e,n,i){e&&(e.value?n.push(e.value):(e.left&&Fl(e.left,n),e.right&&Fl(e.right,n)))},Sp=function(e,n){if(!e)return"";if(e.left&&e.right){var i=Sp(e.left,n),a=Sp(e.right,n),s=n.add({group:"nodes",data:{id:i+","+a}});return n.add({group:"edges",data:{source:i,target:s.id()}}),n.add({group:"edges",data:{source:a,target:s.id()}}),s.id()}else if(e.value)return e.value.id()},Tp=function(e,n,i){if(!e)return[];var a=[],s=[],o=[];return n===0?(e.left&&Fl(e.left,a),e.right&&Fl(e.right,s),o=a.concat(s),[i.collection(o)]):n===1?e.value?[i.collection(e.value)]:(e.left&&Fl(e.left,a),e.right&&Fl(e.right,s),[i.collection(a),i.collection(s)]):e.value?[i.collection(e.value)]:(e.left&&(a=Tp(e.left,n-1,i)),e.right&&(s=Tp(e.right,n-1,i)),a.concat(s))},cw=function(e){for(var n=this.cy(),i=this.nodes(),a=kB(e),s=a.attributes,o=function(E,S){return S0(a.distance,s.length,function(M){return s[M](E)},function(M){return s[M](S)},E,S)},l=[],c=[],u=[],h=[],g=0;g<i.length;g++){var v={value:a.mode==="dendrogram"?i[g]:[i[g]],key:g,index:g};l[g]=v,h[g]=v,c[g]=[],u[g]=0}for(var m=0;m<l.length;m++)for(var y=0;y<=m;y++){var b=void 0;a.mode==="dendrogram"?b=m===y?1/0:o(l[m].value,l[y].value):b=m===y?1/0:o(l[m].value[0],l[y].value[0]),c[m][y]=b,c[y][m]=b,b<c[m][u[m]]&&(u[m]=y)}for(var x=uw(l,h,c,u,a);x;)x=uw(l,h,c,u,a);var A;return a.mode==="dendrogram"?(A=Tp(l[0],a.dendrogramDepth,n),a.addDendrogram&&Sp(l[0],n)):(A=new Array(l.length),l.forEach(function(C,E){C.key=C.index=null,A[E]=n.collection(C.value)})),A},UB={hierarchicalClustering:cw,hca:cw},VB=on({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),OB=function(e){var n=e.damping,i=e.preference;.5<=n&&n<1||ur("Damping must range on [0.5, 1).  Got: ".concat(n));var a=["median","mean","min","max"];return a.some(function(s){return s===i})||Be(i)||ur("Preference must be one of [".concat(a.map(function(s){return"'".concat(s,"'")}).join(", "),"] or a number.  Got: ").concat(i)),VB(e)},PB=function(e,n,i,a){var s=function(l,c){return a[c](l)};return-S0(e,a.length,function(o){return s(n,o)},function(o){return s(i,o)},n,i)},LB=function(e,n){var i=null;return n==="median"?i=OR(e):n==="mean"?i=VR(e):n==="min"?i=kR(e):n==="max"?i=UR(e):i=n,i},_B=function(e,n,i){for(var a=[],s=0;s<e;s++)n[s*e+s]+i[s*e+s]>0&&a.push(s);return a},fw=function(e,n,i){for(var a=[],s=0;s<e;s++){for(var o=-1,l=-1/0,c=0;c<i.length;c++){var u=i[c];n[s*e+u]>l&&(o=u,l=n[s*e+u])}o>0&&a.push(o)}for(var h=0;h<i.length;h++)a[i[h]]=i[h];return a},zB=function(e,n,i){for(var a=fw(e,n,i),s=0;s<i.length;s++){for(var o=[],l=0;l<a.length;l++)a[l]===i[s]&&o.push(l);for(var c=-1,u=-1/0,h=0;h<o.length;h++){for(var g=0,v=0;v<o.length;v++)g+=n[o[v]*e+o[h]];g>u&&(c=h,u=g)}i[s]=o[c]}return a=fw(e,n,i),a},hw=function(e){for(var n=this.cy(),i=this.nodes(),a=OB(e),s={},o=0;o<i.length;o++)s[i[o].id()]=o;var l,c,u,h,g,v;l=i.length,c=l*l,u=new Array(c);for(var m=0;m<c;m++)u[m]=-1/0;for(var y=0;y<l;y++)for(var b=0;b<l;b++)y!==b&&(u[y*l+b]=PB(a.distance,i[y],i[b],a.attributes));h=LB(u,a.preference);for(var x=0;x<l;x++)u[x*l+x]=h;g=new Array(c);for(var A=0;A<c;A++)g[A]=0;v=new Array(c);for(var C=0;C<c;C++)v[C]=0;for(var E=new Array(l),S=new Array(l),M=new Array(l),R=0;R<l;R++)E[R]=0,S[R]=0,M[R]=0;for(var T=new Array(l*a.minIterations),B=0;B<T.length;B++)T[B]=0;var F;for(F=0;F<a.maxIterations;F++){for(var I=0;I<l;I++){for(var U=-1/0,k=-1/0,O=-1,V=0,L=0;L<l;L++)E[L]=g[I*l+L],V=v[I*l+L]+u[I*l+L],V>=U?(k=U,U=V,O=L):V>k&&(k=V);for(var P=0;P<l;P++)g[I*l+P]=(1-a.damping)*(u[I*l+P]-U)+a.damping*E[P];g[I*l+O]=(1-a.damping)*(u[I*l+O]-k)+a.damping*E[O]}for(var _=0;_<l;_++){for(var q=0,H=0;H<l;H++)E[H]=v[H*l+_],S[H]=Math.max(0,g[H*l+_]),q+=S[H];q-=S[_],S[_]=g[_*l+_],q+=S[_];for(var W=0;W<l;W++)v[W*l+_]=(1-a.damping)*Math.min(0,q-S[W])+a.damping*E[W];v[_*l+_]=(1-a.damping)*(q-S[_])+a.damping*E[_]}for(var G=0,K=0;K<l;K++){var $=v[K*l+K]+g[K*l+K]>0?1:0;T[F%a.minIterations*l+K]=$,G+=$}if(G>0&&(F>=a.minIterations-1||F==a.maxIterations-1)){for(var te=0,ae=0;ae<l;ae++){M[ae]=0;for(var ue=0;ue<a.minIterations;ue++)M[ae]+=T[ue*l+ae];(M[ae]===0||M[ae]===a.minIterations)&&te++}if(te===l)break}}for(var re=_B(l,g,v),ve=zB(l,u,re),le={},ie=0;ie<re.length;ie++)le[re[ie]]=[];for(var se=0;se<i.length;se++){var fe=s[i[se].id()],xe=ve[fe];xe!=null&&le[xe].push(i[se])}for(var De=new Array(re.length),ze=0;ze<re.length;ze++)De[ze]=n.collection(le[re[ze]]);return De},GB={affinityPropagation:hw,ap:hw},qB=on({root:void 0,directed:!1}),YB={hierholzer:function(e){if(!Dt(e)){var n=arguments;e={root:n[0],directed:n[1]}}var i=qB(e),a=i.root,s=i.directed,o=this,l=!1,c,u,h;a&&(h=We(a)?this.filter(a)[0].id():a[0].id());var g={},v={};s?o.forEach(function(C){var E=C.id();if(C.isNode()){var S=C.indegree(!0),M=C.outdegree(!0),R=S-M,T=M-S;R==1?c?l=!0:c=E:T==1?u?l=!0:u=E:(T>1||R>1)&&(l=!0),g[E]=[],C.outgoers().forEach(function(B){B.isEdge()&&g[E].push(B.id())})}else v[E]=[void 0,C.target().id()]}):o.forEach(function(C){var E=C.id();if(C.isNode()){var S=C.degree(!0);S%2&&(c?u?l=!0:u=E:c=E),g[E]=[],C.connectedEdges().forEach(function(M){return g[E].push(M.id())})}else v[E]=[C.source().id(),C.target().id()]});var m={found:!1,trail:void 0};if(l)return m;if(u&&c)if(s){if(h&&u!=h)return m;h=u}else{if(h&&u!=h&&c!=h)return m;h||(h=u)}else h||(h=o[0].id());var y=function(E){for(var S=E,M=[E],R,T,B;g[S].length;)R=g[S].shift(),T=v[R][0],B=v[R][1],S!=B?(g[B]=g[B].filter(function(F){return F!=R}),S=B):!s&&S!=T&&(g[T]=g[T].filter(function(F){return F!=R}),S=T),M.unshift(R),M.unshift(S);return M},b=[],x=[];for(x=y(h);x.length!=1;)g[x[0]].length==0?(b.unshift(o.getElementById(x.shift())),b.unshift(o.getElementById(x.shift()))):x=y(x.shift()).concat(x);b.unshift(o.getElementById(x.shift()));for(var A in g)if(g[A].length)return m;return m.found=!0,m.trail=this.spawn(b,!0),m}},qh=function(){var e=this,n={},i=0,a=0,s=[],o=[],l={},c=function(v,m){for(var y=o.length-1,b=[],x=e.spawn();o[y].x!=v||o[y].y!=m;)b.push(o.pop().edge),y--;b.push(o.pop().edge),b.forEach(function(A){var C=A.connectedNodes().intersection(e);x.merge(A),C.forEach(function(E){var S=E.id(),M=E.connectedEdges().intersection(e);x.merge(E),n[S].cutVertex?x.merge(M.filter(function(R){return R.isLoop()})):x.merge(M)})}),s.push(x)},u=function(v,m,y){v===y&&(a+=1),n[m]={id:i,low:i++,cutVertex:!1};var b=e.getElementById(m).connectedEdges().intersection(e);if(b.size()===0)s.push(e.spawn(e.getElementById(m)));else{var x,A,C,E;b.forEach(function(S){x=S.source().id(),A=S.target().id(),C=x===m?A:x,C!==y&&(E=S.id(),l[E]||(l[E]=!0,o.push({x:m,y:C,edge:S})),C in n?n[m].low=Math.min(n[m].low,n[C].id):(u(v,C,m),n[m].low=Math.min(n[m].low,n[C].low),n[m].id<=n[C].low&&(n[m].cutVertex=!0,c(m,C))))})}};e.forEach(function(g){if(g.isNode()){var v=g.id();v in n||(a=0,u(v,v),n[v].cutVertex=a>1)}});var h=Object.keys(n).filter(function(g){return n[g].cutVertex}).map(function(g){return e.getElementById(g)});return{cut:e.spawn(h),components:s}},jB={hopcroftTarjanBiconnected:qh,htbc:qh,htb:qh,hopcroftTarjanBiconnectedComponents:qh},Yh=function(){var e=this,n={},i=0,a=[],s=[],o=e.spawn(e),l=function(u){s.push(u),n[u]={index:i,low:i++,explored:!1};var h=e.getElementById(u).connectedEdges().intersection(e);if(h.forEach(function(b){var x=b.target().id();x!==u&&(x in n||l(x),n[x].explored||(n[u].low=Math.min(n[u].low,n[x].low)))}),n[u].index===n[u].low){for(var g=e.spawn();;){var v=s.pop();if(g.merge(e.getElementById(v)),n[v].low=n[u].index,n[v].explored=!0,v===u)break}var m=g.edgesWith(g),y=g.merge(m);a.push(y),o=o.difference(y)}};return e.forEach(function(c){if(c.isNode()){var u=c.id();u in n||l(u)}}),{cut:o,components:a}},HB={tarjanStronglyConnected:Yh,tsc:Yh,tscc:Yh,tarjanStronglyConnectedComponents:Yh},IE={};[Pc,wR,CR,SR,MR,RR,NR,aB,Ol,Pl,Ep,yB,IB,UB,GB,YB,jB,HB].forEach(function(r){et(IE,r)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var NE=0,FE=1,kE=2,Fi=function(e){if(!(this instanceof Fi))return new Fi(e);this.id="Thenable/1.0.7",this.state=NE,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};Fi.prototype={fulfill:function(e){return dw(this,FE,"fulfillValue",e)},reject:function(e){return dw(this,kE,"rejectReason",e)},then:function(e,n){var i=this,a=new Fi;return i.onFulfilled.push(vw(e,a,"fulfill")),i.onRejected.push(vw(n,a,"reject")),UE(i),a.proxy}};var dw=function(e,n,i,a){return e.state===NE&&(e.state=n,e[i]=a,UE(e)),e},UE=function(e){e.state===FE?gw(e,"onFulfilled",e.fulfillValue):e.state===kE&&gw(e,"onRejected",e.rejectReason)},gw=function(e,n,i){if(e[n].length!==0){var a=e[n];e[n]=[];var s=function(){for(var l=0;l<a.length;l++)a[l](i)};typeof setImmediate=="function"?setImmediate(s):setTimeout(s,0)}},vw=function(e,n,i){return function(a){if(typeof e!="function")n[i].call(n,a);else{var s;try{s=e(a)}catch(o){n.reject(o);return}VE(n,s)}}},VE=function(e,n){if(e===n||e.proxy===n){e.reject(new TypeError("cannot resolve promise with itself"));return}var i;if(Or(n)==="object"&&n!==null||typeof n=="function")try{i=n.then}catch(s){e.reject(s);return}if(typeof i=="function"){var a=!1;try{i.call(n,function(s){a||(a=!0,s===n?e.reject(new TypeError("circular thenable chain")):VE(e,s))},function(s){a||(a=!0,e.reject(s))})}catch(s){a||e.reject(s)}return}e.fulfill(n)};Fi.all=function(r){return new Fi(function(e,n){for(var i=new Array(r.length),a=0,s=function(c,u){i[c]=u,a++,a===r.length&&e(i)},o=0;o<r.length;o++)(function(l){var c=r[l],u=c!=null&&c.then!=null;if(u)c.then(function(g){s(l,g)},function(g){n(g)});else{var h=c;s(l,h)}})(o)})};Fi.resolve=function(r){return new Fi(function(e,n){e(r)})};Fi.reject=function(r){return new Fi(function(e,n){n(r)})};var Ql=typeof Promise<"u"?Promise:Fi,Mp=function(e,n,i){var a=A2(e),s=!a,o=this._private=et({duration:1e3},n,i);if(o.target=e,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&gr(o.complete)&&o.completes.push(o.complete),s){var l=e.position();o.startPosition=o.startPosition||{x:l.x,y:l.y},o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(a){var c=e.pan();o.startPan={x:c.x,y:c.y},o.startZoom=e.zoom()}this.length=1,this[0]=this},Co=Mp.prototype;et(Co,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var n,i=e.target._private.animation;e.queue?n=i.queue:n=i.current,n.push(this),Jn(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var n=this._private;return e===void 0?n.progress*n.duration:this.progress(e/n.duration)},progress:function(e){var n=this._private,i=n.playing;return e===void 0?n.progress:(i&&this.pause(),n.progress=e,n.started=!1,i&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,n=e.playing;n&&this.pause(),e.progress=1-e.progress,e.started=!1;var i=function(u,h){var g=e[u];g!=null&&(e[u]=e[h],e[h]=g)};if(i("zoom","startZoom"),i("pan","startPan"),i("position","startPosition"),e.style)for(var a=0;a<e.style.length;a++){var s=e.style[a],o=s.name,l=e.startStyle[o];e.startStyle[o]=s,e.style[a]=l}return n&&this.play(),this},promise:function(e){var n=this._private,i;switch(e){case"frame":i=n.frames;break;default:case"complete":case"completed":i=n.completes}return new Ql(function(a,s){i.push(function(){a()})})}});Co.complete=Co.completed;Co.run=Co.play;Co.running=Co.playing;var KB={animated:function(){return function(){var n=this,i=n.length!==void 0,a=i?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return!1;var o=a[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var n=this,i=n.length!==void 0,a=i?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var o=0;o<a.length;o++){var l=a[o];l._private.animation.queue=[]}return this}},delay:function(){return function(n,i){var a=this._private.cy||this;return a.styleEnabled()?this.animate({delay:n,duration:n,complete:i}):this}},delayAnimation:function(){return function(n,i){var a=this._private.cy||this;return a.styleEnabled()?this.animation({delay:n,duration:n,complete:i}):this}},animation:function(){return function(n,i){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this,c=!s,u=!c;if(!l.styleEnabled())return this;var h=l.style();n=et({},n,i);var g=Object.keys(n).length===0;if(g)return new Mp(o[0],n);switch(n.duration===void 0&&(n.duration=400),n.duration){case"slow":n.duration=600;break;case"fast":n.duration=200;break}if(u&&(n.style=h.getPropsList(n.style||n.css),n.css=void 0),u&&n.renderedPosition!=null){var v=n.renderedPosition,m=l.pan(),y=l.zoom();n.position=bE(v,y,m)}if(c&&n.panBy!=null){var b=n.panBy,x=l.pan();n.pan={x:x.x+b.x,y:x.y+b.y}}var A=n.center||n.centre;if(c&&A!=null){var C=l.getCenterPan(A.eles,n.zoom);C!=null&&(n.pan=C)}if(c&&n.fit!=null){var E=n.fit,S=l.getFitViewport(E.eles||E.boundingBox,E.padding);S!=null&&(n.pan=S.pan,n.zoom=S.zoom)}if(c&&Dt(n.zoom)){var M=l.getZoomedViewport(n.zoom);M!=null?(M.zoomed&&(n.zoom=M.zoom),M.panned&&(n.pan=M.pan)):n.zoom=null}return new Mp(o[0],n)}},animate:function(){return function(n,i){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this;if(!l.styleEnabled())return this;i&&(n=et({},n,i));for(var c=0;c<o.length;c++){var u=o[c],h=u.animated()&&(n.queue===void 0||n.queue),g=u.animation(n,h?{queue:!0}:void 0);g.play()}return this}},stop:function(){return function(n,i){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this;if(!l.styleEnabled())return this;for(var c=0;c<o.length;c++){for(var u=o[c],h=u._private,g=h.animation.current,v=0;v<g.length;v++){var m=g[v],y=m._private;i&&(y.duration=0)}n&&(h.animation.queue=[]),i||(h.animation.current=[])}return l.notify("draw"),this}}},Vm,mw;function T0(){if(mw)return Vm;mw=1;var r=Array.isArray;return Vm=r,Vm}var Om,pw;function XB(){if(pw)return Om;pw=1;var r=T0(),e=sf(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;function a(s,o){if(r(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||e(s)?!0:i.test(s)||!n.test(s)||o!=null&&s in Object(o)}return Om=a,Om}var Pm,yw;function QB(){if(yw)return Pm;yw=1;var r=hE(),e=af(),n="[object AsyncFunction]",i="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var c=r(l);return c==i||c==a||c==n||c==s}return Pm=o,Pm}var Lm,Aw;function ZB(){if(Aw)return Lm;Aw=1;var r=w0(),e=r["__core-js_shared__"];return Lm=e,Lm}var _m,xw;function WB(){if(xw)return _m;xw=1;var r=ZB(),e=(function(){var i=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""})();function n(i){return!!e&&e in i}return _m=n,_m}var zm,bw;function JB(){if(bw)return zm;bw=1;var r=Function.prototype,e=r.toString;function n(i){if(i!=null){try{return e.call(i)}catch{}try{return i+""}catch{}}return""}return zm=n,zm}var Gm,ww;function $B(){if(ww)return Gm;ww=1;var r=QB(),e=WB(),n=af(),i=JB(),a=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,c=o.toString,u=l.hasOwnProperty,h=RegExp("^"+c.call(u).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function g(v){if(!n(v)||e(v))return!1;var m=r(v)?h:s;return m.test(i(v))}return Gm=g,Gm}var qm,Cw;function e7(){if(Cw)return qm;Cw=1;function r(e,n){return e?.[n]}return qm=r,qm}var Ym,Ew;function B2(){if(Ew)return Ym;Ew=1;var r=$B(),e=e7();function n(i,a){var s=e(i,a);return r(s)?s:void 0}return Ym=n,Ym}var jm,Sw;function M0(){if(Sw)return jm;Sw=1;var r=B2(),e=r(Object,"create");return jm=e,jm}var Hm,Tw;function t7(){if(Tw)return Hm;Tw=1;var r=M0();function e(){this.__data__=r?r(null):{},this.size=0}return Hm=e,Hm}var Km,Mw;function r7(){if(Mw)return Km;Mw=1;function r(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}return Km=r,Km}var Xm,Dw;function n7(){if(Dw)return Xm;Dw=1;var r=M0(),e="__lodash_hash_undefined__",n=Object.prototype,i=n.hasOwnProperty;function a(s){var o=this.__data__;if(r){var l=o[s];return l===e?void 0:l}return i.call(o,s)?o[s]:void 0}return Xm=a,Xm}var Qm,Rw;function i7(){if(Rw)return Qm;Rw=1;var r=M0(),e=Object.prototype,n=e.hasOwnProperty;function i(a){var s=this.__data__;return r?s[a]!==void 0:n.call(s,a)}return Qm=i,Qm}var Zm,Bw;function a7(){if(Bw)return Zm;Bw=1;var r=M0(),e="__lodash_hash_undefined__";function n(i,a){var s=this.__data__;return this.size+=this.has(i)?0:1,s[i]=r&&a===void 0?e:a,this}return Zm=n,Zm}var Wm,Iw;function s7(){if(Iw)return Wm;Iw=1;var r=t7(),e=r7(),n=n7(),i=i7(),a=a7();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,Wm=s,Wm}var Jm,Nw;function o7(){if(Nw)return Jm;Nw=1;function r(){this.__data__=[],this.size=0}return Jm=r,Jm}var $m,Fw;function OE(){if(Fw)return $m;Fw=1;function r(e,n){return e===n||e!==e&&n!==n}return $m=r,$m}var e1,kw;function D0(){if(kw)return e1;kw=1;var r=OE();function e(n,i){for(var a=n.length;a--;)if(r(n[a][0],i))return a;return-1}return e1=e,e1}var t1,Uw;function l7(){if(Uw)return t1;Uw=1;var r=D0(),e=Array.prototype,n=e.splice;function i(a){var s=this.__data__,o=r(s,a);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():n.call(s,o,1),--this.size,!0}return t1=i,t1}var r1,Vw;function u7(){if(Vw)return r1;Vw=1;var r=D0();function e(n){var i=this.__data__,a=r(i,n);return a<0?void 0:i[a][1]}return r1=e,r1}var n1,Ow;function c7(){if(Ow)return n1;Ow=1;var r=D0();function e(n){return r(this.__data__,n)>-1}return n1=e,n1}var i1,Pw;function f7(){if(Pw)return i1;Pw=1;var r=D0();function e(n,i){var a=this.__data__,s=r(a,n);return s<0?(++this.size,a.push([n,i])):a[s][1]=i,this}return i1=e,i1}var a1,Lw;function h7(){if(Lw)return a1;Lw=1;var r=o7(),e=l7(),n=u7(),i=c7(),a=f7();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,a1=s,a1}var s1,_w;function d7(){if(_w)return s1;_w=1;var r=B2(),e=w0(),n=r(e,"Map");return s1=n,s1}var o1,zw;function g7(){if(zw)return o1;zw=1;var r=s7(),e=h7(),n=d7();function i(){this.size=0,this.__data__={hash:new r,map:new(n||e),string:new r}}return o1=i,o1}var l1,Gw;function v7(){if(Gw)return l1;Gw=1;function r(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}return l1=r,l1}var u1,qw;function R0(){if(qw)return u1;qw=1;var r=v7();function e(n,i){var a=n.__data__;return r(i)?a[typeof i=="string"?"string":"hash"]:a.map}return u1=e,u1}var c1,Yw;function m7(){if(Yw)return c1;Yw=1;var r=R0();function e(n){var i=r(this,n).delete(n);return this.size-=i?1:0,i}return c1=e,c1}var f1,jw;function p7(){if(jw)return f1;jw=1;var r=R0();function e(n){return r(this,n).get(n)}return f1=e,f1}var h1,Hw;function y7(){if(Hw)return h1;Hw=1;var r=R0();function e(n){return r(this,n).has(n)}return h1=e,h1}var d1,Kw;function A7(){if(Kw)return d1;Kw=1;var r=R0();function e(n,i){var a=r(this,n),s=a.size;return a.set(n,i),this.size+=a.size==s?0:1,this}return d1=e,d1}var g1,Xw;function x7(){if(Xw)return g1;Xw=1;var r=g7(),e=m7(),n=p7(),i=y7(),a=A7();function s(o){var l=-1,c=o==null?0:o.length;for(this.clear();++l<c;){var u=o[l];this.set(u[0],u[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,g1=s,g1}var v1,Qw;function b7(){if(Qw)return v1;Qw=1;var r=x7(),e="Expected a function";function n(i,a){if(typeof i!="function"||a!=null&&typeof a!="function")throw new TypeError(e);var s=function(){var o=arguments,l=a?a.apply(this,o):o[0],c=s.cache;if(c.has(l))return c.get(l);var u=i.apply(this,o);return s.cache=c.set(l,u)||c,u};return s.cache=new(n.Cache||r),s}return n.Cache=r,v1=n,v1}var m1,Zw;function w7(){if(Zw)return m1;Zw=1;var r=b7(),e=500;function n(i){var a=r(i,function(o){return s.size===e&&s.clear(),o}),s=a.cache;return a}return m1=n,m1}var p1,Ww;function PE(){if(Ww)return p1;Ww=1;var r=w7(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,i=r(function(a){var s=[];return a.charCodeAt(0)===46&&s.push(""),a.replace(e,function(o,l,c,u){s.push(c?u.replace(n,"$1"):l||o)}),s});return p1=i,p1}var y1,Jw;function LE(){if(Jw)return y1;Jw=1;function r(e,n){for(var i=-1,a=e==null?0:e.length,s=Array(a);++i<a;)s[i]=n(e[i],i,e);return s}return y1=r,y1}var A1,$w;function C7(){if($w)return A1;$w=1;var r=b2(),e=LE(),n=T0(),i=sf(),a=r?r.prototype:void 0,s=a?a.toString:void 0;function o(l){if(typeof l=="string")return l;if(n(l))return e(l,o)+"";if(i(l))return s?s.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return A1=o,A1}var x1,e3;function _E(){if(e3)return x1;e3=1;var r=C7();function e(n){return n==null?"":r(n)}return x1=e,x1}var b1,t3;function zE(){if(t3)return b1;t3=1;var r=T0(),e=XB(),n=PE(),i=_E();function a(s,o){return r(s)?s:e(s,o)?[s]:n(i(s))}return b1=a,b1}var w1,r3;function I2(){if(r3)return w1;r3=1;var r=sf();function e(n){if(typeof n=="string"||r(n))return n;var i=n+"";return i=="0"&&1/n==-1/0?"-0":i}return w1=e,w1}var C1,n3;function E7(){if(n3)return C1;n3=1;var r=zE(),e=I2();function n(i,a){a=r(a,i);for(var s=0,o=a.length;i!=null&&s<o;)i=i[e(a[s++])];return s&&s==o?i:void 0}return C1=n,C1}var E1,i3;function S7(){if(i3)return E1;i3=1;var r=E7();function e(n,i,a){var s=n==null?void 0:r(n,i);return s===void 0?a:s}return E1=e,E1}var T7=S7(),M7=nf(T7),S1,a3;function D7(){if(a3)return S1;a3=1;var r=B2(),e=(function(){try{var n=r(Object,"defineProperty");return n({},"",{}),n}catch{}})();return S1=e,S1}var T1,s3;function R7(){if(s3)return T1;s3=1;var r=D7();function e(n,i,a){i=="__proto__"&&r?r(n,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[i]=a}return T1=e,T1}var M1,o3;function B7(){if(o3)return M1;o3=1;var r=R7(),e=OE(),n=Object.prototype,i=n.hasOwnProperty;function a(s,o,l){var c=s[o];(!(i.call(s,o)&&e(c,l))||l===void 0&&!(o in s))&&r(s,o,l)}return M1=a,M1}var D1,l3;function I7(){if(l3)return D1;l3=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function n(i,a){var s=typeof i;return a=a??r,!!a&&(s=="number"||s!="symbol"&&e.test(i))&&i>-1&&i%1==0&&i<a}return D1=n,D1}var R1,u3;function N7(){if(u3)return R1;u3=1;var r=B7(),e=zE(),n=I7(),i=af(),a=I2();function s(o,l,c,u){if(!i(o))return o;l=e(l,o);for(var h=-1,g=l.length,v=g-1,m=o;m!=null&&++h<g;){var y=a(l[h]),b=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return o;if(h!=v){var x=m[y];b=u?u(x,y,m):void 0,b===void 0&&(b=i(x)?x:n(l[h+1])?[]:{})}r(m,y,b),m=m[y]}return o}return R1=s,R1}var B1,c3;function F7(){if(c3)return B1;c3=1;var r=N7();function e(n,i,a){return n==null?n:r(n,i,a)}return B1=e,B1}var k7=F7(),U7=nf(k7),I1,f3;function V7(){if(f3)return I1;f3=1;function r(e,n){var i=-1,a=e.length;for(n||(n=Array(a));++i<a;)n[i]=e[i];return n}return I1=r,I1}var N1,h3;function O7(){if(h3)return N1;h3=1;var r=LE(),e=V7(),n=T0(),i=sf(),a=PE(),s=I2(),o=_E();function l(c){return n(c)?r(c,s):i(c)?[c]:e(a(o(c)))}return N1=l,N1}var P7=O7(),L7=nf(P7),_7={data:function(e){var n={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(a){},beforeSet:function(a,s){},onSet:function(a){},canSet:function(a){return!0}};return e=et({},n,e),function(a,s){var o=e,l=this,c=l.length!==void 0,u=c?l:[l],h=c?l[0]:l;if(We(a)){var g=a.indexOf(".")!==-1,v=g&&L7(a);if(o.allowGetting&&s===void 0){var m;return h&&(o.beforeGet(h),v&&h._private[o.field][a]===void 0?m=M7(h._private[o.field],v):m=h._private[o.field][a]),m}else if(o.allowSetting&&s!==void 0){var y=!o.immutableKeys[a];if(y){var b=rE({},a,s);o.beforeSet(l,b);for(var x=0,A=u.length;x<A;x++){var C=u[x];o.canSet(C)&&(v&&h._private[o.field][a]===void 0?U7(C._private[o.field],v,s):C._private[o.field][a]=s)}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&Dt(a)){var E=a,S,M,R=Object.keys(E);o.beforeSet(l,E);for(var T=0;T<R.length;T++){S=R[T],M=E[S];var B=!o.immutableKeys[S];if(B)for(var F=0;F<u.length;F++){var I=u[F];o.canSet(I)&&(I._private[o.field][S]=M)}}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&gr(a)){var U=a;l.on(o.bindingEvent,U)}else if(o.allowGetting&&a===void 0){var k;return h&&(o.beforeGet(h),k=h._private[o.field]),k}return l}},removeData:function(e){var n={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=et({},n,e),function(a){var s=e,o=this,l=o.length!==void 0,c=l?o:[o];if(We(a)){for(var u=a.split(/\s+/),h=u.length,g=0;g<h;g++){var v=u[g];if(!Ms(v)){var m=!s.immutableKeys[v];if(m)for(var y=0,b=c.length;y<b;y++)c[y]._private[s.field][v]=void 0}}s.triggerEvent&&o[s.triggerFnName](s.event)}else if(a===void 0){for(var x=0,A=c.length;x<A;x++)for(var C=c[x]._private[s.field],E=Object.keys(C),S=0;S<E.length;S++){var M=E[S],R=!s.immutableKeys[M];R&&(C[M]=void 0)}s.triggerEvent&&o[s.triggerFnName](s.event)}return o}}},z7={eventAliasesOn:function(e){var n=e;n.addListener=n.listen=n.bind=n.on,n.unlisten=n.unbind=n.off=n.removeListener,n.trigger=n.emit,n.pon=n.promiseOn=function(i,a){var s=this,o=Array.prototype.slice.call(arguments,0);return new Ql(function(l,c){var u=function(m){s.off.apply(s,g),l(m)},h=o.concat([u]),g=h.concat([]);s.on.apply(s,h)})}}},Ot={};[KB,_7,z7].forEach(function(r){et(Ot,r)});var G7={animate:Ot.animate(),animation:Ot.animation(),animated:Ot.animated(),clearQueue:Ot.clearQueue(),delay:Ot.delay(),delayAnimation:Ot.delayAnimation(),stop:Ot.stop()},Sd={classes:function(e){var n=this;if(e===void 0){var i=[];return n[0]._private.classes.forEach(function(y){return i.push(y)}),i}else Qt(e)||(e=(e||"").match(/\S+/g)||[]);for(var a=[],s=new Xl(e),o=0;o<n.length;o++){for(var l=n[o],c=l._private,u=c.classes,h=!1,g=0;g<e.length;g++){var v=e[g],m=u.has(v);if(!m){h=!0;break}}h||(h=u.size!==e.length),h&&(c.classes=s,a.push(l))}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var n=this[0];return n!=null&&n._private.classes.has(e)},toggleClass:function(e,n){Qt(e)||(e=e.match(/\S+/g)||[]);for(var i=this,a=n===void 0,s=[],o=0,l=i.length;o<l;o++)for(var c=i[o],u=c._private.classes,h=!1,g=0;g<e.length;g++){var v=e[g],m=u.has(v),y=!1;n||a&&!m?(u.add(v),y=!0):(!n||a&&m)&&(u.delete(v),y=!0),!h&&y&&(s.push(c),h=!0)}return s.length>0&&this.spawn(s).updateStyle().emit("class"),i},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,n){var i=this;if(n==null)n=250;else if(n===0)return i;return i.addClass(e),setTimeout(function(){i.removeClass(e)},n),i}};Sd.className=Sd.classNames=Sd.classes;var Mt={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Ur,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};Mt.variable="(?:[\\w-.]|(?:\\\\"+Mt.metaChar+"))+";Mt.className="(?:[\\w-]|(?:\\\\"+Mt.metaChar+"))+";Mt.value=Mt.string+"|"+Mt.number;Mt.id=Mt.variable;(function(){var r,e,n;for(r=Mt.comparatorOp.split("|"),n=0;n<r.length;n++)e=r[n],Mt.comparatorOp+="|@"+e;for(r=Mt.comparatorOp.split("|"),n=0;n<r.length;n++)e=r[n],!(e.indexOf("!")>=0)&&e!=="="&&(Mt.comparatorOp+="|\\!"+e)})();var jt=function(){return{checks:[]}},Pe={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},Dp=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(r,e){return _8(r.selector,e.selector)}),q7=(function(){for(var r={},e,n=0;n<Dp.length;n++)e=Dp[n],r[e.selector]=e.matches;return r})(),Y7=function(e,n){return q7[e](n)},j7="("+Dp.map(function(r){return r.selector}).join("|")+")",gl=function(e){return e.replace(new RegExp("\\\\("+Mt.metaChar+")","g"),function(n,i){return i})},us=function(e,n,i){e[e.length-1]=i},Rp=[{name:"group",query:!0,regex:"("+Mt.group+")",populate:function(e,n,i){var a=Ir(i,1),s=a[0];n.checks.push({type:Pe.GROUP,value:s==="*"?s:s+"s"})}},{name:"state",query:!0,regex:j7,populate:function(e,n,i){var a=Ir(i,1),s=a[0];n.checks.push({type:Pe.STATE,value:s})}},{name:"id",query:!0,regex:"\\#("+Mt.id+")",populate:function(e,n,i){var a=Ir(i,1),s=a[0];n.checks.push({type:Pe.ID,value:gl(s)})}},{name:"className",query:!0,regex:"\\.("+Mt.className+")",populate:function(e,n,i){var a=Ir(i,1),s=a[0];n.checks.push({type:Pe.CLASS,value:gl(s)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+Mt.variable+")\\s*\\]",populate:function(e,n,i){var a=Ir(i,1),s=a[0];n.checks.push({type:Pe.DATA_EXIST,field:gl(s)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+Mt.variable+")\\s*("+Mt.comparatorOp+")\\s*("+Mt.value+")\\s*\\]",populate:function(e,n,i){var a=Ir(i,3),s=a[0],o=a[1],l=a[2],c=new RegExp("^"+Mt.string+"$").exec(l)!=null;c?l=l.substring(1,l.length-1):l=parseFloat(l),n.checks.push({type:Pe.DATA_COMPARE,field:gl(s),operator:o,value:l})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+Mt.boolOp+")\\s*("+Mt.variable+")\\s*\\]",populate:function(e,n,i){var a=Ir(i,2),s=a[0],o=a[1];n.checks.push({type:Pe.DATA_BOOL,field:gl(o),operator:s})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+Mt.meta+")\\s*("+Mt.comparatorOp+")\\s*("+Mt.number+")\\s*\\]\\]",populate:function(e,n,i){var a=Ir(i,3),s=a[0],o=a[1],l=a[2];n.checks.push({type:Pe.META_COMPARE,field:gl(s),operator:o,value:parseFloat(l)})}},{name:"nextQuery",separator:!0,regex:Mt.separator,populate:function(e,n){var i=e.currentSubject,a=e.edgeCount,s=e.compoundCount,o=e[e.length-1];i!=null&&(o.subject=i,e.currentSubject=null),o.edgeCount=a,o.compoundCount=s,e.edgeCount=0,e.compoundCount=0;var l=e[e.length++]=jt();return l}},{name:"directedEdge",separator:!0,regex:Mt.directedEdge,populate:function(e,n){if(e.currentSubject==null){var i=jt(),a=n,s=jt();return i.checks.push({type:Pe.DIRECTED_EDGE,source:a,target:s}),us(e,n,i),e.edgeCount++,s}else{var o=jt(),l=n,c=jt();return o.checks.push({type:Pe.NODE_SOURCE,source:l,target:c}),us(e,n,o),e.edgeCount++,c}}},{name:"undirectedEdge",separator:!0,regex:Mt.undirectedEdge,populate:function(e,n){if(e.currentSubject==null){var i=jt(),a=n,s=jt();return i.checks.push({type:Pe.UNDIRECTED_EDGE,nodes:[a,s]}),us(e,n,i),e.edgeCount++,s}else{var o=jt(),l=n,c=jt();return o.checks.push({type:Pe.NODE_NEIGHBOR,node:l,neighbor:c}),us(e,n,o),c}}},{name:"child",separator:!0,regex:Mt.child,populate:function(e,n){if(e.currentSubject==null){var i=jt(),a=jt(),s=e[e.length-1];return i.checks.push({type:Pe.CHILD,parent:s,child:a}),us(e,n,i),e.compoundCount++,a}else if(e.currentSubject===n){var o=jt(),l=e[e.length-1],c=jt(),u=jt(),h=jt(),g=jt();return o.checks.push({type:Pe.COMPOUND_SPLIT,left:l,right:c,subject:u}),u.checks=n.checks,n.checks=[{type:Pe.TRUE}],g.checks.push({type:Pe.TRUE}),c.checks.push({type:Pe.PARENT,parent:g,child:h}),us(e,l,o),e.currentSubject=u,e.compoundCount++,h}else{var v=jt(),m=jt(),y=[{type:Pe.PARENT,parent:v,child:m}];return v.checks=n.checks,n.checks=y,e.compoundCount++,m}}},{name:"descendant",separator:!0,regex:Mt.descendant,populate:function(e,n){if(e.currentSubject==null){var i=jt(),a=jt(),s=e[e.length-1];return i.checks.push({type:Pe.DESCENDANT,ancestor:s,descendant:a}),us(e,n,i),e.compoundCount++,a}else if(e.currentSubject===n){var o=jt(),l=e[e.length-1],c=jt(),u=jt(),h=jt(),g=jt();return o.checks.push({type:Pe.COMPOUND_SPLIT,left:l,right:c,subject:u}),u.checks=n.checks,n.checks=[{type:Pe.TRUE}],g.checks.push({type:Pe.TRUE}),c.checks.push({type:Pe.ANCESTOR,ancestor:g,descendant:h}),us(e,l,o),e.currentSubject=u,e.compoundCount++,h}else{var v=jt(),m=jt(),y=[{type:Pe.ANCESTOR,ancestor:v,descendant:m}];return v.checks=n.checks,n.checks=y,e.compoundCount++,m}}},{name:"subject",modifier:!0,regex:Mt.subject,populate:function(e,n){if(e.currentSubject!=null&&e.currentSubject!==n)return Pt("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=n;var i=e[e.length-1],a=i.checks[0],s=a==null?null:a.type;s===Pe.DIRECTED_EDGE?a.type=Pe.NODE_TARGET:s===Pe.UNDIRECTED_EDGE&&(a.type=Pe.NODE_NEIGHBOR,a.node=a.nodes[1],a.neighbor=a.nodes[0],a.nodes=null)}}];Rp.forEach(function(r){return r.regexObj=new RegExp("^"+r.regex)});var H7=function(e){for(var n,i,a,s=0;s<Rp.length;s++){var o=Rp[s],l=o.name,c=e.match(o.regexObj);if(c!=null){i=c,n=o,a=l;var u=c[0];e=e.substring(u.length);break}}return{expr:n,match:i,name:a,remaining:e}},K7=function(e){var n=e.match(/^\s+/);if(n){var i=n[0];e=e.substring(i.length)}return e},X7=function(e){var n=this,i=n.inputText=e,a=n[0]=jt();for(n.length=1,i=K7(i);;){var s=H7(i);if(s.expr==null)return Pt("The selector `"+e+"`is invalid"),!1;var o=s.match.slice(1),l=s.expr.populate(n,a,o);if(l===!1)return!1;if(l!=null&&(a=l),i=s.remaining,i.match(/^\s*$/))break}var c=n[n.length-1];n.currentSubject!=null&&(c.subject=n.currentSubject),c.edgeCount=n.edgeCount,c.compoundCount=n.compoundCount;for(var u=0;u<n.length;u++){var h=n[u];if(h.compoundCount>0&&h.edgeCount>0)return Pt("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(h.edgeCount>1)return Pt("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;h.edgeCount===1&&Pt("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},Q7=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(h){return h??""},n=function(h){return We(h)?'"'+h+'"':e(h)},i=function(h){return" "+h+" "},a=function(h,g){var v=h.type,m=h.value;switch(v){case Pe.GROUP:{var y=e(m);return y.substring(0,y.length-1)}case Pe.DATA_COMPARE:{var b=h.field,x=h.operator;return"["+b+i(e(x))+n(m)+"]"}case Pe.DATA_BOOL:{var A=h.operator,C=h.field;return"["+e(A)+C+"]"}case Pe.DATA_EXIST:{var E=h.field;return"["+E+"]"}case Pe.META_COMPARE:{var S=h.operator,M=h.field;return"[["+M+i(e(S))+n(m)+"]]"}case Pe.STATE:return m;case Pe.ID:return"#"+m;case Pe.CLASS:return"."+m;case Pe.PARENT:case Pe.CHILD:return s(h.parent,g)+i(">")+s(h.child,g);case Pe.ANCESTOR:case Pe.DESCENDANT:return s(h.ancestor,g)+" "+s(h.descendant,g);case Pe.COMPOUND_SPLIT:{var R=s(h.left,g),T=s(h.subject,g),B=s(h.right,g);return R+(R.length>0?" ":"")+T+B}case Pe.TRUE:return""}},s=function(h,g){return h.checks.reduce(function(v,m,y){return v+(g===h&&y===0?"$":"")+a(m,g)},"")},o="",l=0;l<this.length;l++){var c=this[l];o+=s(c,c.subject),this.length>1&&l<this.length-1&&(o+=", ")}return this.toStringCache=o,o},Z7={parse:X7,toString:Q7},GE=function(e,n,i){var a,s=We(e),o=Be(e),l=We(i),c,u,h=!1,g=!1,v=!1;switch(n.indexOf("!")>=0&&(n=n.replace("!",""),g=!0),n.indexOf("@")>=0&&(n=n.replace("@",""),h=!0),(s||l||h)&&(c=!s&&!o?"":""+e,u=""+i),h&&(e=c=c.toLowerCase(),i=u=u.toLowerCase()),n){case"*=":a=c.indexOf(u)>=0;break;case"$=":a=c.indexOf(u,c.length-u.length)>=0;break;case"^=":a=c.indexOf(u)===0;break;case"=":a=e===i;break;case">":v=!0,a=e>i;break;case">=":v=!0,a=e>=i;break;case"<":v=!0,a=e<i;break;case"<=":v=!0,a=e<=i;break;default:a=!1;break}return g&&(e!=null||!v)&&(a=!a),a},W7=function(e,n){switch(n){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},J7=function(e){return e!==void 0},N2=function(e,n){return e.data(n)},$7=function(e,n){return e[n]()},Ar=[],ir=function(e,n){return e.checks.every(function(i){return Ar[i.type](i,n)})};Ar[Pe.GROUP]=function(r,e){var n=r.value;return n==="*"||n===e.group()};Ar[Pe.STATE]=function(r,e){var n=r.value;return Y7(n,e)};Ar[Pe.ID]=function(r,e){var n=r.value;return e.id()===n};Ar[Pe.CLASS]=function(r,e){var n=r.value;return e.hasClass(n)};Ar[Pe.META_COMPARE]=function(r,e){var n=r.field,i=r.operator,a=r.value;return GE($7(e,n),i,a)};Ar[Pe.DATA_COMPARE]=function(r,e){var n=r.field,i=r.operator,a=r.value;return GE(N2(e,n),i,a)};Ar[Pe.DATA_BOOL]=function(r,e){var n=r.field,i=r.operator;return W7(N2(e,n),i)};Ar[Pe.DATA_EXIST]=function(r,e){var n=r.field;return r.operator,J7(N2(e,n))};Ar[Pe.UNDIRECTED_EDGE]=function(r,e){var n=r.nodes[0],i=r.nodes[1],a=e.source(),s=e.target();return ir(n,a)&&ir(i,s)||ir(i,a)&&ir(n,s)};Ar[Pe.NODE_NEIGHBOR]=function(r,e){return ir(r.node,e)&&e.neighborhood().some(function(n){return n.isNode()&&ir(r.neighbor,n)})};Ar[Pe.DIRECTED_EDGE]=function(r,e){return ir(r.source,e.source())&&ir(r.target,e.target())};Ar[Pe.NODE_SOURCE]=function(r,e){return ir(r.source,e)&&e.outgoers().some(function(n){return n.isNode()&&ir(r.target,n)})};Ar[Pe.NODE_TARGET]=function(r,e){return ir(r.target,e)&&e.incomers().some(function(n){return n.isNode()&&ir(r.source,n)})};Ar[Pe.CHILD]=function(r,e){return ir(r.child,e)&&ir(r.parent,e.parent())};Ar[Pe.PARENT]=function(r,e){return ir(r.parent,e)&&e.children().some(function(n){return ir(r.child,n)})};Ar[Pe.DESCENDANT]=function(r,e){return ir(r.descendant,e)&&e.ancestors().some(function(n){return ir(r.ancestor,n)})};Ar[Pe.ANCESTOR]=function(r,e){return ir(r.ancestor,e)&&e.descendants().some(function(n){return ir(r.descendant,n)})};Ar[Pe.COMPOUND_SPLIT]=function(r,e){return ir(r.subject,e)&&ir(r.left,e)&&ir(r.right,e)};Ar[Pe.TRUE]=function(){return!0};Ar[Pe.COLLECTION]=function(r,e){var n=r.value;return n.has(e)};Ar[Pe.FILTER]=function(r,e){var n=r.value;return n(e)};var eI=function(e){var n=this;if(n.length===1&&n[0].checks.length===1&&n[0].checks[0].type===Pe.ID)return e.getElementById(n[0].checks[0].value).collection();var i=function(s){for(var o=0;o<n.length;o++){var l=n[o];if(ir(l,s))return!0}return!1};return n.text()==null&&(i=function(){return!0}),e.filter(i)},tI=function(e){for(var n=this,i=0;i<n.length;i++){var a=n[i];if(ir(a,e))return!0}return!1},rI={matches:tI,filter:eI},Bs=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||We(e)&&e.match(/^\s*$/)||(Jn(e)?this.addQuery({checks:[{type:Pe.COLLECTION,value:e.collection()}]}):gr(e)?this.addQuery({checks:[{type:Pe.FILTER,value:e}]}):We(e)?this.parse(e)||(this.invalid=!0):ur("A selector must be created from a string; found "))},Is=Bs.prototype;[Z7,rI].forEach(function(r){return et(Is,r)});Is.text=function(){return this.inputText};Is.size=function(){return this.length};Is.eq=function(r){return this[r]};Is.sameText=function(r){return!this.invalid&&!r.invalid&&this.text()===r.text()};Is.addQuery=function(r){this[this.length++]=r};Is.selector=Is.toString;var Es={allAre:function(e){var n=new Bs(e);return this.every(function(i){return n.matches(i)})},is:function(e){var n=new Bs(e);return this.some(function(i){return n.matches(i)})},some:function(e,n){for(var i=0;i<this.length;i++){var a=n?e.apply(n,[this[i],i,this]):e(this[i],i,this);if(a)return!0}return!1},every:function(e,n){for(var i=0;i<this.length;i++){var a=n?e.apply(n,[this[i],i,this]):e(this[i],i,this);if(!a)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var n=this.length,i=e.length;return n!==i?!1:n===1?this[0]===e[0]:this.every(function(a){return e.hasElementWithId(a.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(n){return e.hasElementWithId(n.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var n=this.neighborhood();return e.every(function(i){return n.hasElementWithId(i.id())})},contains:function(e){e=this.cy().collection(e);var n=this;return e.every(function(i){return n.hasElementWithId(i.id())})}};Es.allAreNeighbours=Es.allAreNeighbors;Es.has=Es.contains;Es.equal=Es.equals=Es.same;var Ai=function(e,n){return function(a,s,o,l){var c=a,u=this,h;if(c==null?h="":Jn(c)&&c.length===1&&(h=c.id()),u.length===1&&h){var g=u[0]._private,v=g.traversalCache=g.traversalCache||{},m=v[n]=v[n]||[],y=bo(h),b=m[y];return b||(m[y]=e.call(u,a,s,o,l))}else return e.call(u,a,s,o,l)}},Yl={parent:function(e){var n=[];if(this.length===1){var i=this[0]._private.parent;if(i)return i}for(var a=0;a<this.length;a++){var s=this[a],o=s._private.parent;o&&n.push(o)}return this.spawn(n,!0).filter(e)},parents:function(e){for(var n=[],i=this.parent();i.nonempty();){for(var a=0;a<i.length;a++){var s=i[a];n.push(s)}i=i.parent()}return this.spawn(n,!0).filter(e)},commonAncestors:function(e){for(var n,i=0;i<this.length;i++){var a=this[i],s=a.parents();n=n||s,n=n.intersect(s)}return n.filter(e)},orphans:function(e){return this.stdFilter(function(n){return n.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(n){return n.isChild()}).filter(e)},children:Ai(function(r){for(var e=[],n=0;n<this.length;n++)for(var i=this[n],a=i._private.children,s=0;s<a.length;s++)e.push(a[s]);return this.spawn(e,!0).filter(r)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var n=[];function i(a){for(var s=0;s<a.length;s++){var o=a[s];n.push(o),o.children().nonempty()&&i(o.children())}}return i(this.children()),this.spawn(n,!0).filter(e)}};function F2(r,e,n,i){for(var a=[],s=new Xl,o=r.cy(),l=o.hasCompoundNodes(),c=0;c<r.length;c++){var u=r[c];n?a.push(u):l&&i(a,s,u)}for(;a.length>0;){var h=a.shift();e(h),s.add(h.id()),l&&i(a,s,h)}return r}function qE(r,e,n){if(n.isParent())for(var i=n._private.children,a=0;a<i.length;a++){var s=i[a];e.has(s.id())||r.push(s)}}Yl.forEachDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F2(this,r,e,qE)};function YE(r,e,n){if(n.isChild()){var i=n._private.parent;e.has(i.id())||r.push(i)}}Yl.forEachUp=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F2(this,r,e,YE)};function nI(r,e,n){YE(r,e,n),qE(r,e,n)}Yl.forEachUpAndDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F2(this,r,e,nI)};Yl.ancestors=Yl.parents;var zc,jE;zc=jE={data:Ot.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Ot.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Ot.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Ot.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Ot.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Ot.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};zc.attr=zc.data;zc.removeAttr=zc.removeData;var iI=jE,B0={};function F1(r){return function(e){var n=this;if(e===void 0&&(e=!0),n.length!==0)if(n.isNode()&&!n.removed()){for(var i=0,a=n[0],s=a._private.edges,o=0;o<s.length;o++){var l=s[o];!e&&l.isLoop()||(i+=r(a,l))}return i}else return}}et(B0,{degree:F1(function(r,e){return e.source().same(e.target())?2:1}),indegree:F1(function(r,e){return e.target().same(r)?1:0}),outdegree:F1(function(r,e){return e.source().same(r)?1:0})});function vl(r,e){return function(n){for(var i,a=this.nodes(),s=0;s<a.length;s++){var o=a[s],l=o[r](n);l!==void 0&&(i===void 0||e(l,i))&&(i=l)}return i}}et(B0,{minDegree:vl("degree",function(r,e){return r<e}),maxDegree:vl("degree",function(r,e){return r>e}),minIndegree:vl("indegree",function(r,e){return r<e}),maxIndegree:vl("indegree",function(r,e){return r>e}),minOutdegree:vl("outdegree",function(r,e){return r<e}),maxOutdegree:vl("outdegree",function(r,e){return r>e})});et(B0,{totalDegree:function(e){for(var n=0,i=this.nodes(),a=0;a<i.length;a++)n+=i[a].degree(e);return n}});var Ni,HE,KE=function(e,n,i){for(var a=0;a<e.length;a++){var s=e[a];if(!s.locked()){var o=s._private.position,l={x:n.x!=null?n.x-o.x:0,y:n.y!=null?n.y-o.y:0};s.isParent()&&!(l.x===0&&l.y===0)&&s.children().shift(l,i),s.dirtyBoundingBoxCache()}}},d3={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,n){KE(e,n,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};Ni=HE={position:Ot.data(d3),silentPosition:Ot.data(et({},d3,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,n){KE(e,n,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,n){if(Dt(e))n?this.silentPosition(e):this.position(e);else if(gr(e)){var i=e,a=this.cy();a.startBatch();for(var s=0;s<this.length;s++){var o=this[s],l=void 0;(l=i(o,s))&&(n?o.silentPosition(l):o.position(l))}a.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,n,i){var a;if(Dt(e)?(a={x:Be(e.x)?e.x:0,y:Be(e.y)?e.y:0},i=n):We(e)&&Be(n)&&(a={x:0,y:0},a[e]=n),a!=null){var s=this.cy();s.startBatch();for(var o=0;o<this.length;o++){var l=this[o];if(!(s.hasCompoundNodes()&&l.isChild()&&l.ancestors().anySame(this))){var c=l.position(),u={x:c.x+a.x,y:c.y+a.y};i?l.silentPosition(u):l.position(u)}}s.endBatch()}return this},silentShift:function(e,n){return Dt(e)?this.shift(e,!0):We(e)&&Be(n)&&this.shift(e,n,!0),this},renderedPosition:function(e,n){var i=this[0],a=this.cy(),s=a.zoom(),o=a.pan(),l=Dt(e)?e:void 0,c=l!==void 0||n!==void 0&&We(e);if(i&&i.isNode())if(c)for(var u=0;u<this.length;u++){var h=this[u];n!==void 0?h.position(e,(n-o[e])/s):l!==void 0&&h.position(bE(l,s,o))}else{var g=i.position();return l=E0(g,s,o),e===void 0?l:l[e]}else if(!c)return;return this},relativePosition:function(e,n){var i=this[0],a=this.cy(),s=Dt(e)?e:void 0,o=s!==void 0||n!==void 0&&We(e),l=a.hasCompoundNodes();if(i&&i.isNode())if(o)for(var c=0;c<this.length;c++){var u=this[c],h=l?u.parent():null,g=h&&h.length>0,v=g;g&&(h=h[0]);var m=v?h.position():{x:0,y:0};n!==void 0?u.position(e,n+m[e]):s!==void 0&&u.position({x:s.x+m.x,y:s.y+m.y})}else{var y=i.position(),b=l?i.parent():null,x=b&&b.length>0,A=x;x&&(b=b[0]);var C=A?b.position():{x:0,y:0};return s={x:y.x-C.x,y:y.y-C.y},e===void 0?s:s[e]}else if(!o)return;return this}};Ni.modelPosition=Ni.point=Ni.position;Ni.modelPositions=Ni.points=Ni.positions;Ni.renderedPoint=Ni.renderedPosition;Ni.relativePoint=Ni.relativePosition;var aI=HE,Ll,Us;Ll=Us={};Us.renderedBoundingBox=function(r){var e=this.boundingBox(r),n=this.cy(),i=n.zoom(),a=n.pan(),s=e.x1*i+a.x,o=e.x2*i+a.x,l=e.y1*i+a.y,c=e.y2*i+a.y;return{x1:s,x2:o,y1:l,y2:c,w:o-s,h:c-l}};Us.dirtyCompoundBoundsCache=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(n){if(n.isParent()){var i=n._private;i.compoundBoundsClean=!1,i.bbCache=null,r||n.emitAndNotify("bounds")}}),this)};Us.updateCompoundBounds=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!r&&e.batching())return this;function n(o){if(!o.isParent())return;var l=o._private,c=o.children(),u=o.pstyle("compound-sizing-wrt-labels").value==="include",h={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},g=c.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),v=l.position;(g.w===0||g.h===0)&&(g={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},g.x1=v.x-g.w/2,g.x2=v.x+g.w/2,g.y1=v.y-g.h/2,g.y2=v.y+g.h/2);function m(F,I,U){var k=0,O=0,V=I+U;return F>0&&V>0&&(k=I/V*F,O=U/V*F),{biasDiff:k,biasComplementDiff:O}}function y(F,I,U,k){if(U.units==="%")switch(k){case"width":return F>0?U.pfValue*F:0;case"height":return I>0?U.pfValue*I:0;case"average":return F>0&&I>0?U.pfValue*(F+I)/2:0;case"min":return F>0&&I>0?F>I?U.pfValue*I:U.pfValue*F:0;case"max":return F>0&&I>0?F>I?U.pfValue*F:U.pfValue*I:0;default:return 0}else return U.units==="px"?U.pfValue:0}var b=h.width.left.value;h.width.left.units==="px"&&h.width.val>0&&(b=b*100/h.width.val);var x=h.width.right.value;h.width.right.units==="px"&&h.width.val>0&&(x=x*100/h.width.val);var A=h.height.top.value;h.height.top.units==="px"&&h.height.val>0&&(A=A*100/h.height.val);var C=h.height.bottom.value;h.height.bottom.units==="px"&&h.height.val>0&&(C=C*100/h.height.val);var E=m(h.width.val-g.w,b,x),S=E.biasDiff,M=E.biasComplementDiff,R=m(h.height.val-g.h,A,C),T=R.biasDiff,B=R.biasComplementDiff;l.autoPadding=y(g.w,g.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),l.autoWidth=Math.max(g.w,h.width.val),v.x=(-S+g.x1+g.x2+M)/2,l.autoHeight=Math.max(g.h,h.height.val),v.y=(-T+g.y1+g.y2+B)/2}for(var i=0;i<this.length;i++){var a=this[i],s=a._private;(!s.compoundBoundsClean||r)&&(n(a),e.batching()||(s.compoundBoundsClean=!0))}return this};var vi=function(e){return e===1/0||e===-1/0?0:e},Mi=function(e,n,i,a,s){a-n===0||s-i===0||n==null||i==null||a==null||s==null||(e.x1=n<e.x1?n:e.x1,e.x2=a>e.x2?a:e.x2,e.y1=i<e.y1?i:e.y1,e.y2=s>e.y2?s:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},ms=function(e,n){return n==null?e:Mi(e,n.x1,n.y1,n.x2,n.y2)},Hu=function(e,n,i){return Un(e,n,i)},jh=function(e,n,i){if(!n.cy().headless()){var a=n._private,s=a.rstyle,o=s.arrowWidth/2,l=n.pstyle(i+"-arrow-shape").value,c,u;if(l!=="none"){i==="source"?(c=s.srcX,u=s.srcY):i==="target"?(c=s.tgtX,u=s.tgtY):(c=s.midX,u=s.midY);var h=a.arrowBounds=a.arrowBounds||{},g=h[i]=h[i]||{};g.x1=c-o,g.y1=u-o,g.x2=c+o,g.y2=u+o,g.w=g.x2-g.x1,g.h=g.y2-g.y1,Cd(g,1),Mi(e,g.x1,g.y1,g.x2,g.y2)}}},k1=function(e,n,i){if(!n.cy().headless()){var a;i?a=i+"-":a="";var s=n._private,o=s.rstyle,l=n.pstyle(a+"label").strValue;if(l){var c=n.pstyle("text-halign"),u=n.pstyle("text-valign"),h=Hu(o,"labelWidth",i),g=Hu(o,"labelHeight",i),v=Hu(o,"labelX",i),m=Hu(o,"labelY",i),y=n.pstyle(a+"text-margin-x").pfValue,b=n.pstyle(a+"text-margin-y").pfValue,x=n.isEdge(),A=n.pstyle(a+"text-rotation"),C=n.pstyle("text-outline-width").pfValue,E=n.pstyle("text-border-width").pfValue,S=E/2,M=n.pstyle("text-background-padding").pfValue,R=2,T=g,B=h,F=B/2,I=T/2,U,k,O,V;if(x)U=v-F,k=v+F,O=m-I,V=m+I;else{switch(c.value){case"left":U=v-B,k=v;break;case"center":U=v-F,k=v+F;break;case"right":U=v,k=v+B;break}switch(u.value){case"top":O=m-T,V=m;break;case"center":O=m-I,V=m+I;break;case"bottom":O=m,V=m+T;break}}var L=y-Math.max(C,S)-M-R,P=y+Math.max(C,S)+M+R,_=b-Math.max(C,S)-M-R,q=b+Math.max(C,S)+M+R;U+=L,k+=P,O+=_,V+=q;var H=i||"main",W=s.labelBounds,G=W[H]=W[H]||{};G.x1=U,G.y1=O,G.x2=k,G.y2=V,G.w=k-U,G.h=V-O,G.leftPad=L,G.rightPad=P,G.topPad=_,G.botPad=q;var K=x&&A.strValue==="autorotate",$=A.pfValue!=null&&A.pfValue!==0;if(K||$){var te=K?Hu(s.rstyle,"labelAngle",i):A.pfValue,ae=Math.cos(te),ue=Math.sin(te),re=(U+k)/2,ve=(O+V)/2;if(!x){switch(c.value){case"left":re=k;break;case"right":re=U;break}switch(u.value){case"top":ve=V;break;case"bottom":ve=O;break}}var le=function(it,$e){return it=it-re,$e=$e-ve,{x:it*ae-$e*ue+re,y:it*ue+$e*ae+ve}},ie=le(U,O),se=le(U,V),fe=le(k,O),xe=le(k,V);U=Math.min(ie.x,se.x,fe.x,xe.x),k=Math.max(ie.x,se.x,fe.x,xe.x),O=Math.min(ie.y,se.y,fe.y,xe.y),V=Math.max(ie.y,se.y,fe.y,xe.y)}var De=H+"Rot",ze=W[De]=W[De]||{};ze.x1=U,ze.y1=O,ze.x2=k,ze.y2=V,ze.w=k-U,ze.h=V-O,Mi(e,U,O,k,V),Mi(s.labelBounds.all,U,O,k,V)}return e}},g3=function(e,n){if(!n.cy().headless()){var i=n.pstyle("outline-opacity").value,a=n.pstyle("outline-width").value,s=n.pstyle("outline-offset").value,o=a+s;XE(e,n,i,o,"outside",o/2)}},XE=function(e,n,i,a,s,o){if(!(i===0||a<=0||s==="inside")){var l=n.cy(),c=n.pstyle("shape").value,u=l.renderer().nodeShapes[c],h=n.position(),g=h.x,v=h.y,m=n.width(),y=n.height();if(u.hasMiterBounds){s==="center"&&(a/=2);var b=u.miterBounds(g,v,m,y,a);ms(e,b)}else o!=null&&o>0&&Ed(e,[o,o,o,o])}},sI=function(e,n){if(!n.cy().headless()){var i=n.pstyle("border-opacity").value,a=n.pstyle("border-width").pfValue,s=n.pstyle("border-position").value;XE(e,n,i,a,s)}},oI=function(e,n){var i=e._private.cy,a=i.styleEnabled(),s=i.headless(),o=wn(),l=e._private,c=e.isNode(),u=e.isEdge(),h,g,v,m,y,b,x=l.rstyle,A=c&&a?e.pstyle("bounds-expansion").pfValue:[0],C=function(gt){return gt.pstyle("display").value!=="none"},E=!a||C(e)&&(!u||C(e.source())&&C(e.target()));if(E){var S=0,M=0;a&&n.includeOverlays&&(S=e.pstyle("overlay-opacity").value,S!==0&&(M=e.pstyle("overlay-padding").value));var R=0,T=0;a&&n.includeUnderlays&&(R=e.pstyle("underlay-opacity").value,R!==0&&(T=e.pstyle("underlay-padding").value));var B=Math.max(M,T),F=0,I=0;if(a&&(F=e.pstyle("width").pfValue,I=F/2),c&&n.includeNodes){var U=e.position();y=U.x,b=U.y;var k=e.outerWidth(),O=k/2,V=e.outerHeight(),L=V/2;h=y-O,g=y+O,v=b-L,m=b+L,Mi(o,h,v,g,m),a&&g3(o,e),a&&n.includeOutlines&&!s&&g3(o,e),a&&sI(o,e)}else if(u&&n.includeEdges)if(a&&!s){var P=e.pstyle("curve-style").strValue;if(h=Math.min(x.srcX,x.midX,x.tgtX),g=Math.max(x.srcX,x.midX,x.tgtX),v=Math.min(x.srcY,x.midY,x.tgtY),m=Math.max(x.srcY,x.midY,x.tgtY),h-=I,g+=I,v-=I,m+=I,Mi(o,h,v,g,m),P==="haystack"){var _=x.haystackPts;if(_&&_.length===2){if(h=_[0].x,v=_[0].y,g=_[1].x,m=_[1].y,h>g){var q=h;h=g,g=q}if(v>m){var H=v;v=m,m=H}Mi(o,h-I,v-I,g+I,m+I)}}else if(P==="bezier"||P==="unbundled-bezier"||As(P,"segments")||As(P,"taxi")){var W;switch(P){case"bezier":case"unbundled-bezier":W=x.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":W=x.linePts;break}if(W!=null)for(var G=0;G<W.length;G++){var K=W[G];h=K.x-I,g=K.x+I,v=K.y-I,m=K.y+I,Mi(o,h,v,g,m)}}}else{var $=e.source(),te=$.position(),ae=e.target(),ue=ae.position();if(h=te.x,g=ue.x,v=te.y,m=ue.y,h>g){var re=h;h=g,g=re}if(v>m){var ve=v;v=m,m=ve}h-=I,g+=I,v-=I,m+=I,Mi(o,h,v,g,m)}if(a&&n.includeEdges&&u&&(jh(o,e,"mid-source"),jh(o,e,"mid-target"),jh(o,e,"source"),jh(o,e,"target")),a){var le=e.pstyle("ghost").value==="yes";if(le){var ie=e.pstyle("ghost-offset-x").pfValue,se=e.pstyle("ghost-offset-y").pfValue;Mi(o,o.x1+ie,o.y1+se,o.x2+ie,o.y2+se)}}var fe=l.bodyBounds=l.bodyBounds||{};$5(fe,o),Ed(fe,A),Cd(fe,1),a&&(h=o.x1,g=o.x2,v=o.y1,m=o.y2,Mi(o,h-B,v-B,g+B,m+B));var xe=l.overlayBounds=l.overlayBounds||{};$5(xe,o),Ed(xe,A),Cd(xe,1);var De=l.labelBounds=l.labelBounds||{};De.all!=null?GR(De.all):De.all=wn(),a&&n.includeLabels&&(n.includeMainLabels&&k1(o,e,null),u&&(n.includeSourceLabels&&k1(o,e,"source"),n.includeTargetLabels&&k1(o,e,"target")))}return o.x1=vi(o.x1),o.y1=vi(o.y1),o.x2=vi(o.x2),o.y2=vi(o.y2),o.w=vi(o.x2-o.x1),o.h=vi(o.y2-o.y1),o.w>0&&o.h>0&&E&&(Ed(o,A),Cd(o,1)),o},QE=function(e){var n=0,i=function(o){return(o?1:0)<<n++},a=0;return a+=i(e.incudeNodes),a+=i(e.includeEdges),a+=i(e.includeLabels),a+=i(e.includeMainLabels),a+=i(e.includeSourceLabels),a+=i(e.includeTargetLabels),a+=i(e.includeOverlays),a+=i(e.includeOutlines),a},ZE=function(e){var n=function(l){return Math.round(l)};if(e.isEdge()){var i=e.source().position(),a=e.target().position();return K5([n(i.x),n(i.y),n(a.x),n(a.y)])}else{var s=e.position();return K5([n(s.x),n(s.y)])}},v3=function(e,n){var i=e._private,a,s=e.isEdge(),o=n==null?m3:QE(n),l=o===m3;if(i.bbCache==null?(a=oI(e,Gc),i.bbCache=a,i.bbCachePosKey=ZE(e)):a=i.bbCache,!l){var c=e.isNode();a=wn(),(n.includeNodes&&c||n.includeEdges&&!c)&&(n.includeOverlays?ms(a,i.overlayBounds):ms(a,i.bodyBounds)),n.includeLabels&&(n.includeMainLabels&&(!s||n.includeSourceLabels&&n.includeTargetLabels)?ms(a,i.labelBounds.all):(n.includeMainLabels&&ms(a,i.labelBounds.mainRot),n.includeSourceLabels&&ms(a,i.labelBounds.sourceRot),n.includeTargetLabels&&ms(a,i.labelBounds.targetRot))),a.w=a.x2-a.x1,a.h=a.y2-a.y1}return a},Gc={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},m3=QE(Gc),p3=on(Gc);Us.boundingBox=function(r){var e,n=r===void 0||r.useCache===void 0||r.useCache===!0,i=Gl(function(h){var g=h._private;return g.bbCache==null||g.styleDirty||g.bbCachePosKey!==ZE(h)},function(h){return h.id()});if(n&&this.length===1&&!i(this[0]))r===void 0?r=Gc:r=p3(r),e=v3(this[0],r);else{e=wn(),r=r||Gc;var a=p3(r),s=this,o=s.cy(),l=o.styleEnabled();this.edges().forEach(i),this.nodes().forEach(i),l&&this.recalculateRenderedStyle(n),this.updateCompoundBounds(!n);for(var c=0;c<s.length;c++){var u=s[c];i(u)&&u.dirtyBoundingBoxCache(),ms(e,v3(u,a))}}return e.x1=vi(e.x1),e.y1=vi(e.y1),e.x2=vi(e.x2),e.y2=vi(e.y2),e.w=vi(e.x2-e.x1),e.h=vi(e.y2-e.y1),e};Us.dirtyBoundingBoxCache=function(){for(var r=0;r<this.length;r++){var e=this[r]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Us.boundingBoxAt=function(r){var e=this.nodes(),n=this.cy(),i=n.hasCompoundNodes(),a=n.collection();if(i&&(a=e.filter(function(u){return u.isParent()}),e=e.not(a)),Dt(r)){var s=r;r=function(){return s}}var o=function(h,g){return h._private.bbAtOldPos=r(h,g)},l=function(h){return h._private.bbAtOldPos};n.startBatch(),e.forEach(o).silentPositions(r),i&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0));var c=zR(this.boundingBox({useCache:!1}));return e.silentPositions(l),i&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0)),n.endBatch(),c};Ll.boundingbox=Ll.bb=Ll.boundingBox;Ll.renderedBoundingbox=Ll.renderedBoundingBox;var lI=Us,mc,uf;mc=uf={};var WE=function(e){e.uppercaseName=N5(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=N5(e.outerName),mc[e.name]=function(){var i=this[0],a=i._private,s=a.cy,o=s._private.styleEnabled;if(i)if(o){if(i.isParent())return i.updateCompoundBounds(),a[e.autoName]||0;var l=i.pstyle(e.name);switch(l.strValue){case"label":return i.recalculateRenderedStyle(),a.rstyle[e.labelName]||0;default:return l.pfValue}}else return 1},mc["outer"+e.uppercaseName]=function(){var i=this[0],a=i._private,s=a.cy,o=s._private.styleEnabled;if(i)if(o){var l=i[e.name](),c=i.pstyle("border-position").value,u;c==="center"?u=i.pstyle("border-width").pfValue:c==="outside"?u=2*i.pstyle("border-width").pfValue:u=0;var h=2*i.padding();return l+u+h}else return 1},mc["rendered"+e.uppercaseName]=function(){var i=this[0];if(i){var a=i[e.name]();return a*this.cy().zoom()}},mc["rendered"+e.uppercaseOuterName]=function(){var i=this[0];if(i){var a=i[e.outerName]();return a*this.cy().zoom()}}};WE({name:"width"});WE({name:"height"});uf.padding=function(){var r=this[0],e=r._private;return r.isParent()?(r.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:r.pstyle("padding").pfValue):r.pstyle("padding").pfValue};uf.paddedHeight=function(){var r=this[0];return r.height()+2*r.padding()};uf.paddedWidth=function(){var r=this[0];return r.width()+2*r.padding()};var uI=uf,cI=function(e,n){if(e.isEdge()&&e.takesUpSpace())return n(e)},fI=function(e,n){if(e.isEdge()&&e.takesUpSpace()){var i=e.cy();return E0(n(e),i.zoom(),i.pan())}},hI=function(e,n){if(e.isEdge()&&e.takesUpSpace()){var i=e.cy(),a=i.pan(),s=i.zoom();return n(e).map(function(o){return E0(o,s,a)})}},dI=function(e){return e.renderer().getControlPoints(e)},gI=function(e){return e.renderer().getSegmentPoints(e)},vI=function(e){return e.renderer().getSourceEndpoint(e)},mI=function(e){return e.renderer().getTargetEndpoint(e)},pI=function(e){return e.renderer().getEdgeMidpoint(e)},y3={controlPoints:{get:dI,mult:!0},segmentPoints:{get:gI,mult:!0},sourceEndpoint:{get:vI},targetEndpoint:{get:mI},midpoint:{get:pI}},yI=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},AI=Object.keys(y3).reduce(function(r,e){var n=y3[e],i=yI(e);return r[e]=function(){return cI(this,n.get)},n.mult?r[i]=function(){return hI(this,n.get)}:r[i]=function(){return fI(this,n.get)},r},{}),xI=et({},aI,lI,uI,AI);/*!
Event object based on jQuery events, MIT license

https://jquery.org/license/
https://tldrlegal.com/license/mit-license
https://github.com/jquery/jquery/blob/master/src/event.js
*/var JE=function(e,n){this.recycle(e,n)};function Ku(){return!1}function Hh(){return!0}JE.prototype={instanceString:function(){return"event"},recycle:function(e,n){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Ku,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Hh:Ku):e!=null&&e.type?n=e:this.type=e,n!=null&&(this.originalEvent=n.originalEvent,this.type=n.type!=null?n.type:this.type,this.cy=n.cy,this.target=n.target,this.position=n.position,this.renderedPosition=n.renderedPosition,this.namespace=n.namespace,this.layout=n.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var i=this.position,a=this.cy.zoom(),s=this.cy.pan();this.renderedPosition={x:i.x*a+s.x,y:i.y*a+s.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Hh;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Hh;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Hh,this.stopPropagation()},isDefaultPrevented:Ku,isPropagationStopped:Ku,isImmediatePropagationStopped:Ku};var $E=/^([^.]+)(\.(?:[^.]+))?$/,bI=".*",eS={qualifierCompare:function(e,n){return e===n},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},A3=Object.keys(eS),wI={};function I0(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wI,e=arguments.length>1?arguments[1]:void 0,n=0;n<A3.length;n++){var i=A3[n];this[i]=r[i]||eS[i]}this.context=e||this.context,this.listeners=[],this.emitting=0}var Ns=I0.prototype,tS=function(e,n,i,a,s,o,l){gr(a)&&(s=a,a=null),l&&(o==null?o=l:o=et({},o,l));for(var c=Qt(i)?i:i.split(/\s+/),u=0;u<c.length;u++){var h=c[u];if(!Ms(h)){var g=h.match($E);if(g){var v=g[1],m=g[2]?g[2]:null,y=n(e,h,v,m,a,s,o);if(y===!1)break}}}},x3=function(e,n){return e.addEventFields(e.context,n),new JE(n.type,n)},CI=function(e,n,i){if(R8(i)){n(e,i);return}else if(Dt(i)){n(e,x3(e,i));return}for(var a=Qt(i)?i:i.split(/\s+/),s=0;s<a.length;s++){var o=a[s];if(!Ms(o)){var l=o.match($E);if(l){var c=l[1],u=l[2]?l[2]:null,h=x3(e,{type:c,namespace:u,target:e.context});n(e,h)}}}};Ns.on=Ns.addListener=function(r,e,n,i,a){return tS(this,function(s,o,l,c,u,h,g){gr(h)&&s.listeners.push({event:o,callback:h,type:l,namespace:c,qualifier:u,conf:g})},r,e,n,i,a),this};Ns.one=function(r,e,n,i){return this.on(r,e,n,i,{one:!0})};Ns.removeListener=Ns.off=function(r,e,n,i){var a=this;this.emitting!==0&&(this.listeners=fR(this.listeners));for(var s=this.listeners,o=function(u){var h=s[u];tS(a,function(g,v,m,y,b,x){if((h.type===m||r==="*")&&(!y&&h.namespace!==".*"||h.namespace===y)&&(!b||g.qualifierCompare(h.qualifier,b))&&(!x||h.callback===x))return s.splice(u,1),!1},r,e,n,i)},l=s.length-1;l>=0;l--)o(l);return this};Ns.removeAllListeners=function(){return this.removeListener("*")};Ns.emit=Ns.trigger=function(r,e,n){var i=this.listeners,a=i.length;return this.emitting++,Qt(e)||(e=[e]),CI(this,function(s,o){n!=null&&(i=[{event:o.event,type:o.type,namespace:o.namespace,callback:n}],a=i.length);for(var l=function(){var h=i[c];if(h.type===o.type&&(!h.namespace||h.namespace===o.namespace||h.namespace===bI)&&s.eventMatches(s.context,h,o)){var g=[o];e!=null&&dR(g,e),s.beforeEmit(s.context,h,o),h.conf&&h.conf.one&&(s.listeners=s.listeners.filter(function(y){return y!==h}));var v=s.callbackContext(s.context,h,o),m=h.callback.apply(v,g);s.afterEmit(s.context,h,o),m===!1&&(o.stopPropagation(),o.preventDefault())}},c=0;c<a;c++)l();s.bubble(s.context)&&!o.isPropagationStopped()&&s.parent(s.context).emit(o,e)},r),this.emitting--,this};var EI={qualifierCompare:function(e,n){return e==null||n==null?e==null&&n==null:e.sameText(n)},eventMatches:function(e,n,i){var a=n.qualifier;return a!=null?e!==i.target&&rf(i.target)&&a.matches(i.target):!0},addEventFields:function(e,n){n.cy=e.cy(),n.target=e},callbackContext:function(e,n,i){return n.qualifier!=null?i.target:e},beforeEmit:function(e,n){n.conf&&n.conf.once&&n.conf.onceCollection.removeListener(n.event,n.qualifier,n.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},Kh=function(e){return We(e)?new Bs(e):e},rS={createEmitter:function(){for(var e=0;e<this.length;e++){var n=this[e],i=n._private;i.emitter||(i.emitter=new I0(EI,n))}return this},emitter:function(){return this._private.emitter},on:function(e,n,i){for(var a=Kh(n),s=0;s<this.length;s++){var o=this[s];o.emitter().on(e,a,i)}return this},removeListener:function(e,n,i){for(var a=Kh(n),s=0;s<this.length;s++){var o=this[s];o.emitter().removeListener(e,a,i)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var n=this[e];n.emitter().removeAllListeners()}return this},one:function(e,n,i){for(var a=Kh(n),s=0;s<this.length;s++){var o=this[s];o.emitter().one(e,a,i)}return this},once:function(e,n,i){for(var a=Kh(n),s=0;s<this.length;s++){var o=this[s];o.emitter().on(e,a,i,{once:!0,onceCollection:this})}},emit:function(e,n){for(var i=0;i<this.length;i++){var a=this[i];a.emitter().emit(e,n)}return this},emitAndNotify:function(e,n){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,n),this}};Ot.eventAliasesOn(rS);var nS={nodes:function(e){return this.filter(function(n){return n.isNode()}).filter(e)},edges:function(e){return this.filter(function(n){return n.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),n=this.spawn(),i=0;i<this.length;i++){var a=this[i];a.isNode()?e.push(a):n.push(a)}return{nodes:e,edges:n}},filter:function(e,n){if(e===void 0)return this;if(We(e)||Jn(e))return new Bs(e).filter(this);if(gr(e)){for(var i=this.spawn(),a=this,s=0;s<a.length;s++){var o=a[s],l=n?e.apply(n,[o,s,a]):e(o,s,a);l&&i.push(o)}return i}return this.spawn()},not:function(e){if(e){We(e)&&(e=this.filter(e));for(var n=this.spawn(),i=0;i<this.length;i++){var a=this[i],s=e.has(a);s||n.push(a)}return n}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(We(e)){var n=e;return this.filter(n)}for(var i=this.spawn(),a=this,s=e,o=this.length<e.length,l=o?a:s,c=o?s:a,u=0;u<l.length;u++){var h=l[u];c.has(h)&&i.push(h)}return i},xor:function(e){var n=this._private.cy;We(e)&&(e=n.$(e));var i=this.spawn(),a=this,s=e,o=function(c,u){for(var h=0;h<c.length;h++){var g=c[h],v=g._private.data.id,m=u.hasElementWithId(v);m||i.push(g)}};return o(a,s),o(s,a),i},diff:function(e){var n=this._private.cy;We(e)&&(e=n.$(e));var i=this.spawn(),a=this.spawn(),s=this.spawn(),o=this,l=e,c=function(h,g,v){for(var m=0;m<h.length;m++){var y=h[m],b=y._private.data.id,x=g.hasElementWithId(b);x?s.merge(y):v.push(y)}};return c(o,l,i),c(l,o,a),{left:i,right:a,both:s}},add:function(e){var n=this._private.cy;if(!e)return this;if(We(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=this.spawnSelf(),s=0;s<e.length;s++){var o=e[s],l=!this.has(o);l&&a.push(o)}return a},merge:function(e){var n=this._private,i=n.cy;if(!e)return this;if(e&&We(e)){var a=e;e=i.mutableElements().filter(a)}for(var s=n.map,o=0;o<e.length;o++){var l=e[o],c=l._private.data.id,u=!s.has(c);if(u){var h=this.length++;this[h]=l,s.set(c,{ele:l,index:h})}}return this},unmergeAt:function(e){var n=this[e],i=n.id(),a=this._private,s=a.map;this[e]=void 0,s.delete(i);var o=e===this.length-1;if(this.length>1&&!o){var l=this.length-1,c=this[l],u=c._private.data.id;this[l]=void 0,this[e]=c,s.set(u,{ele:c,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var n=this._private,i=e._private.data.id,a=n.map,s=a.get(i);if(!s)return this;var o=s.index;return this.unmergeAt(o),this},unmerge:function(e){var n=this._private.cy;if(!e)return this;if(e&&We(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=0;a<e.length;a++)this.unmergeOne(e[a]);return this},unmergeBy:function(e){for(var n=this.length-1;n>=0;n--){var i=this[n];e(i)&&this.unmergeAt(n)}return this},map:function(e,n){for(var i=[],a=this,s=0;s<a.length;s++){var o=a[s],l=n?e.apply(n,[o,s,a]):e(o,s,a);i.push(l)}return i},reduce:function(e,n){for(var i=n,a=this,s=0;s<a.length;s++)i=e(i,a[s],s,a);return i},max:function(e,n){for(var i=-1/0,a,s=this,o=0;o<s.length;o++){var l=s[o],c=n?e.apply(n,[l,o,s]):e(l,o,s);c>i&&(i=c,a=l)}return{value:i,ele:a}},min:function(e,n){for(var i=1/0,a,s=this,o=0;o<s.length;o++){var l=s[o],c=n?e.apply(n,[l,o,s]):e(l,o,s);c<i&&(i=c,a=l)}return{value:i,ele:a}}},Ft=nS;Ft.u=Ft["|"]=Ft["+"]=Ft.union=Ft.or=Ft.add;Ft["\\"]=Ft["!"]=Ft["-"]=Ft.difference=Ft.relativeComplement=Ft.subtract=Ft.not;Ft.n=Ft["&"]=Ft["."]=Ft.and=Ft.intersection=Ft.intersect;Ft["^"]=Ft["(+)"]=Ft["(-)"]=Ft.symmetricDifference=Ft.symdiff=Ft.xor;Ft.fnFilter=Ft.filterFn=Ft.stdFilter=Ft.filter;Ft.complement=Ft.abscomp=Ft.absoluteComplement;var SI={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},iS=function(e,n){var i=e.cy(),a=i.hasCompoundNodes();function s(h){var g=h.pstyle("z-compound-depth");return g.value==="auto"?a?h.zDepth():0:g.value==="bottom"?-1:g.value==="top"?w2:0}var o=s(e)-s(n);if(o!==0)return o;function l(h){var g=h.pstyle("z-index-compare");return g.value==="auto"&&h.isNode()?1:0}var c=l(e)-l(n);if(c!==0)return c;var u=e.pstyle("z-index").value-n.pstyle("z-index").value;return u!==0?u:e.poolIndex()-n.poolIndex()},$d={forEach:function(e,n){if(gr(e))for(var i=this.length,a=0;a<i;a++){var s=this[a],o=n?e.apply(n,[s,a,this]):e(s,a,this);if(o===!1)break}return this},toArray:function(){for(var e=[],n=0;n<this.length;n++)e.push(this[n]);return e},slice:function(e,n){var i=[],a=this.length;n==null&&(n=a),e==null&&(e=0),e<0&&(e=a+e),n<0&&(n=a+n);for(var s=e;s>=0&&s<n&&s<a;s++)i.push(this[s]);return this.spawn(i)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!gr(e))return this;var n=this.toArray().sort(e);return this.spawn(n)},sortByZIndex:function(){return this.sort(iS)},zDepth:function(){var e=this[0];if(e){var n=e._private,i=n.group;if(i==="nodes"){var a=n.data.parent?e.parents().size():0;return e.isParent()?a:w2-1}else{var s=n.source,o=n.target,l=s.zDepth(),c=o.zDepth();return Math.max(l,c,0)}}}};$d.each=$d.forEach;var TI=function(){var e="undefined",n=(typeof Symbol>"u"?"undefined":Or(Symbol))!=e&&Or(Symbol.iterator)!=e;n&&($d[Symbol.iterator]=function(){var i=this,a={value:void 0,done:!1},s=0,o=this.length;return rE({next:function(){return s<o?a.value=i[s++]:(a.value=void 0,a.done=!0),a}},Symbol.iterator,function(){return this})})};TI();var MI=on({nodeDimensionsIncludeLabels:!1}),Td={layoutDimensions:function(e){e=MI(e);var n;if(!this.takesUpSpace())n={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var i=this.boundingBox();n={w:i.w,h:i.h}}else n={w:this.outerWidth(),h:this.outerHeight()};return(n.w===0||n.h===0)&&(n.w=n.h=1),n},layoutPositions:function(e,n,i){var a=this.nodes().filter(function(M){return!M.isParent()}),s=this.cy(),o=n.eles,l=function(R){return R.id()},c=Gl(i,l);e.emit({type:"layoutstart",layout:e}),e.animations=[];var u=function(R,T,B){var F={x:T.x1+T.w/2,y:T.y1+T.h/2},I={x:(B.x-F.x)*R,y:(B.y-F.y)*R};return{x:F.x+I.x,y:F.y+I.y}},h=n.spacingFactor&&n.spacingFactor!==1,g=function(){if(!h)return null;for(var R=wn(),T=0;T<a.length;T++){var B=a[T],F=c(B,T);wE(R,F.x,F.y)}return R},v=g(),m=Gl(function(M,R){var T=c(M,R);if(h){var B=Math.abs(n.spacingFactor);T=u(B,v,T)}return n.transform!=null&&(T=n.transform(M,T)),T},l);if(n.animate){for(var y=0;y<a.length;y++){var b=a[y],x=m(b,y),A=n.animateFilter==null||n.animateFilter(b,y);if(A){var C=b.animation({position:x,duration:n.animationDuration,easing:n.animationEasing});e.animations.push(C)}else b.position(x)}if(n.fit){var E=s.animation({fit:{boundingBox:o.boundingBoxAt(m),padding:n.padding},duration:n.animationDuration,easing:n.animationEasing});e.animations.push(E)}else if(n.zoom!==void 0&&n.pan!==void 0){var S=s.animation({zoom:n.zoom,pan:n.pan,duration:n.animationDuration,easing:n.animationEasing});e.animations.push(S)}e.animations.forEach(function(M){return M.play()}),e.one("layoutready",n.ready),e.emit({type:"layoutready",layout:e}),Ql.all(e.animations.map(function(M){return M.promise()})).then(function(){e.one("layoutstop",n.stop),e.emit({type:"layoutstop",layout:e})})}else a.positions(m),n.fit&&s.fit(n.eles,n.padding),n.zoom!=null&&s.zoom(n.zoom),n.pan&&s.pan(n.pan),e.one("layoutready",n.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",n.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var n=this.cy();return n.makeLayout(et({},e,{eles:this}))}};Td.createLayout=Td.makeLayout=Td.layout;function aS(r,e,n){var i=n._private,a=i.styleCache=i.styleCache||[],s;return(s=a[r])!=null||(s=a[r]=e(n)),s}function N0(r,e){return r=bo(r),function(i){return aS(r,e,i)}}function F0(r,e){r=bo(r);var n=function(a){return e.call(a)};return function(){var a=this[0];if(a)return aS(r,n,a)}}var an={recalculateRenderedStyle:function(e){var n=this.cy(),i=n.renderer(),a=n.styleEnabled();return i&&a&&i.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),n=function(s){return s._private.styleCache=null};if(e.hasCompoundNodes()){var i;i=this.spawnSelf().merge(this.descendants()).merge(this.parents()),i.merge(i.connectedEdges()),i.forEach(n)}else this.forEach(function(a){n(a),a.connectedEdges().forEach(n)});return this},updateStyle:function(e){var n=this._private.cy;if(!n.styleEnabled())return this;if(n.batching()){var i=n._private.batchStyleEles;return i.merge(this),this}var a=n.hasCompoundNodes(),s=this;e=!!(e||e===void 0),a&&(s=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=s;return e?o.emitAndNotify("style"):o.emit("style"),s.forEach(function(l){return l._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var n=0;n<this.length;n++){var i=this[n];i._private.styleDirty&&(i._private.styleDirty=!1,e.style().apply(i))}},parsedStyle:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=this[0],a=i.cy();if(a.styleEnabled()&&i){i._private.styleDirty&&(i._private.styleDirty=!1,a.style().apply(i));var s=i._private.style[e];return s??(n?a.style().getDefaultProperty(e):null)}},numericStyle:function(e){var n=this[0];if(n.cy().styleEnabled()&&n){var i=n.pstyle(e);return i.pfValue!==void 0?i.pfValue:i.value}},numericStyleUnits:function(e){var n=this[0];if(n.cy().styleEnabled()&&n)return n.pstyle(e).units},renderedStyle:function(e){var n=this.cy();if(!n.styleEnabled())return this;var i=this[0];if(i)return n.style().getRenderedStyle(i,e)},style:function(e,n){var i=this.cy();if(!i.styleEnabled())return this;var a=!1,s=i.style();if(Dt(e)){var o=e;s.applyBypass(this,o,a),this.emitAndNotify("style")}else if(We(e))if(n===void 0){var l=this[0];return l?s.getStylePropertyValue(l,e):void 0}else s.applyBypass(this,e,n,a),this.emitAndNotify("style");else if(e===void 0){var c=this[0];return c?s.getRawStyle(c):void 0}return this},removeStyle:function(e){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style(),s=this;if(e===void 0)for(var o=0;o<s.length;o++){var l=s[o];a.removeAllBypasses(l,i)}else{e=e.split(/\s+/);for(var c=0;c<s.length;c++){var u=s[c];a.removeBypasses(u,e,i)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var n=e.hasCompoundNodes(),i=this[0];if(i){var a=i._private,s=i.pstyle("opacity").value;if(!n)return s;var o=a.data.parent?i.parents():null;if(o)for(var l=0;l<o.length;l++){var c=o[l],u=c.pstyle("opacity").value;s=u*s}return s}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var n=this[0],i=n.cy().hasCompoundNodes();if(n)return i?n.effectiveOpacity()===0:n.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var n=this[0];return!!n._private.backgrounding}};function U1(r,e){var n=r._private,i=n.data.parent?r.parents():null;if(i)for(var a=0;a<i.length;a++){var s=i[a];if(!e(s))return!1}return!0}function k2(r){var e=r.ok,n=r.edgeOkViaNode||r.ok,i=r.parentOk||r.ok;return function(){var a=this.cy();if(!a.styleEnabled())return!0;var s=this[0],o=a.hasCompoundNodes();if(s){var l=s._private;if(!e(s))return!1;if(s.isNode())return!o||U1(s,i);var c=l.source,u=l.target;return n(c)&&(!o||U1(c,n))&&(c===u||n(u)&&(!o||U1(u,n)))}}}var Zl=N0("eleTakesUpSpace",function(r){return r.pstyle("display").value==="element"&&r.width()!==0&&(r.isNode()?r.height()!==0:!0)});an.takesUpSpace=F0("takesUpSpace",k2({ok:Zl}));var DI=N0("eleInteractive",function(r){return r.pstyle("events").value==="yes"&&r.pstyle("visibility").value==="visible"&&Zl(r)}),RI=N0("parentInteractive",function(r){return r.pstyle("visibility").value==="visible"&&Zl(r)});an.interactive=F0("interactive",k2({ok:DI,parentOk:RI,edgeOkViaNode:Zl}));an.noninteractive=function(){var r=this[0];if(r)return!r.interactive()};var BI=N0("eleVisible",function(r){return r.pstyle("visibility").value==="visible"&&r.pstyle("opacity").pfValue!==0&&Zl(r)}),II=Zl;an.visible=F0("visible",k2({ok:BI,edgeOkViaNode:II}));an.hidden=function(){var r=this[0];if(r)return!r.visible()};an.isBundledBezier=F0("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});an.bypass=an.css=an.style;an.renderedCss=an.renderedStyle;an.removeBypass=an.removeCss=an.removeStyle;an.pstyle=an.parsedStyle;var Ss={};function b3(r){return function(){var e=arguments,n=[];if(e.length===2){var i=e[0],a=e[1];this.on(r.event,i,a)}else if(e.length===1&&gr(e[0])){var s=e[0];this.on(r.event,s)}else if(e.length===0||e.length===1&&Qt(e[0])){for(var o=e.length===1?e[0]:null,l=0;l<this.length;l++){var c=this[l],u=!r.ableField||c._private[r.ableField],h=c._private[r.field]!=r.value;if(r.overrideAble){var g=r.overrideAble(c);if(g!==void 0&&(u=g,!g))return this}u&&(c._private[r.field]=r.value,h&&n.push(c))}var v=this.spawn(n);v.updateStyle(),v.emit(r.event),o&&v.emit(o)}return this}}function Wl(r){Ss[r.field]=function(){var e=this[0];if(e){if(r.overrideField){var n=r.overrideField(e);if(n!==void 0)return n}return e._private[r.field]}},Ss[r.on]=b3({event:r.on,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!0}),Ss[r.off]=b3({event:r.off,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!1})}Wl({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});Wl({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});Wl({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});Wl({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});Ss.deselect=Ss.unselect;Ss.grabbed=function(){var r=this[0];if(r)return r._private.grabbed};Wl({field:"active",on:"activate",off:"unactivate"});Wl({field:"pannable",on:"panify",off:"unpanify"});Ss.inactive=function(){var r=this[0];if(r)return!r._private.active};var gn={},w3=function(e){return function(i){for(var a=this,s=[],o=0;o<a.length;o++){var l=a[o];if(l.isNode()){for(var c=!1,u=l.connectedEdges(),h=0;h<u.length;h++){var g=u[h],v=g.source(),m=g.target();if(e.noIncomingEdges&&m===l&&v!==l||e.noOutgoingEdges&&v===l&&m!==l){c=!0;break}}c||s.push(l)}}return this.spawn(s,!0).filter(i)}},C3=function(e){return function(n){for(var i=this,a=[],s=0;s<i.length;s++){var o=i[s];if(o.isNode())for(var l=o.connectedEdges(),c=0;c<l.length;c++){var u=l[c],h=u.source(),g=u.target();e.outgoing&&h===o?(a.push(u),a.push(g)):e.incoming&&g===o&&(a.push(u),a.push(h))}}return this.spawn(a,!0).filter(n)}},E3=function(e){return function(n){for(var i=this,a=[],s={};;){var o=e.outgoing?i.outgoers():i.incomers();if(o.length===0)break;for(var l=!1,c=0;c<o.length;c++){var u=o[c],h=u.id();s[h]||(s[h]=!0,a.push(u),l=!0)}if(!l)break;i=o}return this.spawn(a,!0).filter(n)}};gn.clearTraversalCache=function(){for(var r=0;r<this.length;r++)this[r]._private.traversalCache=null};et(gn,{roots:w3({noIncomingEdges:!0}),leaves:w3({noOutgoingEdges:!0}),outgoers:Ai(C3({outgoing:!0}),"outgoers"),successors:E3({outgoing:!0}),incomers:Ai(C3({incoming:!0}),"incomers"),predecessors:E3({})});et(gn,{neighborhood:Ai(function(r){for(var e=[],n=this.nodes(),i=0;i<n.length;i++)for(var a=n[i],s=a.connectedEdges(),o=0;o<s.length;o++){var l=s[o],c=l.source(),u=l.target(),h=a===c?u:c;h.length>0&&e.push(h[0]),e.push(l[0])}return this.spawn(e,!0).filter(r)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});gn.neighbourhood=gn.neighborhood;gn.closedNeighbourhood=gn.closedNeighborhood;gn.openNeighbourhood=gn.openNeighborhood;et(gn,{source:Ai(function(e){var n=this[0],i;return n&&(i=n._private.source||n.cy().collection()),i&&e?i.filter(e):i},"source"),target:Ai(function(e){var n=this[0],i;return n&&(i=n._private.target||n.cy().collection()),i&&e?i.filter(e):i},"target"),sources:S3({attr:"source"}),targets:S3({attr:"target"})});function S3(r){return function(n){for(var i=[],a=0;a<this.length;a++){var s=this[a],o=s._private[r.attr];o&&i.push(o)}return this.spawn(i,!0).filter(n)}}et(gn,{edgesWith:Ai(T3(),"edgesWith"),edgesTo:Ai(T3({thisIsSrc:!0}),"edgesTo")});function T3(r){return function(n){var i=[],a=this._private.cy,s=r||{};We(n)&&(n=a.$(n));for(var o=0;o<n.length;o++)for(var l=n[o]._private.edges,c=0;c<l.length;c++){var u=l[c],h=u._private.data,g=this.hasElementWithId(h.source)&&n.hasElementWithId(h.target),v=n.hasElementWithId(h.source)&&this.hasElementWithId(h.target),m=g||v;m&&((s.thisIsSrc||s.thisIsTgt)&&(s.thisIsSrc&&!g||s.thisIsTgt&&!v)||i.push(u))}return this.spawn(i,!0)}}et(gn,{connectedEdges:Ai(function(r){for(var e=[],n=this,i=0;i<n.length;i++){var a=n[i];if(a.isNode())for(var s=a._private.edges,o=0;o<s.length;o++){var l=s[o];e.push(l)}}return this.spawn(e,!0).filter(r)},"connectedEdges"),connectedNodes:Ai(function(r){for(var e=[],n=this,i=0;i<n.length;i++){var a=n[i];a.isEdge()&&(e.push(a.source()[0]),e.push(a.target()[0]))}return this.spawn(e,!0).filter(r)},"connectedNodes"),parallelEdges:Ai(M3(),"parallelEdges"),codirectedEdges:Ai(M3({codirected:!0}),"codirectedEdges")});function M3(r){var e={codirected:!1};return r=et({},e,r),function(i){for(var a=[],s=this.edges(),o=r,l=0;l<s.length;l++)for(var c=s[l],u=c._private,h=u.source,g=h._private.data.id,v=u.data.target,m=h._private.edges,y=0;y<m.length;y++){var b=m[y],x=b._private.data,A=x.target,C=x.source,E=A===v&&C===g,S=g===A&&v===C;(o.codirected&&E||!o.codirected&&(E||S))&&a.push(b)}return this.spawn(a,!0).filter(i)}}et(gn,{components:function(e){var n=this,i=n.cy(),a=i.collection(),s=e==null?n.nodes():e.nodes(),o=[];e!=null&&s.empty()&&(s=e.sources());var l=function(h,g){a.merge(h),s.unmerge(h),g.merge(h)};if(s.empty())return n.spawn();var c=function(){var h=i.collection();o.push(h);var g=s[0];l(g,h),n.bfs({directed:!1,roots:g,visit:function(m){return l(m,h)}}),h.forEach(function(v){v.connectedEdges().forEach(function(m){n.has(m)&&h.has(m.source())&&h.has(m.target())&&h.merge(m)})})};do c();while(s.length>0);return o},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});gn.componentsOf=gn.components;var sn=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){ur("A collection must have a reference to the core");return}var s=new Sa,o=!1;if(!n)n=[];else if(n.length>0&&Dt(n[0])&&!rf(n[0])){o=!0;for(var l=[],c=new Xl,u=0,h=n.length;u<h;u++){var g=n[u];g.data==null&&(g.data={});var v=g.data;if(v.id==null)v.id=AE();else if(e.hasElementWithId(v.id)||c.has(v.id))continue;var m=new C0(e,g,!1);l.push(m),c.add(v.id)}n=l}this.length=0;for(var y=0,b=n.length;y<b;y++){var x=n[y][0];if(x!=null){var A=x._private.data.id;(!i||!s.has(A))&&(i&&s.set(A,{index:this.length,ele:x}),this[this.length]=x,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(C){this.lazyMap=C},rebuildMap:function(){for(var E=this.lazyMap=new Sa,S=this.eles,M=0;M<S.length;M++){var R=S[M];E.set(R.id(),{index:M,ele:R})}}},i&&(this._private.map=s),o&&!a&&this.restore()},$t=C0.prototype=sn.prototype=Object.create(Array.prototype);$t.instanceString=function(){return"collection"};$t.spawn=function(r,e){return new sn(this.cy(),r,e)};$t.spawnSelf=function(){return this.spawn(this)};$t.cy=function(){return this._private.cy};$t.renderer=function(){return this._private.cy.renderer()};$t.element=function(){return this[0]};$t.collection=function(){return aE(this)?this:new sn(this._private.cy,[this])};$t.unique=function(){return new sn(this._private.cy,this,!0)};$t.hasElementWithId=function(r){return r=""+r,this._private.map.has(r)};$t.getElementById=function(r){r=""+r;var e=this._private.cy,n=this._private.map.get(r);return n?n.ele:new sn(e)};$t.$id=$t.getElementById;$t.poolIndex=function(){var r=this._private.cy,e=r._private.elements,n=this[0]._private.data.id;return e._private.map.get(n).index};$t.indexOf=function(r){var e=r[0]._private.data.id;return this._private.map.get(e).index};$t.indexOfId=function(r){return r=""+r,this._private.map.get(r).index};$t.json=function(r){var e=this.element(),n=this.cy();if(e==null&&r)return this;if(e!=null){var i=e._private;if(Dt(r)){if(n.startBatch(),r.data){e.data(r.data);var a=i.data;if(e.isEdge()){var s=!1,o={},l=r.data.source,c=r.data.target;l!=null&&l!=a.source&&(o.source=""+l,s=!0),c!=null&&c!=a.target&&(o.target=""+c,s=!0),s&&(e=e.move(o))}else{var u="parent"in r.data,h=r.data.parent;u&&(h!=null||a.parent!=null)&&h!=a.parent&&(h===void 0&&(h=null),h!=null&&(h=""+h),e=e.move({parent:h}))}}r.position&&e.position(r.position);var g=function(b,x,A){var C=r[b];C!=null&&C!==i[b]&&(C?e[x]():e[A]())};return g("removed","remove","restore"),g("selected","select","unselect"),g("selectable","selectify","unselectify"),g("locked","lock","unlock"),g("grabbable","grabify","ungrabify"),g("pannable","panify","unpanify"),r.classes!=null&&e.classes(r.classes),n.endBatch(),this}else if(r===void 0){var v={data:Hi(i.data),position:Hi(i.position),group:i.group,removed:i.removed,selected:i.selected,selectable:i.selectable,locked:i.locked,grabbable:i.grabbable,pannable:i.pannable,classes:null};v.classes="";var m=0;return i.classes.forEach(function(y){return v.classes+=m++===0?y:" "+y}),v}}};$t.jsons=function(){for(var r=[],e=0;e<this.length;e++){var n=this[e],i=n.json();r.push(i)}return r};$t.clone=function(){for(var r=this.cy(),e=[],n=0;n<this.length;n++){var i=this[n],a=i.json(),s=new C0(r,a,!1);e.push(s)}return new sn(r,e)};$t.copy=$t.clone;$t.restore=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,i=n.cy(),a=i._private,s=[],o=[],l,c=0,u=n.length;c<u;c++){var h=n[c];e&&!h.removed()||(h.isNode()?s.push(h):o.push(h))}l=s.concat(o);var g,v=function(){l.splice(g,1),g--};for(g=0;g<l.length;g++){var m=l[g],y=m._private,b=y.data;if(m.clearTraversalCache(),!(!e&&!y.removed)){if(b.id===void 0)b.id=AE();else if(Be(b.id))b.id=""+b.id;else if(Ms(b.id)||!We(b.id)){ur("Can not create element with invalid string ID `"+b.id+"`"),v();continue}else if(i.hasElementWithId(b.id)){ur("Can not create second element with ID `"+b.id+"`"),v();continue}}var x=b.id;if(m.isNode()){var A=y.position;A.x==null&&(A.x=0),A.y==null&&(A.y=0)}if(m.isEdge()){for(var C=m,E=["source","target"],S=E.length,M=!1,R=0;R<S;R++){var T=E[R],B=b[T];Be(B)&&(B=b[T]=""+b[T]),B==null||B===""?(ur("Can not create edge `"+x+"` with unspecified "+T),M=!0):i.hasElementWithId(B)||(ur("Can not create edge `"+x+"` with nonexistant "+T+" `"+B+"`"),M=!0)}if(M){v();continue}var F=i.getElementById(b.source),I=i.getElementById(b.target);F.same(I)?F._private.edges.push(C):(F._private.edges.push(C),I._private.edges.push(C)),C._private.source=F,C._private.target=I}y.map=new Sa,y.map.set(x,{ele:m,index:0}),y.removed=!1,e&&i.addToPool(m)}for(var U=0;U<s.length;U++){var k=s[U],O=k._private.data;Be(O.parent)&&(O.parent=""+O.parent);var V=O.parent,L=V!=null;if(L||k._private.parent){var P=k._private.parent?i.collection().merge(k._private.parent):i.getElementById(V);if(P.empty())O.parent=void 0;else if(P[0].removed())Pt("Node added with missing parent, reference to parent removed"),O.parent=void 0,k._private.parent=null;else{for(var _=!1,q=P;!q.empty();){if(k.same(q)){_=!0,O.parent=void 0;break}q=q.parent()}_||(P[0]._private.children.push(k),k._private.parent=P[0],a.hasCompoundNodes=!0)}}}if(l.length>0){for(var H=l.length===n.length?n:new sn(i,l),W=0;W<H.length;W++){var G=H[W];G.isNode()||(G.parallelEdges().clearTraversalCache(),G.source().clearTraversalCache(),G.target().clearTraversalCache())}var K;a.hasCompoundNodes?K=i.collection().merge(H).merge(H.connectedNodes()).merge(H.parent()):K=H,K.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(r),r?H.emitAndNotify("add"):e&&H.emit("add")}return n};$t.removed=function(){var r=this[0];return r&&r._private.removed};$t.inside=function(){var r=this[0];return r&&!r._private.removed};$t.remove=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,i=[],a={},s=n._private.cy;function o(V){for(var L=V._private.edges,P=0;P<L.length;P++)c(L[P])}function l(V){for(var L=V._private.children,P=0;P<L.length;P++)c(L[P])}function c(V){var L=a[V.id()];e&&V.removed()||L||(a[V.id()]=!0,V.isNode()?(i.push(V),o(V),l(V)):i.unshift(V))}for(var u=0,h=n.length;u<h;u++){var g=n[u];c(g)}function v(V,L){var P=V._private.edges;Ds(P,L),V.clearTraversalCache()}function m(V){V.clearTraversalCache()}var y=[];y.ids={};function b(V,L){L=L[0],V=V[0];var P=V._private.children,_=V.id();Ds(P,L),L._private.parent=null,y.ids[_]||(y.ids[_]=!0,y.push(V))}n.dirtyCompoundBoundsCache(),e&&s.removeFromPool(i);for(var x=0;x<i.length;x++){var A=i[x];if(A.isEdge()){var C=A.source()[0],E=A.target()[0];v(C,A),v(E,A);for(var S=A.parallelEdges(),M=0;M<S.length;M++){var R=S[M];m(R),R.isBundledBezier()&&R.dirtyBoundingBoxCache()}}else{var T=A.parent();T.length!==0&&b(T,A)}e&&(A._private.removed=!0)}var B=s._private.elements;s._private.hasCompoundNodes=!1;for(var F=0;F<B.length;F++){var I=B[F];if(I.isParent()){s._private.hasCompoundNodes=!0;break}}var U=new sn(this.cy(),i);U.size()>0&&(r?U.emitAndNotify("remove"):e&&U.emit("remove"));for(var k=0;k<y.length;k++){var O=y[k];(!e||!O.removed())&&O.updateStyle()}return U};$t.move=function(r){var e=this._private.cy,n=this,i=!1,a=!1,s=function(y){return y==null?y:""+y};if(r.source!==void 0||r.target!==void 0){var o=s(r.source),l=s(r.target),c=o!=null&&e.hasElementWithId(o),u=l!=null&&e.hasElementWithId(l);(c||u)&&(e.batch(function(){n.remove(i,a),n.emitAndNotify("moveout");for(var m=0;m<n.length;m++){var y=n[m],b=y._private.data;y.isEdge()&&(c&&(b.source=o),u&&(b.target=l))}n.restore(i,a)}),n.emitAndNotify("move"))}else if(r.parent!==void 0){var h=s(r.parent),g=h===null||e.hasElementWithId(h);if(g){var v=h===null?void 0:h;e.batch(function(){var m=n.remove(i,a);m.emitAndNotify("moveout");for(var y=0;y<n.length;y++){var b=n[y],x=b._private.data;b.isNode()&&(x.parent=v)}m.restore(i,a)}),n.emitAndNotify("move")}}return this};[IE,G7,Sd,Es,Yl,iI,B0,xI,rS,nS,SI,$d,Td,an,Ss,gn].forEach(function(r){et($t,r)});var NI={add:function(e){var n,i=this;if(Jn(e)){var a=e;if(a._private.cy===i)n=a.restore();else{for(var s=[],o=0;o<a.length;o++){var l=a[o];s.push(l.json())}n=new sn(i,s)}}else if(Qt(e)){var c=e;n=new sn(i,c)}else if(Dt(e)&&(Qt(e.nodes)||Qt(e.edges))){for(var u=e,h=[],g=["nodes","edges"],v=0,m=g.length;v<m;v++){var y=g[v],b=u[y];if(Qt(b))for(var x=0,A=b.length;x<A;x++){var C=et({group:y},b[x]);h.push(C)}}n=new sn(i,h)}else{var E=e;n=new C0(i,E).collection()}return n},remove:function(e){if(!Jn(e)){if(We(e)){var n=e;e=this.$(n)}}return e.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function FI(r,e,n,i){var a=4,s=.001,o=1e-7,l=10,c=11,u=1/(c-1),h=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var g=0;g<4;++g)if(typeof arguments[g]!="number"||isNaN(arguments[g])||!isFinite(arguments[g]))return!1;r=Math.min(r,1),n=Math.min(n,1),r=Math.max(r,0),n=Math.max(n,0);var v=h?new Float32Array(c):new Array(c);function m(I,U){return 1-3*U+3*I}function y(I,U){return 3*U-6*I}function b(I){return 3*I}function x(I,U,k){return((m(U,k)*I+y(U,k))*I+b(U))*I}function A(I,U,k){return 3*m(U,k)*I*I+2*y(U,k)*I+b(U)}function C(I,U){for(var k=0;k<a;++k){var O=A(U,r,n);if(O===0)return U;var V=x(U,r,n)-I;U-=V/O}return U}function E(){for(var I=0;I<c;++I)v[I]=x(I*u,r,n)}function S(I,U,k){var O,V,L=0;do V=U+(k-U)/2,O=x(V,r,n)-I,O>0?k=V:U=V;while(Math.abs(O)>o&&++L<l);return V}function M(I){for(var U=0,k=1,O=c-1;k!==O&&v[k]<=I;++k)U+=u;--k;var V=(I-v[k])/(v[k+1]-v[k]),L=U+V*u,P=A(L,r,n);return P>=s?C(I,L):P===0?L:S(I,U,U+u)}var R=!1;function T(){R=!0,(r!==e||n!==i)&&E()}var B=function(U){return R||T(),r===e&&n===i?U:U===0?0:U===1?1:x(M(U),e,i)};B.getControlPoints=function(){return[{x:r,y:e},{x:n,y:i}]};var F="generateBezier("+[r,e,n,i]+")";return B.toString=function(){return F},B}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var kI=(function(){function r(i){return-i.tension*i.x-i.friction*i.v}function e(i,a,s){var o={x:i.x+s.dx*a,v:i.v+s.dv*a,tension:i.tension,friction:i.friction};return{dx:o.v,dv:r(o)}}function n(i,a){var s={dx:i.v,dv:r(i)},o=e(i,a*.5,s),l=e(i,a*.5,o),c=e(i,a,l),u=1/6*(s.dx+2*(o.dx+l.dx)+c.dx),h=1/6*(s.dv+2*(o.dv+l.dv)+c.dv);return i.x=i.x+u*a,i.v=i.v+h*a,i}return function i(a,s,o){var l={x:-1,v:0,tension:null,friction:null},c=[0],u=0,h=1/1e4,g=16/1e3,v,m,y;for(a=parseFloat(a)||500,s=parseFloat(s)||20,o=o||null,l.tension=a,l.friction=s,v=o!==null,v?(u=i(a,s),m=u/o*g):m=g;y=n(y||l,m),c.push(1+y.x),u+=16,Math.abs(y.x)>h&&Math.abs(y.v)>h;);return v?function(b){return c[b*(c.length-1)|0]}:u}})(),Zt=function(e,n,i,a){var s=FI(e,n,i,a);return function(o,l,c){return o+(l-o)*s(c)}},Md={linear:function(e,n,i){return e+(n-e)*i},ease:Zt(.25,.1,.25,1),"ease-in":Zt(.42,0,1,1),"ease-out":Zt(0,0,.58,1),"ease-in-out":Zt(.42,0,.58,1),"ease-in-sine":Zt(.47,0,.745,.715),"ease-out-sine":Zt(.39,.575,.565,1),"ease-in-out-sine":Zt(.445,.05,.55,.95),"ease-in-quad":Zt(.55,.085,.68,.53),"ease-out-quad":Zt(.25,.46,.45,.94),"ease-in-out-quad":Zt(.455,.03,.515,.955),"ease-in-cubic":Zt(.55,.055,.675,.19),"ease-out-cubic":Zt(.215,.61,.355,1),"ease-in-out-cubic":Zt(.645,.045,.355,1),"ease-in-quart":Zt(.895,.03,.685,.22),"ease-out-quart":Zt(.165,.84,.44,1),"ease-in-out-quart":Zt(.77,0,.175,1),"ease-in-quint":Zt(.755,.05,.855,.06),"ease-out-quint":Zt(.23,1,.32,1),"ease-in-out-quint":Zt(.86,0,.07,1),"ease-in-expo":Zt(.95,.05,.795,.035),"ease-out-expo":Zt(.19,1,.22,1),"ease-in-out-expo":Zt(1,0,0,1),"ease-in-circ":Zt(.6,.04,.98,.335),"ease-out-circ":Zt(.075,.82,.165,1),"ease-in-out-circ":Zt(.785,.135,.15,.86),spring:function(e,n,i){if(i===0)return Md.linear;var a=kI(e,n,i);return function(s,o,l){return s+(o-s)*a(l)}},"cubic-bezier":Zt};function D3(r,e,n,i,a){if(i===1||e===n)return n;var s=a(e,n,i);return r==null||((r.roundValue||r.color)&&(s=Math.round(s)),r.min!==void 0&&(s=Math.max(s,r.min)),r.max!==void 0&&(s=Math.min(s,r.max))),s}function R3(r,e){return r.pfValue!=null||r.value!=null?r.pfValue!=null&&(e==null||e.type.units!=="%")?r.pfValue:r.value:r}function ml(r,e,n,i,a){var s=a!=null?a.type:null;n<0?n=0:n>1&&(n=1);var o=R3(r,a),l=R3(e,a);if(Be(o)&&Be(l))return D3(s,o,l,n,i);if(Qt(o)&&Qt(l)){for(var c=[],u=0;u<l.length;u++){var h=o[u],g=l[u];if(h!=null&&g!=null){var v=D3(s,h,g,n,i);c.push(v)}else c.push(g)}return c}}function UI(r,e,n,i){var a=!i,s=r._private,o=e._private,l=o.easing,c=o.startTime,u=i?r:r.cy(),h=u.style();if(!o.easingImpl)if(l==null)o.easingImpl=Md.linear;else{var g;if(We(l)){var v=h.parse("transition-timing-function",l);g=v.value}else g=l;var m,y;We(g)?(m=g,y=[]):(m=g[1],y=g.slice(2).map(function(H){return+H})),y.length>0?(m==="spring"&&y.push(o.duration),o.easingImpl=Md[m].apply(null,y)):o.easingImpl=Md[m]}var b=o.easingImpl,x;if(o.duration===0?x=1:x=(n-c)/o.duration,o.applying&&(x=o.progress),x<0?x=0:x>1&&(x=1),o.delay==null){var A=o.startPosition,C=o.position;if(C&&a&&!r.locked()){var E={};Xu(A.x,C.x)&&(E.x=ml(A.x,C.x,x,b)),Xu(A.y,C.y)&&(E.y=ml(A.y,C.y,x,b)),r.position(E)}var S=o.startPan,M=o.pan,R=s.pan,T=M!=null&&i;T&&(Xu(S.x,M.x)&&(R.x=ml(S.x,M.x,x,b)),Xu(S.y,M.y)&&(R.y=ml(S.y,M.y,x,b)),r.emit("pan"));var B=o.startZoom,F=o.zoom,I=F!=null&&i;I&&(Xu(B,F)&&(s.zoom=Lc(s.minZoom,ml(B,F,x,b),s.maxZoom)),r.emit("zoom")),(T||I)&&r.emit("viewport");var U=o.style;if(U&&U.length>0&&a){for(var k=0;k<U.length;k++){var O=U[k],V=O.name,L=O,P=o.startStyle[V],_=h.properties[P.name],q=ml(P,L,x,b,_);h.overrideBypass(r,V,q)}r.emit("style")}}return o.progress=x,x}function Xu(r,e){return r==null||e==null?!1:Be(r)&&Be(e)?!0:!!(r&&e)}function VI(r,e,n,i){var a=e._private;a.started=!0,a.startTime=n-a.progress*a.duration}function B3(r,e){var n=e._private.aniEles,i=[];function a(h,g){var v=h._private,m=v.animation.current,y=v.animation.queue,b=!1;if(m.length===0){var x=y.shift();x&&m.push(x)}for(var A=function(R){for(var T=R.length-1;T>=0;T--){var B=R[T];B()}R.splice(0,R.length)},C=m.length-1;C>=0;C--){var E=m[C],S=E._private;if(S.stopped){m.splice(C,1),S.hooked=!1,S.playing=!1,S.started=!1,A(S.frames);continue}!S.playing&&!S.applying||(S.playing&&S.applying&&(S.applying=!1),S.started||VI(h,E,r),UI(h,E,r,g),S.applying&&(S.applying=!1),A(S.frames),S.step!=null&&S.step(r),E.completed()&&(m.splice(C,1),S.hooked=!1,S.playing=!1,S.started=!1,A(S.completes)),b=!0)}return!g&&m.length===0&&y.length===0&&i.push(h),b}for(var s=!1,o=0;o<n.length;o++){var l=n[o],c=a(l);s=s||c}var u=a(e,!0);(s||u)&&(n.length>0?e.notify("draw",n):e.notify("draw")),n.unmerge(i),e.emit("step")}var OI={animate:Ot.animate(),animation:Ot.animation(),animated:Ot.animated(),clearQueue:Ot.clearQueue(),delay:Ot.delay(),delayAnimation:Ot.delayAnimation(),stop:Ot.stop(),addToAnimationPool:function(e){var n=this;n.styleEnabled()&&n._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function n(){e._private.animationsRunning&&Xd(function(s){B3(s,e),n()})}var i=e.renderer();i&&i.beforeRender?i.beforeRender(function(s,o){B3(o,e)},i.beforeRenderPriorities.animations):n()}},PI={qualifierCompare:function(e,n){return e==null||n==null?e==null&&n==null:e.sameText(n)},eventMatches:function(e,n,i){var a=n.qualifier;return a!=null?e!==i.target&&rf(i.target)&&a.matches(i.target):!0},addEventFields:function(e,n){n.cy=e,n.target=e},callbackContext:function(e,n,i){return n.qualifier!=null?i.target:e}},Xh=function(e){return We(e)?new Bs(e):e},sS={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new I0(PI,this)),this},emitter:function(){return this._private.emitter},on:function(e,n,i){return this.emitter().on(e,Xh(n),i),this},removeListener:function(e,n,i){return this.emitter().removeListener(e,Xh(n),i),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,n,i){return this.emitter().one(e,Xh(n),i),this},once:function(e,n,i){return this.emitter().one(e,Xh(n),i),this},emit:function(e,n){return this.emitter().emit(e,n),this},emitAndNotify:function(e,n){return this.emit(e),this.notify(e,n),this}};Ot.eventAliasesOn(sS);var Bp={png:function(e){var n=this._private.renderer;return e=e||{},n.png(e)},jpg:function(e){var n=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",n.jpg(e)}};Bp.jpeg=Bp.jpg;var Dd={layout:function(e){var n=this;if(e==null){ur("Layout options must be specified to make a layout");return}if(e.name==null){ur("A `name` must be specified to make a layout");return}var i=e.name,a=n.extension("layout",i);if(a==null){ur("No such layout `"+i+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var s;We(e.eles)?s=n.$(e.eles):s=e.eles!=null?e.eles:n.$();var o=new a(et({},e,{cy:n,eles:s}));return o}};Dd.createLayout=Dd.makeLayout=Dd.layout;var LI={notify:function(e,n){var i=this._private;if(this.batching()){i.batchNotifications=i.batchNotifications||{};var a=i.batchNotifications[e]=i.batchNotifications[e]||this.collection();n!=null&&a.merge(n);return}if(i.notificationsEnabled){var s=this.renderer();this.destroyed()||!s||s.notify(e,n)}},notifications:function(e){var n=this._private;return e===void 0?n.notificationsEnabled:(n.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var n=this.renderer();Object.keys(e.batchNotifications).forEach(function(i){var a=e.batchNotifications[i];a.empty()?n.notify(i):n.notify(i,a)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var n=this;return this.batch(function(){for(var i=Object.keys(e),a=0;a<i.length;a++){var s=i[a],o=e[s],l=n.getElementById(s);l.data(o)}})}},_I=on({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),Ip={renderTo:function(e,n,i,a){var s=this._private.renderer;return s.renderTo(e,n,i,a),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var n=this,i=n.extension("renderer",e.name);if(i==null){ur("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&Pt("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var a=_I(e);a.cy=n,n._private.renderer=new i(a),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var n=e.container();if(n)for(n._cyreg=null;n.childNodes.length>0;)n.removeChild(n.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(i){var a=i._private;a.rscratch={},a.rstyle={},a.animation.current=[],a.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};Ip.invalidateDimensions=Ip.resize;var Rd={collection:function(e,n){return We(e)?this.$(e):Jn(e)?e.collection():Qt(e)?(n||(n={}),new sn(this,e,n.unique,n.removed)):new sn(this)},nodes:function(e){var n=this.$(function(i){return i.isNode()});return e?n.filter(e):n},edges:function(e){var n=this.$(function(i){return i.isEdge()});return e?n.filter(e):n},$:function(e){var n=this._private.elements;return e?n.filter(e):n.spawnSelf()},mutableElements:function(){return this._private.elements}};Rd.elements=Rd.filter=Rd.$;var Wr={},Tc="t",zI="f";Wr.apply=function(r){for(var e=this,n=e._private,i=n.cy,a=i.collection(),s=0;s<r.length;s++){var o=r[s],l=e.getContextMeta(o);if(!l.empty){var c=e.getContextStyle(l),u=e.applyContextStyle(l,c,o);o._private.appliedInitStyle?e.updateTransitions(o,u.diffProps):o._private.appliedInitStyle=!0;var h=e.updateStyleHints(o);h&&a.push(o)}}return a};Wr.getPropertiesDiff=function(r,e){var n=this,i=n._private.propDiffs=n._private.propDiffs||{},a=r+"-"+e,s=i[a];if(s)return s;for(var o=[],l={},c=0;c<n.length;c++){var u=n[c],h=r[c]===Tc,g=e[c]===Tc,v=h!==g,m=u.mappedProperties.length>0;if(v||g&&m){var y=void 0;v&&m||v?y=u.properties:m&&(y=u.mappedProperties);for(var b=0;b<y.length;b++){for(var x=y[b],A=x.name,C=!1,E=c+1;E<n.length;E++){var S=n[E],M=e[E]===Tc;if(M&&(C=S.properties[x.name]!=null,C))break}!l[A]&&!C&&(l[A]=!0,o.push(A))}}}return i[a]=o,o};Wr.getContextMeta=function(r){for(var e=this,n="",i,a=r._private.styleCxtKey||"",s=0;s<e.length;s++){var o=e[s],l=o.selector&&o.selector.matches(r);l?n+=Tc:n+=zI}return i=e.getPropertiesDiff(a,n),r._private.styleCxtKey=n,{key:n,diffPropNames:i,empty:i.length===0}};Wr.getContextStyle=function(r){var e=r.key,n=this,i=this._private.contextStyles=this._private.contextStyles||{};if(i[e])return i[e];for(var a={_private:{key:e}},s=0;s<n.length;s++){var o=n[s],l=e[s]===Tc;if(l)for(var c=0;c<o.properties.length;c++){var u=o.properties[c];a[u.name]=u}}return i[e]=a,a};Wr.applyContextStyle=function(r,e,n){for(var i=this,a=r.diffPropNames,s={},o=i.types,l=0;l<a.length;l++){var c=a[l],u=e[c],h=n.pstyle(c);if(!u)if(h)h.bypass?u={name:c,deleteBypassed:!0}:u={name:c,delete:!0};else continue;if(h!==u){if(u.mapped===o.fn&&h!=null&&h.mapping!=null&&h.mapping.value===u.value){var g=h.mapping,v=g.fnValue=u.value(n);if(v===g.prevFnValue)continue}var m=s[c]={prev:h};i.applyParsedProperty(n,u),m.next=n.pstyle(c),m.next&&m.next.bypass&&(m.next=m.next.bypassed)}}return{diffProps:s}};Wr.updateStyleHints=function(r){var e=r._private,n=this,i=n.propertyGroupNames,a=n.propertyGroupKeys,s=function(fe,xe,De){return n.getPropertiesHash(fe,xe,De)},o=e.styleKey;if(r.removed())return!1;var l=e.group==="nodes",c=r._private.style;i=Object.keys(c);for(var u=0;u<a.length;u++){var h=a[u];e.styleKeys[h]=[uo,Dl]}for(var g=function(fe,xe){return e.styleKeys[xe][0]=Vc(fe,e.styleKeys[xe][0])},v=function(fe,xe){return e.styleKeys[xe][1]=Oc(fe,e.styleKeys[xe][1])},m=function(fe,xe){g(fe,xe),v(fe,xe)},y=function(fe,xe){for(var De=0;De<fe.length;De++){var ze=fe.charCodeAt(De);g(ze,xe),v(ze,xe)}},b=2e9,x=function(fe){return-128<fe&&fe<128&&Math.floor(fe)!==fe?b-(fe*1024|0):fe},A=0;A<i.length;A++){var C=i[A],E=c[C];if(E!=null){var S=this.properties[C],M=S.type,R=S.groupKey,T=void 0;S.hashOverride!=null?T=S.hashOverride(r,E):E.pfValue!=null&&(T=E.pfValue);var B=S.enums==null?E.value:null,F=T!=null,I=B!=null,U=F||I,k=E.units;if(M.number&&U&&!M.multiple){var O=F?T:B;m(x(O),R),!F&&k!=null&&y(k,R)}else y(E.strValue,R)}}for(var V=[uo,Dl],L=0;L<a.length;L++){var P=a[L],_=e.styleKeys[P];V[0]=Vc(_[0],V[0]),V[1]=Oc(_[1],V[1])}e.styleKey=nR(V[0],V[1]);var q=e.styleKeys;e.labelDimsKey=ls(q.labelDimensions);var H=s(r,["label"],q.labelDimensions);if(e.labelKey=ls(H),e.labelStyleKey=ls(_h(q.commonLabel,H)),!l){var W=s(r,["source-label"],q.labelDimensions);e.sourceLabelKey=ls(W),e.sourceLabelStyleKey=ls(_h(q.commonLabel,W));var G=s(r,["target-label"],q.labelDimensions);e.targetLabelKey=ls(G),e.targetLabelStyleKey=ls(_h(q.commonLabel,G))}if(l){var K=e.styleKeys,$=K.nodeBody,te=K.nodeBorder,ae=K.nodeOutline,ue=K.backgroundImage,re=K.compound,ve=K.pie,le=K.stripe,ie=[$,te,ae,ue,re,ve,le].filter(function(se){return se!=null}).reduce(_h,[uo,Dl]);e.nodeKey=ls(ie),e.hasPie=ve!=null&&ve[0]!==uo&&ve[1]!==Dl,e.hasStripe=le!=null&&le[0]!==uo&&le[1]!==Dl}return o!==e.styleKey};Wr.clearStyleHints=function(r){var e=r._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null,e.hasStripe=null};Wr.applyParsedProperty=function(r,e){var n=this,i=e,a=r._private.style,s,o=n.types,l=n.properties[i.name].type,c=i.bypass,u=a[i.name],h=u&&u.bypass,g=r._private,v="mapping",m=function($){return $==null?null:$.pfValue!=null?$.pfValue:$.value},y=function(){var $=m(u),te=m(i);n.checkTriggers(r,i.name,$,te)};if(e.name==="curve-style"&&r.isEdge()&&(e.value!=="bezier"&&r.isLoop()||e.value==="haystack"&&(r.source().isParent()||r.target().isParent()))&&(i=e=this.parse(e.name,"bezier",c)),i.delete)return a[i.name]=void 0,y(),!0;if(i.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,y(),!0):!1:(y(),!0);if(i.deleteBypass)return u?u.bypass?(a[i.name]=u.bypassed,y(),!0):!1:(y(),!0);var b=function(){Pt("Do not assign mappings to elements without corresponding data (i.e. ele `"+r.id()+"` has no mapping for property `"+i.name+"` with data field `"+i.field+"`); try a `["+i.field+"]` selector to limit scope to elements with `"+i.field+"` defined")};switch(i.mapped){case o.mapData:{for(var x=i.field.split("."),A=g.data,C=0;C<x.length&&A;C++){var E=x[C];A=A[E]}if(A==null)return b(),!1;var S;if(Be(A)){var M=i.fieldMax-i.fieldMin;M===0?S=0:S=(A-i.fieldMin)/M}else return Pt("Do not use continuous mappers without specifying numeric data (i.e. `"+i.field+": "+A+"` for `"+r.id()+"` is non-numeric)"),!1;if(S<0?S=0:S>1&&(S=1),l.color){var R=i.valueMin[0],T=i.valueMax[0],B=i.valueMin[1],F=i.valueMax[1],I=i.valueMin[2],U=i.valueMax[2],k=i.valueMin[3]==null?1:i.valueMin[3],O=i.valueMax[3]==null?1:i.valueMax[3],V=[Math.round(R+(T-R)*S),Math.round(B+(F-B)*S),Math.round(I+(U-I)*S),Math.round(k+(O-k)*S)];s={bypass:i.bypass,name:i.name,value:V,strValue:"rgb("+V[0]+", "+V[1]+", "+V[2]+")"}}else if(l.number){var L=i.valueMin+(i.valueMax-i.valueMin)*S;s=this.parse(i.name,L,i.bypass,v)}else return!1;if(!s)return b(),!1;s.mapping=i,i=s;break}case o.data:{for(var P=i.field.split("."),_=g.data,q=0;q<P.length&&_;q++){var H=P[q];_=_[H]}if(_!=null&&(s=this.parse(i.name,_,i.bypass,v)),!s)return b(),!1;s.mapping=i,i=s;break}case o.fn:{var W=i.value,G=i.fnValue!=null?i.fnValue:W(r);if(i.prevFnValue=G,G==null)return Pt("Custom function mappers may not return null (i.e. `"+i.name+"` for ele `"+r.id()+"` is null)"),!1;if(s=this.parse(i.name,G,i.bypass,v),!s)return Pt("Custom function mappers may not return invalid values for the property type (i.e. `"+i.name+"` for ele `"+r.id()+"` is invalid)"),!1;s.mapping=Hi(i),i=s;break}case void 0:break;default:return!1}return c?(h?i.bypassed=u.bypassed:i.bypassed=u,a[i.name]=i):h?u.bypassed=i:a[i.name]=i,y(),!0};Wr.cleanElements=function(r,e){for(var n=0;n<r.length;n++){var i=r[n];if(this.clearStyleHints(i),i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),!e)i._private.style={};else for(var a=i._private.style,s=Object.keys(a),o=0;o<s.length;o++){var l=s[o],c=a[l];c!=null&&(c.bypass?c.bypassed=null:a[l]=null)}}};Wr.update=function(){var r=this._private.cy,e=r.mutableElements();e.updateStyle()};Wr.updateTransitions=function(r,e){var n=this,i=r._private,a=r.pstyle("transition-property").value,s=r.pstyle("transition-duration").pfValue,o=r.pstyle("transition-delay").pfValue;if(a.length>0&&s>0){for(var l={},c=!1,u=0;u<a.length;u++){var h=a[u],g=r.pstyle(h),v=e[h];if(v){var m=v.prev,y=m,b=v.next!=null?v.next:g,x=!1,A=void 0,C=1e-6;y&&(Be(y.pfValue)&&Be(b.pfValue)?(x=b.pfValue-y.pfValue,A=y.pfValue+C*x):Be(y.value)&&Be(b.value)?(x=b.value-y.value,A=y.value+C*x):Qt(y.value)&&Qt(b.value)&&(x=y.value[0]!==b.value[0]||y.value[1]!==b.value[1]||y.value[2]!==b.value[2],A=y.strValue),x&&(l[h]=b.strValue,this.applyBypass(r,h,A),c=!0))}}if(!c)return;i.transitioning=!0,new Ql(function(E){o>0?r.delayAnimation(o).play().promise().then(E):E()}).then(function(){return r.animation({style:l,duration:s,easing:r.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){n.removeBypasses(r,a),r.emitAndNotify("style"),i.transitioning=!1})}else i.transitioning&&(this.removeBypasses(r,a),r.emitAndNotify("style"),i.transitioning=!1)};Wr.checkTrigger=function(r,e,n,i,a,s){var o=this.properties[e],l=a(o);r.removed()||l!=null&&l(n,i,r)&&s(o)};Wr.checkZOrderTrigger=function(r,e,n,i){var a=this;this.checkTrigger(r,e,n,i,function(s){return s.triggersZOrder},function(){a._private.cy.notify("zorder",r)})};Wr.checkBoundsTrigger=function(r,e,n,i){this.checkTrigger(r,e,n,i,function(a){return a.triggersBounds},function(a){r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache()})};Wr.checkConnectedEdgesBoundsTrigger=function(r,e,n,i){this.checkTrigger(r,e,n,i,function(a){return a.triggersBoundsOfConnectedEdges},function(a){r.connectedEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};Wr.checkParallelEdgesBoundsTrigger=function(r,e,n,i){this.checkTrigger(r,e,n,i,function(a){return a.triggersBoundsOfParallelEdges},function(a){r.parallelEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};Wr.checkTriggers=function(r,e,n,i){r.dirtyStyleCache(),this.checkZOrderTrigger(r,e,n,i),this.checkBoundsTrigger(r,e,n,i),this.checkConnectedEdgesBoundsTrigger(r,e,n,i),this.checkParallelEdgesBoundsTrigger(r,e,n,i)};var cf={};cf.applyBypass=function(r,e,n,i){var a=this,s=[],o=!0;if(e==="*"||e==="**"){if(n!==void 0)for(var l=0;l<a.properties.length;l++){var c=a.properties[l],u=c.name,h=this.parse(u,n,!0);h&&s.push(h)}}else if(We(e)){var g=this.parse(e,n,!0);g&&s.push(g)}else if(Dt(e)){var v=e;i=n;for(var m=Object.keys(v),y=0;y<m.length;y++){var b=m[y],x=v[b];if(x===void 0&&(x=v[b0(b)]),x!==void 0){var A=this.parse(b,x,!0);A&&s.push(A)}}}else return!1;if(s.length===0)return!1;for(var C=!1,E=0;E<r.length;E++){for(var S=r[E],M={},R=void 0,T=0;T<s.length;T++){var B=s[T];if(i){var F=S.pstyle(B.name);R=M[B.name]={prev:F}}C=this.applyParsedProperty(S,Hi(B))||C,i&&(R.next=S.pstyle(B.name))}C&&this.updateStyleHints(S),i&&this.updateTransitions(S,M,o)}return C};cf.overrideBypass=function(r,e,n){e=x2(e);for(var i=0;i<r.length;i++){var a=r[i],s=a._private.style[e],o=this.properties[e].type,l=o.color,c=o.mutiple,u=s?s.pfValue!=null?s.pfValue:s.value:null;!s||!s.bypass?this.applyBypass(a,e,n):(s.value=n,s.pfValue!=null&&(s.pfValue=n),l?s.strValue="rgb("+n.join(",")+")":c?s.strValue=n.join(" "):s.strValue=""+n,this.updateStyleHints(a)),this.checkTriggers(a,e,u,n)}};cf.removeAllBypasses=function(r,e){return this.removeBypasses(r,this.propertyNames,e)};cf.removeBypasses=function(r,e,n){for(var i=!0,a=0;a<r.length;a++){for(var s=r[a],o={},l=0;l<e.length;l++){var c=e[l],u=this.properties[c],h=s.pstyle(u.name);if(!(!h||!h.bypass)){var g="",v=this.parse(c,g,!0),m=o[u.name]={prev:h};this.applyParsedProperty(s,v),m.next=s.pstyle(u.name)}}this.updateStyleHints(s),n&&this.updateTransitions(s,o,i)}};var U2={};U2.getEmSizeInPixels=function(){var r=this.containerCss("font-size");return r!=null?parseFloat(r):1};U2.containerCss=function(r){var e=this._private.cy,n=e.container(),i=e.window();if(i&&n&&i.getComputedStyle)return i.getComputedStyle(n).getPropertyValue(r)};var Zi={};Zi.getRenderedStyle=function(r,e){return e?this.getStylePropertyValue(r,e,!0):this.getRawStyle(r,!0)};Zi.getRawStyle=function(r,e){var n=this;if(r=r[0],r){for(var i={},a=0;a<n.properties.length;a++){var s=n.properties[a],o=n.getStylePropertyValue(r,s.name,e);o!=null&&(i[s.name]=o,i[b0(s.name)]=o)}return i}};Zi.getIndexedStyle=function(r,e,n,i){var a=r.pstyle(e)[n][i];return a??r.cy().style().getDefaultProperty(e)[n][0]};Zi.getStylePropertyValue=function(r,e,n){var i=this;if(r=r[0],r){var a=i.properties[e];a.alias&&(a=a.pointsTo);var s=a.type,o=r.pstyle(a.name);if(o){var l=o.value,c=o.units,u=o.strValue;if(n&&s.number&&l!=null&&Be(l)){var h=r.cy().zoom(),g=function(x){return x*h},v=function(x,A){return g(x)+A},m=Qt(l),y=m?c.every(function(b){return b!=null}):c!=null;return y?m?l.map(function(b,x){return v(b,c[x])}).join(" "):v(l,c):m?l.map(function(b){return We(b)?b:""+g(b)}).join(" "):""+g(l)}else if(u!=null)return u}return null}};Zi.getAnimationStartStyle=function(r,e){for(var n={},i=0;i<e.length;i++){var a=e[i],s=a.name,o=r.pstyle(s);o!==void 0&&(Dt(o)?o=this.parse(s,o.strValue):o=this.parse(s,o)),o&&(n[s]=o)}return n};Zi.getPropsList=function(r){var e=this,n=[],i=r,a=e.properties;if(i)for(var s=Object.keys(i),o=0;o<s.length;o++){var l=s[o],c=i[l],u=a[l]||a[x2(l)],h=this.parse(u.name,c);h&&n.push(h)}return n};Zi.getNonDefaultPropertiesHash=function(r,e,n){var i=n.slice(),a,s,o,l,c,u;for(c=0;c<e.length;c++)if(a=e[c],s=r.pstyle(a,!1),s!=null)if(s.pfValue!=null)i[0]=Vc(l,i[0]),i[1]=Oc(l,i[1]);else for(o=s.strValue,u=0;u<o.length;u++)l=o.charCodeAt(u),i[0]=Vc(l,i[0]),i[1]=Oc(l,i[1]);return i};Zi.getPropertiesHash=Zi.getNonDefaultPropertiesHash;var k0={};k0.appendFromJson=function(r){for(var e=this,n=0;n<r.length;n++){var i=r[n],a=i.selector,s=i.style||i.css,o=Object.keys(s);e.selector(a);for(var l=0;l<o.length;l++){var c=o[l],u=s[c];e.css(c,u)}}return e};k0.fromJson=function(r){var e=this;return e.resetToDefault(),e.appendFromJson(r),e};k0.json=function(){for(var r=[],e=this.defaultLength;e<this.length;e++){for(var n=this[e],i=n.selector,a=n.properties,s={},o=0;o<a.length;o++){var l=a[o];s[l.name]=l.strValue}r.push({selector:i?i.toString():"core",style:s})}return r};var V2={};V2.appendFromString=function(r){var e=this,n=this,i=""+r,a,s,o;i=i.replace(/[/][*](\s|.)+?[*][/]/g,"");function l(){i.length>a.length?i=i.substr(a.length):i=""}function c(){s.length>o.length?s=s.substr(o.length):s=""}for(;;){var u=i.match(/^\s*$/);if(u)break;var h=i.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!h){Pt("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+i);break}a=h[0];var g=h[1];if(g!=="core"){var v=new Bs(g);if(v.invalid){Pt("Skipping parsing of block: Invalid selector found in string stylesheet: "+g),l();continue}}var m=h[2],y=!1;s=m;for(var b=[];;){var x=s.match(/^\s*$/);if(x)break;var A=s.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!A){Pt("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+m),y=!0;break}o=A[0];var C=A[1],E=A[2],S=e.properties[C];if(!S){Pt("Skipping property: Invalid property name in: "+o),c();continue}var M=n.parse(C,E);if(!M){Pt("Skipping property: Invalid property definition in: "+o),c();continue}b.push({name:C,val:E}),c()}if(y){l();break}n.selector(g);for(var R=0;R<b.length;R++){var T=b[R];n.css(T.name,T.val)}l()}return n};V2.fromString=function(r){var e=this;return e.resetToDefault(),e.appendFromString(r),e};var Br={};(function(){var r=Ur,e=U8,n=O8,i=P8,a=L8,s=function(se){return"^"+se+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(se){var fe=r+"|\\w+|"+e+"|"+n+"|"+i+"|"+a;return"^"+se+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+r+")\\s*\\,\\s*("+r+")\\s*,\\s*("+fe+")\\s*\\,\\s*("+fe+")\\)$"},l=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Br.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:s("data")},layoutData:{mapping:!0,regex:s("layoutData")},scratch:{mapping:!0,regex:s("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:l,singleRegexMatchValue:!0},urls:{regexes:l,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(se,fe){switch(se.length){case 2:return fe[0]!=="deg"&&fe[0]!=="rad"&&fe[1]!=="deg"&&fe[1]!=="rad";case 1:return We(se[0])||fe[0]==="deg"||fe[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(se){var fe=se.length;return fe===1||fe===2||fe===4}}};var c={zeroNonZero:function(se,fe){return(se==null||fe==null)&&se!==fe||se==0&&fe!=0?!0:se!=0&&fe==0},any:function(se,fe){return se!=fe},emptyNonEmpty:function(se,fe){var xe=Ms(se),De=Ms(fe);return xe&&!De||!xe&&De}},u=Br.types,h=[{name:"label",type:u.text,triggersBounds:c.any,triggersZOrder:c.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:c.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:c.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:c.any}],g=[{name:"source-label",type:u.text,triggersBounds:c.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:c.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:c.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:c.any},{name:"source-text-offset",type:u.size,triggersBounds:c.any}],v=[{name:"target-label",type:u.text,triggersBounds:c.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:c.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:c.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:c.any},{name:"target-text-offset",type:u.size,triggersBounds:c.any}],m=[{name:"font-family",type:u.fontFamily,triggersBounds:c.any},{name:"font-style",type:u.fontStyle,triggersBounds:c.any},{name:"font-weight",type:u.fontWeight,triggersBounds:c.any},{name:"font-size",type:u.size,triggersBounds:c.any},{name:"text-transform",type:u.textTransform,triggersBounds:c.any},{name:"text-wrap",type:u.textWrap,triggersBounds:c.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:c.any},{name:"text-max-width",type:u.size,triggersBounds:c.any},{name:"text-outline-width",type:u.size,triggersBounds:c.any},{name:"line-height",type:u.positiveNumber,triggersBounds:c.any}],y=[{name:"text-valign",type:u.valign,triggersBounds:c.any},{name:"text-halign",type:u.halign,triggersBounds:c.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:c.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:c.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:c.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:c.any},{name:"text-justification",type:u.justification},{name:"box-select-labels",type:u.bool,triggersBounds:c.any}],b=[{name:"events",type:u.bool,triggersZOrder:c.any},{name:"text-events",type:u.bool,triggersZOrder:c.any},{name:"box-selection",type:u.boxSelection,triggersZOrder:c.any}],x=[{name:"display",type:u.display,triggersZOrder:c.any,triggersBounds:c.any,triggersBoundsOfConnectedEdges:c.any,triggersBoundsOfParallelEdges:function(se,fe,xe){return se===fe?!1:xe.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:u.visibility,triggersZOrder:c.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:c.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:c.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:c.any},{name:"z-index",type:u.number,triggersZOrder:c.any}],A=[{name:"overlay-padding",type:u.size,triggersBounds:c.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:c.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:c.any},{name:"overlay-corner-radius",type:u.cornerRadius}],C=[{name:"underlay-padding",type:u.size,triggersBounds:c.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:c.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:c.any},{name:"underlay-corner-radius",type:u.cornerRadius}],E=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],S=function(se,fe){return fe.value==="label"?-se.poolIndex():fe.pfValue},M=[{name:"height",type:u.nodeSize,triggersBounds:c.any,hashOverride:S},{name:"width",type:u.nodeSize,triggersBounds:c.any,hashOverride:S},{name:"shape",type:u.nodeShape,triggersBounds:c.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:c.any},{name:"corner-radius",type:u.cornerRadius},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:c.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:c.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:c.any}],R=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:c.any},{name:"border-style",type:u.borderStyle},{name:"border-cap",type:u.lineCap},{name:"border-join",type:u.lineJoin},{name:"border-dash-pattern",type:u.numbers},{name:"border-dash-offset",type:u.number},{name:"border-position",type:u.linePosition}],T=[{name:"outline-color",type:u.color},{name:"outline-opacity",type:u.zeroOneNumber},{name:"outline-width",type:u.size,triggersBounds:c.any},{name:"outline-style",type:u.borderStyle},{name:"outline-offset",type:u.size,triggersBounds:c.any}],B=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],F=[{name:"position",type:u.position,triggersBounds:c.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:c.any},{name:"min-width",type:u.size,triggersBounds:c.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:c.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:c.any},{name:"min-height",type:u.size,triggersBounds:c.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:c.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:c.any}],I=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-outline-width",type:u.size},{name:"line-outline-color",type:u.color},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:c.any,triggersBoundsOfParallelEdges:function(se,fe){return se===fe?!1:se==="bezier"||fe==="bezier"}},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:c.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:c.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:c.any},{name:"control-point-step-size",type:u.size,triggersBounds:c.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:c.any},{name:"control-point-weights",type:u.numbers,triggersBounds:c.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:c.any},{name:"segment-weights",type:u.numbers,triggersBounds:c.any},{name:"segment-radii",type:u.numbers,triggersBounds:c.any},{name:"radius-type",type:u.radiusType,triggersBounds:c.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:c.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:c.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:c.any},{name:"taxi-radius",type:u.number,triggersBounds:c.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:c.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:c.any},{name:"loop-direction",type:u.angle,triggersBounds:c.any},{name:"loop-sweep",type:u.angle,triggersBounds:c.any},{name:"source-distance-from-node",type:u.size,triggersBounds:c.any},{name:"target-distance-from-node",type:u.size,triggersBounds:c.any}],U=[{name:"ghost",type:u.bool,triggersBounds:c.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:c.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:c.any},{name:"ghost-opacity",type:u.zeroOneNumber}],k=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],O=[];Br.pieBackgroundN=16,O.push({name:"pie-size",type:u.sizeMaybePercent}),O.push({name:"pie-hole",type:u.sizeMaybePercent}),O.push({name:"pie-start-angle",type:u.angle});for(var V=1;V<=Br.pieBackgroundN;V++)O.push({name:"pie-"+V+"-background-color",type:u.color}),O.push({name:"pie-"+V+"-background-size",type:u.percent}),O.push({name:"pie-"+V+"-background-opacity",type:u.zeroOneNumber});var L=[];Br.stripeBackgroundN=16,L.push({name:"stripe-size",type:u.sizeMaybePercent}),L.push({name:"stripe-direction",type:u.axisDirectionPrimary});for(var P=1;P<=Br.stripeBackgroundN;P++)L.push({name:"stripe-"+P+"-background-color",type:u.color}),L.push({name:"stripe-"+P+"-background-size",type:u.percent}),L.push({name:"stripe-"+P+"-background-opacity",type:u.zeroOneNumber});var _=[],q=Br.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:c.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill},{name:"arrow-width",type:u.arrowWidth}].forEach(function(ie){q.forEach(function(se){var fe=se+"-"+ie.name,xe=ie.type,De=ie.triggersBounds;_.push({name:fe,type:xe,triggersBounds:De})})},{});var H=Br.properties=[].concat(b,E,x,A,C,U,y,m,h,g,v,M,R,T,B,O,L,F,I,_,k),W=Br.propertyGroups={behavior:b,transition:E,visibility:x,overlay:A,underlay:C,ghost:U,commonLabel:y,labelDimensions:m,mainLabel:h,sourceLabel:g,targetLabel:v,nodeBody:M,nodeBorder:R,nodeOutline:T,backgroundImage:B,pie:O,stripe:L,compound:F,edgeLine:I,edgeArrow:_,core:k},G=Br.propertyGroupNames={},K=Br.propertyGroupKeys=Object.keys(W);K.forEach(function(ie){G[ie]=W[ie].map(function(se){return se.name}),W[ie].forEach(function(se){return se.groupKey=ie})});var $=Br.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Br.propertyNames=H.map(function(ie){return ie.name});for(var te=0;te<H.length;te++){var ae=H[te];H[ae.name]=ae}for(var ue=0;ue<$.length;ue++){var re=$[ue],ve=H[re.pointsTo],le={name:re.name,alias:!0,pointsTo:ve};H.push(le),H[re.name]=le}})();Br.getDefaultProperty=function(r){return this.getDefaultProperties()[r]};Br.getDefaultProperties=function(){var r=this._private;if(r.defaultProperties!=null)return r.defaultProperties;for(var e=et({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(c,u){for(var h=1;h<=Br.pieBackgroundN;h++){var g=u.name.replace("{{i}}",h),v=u.value;c[g]=v}return c},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(c,u){for(var h=1;h<=Br.stripeBackgroundN;h++){var g=u.name.replace("{{i}}",h),v=u.value;c[g]=v}return c},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(c,u){return Br.arrowPrefixes.forEach(function(h){var g=h+"-"+u.name,v=u.value;c[g]=v}),c},{})),n={},i=0;i<this.properties.length;i++){var a=this.properties[i];if(!a.pointsTo){var s=a.name,o=e[s],l=this.parse(s,o);n[s]=l}}return r.defaultProperties=n,r.defaultProperties};Br.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var U0={};U0.parse=function(r,e,n,i){var a=this;if(gr(e))return a.parseImplWarn(r,e,n,i);var s=i==="mapping"||i===!0||i===!1||i==null?"dontcare":i,o=n?"t":"f",l=""+e,c=mE(r,l,o,s),u=a.propCache=a.propCache||[],h;return(h=u[c])||(h=u[c]=a.parseImplWarn(r,e,n,i)),(n||i==="mapping")&&(h=Hi(h),h&&(h.value=Hi(h.value))),h};U0.parseImplWarn=function(r,e,n,i){var a=this.parseImpl(r,e,n,i);return!a&&e!=null&&Pt("The style property `".concat(r,": ").concat(e,"` is invalid")),a&&(a.name==="width"||a.name==="height")&&e==="label"&&Pt("The style value of `label` is deprecated for `"+a.name+"`"),a};U0.parseImpl=function(r,e,n,i){var a=this;r=x2(r);var s=a.properties[r],o=e,l=a.types;if(!s||e===void 0)return null;s.alias&&(s=s.pointsTo,r=s.name);var c=We(e);c&&(e=e.trim());var u=s.type;if(!u)return null;if(n&&(e===""||e===null))return{name:r,value:e,bypass:!0,deleteBypass:!0};if(gr(e))return{name:r,value:e,strValue:"fn",mapped:l.fn,bypass:n};var h,g;if(!(!c||i||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(h=new RegExp(l.data.regex).exec(e))){if(n)return!1;var v=l.data;return{name:r,value:h,strValue:""+e,mapped:v,field:h[1],bypass:n}}else if(e.length>=10&&e[0]==="m"&&(g=new RegExp(l.mapData.regex).exec(e))){if(n||u.multiple)return!1;var m=l.mapData;if(!(u.color||u.number))return!1;var y=this.parse(r,g[4]);if(!y||y.mapped)return!1;var b=this.parse(r,g[5]);if(!b||b.mapped)return!1;if(y.pfValue===b.pfValue||y.strValue===b.strValue)return Pt("`"+r+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+r+": "+y.strValue+"`"),this.parse(r,y.strValue);if(u.color){var x=y.value,A=b.value,C=x[0]===A[0]&&x[1]===A[1]&&x[2]===A[2]&&(x[3]===A[3]||(x[3]==null||x[3]===1)&&(A[3]==null||A[3]===1));if(C)return!1}return{name:r,value:g,strValue:""+e,mapped:m,field:g[1],fieldMin:parseFloat(g[2]),fieldMax:parseFloat(g[3]),valueMin:y.value,valueMax:b.value,bypass:n}}}if(u.multiple&&i!=="multiple"){var E;if(c?E=e.split(/\s+/):Qt(e)?E=e:E=[e],u.evenMultiple&&E.length%2!==0)return null;for(var S=[],M=[],R=[],T="",B=!1,F=0;F<E.length;F++){var I=a.parse(r,E[F],n,"multiple");B=B||We(I.value),S.push(I.value),R.push(I.pfValue!=null?I.pfValue:I.value),M.push(I.units),T+=(F>0?" ":"")+I.strValue}return u.validate&&!u.validate(S,M)?null:u.singleEnum&&B?S.length===1&&We(S[0])?{name:r,value:S[0],strValue:S[0],bypass:n}:null:{name:r,value:S,pfValue:R,strValue:T,bypass:n,units:M}}var U=function(){for(var le=0;le<u.enums.length;le++){var ie=u.enums[le];if(ie===e)return{name:r,value:e,strValue:""+e,bypass:n}}return null};if(u.number){var k,O="px";if(u.units&&(k=u.units),u.implicitUnits&&(O=u.implicitUnits),!u.unitless)if(c){var V="px|em"+(u.allowPercent?"|\\%":"");k&&(V=k);var L=e.match("^("+Ur+")("+V+")?$");L&&(e=L[1],k=L[2]||O)}else(!k||u.implicitUnits)&&(k=O);if(e=parseFloat(e),isNaN(e)&&u.enums===void 0)return null;if(isNaN(e)&&u.enums!==void 0)return e=o,U();if(u.integer&&!D8(e)||u.min!==void 0&&(e<u.min||u.strictMin&&e===u.min)||u.max!==void 0&&(e>u.max||u.strictMax&&e===u.max))return null;var P={name:r,value:e,strValue:""+e+(k||""),units:k,bypass:n};return u.unitless||k!=="px"&&k!=="em"?P.pfValue=e:P.pfValue=k==="px"||!k?e:this.getEmSizeInPixels()*e,(k==="ms"||k==="s")&&(P.pfValue=k==="ms"?e:1e3*e),(k==="deg"||k==="rad")&&(P.pfValue=k==="rad"?e:PR(e)),k==="%"&&(P.pfValue=e/100),P}else if(u.propList){var _=[],q=""+e;if(q!=="none"){for(var H=q.split(/\s*,\s*|\s+/),W=0;W<H.length;W++){var G=H[W].trim();a.properties[G]?_.push(G):Pt("`"+G+"` is not a valid property name")}if(_.length===0)return null}return{name:r,value:_,strValue:_.length===0?"none":_.join(" "),bypass:n}}else if(u.color){var K=uE(e);return K?{name:r,value:K,pfValue:K,strValue:"rgb("+K[0]+","+K[1]+","+K[2]+")",bypass:n}:null}else if(u.regex||u.regexes){if(u.enums){var $=U();if($)return $}for(var te=u.regexes?u.regexes:[u.regex],ae=0;ae<te.length;ae++){var ue=new RegExp(te[ae]),re=ue.exec(e);if(re)return{name:r,value:u.singleRegexMatchValue?re[1]:re,strValue:""+e,bypass:n}}return null}else return u.string?{name:r,value:""+e,strValue:""+e,bypass:n}:u.enums?U():null};var Qr=function(e){if(!(this instanceof Qr))return new Qr(e);if(!A2(e)){ur("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},vn=Qr.prototype;vn.instanceString=function(){return"style"};vn.clear=function(){for(var r=this._private,e=r.cy,n=e.elements(),i=0;i<this.length;i++)this[i]=void 0;return this.length=0,r.contextStyles={},r.propDiffs={},this.cleanElements(n,!0),n.forEach(function(a){var s=a[0]._private;s.styleDirty=!0,s.appliedInitStyle=!1}),this};vn.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};vn.core=function(r){return this._private.coreStyle[r]||this.getDefaultProperty(r)};vn.selector=function(r){var e=r==="core"?null:new Bs(r),n=this.length++;return this[n]={selector:e,properties:[],mappedProperties:[],index:n},this};vn.css=function(){var r=this,e=arguments;if(e.length===1)for(var n=e[0],i=0;i<r.properties.length;i++){var a=r.properties[i],s=n[a.name];s===void 0&&(s=n[b0(a.name)]),s!==void 0&&this.cssRule(a.name,s)}else e.length===2&&this.cssRule(e[0],e[1]);return this};vn.style=vn.css;vn.cssRule=function(r,e){var n=this.parse(r,e);if(n){var i=this.length-1;this[i].properties.push(n),this[i].properties[n.name]=n,n.name.match(/pie-(\d+)-background-size/)&&n.value&&(this._private.hasPie=!0),n.name.match(/stripe-(\d+)-background-size/)&&n.value&&(this._private.hasStripe=!0),n.mapped&&this[i].mappedProperties.push(n);var a=!this[i].selector;a&&(this._private.coreStyle[n.name]=n)}return this};vn.append=function(r){return sE(r)?r.appendToStyle(this):Qt(r)?this.appendFromJson(r):We(r)&&this.appendFromString(r),this};Qr.fromJson=function(r,e){var n=new Qr(r);return n.fromJson(e),n};Qr.fromString=function(r,e){return new Qr(r).fromString(e)};[Wr,cf,U2,Zi,k0,V2,Br,U0].forEach(function(r){et(vn,r)});Qr.types=vn.types;Qr.properties=vn.properties;Qr.propertyGroups=vn.propertyGroups;Qr.propertyGroupNames=vn.propertyGroupNames;Qr.propertyGroupKeys=vn.propertyGroupKeys;var GI={style:function(e){if(e){var n=this.setStyle(e);n.update()}return this._private.style},setStyle:function(e){var n=this._private;return sE(e)?n.style=e.generateStyle(this):Qt(e)?n.style=Qr.fromJson(this,e):We(e)?n.style=Qr.fromString(this,e):n.style=Qr(this),n.style},updateStyle:function(){this.mutableElements().updateStyle()}},qI="single",Eo={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var n=this._private;if(n.selectionType==null&&(n.selectionType=qI),e!==void 0)(e==="additive"||e==="single")&&(n.selectionType=e);else return n.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,n=this._private.pan,i,a,s,o,l;switch(e.length){case 0:return n;case 1:if(We(e[0]))return i=e[0],n[i];if(Dt(e[0])){if(!this._private.panningEnabled)return this;s=e[0],o=s.x,l=s.y,Be(o)&&(n.x=o),Be(l)&&(n.y=l),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;i=e[0],a=e[1],(i==="x"||i==="y")&&Be(a)&&(n[i]=a),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,n){var i=arguments,a=this._private.pan,s,o,l,c,u;if(!this._private.panningEnabled)return this;switch(i.length){case 1:Dt(e)&&(l=i[0],c=l.x,u=l.y,Be(c)&&(a.x+=c),Be(u)&&(a.y+=u),this.emit("pan viewport"));break;case 2:s=e,o=n,(s==="x"||s==="y")&&Be(o)&&(a[s]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,n){var i=this.getFitViewport(e,n);if(i){var a=this._private;a.zoom=i.zoom,a.pan=i.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,n){if(Be(e)&&n===void 0&&(n=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var i;if(We(e)){var a=e;e=this.$(a)}else if(I8(e)){var s=e;i={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2},i.w=i.x2-i.x1,i.h=i.y2-i.y1}else Jn(e)||(e=this.mutableElements());if(!(Jn(e)&&e.empty())){i=i||e.boundingBox();var o=this.width(),l=this.height(),c;if(n=Be(n)?n:0,!isNaN(o)&&!isNaN(l)&&o>0&&l>0&&!isNaN(i.w)&&!isNaN(i.h)&&i.w>0&&i.h>0){c=Math.min((o-2*n)/i.w,(l-2*n)/i.h),c=c>this._private.maxZoom?this._private.maxZoom:c,c=c<this._private.minZoom?this._private.minZoom:c;var u={x:(o-c*(i.x1+i.x2))/2,y:(l-c*(i.y1+i.y2))/2};return{zoom:c,pan:u}}}}},zoomRange:function(e,n){var i=this._private;if(n==null){var a=e;e=a.min,n=a.max}return Be(e)&&Be(n)&&e<=n?(i.minZoom=e,i.maxZoom=n):Be(e)&&n===void 0&&e<=i.maxZoom?i.minZoom=e:Be(n)&&e===void 0&&n>=i.minZoom&&(i.maxZoom=n),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var n=this._private,i=n.pan,a=n.zoom,s,o,l=!1;if(n.zoomingEnabled||(l=!0),Be(e)?o=e:Dt(e)&&(o=e.level,e.position!=null?s=E0(e.position,a,i):e.renderedPosition!=null&&(s=e.renderedPosition),s!=null&&!n.panningEnabled&&(l=!0)),o=o>n.maxZoom?n.maxZoom:o,o=o<n.minZoom?n.minZoom:o,l||!Be(o)||o===a||s!=null&&(!Be(s.x)||!Be(s.y)))return null;if(s!=null){var c=i,u=a,h=o,g={x:-h/u*(s.x-c.x)+s.x,y:-h/u*(s.y-c.y)+s.y};return{zoomed:!0,panned:!0,zoom:h,pan:g}}else return{zoomed:!0,panned:!1,zoom:o,pan:i}},zoom:function(e){if(e===void 0)return this._private.zoom;var n=this.getZoomedViewport(e),i=this._private;return n==null||!n.zoomed?this:(i.zoom=n.zoom,n.panned&&(i.pan.x=n.pan.x,i.pan.y=n.pan.y),this.emit("zoom"+(n.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var n=this._private,i=!0,a=!0,s=[],o=!1,l=!1;if(!e)return this;if(Be(e.zoom)||(i=!1),Dt(e.pan)||(a=!1),!i&&!a)return this;if(i){var c=e.zoom;c<n.minZoom||c>n.maxZoom||!n.zoomingEnabled?o=!0:(n.zoom=c,s.push("zoom"))}if(a&&(!o||!e.cancelOnFailedZoom)&&n.panningEnabled){var u=e.pan;Be(u.x)&&(n.pan.x=u.x,l=!1),Be(u.y)&&(n.pan.y=u.y,l=!1),l||s.push("pan")}return s.length>0&&(s.push("viewport"),this.emit(s.join(" ")),this.notify("viewport")),this},center:function(e){var n=this.getCenterPan(e);return n&&(this._private.pan=n,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,n){if(this._private.panningEnabled){if(We(e)){var i=e;e=this.mutableElements().filter(i)}else Jn(e)||(e=this.mutableElements());if(e.length!==0){var a=e.boundingBox(),s=this.width(),o=this.height();n=n===void 0?this._private.zoom:n;var l={x:(s-n*(a.x1+a.x2))/2,y:(o-n*(a.y1+a.y2))/2};return l}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,n=e.container,i=this;return e.sizeCache=e.sizeCache||(n?(function(){var a=i.window().getComputedStyle(n),s=function(l){return parseFloat(a.getPropertyValue(l))};return{width:n.clientWidth-s("padding-left")-s("padding-right"),height:n.clientHeight-s("padding-top")-s("padding-bottom")}})():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,n=this._private.zoom,i=this.renderedExtent(),a={x1:(i.x1-e.x)/n,x2:(i.x2-e.x)/n,y1:(i.y1-e.y)/n,y2:(i.y2-e.y)/n};return a.w=a.x2-a.x1,a.h=a.y2-a.y1,a},renderedExtent:function(){var e=this.width(),n=this.height();return{x1:0,y1:0,x2:e,y2:n,w:e,h:n}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};Eo.centre=Eo.center;Eo.autolockNodes=Eo.autolock;Eo.autoungrabifyNodes=Eo.autoungrabify;var qc={data:Ot.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Ot.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Ot.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Ot.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};qc.attr=qc.data;qc.removeAttr=qc.removeData;var Yc=function(e){var n=this;e=et({},e);var i=e.container;i&&!Kd(i)&&Kd(i[0])&&(i=i[0]);var a=i?i._cyreg:null;a=a||{},a&&a.cy&&(a.cy.destroy(),a={});var s=a.readies=a.readies||[];i&&(i._cyreg=a),a.cy=n;var o=kr!==void 0&&i!==void 0&&!e.headless,l=e;l.layout=et({name:o?"grid":"null"},l.layout),l.renderer=et({name:o?"canvas":"null"},l.renderer);var c=function(y,b,x){return b!==void 0?b:x!==void 0?x:y},u=this._private={container:i,ready:!1,options:l,elements:new sn(this),listeners:[],aniEles:new sn(this),data:l.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:c(!0,l.zoomingEnabled),userZoomingEnabled:c(!0,l.userZoomingEnabled),panningEnabled:c(!0,l.panningEnabled),userPanningEnabled:c(!0,l.userPanningEnabled),boxSelectionEnabled:c(!0,l.boxSelectionEnabled),autolock:c(!1,l.autolock,l.autolockNodes),autoungrabify:c(!1,l.autoungrabify,l.autoungrabifyNodes),autounselectify:c(!1,l.autounselectify),styleEnabled:l.styleEnabled===void 0?o:l.styleEnabled,zoom:Be(l.zoom)?l.zoom:1,pan:{x:Dt(l.pan)&&Be(l.pan.x)?l.pan.x:0,y:Dt(l.pan)&&Be(l.pan.y)?l.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:c(250,l.multiClickDebounceTime)};this.createEmitter(),this.selectionType(l.selectionType),this.zoomRange({min:l.minZoom,max:l.maxZoom});var h=function(y,b){var x=y.some(N8);if(x)return Ql.all(y).then(b);b(y)};u.styleEnabled&&n.setStyle([]);var g=et({},l,l.renderer);n.initRenderer(g);var v=function(y,b,x){n.notifications(!1);var A=n.mutableElements();A.length>0&&A.remove(),y!=null&&(Dt(y)||Qt(y))&&n.add(y),n.one("layoutready",function(E){n.notifications(!0),n.emit(E),n.one("load",b),n.emitAndNotify("load")}).one("layoutstop",function(){n.one("done",x),n.emit("done")});var C=et({},n._private.options.layout);C.eles=n.elements(),n.layout(C).run()};h([l.style,l.elements],function(m){var y=m[0],b=m[1];u.styleEnabled&&n.style().append(y),v(b,function(){n.startAnimationLoop(),u.ready=!0,gr(l.ready)&&n.on("ready",l.ready);for(var x=0;x<s.length;x++){var A=s[x];n.on("ready",A)}a&&(a.readies=[]),n.emit("ready")},l.done)})},e0=Yc.prototype;et(e0,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return kr;var n=this._private.container.ownerDocument;return n===void 0||n==null?kr:n.defaultView||kr},mount:function(e){if(e!=null){var n=this,i=n._private,a=i.options;return!Kd(e)&&Kd(e[0])&&(e=e[0]),n.stopAnimationLoop(),n.destroyRenderer(),i.container=e,i.styleEnabled=!0,n.invalidateSize(),n.initRenderer(et({},a,a.renderer,{name:a.renderer.name==="null"?"canvas":a.renderer.name})),n.startAnimationLoop(),n.style(a.style),n.emit("mount"),n}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return Hi(this._private.options)},json:function(e){var n=this,i=n._private,a=n.mutableElements(),s=function(S){return n.getElementById(S.id())};if(Dt(e)){if(n.startBatch(),e.elements){var o={},l=function(S,M){for(var R=[],T=[],B=0;B<S.length;B++){var F=S[B];if(!F.data.id){Pt("cy.json() cannot handle elements without an ID attribute");continue}var I=""+F.data.id,U=n.getElementById(I);o[I]=!0,U.length!==0?T.push({ele:U,json:F}):(M&&(F.group=M),R.push(F))}n.add(R);for(var k=0;k<T.length;k++){var O=T[k],V=O.ele,L=O.json;V.json(L)}};if(Qt(e.elements))l(e.elements);else for(var c=["nodes","edges"],u=0;u<c.length;u++){var h=c[u],g=e.elements[h];Qt(g)&&l(g,h)}var v=n.collection();a.filter(function(E){return!o[E.id()]}).forEach(function(E){E.isParent()?v.merge(E):E.remove()}),v.forEach(function(E){return E.children().move({parent:null})}),v.forEach(function(E){return s(E).remove()})}e.style&&n.style(e.style),e.zoom!=null&&e.zoom!==i.zoom&&n.zoom(e.zoom),e.pan&&(e.pan.x!==i.pan.x||e.pan.y!==i.pan.y)&&n.pan(e.pan),e.data&&n.data(e.data);for(var m=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],y=0;y<m.length;y++){var b=m[y];e[b]!=null&&n[b](e[b])}return n.endBatch(),this}else{var x=!!e,A={};x?A.elements=this.elements().map(function(E){return E.json()}):(A.elements={},a.forEach(function(E){var S=E.group();A.elements[S]||(A.elements[S]=[]),A.elements[S].push(E.json())})),this._private.styleEnabled&&(A.style=n.style().json()),A.data=Hi(n.data());var C=i.options;return A.zoomingEnabled=i.zoomingEnabled,A.userZoomingEnabled=i.userZoomingEnabled,A.zoom=i.zoom,A.minZoom=i.minZoom,A.maxZoom=i.maxZoom,A.panningEnabled=i.panningEnabled,A.userPanningEnabled=i.userPanningEnabled,A.pan=Hi(i.pan),A.boxSelectionEnabled=i.boxSelectionEnabled,A.renderer=Hi(C.renderer),A.hideEdgesOnViewport=C.hideEdgesOnViewport,A.textureOnViewport=C.textureOnViewport,A.wheelSensitivity=C.wheelSensitivity,A.motionBlur=C.motionBlur,A.multiClickDebounceTime=C.multiClickDebounceTime,A}}});e0.$id=e0.getElementById;[NI,OI,sS,Bp,Dd,LI,Ip,Rd,GI,Eo,qc].forEach(function(r){et(e0,r)});var YI={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}},jI={maximal:!1,acyclic:!1},pl=function(e){return e.scratch("breadthfirst")},I3=function(e,n){return e.scratch("breadthfirst",n)};function oS(r){this.options=et({},YI,jI,r)}oS.prototype.run=function(){var r=this.options,e=r.cy,n=r.eles,i=n.nodes().filter(function(Xe){return Xe.isChildless()}),a=n,s=r.directed,o=r.acyclic||r.maximal||r.maximalAdjustments>0,l=!!r.boundingBox,c=wn(l?r.boundingBox:structuredClone(e.extent())),u;if(Jn(r.roots))u=r.roots;else if(Qt(r.roots)){for(var h=[],g=0;g<r.roots.length;g++){var v=r.roots[g],m=e.getElementById(v);h.push(m)}u=e.collection(h)}else if(We(r.roots))u=e.$(r.roots);else if(s)u=i.roots();else{var y=n.components();u=e.collection();for(var b=function(){var Ie=y[x],Ye=Ie.maxDegree(!1),Ke=Ie.filter(function(at){return at.degree(!1)===Ye});u=u.add(Ke)},x=0;x<y.length;x++)b()}var A=[],C={},E=function(Ie,Ye){A[Ye]==null&&(A[Ye]=[]);var Ke=A[Ye].length;A[Ye].push(Ie),I3(Ie,{index:Ke,depth:Ye})},S=function(Ie,Ye){var Ke=pl(Ie),at=Ke.depth,ke=Ke.index;A[at][ke]=null,Ie.isChildless()&&E(Ie,Ye)};a.bfs({roots:u,directed:r.directed,visit:function(Ie,Ye,Ke,at,ke){var ft=Ie[0],pt=ft.id();ft.isChildless()&&E(ft,ke),C[pt]=!0}});for(var M=[],R=0;R<i.length;R++){var T=i[R];C[T.id()]||M.push(T)}var B=function(Ie){for(var Ye=A[Ie],Ke=0;Ke<Ye.length;Ke++){var at=Ye[Ke];if(at==null){Ye.splice(Ke,1),Ke--;continue}I3(at,{depth:Ie,index:Ke})}},F=function(Ie,Ye){for(var Ke=pl(Ie),at=Ie.incomers().filter(function(nt){return nt.isNode()&&n.has(nt)}),ke=-1,ft=Ie.id(),pt=0;pt<at.length;pt++){var Tt=at[pt],Et=pl(Tt);ke=Math.max(ke,Et.depth)}if(Ke.depth<=ke){if(!r.acyclic&&Ye[ft])return null;var Rt=ke+1;return S(Ie,Rt),Ye[ft]=Rt,!0}return!1};if(s&&o){var I=[],U={},k=function(Ie){return I.push(Ie)},O=function(){return I.shift()};for(i.forEach(function(Xe){return I.push(Xe)});I.length>0;){var V=O(),L=F(V,U);if(L)V.outgoers().filter(function(Xe){return Xe.isNode()&&n.has(Xe)}).forEach(k);else if(L===null){Pt("Detected double maximal shift for node `"+V.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var P=0;if(r.avoidOverlap)for(var _=0;_<i.length;_++){var q=i[_],H=q.layoutDimensions(r),W=H.w,G=H.h;P=Math.max(P,W,G)}var K={},$=function(Ie){if(K[Ie.id()])return K[Ie.id()];for(var Ye=pl(Ie).depth,Ke=Ie.neighborhood(),at=0,ke=0,ft=0;ft<Ke.length;ft++){var pt=Ke[ft];if(!(pt.isEdge()||pt.isParent()||!i.has(pt))){var Tt=pl(pt);if(Tt!=null){var Et=Tt.index,Rt=Tt.depth;if(!(Et==null||Rt==null)){var nt=A[Rt].length;Rt<Ye&&(at+=Et/nt,ke++)}}}}return ke=Math.max(1,ke),at=at/ke,ke===0&&(at=0),K[Ie.id()]=at,at},te=function(Ie,Ye){var Ke=$(Ie),at=$(Ye),ke=Ke-at;return ke===0?lE(Ie.id(),Ye.id()):ke};r.depthSort!==void 0&&(te=r.depthSort);for(var ae=A.length,ue=0;ue<ae;ue++)A[ue].sort(te),B(ue);for(var re=[],ve=0;ve<M.length;ve++)re.push(M[ve]);var le=function(){for(var Ie=0;Ie<ae;Ie++)B(Ie)};re.length&&(A.unshift(re),ae=A.length,le());for(var ie=0,se=0;se<ae;se++)ie=Math.max(A[se].length,ie);var fe={x:c.x1+c.w/2,y:c.y1+c.h/2},xe=i.reduce(function(Xe,Ie){return(function(Ye){return{w:Xe.w===-1?Ye.w:(Xe.w+Ye.w)/2,h:Xe.h===-1?Ye.h:(Xe.h+Ye.h)/2}})(Ie.boundingBox({includeLabels:r.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),De=Math.max(ae===1?0:l?(c.h-r.padding*2-xe.h)/(ae-1):(c.h-r.padding*2-xe.h)/(ae+1),P),ze=A.reduce(function(Xe,Ie){return Math.max(Xe,Ie.length)},0),gt=function(Ie){var Ye=pl(Ie),Ke=Ye.depth,at=Ye.index;if(r.circle){var ke=Math.min(c.w/2/ae,c.h/2/ae);ke=Math.max(ke,P);var ft=ke*Ke+ke-(ae>0&&A[0].length<=3?ke/2:0),pt=2*Math.PI/A[Ke].length*at;return Ke===0&&A[0].length===1&&(ft=1),{x:fe.x+ft*Math.cos(pt),y:fe.y+ft*Math.sin(pt)}}else{var Tt=A[Ke].length,Et=Math.max(Tt===1?0:l?(c.w-r.padding*2-xe.w)/((r.grid?ze:Tt)-1):(c.w-r.padding*2-xe.w)/((r.grid?ze:Tt)+1),P),Rt={x:fe.x+(at+1-(Tt+1)/2)*Et,y:fe.y+(Ke+1-(ae+1)/2)*De};return Rt}},it={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(it).indexOf(r.direction)===-1&&ur("Invalid direction '".concat(r.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(it).join(", ")));var $e=function(Ie){return oR(gt(Ie),c,it[r.direction])};return n.nodes().layoutPositions(this,r,$e),this};var HI={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function lS(r){this.options=et({},HI,r)}lS.prototype.run=function(){var r=this.options,e=r,n=r.cy,i=e.eles,a=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,s=i.nodes().not(":parent");e.sort&&(s=s.sort(e.sort));for(var o=wn(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},c=e.sweep===void 0?2*Math.PI-2*Math.PI/s.length:e.sweep,u=c/Math.max(1,s.length-1),h,g=0,v=0;v<s.length;v++){var m=s[v],y=m.layoutDimensions(e),b=y.w,x=y.h;g=Math.max(g,b,x)}if(Be(e.radius)?h=e.radius:s.length<=1?h=0:h=Math.min(o.h,o.w)/2-g,s.length>1&&e.avoidOverlap){g*=1.75;var A=Math.cos(u)-Math.cos(0),C=Math.sin(u)-Math.sin(0),E=Math.sqrt(g*g/(A*A+C*C));h=Math.max(E,h)}var S=function(R,T){var B=e.startAngle+T*u*(a?1:-1),F=h*Math.cos(B),I=h*Math.sin(B),U={x:l.x+F,y:l.y+I};return U};return i.nodes().layoutPositions(this,e,S),this};var KI={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function uS(r){this.options=et({},KI,r)}uS.prototype.run=function(){for(var r=this.options,e=r,n=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,i=r.cy,a=e.eles,s=a.nodes().not(":parent"),o=wn(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},c=[],u=0,h=0;h<s.length;h++){var g=s[h],v=void 0;v=e.concentric(g),c.push({value:v,node:g}),g._private.scratch.concentric=v}s.updateStyle();for(var m=0;m<s.length;m++){var y=s[m],b=y.layoutDimensions(e);u=Math.max(u,b.w,b.h)}c.sort(function(De,ze){return ze.value-De.value});for(var x=e.levelWidth(s),A=[[]],C=A[0],E=0;E<c.length;E++){var S=c[E];if(C.length>0){var M=Math.abs(C[0].value-S.value);M>=x&&(C=[],A.push(C))}C.push(S)}var R=u+e.minNodeSpacing;if(!e.avoidOverlap){var T=A.length>0&&A[0].length>1,B=Math.min(o.w,o.h)/2-R,F=B/(A.length+T?1:0);R=Math.min(R,F)}for(var I=0,U=0;U<A.length;U++){var k=A[U],O=e.sweep===void 0?2*Math.PI-2*Math.PI/k.length:e.sweep,V=k.dTheta=O/Math.max(1,k.length-1);if(k.length>1&&e.avoidOverlap){var L=Math.cos(V)-Math.cos(0),P=Math.sin(V)-Math.sin(0),_=Math.sqrt(R*R/(L*L+P*P));I=Math.max(_,I)}k.r=I,I+=R}if(e.equidistant){for(var q=0,H=0,W=0;W<A.length;W++){var G=A[W],K=G.r-H;q=Math.max(q,K)}H=0;for(var $=0;$<A.length;$++){var te=A[$];$===0&&(H=te.r),te.r=H,H+=q}}for(var ae={},ue=0;ue<A.length;ue++)for(var re=A[ue],ve=re.dTheta,le=re.r,ie=0;ie<re.length;ie++){var se=re[ie],fe=e.startAngle+(n?1:-1)*ve*ie,xe={x:l.x+le*Math.cos(fe),y:l.y+le*Math.sin(fe)};ae[se.node.id()]=xe}return a.nodes().layoutPositions(this,e,function(De){var ze=De.id();return ae[ze]}),this};var V1,XI={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,n){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function V0(r){this.options=et({},XI,r),this.options.layout=this;var e=this.options.eles.nodes(),n=this.options.eles.edges(),i=n.filter(function(a){var s=a.source().data("id"),o=a.target().data("id"),l=e.some(function(u){return u.data("id")===s}),c=e.some(function(u){return u.data("id")===o});return!l||!c});this.options.eles=this.options.eles.not(i)}V0.prototype.run=function(){var r=this.options,e=r.cy,n=this;n.stopped=!1,(r.animate===!0||r.animate===!1)&&n.emit({type:"layoutstart",layout:n}),r.debug===!0?V1=!0:V1=!1;var i=QI(e,n,r);V1&&WI(i),r.randomize&&JI(i);var a=Ra(),s=function(){$I(i,e,r),r.fit===!0&&e.fit(r.padding)},o=function(v){return!(n.stopped||v>=r.numIter||(eN(i,r),i.temperature=i.temperature*r.coolingFactor,i.temperature<r.minTemp))},l=function(){if(r.animate===!0||r.animate===!1)s(),n.one("layoutstop",r.stop),n.emit({type:"layoutstop",layout:n});else{var v=r.eles.nodes(),m=fS(i,r,v);v.layoutPositions(n,r,m)}},c=0,u=!0;if(r.animate===!0){var h=function(){for(var v=0;u&&v<r.refresh;)u=o(c),c++,v++;if(!u)F3(i,r),l();else{var m=Ra();m-a>=r.animationThreshold&&s(),Xd(h)}};h()}else{for(;u;)u=o(c),c++;F3(i,r),l()}return this};V0.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};V0.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var QI=function(e,n,i){for(var a=i.eles.edges(),s=i.eles.nodes(),o=wn(i.boundingBox?i.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),l={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:s.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:a.size(),temperature:i.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o},c=i.eles.components(),u={},h=0;h<c.length;h++)for(var g=c[h],v=0;v<g.length;v++){var m=g[v];u[m.id()]=h}for(var h=0;h<l.nodeSize;h++){var y=s[h],b=y.layoutDimensions(i),x={};x.isLocked=y.locked(),x.id=y.data("id"),x.parentId=y.data("parent"),x.cmptId=u[y.id()],x.children=[],x.positionX=y.position("x"),x.positionY=y.position("y"),x.offsetX=0,x.offsetY=0,x.height=b.w,x.width=b.h,x.maxX=x.positionX+x.width/2,x.minX=x.positionX-x.width/2,x.maxY=x.positionY+x.height/2,x.minY=x.positionY-x.height/2,x.padLeft=parseFloat(y.style("padding")),x.padRight=parseFloat(y.style("padding")),x.padTop=parseFloat(y.style("padding")),x.padBottom=parseFloat(y.style("padding")),x.nodeRepulsion=gr(i.nodeRepulsion)?i.nodeRepulsion(y):i.nodeRepulsion,l.layoutNodes.push(x),l.idToIndex[x.id]=h}for(var A=[],C=0,E=-1,S=[],h=0;h<l.nodeSize;h++){var y=l.layoutNodes[h],M=y.parentId;M!=null?l.layoutNodes[l.idToIndex[M]].children.push(y.id):(A[++E]=y.id,S.push(y.id))}for(l.graphSet.push(S);C<=E;){var R=A[C++],T=l.idToIndex[R],m=l.layoutNodes[T],B=m.children;if(B.length>0){l.graphSet.push(B);for(var h=0;h<B.length;h++)A[++E]=B[h]}}for(var h=0;h<l.graphSet.length;h++)for(var F=l.graphSet[h],v=0;v<F.length;v++){var I=l.idToIndex[F[v]];l.indexToGraph[I]=h}for(var h=0;h<l.edgeSize;h++){var U=a[h],k={};k.id=U.data("id"),k.sourceId=U.data("source"),k.targetId=U.data("target");var O=gr(i.idealEdgeLength)?i.idealEdgeLength(U):i.idealEdgeLength,V=gr(i.edgeElasticity)?i.edgeElasticity(U):i.edgeElasticity,L=l.idToIndex[k.sourceId],P=l.idToIndex[k.targetId],_=l.indexToGraph[L],q=l.indexToGraph[P];if(_!=q){for(var H=ZI(k.sourceId,k.targetId,l),W=l.graphSet[H],G=0,x=l.layoutNodes[L];W.indexOf(x.id)===-1;)x=l.layoutNodes[l.idToIndex[x.parentId]],G++;for(x=l.layoutNodes[P];W.indexOf(x.id)===-1;)x=l.layoutNodes[l.idToIndex[x.parentId]],G++;O*=G*i.nestingFactor}k.idealLength=O,k.elasticity=V,l.layoutEdges.push(k)}return l},ZI=function(e,n,i){var a=cS(e,n,0,i);return 2>a.count?0:a.graph},cS=function(e,n,i,a){var s=a.graphSet[i];if(-1<s.indexOf(e)&&-1<s.indexOf(n))return{count:2,graph:i};for(var o=0,l=0;l<s.length;l++){var c=s[l],u=a.idToIndex[c],h=a.layoutNodes[u].children;if(h.length!==0){var g=a.indexToGraph[a.idToIndex[h[0]]],v=cS(e,n,g,a);if(v.count!==0)if(v.count===1){if(o++,o===2)break}else return v}}return{count:o,graph:i}},WI,JI=function(e,n){for(var i=e.clientWidth,a=e.clientHeight,s=0;s<e.nodeSize;s++){var o=e.layoutNodes[s];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*i,o.positionY=Math.random()*a)}},fS=function(e,n,i){var a=e.boundingBox,s={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return n.boundingBox&&(i.forEach(function(o){var l=e.layoutNodes[e.idToIndex[o.data("id")]];s.x1=Math.min(s.x1,l.positionX),s.x2=Math.max(s.x2,l.positionX),s.y1=Math.min(s.y1,l.positionY),s.y2=Math.max(s.y2,l.positionY)}),s.w=s.x2-s.x1,s.h=s.y2-s.y1),function(o,l){var c=e.layoutNodes[e.idToIndex[o.data("id")]];if(n.boundingBox){var u=s.w===0?.5:(c.positionX-s.x1)/s.w,h=s.h===0?.5:(c.positionY-s.y1)/s.h;return{x:a.x1+u*a.w,y:a.y1+h*a.h}}else return{x:c.positionX,y:c.positionY}}},$I=function(e,n,i){var a=i.layout,s=i.eles.nodes(),o=fS(e,i,s);s.positions(o),e.ready!==!0&&(e.ready=!0,a.one("layoutready",i.ready),a.emit({type:"layoutready",layout:this}))},eN=function(e,n,i){tN(e,n),iN(e),aN(e,n),sN(e),oN(e)},tN=function(e,n){for(var i=0;i<e.graphSet.length;i++)for(var a=e.graphSet[i],s=a.length,o=0;o<s;o++)for(var l=e.layoutNodes[e.idToIndex[a[o]]],c=o+1;c<s;c++){var u=e.layoutNodes[e.idToIndex[a[c]]];rN(l,u,e,n)}},N3=function(e){return-1+2*e*Math.random()},rN=function(e,n,i,a){var s=e.cmptId,o=n.cmptId;if(!(s!==o&&!i.isCompound)){var l=n.positionX-e.positionX,c=n.positionY-e.positionY,u=1;l===0&&c===0&&(l=N3(u),c=N3(u));var h=nN(e,n,l,c);if(h>0)var g=a.nodeOverlap*h,v=Math.sqrt(l*l+c*c),m=g*l/v,y=g*c/v;else var b=t0(e,l,c),x=t0(n,-1*l,-1*c),A=x.x-b.x,C=x.y-b.y,E=A*A+C*C,v=Math.sqrt(E),g=(e.nodeRepulsion+n.nodeRepulsion)/E,m=g*A/v,y=g*C/v;e.isLocked||(e.offsetX-=m,e.offsetY-=y),n.isLocked||(n.offsetX+=m,n.offsetY+=y)}},nN=function(e,n,i,a){if(i>0)var s=e.maxX-n.minX;else var s=n.maxX-e.minX;if(a>0)var o=e.maxY-n.minY;else var o=n.maxY-e.minY;return s>=0&&o>=0?Math.sqrt(s*s+o*o):0},t0=function(e,n,i){var a=e.positionX,s=e.positionY,o=e.height||1,l=e.width||1,c=i/n,u=o/l,h={};return n===0&&0<i||n===0&&0>i?(h.x=a,h.y=s+o/2,h):0<n&&-1*u<=c&&c<=u?(h.x=a+l/2,h.y=s+l*i/2/n,h):0>n&&-1*u<=c&&c<=u?(h.x=a-l/2,h.y=s-l*i/2/n,h):0<i&&(c<=-1*u||c>=u)?(h.x=a+o*n/2/i,h.y=s+o/2,h):(0>i&&(c<=-1*u||c>=u)&&(h.x=a-o*n/2/i,h.y=s-o/2),h)},iN=function(e,n){for(var i=0;i<e.edgeSize;i++){var a=e.layoutEdges[i],s=e.idToIndex[a.sourceId],o=e.layoutNodes[s],l=e.idToIndex[a.targetId],c=e.layoutNodes[l],u=c.positionX-o.positionX,h=c.positionY-o.positionY;if(!(u===0&&h===0)){var g=t0(o,u,h),v=t0(c,-1*u,-1*h),m=v.x-g.x,y=v.y-g.y,b=Math.sqrt(m*m+y*y),x=Math.pow(a.idealLength-b,2)/a.elasticity;if(b!==0)var A=x*m/b,C=x*y/b;else var A=0,C=0;o.isLocked||(o.offsetX+=A,o.offsetY+=C),c.isLocked||(c.offsetX-=A,c.offsetY-=C)}}},aN=function(e,n){if(n.gravity!==0)for(var i=1,a=0;a<e.graphSet.length;a++){var s=e.graphSet[a],o=s.length;if(a===0)var l=e.clientHeight/2,c=e.clientWidth/2;else var u=e.layoutNodes[e.idToIndex[s[0]]],h=e.layoutNodes[e.idToIndex[u.parentId]],l=h.positionX,c=h.positionY;for(var g=0;g<o;g++){var v=e.layoutNodes[e.idToIndex[s[g]]];if(!v.isLocked){var m=l-v.positionX,y=c-v.positionY,b=Math.sqrt(m*m+y*y);if(b>i){var x=n.gravity*m/b,A=n.gravity*y/b;v.offsetX+=x,v.offsetY+=A}}}}},sN=function(e,n){var i=[],a=0,s=-1;for(i.push.apply(i,e.graphSet[0]),s+=e.graphSet[0].length;a<=s;){var o=i[a++],l=e.idToIndex[o],c=e.layoutNodes[l],u=c.children;if(0<u.length&&!c.isLocked){for(var h=c.offsetX,g=c.offsetY,v=0;v<u.length;v++){var m=e.layoutNodes[e.idToIndex[u[v]]];m.offsetX+=h,m.offsetY+=g,i[++s]=u[v]}c.offsetX=0,c.offsetY=0}}},oN=function(e,n){for(var i=0;i<e.nodeSize;i++){var a=e.layoutNodes[i];0<a.children.length&&(a.maxX=void 0,a.minX=void 0,a.maxY=void 0,a.minY=void 0)}for(var i=0;i<e.nodeSize;i++){var a=e.layoutNodes[i];if(!(0<a.children.length||a.isLocked)){var s=lN(a.offsetX,a.offsetY,e.temperature);a.positionX+=s.x,a.positionY+=s.y,a.offsetX=0,a.offsetY=0,a.minX=a.positionX-a.width,a.maxX=a.positionX+a.width,a.minY=a.positionY-a.height,a.maxY=a.positionY+a.height,hS(a,e)}}for(var i=0;i<e.nodeSize;i++){var a=e.layoutNodes[i];0<a.children.length&&!a.isLocked&&(a.positionX=(a.maxX+a.minX)/2,a.positionY=(a.maxY+a.minY)/2,a.width=a.maxX-a.minX,a.height=a.maxY-a.minY)}},lN=function(e,n,i){var a=Math.sqrt(e*e+n*n);if(a>i)var s={x:i*e/a,y:i*n/a};else var s={x:e,y:n};return s},hS=function(e,n){var i=e.parentId;if(i!=null){var a=n.layoutNodes[n.idToIndex[i]],s=!1;if((a.maxX==null||e.maxX+a.padRight>a.maxX)&&(a.maxX=e.maxX+a.padRight,s=!0),(a.minX==null||e.minX-a.padLeft<a.minX)&&(a.minX=e.minX-a.padLeft,s=!0),(a.maxY==null||e.maxY+a.padBottom>a.maxY)&&(a.maxY=e.maxY+a.padBottom,s=!0),(a.minY==null||e.minY-a.padTop<a.minY)&&(a.minY=e.minY-a.padTop,s=!0),s)return hS(a,n)}},F3=function(e,n){for(var i=e.layoutNodes,a=[],s=0;s<i.length;s++){var o=i[s],l=o.cmptId,c=a[l]=a[l]||[];c.push(o)}for(var u=0,s=0;s<a.length;s++){var h=a[s];if(h){h.x1=1/0,h.x2=-1/0,h.y1=1/0,h.y2=-1/0;for(var g=0;g<h.length;g++){var v=h[g];h.x1=Math.min(h.x1,v.positionX-v.width/2),h.x2=Math.max(h.x2,v.positionX+v.width/2),h.y1=Math.min(h.y1,v.positionY-v.height/2),h.y2=Math.max(h.y2,v.positionY+v.height/2)}h.w=h.x2-h.x1,h.h=h.y2-h.y1,u+=h.w*h.h}}a.sort(function(C,E){return E.w*E.h-C.w*C.h});for(var m=0,y=0,b=0,x=0,A=Math.sqrt(u)*e.clientWidth/e.clientHeight,s=0;s<a.length;s++){var h=a[s];if(h){for(var g=0;g<h.length;g++){var v=h[g];v.isLocked||(v.positionX+=m-h.x1,v.positionY+=y-h.y1)}m+=h.w+n.componentSpacing,b+=h.w+n.componentSpacing,x=Math.max(x,h.h),b>A&&(y+=x+n.componentSpacing,m=0,b=0,x=0)}}},uN={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function dS(r){this.options=et({},uN,r)}dS.prototype.run=function(){var r=this.options,e=r,n=r.cy,i=e.eles,a=i.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));var s=wn(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});if(s.h===0||s.w===0)i.nodes().layoutPositions(this,e,function($){return{x:s.x1,y:s.y1}});else{var o=a.size(),l=Math.sqrt(o*s.h/s.w),c=Math.round(l),u=Math.round(s.w/s.h*l),h=function(te){if(te==null)return Math.min(c,u);var ae=Math.min(c,u);ae==c?c=te:u=te},g=function(te){if(te==null)return Math.max(c,u);var ae=Math.max(c,u);ae==c?c=te:u=te},v=e.rows,m=e.cols!=null?e.cols:e.columns;if(v!=null&&m!=null)c=v,u=m;else if(v!=null&&m==null)c=v,u=Math.ceil(o/c);else if(v==null&&m!=null)u=m,c=Math.ceil(o/u);else if(u*c>o){var y=h(),b=g();(y-1)*b>=o?h(y-1):(b-1)*y>=o&&g(b-1)}else for(;u*c<o;){var x=h(),A=g();(A+1)*x>=o?g(A+1):h(x+1)}var C=s.w/u,E=s.h/c;if(e.condense&&(C=0,E=0),e.avoidOverlap)for(var S=0;S<a.length;S++){var M=a[S],R=M._private.position;(R.x==null||R.y==null)&&(R.x=0,R.y=0);var T=M.layoutDimensions(e),B=e.avoidOverlapPadding,F=T.w+B,I=T.h+B;C=Math.max(C,F),E=Math.max(E,I)}for(var U={},k=function(te,ae){return!!U["c-"+te+"-"+ae]},O=function(te,ae){U["c-"+te+"-"+ae]=!0},V=0,L=0,P=function(){L++,L>=u&&(L=0,V++)},_={},q=0;q<a.length;q++){var H=a[q],W=e.position(H);if(W&&(W.row!==void 0||W.col!==void 0)){var G={row:W.row,col:W.col};if(G.col===void 0)for(G.col=0;k(G.row,G.col);)G.col++;else if(G.row===void 0)for(G.row=0;k(G.row,G.col);)G.row++;_[H.id()]=G,O(G.row,G.col)}}var K=function(te,ae){var ue,re;if(te.locked()||te.isParent())return!1;var ve=_[te.id()];if(ve)ue=ve.col*C+C/2+s.x1,re=ve.row*E+E/2+s.y1;else{for(;k(V,L);)P();ue=L*C+C/2+s.x1,re=V*E+E/2+s.y1,O(V,L),P()}return{x:ue,y:re}};a.layoutPositions(this,e,K)}return this};var cN={ready:function(){},stop:function(){}};function O2(r){this.options=et({},cN,r)}O2.prototype.run=function(){var r=this.options,e=r.eles,n=this;return r.cy,n.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),n.one("layoutready",r.ready),n.emit("layoutready"),n.one("layoutstop",r.stop),n.emit("layoutstop"),this};O2.prototype.stop=function(){return this};var fN={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function gS(r){this.options=et({},fN,r)}gS.prototype.run=function(){var r=this.options,e=r.eles,n=e.nodes(),i=gr(r.positions);function a(s){if(r.positions==null)return FR(s.position());if(i)return r.positions(s);var o=r.positions[s._private.data.id];return o??null}return n.layoutPositions(this,r,function(s,o){var l=a(s);return s.locked()||l==null?!1:l}),this};var hN={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function vS(r){this.options=et({},hN,r)}vS.prototype.run=function(){var r=this.options,e=r.cy,n=r.eles,i=wn(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),a=function(o,l){return{x:i.x1+Math.round(Math.random()*i.w),y:i.y1+Math.round(Math.random()*i.h)}};return n.nodes().layoutPositions(this,r,a),this};var dN=[{name:"breadthfirst",impl:oS},{name:"circle",impl:lS},{name:"concentric",impl:uS},{name:"cose",impl:V0},{name:"grid",impl:dS},{name:"null",impl:O2},{name:"preset",impl:gS},{name:"random",impl:vS}];function mS(r){this.options=r,this.notifications=0}var k3=function(){},U3=function(){throw new Error("A headless instance can not render images")};mS.prototype={recalculateRenderedStyle:k3,notify:function(){this.notifications++},init:k3,isHeadless:function(){return!0},png:U3,jpg:U3};var P2={};P2.arrowShapeWidth=.3;P2.registerArrowShapes=function(){var r=this.arrowShapes={},e=this,n=function(u,h,g,v,m,y,b){var x=m.x-g/2-b,A=m.x+g/2+b,C=m.y-g/2-b,E=m.y+g/2+b,S=x<=u&&u<=A&&C<=h&&h<=E;return S},i=function(u,h,g,v,m){var y=u*Math.cos(v)-h*Math.sin(v),b=u*Math.sin(v)+h*Math.cos(v),x=y*g,A=b*g,C=x+m.x,E=A+m.y;return{x:C,y:E}},a=function(u,h,g,v){for(var m=[],y=0;y<u.length;y+=2){var b=u[y],x=u[y+1];m.push(i(b,x,h,g,v))}return m},s=function(u){for(var h=[],g=0;g<u.length;g++){var v=u[g];h.push(v.x,v.y)}return h},o=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},l=function(u,h){We(h)&&(h=r[h]),r[u]=et({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(v,m,y,b,x,A){var C=s(a(this.points,y+2*A,b,x)),E=Vn(v,m,C);return E},roughCollide:n,draw:function(v,m,y,b){var x=a(this.points,m,y,b);e.arrowShapeImpl("polygon")(v,x)},spacing:function(v){return 0},gap:o},h)};l("none",{collide:Qd,roughCollide:Qd,draw:C2,spacing:Q5,gap:Q5}),l("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),l("arrow","triangle"),l("triangle-backcurve",{points:r.triangle.points,controlPoint:[0,-.15],roughCollide:n,draw:function(u,h,g,v,m){var y=a(this.points,h,g,v),b=this.controlPoint,x=i(b[0],b[1],h,g,v);e.arrowShapeImpl(this.name)(u,y,x)},gap:function(u){return o(u)*.8}}),l("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,h,g,v,m,y,b){var x=s(a(this.points,g+2*b,v,m)),A=s(a(this.pointsTee,g+2*b,v,m)),C=Vn(u,h,x)||Vn(u,h,A);return C},draw:function(u,h,g,v,m){var y=a(this.points,h,g,v),b=a(this.pointsTee,h,g,v);e.arrowShapeImpl(this.name)(u,y,b)}}),l("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,h,g,v,m,y,b){var x=m,A=Math.pow(x.x-u,2)+Math.pow(x.y-h,2)<=Math.pow((g+2*b)*this.radius,2),C=s(a(this.points,g+2*b,v,m));return Vn(u,h,C)||A},draw:function(u,h,g,v,m){var y=a(this.pointsTr,h,g,v);e.arrowShapeImpl(this.name)(u,y,v.x,v.y,this.radius*h)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),l("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,h){var g=this.baseCrossLinePts.slice(),v=h/u,m=3,y=5;return g[m]=g[m]-v,g[y]=g[y]-v,g},collide:function(u,h,g,v,m,y,b){var x=s(a(this.points,g+2*b,v,m)),A=s(a(this.crossLinePts(g,y),g+2*b,v,m)),C=Vn(u,h,x)||Vn(u,h,A);return C},draw:function(u,h,g,v,m){var y=a(this.points,h,g,v),b=a(this.crossLinePts(h,m),h,g,v);e.arrowShapeImpl(this.name)(u,y,b)}}),l("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return o(u)*.525}}),l("circle",{radius:.15,collide:function(u,h,g,v,m,y,b){var x=m,A=Math.pow(x.x-u,2)+Math.pow(x.y-h,2)<=Math.pow((g+2*b)*this.radius,2);return A},draw:function(u,h,g,v,m){e.arrowShapeImpl(this.name)(u,v.x,v.y,this.radius*h)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),l("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),l("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),l("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),l("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Bo={};Bo.projectIntoViewport=function(r,e){var n=this.cy,i=this.findContainerClientCoords(),a=i[0],s=i[1],o=i[4],l=n.pan(),c=n.zoom(),u=((r-a)/o-l.x)/c,h=((e-s)/o-l.y)/c;return[u,h]};Bo.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var r=this.container,e=r.getBoundingClientRect(),n=this.cy.window().getComputedStyle(r),i=function(A){return parseFloat(n.getPropertyValue(A))},a={left:i("padding-left"),right:i("padding-right"),top:i("padding-top"),bottom:i("padding-bottom")},s={left:i("border-left-width"),right:i("border-right-width"),top:i("border-top-width"),bottom:i("border-bottom-width")},o=r.clientWidth,l=r.clientHeight,c=a.left+a.right,u=a.top+a.bottom,h=s.left+s.right,g=e.width/(o+h),v=o-c,m=l-u,y=e.left+a.left+s.left,b=e.top+a.top+s.top;return this.containerBB=[y,b,v,m,g]};Bo.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Bo.findNearestElement=function(r,e,n,i){return this.findNearestElements(r,e,n,i)[0]};Bo.findNearestElements=function(r,e,n,i){var a=this,s=this,o=s.getCachedZSortedEles(),l=[],c=s.cy.zoom(),u=s.cy.hasCompoundNodes(),h=(i?24:8)/c,g=(i?8:2)/c,v=(i?8:2)/c,m=1/0,y,b;n&&(o=o.interactive);function x(T,B){if(T.isNode()){if(b)return;b=T,l.push(T)}if(T.isEdge()&&(B==null||B<m))if(y){if(y.pstyle("z-compound-depth").value===T.pstyle("z-compound-depth").value&&y.pstyle("z-compound-depth").value===T.pstyle("z-compound-depth").value){for(var F=0;F<l.length;F++)if(l[F].isEdge()){l[F]=T,y=T,m=B??m;break}}}else l.push(T),y=T,m=B??m}function A(T){var B=T.outerWidth()+2*g,F=T.outerHeight()+2*g,I=B/2,U=F/2,k=T.position(),O=T.pstyle("corner-radius").value==="auto"?"auto":T.pstyle("corner-radius").pfValue,V=T._private.rscratch;if(k.x-I<=r&&r<=k.x+I&&k.y-U<=e&&e<=k.y+U){var L=s.nodeShapes[a.getNodeShape(T)];if(L.checkPoint(r,e,0,B,F,k.x,k.y,O,V))return x(T,0),!0}}function C(T){var B=T._private,F=B.rscratch,I=T.pstyle("width").pfValue,U=T.pstyle("arrow-scale").value,k=I/2+h,O=k*k,V=k*2,q=B.source,H=B.target,L;if(F.edgeType==="segments"||F.edgeType==="straight"||F.edgeType==="haystack"){for(var P=F.allpts,_=0;_+3<P.length;_+=2)if(KR(r,e,P[_],P[_+1],P[_+2],P[_+3],V)&&O>(L=JR(r,e,P[_],P[_+1],P[_+2],P[_+3])))return x(T,L),!0}else if(F.edgeType==="bezier"||F.edgeType==="multibezier"||F.edgeType==="self"||F.edgeType==="compound"){for(var P=F.allpts,_=0;_+5<F.allpts.length;_+=4)if(XR(r,e,P[_],P[_+1],P[_+2],P[_+3],P[_+4],P[_+5],V)&&O>(L=WR(r,e,P[_],P[_+1],P[_+2],P[_+3],P[_+4],P[_+5])))return x(T,L),!0}for(var q=q||B.source,H=H||B.target,W=a.getArrowWidth(I,U),G=[{name:"source",x:F.arrowStartX,y:F.arrowStartY,angle:F.srcArrowAngle},{name:"target",x:F.arrowEndX,y:F.arrowEndY,angle:F.tgtArrowAngle},{name:"mid-source",x:F.midX,y:F.midY,angle:F.midsrcArrowAngle},{name:"mid-target",x:F.midX,y:F.midY,angle:F.midtgtArrowAngle}],_=0;_<G.length;_++){var K=G[_],$=s.arrowShapes[T.pstyle(K.name+"-arrow-shape").value],te=T.pstyle("width").pfValue;if($.roughCollide(r,e,W,K.angle,{x:K.x,y:K.y},te,h)&&$.collide(r,e,W,K.angle,{x:K.x,y:K.y},te,h))return x(T),!0}u&&l.length>0&&(A(q),A(H))}function E(T,B,F){return Un(T,B,F)}function S(T,B){var F=T._private,I=v,U;B?U=B+"-":U="",T.boundingBox();var k=F.labelBounds[B||"main"],O=T.pstyle(U+"label").value,V=T.pstyle("text-events").strValue==="yes";if(!(!V||!O)){var L=E(F.rscratch,"labelX",B),P=E(F.rscratch,"labelY",B),_=E(F.rscratch,"labelAngle",B),q=T.pstyle(U+"text-margin-x").pfValue,H=T.pstyle(U+"text-margin-y").pfValue,W=k.x1-I-q,G=k.x2+I-q,K=k.y1-I-H,$=k.y2+I-H;if(_){var te=Math.cos(_),ae=Math.sin(_),ue=function(xe,De){return xe=xe-L,De=De-P,{x:xe*te-De*ae+L,y:xe*ae+De*te+P}},re=ue(W,K),ve=ue(W,$),le=ue(G,K),ie=ue(G,$),se=[re.x+q,re.y+H,le.x+q,le.y+H,ie.x+q,ie.y+H,ve.x+q,ve.y+H];if(Vn(r,e,se))return x(T),!0}else if(xs(k,r,e))return x(T),!0}}for(var M=o.length-1;M>=0;M--){var R=o[M];R.isNode()?A(R)||S(R):C(R)||S(R)||S(R,"source")||S(R,"target")}return l};Bo.getAllInBox=function(r,e,n,i){var a=this.getCachedZSortedEles().interactive,s=this.cy.zoom(),o=2/s,l=[],c=Math.min(r,n),u=Math.max(r,n),h=Math.min(e,i),g=Math.max(e,i);r=c,n=u,e=h,i=g;var v=wn({x1:r,y1:e,x2:n,y2:i}),m=[{x:v.x1,y:v.y1},{x:v.x2,y:v.y1},{x:v.x2,y:v.y2},{x:v.x1,y:v.y2}],y=[[m[0],m[1]],[m[1],m[2]],[m[2],m[3]],[m[3],m[0]]];function b(xe,De,ze){return Un(xe,De,ze)}function x(xe,De){var ze=xe._private,gt=o,it="";xe.boundingBox();var $e=ze.labelBounds.main;if(!$e)return null;var Xe=b(ze.rscratch,"labelX",De),Ie=b(ze.rscratch,"labelY",De),Ye=b(ze.rscratch,"labelAngle",De),Ke=xe.pstyle(it+"text-margin-x").pfValue,at=xe.pstyle(it+"text-margin-y").pfValue,ke=$e.x1-gt-Ke,ft=$e.x2+gt-Ke,pt=$e.y1-gt-at,Tt=$e.y2+gt-at;if(Ye){var Et=Math.cos(Ye),Rt=Math.sin(Ye),nt=function(be,X){return be=be-Xe,X=X-Ie,{x:be*Et-X*Rt+Xe,y:be*Rt+X*Et+Ie}};return[nt(ke,pt),nt(ft,pt),nt(ft,Tt),nt(ke,Tt)]}else return[{x:ke,y:pt},{x:ft,y:pt},{x:ft,y:Tt},{x:ke,y:Tt}]}function A(xe,De,ze,gt){function it($e,Xe,Ie){return(Ie.y-$e.y)*(Xe.x-$e.x)>(Xe.y-$e.y)*(Ie.x-$e.x)}return it(xe,ze,gt)!==it(De,ze,gt)&&it(xe,De,ze)!==it(xe,De,gt)}for(var C=0;C<a.length;C++){var E=a[C];if(E.isNode()){var S=E,M=S.pstyle("text-events").strValue==="yes",R=S.pstyle("box-selection").strValue,T=S.pstyle("box-select-labels").strValue==="yes";if(R==="none")continue;var B=(R==="overlap"||T)&&M,F=S.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:B});if(R==="contain"){var I=!1;if(T&&M){var U=x(S);U&&km(U,m)&&(l.push(S),I=!0)}!I&&CE(v,F)&&l.push(S)}else if(R==="overlap"&&M2(v,F)){var k=S.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),O=[{x:k.x1,y:k.y1},{x:k.x2,y:k.y1},{x:k.x2,y:k.y2},{x:k.x1,y:k.y2}];if(km(O,m))l.push(S);else{var V=x(S);V&&km(V,m)&&l.push(S)}}}else{var L=E,P=L._private,_=P.rscratch,q=L.pstyle("box-selection").strValue;if(q==="none")continue;if(q==="contain"){if(_.startX!=null&&_.startY!=null&&!xs(v,_.startX,_.startY)||_.endX!=null&&_.endY!=null&&!xs(v,_.endX,_.endY))continue;if(_.edgeType==="bezier"||_.edgeType==="multibezier"||_.edgeType==="self"||_.edgeType==="compound"||_.edgeType==="segments"||_.edgeType==="haystack"){for(var H=P.rstyle.bezierPts||P.rstyle.linePts||P.rstyle.haystackPts,W=!0,G=0;G<H.length;G++)if(!ew(v,H[G])){W=!1;break}W&&l.push(L)}else _.edgeType==="straight"&&l.push(L)}else if(q==="overlap"){var K=!1;if(_.startX!=null&&_.startY!=null&&_.endX!=null&&_.endY!=null&&(xs(v,_.startX,_.startY)||xs(v,_.endX,_.endY)))l.push(L),K=!0;else if(!K&&_.edgeType==="haystack"){for(var $=P.rstyle.haystackPts,te=0;te<$.length;te++)if(ew(v,$[te])){l.push(L),K=!0;break}}if(!K){var ae=P.rstyle.bezierPts||P.rstyle.linePts||P.rstyle.haystackPts;if((!ae||ae.length<2)&&_.edgeType==="straight"&&_.startX!=null&&_.startY!=null&&_.endX!=null&&_.endY!=null&&(ae=[{x:_.startX,y:_.startY},{x:_.endX,y:_.endY}]),!ae||ae.length<2)continue;for(var ue=0;ue<ae.length-1;ue++){for(var re=ae[ue],ve=ae[ue+1],le=0;le<y.length;le++){var ie=Ir(y[le],2),se=ie[0],fe=ie[1];if(A(re,ve,se,fe)){l.push(L),K=!0;break}}if(K)break}}}}}return l};var r0={};r0.calculateArrowAngles=function(r){var e=r._private.rscratch,n=e.edgeType==="haystack",i=e.edgeType==="bezier",a=e.edgeType==="multibezier",s=e.edgeType==="segments",o=e.edgeType==="compound",l=e.edgeType==="self",c,u,h,g,v,m,A,C;if(n?(h=e.haystackPts[0],g=e.haystackPts[1],v=e.haystackPts[2],m=e.haystackPts[3]):(h=e.arrowStartX,g=e.arrowStartY,v=e.arrowEndX,m=e.arrowEndY),A=e.midX,C=e.midY,s)c=h-e.segpts[0],u=g-e.segpts[1];else if(a||o||l||i){var y=e.allpts,b=Hr(y[0],y[2],y[4],.1),x=Hr(y[1],y[3],y[5],.1);c=h-b,u=g-x}else c=h-A,u=g-C;e.srcArrowAngle=zh(c,u);var A=e.midX,C=e.midY;if(n&&(A=(h+v)/2,C=(g+m)/2),c=v-h,u=m-g,s){var y=e.allpts;if(y.length/2%2===0){var E=y.length/2,S=E-2;c=y[E]-y[S],u=y[E+1]-y[S+1]}else if(e.isRound)c=e.midVector[1],u=-e.midVector[0];else{var E=y.length/2-1,S=E-2;c=y[E]-y[S],u=y[E+1]-y[S+1]}}else if(a||o||l){var y=e.allpts,M=e.ctrlpts,R,T,B,F;if(M.length/2%2===0){var I=y.length/2-1,U=I+2,k=U+2;R=Hr(y[I],y[U],y[k],0),T=Hr(y[I+1],y[U+1],y[k+1],0),B=Hr(y[I],y[U],y[k],1e-4),F=Hr(y[I+1],y[U+1],y[k+1],1e-4)}else{var U=y.length/2-1,I=U-2,k=U+2;R=Hr(y[I],y[U],y[k],.4999),T=Hr(y[I+1],y[U+1],y[k+1],.4999),B=Hr(y[I],y[U],y[k],.5),F=Hr(y[I+1],y[U+1],y[k+1],.5)}c=B-R,u=F-T}if(e.midtgtArrowAngle=zh(c,u),e.midDispX=c,e.midDispY=u,c*=-1,u*=-1,s){var y=e.allpts;if(y.length/2%2!==0){if(!e.isRound){var E=y.length/2-1,O=E+2;c=-(y[O]-y[E]),u=-(y[O+1]-y[E+1])}}}if(e.midsrcArrowAngle=zh(c,u),s)c=v-e.segpts[e.segpts.length-2],u=m-e.segpts[e.segpts.length-1];else if(a||o||l||i){var y=e.allpts,V=y.length,b=Hr(y[V-6],y[V-4],y[V-2],.9),x=Hr(y[V-5],y[V-3],y[V-1],.9);c=v-b,u=m-x}else c=v-A,u=m-C;e.tgtArrowAngle=zh(c,u)};r0.getArrowWidth=r0.getArrowHeight=function(r,e){var n=this.arrowWidthCache=this.arrowWidthCache||{},i=n[r+", "+e];return i||(i=Math.max(Math.pow(r*13.37,.9),29)*e,n[r+", "+e]=i,i)};var Np,Fp,Gi={},di={},V3,O3,co,Bd,ya,to,lo,_i,yl,Qh,pS,yS,kp,Up,P3,L3=function(e,n,i){i.x=n.x-e.x,i.y=n.y-e.y,i.len=Math.sqrt(i.x*i.x+i.y*i.y),i.nx=i.x/i.len,i.ny=i.y/i.len,i.ang=Math.atan2(i.ny,i.nx)},gN=function(e,n){n.x=e.x*-1,n.y=e.y*-1,n.nx=e.nx*-1,n.ny=e.ny*-1,n.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},vN=function(e,n,i,a,s){if(e!==P3?L3(n,e,Gi):gN(di,Gi),L3(n,i,di),V3=Gi.nx*di.ny-Gi.ny*di.nx,O3=Gi.nx*di.nx-Gi.ny*-di.ny,ya=Math.asin(Math.max(-1,Math.min(1,V3))),Math.abs(ya)<1e-6){Np=n.x,Fp=n.y,lo=yl=0;return}co=1,Bd=!1,O3<0?ya<0?ya=Math.PI+ya:(ya=Math.PI-ya,co=-1,Bd=!0):ya>0&&(co=-1,Bd=!0),n.radius!==void 0?yl=n.radius:yl=a,to=ya/2,Qh=Math.min(Gi.len/2,di.len/2),s?(_i=Math.abs(Math.cos(to)*yl/Math.sin(to)),_i>Qh?(_i=Qh,lo=Math.abs(_i*Math.sin(to)/Math.cos(to))):lo=yl):(_i=Math.min(Qh,yl),lo=Math.abs(_i*Math.sin(to)/Math.cos(to))),kp=n.x+di.nx*_i,Up=n.y+di.ny*_i,Np=kp-di.ny*lo*co,Fp=Up+di.nx*lo*co,pS=n.x+Gi.nx*_i,yS=n.y+Gi.ny*_i,P3=n};function AS(r,e){e.radius===0?r.lineTo(e.cx,e.cy):r.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function L2(r,e,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return i===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(vN(r,e,n,i,a),{cx:Np,cy:Fp,radius:lo,startX:pS,startY:yS,stopX:kp,stopY:Up,startAngle:Gi.ang+Math.PI/2*co,endAngle:di.ang-Math.PI/2*co,counterClockwise:Bd})}var jc=.01,mN=Math.sqrt(2*jc),mn={};mn.findMidptPtsEtc=function(r,e){var n=e.posPts,i=e.intersectionPts,a=e.vectorNormInverse,s,o=r.pstyle("source-endpoint"),l=r.pstyle("target-endpoint"),c=o.units!=null&&l.units!=null,u=function(M,R,T,B){var F=B-R,I=T-M,U=Math.sqrt(I*I+F*F);return{x:-F/U,y:I/U}},h=r.pstyle("edge-distances").value;switch(h){case"node-position":s=n;break;case"intersection":s=i;break;case"endpoints":{if(c){var g=this.manualEndptToPx(r.source()[0],o),v=Ir(g,2),m=v[0],y=v[1],b=this.manualEndptToPx(r.target()[0],l),x=Ir(b,2),A=x[0],C=x[1],E={x1:m,y1:y,x2:A,y2:C};a=u(m,y,A,C),s=E}else Pt("Edge ".concat(r.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),s=i;break}}return{midptPts:s,vectorNormInverse:a}};mn.findHaystackPoints=function(r){for(var e=0;e<r.length;e++){var n=r[e],i=n._private,a=i.rscratch;if(!a.haystack){var s=Math.random()*2*Math.PI;a.source={x:Math.cos(s),y:Math.sin(s)},s=Math.random()*2*Math.PI,a.target={x:Math.cos(s),y:Math.sin(s)}}var o=i.source,l=i.target,c=o.position(),u=l.position(),h=o.width(),g=l.width(),v=o.height(),m=l.height(),y=n.pstyle("haystack-radius").value,b=y/2;a.haystackPts=a.allpts=[a.source.x*h*b+c.x,a.source.y*v*b+c.y,a.target.x*g*b+u.x,a.target.y*m*b+u.y],a.midX=(a.allpts[0]+a.allpts[2])/2,a.midY=(a.allpts[1]+a.allpts[3])/2,a.edgeType="haystack",a.haystack=!0,this.storeEdgeProjections(n),this.calculateArrowAngles(n),this.recalculateEdgeLabelProjections(n),this.calculateLabelAngles(n)}};mn.findSegmentsPoints=function(r,e){var n=r._private.rscratch,i=r.pstyle("segment-weights"),a=r.pstyle("segment-distances"),s=r.pstyle("segment-radii"),o=r.pstyle("radius-type"),l=Math.min(i.pfValue.length,a.pfValue.length),c=s.pfValue[s.pfValue.length-1],u=o.pfValue[o.pfValue.length-1];n.edgeType="segments",n.segpts=[],n.radii=[],n.isArcRadius=[];for(var h=0;h<l;h++){var g=i.pfValue[h],v=a.pfValue[h],m=1-g,y=g,b=this.findMidptPtsEtc(r,e),x=b.midptPts,A=b.vectorNormInverse,C={x:x.x1*m+x.x2*y,y:x.y1*m+x.y2*y};n.segpts.push(C.x+A.x*v,C.y+A.y*v),n.radii.push(s.pfValue[h]!==void 0?s.pfValue[h]:c),n.isArcRadius.push((o.pfValue[h]!==void 0?o.pfValue[h]:u)==="arc-radius")}};mn.findLoopPoints=function(r,e,n,i){var a=r._private.rscratch,s=e.dirCounts,o=e.srcPos,l=r.pstyle("control-point-distances"),c=l?l.pfValue[0]:void 0,u=r.pstyle("loop-direction").pfValue,h=r.pstyle("loop-sweep").pfValue,g=r.pstyle("control-point-step-size").pfValue;a.edgeType="self";var v=n,m=g;i&&(v=0,m=c);var y=u-Math.PI/2,b=y-h/2,x=y+h/2,A=u+"_"+h;v=s[A]===void 0?s[A]=0:++s[A],a.ctrlpts=[o.x+Math.cos(b)*1.4*m*(v/3+1),o.y+Math.sin(b)*1.4*m*(v/3+1),o.x+Math.cos(x)*1.4*m*(v/3+1),o.y+Math.sin(x)*1.4*m*(v/3+1)]};mn.findCompoundLoopPoints=function(r,e,n,i){var a=r._private.rscratch;a.edgeType="compound";var s=e.srcPos,o=e.tgtPos,l=e.srcW,c=e.srcH,u=e.tgtW,h=e.tgtH,g=r.pstyle("control-point-step-size").pfValue,v=r.pstyle("control-point-distances"),m=v?v.pfValue[0]:void 0,y=n,b=g;i&&(y=0,b=m);var x=50,A={x:s.x-l/2,y:s.y-c/2},C={x:o.x-u/2,y:o.y-h/2},E={x:Math.min(A.x,C.x),y:Math.min(A.y,C.y)},S=.5,M=Math.max(S,Math.log(l*jc)),R=Math.max(S,Math.log(u*jc));a.ctrlpts=[E.x,E.y-(1+Math.pow(x,1.12)/100)*b*(y/3+1)*M,E.x-(1+Math.pow(x,1.12)/100)*b*(y/3+1)*R,E.y]};mn.findStraightEdgePoints=function(r){r._private.rscratch.edgeType="straight"};mn.findBezierPoints=function(r,e,n,i,a){var s=r._private.rscratch,o=r.pstyle("control-point-step-size").pfValue,l=r.pstyle("control-point-distances"),c=r.pstyle("control-point-weights"),u=l&&c?Math.min(l.value.length,c.value.length):1,h=l?l.pfValue[0]:void 0,g=c.value[0],v=i;s.edgeType=v?"multibezier":"bezier",s.ctrlpts=[];for(var m=0;m<u;m++){var y=(.5-e.eles.length/2+n)*o*(a?-1:1),b=void 0,x=T2(y);v&&(h=l?l.pfValue[m]:o,g=c.value[m]),i?b=h:b=h!==void 0?x*h:void 0;var A=b!==void 0?b:y,C=1-g,E=g,S=this.findMidptPtsEtc(r,e),M=S.midptPts,R=S.vectorNormInverse,T={x:M.x1*C+M.x2*E,y:M.y1*C+M.y2*E};s.ctrlpts.push(T.x+R.x*A,T.y+R.y*A)}};mn.findTaxiPoints=function(r,e){var n=r._private.rscratch;n.edgeType="segments";var i="vertical",a="horizontal",s="leftward",o="rightward",l="downward",c="upward",u="auto",h=e.posPts,g=e.srcW,v=e.srcH,m=e.tgtW,y=e.tgtH,b=r.pstyle("edge-distances").value,x=b!=="node-position",A=r.pstyle("taxi-direction").value,C=A,E=r.pstyle("taxi-turn"),S=E.units==="%",M=E.pfValue,R=M<0,T=r.pstyle("taxi-turn-min-distance").pfValue,B=x?(g+m)/2:0,F=x?(v+y)/2:0,I=h.x2-h.x1,U=h.y2-h.y1,k=function(X,ce){return X>0?Math.max(X-ce,0):Math.min(X+ce,0)},O=k(I,B),V=k(U,F),L=!1;C===u?A=Math.abs(O)>Math.abs(V)?a:i:C===c||C===l?(A=i,L=!0):(C===s||C===o)&&(A=a,L=!0);var P=A===i,_=P?V:O,q=P?U:I,H=T2(q),W=!1;!(L&&(S||R))&&(C===l&&q<0||C===c&&q>0||C===s&&q>0||C===o&&q<0)&&(H*=-1,_=H*Math.abs(_),W=!0);var G;if(S){var K=M<0?1+M:M;G=K*_}else{var $=M<0?_:0;G=$+M*H}var te=function(X){return Math.abs(X)<T||Math.abs(X)>=Math.abs(_)},ae=te(G),ue=te(Math.abs(_)-Math.abs(G)),re=ae||ue;if(re&&!W)if(P){var ve=Math.abs(q)<=v/2,le=Math.abs(I)<=m/2;if(ve){var ie=(h.x1+h.x2)/2,se=h.y1,fe=h.y2;n.segpts=[ie,se,ie,fe]}else if(le){var xe=(h.y1+h.y2)/2,De=h.x1,ze=h.x2;n.segpts=[De,xe,ze,xe]}else n.segpts=[h.x1,h.y2]}else{var gt=Math.abs(q)<=g/2,it=Math.abs(U)<=y/2;if(gt){var $e=(h.y1+h.y2)/2,Xe=h.x1,Ie=h.x2;n.segpts=[Xe,$e,Ie,$e]}else if(it){var Ye=(h.x1+h.x2)/2,Ke=h.y1,at=h.y2;n.segpts=[Ye,Ke,Ye,at]}else n.segpts=[h.x2,h.y1]}else if(P){var ke=h.y1+G+(x?v/2*H:0),ft=h.x1,pt=h.x2;n.segpts=[ft,ke,pt,ke]}else{var Tt=h.x1+G+(x?g/2*H:0),Et=h.y1,Rt=h.y2;n.segpts=[Tt,Et,Tt,Rt]}if(n.isRound){var nt=r.pstyle("taxi-radius").value,Oe=r.pstyle("radius-type").value[0]==="arc-radius";n.radii=new Array(n.segpts.length/2).fill(nt),n.isArcRadius=new Array(n.segpts.length/2).fill(Oe)}};mn.tryToCorrectInvalidPoints=function(r,e){var n=r._private.rscratch;if(n.edgeType==="bezier"){var i=e.srcPos,a=e.tgtPos,s=e.srcW,o=e.srcH,l=e.tgtW,c=e.tgtH,u=e.srcShape,h=e.tgtShape,g=e.srcCornerRadius,v=e.tgtCornerRadius,m=e.srcRs,y=e.tgtRs,b=!Be(n.startX)||!Be(n.startY),x=!Be(n.arrowStartX)||!Be(n.arrowStartY),A=!Be(n.endX)||!Be(n.endY),C=!Be(n.arrowEndX)||!Be(n.arrowEndY),E=3,S=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth,M=E*S,R=wo({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.startX,y:n.startY}),T=R<M,B=wo({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.endX,y:n.endY}),F=B<M,I=!1;if(b||x||T){I=!0;var U={x:n.ctrlpts[0]-i.x,y:n.ctrlpts[1]-i.y},k=Math.sqrt(U.x*U.x+U.y*U.y),O={x:U.x/k,y:U.y/k},V=Math.max(s,o),L={x:n.ctrlpts[0]+O.x*2*V,y:n.ctrlpts[1]+O.y*2*V},P=u.intersectLine(i.x,i.y,s,o,L.x,L.y,0,g,m);T?(n.ctrlpts[0]=n.ctrlpts[0]+O.x*(M-R),n.ctrlpts[1]=n.ctrlpts[1]+O.y*(M-R)):(n.ctrlpts[0]=P[0]+O.x*M,n.ctrlpts[1]=P[1]+O.y*M)}if(A||C||F){I=!0;var _={x:n.ctrlpts[0]-a.x,y:n.ctrlpts[1]-a.y},q=Math.sqrt(_.x*_.x+_.y*_.y),H={x:_.x/q,y:_.y/q},W=Math.max(s,o),G={x:n.ctrlpts[0]+H.x*2*W,y:n.ctrlpts[1]+H.y*2*W},K=h.intersectLine(a.x,a.y,l,c,G.x,G.y,0,v,y);F?(n.ctrlpts[0]=n.ctrlpts[0]+H.x*(M-B),n.ctrlpts[1]=n.ctrlpts[1]+H.y*(M-B)):(n.ctrlpts[0]=K[0]+H.x*M,n.ctrlpts[1]=K[1]+H.y*M)}I&&this.findEndpoints(r)}};mn.storeAllpts=function(r){var e=r._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var n=0;n+1<e.ctrlpts.length;n+=2)e.allpts.push(e.ctrlpts[n],e.ctrlpts[n+1]),n+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[n]+e.ctrlpts[n+2])/2,(e.ctrlpts[n+1]+e.ctrlpts[n+3])/2);e.allpts.push(e.endX,e.endY);var i,a;e.ctrlpts.length/2%2===0?(i=e.allpts.length/2-1,e.midX=e.allpts[i],e.midY=e.allpts[i+1]):(i=e.allpts.length/2-3,a=.5,e.midX=Hr(e.allpts[i],e.allpts[i+2],e.allpts[i+4],a),e.midY=Hr(e.allpts[i+1],e.allpts[i+3],e.allpts[i+5],a))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var s=2;s+3<e.allpts.length;s+=2){var o=e.radii[s/2-1],l=e.isArcRadius[s/2-1];e.roundCorners.push(L2({x:e.allpts[s-2],y:e.allpts[s-1]},{x:e.allpts[s],y:e.allpts[s+1],radius:o},{x:e.allpts[s+2],y:e.allpts[s+3]},o,l))}}if(e.segpts.length%4===0){var c=e.segpts.length/2,u=c-2;e.midX=(e.segpts[u]+e.segpts[c])/2,e.midY=(e.segpts[u+1]+e.segpts[c+1])/2}else{var h=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[h],e.midY=e.segpts[h+1];else{var g={x:e.segpts[h],y:e.segpts[h+1]},v=e.roundCorners[h/2];if(v.radius===0){var m={x:e.segpts[h+2],y:e.segpts[h+3]};e.midX=g.x,e.midY=g.y,e.midVector=[g.y-m.y,m.x-g.x]}else{var y=[g.x-v.cx,g.y-v.cy],b=v.radius/Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2));y=y.map(function(x){return x*b}),e.midX=v.cx+y[0],e.midY=v.cy+y[1],e.midVector=y}}}}};mn.checkForInvalidEdgeWarning=function(r){var e=r[0]._private.rscratch;e.nodesOverlap||Be(e.startX)&&Be(e.startY)&&Be(e.endX)&&Be(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,Pt("Edge `"+r.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};mn.findEdgeControlPoints=function(r){var e=this;if(!(!r||r.length===0)){for(var n=this,i=n.cy,a=i.hasCompoundNodes(),s=new Sa,o=function(F,I){return[].concat(Hd(F),[I?1:0]).join("-")},l=[],c=[],u=0;u<r.length;u++){var h=r[u],g=h._private,v=h.pstyle("curve-style").value;if(!(h.removed()||!h.takesUpSpace())){if(v==="haystack"){c.push(h);continue}var m=v==="unbundled-bezier"||As(v,"segments")||v==="straight"||v==="straight-triangle"||As(v,"taxi"),y=v==="unbundled-bezier"||v==="bezier",b=g.source,x=g.target,A=b.poolIndex(),C=x.poolIndex(),E=[A,C].sort(),S=o(E,m),M=s.get(S);M==null&&(M={eles:[]},l.push({pairId:E,edgeIsUnbundled:m}),s.set(S,M)),M.eles.push(h),m&&(M.hasUnbundled=!0),y&&(M.hasBezier=!0)}}for(var R=function(){var F=l[T],I=F.pairId,U=F.edgeIsUnbundled,k=o(I,U),O=s.get(k),V;if(!O.hasUnbundled){var L=O.eles[0].parallelEdges().filter(function(Oe){return Oe.isBundledBezier()});E2(O.eles),L.forEach(function(Oe){return O.eles.push(Oe)}),O.eles.sort(function(Oe,be){return Oe.poolIndex()-be.poolIndex()})}var P=O.eles[0],_=P.source(),q=P.target();if(_.poolIndex()>q.poolIndex()){var H=_;_=q,q=H}var W=O.srcPos=_.position(),G=O.tgtPos=q.position(),K=O.srcW=_.outerWidth(),$=O.srcH=_.outerHeight(),te=O.tgtW=q.outerWidth(),ae=O.tgtH=q.outerHeight(),ue=O.srcShape=n.nodeShapes[e.getNodeShape(_)],re=O.tgtShape=n.nodeShapes[e.getNodeShape(q)],ve=O.srcCornerRadius=_.pstyle("corner-radius").value==="auto"?"auto":_.pstyle("corner-radius").pfValue,le=O.tgtCornerRadius=q.pstyle("corner-radius").value==="auto"?"auto":q.pstyle("corner-radius").pfValue,ie=O.tgtRs=q._private.rscratch,se=O.srcRs=_._private.rscratch;O.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var fe=0;fe<O.eles.length;fe++){var xe=O.eles[fe],De=xe[0]._private.rscratch,ze=xe.pstyle("curve-style").value,gt=ze==="unbundled-bezier"||As(ze,"segments")||As(ze,"taxi"),it=!_.same(xe.source());if(!O.calculatedIntersection&&_!==q&&(O.hasBezier||O.hasUnbundled)){O.calculatedIntersection=!0;var $e=ue.intersectLine(W.x,W.y,K,$,G.x,G.y,0,ve,se),Xe=O.srcIntn=$e,Ie=re.intersectLine(G.x,G.y,te,ae,W.x,W.y,0,le,ie),Ye=O.tgtIntn=Ie,Ke=O.intersectionPts={x1:$e[0],x2:Ie[0],y1:$e[1],y2:Ie[1]},at=O.posPts={x1:W.x,x2:G.x,y1:W.y,y2:G.y},ke=Ie[1]-$e[1],ft=Ie[0]-$e[0],pt=Math.sqrt(ft*ft+ke*ke);Be(pt)&&pt>=mN||(pt=Math.sqrt(Math.max(ft*ft,jc)+Math.max(ke*ke,jc)));var Tt=O.vector={x:ft,y:ke},Et=O.vectorNorm={x:Tt.x/pt,y:Tt.y/pt},Rt={x:-Et.y,y:Et.x};O.nodesOverlap=!Be(pt)||re.checkPoint($e[0],$e[1],0,te,ae,G.x,G.y,le,ie)||ue.checkPoint(Ie[0],Ie[1],0,K,$,W.x,W.y,ve,se),O.vectorNormInverse=Rt,V={nodesOverlap:O.nodesOverlap,dirCounts:O.dirCounts,calculatedIntersection:!0,hasBezier:O.hasBezier,hasUnbundled:O.hasUnbundled,eles:O.eles,srcPos:G,srcRs:ie,tgtPos:W,tgtRs:se,srcW:te,srcH:ae,tgtW:K,tgtH:$,srcIntn:Ye,tgtIntn:Xe,srcShape:re,tgtShape:ue,posPts:{x1:at.x2,y1:at.y2,x2:at.x1,y2:at.y1},intersectionPts:{x1:Ke.x2,y1:Ke.y2,x2:Ke.x1,y2:Ke.y1},vector:{x:-Tt.x,y:-Tt.y},vectorNorm:{x:-Et.x,y:-Et.y},vectorNormInverse:{x:-Rt.x,y:-Rt.y}}}var nt=it?V:O;De.nodesOverlap=nt.nodesOverlap,De.srcIntn=nt.srcIntn,De.tgtIntn=nt.tgtIntn,De.isRound=ze.startsWith("round"),a&&(_.isParent()||_.isChild()||q.isParent()||q.isChild())&&(_.parents().anySame(q)||q.parents().anySame(_)||_.same(q)&&_.isParent())?e.findCompoundLoopPoints(xe,nt,fe,gt):_===q?e.findLoopPoints(xe,nt,fe,gt):ze.endsWith("segments")?e.findSegmentsPoints(xe,nt):ze.endsWith("taxi")?e.findTaxiPoints(xe,nt):ze==="straight"||!gt&&O.eles.length%2===1&&fe===Math.floor(O.eles.length/2)?e.findStraightEdgePoints(xe):e.findBezierPoints(xe,nt,fe,gt,it),e.findEndpoints(xe),e.tryToCorrectInvalidPoints(xe,nt),e.checkForInvalidEdgeWarning(xe),e.storeAllpts(xe),e.storeEdgeProjections(xe),e.calculateArrowAngles(xe),e.recalculateEdgeLabelProjections(xe),e.calculateLabelAngles(xe)}},T=0;T<l.length;T++)R();this.findHaystackPoints(c)}};function xS(r){var e=[];if(r!=null){for(var n=0;n<r.length;n+=2){var i=r[n],a=r[n+1];e.push({x:i,y:a})}return e}}mn.getSegmentPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var n=e.edgeType;if(n==="segments")return xS(e.segpts)};mn.getControlPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var n=e.edgeType;if(n==="bezier"||n==="multibezier"||n==="self"||n==="compound")return xS(e.ctrlpts)};mn.getEdgeMidpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),{x:e.midX,y:e.midY}};var ff={};ff.manualEndptToPx=function(r,e){var n=this,i=r.position(),a=r.outerWidth(),s=r.outerHeight(),o=r._private.rscratch;if(e.value.length===2){var l=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(l[0]=l[0]*a),e.units[1]==="%"&&(l[1]=l[1]*s),l[0]+=i.x,l[1]+=i.y,l}else{var c=e.pfValue[0];c=-Math.PI/2+c;var u=2*Math.max(a,s),h=[i.x+Math.cos(c)*u,i.y+Math.sin(c)*u];return n.nodeShapes[this.getNodeShape(r)].intersectLine(i.x,i.y,a,s,h[0],h[1],0,r.pstyle("corner-radius").value==="auto"?"auto":r.pstyle("corner-radius").pfValue,o)}};ff.findEndpoints=function(r){var e,n,i,a,s=this,o,l=r.source()[0],c=r.target()[0],u=l.position(),h=c.position(),g=r.pstyle("target-arrow-shape").value,v=r.pstyle("source-arrow-shape").value,m=r.pstyle("target-distance-from-node").pfValue,y=r.pstyle("source-distance-from-node").pfValue,b=l._private.rscratch,x=c._private.rscratch,A=r.pstyle("curve-style").value,C=r._private.rscratch,E=C.edgeType,S=As(A,"taxi"),M=E==="self"||E==="compound",R=E==="bezier"||E==="multibezier"||M,T=E!=="bezier",B=E==="straight"||E==="segments",F=E==="segments",I=R||T||B,U=M||S,k=r.pstyle("source-endpoint"),O=U?"outside-to-node":k.value,V=l.pstyle("corner-radius").value==="auto"?"auto":l.pstyle("corner-radius").pfValue,L=r.pstyle("target-endpoint"),P=U?"outside-to-node":L.value,_=c.pstyle("corner-radius").value==="auto"?"auto":c.pstyle("corner-radius").pfValue;C.srcManEndpt=k,C.tgtManEndpt=L;var q,H,W,G,K=(e=(L==null||(n=L.pfValue)===null||n===void 0?void 0:n.length)===2?L.pfValue:null)!==null&&e!==void 0?e:[0,0],$=(i=(k==null||(a=k.pfValue)===null||a===void 0?void 0:a.length)===2?k.pfValue:null)!==null&&i!==void 0?i:[0,0];if(R){var te=[C.ctrlpts[0],C.ctrlpts[1]],ae=T?[C.ctrlpts[C.ctrlpts.length-2],C.ctrlpts[C.ctrlpts.length-1]]:te;q=ae,H=te}else if(B){var ue=F?C.segpts.slice(0,2):[h.x+K[0],h.y+K[1]],re=F?C.segpts.slice(C.segpts.length-2):[u.x+$[0],u.y+$[1]];q=re,H=ue}if(P==="inside-to-node")o=[h.x,h.y];else if(L.units)o=this.manualEndptToPx(c,L);else if(P==="outside-to-line")o=C.tgtIntn;else if(P==="outside-to-node"||P==="outside-to-node-or-label"?W=q:(P==="outside-to-line"||P==="outside-to-line-or-label")&&(W=[u.x,u.y]),o=s.nodeShapes[this.getNodeShape(c)].intersectLine(h.x,h.y,c.outerWidth(),c.outerHeight(),W[0],W[1],0,_,x),P==="outside-to-node-or-label"||P==="outside-to-line-or-label"){var ve=c._private.rscratch,le=ve.labelWidth,ie=ve.labelHeight,se=ve.labelX,fe=ve.labelY,xe=le/2,De=ie/2,ze=c.pstyle("text-valign").value;ze==="top"?fe-=De:ze==="bottom"&&(fe+=De);var gt=c.pstyle("text-halign").value;gt==="left"?se-=xe:gt==="right"&&(se+=xe);var it=_c(W[0],W[1],[se-xe,fe-De,se+xe,fe-De,se+xe,fe+De,se-xe,fe+De],h.x,h.y);if(it.length>0){var $e=u,Xe=oo($e,Nl(o)),Ie=oo($e,Nl(it)),Ye=Xe;if(Ie<Xe&&(o=it,Ye=Ie),it.length>2){var Ke=oo($e,{x:it[2],y:it[3]});Ke<Ye&&(o=[it[2],it[3]])}}}var at=Gh(o,q,s.arrowShapes[g].spacing(r)+m),ke=Gh(o,q,s.arrowShapes[g].gap(r)+m);if(C.endX=ke[0],C.endY=ke[1],C.arrowEndX=at[0],C.arrowEndY=at[1],O==="inside-to-node")o=[u.x,u.y];else if(k.units)o=this.manualEndptToPx(l,k);else if(O==="outside-to-line")o=C.srcIntn;else if(O==="outside-to-node"||O==="outside-to-node-or-label"?G=H:(O==="outside-to-line"||O==="outside-to-line-or-label")&&(G=[h.x,h.y]),o=s.nodeShapes[this.getNodeShape(l)].intersectLine(u.x,u.y,l.outerWidth(),l.outerHeight(),G[0],G[1],0,V,b),O==="outside-to-node-or-label"||O==="outside-to-line-or-label"){var ft=l._private.rscratch,pt=ft.labelWidth,Tt=ft.labelHeight,Et=ft.labelX,Rt=ft.labelY,nt=pt/2,Oe=Tt/2,be=l.pstyle("text-valign").value;be==="top"?Rt-=Oe:be==="bottom"&&(Rt+=Oe);var X=l.pstyle("text-halign").value;X==="left"?Et-=nt:X==="right"&&(Et+=nt);var ce=_c(G[0],G[1],[Et-nt,Rt-Oe,Et+nt,Rt-Oe,Et+nt,Rt+Oe,Et-nt,Rt+Oe],u.x,u.y);if(ce.length>0){var pe=h,me=oo(pe,Nl(o)),we=oo(pe,Nl(ce)),Ve=me;if(we<me&&(o=[ce[0],ce[1]],Ve=we),ce.length>2){var Se=oo(pe,{x:ce[2],y:ce[3]});Se<Ve&&(o=[ce[2],ce[3]])}}}var Ge=Gh(o,H,s.arrowShapes[v].spacing(r)+y),Ue=Gh(o,H,s.arrowShapes[v].gap(r)+y);C.startX=Ue[0],C.startY=Ue[1],C.arrowStartX=Ge[0],C.arrowStartY=Ge[1],I&&(!Be(C.startX)||!Be(C.startY)||!Be(C.endX)||!Be(C.endY)?C.badLine=!0:C.badLine=!1)};ff.getSourceEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};ff.getTargetEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var _2={};function pN(r,e,n){for(var i=function(u,h,g,v){return Hr(u,h,g,v)},a=e._private,s=a.rstyle.bezierPts,o=0;o<r.bezierProjPcts.length;o++){var l=r.bezierProjPcts[o];s.push({x:i(n[0],n[2],n[4],l),y:i(n[1],n[3],n[5],l)})}}_2.storeEdgeProjections=function(r){var e=r._private,n=e.rscratch,i=n.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,i==="multibezier"||i==="bezier"||i==="self"||i==="compound"){e.rstyle.bezierPts=[];for(var a=0;a+5<n.allpts.length;a+=4)pN(this,r,n.allpts.slice(a,a+6))}else if(i==="segments")for(var s=e.rstyle.linePts=[],a=0;a+1<n.allpts.length;a+=2)s.push({x:n.allpts[a],y:n.allpts[a+1]});else if(i==="haystack"){var o=n.haystackPts;e.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth};_2.recalculateEdgeProjections=function(r){this.findEdgeControlPoints(r)};var Ji={};Ji.recalculateNodeLabelProjection=function(r){var e=r.pstyle("label").strValue;if(!Ms(e)){var n,i,a=r._private,s=r.width(),o=r.height(),l=r.padding(),c=r.position(),u=r.pstyle("text-halign").strValue,h=r.pstyle("text-valign").strValue,g=a.rscratch,v=a.rstyle;switch(u){case"left":n=c.x-s/2-l;break;case"right":n=c.x+s/2+l;break;default:n=c.x}switch(h){case"top":i=c.y-o/2-l;break;case"bottom":i=c.y+o/2+l;break;default:i=c.y}g.labelX=n,g.labelY=i,v.labelX=n,v.labelY=i,this.calculateLabelAngles(r),this.applyLabelDimensions(r)}};var bS=function(e,n){var i=Math.atan(n/e);return e===0&&i<0&&(i=i*-1),i},wS=function(e,n){var i=n.x-e.x,a=n.y-e.y;return bS(i,a)},yN=function(e,n,i,a){var s=Lc(0,a-.001,1),o=Lc(0,a+.001,1),l=Vl(e,n,i,s),c=Vl(e,n,i,o);return wS(l,c)};Ji.recalculateEdgeLabelProjections=function(r){var e,n=r._private,i=n.rscratch,a=this,s={mid:r.pstyle("label").strValue,source:r.pstyle("source-label").strValue,target:r.pstyle("target-label").strValue};if(s.mid||s.source||s.target){e={x:i.midX,y:i.midY};var o=function(g,v,m){Ca(n.rscratch,g,v,m),Ca(n.rstyle,g,v,m)};o("labelX",null,e.x),o("labelY",null,e.y);var l=bS(i.midDispX,i.midDispY);o("labelAutoAngle",null,l);var c=function(){if(c.cache)return c.cache;for(var g=[],v=0;v+5<i.allpts.length;v+=4){var m={x:i.allpts[v],y:i.allpts[v+1]},y={x:i.allpts[v+2],y:i.allpts[v+3]},b={x:i.allpts[v+4],y:i.allpts[v+5]};g.push({p0:m,p1:y,p2:b,startDist:0,length:0,segments:[]})}var x=n.rstyle.bezierPts,A=a.bezierProjPcts.length;function C(T,B,F,I,U){var k=wo(B,F),O=T.segments[T.segments.length-1],V={p0:B,p1:F,t0:I,t1:U,startDist:O?O.startDist+O.length:0,length:k};T.segments.push(V),T.length+=k}for(var E=0;E<g.length;E++){var S=g[E],M=g[E-1];M&&(S.startDist=M.startDist+M.length),C(S,S.p0,x[E*A],0,a.bezierProjPcts[0]);for(var R=0;R<A-1;R++)C(S,x[E*A+R],x[E*A+R+1],a.bezierProjPcts[R],a.bezierProjPcts[R+1]);C(S,x[E*A+A-1],S.p2,a.bezierProjPcts[A-1],1)}return c.cache=g},u=function(g){var v,m=g==="source";if(s[g]){var y=r.pstyle(g+"-text-offset").pfValue;switch(i.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var b=c(),x,A=0,C=0,E=0;E<b.length;E++){for(var S=b[m?E:b.length-1-E],M=0;M<S.segments.length;M++){var R=S.segments[m?M:S.segments.length-1-M],T=E===b.length-1&&M===S.segments.length-1;if(A=C,C+=R.length,C>=y||T){x={cp:S,segment:R};break}}if(x)break}var B=x.cp,F=x.segment,I=(y-A)/F.length,U=F.t1-F.t0,k=m?F.t0+U*I:F.t1-U*I;k=Lc(0,k,1),e=Vl(B.p0,B.p1,B.p2,k),v=yN(B.p0,B.p1,B.p2,k);break}case"straight":case"segments":case"haystack":{for(var O=0,V,L,P,_,q=i.allpts.length,H=0;H+3<q&&(m?(P={x:i.allpts[H],y:i.allpts[H+1]},_={x:i.allpts[H+2],y:i.allpts[H+3]}):(P={x:i.allpts[q-2-H],y:i.allpts[q-1-H]},_={x:i.allpts[q-4-H],y:i.allpts[q-3-H]}),V=wo(P,_),L=O,O+=V,!(O>=y));H+=2);var W=y-L,G=W/V;G=Lc(0,G,1),e=_R(P,_,G),v=wS(P,_);break}}o("labelX",g,e.x),o("labelY",g,e.y),o("labelAutoAngle",g,v)}};u("source"),u("target"),this.applyLabelDimensions(r)}};Ji.applyLabelDimensions=function(r){this.applyPrefixedLabelDimensions(r),r.isEdge()&&(this.applyPrefixedLabelDimensions(r,"source"),this.applyPrefixedLabelDimensions(r,"target"))};Ji.applyPrefixedLabelDimensions=function(r,e){var n=r._private,i=this.getLabelText(r,e),a=bo(i,r._private.labelDimsKey);if(Un(n.rscratch,"prefixedLabelDimsKey",e)!==a){Ca(n.rscratch,"prefixedLabelDimsKey",e,a);var s=this.calculateLabelDimensions(r,i),o=r.pstyle("line-height").pfValue,l=r.pstyle("text-wrap").strValue,c=Un(n.rscratch,"labelWrapCachedLines",e)||[],u=l!=="wrap"?1:Math.max(c.length,1),h=s.height/u,g=h*o,v=s.width,m=s.height+(u-1)*(o-1)*h;Ca(n.rstyle,"labelWidth",e,v),Ca(n.rscratch,"labelWidth",e,v),Ca(n.rstyle,"labelHeight",e,m),Ca(n.rscratch,"labelHeight",e,m),Ca(n.rscratch,"labelLineHeight",e,g)}};Ji.getLabelText=function(r,e){var n=r._private,i=e?e+"-":"",a=r.pstyle(i+"label").strValue,s=r.pstyle("text-transform").value,o=function($,te){return te?(Ca(n.rscratch,$,e,te),te):Un(n.rscratch,$,e)};if(!a)return"";s=="none"||(s=="uppercase"?a=a.toUpperCase():s=="lowercase"&&(a=a.toLowerCase()));var l=r.pstyle("text-wrap").value;if(l==="wrap"){var c=o("labelKey");if(c!=null&&o("labelWrapKey")===c)return o("labelWrapCachedText");for(var u="​",h=a.split(`
`),g=r.pstyle("text-max-width").pfValue,v=r.pstyle("text-overflow-wrap").value,m=v==="anywhere",y=[],b=/[\s\u200b]+|$/g,x=0;x<h.length;x++){var A=h[x],C=this.calculateLabelDimensions(r,A),E=C.width;if(m){var S=A.split("").join(u);A=S}if(E>g){var M=A.matchAll(b),R="",T=0,B=On(M),F;try{for(B.s();!(F=B.n()).done;){var I=F.value,U=I[0],k=A.substring(T,I.index);T=I.index+U.length;var O=R.length===0?k:R+k+U,V=this.calculateLabelDimensions(r,O),L=V.width;L<=g?R+=k+U:(R&&y.push(R),R=k+U)}}catch(K){B.e(K)}finally{B.f()}R.match(/^[\s\u200b]+$/)||y.push(R)}else y.push(A)}o("labelWrapCachedLines",y),a=o("labelWrapCachedText",y.join(`
`)),o("labelWrapKey",c)}else if(l==="ellipsis"){var P=r.pstyle("text-max-width").pfValue,_="",q="…",H=!1;if(this.calculateLabelDimensions(r,a).width<P)return a;for(var W=0;W<a.length;W++){var G=this.calculateLabelDimensions(r,_+a[W]+q).width;if(G>P)break;_+=a[W],W===a.length-1&&(H=!0)}return H||(_+=q),_}return a};Ji.getLabelJustification=function(r){var e=r.pstyle("text-justification").strValue,n=r.pstyle("text-halign").strValue;if(e==="auto")if(r.isNode())switch(n){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};Ji.calculateLabelDimensions=function(r,e){var n=this,i=n.cy.window(),a=i.document,s=0,o=r.pstyle("font-style").strValue,l=r.pstyle("font-size").pfValue,c=r.pstyle("font-family").strValue,u=r.pstyle("font-weight").strValue,h=this.labelCalcCanvas,g=this.labelCalcCanvasContext;if(!h){h=this.labelCalcCanvas=a.createElement("canvas"),g=this.labelCalcCanvasContext=h.getContext("2d");var v=h.style;v.position="absolute",v.left="-9999px",v.top="-9999px",v.zIndex="-1",v.visibility="hidden",v.pointerEvents="none"}g.font="".concat(o," ").concat(u," ").concat(l,"px ").concat(c);for(var m=0,y=0,b=e.split(`
`),x=0;x<b.length;x++){var A=b[x],C=g.measureText(A),E=Math.ceil(C.width),S=l;m=Math.max(E,m),y+=S}return m+=s,y+=s,{width:m,height:y}};Ji.calculateLabelAngle=function(r,e){var n=r._private,i=n.rscratch,a=r.isEdge(),s=e?e+"-":"",o=r.pstyle(s+"text-rotation"),l=o.strValue;return l==="none"?0:a&&l==="autorotate"?i.labelAutoAngle:l==="autorotate"?0:o.pfValue};Ji.calculateLabelAngles=function(r){var e=this,n=r.isEdge(),i=r._private,a=i.rscratch;a.labelAngle=e.calculateLabelAngle(r),n&&(a.sourceLabelAngle=e.calculateLabelAngle(r,"source"),a.targetLabelAngle=e.calculateLabelAngle(r,"target"))};var CS={},_3=28,z3=!1;CS.getNodeShape=function(r){var e=this,n=r.pstyle("shape").value;if(n==="cutrectangle"&&(r.width()<_3||r.height()<_3))return z3||(Pt("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),z3=!0),"rectangle";if(r.isParent())return n==="rectangle"||n==="roundrectangle"||n==="round-rectangle"||n==="cutrectangle"||n==="cut-rectangle"||n==="barrel"?n:"rectangle";if(n==="polygon"){var i=r.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(i).name}return n};var O0={};O0.registerCalculationListeners=function(){var r=this.cy,e=r.collection(),n=this,i=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(o),l)for(var c=0;c<o.length;c++){var u=o[c],h=u._private,g=h.rstyle;g.clean=!1,g.cleanConnected=!1}};n.binder(r).on("bounds.* dirty.*",function(o){var l=o.target;i(l)}).on("style.* background.*",function(o){var l=o.target;i(l,!1)});var a=function(o){if(o){var l=n.onUpdateEleCalcsFns;e.cleanStyle();for(var c=0;c<e.length;c++){var u=e[c],h=u._private.rstyle;u.isNode()&&!h.cleanConnected&&(i(u.connectedEdges()),h.cleanConnected=!0)}if(l)for(var g=0;g<l.length;g++){var v=l[g];v(o,e)}n.recalculateRenderedStyle(e),e=r.collection()}};n.flushRenderedStyleQueue=function(){a(!0)},n.beforeRender(a,n.beforeRenderPriorities.eleCalcs)};O0.onUpdateEleCalcs=function(r){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(r)};O0.recalculateRenderedStyle=function(r,e){var n=function(S){return S._private.rstyle.cleanConnected};if(r.length!==0){var i=[],a=[];if(!this.destroyed){e===void 0&&(e=!0);for(var s=0;s<r.length;s++){var o=r[s],l=o._private,c=l.rstyle;o.isEdge()&&(!n(o.source())||!n(o.target()))&&(c.clean=!1),o.isEdge()&&o.isBundledBezier()&&o.parallelEdges().some(function(E){return!E._private.rstyle.clean&&E.isBundledBezier()})&&(c.clean=!1),!(e&&c.clean||o.removed())&&o.pstyle("display").value!=="none"&&(l.group==="nodes"?a.push(o):i.push(o),c.clean=!0)}for(var u=0;u<a.length;u++){var h=a[u],g=h._private,v=g.rstyle,m=h.position();this.recalculateNodeLabelProjection(h),v.nodeX=m.x,v.nodeY=m.y,v.nodeW=h.pstyle("width").pfValue,v.nodeH=h.pstyle("height").pfValue}this.recalculateEdgeProjections(i);for(var y=0;y<i.length;y++){var b=i[y],x=b._private,A=x.rstyle,C=x.rscratch;A.srcX=C.arrowStartX,A.srcY=C.arrowStartY,A.tgtX=C.arrowEndX,A.tgtY=C.arrowEndY,A.midX=C.midX,A.midY=C.midY,A.labelAngle=C.labelAngle,A.sourceLabelAngle=C.sourceLabelAngle,A.targetLabelAngle=C.targetLabelAngle}}}};var P0={};P0.updateCachedGrabbedEles=function(){var r=this.cachedZSortedEles;if(r){r.drag=[],r.nondrag=[];for(var e=[],n=0;n<r.length;n++){var i=r[n],a=i._private.rscratch;i.grabbed()&&!i.isParent()?e.push(i):a.inDragLayer?r.drag.push(i):r.nondrag.push(i)}for(var n=0;n<e.length;n++){var i=e[n];r.drag.push(i)}}};P0.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};P0.getCachedZSortedEles=function(r){if(r||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(iS),e.interactive=e.filter(function(n){return n.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var ES={};[Bo,r0,mn,ff,_2,Ji,CS,O0,P0].forEach(function(r){et(ES,r)});var SS={};SS.getCachedImage=function(r,e,n){var i=this,a=i.imageCache=i.imageCache||{},s=a[r];if(s)return s.image.complete||s.image.addEventListener("load",n),s.image;s=a[r]=a[r]||{};var o=s.image=new Image;o.addEventListener("load",n),o.addEventListener("error",function(){o.error=!0});var l="data:",c=r.substring(0,l.length).toLowerCase()===l;return c||(e=e==="null"?null:e,o.crossOrigin=e),o.src=r,o};var Jl={};Jl.registerBinding=function(r,e,n,i){var a=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(r)){for(var s=[],o=0;o<r.length;o++){var l=r[o];if(l!==void 0){var c=this.binder(l);s.push(c.on.apply(c,a))}}return s}var c=this.binder(r);return c.on.apply(c,a)};Jl.binder=function(r){var e=this,n=e.cy.window(),i=r===n||r===n.document||r===n.document.body||B8(r);if(e.supportsPassiveEvents==null){var a=!1;try{var s=Object.defineProperty({},"passive",{get:function(){return a=!0,!0}});n.addEventListener("test",null,s)}catch{}e.supportsPassiveEvents=a}var o=function(c,u,h){var g=Array.prototype.slice.call(arguments);return i&&e.supportsPassiveEvents&&(g[2]={capture:h??!1,passive:!1,once:!1}),e.bindings.push({target:r,args:g}),(r.addEventListener||r.on).apply(r,g),this};return{on:o,addEventListener:o,addListener:o,bind:o}};Jl.nodeIsDraggable=function(r){return r&&r.isNode()&&!r.locked()&&r.grabbable()};Jl.nodeIsGrabbable=function(r){return this.nodeIsDraggable(r)&&r.interactive()};Jl.load=function(){var r=this,e=r.cy.window(),n=function(X){return X.selected()},i=function(X){var ce=X.getRootNode();if(ce&&ce.nodeType===11&&ce.host!==void 0)return ce},a=function(X,ce,pe,me){X==null&&(X=r.cy);for(var we=0;we<ce.length;we++){var Ve=ce[we];X.emit({originalEvent:pe,type:Ve,position:me})}},s=function(X){return X.shiftKey||X.metaKey||X.ctrlKey},o=function(X,ce){var pe=!0;if(r.cy.hasCompoundNodes()&&X&&X.pannable())for(var me=0;ce&&me<ce.length;me++){var X=ce[me];if(X.isNode()&&X.isParent()&&!X.pannable()){pe=!1;break}}else pe=!0;return pe},l=function(X){X[0]._private.grabbed=!0},c=function(X){X[0]._private.grabbed=!1},u=function(X){X[0]._private.rscratch.inDragLayer=!0},h=function(X){X[0]._private.rscratch.inDragLayer=!1},g=function(X){X[0]._private.rscratch.isGrabTarget=!0},v=function(X){X[0]._private.rscratch.isGrabTarget=!1},m=function(X,ce){var pe=ce.addToList,me=pe.has(X);!me&&X.grabbable()&&!X.locked()&&(pe.merge(X),l(X))},y=function(X,ce){if(X.cy().hasCompoundNodes()&&!(ce.inDragLayer==null&&ce.addToList==null)){var pe=X.descendants();ce.inDragLayer&&(pe.forEach(u),pe.connectedEdges().forEach(u)),ce.addToList&&m(pe,ce)}},b=function(X,ce){ce=ce||{};var pe=X.cy().hasCompoundNodes();ce.inDragLayer&&(X.forEach(u),X.neighborhood().stdFilter(function(me){return!pe||me.isEdge()}).forEach(u)),ce.addToList&&X.forEach(function(me){m(me,ce)}),y(X,ce),C(X,{inDragLayer:ce.inDragLayer}),r.updateCachedGrabbedEles()},x=b,A=function(X){X&&(r.getCachedZSortedEles().forEach(function(ce){c(ce),h(ce),v(ce)}),r.updateCachedGrabbedEles())},C=function(X,ce){if(!(ce.inDragLayer==null&&ce.addToList==null)&&X.cy().hasCompoundNodes()){var pe=X.ancestors().orphans();if(!pe.same(X)){var me=pe.descendants().spawnSelf().merge(pe).unmerge(X).unmerge(X.descendants()),we=me.connectedEdges();ce.inDragLayer&&(we.forEach(u),me.forEach(u)),ce.addToList&&me.forEach(function(Ve){m(Ve,ce)})}}},E=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},S=typeof MutationObserver<"u",M=typeof ResizeObserver<"u";S?(r.removeObserver=new MutationObserver(function(be){for(var X=0;X<be.length;X++){var ce=be[X],pe=ce.removedNodes;if(pe)for(var me=0;me<pe.length;me++){var we=pe[me];if(we===r.container){r.destroy();break}}}}),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",function(be){r.destroy()});var R=of(function(){r.cy.resize()},100);S&&(r.styleObserver=new MutationObserver(R),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(e,"resize",R),M&&(r.resizeObserver=new ResizeObserver(R),r.resizeObserver.observe(r.container));var T=function(X,ce){for(;X!=null;)ce(X),X=X.parentNode},B=function(){r.invalidateContainerClientCoordsCache()};T(r.container,function(be){r.registerBinding(be,"transitionend",B),r.registerBinding(be,"animationend",B),r.registerBinding(be,"scroll",B)}),r.registerBinding(r.container,"contextmenu",function(be){be.preventDefault()});var F=function(){return r.selection[4]!==0},I=function(X){for(var ce=r.findContainerClientCoords(),pe=ce[0],me=ce[1],we=ce[2],Ve=ce[3],Se=X.touches?X.touches:[X],Ge=!1,Ue=0;Ue<Se.length;Ue++){var Qe=Se[Ue];if(pe<=Qe.clientX&&Qe.clientX<=pe+we&&me<=Qe.clientY&&Qe.clientY<=me+Ve){Ge=!0;break}}if(!Ge)return!1;for(var st=r.container,ot=X.target,Le=ot.parentNode,vt=!1;Le;){if(Le===st){vt=!0;break}Le=Le.parentNode}return!!vt};r.registerBinding(r.container,"mousedown",function(X){if(I(X)&&!(r.hoverData.which===1&&X.which!==1)){X.preventDefault(),E(),r.hoverData.capture=!0,r.hoverData.which=X.which;var ce=r.cy,pe=[X.clientX,X.clientY],me=r.projectIntoViewport(pe[0],pe[1]),we=r.selection,Ve=r.findNearestElements(me[0],me[1],!0,!1),Se=Ve[0],Ge=r.dragData.possibleDragElements;r.hoverData.mdownPos=me,r.hoverData.mdownGPos=pe;var Ue=function(ht){return{originalEvent:X,type:ht,position:{x:me[0],y:me[1]}}},Qe=function(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout(function(){if(!r.hoverData.tapholdCancelled){var ht=r.hoverData.down;ht?ht.emit(Ue("taphold")):ce.emit(Ue("taphold"))}},r.tapholdDuration)};if(X.which==3){r.hoverData.cxtStarted=!0;var st={originalEvent:X,type:"cxttapstart",position:{x:me[0],y:me[1]}};Se?(Se.activate(),Se.emit(st),r.hoverData.down=Se):ce.emit(st),r.hoverData.downTime=new Date().getTime(),r.hoverData.cxtDragged=!1}else if(X.which==1){Se&&Se.activate();{if(Se!=null&&r.nodeIsGrabbable(Se)){var ot=function(ht){ht.emit(Ue("grab"))};if(g(Se),!Se.selected())Ge=r.dragData.possibleDragElements=ce.collection(),x(Se,{addToList:Ge}),Se.emit(Ue("grabon")).emit(Ue("grab"));else{Ge=r.dragData.possibleDragElements=ce.collection();var Le=ce.$(function(vt){return vt.isNode()&&vt.selected()&&r.nodeIsGrabbable(vt)});b(Le,{addToList:Ge}),Se.emit(Ue("grabon")),Le.forEach(ot)}r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=Se,r.hoverData.downs=Ve,r.hoverData.downTime=new Date().getTime()}a(Se,["mousedown","tapstart","vmousedown"],X,{x:me[0],y:me[1]}),Se==null?(we[4]=1,r.data.bgActivePosistion={x:me[0],y:me[1]},r.redrawHint("select",!0),r.redraw()):Se.pannable()&&(we[4]=1),Qe()}we[0]=we[2]=me[0],we[1]=we[3]=me[1]}},!1);var U=i(r.container);r.registerBinding([e,U],"mousemove",function(X){var ce=r.hoverData.capture;if(!(!ce&&!I(X))){var pe=!1,me=r.cy,we=me.zoom(),Ve=[X.clientX,X.clientY],Se=r.projectIntoViewport(Ve[0],Ve[1]),Ge=r.hoverData.mdownPos,Ue=r.hoverData.mdownGPos,Qe=r.selection,st=null;!r.hoverData.draggingEles&&!r.hoverData.dragging&&!r.hoverData.selecting&&(st=r.findNearestElement(Se[0],Se[1],!0,!1));var ot=r.hoverData.last,Le=r.hoverData.down,vt=[Se[0]-Qe[2],Se[1]-Qe[3]],ht=r.dragData.possibleDragElements,fr;if(Ue){var zt=Ve[0]-Ue[0],Jr=zt*zt,hr=Ve[1]-Ue[1],xr=hr*hr,vr=Jr+xr;r.hoverData.isOverThresholdDrag=fr=vr>=r.desktopTapThreshold2}var br=s(X);fr&&(r.hoverData.tapholdCancelled=!0);var ei=function(){var Gr=r.hoverData.dragDelta=r.hoverData.dragDelta||[];Gr.length===0?(Gr.push(vt[0]),Gr.push(vt[1])):(Gr[0]+=vt[0],Gr[1]+=vt[1])};pe=!0,a(st,["mousemove","vmousemove","tapdrag"],X,{x:Se[0],y:Se[1]});var dr=function(Gr){return{originalEvent:X,type:Gr,position:{x:Se[0],y:Se[1]}}},ti=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||me.emit(dr("boxstart")),Qe[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(r.hoverData.which===3){if(fr){var Lr=dr("cxtdrag");Le?Le.emit(Lr):me.emit(Lr),r.hoverData.cxtDragged=!0,(!r.hoverData.cxtOver||st!==r.hoverData.cxtOver)&&(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit(dr("cxtdragout")),r.hoverData.cxtOver=st,st&&st.emit(dr("cxtdragover")))}}else if(r.hoverData.dragging){if(pe=!0,me.panningEnabled()&&me.userPanningEnabled()){var ar;if(r.hoverData.justStartedPan){var Nr=r.hoverData.mdownPos;ar={x:(Se[0]-Nr[0])*we,y:(Se[1]-Nr[1])*we},r.hoverData.justStartedPan=!1}else ar={x:vt[0]*we,y:vt[1]*we};me.panBy(ar),me.emit(dr("dragpan")),r.hoverData.dragged=!0}Se=r.projectIntoViewport(X.clientX,X.clientY)}else if(Qe[4]==1&&(Le==null||Le.pannable())){if(fr){if(!r.hoverData.dragging&&me.boxSelectionEnabled()&&(br||!me.panningEnabled()||!me.userPanningEnabled()))ti();else if(!r.hoverData.selecting&&me.panningEnabled()&&me.userPanningEnabled()){var Sn=o(Le,r.hoverData.downs);Sn&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,Qe[4]=0,r.data.bgActivePosistion=Nl(Ge),r.redrawHint("select",!0),r.redraw())}Le&&Le.pannable()&&Le.active()&&Le.unactivate()}}else{if(Le&&Le.pannable()&&Le.active()&&Le.unactivate(),(!Le||!Le.grabbed())&&st!=ot&&(ot&&a(ot,["mouseout","tapdragout"],X,{x:Se[0],y:Se[1]}),st&&a(st,["mouseover","tapdragover"],X,{x:Se[0],y:Se[1]}),r.hoverData.last=st),Le)if(fr){if(me.boxSelectionEnabled()&&br)Le&&Le.grabbed()&&(A(ht),Le.emit(dr("freeon")),ht.emit(dr("free")),r.dragData.didDrag&&(Le.emit(dr("dragfreeon")),ht.emit(dr("dragfree")))),ti();else if(Le&&Le.grabbed()&&r.nodeIsDraggable(Le)){var _r=!r.dragData.didDrag;_r&&r.redrawHint("eles",!0),r.dragData.didDrag=!0,r.hoverData.draggingEles||b(ht,{inDragLayer:!0});var zr={x:0,y:0};if(Be(vt[0])&&Be(vt[1])&&(zr.x+=vt[0],zr.y+=vt[1],_r)){var cn=r.hoverData.dragDelta;cn&&Be(cn[0])&&Be(cn[1])&&(zr.x+=cn[0],zr.y+=cn[1])}r.hoverData.draggingEles=!0,ht.silentShift(zr).emit(dr("position")).emit(dr("drag")),r.redrawHint("drag",!0),r.redraw()}}else ei();pe=!0}if(Qe[2]=Se[0],Qe[3]=Se[1],pe)return X.stopPropagation&&X.stopPropagation(),X.preventDefault&&X.preventDefault(),!1}},!1);var k,O,V;r.registerBinding(e,"mouseup",function(X){if(!(r.hoverData.which===1&&X.which!==1&&r.hoverData.capture)){var ce=r.hoverData.capture;if(ce){r.hoverData.capture=!1;var pe=r.cy,me=r.projectIntoViewport(X.clientX,X.clientY),we=r.selection,Ve=r.findNearestElement(me[0],me[1],!0,!1),Se=r.dragData.possibleDragElements,Ge=r.hoverData.down,Ue=s(X);r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,Ge&&Ge.unactivate();var Qe=function(zt){return{originalEvent:X,type:zt,position:{x:me[0],y:me[1]}}};if(r.hoverData.which===3){var st=Qe("cxttapend");if(Ge?Ge.emit(st):pe.emit(st),!r.hoverData.cxtDragged){var ot=Qe("cxttap");Ge?Ge.emit(ot):pe.emit(ot)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(r.hoverData.which===1){if(a(Ve,["mouseup","tapend","vmouseup"],X,{x:me[0],y:me[1]}),!r.dragData.didDrag&&!r.hoverData.dragged&&!r.hoverData.selecting&&!r.hoverData.isOverThresholdDrag&&(a(Ge,["click","tap","vclick"],X,{x:me[0],y:me[1]}),O=!1,X.timeStamp-V<=pe.multiClickDebounceTime()?(k&&clearTimeout(k),O=!0,V=null,a(Ge,["dblclick","dbltap","vdblclick"],X,{x:me[0],y:me[1]})):(k=setTimeout(function(){O||a(Ge,["oneclick","onetap","voneclick"],X,{x:me[0],y:me[1]})},pe.multiClickDebounceTime()),V=X.timeStamp)),Ge==null&&!r.dragData.didDrag&&!r.hoverData.selecting&&!r.hoverData.dragged&&!s(X)&&(pe.$(n).unselect(["tapunselect"]),Se.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=Se=pe.collection()),Ve==Ge&&!r.dragData.didDrag&&!r.hoverData.selecting&&Ve!=null&&Ve._private.selectable&&(r.hoverData.dragging||(pe.selectionType()==="additive"||Ue?Ve.selected()?Ve.unselect(["tapunselect"]):Ve.select(["tapselect"]):Ue||(pe.$(n).unmerge(Ve).unselect(["tapunselect"]),Ve.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var Le=pe.collection(r.getAllInBox(we[0],we[1],we[2],we[3]));r.redrawHint("select",!0),Le.length>0&&r.redrawHint("eles",!0),pe.emit(Qe("boxend"));var vt=function(zt){return zt.selectable()&&!zt.selected()};pe.selectionType()==="additive"||Ue||pe.$(n).unmerge(Le).unselect(),Le.emit(Qe("box")).stdFilter(vt).select().emit(Qe("boxselect")),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!we[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var ht=Ge&&Ge.grabbed();A(Se),ht&&(Ge.emit(Qe("freeon")),Se.emit(Qe("free")),r.dragData.didDrag&&(Ge.emit(Qe("dragfreeon")),Se.emit(Qe("dragfree"))))}}we[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null,r.hoverData.which=null}}},!1);var L=[],P=4,_,q=1e5,H=function(X,ce){for(var pe=0;pe<X.length;pe++)if(X[pe]%ce!==0)return!1;return!0},W=function(X){for(var ce=Math.abs(X[0]),pe=1;pe<X.length;pe++)if(Math.abs(X[pe])!==ce)return!1;return!0},G=function(X){var ce=!1,pe=X.deltaY;if(pe==null&&(X.wheelDeltaY!=null?pe=X.wheelDeltaY/4:X.wheelDelta!=null&&(pe=X.wheelDelta/4)),pe!==0){if(_==null)if(L.length>=P){var me=L;if(_=H(me,5),!_){var we=Math.abs(me[0]);_=W(me)&&we>5}if(_)for(var Ve=0;Ve<me.length;Ve++)q=Math.min(Math.abs(me[Ve]),q)}else L.push(pe),ce=!0;else _&&(q=Math.min(Math.abs(pe),q));if(!r.scrollingPage){var Se=r.cy,Ge=Se.zoom(),Ue=Se.pan(),Qe=r.projectIntoViewport(X.clientX,X.clientY),st=[Qe[0]*Ge+Ue.x,Qe[1]*Ge+Ue.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||F()){X.preventDefault();return}if(Se.panningEnabled()&&Se.userPanningEnabled()&&Se.zoomingEnabled()&&Se.userZoomingEnabled()){X.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout(function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()},150);var ot;ce&&Math.abs(pe)>5&&(pe=T2(pe)*5),ot=pe/-250,_&&(ot/=q,ot*=3),ot=ot*r.wheelSensitivity;var Le=X.deltaMode===1;Le&&(ot*=33);var vt=Se.zoom()*Math.pow(10,ot);X.type==="gesturechange"&&(vt=r.gestureStartZoom*X.scale),Se.zoom({level:vt,renderedPosition:{x:st[0],y:st[1]}}),Se.emit({type:X.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:X,position:{x:Qe[0],y:Qe[1]}})}}}};r.registerBinding(r.container,"wheel",G,!0),r.registerBinding(e,"scroll",function(X){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout(function(){r.scrollingPage=!1},250)},!0),r.registerBinding(r.container,"gesturestart",function(X){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||X.preventDefault()},!0),r.registerBinding(r.container,"gesturechange",function(be){r.hasTouchStarted||G(be)},!0),r.registerBinding(r.container,"mouseout",function(X){var ce=r.projectIntoViewport(X.clientX,X.clientY);r.cy.emit({originalEvent:X,type:"mouseout",position:{x:ce[0],y:ce[1]}})},!1),r.registerBinding(r.container,"mouseover",function(X){var ce=r.projectIntoViewport(X.clientX,X.clientY);r.cy.emit({originalEvent:X,type:"mouseover",position:{x:ce[0],y:ce[1]}})},!1);var K,$,te,ae,ue,re,ve,le,ie,se,fe,xe,De,ze=function(X,ce,pe,me){return Math.sqrt((pe-X)*(pe-X)+(me-ce)*(me-ce))},gt=function(X,ce,pe,me){return(pe-X)*(pe-X)+(me-ce)*(me-ce)},it;r.registerBinding(r.container,"touchstart",it=function(X){if(r.hasTouchStarted=!0,!!I(X)){E(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var ce=r.cy,pe=r.touchData.now,me=r.touchData.earlier;if(X.touches[0]){var we=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);pe[0]=we[0],pe[1]=we[1]}if(X.touches[1]){var we=r.projectIntoViewport(X.touches[1].clientX,X.touches[1].clientY);pe[2]=we[0],pe[3]=we[1]}if(X.touches[2]){var we=r.projectIntoViewport(X.touches[2].clientX,X.touches[2].clientY);pe[4]=we[0],pe[5]=we[1]}var Ve=function(br){return{originalEvent:X,type:br,position:{x:pe[0],y:pe[1]}}};if(X.touches[1]){r.touchData.singleTouchMoved=!0,A(r.dragData.touchDragEles);var Se=r.findContainerClientCoords();ie=Se[0],se=Se[1],fe=Se[2],xe=Se[3],K=X.touches[0].clientX-ie,$=X.touches[0].clientY-se,te=X.touches[1].clientX-ie,ae=X.touches[1].clientY-se,De=0<=K&&K<=fe&&0<=te&&te<=fe&&0<=$&&$<=xe&&0<=ae&&ae<=xe;var Ge=ce.pan(),Ue=ce.zoom();ue=ze(K,$,te,ae),re=gt(K,$,te,ae),ve=[(K+te)/2,($+ae)/2],le=[(ve[0]-Ge.x)/Ue,(ve[1]-Ge.y)/Ue];var Qe=200,st=Qe*Qe;if(re<st&&!X.touches[2]){var ot=r.findNearestElement(pe[0],pe[1],!0,!0),Le=r.findNearestElement(pe[2],pe[3],!0,!0);ot&&ot.isNode()?(ot.activate().emit(Ve("cxttapstart")),r.touchData.start=ot):Le&&Le.isNode()?(Le.activate().emit(Ve("cxttapstart")),r.touchData.start=Le):ce.emit(Ve("cxttapstart")),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,r.redraw();return}}if(X.touches[2])ce.boxSelectionEnabled()&&X.preventDefault();else if(!X.touches[1]){if(X.touches[0]){var vt=r.findNearestElements(pe[0],pe[1],!0,!0),ht=vt[0];if(ht!=null&&(ht.activate(),r.touchData.start=ht,r.touchData.starts=vt,r.nodeIsGrabbable(ht))){var fr=r.dragData.touchDragEles=ce.collection(),zt=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),ht.selected()?(zt=ce.$(function(vr){return vr.selected()&&r.nodeIsGrabbable(vr)}),b(zt,{addToList:fr})):x(ht,{addToList:fr}),g(ht),ht.emit(Ve("grabon")),zt?zt.forEach(function(vr){vr.emit(Ve("grab"))}):ht.emit(Ve("grab"))}a(ht,["touchstart","tapstart","vmousedown"],X,{x:pe[0],y:pe[1]}),ht==null&&(r.data.bgActivePosistion={x:we[0],y:we[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout(function(){r.touchData.singleTouchMoved===!1&&!r.pinching&&!r.touchData.selecting&&a(r.touchData.start,["taphold"],X,{x:pe[0],y:pe[1]})},r.tapholdDuration)}}if(X.touches.length>=1){for(var Jr=r.touchData.startPosition=[null,null,null,null,null,null],hr=0;hr<pe.length;hr++)Jr[hr]=me[hr]=pe[hr];var xr=X.touches[0];r.touchData.startGPosition=[xr.clientX,xr.clientY]}}},!1);var $e;r.registerBinding(e,"touchmove",$e=function(X){var ce=r.touchData.capture;if(!(!ce&&!I(X))){var pe=r.selection,me=r.cy,we=r.touchData.now,Ve=r.touchData.earlier,Se=me.zoom();if(X.touches[0]){var Ge=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);we[0]=Ge[0],we[1]=Ge[1]}if(X.touches[1]){var Ge=r.projectIntoViewport(X.touches[1].clientX,X.touches[1].clientY);we[2]=Ge[0],we[3]=Ge[1]}if(X.touches[2]){var Ge=r.projectIntoViewport(X.touches[2].clientX,X.touches[2].clientY);we[4]=Ge[0],we[5]=Ge[1]}var Ue=function(Df){return{originalEvent:X,type:Df,position:{x:we[0],y:we[1]}}},Qe=r.touchData.startGPosition,st;if(ce&&X.touches[0]&&Qe){for(var ot=[],Le=0;Le<we.length;Le++)ot[Le]=we[Le]-Ve[Le];var vt=X.touches[0].clientX-Qe[0],ht=vt*vt,fr=X.touches[0].clientY-Qe[1],zt=fr*fr,Jr=ht+zt;st=Jr>=r.touchTapThreshold2}if(ce&&r.touchData.cxt){X.preventDefault();var hr=X.touches[0].clientX-ie,xr=X.touches[0].clientY-se,vr=X.touches[1].clientX-ie,br=X.touches[1].clientY-se,ei=gt(hr,xr,vr,br),dr=ei/re,ti=150,Lr=ti*ti,ar=1.5,Nr=ar*ar;if(dr>=Nr||ei>=Lr){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Sn=Ue("cxttapend");r.touchData.start?(r.touchData.start.unactivate().emit(Sn),r.touchData.start=null):me.emit(Sn)}}if(ce&&r.touchData.cxt){var Sn=Ue("cxtdrag");r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(Sn):me.emit(Sn),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var _r=r.findNearestElement(we[0],we[1],!0,!0);(!r.touchData.cxtOver||_r!==r.touchData.cxtOver)&&(r.touchData.cxtOver&&r.touchData.cxtOver.emit(Ue("cxtdragout")),r.touchData.cxtOver=_r,_r&&_r.emit(Ue("cxtdragover")))}else if(ce&&X.touches[2]&&me.boxSelectionEnabled())X.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||me.emit(Ue("boxstart")),r.touchData.selecting=!0,r.touchData.didSelect=!0,pe[4]=1,!pe||pe.length===0||pe[0]===void 0?(pe[0]=(we[0]+we[2]+we[4])/3,pe[1]=(we[1]+we[3]+we[5])/3,pe[2]=(we[0]+we[2]+we[4])/3+1,pe[3]=(we[1]+we[3]+we[5])/3+1):(pe[2]=(we[0]+we[2]+we[4])/3,pe[3]=(we[1]+we[3]+we[5])/3),r.redrawHint("select",!0),r.redraw();else if(ce&&X.touches[1]&&!r.touchData.didSelect&&me.zoomingEnabled()&&me.panningEnabled()&&me.userZoomingEnabled()&&me.userPanningEnabled()){X.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var zr=r.dragData.touchDragEles;if(zr){r.redrawHint("drag",!0);for(var cn=0;cn<zr.length;cn++){var ka=zr[cn]._private;ka.grabbed=!1,ka.rscratch.inDragLayer=!1}}var Gr=r.touchData.start,hr=X.touches[0].clientX-ie,xr=X.touches[0].clientY-se,vr=X.touches[1].clientX-ie,br=X.touches[1].clientY-se,Fo=ze(hr,xr,vr,br),Ua=Fo/ue;if(De){var Va=hr-K,Ps=xr-$,Oa=vr-te,Sr=br-ae,Sf=(Va+Oa)/2,Tf=(Ps+Sr)/2,_n=me.zoom(),Ui=_n*Ua,ko=me.pan(),eu=le[0]*_n+ko.x,tu=le[1]*_n+ko.y,J0={x:-Ui/_n*(eu-ko.x-Sf)+eu,y:-Ui/_n*(tu-ko.y-Tf)+tu};if(Gr&&Gr.active()){var zr=r.dragData.touchDragEles;A(zr),r.redrawHint("drag",!0),r.redrawHint("eles",!0),Gr.unactivate().emit(Ue("freeon")),zr.emit(Ue("free")),r.dragData.didDrag&&(Gr.emit(Ue("dragfreeon")),zr.emit(Ue("dragfree")))}me.viewport({zoom:Ui,pan:J0,cancelOnFailedZoom:!0}),me.emit(Ue("pinchzoom")),ue=Fo,K=hr,$=xr,te=vr,ae=br,r.pinching=!0}if(X.touches[0]){var Ge=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);we[0]=Ge[0],we[1]=Ge[1]}if(X.touches[1]){var Ge=r.projectIntoViewport(X.touches[1].clientX,X.touches[1].clientY);we[2]=Ge[0],we[3]=Ge[1]}if(X.touches[2]){var Ge=r.projectIntoViewport(X.touches[2].clientX,X.touches[2].clientY);we[4]=Ge[0],we[5]=Ge[1]}}else if(X.touches[0]&&!r.touchData.didSelect){var fn=r.touchData.start,Pa=r.touchData.last,_r;if(!r.hoverData.draggingEles&&!r.swipePanning&&(_r=r.findNearestElement(we[0],we[1],!0,!0)),ce&&fn!=null&&X.preventDefault(),ce&&fn!=null&&r.nodeIsDraggable(fn))if(st){var zr=r.dragData.touchDragEles,ri=!r.dragData.didDrag;ri&&b(zr,{inDragLayer:!0}),r.dragData.didDrag=!0;var qr={x:0,y:0};if(Be(ot[0])&&Be(ot[1])&&(qr.x+=ot[0],qr.y+=ot[1],ri)){r.redrawHint("eles",!0);var Tn=r.touchData.dragDelta;Tn&&Be(Tn[0])&&Be(Tn[1])&&(qr.x+=Tn[0],qr.y+=Tn[1])}r.hoverData.draggingEles=!0,zr.silentShift(qr).emit(Ue("position")).emit(Ue("drag")),r.redrawHint("drag",!0),r.touchData.startPosition[0]==Ve[0]&&r.touchData.startPosition[1]==Ve[1]&&r.redrawHint("eles",!0),r.redraw()}else{var Tn=r.touchData.dragDelta=r.touchData.dragDelta||[];Tn.length===0?(Tn.push(ot[0]),Tn.push(ot[1])):(Tn[0]+=ot[0],Tn[1]+=ot[1])}if(a(fn||_r,["touchmove","tapdrag","vmousemove"],X,{x:we[0],y:we[1]}),(!fn||!fn.grabbed())&&_r!=Pa&&(Pa&&Pa.emit(Ue("tapdragout")),_r&&_r.emit(Ue("tapdragover"))),r.touchData.last=_r,ce)for(var cn=0;cn<we.length;cn++)we[cn]&&r.touchData.startPosition[cn]&&st&&(r.touchData.singleTouchMoved=!0);if(ce&&(fn==null||fn.pannable())&&me.panningEnabled()&&me.userPanningEnabled()){var $0=o(fn,r.touchData.starts);$0&&(X.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=Nl(r.touchData.startPosition)),r.swipePanning?(me.panBy({x:ot[0]*Se,y:ot[1]*Se}),me.emit(Ue("dragpan"))):st&&(r.swipePanning=!0,me.panBy({x:vt*Se,y:fr*Se}),me.emit(Ue("dragpan")),fn&&(fn.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));var Ge=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);we[0]=Ge[0],we[1]=Ge[1]}}for(var Le=0;Le<we.length;Le++)Ve[Le]=we[Le];ce&&X.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&r.data.bgActivePosistion!=null&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1);var Xe;r.registerBinding(e,"touchcancel",Xe=function(X){var ce=r.touchData.start;r.touchData.capture=!1,ce&&ce.unactivate()});var Ie,Ye,Ke,at;if(r.registerBinding(e,"touchend",Ie=function(X){var ce=r.touchData.start,pe=r.touchData.capture;if(pe)X.touches.length===0&&(r.touchData.capture=!1),X.preventDefault();else return;var me=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var we=r.cy,Ve=we.zoom(),Se=r.touchData.now,Ge=r.touchData.earlier;if(X.touches[0]){var Ue=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);Se[0]=Ue[0],Se[1]=Ue[1]}if(X.touches[1]){var Ue=r.projectIntoViewport(X.touches[1].clientX,X.touches[1].clientY);Se[2]=Ue[0],Se[3]=Ue[1]}if(X.touches[2]){var Ue=r.projectIntoViewport(X.touches[2].clientX,X.touches[2].clientY);Se[4]=Ue[0],Se[5]=Ue[1]}var Qe=function(Lr){return{originalEvent:X,type:Lr,position:{x:Se[0],y:Se[1]}}};ce&&ce.unactivate();var st;if(r.touchData.cxt){if(st=Qe("cxttapend"),ce?ce.emit(st):we.emit(st),!r.touchData.cxtDragged){var ot=Qe("cxttap");ce?ce.emit(ot):we.emit(ot)}r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,r.redraw();return}if(!X.touches[2]&&we.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var Le=we.collection(r.getAllInBox(me[0],me[1],me[2],me[3]));me[0]=void 0,me[1]=void 0,me[2]=void 0,me[3]=void 0,me[4]=0,r.redrawHint("select",!0),we.emit(Qe("boxend"));var vt=function(Lr){return Lr.selectable()&&!Lr.selected()};Le.emit(Qe("box")).stdFilter(vt).select().emit(Qe("boxselect")),Le.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(ce?.unactivate(),X.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(!X.touches[1]){if(!X.touches[0]){if(!X.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var ht=r.dragData.touchDragEles;if(ce!=null){var fr=ce._private.grabbed;A(ht),r.redrawHint("drag",!0),r.redrawHint("eles",!0),fr&&(ce.emit(Qe("freeon")),ht.emit(Qe("free")),r.dragData.didDrag&&(ce.emit(Qe("dragfreeon")),ht.emit(Qe("dragfree")))),a(ce,["touchend","tapend","vmouseup","tapdragout"],X,{x:Se[0],y:Se[1]}),ce.unactivate(),r.touchData.start=null}else{var zt=r.findNearestElement(Se[0],Se[1],!0,!0);a(zt,["touchend","tapend","vmouseup","tapdragout"],X,{x:Se[0],y:Se[1]})}var Jr=r.touchData.startPosition[0]-Se[0],hr=Jr*Jr,xr=r.touchData.startPosition[1]-Se[1],vr=xr*xr,br=hr+vr,ei=br*Ve*Ve;r.touchData.singleTouchMoved||(ce||we.$(":selected").unselect(["tapunselect"]),a(ce,["tap","vclick"],X,{x:Se[0],y:Se[1]}),Ye=!1,X.timeStamp-at<=we.multiClickDebounceTime()?(Ke&&clearTimeout(Ke),Ye=!0,at=null,a(ce,["dbltap","vdblclick"],X,{x:Se[0],y:Se[1]})):(Ke=setTimeout(function(){Ye||a(ce,["onetap","voneclick"],X,{x:Se[0],y:Se[1]})},we.multiClickDebounceTime()),at=X.timeStamp)),ce!=null&&!r.dragData.didDrag&&ce._private.selectable&&ei<r.touchTapThreshold2&&!r.pinching&&(we.selectionType()==="single"?(we.$(n).unmerge(ce).unselect(["tapunselect"]),ce.select(["tapselect"])):ce.selected()?ce.unselect(["tapunselect"]):ce.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}}}for(var dr=0;dr<Se.length;dr++)Ge[dr]=Se[dr];r.dragData.didDrag=!1,X.touches.length===0&&(r.touchData.dragDelta=[],r.touchData.startPosition=[null,null,null,null,null,null],r.touchData.startGPosition=null,r.touchData.didSelect=!1),X.touches.length<2&&(X.touches.length===1&&(r.touchData.startGPosition=[X.touches[0].clientX,X.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())},!1),typeof TouchEvent>"u"){var ke=[],ft=function(X){return{clientX:X.clientX,clientY:X.clientY,force:1,identifier:X.pointerId,pageX:X.pageX,pageY:X.pageY,radiusX:X.width/2,radiusY:X.height/2,screenX:X.screenX,screenY:X.screenY,target:X.target}},pt=function(X){return{event:X,touch:ft(X)}},Tt=function(X){ke.push(pt(X))},Et=function(X){for(var ce=0;ce<ke.length;ce++){var pe=ke[ce];if(pe.event.pointerId===X.pointerId){ke.splice(ce,1);return}}},Rt=function(X){var ce=ke.filter(function(pe){return pe.event.pointerId===X.pointerId})[0];ce.event=X,ce.touch=ft(X)},nt=function(X){X.touches=ke.map(function(ce){return ce.touch})},Oe=function(X){return X.pointerType==="mouse"||X.pointerType===4};r.registerBinding(r.container,"pointerdown",function(be){Oe(be)||(be.preventDefault(),Tt(be),nt(be),it(be))}),r.registerBinding(r.container,"pointerup",function(be){Oe(be)||(Et(be),nt(be),Ie(be))}),r.registerBinding(r.container,"pointercancel",function(be){Oe(be)||(Et(be),nt(be),Xe(be))}),r.registerBinding(r.container,"pointermove",function(be){Oe(be)||(be.preventDefault(),Rt(be),nt(be),$e(be))})}};var Na={};Na.generatePolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,draw:function(i,a,s,o,l,c){this.renderer.nodeShapeImpl("polygon",i,a,s,o,l,this.points)},intersectLine:function(i,a,s,o,l,c,u,h){return _c(l,c,this.points,i,a,s/2,o/2,u)},checkPoint:function(i,a,s,o,l,c,u,h){return Ba(i,a,this.points,c,u,o,l,[0,-1],s)},hasMiterBounds:r!=="rectangle",miterBounds:function(i,a,s,o,l,c){return HR(this.points,i,a,s,o,l)}}};Na.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s)},intersectLine:function(e,n,i,a,s,o,l,c){return eB(s,o,e,n,i/2+l,a/2+l)},checkPoint:function(e,n,i,a,s,o,l,c){return go(e,n,a,s,o,l,i)}}};Na.generateRoundPolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,getOrCreateCorners:function(i,a,s,o,l,c,u){if(c[u]!==void 0&&c[u+"-cx"]===i&&c[u+"-cy"]===a)return c[u];c[u]=new Array(e.length/2),c[u+"-cx"]=i,c[u+"-cy"]=a;var h=s/2,g=o/2;l=l==="auto"?TE(s,o):l;for(var v=new Array(e.length/2),m=0;m<e.length/2;m++)v[m]={x:i+h*e[m*2],y:a+g*e[m*2+1]};var y,b,x,A,C=v.length;for(b=v[C-1],y=0;y<C;y++)x=v[y%C],A=v[(y+1)%C],c[u][y]=L2(b,x,A,l),b=x,x=A;return c[u]},draw:function(i,a,s,o,l,c,u){this.renderer.nodeShapeImpl("round-polygon",i,a,s,o,l,this.points,this.getOrCreateCorners(a,s,o,l,c,u,"drawCorners"))},intersectLine:function(i,a,s,o,l,c,u,h,g){return rB(l,c,this.points,i,a,s,o,u,this.getOrCreateCorners(i,a,s,o,h,g,"corners"))},checkPoint:function(i,a,s,o,l,c,u,h,g){return $R(i,a,this.points,c,u,o,l,this.getOrCreateCorners(c,u,o,l,h,g,"corners"))}}};Na.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:An(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s,this.points,o)},intersectLine:function(e,n,i,a,s,o,l,c){return EE(s,o,e,n,i,a,l,c)},checkPoint:function(e,n,i,a,s,o,l,c){var u=a/2,h=s/2;c=c==="auto"?Rs(a,s):c,c=Math.min(u,h,c);var g=c*2;return!!(Ba(e,n,this.points,o,l,a,s-g,[0,-1],i)||Ba(e,n,this.points,o,l,a-g,s,[0,-1],i)||go(e,n,g,g,o-u+c,l-h+c,i)||go(e,n,g,g,o+u-c,l-h+c,i)||go(e,n,g,g,o+u-c,l+h-c,i)||go(e,n,g,g,o-u+c,l+h-c,i))}}};Na.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:D2(),points:An(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s,null,o)},generateCutTrianglePts:function(e,n,i,a,s){var o=s==="auto"?this.cornerLength:s,l=n/2,c=e/2,u=i-c,h=i+c,g=a-l,v=a+l;return{topLeft:[u,g+o,u+o,g,u+o,g+o],topRight:[h-o,g,h,g+o,h-o,g+o],bottomRight:[h,v-o,h-o,v,h-o,v-o],bottomLeft:[u+o,v,u,v-o,u+o,v-o]}},intersectLine:function(e,n,i,a,s,o,l,c){var u=this.generateCutTrianglePts(i+2*l,a+2*l,e,n,c),h=[].concat.apply([],[u.topLeft.splice(0,4),u.topRight.splice(0,4),u.bottomRight.splice(0,4),u.bottomLeft.splice(0,4)]);return _c(s,o,h,e,n)},checkPoint:function(e,n,i,a,s,o,l,c){var u=c==="auto"?this.cornerLength:c;if(Ba(e,n,this.points,o,l,a,s-2*u,[0,-1],i)||Ba(e,n,this.points,o,l,a-2*u,s,[0,-1],i))return!0;var h=this.generateCutTrianglePts(a,s,o,l);return Vn(e,n,h.topLeft)||Vn(e,n,h.topRight)||Vn(e,n,h.bottomRight)||Vn(e,n,h.bottomLeft)}}};Na.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:An(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s)},intersectLine:function(e,n,i,a,s,o,l,c){var u=.15,h=.5,g=.85,v=this.generateBarrelBezierPts(i+2*l,a+2*l,e,n),m=function(x){var A=Vl({x:x[0],y:x[1]},{x:x[2],y:x[3]},{x:x[4],y:x[5]},u),C=Vl({x:x[0],y:x[1]},{x:x[2],y:x[3]},{x:x[4],y:x[5]},h),E=Vl({x:x[0],y:x[1]},{x:x[2],y:x[3]},{x:x[4],y:x[5]},g);return[x[0],x[1],A.x,A.y,C.x,C.y,E.x,E.y,x[4],x[5]]},y=[].concat(m(v.topLeft),m(v.topRight),m(v.bottomRight),m(v.bottomLeft));return _c(s,o,y,e,n)},generateBarrelBezierPts:function(e,n,i,a){var s=n/2,o=e/2,l=i-o,c=i+o,u=a-s,h=a+s,g=Cp(e,n),v=g.heightOffset,m=g.widthOffset,y=g.ctrlPtOffsetPct*e,b={topLeft:[l,u+v,l+y,u,l+m,u],topRight:[c-m,u,c-y,u,c,u+v],bottomRight:[c,h-v,c-y,h,c-m,h],bottomLeft:[l+m,h,l+y,h,l,h-v]};return b.topLeft.isTop=!0,b.topRight.isTop=!0,b.bottomLeft.isBottom=!0,b.bottomRight.isBottom=!0,b},checkPoint:function(e,n,i,a,s,o,l,c){var u=Cp(a,s),h=u.heightOffset,g=u.widthOffset;if(Ba(e,n,this.points,o,l,a,s-2*h,[0,-1],i)||Ba(e,n,this.points,o,l,a-2*g,s,[0,-1],i))return!0;for(var v=this.generateBarrelBezierPts(a,s,o,l),m=function(B,F,I){var U=I[4],k=I[2],O=I[0],V=I[5],L=I[1],P=Math.min(U,O),_=Math.max(U,O),q=Math.min(V,L),H=Math.max(V,L);if(P<=B&&B<=_&&q<=F&&F<=H){var W=nB(U,k,O),G=QR(W[0],W[1],W[2],B),K=G.filter(function($){return 0<=$&&$<=1});if(K.length>0)return K[0]}return null},y=Object.keys(v),b=0;b<y.length;b++){var x=y[b],A=v[x],C=m(e,n,A);if(C!=null){var E=A[5],S=A[3],M=A[1],R=Hr(E,S,M,C);if(A.isTop&&R<=n||A.isBottom&&n<=R)return!0}}return!1}}};Na.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:An(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s,this.points,o)},intersectLine:function(e,n,i,a,s,o,l,c){var u=e-(i/2+l),h=n-(a/2+l),g=h,v=e+(i/2+l),m=bs(s,o,e,n,u,h,v,g,!1);return m.length>0?m:EE(s,o,e,n,i,a,l,c)},checkPoint:function(e,n,i,a,s,o,l,c){c=c==="auto"?Rs(a,s):c;var u=2*c;if(Ba(e,n,this.points,o,l,a,s-u,[0,-1],i)||Ba(e,n,this.points,o,l,a-u,s,[0,-1],i))return!0;var h=a/2+2*i,g=s/2+2*i,v=[o-h,l-g,o-h,l,o+h,l,o+h,l-g];return!!(Vn(e,n,v)||go(e,n,u,u,o+a/2-c,l+s/2-c,i)||go(e,n,u,u,o-a/2+c,l+s/2-c,i))}}};Na.registerNodeShapes=function(){var r=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",An(3,0)),this.generateRoundPolygon("round-triangle",An(3,0)),this.generatePolygon("rectangle",An(4,0)),r.square=r.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var n=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",n),this.generateRoundPolygon("round-diamond",n)}this.generatePolygon("pentagon",An(5,0)),this.generateRoundPolygon("round-pentagon",An(5,0)),this.generatePolygon("hexagon",An(6,0)),this.generateRoundPolygon("round-hexagon",An(6,0)),this.generatePolygon("heptagon",An(7,0)),this.generateRoundPolygon("round-heptagon",An(7,0)),this.generatePolygon("octagon",An(8,0)),this.generateRoundPolygon("round-octagon",An(8,0));var i=new Array(20);{var a=wp(5,0),s=wp(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var l=0;l<s.length/2;l++)s[l*2]*=o,s[l*2+1]*=o;for(var l=0;l<20/4;l++)i[l*4]=a[l*2],i[l*4+1]=a[l*2+1],i[l*4+2]=s[l*2],i[l*4+3]=s[l*2+1]}i=SE(i),this.generatePolygon("star",i),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var c=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",c),this.generateRoundPolygon("round-tag",c)}r.makePolygon=function(u){var h=u.join("$"),g="polygon-"+h,v;return(v=this[g])?v:e.generatePolygon(g,u)}};var hf={};hf.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};hf.redraw=function(r){r=r||xE();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=r};hf.beforeRender=function(r,e){if(!this.destroyed){e==null&&ur("Priority is not optional for beforeRender");var n=this.beforeRenderCallbacks;n.push({fn:r,priority:e}),n.sort(function(i,a){return a.priority-i.priority})}};var G3=function(e,n,i){for(var a=e.beforeRenderCallbacks,s=0;s<a.length;s++)a[s].fn(n,i)};hf.startRenderLoop=function(){var r=this,e=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;var n=function(a){if(!r.destroyed){if(!e.batching())if(r.requestedFrame&&!r.skipFrame){G3(r,!0,a);var s=Ra();r.render(r.renderOptions);var o=r.lastDrawTime=Ra();r.averageRedrawTime===void 0&&(r.averageRedrawTime=o-s),r.redrawCount===void 0&&(r.redrawCount=0),r.redrawCount++,r.redrawTotalTime===void 0&&(r.redrawTotalTime=0);var l=o-s;r.redrawTotalTime+=l,r.lastRedrawTime=l,r.averageRedrawTime=r.averageRedrawTime/2+l/2,r.requestedFrame=!1}else G3(r,!1,a);r.skipFrame=!1,Xd(n)}};Xd(n)}};var AN=function(e){this.init(e)},TS=AN,$l=TS.prototype;$l.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];$l.init=function(r){var e=this;e.options=r,e.cy=r.cy;var n=e.container=r.cy.container(),i=e.cy.window();if(i){var a=i.document,s=a.head,o="__________cytoscape_stylesheet",l="__________cytoscape_container",c=a.getElementById(o)!=null;if(n.className.indexOf(l)<0&&(n.className=(n.className||"")+" "+l),!c){var u=a.createElement("style");u.id=o,u.textContent="."+l+" { position: relative; }",s.insertBefore(u,s.children[0])}var h=i.getComputedStyle(n),g=h.getPropertyValue("position");g==="static"&&Pt("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=r.showFps,e.debug=r.debug,e.webgl=r.webgl,e.hideEdgesOnViewport=r.hideEdgesOnViewport,e.textureOnViewport=r.textureOnViewport,e.wheelSensitivity=r.wheelSensitivity,e.motionBlurEnabled=r.motionBlur,e.forcedPixelRatio=Be(r.pixelRatio)?r.pixelRatio:null,e.motionBlur=r.motionBlur,e.motionBlurOpacity=r.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=r.desktopTapThreshold,e.desktopTapThreshold2=r.desktopTapThreshold*r.desktopTapThreshold,e.touchTapThreshold=r.touchTapThreshold,e.touchTapThreshold2=r.touchTapThreshold*r.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};$l.notify=function(r,e){var n=this,i=n.cy;if(!this.destroyed){if(r==="init"){n.load();return}if(r==="destroy"){n.destroy();return}(r==="add"||r==="remove"||r==="move"&&i.hasCompoundNodes()||r==="load"||r==="zorder"||r==="mount")&&n.invalidateCachedZSortedEles(),r==="viewport"&&n.redrawHint("select",!0),r==="gc"&&n.redrawHint("gc",!0),(r==="load"||r==="resize"||r==="mount")&&(n.invalidateContainerClientCoordsCache(),n.matchCanvasSize(n.container)),n.redrawHint("eles",!0),n.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};$l.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var e=0;e<r.bindings.length;e++){var n=r.bindings[e],i=n,a=i.target;(a.off||a.removeEventListener).apply(a,i.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch{}};$l.isHeadless=function(){return!1};[P2,ES,SS,Jl,Na,hf].forEach(function(r){et($l,r)});var O1=1e3/60,MS={setupDequeueing:function(e){return function(){var i=this,a=this.renderer;if(!i.dequeueingSetup){i.dequeueingSetup=!0;var s=of(function(){a.redrawHint("eles",!0),a.redrawHint("drag",!0),a.redraw()},e.deqRedrawThreshold),o=function(u,h){var g=Ra(),v=a.averageRedrawTime,m=a.lastRedrawTime,y=[],b=a.cy.extent(),x=a.getPixelRatio();for(u||a.flushRenderedStyleQueue();;){var A=Ra(),C=A-g,E=A-h;if(m<O1){var S=O1-(u?v:0);if(E>=e.deqFastCost*S)break}else if(u){if(C>=e.deqCost*m||C>=e.deqAvgCost*v)break}else if(E>=e.deqNoDrawCost*O1)break;var M=e.deq(i,x,b);if(M.length>0)for(var R=0;R<M.length;R++)y.push(M[R]);else break}y.length>0&&(e.onDeqd(i,y),!u&&e.shouldRedraw(i,y,x,b)&&s())},l=e.priority||C2;a.beforeRender(o,l(i))}}}},xN=(function(){function r(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qd;Fs(this,r),this.idsByKey=new Sa,this.keyForId=new Sa,this.cachesByLvl=new Sa,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=n}return ks(r,[{key:"getIdsFor",value:function(n){n==null&&ur("Can not get id list for null key");var i=this.idsByKey,a=this.idsByKey.get(n);return a||(a=new Xl,i.set(n,a)),a}},{key:"addIdForKey",value:function(n,i){n!=null&&this.getIdsFor(n).add(i)}},{key:"deleteIdForKey",value:function(n,i){n!=null&&this.getIdsFor(n).delete(i)}},{key:"getNumberOfIdsForKey",value:function(n){return n==null?0:this.getIdsFor(n).size}},{key:"updateKeyMappingFor",value:function(n){var i=n.id(),a=this.keyForId.get(i),s=this.getKey(n);this.deleteIdForKey(a,i),this.addIdForKey(s,i),this.keyForId.set(i,s)}},{key:"deleteKeyMappingFor",value:function(n){var i=n.id(),a=this.keyForId.get(i);this.deleteIdForKey(a,i),this.keyForId.delete(i)}},{key:"keyHasChangedFor",value:function(n){var i=n.id(),a=this.keyForId.get(i),s=this.getKey(n);return a!==s}},{key:"isInvalid",value:function(n){return this.keyHasChangedFor(n)||this.doesEleInvalidateKey(n)}},{key:"getCachesAt",value:function(n){var i=this.cachesByLvl,a=this.lvls,s=i.get(n);return s||(s=new Sa,i.set(n,s),a.push(n)),s}},{key:"getCache",value:function(n,i){return this.getCachesAt(i).get(n)}},{key:"get",value:function(n,i){var a=this.getKey(n),s=this.getCache(a,i);return s!=null&&this.updateKeyMappingFor(n),s}},{key:"getForCachedKey",value:function(n,i){var a=this.keyForId.get(n.id()),s=this.getCache(a,i);return s}},{key:"hasCache",value:function(n,i){return this.getCachesAt(i).has(n)}},{key:"has",value:function(n,i){var a=this.getKey(n);return this.hasCache(a,i)}},{key:"setCache",value:function(n,i,a){a.key=n,this.getCachesAt(i).set(n,a)}},{key:"set",value:function(n,i,a){var s=this.getKey(n);this.setCache(s,i,a),this.updateKeyMappingFor(n)}},{key:"deleteCache",value:function(n,i){this.getCachesAt(i).delete(n)}},{key:"delete",value:function(n,i){var a=this.getKey(n);this.deleteCache(a,i)}},{key:"invalidateKey",value:function(n){var i=this;this.lvls.forEach(function(a){return i.deleteCache(n,a)})}},{key:"invalidate",value:function(n){var i=n.id(),a=this.keyForId.get(i);this.deleteKeyMappingFor(n);var s=this.doesEleInvalidateKey(n);return s&&this.invalidateKey(a),s||this.getNumberOfIdsForKey(a)===0}}])})(),q3=25,Zh=50,Id=-4,Vp=3,DS=7.99,bN=8,wN=1024,CN=1024,EN=1024,SN=.2,TN=.8,MN=10,DN=.15,RN=.1,BN=.9,IN=.9,NN=100,FN=1,kl={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},kN=on({getKey:null,doesEleInvalidateKey:Qd,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:pE,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),pc=function(e,n){var i=this;i.renderer=e,i.onDequeues=[];var a=kN(n);et(i,a),i.lookup=new xN(a.getKey,a.doesEleInvalidateKey),i.setupDequeueing()},Pr=pc.prototype;Pr.reasons=kl;Pr.getTextureQueue=function(r){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[r]=e.eleImgCaches[r]||[]};Pr.getRetiredTextureQueue=function(r){var e=this,n=e.eleImgCaches.retired=e.eleImgCaches.retired||{},i=n[r]=n[r]||[];return i};Pr.getElementQueue=function(){var r=this,e=r.eleCacheQueue=r.eleCacheQueue||new lf(function(n,i){return i.reqs-n.reqs});return e};Pr.getElementKeyToQueue=function(){var r=this,e=r.eleKeyToCacheQueue=r.eleKeyToCacheQueue||{};return e};Pr.getElement=function(r,e,n,i,a){var s=this,o=this.renderer,l=o.cy.zoom(),c=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!r.visible()||r.removed()||!s.allowEdgeTxrCaching&&r.isEdge()||!s.allowParentTxrCaching&&r.isParent())return null;if(i==null&&(i=Math.ceil(S2(l*n))),i<Id)i=Id;else if(l>=DS||i>Vp)return null;var u=Math.pow(2,i),h=e.h*u,g=e.w*u,v=o.eleTextBiggerThanMin(r,u);if(!this.isVisible(r,v))return null;var m=c.get(r,i);if(m&&m.invalidated&&(m.invalidated=!1,m.texture.invalidatedWidth-=m.width),m)return m;var y;if(h<=q3?y=q3:h<=Zh?y=Zh:y=Math.ceil(h/Zh)*Zh,h>EN||g>CN)return null;var b=s.getTextureQueue(y),x=b[b.length-2],A=function(){return s.recycleTexture(y,g)||s.addTexture(y,g)};x||(x=b[b.length-1]),x||(x=A()),x.width-x.usedWidth<g&&(x=A());for(var C=function(P){return P&&P.scaledLabelShown===v},E=a&&a===kl.dequeue,S=a&&a===kl.highQuality,M=a&&a===kl.downscale,R,T=i+1;T<=Vp;T++){var B=c.get(r,T);if(B){R=B;break}}var F=R&&R.level===i+1?R:null,I=function(){x.context.drawImage(F.texture.canvas,F.x,0,F.width,F.height,x.usedWidth,0,g,h)};if(x.context.setTransform(1,0,0,1,0,0),x.context.clearRect(x.usedWidth,0,g,y),C(F))I();else if(C(R))if(S){for(var U=R.level;U>i;U--)F=s.getElement(r,e,n,U,kl.downscale);I()}else return s.queueElement(r,R.level-1),R;else{var k;if(!E&&!S&&!M)for(var O=i-1;O>=Id;O--){var V=c.get(r,O);if(V){k=V;break}}if(C(k))return s.queueElement(r,i),k;x.context.translate(x.usedWidth,0),x.context.scale(u,u),this.drawElement(x.context,r,e,v,!1),x.context.scale(1/u,1/u),x.context.translate(-x.usedWidth,0)}return m={x:x.usedWidth,texture:x,level:i,scale:u,width:g,height:h,scaledLabelShown:v},x.usedWidth+=Math.ceil(g+bN),x.eleCaches.push(m),c.set(r,i,m),s.checkTextureFullness(x),m};Pr.invalidateElements=function(r){for(var e=0;e<r.length;e++)this.invalidateElement(r[e])};Pr.invalidateElement=function(r){var e=this,n=e.lookup,i=[],a=n.isInvalid(r);if(a){for(var s=Id;s<=Vp;s++){var o=n.getForCachedKey(r,s);o&&i.push(o)}var l=n.invalidate(r);if(l)for(var c=0;c<i.length;c++){var u=i[c],h=u.texture;h.invalidatedWidth+=u.width,u.invalidated=!0,e.checkTextureUtility(h)}e.removeFromQueue(r)}};Pr.checkTextureUtility=function(r){r.invalidatedWidth>=SN*r.width&&this.retireTexture(r)};Pr.checkTextureFullness=function(r){var e=this,n=e.getTextureQueue(r.height);r.usedWidth/r.width>TN&&r.fullnessChecks>=MN?Ds(n,r):r.fullnessChecks++};Pr.retireTexture=function(r){var e=this,n=r.height,i=e.getTextureQueue(n),a=this.lookup;Ds(i,r),r.retired=!0;for(var s=r.eleCaches,o=0;o<s.length;o++){var l=s[o];a.deleteCache(l.key,l.level)}E2(s);var c=e.getRetiredTextureQueue(n);c.push(r)};Pr.addTexture=function(r,e){var n=this,i=n.getTextureQueue(r),a={};return i.push(a),a.eleCaches=[],a.height=r,a.width=Math.max(wN,e),a.usedWidth=0,a.invalidatedWidth=0,a.fullnessChecks=0,a.canvas=n.renderer.makeOffscreenCanvas(a.width,a.height),a.context=a.canvas.getContext("2d"),a};Pr.recycleTexture=function(r,e){for(var n=this,i=n.getTextureQueue(r),a=n.getRetiredTextureQueue(r),s=0;s<a.length;s++){var o=a[s];if(o.width>=e)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,E2(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),Ds(a,o),i.push(o),o}};Pr.queueElement=function(r,e){var n=this,i=n.getElementQueue(),a=n.getElementKeyToQueue(),s=this.getKey(r),o=a[s];if(o)o.level=Math.max(o.level,e),o.eles.merge(r),o.reqs++,i.updateItem(o);else{var l={eles:r.spawn().merge(r),level:e,reqs:1,key:s};i.push(l),a[s]=l}};Pr.dequeue=function(r){for(var e=this,n=e.getElementQueue(),i=e.getElementKeyToQueue(),a=[],s=e.lookup,o=0;o<FN&&n.size()>0;o++){var l=n.pop(),c=l.key,u=l.eles[0],h=s.hasCache(u,l.level);if(i[c]=null,h)continue;a.push(l);var g=e.getBoundingBox(u);e.getElement(u,g,r,l.level,kl.dequeue)}return a};Pr.removeFromQueue=function(r){var e=this,n=e.getElementQueue(),i=e.getElementKeyToQueue(),a=this.getKey(r),s=i[a];s!=null&&(s.eles.length===1?(s.reqs=w2,n.updateItem(s),n.pop(),i[a]=null):s.eles.unmerge(r))};Pr.onDequeue=function(r){this.onDequeues.push(r)};Pr.offDequeue=function(r){Ds(this.onDequeues,r)};Pr.setupDequeueing=MS.setupDequeueing({deqRedrawThreshold:NN,deqCost:DN,deqAvgCost:RN,deqNoDrawCost:BN,deqFastCost:IN,deq:function(e,n,i){return e.dequeue(n,i)},onDeqd:function(e,n){for(var i=0;i<e.onDequeues.length;i++){var a=e.onDequeues[i];a(n)}},shouldRedraw:function(e,n,i,a){for(var s=0;s<n.length;s++)for(var o=n[s].eles,l=0;l<o.length;l++){var c=o[l].boundingBox();if(M2(c,a))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var UN=1,Mc=-4,n0=2,VN=3.99,ON=50,PN=50,LN=.15,_N=.1,zN=.9,GN=.9,qN=1,Y3=250,YN=4e3*4e3,j3=32767,jN=!0,RS=function(e){var n=this,i=n.renderer=e,a=i.cy;n.layersByLevel={},n.firstGet=!0,n.lastInvalidationTime=Ra()-2*Y3,n.skipping=!1,n.eleTxrDeqs=a.collection(),n.scheduleElementRefinement=of(function(){n.refineElementTextures(n.eleTxrDeqs),n.eleTxrDeqs.unmerge(n.eleTxrDeqs)},PN),i.beforeRender(function(o,l){l-n.lastInvalidationTime<=Y3?n.skipping=!0:n.skipping=!1},i.beforeRenderPriorities.lyrTxrSkip);var s=function(l,c){return c.reqs-l.reqs};n.layersQueue=new lf(s),n.setupDequeueing()},ln=RS.prototype,H3=0,HN=Math.pow(2,53)-1;ln.makeLayer=function(r,e){var n=Math.pow(2,e),i=Math.ceil(r.w*n),a=Math.ceil(r.h*n),s=this.renderer.makeOffscreenCanvas(i,a),o={id:H3=++H3%HN,bb:r,level:e,width:i,height:a,canvas:s,context:s.getContext("2d"),eles:[],elesQueue:[],reqs:0},l=o.context,c=-o.bb.x1,u=-o.bb.y1;return l.scale(n,n),l.translate(c,u),o};ln.getLayers=function(r,e,n){var i=this,a=i.renderer,s=a.cy,o=s.zoom(),l=i.firstGet;if(i.firstGet=!1,n==null){if(n=Math.ceil(S2(o*e)),n<Mc)n=Mc;else if(o>=VN||n>n0)return null}i.validateLayersElesOrdering(n,r);var c=i.layersByLevel,u=Math.pow(2,n),h=c[n]=c[n]||[],g,v=i.levelIsComplete(n,r),m,y=function(){var I=function(L){if(i.validateLayersElesOrdering(L,r),i.levelIsComplete(L,r))return m=c[L],!0},U=function(L){if(!m)for(var P=n+L;Mc<=P&&P<=n0&&!I(P);P+=L);};U(1),U(-1);for(var k=h.length-1;k>=0;k--){var O=h[k];O.invalid&&Ds(h,O)}};if(!v)y();else return h;var b=function(){if(!g){g=wn();for(var I=0;I<r.length;I++)qR(g,r[I].boundingBox())}return g},x=function(I){I=I||{};var U=I.after;b();var k=Math.ceil(g.w*u),O=Math.ceil(g.h*u);if(k>j3||O>j3)return null;var V=k*O;if(V>YN)return null;var L=i.makeLayer(g,n);if(U!=null){var P=h.indexOf(U)+1;h.splice(P,0,L)}else(I.insert===void 0||I.insert)&&h.unshift(L);return L};if(i.skipping&&!l)return null;for(var A=null,C=r.length/UN,E=!l,S=0;S<r.length;S++){var M=r[S],R=M._private.rscratch,T=R.imgLayerCaches=R.imgLayerCaches||{},B=T[n];if(B){A=B;continue}if((!A||A.eles.length>=C||!CE(A.bb,M.boundingBox()))&&(A=x({insert:!0,after:A}),!A))return null;m||E?i.queueLayer(A,M):i.drawEleInLayer(A,M,n,e),A.eles.push(M),T[n]=A}return m||(E?null:h)};ln.getEleLevelForLayerLevel=function(r,e){return r};ln.drawEleInLayer=function(r,e,n,i){var a=this,s=this.renderer,o=r.context,l=e.boundingBox();l.w===0||l.h===0||!e.visible()||(n=a.getEleLevelForLayerLevel(n,i),s.setImgSmoothing(o,!1),s.drawCachedElement(o,e,null,null,n,jN),s.setImgSmoothing(o,!0))};ln.levelIsComplete=function(r,e){var n=this,i=n.layersByLevel[r];if(!i||i.length===0)return!1;for(var a=0,s=0;s<i.length;s++){var o=i[s];if(o.reqs>0||o.invalid)return!1;a+=o.eles.length}return a===e.length};ln.validateLayersElesOrdering=function(r,e){var n=this.layersByLevel[r];if(n)for(var i=0;i<n.length;i++){for(var a=n[i],s=-1,o=0;o<e.length;o++)if(a.eles[0]===e[o]){s=o;break}if(s<0){this.invalidateLayer(a);continue}for(var l=s,o=0;o<a.eles.length;o++)if(a.eles[o]!==e[l+o]){this.invalidateLayer(a);break}}};ln.updateElementsInLayers=function(r,e){for(var n=this,i=rf(r[0]),a=0;a<r.length;a++)for(var s=i?null:r[a],o=i?r[a]:r[a].ele,l=o._private.rscratch,c=l.imgLayerCaches=l.imgLayerCaches||{},u=Mc;u<=n0;u++){var h=c[u];h&&(s&&n.getEleLevelForLayerLevel(h.level)!==s.level||e(h,o,s))}};ln.haveLayers=function(){for(var r=this,e=!1,n=Mc;n<=n0;n++){var i=r.layersByLevel[n];if(i&&i.length>0){e=!0;break}}return e};ln.invalidateElements=function(r){var e=this;r.length!==0&&(e.lastInvalidationTime=Ra(),!(r.length===0||!e.haveLayers())&&e.updateElementsInLayers(r,function(i,a,s){e.invalidateLayer(i)}))};ln.invalidateLayer=function(r){if(this.lastInvalidationTime=Ra(),!r.invalid){var e=r.level,n=r.eles,i=this.layersByLevel[e];Ds(i,r),r.elesQueue=[],r.invalid=!0,r.replacement&&(r.replacement.invalid=!0);for(var a=0;a<n.length;a++){var s=n[a]._private.rscratch.imgLayerCaches;s&&(s[e]=null)}}};ln.refineElementTextures=function(r){var e=this;e.updateElementsInLayers(r,function(i,a,s){var o=i.replacement;if(o||(o=i.replacement=e.makeLayer(i.bb,i.level),o.replaces=i,o.eles=i.eles),!o.reqs)for(var l=0;l<o.eles.length;l++)e.queueLayer(o,o.eles[l])})};ln.enqueueElementRefinement=function(r){this.eleTxrDeqs.merge(r),this.scheduleElementRefinement()};ln.queueLayer=function(r,e){var n=this,i=n.layersQueue,a=r.elesQueue,s=a.hasId=a.hasId||{};if(!r.replacement){if(e){if(s[e.id()])return;a.push(e),s[e.id()]=!0}r.reqs?(r.reqs++,i.updateItem(r)):(r.reqs=1,i.push(r))}};ln.dequeue=function(r){for(var e=this,n=e.layersQueue,i=[],a=0;a<qN&&n.size()!==0;){var s=n.peek();if(s.replacement){n.pop();continue}if(s.replaces&&s!==s.replaces.replacement){n.pop();continue}if(s.invalid){n.pop();continue}var o=s.elesQueue.shift();o&&(e.drawEleInLayer(s,o,s.level,r),a++),i.length===0&&i.push(!0),s.elesQueue.length===0&&(n.pop(),s.reqs=0,s.replaces&&e.applyLayerReplacement(s),e.requestRedraw())}return i};ln.applyLayerReplacement=function(r){var e=this,n=e.layersByLevel[r.level],i=r.replaces,a=n.indexOf(i);if(!(a<0||i.invalid)){n[a]=r;for(var s=0;s<r.eles.length;s++){var o=r.eles[s]._private,l=o.imgLayerCaches=o.imgLayerCaches||{};l&&(l[r.level]=r)}e.requestRedraw()}};ln.requestRedraw=of(function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()},100);ln.setupDequeueing=MS.setupDequeueing({deqRedrawThreshold:ON,deqCost:LN,deqAvgCost:_N,deqNoDrawCost:zN,deqFastCost:GN,deq:function(e,n){return e.dequeue(n)},onDeqd:C2,shouldRedraw:pE,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var BS={},K3;function KN(r,e){for(var n=0;n<e.length;n++){var i=e[n];r.lineTo(i.x,i.y)}}function XN(r,e,n){for(var i,a=0;a<e.length;a++){var s=e[a];a===0&&(i=s),r.lineTo(s.x,s.y)}r.quadraticCurveTo(n.x,n.y,i.x,i.y)}function X3(r,e,n){r.beginPath&&r.beginPath();for(var i=e,a=0;a<i.length;a++){var s=i[a];r.lineTo(s.x,s.y)}var o=n,l=n[0];r.moveTo(l.x,l.y);for(var a=1;a<o.length;a++){var s=o[a];r.lineTo(s.x,s.y)}r.closePath&&r.closePath()}function QN(r,e,n,i,a){r.beginPath&&r.beginPath(),r.arc(n,i,a,0,Math.PI*2,!1);var s=e,o=s[0];r.moveTo(o.x,o.y);for(var l=0;l<s.length;l++){var c=s[l];r.lineTo(c.x,c.y)}r.closePath&&r.closePath()}function ZN(r,e,n,i){r.arc(e,n,i,0,Math.PI*2,!1)}BS.arrowShapeImpl=function(r){return(K3||(K3={polygon:KN,"triangle-backcurve":XN,"triangle-tee":X3,"circle-triangle":QN,"triangle-cross":X3,circle:ZN}))[r]};var $i={};$i.drawElement=function(r,e,n,i,a,s){var o=this;e.isNode()?o.drawNode(r,e,n,i,a,s):o.drawEdge(r,e,n,i,a,s)};$i.drawElementOverlay=function(r,e){var n=this;e.isNode()?n.drawNodeOverlay(r,e):n.drawEdgeOverlay(r,e)};$i.drawElementUnderlay=function(r,e){var n=this;e.isNode()?n.drawNodeUnderlay(r,e):n.drawEdgeUnderlay(r,e)};$i.drawCachedElementPortion=function(r,e,n,i,a,s,o,l){var c=this,u=n.getBoundingBox(e);if(!(u.w===0||u.h===0)){var h=n.getElement(e,u,i,a,s);if(h!=null){var g=l(c,e);if(g===0)return;var v=o(c,e),m=u.x1,y=u.y1,b=u.w,x=u.h,A,C,E,S,M;if(v!==0){var R=n.getRotationPoint(e);E=R.x,S=R.y,r.translate(E,S),r.rotate(v),M=c.getImgSmoothing(r),M||c.setImgSmoothing(r,!0);var T=n.getRotationOffset(e);A=T.x,C=T.y}else A=m,C=y;var B;g!==1&&(B=r.globalAlpha,r.globalAlpha=B*g),r.drawImage(h.texture.canvas,h.x,0,h.width,h.height,A,C,b,x),g!==1&&(r.globalAlpha=B),v!==0&&(r.rotate(-v),r.translate(-E,-S),M||c.setImgSmoothing(r,!1))}else n.drawElement(r,e)}};var WN=function(){return 0},JN=function(e,n){return e.getTextAngle(n,null)},$N=function(e,n){return e.getTextAngle(n,"source")},eF=function(e,n){return e.getTextAngle(n,"target")},tF=function(e,n){return n.effectiveOpacity()},P1=function(e,n){return n.pstyle("text-opacity").pfValue*n.effectiveOpacity()};$i.drawCachedElement=function(r,e,n,i,a,s){var o=this,l=o.data,c=l.eleTxrCache,u=l.lblTxrCache,h=l.slbTxrCache,g=l.tlbTxrCache,v=e.boundingBox(),m=s===!0?c.reasons.highQuality:null;if(!(v.w===0||v.h===0||!e.visible())&&(!i||M2(v,i))){var y=e.isEdge(),b=e.element()._private.rscratch.badLine;o.drawElementUnderlay(r,e),o.drawCachedElementPortion(r,e,c,n,a,m,WN,tF),(!y||!b)&&o.drawCachedElementPortion(r,e,u,n,a,m,JN,P1),y&&!b&&(o.drawCachedElementPortion(r,e,h,n,a,m,$N,P1),o.drawCachedElementPortion(r,e,g,n,a,m,eF,P1)),o.drawElementOverlay(r,e)}};$i.drawElements=function(r,e){for(var n=this,i=0;i<e.length;i++){var a=e[i];n.drawElement(r,a)}};$i.drawCachedElements=function(r,e,n,i){for(var a=this,s=0;s<e.length;s++){var o=e[s];a.drawCachedElement(r,o,n,i)}};$i.drawCachedNodes=function(r,e,n,i){for(var a=this,s=0;s<e.length;s++){var o=e[s];o.isNode()&&a.drawCachedElement(r,o,n,i)}};$i.drawLayeredElements=function(r,e,n,i){var a=this,s=a.data.lyrTxrCache.getLayers(e,n);if(s)for(var o=0;o<s.length;o++){var l=s[o],c=l.bb;c.w===0||c.h===0||r.drawImage(l.canvas,c.x1,c.y1,c.w,c.h)}else a.drawCachedElements(r,e,n,i)};var Fa={};Fa.drawEdge=function(r,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l=e._private.rscratch;if(!(s&&!e.visible())&&!(l.badLine||l.allpts==null||isNaN(l.allpts[0]))){var c;n&&(c=n,r.translate(-c.x1,-c.y1));var u=s?e.pstyle("opacity").value:1,h=s?e.pstyle("line-opacity").value:1,g=e.pstyle("curve-style").value,v=e.pstyle("line-style").value,m=e.pstyle("width").pfValue,y=e.pstyle("line-cap").value,b=e.pstyle("line-outline-width").value,x=e.pstyle("line-outline-color").value,A=u*h,C=u*h,E=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:A;g==="straight-triangle"?(o.eleStrokeStyle(r,e,L),o.drawEdgeTrianglePath(e,r,l.allpts)):(r.lineWidth=m,r.lineCap=y,o.eleStrokeStyle(r,e,L),o.drawEdgePath(e,r,l.allpts,v),r.lineCap="butt")},S=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:A;if(r.lineWidth=m+b,r.lineCap=y,b>0)o.colorStrokeStyle(r,x[0],x[1],x[2],L);else{r.lineCap="butt";return}g==="straight-triangle"?o.drawEdgeTrianglePath(e,r,l.allpts):(o.drawEdgePath(e,r,l.allpts,v),r.lineCap="butt")},M=function(){a&&o.drawEdgeOverlay(r,e)},R=function(){a&&o.drawEdgeUnderlay(r,e)},T=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C;o.drawArrowheads(r,e,L)},B=function(){o.drawElementText(r,e,null,i)};r.lineJoin="round";var F=e.pstyle("ghost").value==="yes";if(F){var I=e.pstyle("ghost-offset-x").pfValue,U=e.pstyle("ghost-offset-y").pfValue,k=e.pstyle("ghost-opacity").value,O=A*k;r.translate(I,U),E(O),T(O),r.translate(-I,-U)}else S();R(),E(),T(),M(),B(),n&&r.translate(c.x1,c.y1)}};var IS=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(n,i){if(i.visible()){var a=i.pstyle("".concat(e,"-opacity")).value;if(a!==0){var s=this,o=s.usePaths(),l=i._private.rscratch,c=i.pstyle("".concat(e,"-padding")).pfValue,u=2*c,h=i.pstyle("".concat(e,"-color")).value;n.lineWidth=u,l.edgeType==="self"&&!o?n.lineCap="butt":n.lineCap="round",s.colorStrokeStyle(n,h[0],h[1],h[2],a),s.drawEdgePath(i,n,l.allpts,"solid")}}}};Fa.drawEdgeOverlay=IS("overlay");Fa.drawEdgeUnderlay=IS("underlay");Fa.drawEdgePath=function(r,e,n,i){var a=r._private.rscratch,s=e,o,l=!1,c=this.usePaths(),u=r.pstyle("line-dash-pattern").pfValue,h=r.pstyle("line-dash-offset").pfValue;if(c){var g=n.join("$"),v=a.pathCacheKey&&a.pathCacheKey===g;v?(o=e=a.pathCache,l=!0):(o=e=new Path2D,a.pathCacheKey=g,a.pathCache=o)}if(s.setLineDash)switch(i){case"dotted":s.setLineDash([1,1]);break;case"dashed":s.setLineDash(u),s.lineDashOffset=h;break;case"solid":s.setLineDash([]);break}if(!l&&!a.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(n[0],n[1]),a.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var m=2;m+3<n.length;m+=4)e.quadraticCurveTo(n[m],n[m+1],n[m+2],n[m+3]);break;case"straight":case"haystack":for(var y=2;y+1<n.length;y+=2)e.lineTo(n[y],n[y+1]);break;case"segments":if(a.isRound){var b=On(a.roundCorners),x;try{for(b.s();!(x=b.n()).done;){var A=x.value;AS(e,A)}}catch(E){b.e(E)}finally{b.f()}e.lineTo(n[n.length-2],n[n.length-1])}else for(var C=2;C+1<n.length;C+=2)e.lineTo(n[C],n[C+1]);break}e=s,c?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])};Fa.drawEdgeTrianglePath=function(r,e,n){e.fillStyle=e.strokeStyle;for(var i=r.pstyle("width").pfValue,a=0;a+1<n.length;a+=2){var s=[n[a+2]-n[a],n[a+3]-n[a+1]],o=Math.sqrt(s[0]*s[0]+s[1]*s[1]),l=[s[1]/o,-s[0]/o],c=[l[0]*i/2,l[1]*i/2];e.beginPath(),e.moveTo(n[a]-c[0],n[a+1]-c[1]),e.lineTo(n[a]+c[0],n[a+1]+c[1]),e.lineTo(n[a+2],n[a+3]),e.closePath(),e.fill()}};Fa.drawArrowheads=function(r,e,n){var i=e._private.rscratch,a=i.edgeType==="haystack";a||this.drawArrowhead(r,e,"source",i.arrowStartX,i.arrowStartY,i.srcArrowAngle,n),this.drawArrowhead(r,e,"mid-target",i.midX,i.midY,i.midtgtArrowAngle,n),this.drawArrowhead(r,e,"mid-source",i.midX,i.midY,i.midsrcArrowAngle,n),a||this.drawArrowhead(r,e,"target",i.arrowEndX,i.arrowEndY,i.tgtArrowAngle,n)};Fa.drawArrowhead=function(r,e,n,i,a,s,o){if(!(isNaN(i)||i==null||isNaN(a)||a==null||isNaN(s)||s==null)){var l=this,c=e.pstyle(n+"-arrow-shape").value;if(c!=="none"){var u=e.pstyle(n+"-arrow-fill").value==="hollow"?"both":"filled",h=e.pstyle(n+"-arrow-fill").value,g=e.pstyle("width").pfValue,v=e.pstyle(n+"-arrow-width"),m=v.value==="match-line"?g:v.pfValue;v.units==="%"&&(m*=g);var y=e.pstyle("opacity").value;o===void 0&&(o=y);var b=r.globalCompositeOperation;(o!==1||h==="hollow")&&(r.globalCompositeOperation="destination-out",l.colorFillStyle(r,255,255,255,1),l.colorStrokeStyle(r,255,255,255,1),l.drawArrowShape(e,r,u,g,c,m,i,a,s),r.globalCompositeOperation=b);var x=e.pstyle(n+"-arrow-color").value;l.colorFillStyle(r,x[0],x[1],x[2],o),l.colorStrokeStyle(r,x[0],x[1],x[2],o),l.drawArrowShape(e,r,h,g,c,m,i,a,s)}}};Fa.drawArrowShape=function(r,e,n,i,a,s,o,l,c){var u=this,h=this.usePaths()&&a!=="triangle-cross",g=!1,v,m=e,y={x:o,y:l},b=r.pstyle("arrow-scale").value,x=this.getArrowWidth(i,b),A=u.arrowShapes[a];if(h){var C=u.arrowPathCache=u.arrowPathCache||[],E=bo(a),S=C[E];S!=null?(v=e=S,g=!0):(v=e=new Path2D,C[E]=v)}g||(e.beginPath&&e.beginPath(),h?A.draw(e,1,0,{x:0,y:0},1):A.draw(e,x,c,y,i),e.closePath&&e.closePath()),e=m,h&&(e.translate(o,l),e.rotate(c),e.scale(x,x)),(n==="filled"||n==="both")&&(h?e.fill(v):e.fill()),(n==="hollow"||n==="both")&&(e.lineWidth=s/(h?x:1),e.lineJoin="miter",h?e.stroke(v):e.stroke()),h&&(e.scale(1/x,1/x),e.rotate(-c),e.translate(-o,-l))};var z2={};z2.safeDrawImage=function(r,e,n,i,a,s,o,l,c,u){if(!(a<=0||s<=0||c<=0||u<=0))try{r.drawImage(e,n,i,a,s,o,l,c,u)}catch(h){Pt(h)}};z2.drawInscribedImage=function(r,e,n,i,a){var s=this,o=n.position(),l=o.x,c=o.y,u=n.cy().style(),h=u.getIndexedStyle.bind(u),g=h(n,"background-fit","value",i),v=h(n,"background-repeat","value",i),m=n.width(),y=n.height(),b=n.padding()*2,x=m+(h(n,"background-width-relative-to","value",i)==="inner"?0:b),A=y+(h(n,"background-height-relative-to","value",i)==="inner"?0:b),C=n._private.rscratch,E=h(n,"background-clip","value",i),S=E==="node",M=h(n,"background-image-opacity","value",i)*a,R=h(n,"background-image-smoothing","value",i),T=n.pstyle("corner-radius").value;T!=="auto"&&(T=n.pstyle("corner-radius").pfValue);var B=e.width||e.cachedW,F=e.height||e.cachedH;(B==null||F==null)&&(document.body.appendChild(e),B=e.cachedW=e.width||e.offsetWidth,F=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var I=B,U=F;if(h(n,"background-width","value",i)!=="auto"&&(h(n,"background-width","units",i)==="%"?I=h(n,"background-width","pfValue",i)*x:I=h(n,"background-width","pfValue",i)),h(n,"background-height","value",i)!=="auto"&&(h(n,"background-height","units",i)==="%"?U=h(n,"background-height","pfValue",i)*A:U=h(n,"background-height","pfValue",i)),!(I===0||U===0)){if(g==="contain"){var k=Math.min(x/I,A/U);I*=k,U*=k}else if(g==="cover"){var k=Math.max(x/I,A/U);I*=k,U*=k}var O=l-x/2,V=h(n,"background-position-x","units",i),L=h(n,"background-position-x","pfValue",i);V==="%"?O+=(x-I)*L:O+=L;var P=h(n,"background-offset-x","units",i),_=h(n,"background-offset-x","pfValue",i);P==="%"?O+=(x-I)*_:O+=_;var q=c-A/2,H=h(n,"background-position-y","units",i),W=h(n,"background-position-y","pfValue",i);H==="%"?q+=(A-U)*W:q+=W;var G=h(n,"background-offset-y","units",i),K=h(n,"background-offset-y","pfValue",i);G==="%"?q+=(A-U)*K:q+=K,C.pathCache&&(O-=l,q-=c,l=0,c=0);var $=r.globalAlpha;r.globalAlpha=M;var te=s.getImgSmoothing(r),ae=!1;if(R==="no"&&te?(s.setImgSmoothing(r,!1),ae=!0):R==="yes"&&!te&&(s.setImgSmoothing(r,!0),ae=!0),v==="no-repeat")S&&(r.save(),C.pathCache?r.clip(C.pathCache):(s.nodeShapes[s.getNodeShape(n)].draw(r,l,c,x,A,T,C),r.clip())),s.safeDrawImage(r,e,0,0,B,F,O,q,I,U),S&&r.restore();else{var ue=r.createPattern(e,v);r.fillStyle=ue,s.nodeShapes[s.getNodeShape(n)].draw(r,l,c,x,A,T,C),r.translate(O,q),r.fill(),r.translate(-O,-q)}r.globalAlpha=$,ae&&s.setImgSmoothing(r,te)}};var Io={};Io.eleTextBiggerThanMin=function(r,e){if(!e){var n=r.cy().zoom(),i=this.getPixelRatio(),a=Math.ceil(S2(n*i));e=Math.pow(2,a)}var s=r.pstyle("font-size").pfValue*e,o=r.pstyle("min-zoomed-font-size").pfValue;return!(s<o)};Io.drawElementText=function(r,e,n,i,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(i==null){if(s&&!o.eleTextBiggerThanMin(e))return}else if(i===!1)return;if(e.isNode()){var l=e.pstyle("label");if(!l||!l.value)return;var c=o.getLabelJustification(e);r.textAlign=c,r.textBaseline="bottom"}else{var u=e.element()._private.rscratch.badLine,h=e.pstyle("label"),g=e.pstyle("source-label"),v=e.pstyle("target-label");if(u||(!h||!h.value)&&(!g||!g.value)&&(!v||!v.value))return;r.textAlign="center",r.textBaseline="bottom"}var m=!n,y;n&&(y=n,r.translate(-y.x1,-y.y1)),a==null?(o.drawText(r,e,null,m,s),e.isEdge()&&(o.drawText(r,e,"source",m,s),o.drawText(r,e,"target",m,s))):o.drawText(r,e,a,m,s),n&&r.translate(y.x1,y.y1)};Io.getFontCache=function(r){var e;this.fontCaches=this.fontCaches||[];for(var n=0;n<this.fontCaches.length;n++)if(e=this.fontCaches[n],e.context===r)return e;return e={context:r},this.fontCaches.push(e),e};Io.setupTextStyle=function(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=e.pstyle("font-style").strValue,a=e.pstyle("font-size").pfValue+"px",s=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,l=n?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,c=e.pstyle("text-outline-opacity").value*l,u=e.pstyle("color").value,h=e.pstyle("text-outline-color").value;r.font=i+" "+o+" "+a+" "+s,r.lineJoin="round",this.colorFillStyle(r,u[0],u[1],u[2],l),this.colorStrokeStyle(r,h[0],h[1],h[2],c)};function rF(r,e,n,i,a){var s=Math.min(i,a),o=s/2,l=e+i/2,c=n+a/2;r.beginPath(),r.arc(l,c,o,0,Math.PI*2),r.closePath()}function Q3(r,e,n,i,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=Math.min(s,i/2,a/2);r.beginPath(),r.moveTo(e+o,n),r.lineTo(e+i-o,n),r.quadraticCurveTo(e+i,n,e+i,n+o),r.lineTo(e+i,n+a-o),r.quadraticCurveTo(e+i,n+a,e+i-o,n+a),r.lineTo(e+o,n+a),r.quadraticCurveTo(e,n+a,e,n+a-o),r.lineTo(e,n+o),r.quadraticCurveTo(e,n,e+o,n),r.closePath()}Io.getTextAngle=function(r,e){var n,i=r._private,a=i.rscratch,s=e?e+"-":"",o=r.pstyle(s+"text-rotation");if(o.strValue==="autorotate"){var l=Un(a,"labelAngle",e);n=r.isEdge()?l:0}else o.strValue==="none"?n=0:n=o.pfValue;return n};Io.drawText=function(r,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=e._private,o=s.rscratch,l=a?e.effectiveOpacity():1;if(!(a&&(l===0||e.pstyle("text-opacity").value===0))){n==="main"&&(n=null);var c=Un(o,"labelX",n),u=Un(o,"labelY",n),h,g,v=this.getLabelText(e,n);if(v!=null&&v!==""&&!isNaN(c)&&!isNaN(u)){this.setupTextStyle(r,e,a);var m=n?n+"-":"",y=Un(o,"labelWidth",n),b=Un(o,"labelHeight",n),x=e.pstyle(m+"text-margin-x").pfValue,A=e.pstyle(m+"text-margin-y").pfValue,C=e.isEdge(),E=e.pstyle("text-halign").value,S=e.pstyle("text-valign").value;C&&(E="center",S="center"),c+=x,u+=A;var M;switch(i?M=this.getTextAngle(e,n):M=0,M!==0&&(h=c,g=u,r.translate(h,g),r.rotate(M),c=0,u=0),S){case"top":break;case"center":u+=b/2;break;case"bottom":u+=b;break}var R=e.pstyle("text-background-opacity").value,T=e.pstyle("text-border-opacity").value,B=e.pstyle("text-border-width").pfValue,F=e.pstyle("text-background-padding").pfValue,I=e.pstyle("text-background-shape").strValue,U=I==="round-rectangle"||I==="roundrectangle",k=I==="circle",O=2;if(R>0||B>0&&T>0){var V=r.fillStyle,L=r.strokeStyle,P=r.lineWidth,_=e.pstyle("text-background-color").value,q=e.pstyle("text-border-color").value,H=e.pstyle("text-border-style").value,W=R>0,G=B>0&&T>0,K=c-F;switch(E){case"left":K-=y;break;case"center":K-=y/2;break}var $=u-b-F,te=y+2*F,ae=b+2*F;if(W&&(r.fillStyle="rgba(".concat(_[0],",").concat(_[1],",").concat(_[2],",").concat(R*l,")")),G&&(r.strokeStyle="rgba(".concat(q[0],",").concat(q[1],",").concat(q[2],",").concat(T*l,")"),r.lineWidth=B,r.setLineDash))switch(H){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"double":r.lineWidth=B/4,r.setLineDash([]);break;case"solid":default:r.setLineDash([]);break}if(U?(r.beginPath(),Q3(r,K,$,te,ae,O)):k?(r.beginPath(),rF(r,K,$,te,ae)):(r.beginPath(),r.rect(K,$,te,ae)),W&&r.fill(),G&&r.stroke(),G&&H==="double"){var ue=B/2;r.beginPath(),U?Q3(r,K+ue,$+ue,te-2*ue,ae-2*ue,O):r.rect(K+ue,$+ue,te-2*ue,ae-2*ue),r.stroke()}r.fillStyle=V,r.strokeStyle=L,r.lineWidth=P,r.setLineDash&&r.setLineDash([])}var re=2*e.pstyle("text-outline-width").pfValue;if(re>0&&(r.lineWidth=re),e.pstyle("text-wrap").value==="wrap"){var ve=Un(o,"labelWrapCachedLines",n),le=Un(o,"labelLineHeight",n),ie=y/2,se=this.getLabelJustification(e);switch(se==="auto"||(E==="left"?se==="left"?c+=-y:se==="center"&&(c+=-ie):E==="center"?se==="left"?c+=-ie:se==="right"&&(c+=ie):E==="right"&&(se==="center"?c+=ie:se==="right"&&(c+=y))),S){case"top":u-=(ve.length-1)*le;break;case"center":case"bottom":u-=(ve.length-1)*le;break}for(var fe=0;fe<ve.length;fe++)re>0&&r.strokeText(ve[fe],c,u),r.fillText(ve[fe],c,u),u+=le}else re>0&&r.strokeText(v,c,u),r.fillText(v,c,u);M!==0&&(r.rotate(-M),r.translate(-h,-g))}}};var Vs={};Vs.drawNode=function(r,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l,c,u=e._private,h=u.rscratch,g=e.position();if(!(!Be(g.x)||!Be(g.y))&&!(s&&!e.visible())){var v=s?e.effectiveOpacity():1,m=o.usePaths(),y,b=!1,x=e.padding();l=e.width()+2*x,c=e.height()+2*x;var A;n&&(A=n,r.translate(-A.x1,-A.y1));for(var C=e.pstyle("background-image"),E=C.value,S=new Array(E.length),M=new Array(E.length),R=0,T=0;T<E.length;T++){var B=E[T],F=S[T]=B!=null&&B!=="none";if(F){var I=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",T);R++,M[T]=o.getCachedImage(B,I,function(){u.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var U=e.pstyle("background-blacken").value,k=e.pstyle("border-width").pfValue,O=e.pstyle("background-opacity").value*v,V=e.pstyle("border-color").value,L=e.pstyle("border-style").value,P=e.pstyle("border-join").value,_=e.pstyle("border-cap").value,q=e.pstyle("border-position").value,H=e.pstyle("border-dash-pattern").pfValue,W=e.pstyle("border-dash-offset").pfValue,G=e.pstyle("border-opacity").value*v,K=e.pstyle("outline-width").pfValue,$=e.pstyle("outline-color").value,te=e.pstyle("outline-style").value,ae=e.pstyle("outline-opacity").value*v,ue=e.pstyle("outline-offset").value,re=e.pstyle("corner-radius").value;re!=="auto"&&(re=e.pstyle("corner-radius").pfValue);var ve=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:O;o.eleFillStyle(r,e,Oe)},le=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G;o.colorStrokeStyle(r,V[0],V[1],V[2],Oe)},ie=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ae;o.colorStrokeStyle(r,$[0],$[1],$[2],Oe)},se=function(Oe,be,X,ce){var pe=o.nodePathCache=o.nodePathCache||[],me=mE(X==="polygon"?X+","+ce.join(","):X,""+be,""+Oe,""+re),we=pe[me],Ve,Se=!1;return we!=null?(Ve=we,Se=!0,h.pathCache=Ve):(Ve=new Path2D,pe[me]=h.pathCache=Ve),{path:Ve,cacheHit:Se}},fe=e.pstyle("shape").strValue,xe=e.pstyle("shape-polygon-points").pfValue;if(m){r.translate(g.x,g.y);var De=se(l,c,fe,xe);y=De.path,b=De.cacheHit}var ze=function(){if(!b){var Oe=g;m&&(Oe={x:0,y:0}),o.nodeShapes[o.getNodeShape(e)].draw(y||r,Oe.x,Oe.y,l,c,re,h)}m?r.fill(y):r.fill()},gt=function(){for(var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,X=u.backgrounding,ce=0,pe=0;pe<M.length;pe++){var me=e.cy().style().getIndexedStyle(e,"background-image-containment","value",pe);if(be&&me==="over"||!be&&me==="inside"){ce++;continue}S[pe]&&M[pe].complete&&!M[pe].error&&(ce++,o.drawInscribedImage(r,M[pe],e,pe,Oe))}u.backgrounding=ce!==R,X!==u.backgrounding&&e.updateStyle(!1)},it=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v;o.hasPie(e)&&(o.drawPie(r,e,be),Oe&&(m||o.nodeShapes[o.getNodeShape(e)].draw(r,g.x,g.y,l,c,re,h)))},$e=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v;o.hasStripe(e)&&(r.save(),m?r.clip(h.pathCache):(o.nodeShapes[o.getNodeShape(e)].draw(r,g.x,g.y,l,c,re,h),r.clip()),o.drawStripe(r,e,be),r.restore(),Oe&&(m||o.nodeShapes[o.getNodeShape(e)].draw(r,g.x,g.y,l,c,re,h)))},Xe=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v,be=(U>0?U:-U)*Oe,X=U>0?0:255;U!==0&&(o.colorFillStyle(r,X,X,X,be),m?r.fill(y):r.fill())},Ie=function(){if(k>0){if(r.lineWidth=k,r.lineCap=_,r.lineJoin=P,r.setLineDash)switch(L){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(H),r.lineDashOffset=W;break;case"solid":case"double":r.setLineDash([]);break}if(q!=="center"){if(r.save(),r.lineWidth*=2,q==="inside")m?r.clip(y):r.clip();else{var Oe=new Path2D;Oe.rect(-l/2-k,-c/2-k,l+2*k,c+2*k),Oe.addPath(y),r.clip(Oe,"evenodd")}m?r.stroke(y):r.stroke(),r.restore()}else m?r.stroke(y):r.stroke();if(L==="double"){r.lineWidth=k/3;var be=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",m?r.stroke(y):r.stroke(),r.globalCompositeOperation=be}r.setLineDash&&r.setLineDash([])}},Ye=function(){if(K>0){if(r.lineWidth=K,r.lineCap="butt",r.setLineDash)switch(te){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"solid":case"double":r.setLineDash([]);break}var Oe=g;m&&(Oe={x:0,y:0});var be=o.getNodeShape(e),X=k;q==="inside"&&(X=0),q==="outside"&&(X*=2);var ce=(l+X+(K+ue))/l,pe=(c+X+(K+ue))/c,me=l*ce,we=c*pe,Ve=o.nodeShapes[be].points,Se;if(m){var Ge=se(me,we,be,Ve);Se=Ge.path}if(be==="ellipse")o.drawEllipsePath(Se||r,Oe.x,Oe.y,me,we);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(be)){var Ue=0,Qe=0,st=0;be==="round-diamond"?Ue=(X+ue+K)*1.4:be==="round-heptagon"?(Ue=(X+ue+K)*1.075,st=-(X/2+ue+K)/35):be==="round-hexagon"?Ue=(X+ue+K)*1.12:be==="round-pentagon"?(Ue=(X+ue+K)*1.13,st=-(X/2+ue+K)/15):be==="round-tag"?(Ue=(X+ue+K)*1.12,Qe=(X/2+K+ue)*.07):be==="round-triangle"&&(Ue=(X+ue+K)*(Math.PI/2),st=-(X+ue/2+K)/Math.PI),Ue!==0&&(ce=(l+Ue)/l,me=l*ce,["round-hexagon","round-tag"].includes(be)||(pe=(c+Ue)/c,we=c*pe)),re=re==="auto"?TE(me,we):re;for(var ot=me/2,Le=we/2,vt=re+(X+K+ue)/2,ht=new Array(Ve.length/2),fr=new Array(Ve.length/2),zt=0;zt<Ve.length/2;zt++)ht[zt]={x:Oe.x+Qe+ot*Ve[zt*2],y:Oe.y+st+Le*Ve[zt*2+1]};var Jr,hr,xr,vr,br=ht.length;for(hr=ht[br-1],Jr=0;Jr<br;Jr++)xr=ht[Jr%br],vr=ht[(Jr+1)%br],fr[Jr]=L2(hr,xr,vr,vt),hr=xr,xr=vr;o.drawRoundPolygonPath(Se||r,Oe.x+Qe,Oe.y+st,l*ce,c*pe,Ve,fr)}else if(["roundrectangle","round-rectangle"].includes(be))re=re==="auto"?Rs(me,we):re,o.drawRoundRectanglePath(Se||r,Oe.x,Oe.y,me,we,re+(X+K+ue)/2);else if(["cutrectangle","cut-rectangle"].includes(be))re=re==="auto"?D2():re,o.drawCutRectanglePath(Se||r,Oe.x,Oe.y,me,we,null,re+(X+K+ue)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(be))re=re==="auto"?Rs(me,we):re,o.drawBottomRoundRectanglePath(Se||r,Oe.x,Oe.y,me,we,re+(X+K+ue)/2);else if(be==="barrel")o.drawBarrelPath(Se||r,Oe.x,Oe.y,me,we);else if(be.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(be)){var ei=(X+K+ue)/l;Ve=Zd(Wd(Ve,ei)),o.drawPolygonPath(Se||r,Oe.x,Oe.y,l,c,Ve)}else{var dr=(X+K+ue)/l;Ve=Zd(Wd(Ve,-dr)),o.drawPolygonPath(Se||r,Oe.x,Oe.y,l,c,Ve)}if(m?r.stroke(Se):r.stroke(),te==="double"){r.lineWidth=X/3;var ti=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",m?r.stroke(Se):r.stroke(),r.globalCompositeOperation=ti}r.setLineDash&&r.setLineDash([])}},Ke=function(){a&&o.drawNodeOverlay(r,e,g,l,c)},at=function(){a&&o.drawNodeUnderlay(r,e,g,l,c)},ke=function(){o.drawElementText(r,e,null,i)},ft=e.pstyle("ghost").value==="yes";if(ft){var pt=e.pstyle("ghost-offset-x").pfValue,Tt=e.pstyle("ghost-offset-y").pfValue,Et=e.pstyle("ghost-opacity").value,Rt=Et*v;r.translate(pt,Tt),ie(),Ye(),ve(Et*O),ze(),gt(Rt,!0),le(Et*G),Ie(),it(U!==0||k!==0),$e(U!==0||k!==0),gt(Rt,!1),Xe(Rt),r.translate(-pt,-Tt)}m&&r.translate(-g.x,-g.y),at(),m&&r.translate(g.x,g.y),ie(),Ye(),ve(),ze(),gt(v,!0),le(),Ie(),it(U!==0||k!==0),$e(U!==0||k!==0),gt(v,!1),Xe(),m&&r.translate(-g.x,-g.y),ke(),Ke(),n&&r.translate(A.x1,A.y1)}};var NS=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(n,i,a,s,o){var l=this;if(i.visible()){var c=i.pstyle("".concat(e,"-padding")).pfValue,u=i.pstyle("".concat(e,"-opacity")).value,h=i.pstyle("".concat(e,"-color")).value,g=i.pstyle("".concat(e,"-shape")).value,v=i.pstyle("".concat(e,"-corner-radius")).value;if(u>0){if(a=a||i.position(),s==null||o==null){var m=i.padding();s=i.width()+2*m,o=i.height()+2*m}l.colorFillStyle(n,h[0],h[1],h[2],u),l.nodeShapes[g].draw(n,a.x,a.y,s+c*2,o+c*2,v),n.fill()}}}};Vs.drawNodeOverlay=NS("overlay");Vs.drawNodeUnderlay=NS("underlay");Vs.hasPie=function(r){return r=r[0],r._private.hasPie};Vs.hasStripe=function(r){return r=r[0],r._private.hasStripe};Vs.drawPie=function(r,e,n,i){e=e[0],i=i||e.position();var a=e.cy().style(),s=e.pstyle("pie-size"),o=e.pstyle("pie-hole"),l=e.pstyle("pie-start-angle").pfValue,c=i.x,u=i.y,h=e.width(),g=e.height(),v=Math.min(h,g)/2,m,y=0,b=this.usePaths();if(b&&(c=0,u=0),s.units==="%"?v=v*s.pfValue:s.pfValue!==void 0&&(v=s.pfValue/2),o.units==="%"?m=v*o.pfValue:o.pfValue!==void 0&&(m=o.pfValue/2),!(m>=v))for(var x=1;x<=a.pieBackgroundN;x++){var A=e.pstyle("pie-"+x+"-background-size").value,C=e.pstyle("pie-"+x+"-background-color").value,E=e.pstyle("pie-"+x+"-background-opacity").value*n,S=A/100;S+y>1&&(S=1-y);var M=1.5*Math.PI+2*Math.PI*y;M+=l;var R=2*Math.PI*S,T=M+R;A===0||y>=1||y+S>1||(m===0?(r.beginPath(),r.moveTo(c,u),r.arc(c,u,v,M,T),r.closePath()):(r.beginPath(),r.arc(c,u,v,M,T),r.arc(c,u,m,T,M,!0),r.closePath()),this.colorFillStyle(r,C[0],C[1],C[2],E),r.fill(),y+=S)}};Vs.drawStripe=function(r,e,n,i){e=e[0],i=i||e.position();var a=e.cy().style(),s=i.x,o=i.y,l=e.width(),c=e.height(),u=0,h=this.usePaths();r.save();var g=e.pstyle("stripe-direction").value,v=e.pstyle("stripe-size");switch(g){case"vertical":break;case"righward":r.rotate(-Math.PI/2);break}var m=l,y=c;v.units==="%"?(m=m*v.pfValue,y=y*v.pfValue):v.pfValue!==void 0&&(m=v.pfValue,y=v.pfValue),h&&(s=0,o=0),o-=m/2,s-=y/2;for(var b=1;b<=a.stripeBackgroundN;b++){var x=e.pstyle("stripe-"+b+"-background-size").value,A=e.pstyle("stripe-"+b+"-background-color").value,C=e.pstyle("stripe-"+b+"-background-opacity").value*n,E=x/100;E+u>1&&(E=1-u),!(x===0||u>=1||u+E>1)&&(r.beginPath(),r.rect(s,o+y*u,m,y*E),r.closePath(),this.colorFillStyle(r,A[0],A[1],A[2],C),r.fill(),u+=E)}r.restore()};var Cn={},nF=100;Cn.getPixelRatio=function(){var r=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),n=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/n};Cn.paintCache=function(r){for(var e=this.paintCaches=this.paintCaches||[],n=!0,i,a=0;a<e.length;a++)if(i=e[a],i.context===r){n=!1;break}return n&&(i={context:r},e.push(i)),i};Cn.createGradientStyleFor=function(r,e,n,i,a){var s,o=this.usePaths(),l=n.pstyle(e+"-gradient-stop-colors").value,c=n.pstyle(e+"-gradient-stop-positions").pfValue;if(i==="radial-gradient")if(n.isEdge()){var u=n.sourceEndpoint(),h=n.targetEndpoint(),g=n.midpoint(),v=wo(u,g),m=wo(h,g);s=r.createRadialGradient(g.x,g.y,0,g.x,g.y,Math.max(v,m))}else{var y=o?{x:0,y:0}:n.position(),b=n.paddedWidth(),x=n.paddedHeight();s=r.createRadialGradient(y.x,y.y,0,y.x,y.y,Math.max(b,x))}else if(n.isEdge()){var A=n.sourceEndpoint(),C=n.targetEndpoint();s=r.createLinearGradient(A.x,A.y,C.x,C.y)}else{var E=o?{x:0,y:0}:n.position(),S=n.paddedWidth(),M=n.paddedHeight(),R=S/2,T=M/2,B=n.pstyle("background-gradient-direction").value;switch(B){case"to-bottom":s=r.createLinearGradient(E.x,E.y-T,E.x,E.y+T);break;case"to-top":s=r.createLinearGradient(E.x,E.y+T,E.x,E.y-T);break;case"to-left":s=r.createLinearGradient(E.x+R,E.y,E.x-R,E.y);break;case"to-right":s=r.createLinearGradient(E.x-R,E.y,E.x+R,E.y);break;case"to-bottom-right":case"to-right-bottom":s=r.createLinearGradient(E.x-R,E.y-T,E.x+R,E.y+T);break;case"to-top-right":case"to-right-top":s=r.createLinearGradient(E.x-R,E.y+T,E.x+R,E.y-T);break;case"to-bottom-left":case"to-left-bottom":s=r.createLinearGradient(E.x+R,E.y-T,E.x-R,E.y+T);break;case"to-top-left":case"to-left-top":s=r.createLinearGradient(E.x+R,E.y+T,E.x-R,E.y-T);break}}if(!s)return null;for(var F=c.length===l.length,I=l.length,U=0;U<I;U++)s.addColorStop(F?c[U]:U/(I-1),"rgba("+l[U][0]+","+l[U][1]+","+l[U][2]+","+a+")");return s};Cn.gradientFillStyle=function(r,e,n,i){var a=this.createGradientStyleFor(r,"background",e,n,i);if(!a)return null;r.fillStyle=a};Cn.colorFillStyle=function(r,e,n,i,a){r.fillStyle="rgba("+e+","+n+","+i+","+a+")"};Cn.eleFillStyle=function(r,e,n){var i=e.pstyle("background-fill").value;if(i==="linear-gradient"||i==="radial-gradient")this.gradientFillStyle(r,e,i,n);else{var a=e.pstyle("background-color").value;this.colorFillStyle(r,a[0],a[1],a[2],n)}};Cn.gradientStrokeStyle=function(r,e,n,i){var a=this.createGradientStyleFor(r,"line",e,n,i);if(!a)return null;r.strokeStyle=a};Cn.colorStrokeStyle=function(r,e,n,i,a){r.strokeStyle="rgba("+e+","+n+","+i+","+a+")"};Cn.eleStrokeStyle=function(r,e,n){var i=e.pstyle("line-fill").value;if(i==="linear-gradient"||i==="radial-gradient")this.gradientStrokeStyle(r,e,i,n);else{var a=e.pstyle("line-color").value;this.colorStrokeStyle(r,a[0],a[1],a[2],n)}};Cn.matchCanvasSize=function(r){var e=this,n=e.data,i=e.findContainerClientCoords(),a=i[2],s=i[3],o=e.getPixelRatio(),l=e.motionBlurPxRatio;(r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(o=l);var c=a*o,u=s*o,h;if(!(c===e.canvasWidth&&u===e.canvasHeight)){e.fontCaches=null;var g=n.canvasContainer;g.style.width=a+"px",g.style.height=s+"px";for(var v=0;v<e.CANVAS_LAYERS;v++)h=n.canvases[v],h.width=c,h.height=u,h.style.width=a+"px",h.style.height=s+"px";for(var v=0;v<e.BUFFER_COUNT;v++)h=n.bufferCanvases[v],h.width=c,h.height=u,h.style.width=a+"px",h.style.height=s+"px";e.textureMult=1,o<=1&&(h=n.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,h.width=c*e.textureMult,h.height=u*e.textureMult),e.canvasWidth=c,e.canvasHeight=u,e.pixelRatio=o}};Cn.renderTo=function(r,e,n,i){this.render({forcedContext:r,forcedZoom:e,forcedPan:n,drawAllLayers:!0,forcedPxRatio:i})};Cn.clearCanvas=function(){var r=this,e=r.data;function n(i){i.clearRect(0,0,r.canvasWidth,r.canvasHeight)}n(e.contexts[r.NODE]),n(e.contexts[r.DRAG])};Cn.render=function(r){var e=this;r=r||xE();var n=e.cy,i=r.forcedContext,a=r.drawAllLayers,s=r.drawOnlyNodeLayer,o=r.forcedZoom,l=r.forcedPan,c=r.forcedPxRatio===void 0?this.getPixelRatio():r.forcedPxRatio,u=e.data,h=u.canvasNeedsRedraw,g=e.textureOnViewport&&!i&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),v=r.motionBlur!==void 0?r.motionBlur:e.motionBlur,m=e.motionBlurPxRatio,y=n.hasCompoundNodes(),b=e.hoverData.draggingEles,x=!!(e.hoverData.selecting||e.touchData.selecting);v=v&&!i&&e.motionBlurEnabled&&!x;var A=v;i||(e.prevPxRatio!==c&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=c),!i&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),v&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(A=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!g&&(h[e.NODE]=!0,h[e.SELECT_BOX]=!0);var C=n.style(),E=n.zoom(),S=o!==void 0?o:E,M=n.pan(),R={x:M.x,y:M.y},T={zoom:E,pan:{x:M.x,y:M.y}},B=e.prevViewport,F=B===void 0||T.zoom!==B.zoom||T.pan.x!==B.pan.x||T.pan.y!==B.pan.y;!F&&!(b&&!y)&&(e.motionBlurPxRatio=1),l&&(R=l),S*=c,R.x*=c,R.y*=c;var I=e.getCachedZSortedEles();function U(le,ie,se,fe,xe){var De=le.globalCompositeOperation;le.globalCompositeOperation="destination-out",e.colorFillStyle(le,255,255,255,e.motionBlurTransparency),le.fillRect(ie,se,fe,xe),le.globalCompositeOperation=De}function k(le,ie){var se,fe,xe,De;!e.clearingMotionBlur&&(le===u.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||le===u.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(se={x:M.x*m,y:M.y*m},fe=E*m,xe=e.canvasWidth*m,De=e.canvasHeight*m):(se=R,fe=S,xe=e.canvasWidth,De=e.canvasHeight),le.setTransform(1,0,0,1,0,0),ie==="motionBlur"?U(le,0,0,xe,De):!i&&(ie===void 0||ie)&&le.clearRect(0,0,xe,De),a||(le.translate(se.x,se.y),le.scale(fe,fe)),l&&le.translate(l.x,l.y),o&&le.scale(o,o)}if(g||(e.textureDrawLastFrame=!1),g){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=n.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var O=e.data.bufferContexts[e.TEXTURE_BUFFER];O.setTransform(1,0,0,1,0,0),O.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:O,drawOnlyNodeLayer:!0,forcedPxRatio:c*e.textureMult});var T=e.textureCache.viewport={zoom:n.zoom(),pan:n.pan(),width:e.canvasWidth,height:e.canvasHeight};T.mpan={x:(0-T.pan.x)/T.zoom,y:(0-T.pan.y)/T.zoom}}h[e.DRAG]=!1,h[e.NODE]=!1;var V=u.contexts[e.NODE],L=e.textureCache.texture,T=e.textureCache.viewport;V.setTransform(1,0,0,1,0,0),v?U(V,0,0,T.width,T.height):V.clearRect(0,0,T.width,T.height);var P=C.core("outside-texture-bg-color").value,_=C.core("outside-texture-bg-opacity").value;e.colorFillStyle(V,P[0],P[1],P[2],_),V.fillRect(0,0,T.width,T.height);var E=n.zoom();k(V,!1),V.clearRect(T.mpan.x,T.mpan.y,T.width/T.zoom/c,T.height/T.zoom/c),V.drawImage(L,T.mpan.x,T.mpan.y,T.width/T.zoom/c,T.height/T.zoom/c)}else e.textureOnViewport&&!i&&(e.textureCache=null);var q=n.extent(),H=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),W=e.hideEdgesOnViewport&&H,G=[];if(G[e.NODE]=!h[e.NODE]&&v&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,G[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),G[e.DRAG]=!h[e.DRAG]&&v&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,G[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),h[e.NODE]||a||s||G[e.NODE]){var K=v&&!G[e.NODE]&&m!==1,V=i||(K?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:u.contexts[e.NODE]),$=v&&!K?"motionBlur":void 0;k(V,$),W?e.drawCachedNodes(V,I.nondrag,c,q):e.drawLayeredElements(V,I.nondrag,c,q),e.debug&&e.drawDebugPoints(V,I.nondrag),!a&&!v&&(h[e.NODE]=!1)}if(!s&&(h[e.DRAG]||a||G[e.DRAG])){var K=v&&!G[e.DRAG]&&m!==1,V=i||(K?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:u.contexts[e.DRAG]);k(V,v&&!K?"motionBlur":void 0),W?e.drawCachedNodes(V,I.drag,c,q):e.drawCachedElements(V,I.drag,c,q),e.debug&&e.drawDebugPoints(V,I.drag),!a&&!v&&(h[e.DRAG]=!1)}if(this.drawSelectionRectangle(r,k),v&&m!==1){var te=u.contexts[e.NODE],ae=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],ue=u.contexts[e.DRAG],re=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],ve=function(ie,se,fe){ie.setTransform(1,0,0,1,0,0),fe||!A?ie.clearRect(0,0,e.canvasWidth,e.canvasHeight):U(ie,0,0,e.canvasWidth,e.canvasHeight);var xe=m;ie.drawImage(se,0,0,e.canvasWidth*xe,e.canvasHeight*xe,0,0,e.canvasWidth,e.canvasHeight)};(h[e.NODE]||G[e.NODE])&&(ve(te,ae,G[e.NODE]),h[e.NODE]=!1),(h[e.DRAG]||G[e.DRAG])&&(ve(ue,re,G[e.DRAG]),h[e.DRAG]=!1)}e.prevViewport=T,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),v&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!g,e.mbFrames=0,h[e.NODE]=!0,h[e.DRAG]=!0,e.redraw()},nF)),i||n.emit("render")};var Qu;Cn.drawSelectionRectangle=function(r,e){var n=this,i=n.cy,a=n.data,s=i.style(),o=r.drawOnlyNodeLayer,l=r.drawAllLayers,c=a.canvasNeedsRedraw,u=r.forcedContext;if(n.showFps||!o&&c[n.SELECT_BOX]&&!l){var h=u||a.contexts[n.SELECT_BOX];if(e(h),n.selection[4]==1&&(n.hoverData.selecting||n.touchData.selecting)){var g=n.cy.zoom(),v=s.core("selection-box-border-width").value/g;h.lineWidth=v,h.fillStyle="rgba("+s.core("selection-box-color").value[0]+","+s.core("selection-box-color").value[1]+","+s.core("selection-box-color").value[2]+","+s.core("selection-box-opacity").value+")",h.fillRect(n.selection[0],n.selection[1],n.selection[2]-n.selection[0],n.selection[3]-n.selection[1]),v>0&&(h.strokeStyle="rgba("+s.core("selection-box-border-color").value[0]+","+s.core("selection-box-border-color").value[1]+","+s.core("selection-box-border-color").value[2]+","+s.core("selection-box-opacity").value+")",h.strokeRect(n.selection[0],n.selection[1],n.selection[2]-n.selection[0],n.selection[3]-n.selection[1]))}if(a.bgActivePosistion&&!n.hoverData.selecting){var g=n.cy.zoom(),m=a.bgActivePosistion;h.fillStyle="rgba("+s.core("active-bg-color").value[0]+","+s.core("active-bg-color").value[1]+","+s.core("active-bg-color").value[2]+","+s.core("active-bg-opacity").value+")",h.beginPath(),h.arc(m.x,m.y,s.core("active-bg-size").pfValue/g,0,2*Math.PI),h.fill()}var y=n.lastRedrawTime;if(n.showFps&&y){y=Math.round(y);var b=Math.round(1e3/y),x="1 frame = "+y+" ms = "+b+" fps";if(h.setTransform(1,0,0,1,0,0),h.fillStyle="rgba(255, 0, 0, 0.75)",h.strokeStyle="rgba(255, 0, 0, 0.75)",h.font="30px Arial",!Qu){var A=h.measureText(x);Qu=A.actualBoundingBoxAscent}h.fillText(x,0,Qu);var C=60;h.strokeRect(0,Qu+10,250,20),h.fillRect(0,Qu+10,250*Math.min(b/C,1),20)}l||(c[n.SELECT_BOX]=!1)}};function Z3(r,e,n){var i=r.createShader(e);if(r.shaderSource(i,n),r.compileShader(i),!r.getShaderParameter(i,r.COMPILE_STATUS))throw new Error(r.getShaderInfoLog(i));return i}function iF(r,e,n){var i=Z3(r,r.VERTEX_SHADER,e),a=Z3(r,r.FRAGMENT_SHADER,n),s=r.createProgram();if(r.attachShader(s,i),r.attachShader(s,a),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))throw new Error("Could not initialize shaders");return s}function aF(r,e,n){n===void 0&&(n=e);var i=r.makeOffscreenCanvas(e,n),a=i.context=i.getContext("2d");return i.clear=function(){return a.clearRect(0,0,i.width,i.height)},i.clear(),i}function G2(r){var e=r.pixelRatio,n=r.cy.zoom(),i=r.cy.pan();return{zoom:n*e,pan:{x:i.x*e,y:i.y*e}}}function sF(r){var e=r.pixelRatio,n=r.cy.zoom();return n*e}function oF(r,e,n,i,a){var s=i*n+e.x,o=a*n+e.y;return o=Math.round(r.canvasHeight-o),[s,o]}function lF(r){return r.pstyle("background-fill").value!=="solid"||r.pstyle("background-image").strValue!=="none"?!1:r.pstyle("border-width").value===0||r.pstyle("border-opacity").value===0?!0:r.pstyle("border-style").value==="solid"}function uF(r,e){if(r.length!==e.length)return!1;for(var n=0;n<r.length;n++)if(r[n]!==e[n])return!1;return!0}function ro(r,e,n){var i=r[0]/255,a=r[1]/255,s=r[2]/255,o=e,l=n||new Array(4);return l[0]=i*o,l[1]=a*o,l[2]=s*o,l[3]=o,l}function Al(r,e){var n=e||new Array(4);return n[0]=(r>>0&255)/255,n[1]=(r>>8&255)/255,n[2]=(r>>16&255)/255,n[3]=(r>>24&255)/255,n}function cF(r){return r[0]+(r[1]<<8)+(r[2]<<16)+(r[3]<<24)}function fF(r,e){var n=r.createTexture();return n.buffer=function(i){r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,i),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null)},n.deleteTexture=function(){r.deleteTexture(n)},n}function FS(r,e){switch(e){case"float":return[1,r.FLOAT,4];case"vec2":return[2,r.FLOAT,4];case"vec3":return[3,r.FLOAT,4];case"vec4":return[4,r.FLOAT,4];case"int":return[1,r.INT,4];case"ivec2":return[2,r.INT,4]}}function kS(r,e,n){switch(e){case r.FLOAT:return new Float32Array(n);case r.INT:return new Int32Array(n)}}function hF(r,e,n,i,a,s){switch(e){case r.FLOAT:return new Float32Array(n.buffer,s*i,a);case r.INT:return new Int32Array(n.buffer,s*i,a)}}function dF(r,e,n,i){var a=FS(r,e),s=Ir(a,2),o=s[0],l=s[1],c=kS(r,l,i),u=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,u),r.bufferData(r.ARRAY_BUFFER,c,r.STATIC_DRAW),l===r.FLOAT?r.vertexAttribPointer(n,o,l,!1,0,0):l===r.INT&&r.vertexAttribIPointer(n,o,l,0,0),r.enableVertexAttribArray(n),r.bindBuffer(r.ARRAY_BUFFER,null),u}function zi(r,e,n,i){var a=FS(r,n),s=Ir(a,3),o=s[0],l=s[1],c=s[2],u=kS(r,l,e*o),h=o*c,g=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,g),r.bufferData(r.ARRAY_BUFFER,e*h,r.DYNAMIC_DRAW),r.enableVertexAttribArray(i),l===r.FLOAT?r.vertexAttribPointer(i,o,l,!1,h,0):l===r.INT&&r.vertexAttribIPointer(i,o,l,h,0),r.vertexAttribDivisor(i,1),r.bindBuffer(r.ARRAY_BUFFER,null);for(var v=new Array(e),m=0;m<e;m++)v[m]=hF(r,l,u,h,o,m);return g.dataArray=u,g.stride=h,g.size=o,g.getView=function(y){return v[y]},g.setPoint=function(y,b,x){var A=v[y];A[0]=b,A[1]=x},g.bufferSubData=function(y){r.bindBuffer(r.ARRAY_BUFFER,g),y?r.bufferSubData(r.ARRAY_BUFFER,0,u,0,y*o):r.bufferSubData(r.ARRAY_BUFFER,0,u)},g}function gF(r,e,n){for(var i=9,a=new Float32Array(e*i),s=new Array(e),o=0;o<e;o++){var l=o*i*4;s[o]=new Float32Array(a.buffer,l,i)}var c=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,c),r.bufferData(r.ARRAY_BUFFER,a.byteLength,r.DYNAMIC_DRAW);for(var u=0;u<3;u++){var h=n+u;r.enableVertexAttribArray(h),r.vertexAttribPointer(h,3,r.FLOAT,!1,36,u*12),r.vertexAttribDivisor(h,1)}return r.bindBuffer(r.ARRAY_BUFFER,null),c.getMatrixView=function(g){return s[g]},c.setData=function(g,v){s[v].set(g,0)},c.bufferSubData=function(){r.bindBuffer(r.ARRAY_BUFFER,c),r.bufferSubData(r.ARRAY_BUFFER,0,a)},c}function vF(r){var e=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,e);var n=r.createTexture();return r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0),r.bindFramebuffer(r.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(i,a){r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i,a,0,r.RGBA,r.UNSIGNED_BYTE,null)},e}var W3=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function L1(){var r=new W3(9);return W3!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function J3(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function mF(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],c=e[5],u=e[6],h=e[7],g=e[8],v=n[0],m=n[1],y=n[2],b=n[3],x=n[4],A=n[5],C=n[6],E=n[7],S=n[8];return r[0]=v*i+m*o+y*u,r[1]=v*a+m*l+y*h,r[2]=v*s+m*c+y*g,r[3]=b*i+x*o+A*u,r[4]=b*a+x*l+A*h,r[5]=b*s+x*c+A*g,r[6]=C*i+E*o+S*u,r[7]=C*a+E*l+S*h,r[8]=C*s+E*c+S*g,r}function Nd(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],c=e[5],u=e[6],h=e[7],g=e[8],v=n[0],m=n[1];return r[0]=i,r[1]=a,r[2]=s,r[3]=o,r[4]=l,r[5]=c,r[6]=v*i+m*o+u,r[7]=v*a+m*l+h,r[8]=v*s+m*c+g,r}function $3(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],c=e[5],u=e[6],h=e[7],g=e[8],v=Math.sin(n),m=Math.cos(n);return r[0]=m*i+v*o,r[1]=m*a+v*l,r[2]=m*s+v*c,r[3]=m*o-v*i,r[4]=m*l-v*a,r[5]=m*c-v*s,r[6]=u,r[7]=h,r[8]=g,r}function Op(r,e,n){var i=n[0],a=n[1];return r[0]=i*e[0],r[1]=i*e[1],r[2]=i*e[2],r[3]=a*e[3],r[4]=a*e[4],r[5]=a*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function pF(r,e,n){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/n,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}var yF=(function(){function r(e,n,i,a){Fs(this,r),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.texSize=n,this.texRows=i,this.texHeight=Math.floor(n/i),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=a(e,n,n),this.scratch=a(e,n,this.texHeight,"scratch")}return ks(r,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(n){var i=n.w,a=n.h,s=this.texHeight,o=this.texSize,l=s/a,c=i*l,u=a*l;return c>o&&(l=o/i,c=i*l,u=a*l),{scale:l,texW:c,texH:u}}},{key:"draw",value:function(n,i,a){var s=this;if(this.locked)throw new Error("can't draw, atlas is locked");var o=this.texSize,l=this.texRows,c=this.texHeight,u=this.getScale(i),h=u.scale,g=u.texW,v=u.texH,m=function(E,S){if(a&&S){var M=S.context,R=E.x,T=E.row,B=R,F=c*T;M.save(),M.translate(B,F),M.scale(h,h),a(M,i),M.restore()}},y=[null,null],b=function(){m(s.freePointer,s.canvas),y[0]={x:s.freePointer.x,y:s.freePointer.row*c,w:g,h:v},y[1]={x:s.freePointer.x+g,y:s.freePointer.row*c,w:0,h:v},s.freePointer.x+=g,s.freePointer.x==o&&(s.freePointer.x=0,s.freePointer.row++)},x=function(){var E=s.scratch,S=s.canvas;E.clear(),m({x:0,row:0},E);var M=o-s.freePointer.x,R=g-M,T=c;{var B=s.freePointer.x,F=s.freePointer.row*c,I=M;S.context.drawImage(E,0,0,I,T,B,F,I,T),y[0]={x:B,y:F,w:I,h:v}}{var U=M,k=(s.freePointer.row+1)*c,O=R;S&&S.context.drawImage(E,U,0,O,T,0,k,O,T),y[1]={x:0,y:k,w:O,h:v}}s.freePointer.x=R,s.freePointer.row++},A=function(){s.freePointer.x=0,s.freePointer.row++};if(this.freePointer.x+g<=o)b();else{if(this.freePointer.row>=l-1)return!1;this.freePointer.x===o?(A(),b()):this.enableWrapping?x():(A(),b())}return this.keyToLocation.set(n,y),this.needsBuffer=!0,y}},{key:"getOffsets",value:function(n){return this.keyToLocation.get(n)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(n){if(this.locked)return!1;var i=this.texSize,a=this.texRows,s=this.getScale(n),o=s.texW;return this.freePointer.x+o>i?this.freePointer.row<a-1:!0}},{key:"bufferIfNeeded",value:function(n){this.texture||(this.texture=fF(n,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])})(),AF=(function(){function r(e,n,i,a){Fs(this,r),this.r=e,this.texSize=n,this.texRows=i,this.createTextureCanvas=a,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return ks(r,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var n=this.r,i=this.texSize,a=this.texRows,s=this.createTextureCanvas;return new yF(n,i,a,s)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var n=this.r,i=this.texSize,a=this.texRows,s=this.createTextureCanvas,o=Math.floor(i/a);this.scratch=s(n,i,o,"scratch")}return this.scratch}},{key:"draw",value:function(n,i,a){var s=this.styleKeyToAtlas.get(n);return s||(s=this.atlases[this.atlases.length-1],(!s||!s.canFit(i))&&(s&&s.lock(),s=this._createAtlas(),this.atlases.push(s)),s.draw(n,i,a),this.styleKeyToAtlas.set(n,s)),s}},{key:"getAtlas",value:function(n){return this.styleKeyToAtlas.get(n)}},{key:"hasAtlas",value:function(n){return this.styleKeyToAtlas.has(n)}},{key:"markKeyForGC",value:function(n){this.markedKeys.add(n)}},{key:"gc",value:function(){var n=this,i=this.markedKeys;if(i.size===0){console.log("nothing to garbage collect");return}var a=[],s=new Map,o=null,l=On(this.atlases),c;try{var u=function(){var g=c.value,v=g.getKeys(),m=xF(i,v);if(m.size===0)return a.push(g),v.forEach(function(M){return s.set(M,g)}),1;o||(o=n._createAtlas(),a.push(o));var y=On(v),b;try{for(y.s();!(b=y.n()).done;){var x=b.value;if(!m.has(x)){var A=g.getOffsets(x),C=Ir(A,2),E=C[0],S=C[1];o.canFit({w:E.w+S.w,h:E.h})||(o.lock(),o=n._createAtlas(),a.push(o)),g.canvas&&(n._copyTextureToNewAtlas(x,g,o),s.set(x,o))}}}catch(M){y.e(M)}finally{y.f()}g.dispose()};for(l.s();!(c=l.n()).done;)u()}catch(h){l.e(h)}finally{l.f()}this.atlases=a,this.styleKeyToAtlas=s,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(n,i,a){var s=i.getOffsets(n),o=Ir(s,2),l=o[0],c=o[1];if(c.w===0)a.draw(n,l,function(v){v.drawImage(i.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h)});else{var u=this._getScratchCanvas();u.clear(),u.context.drawImage(i.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h),u.context.drawImage(i.canvas,c.x,c.y,c.w,c.h,l.w,0,c.w,c.h);var h=l.w+c.w,g=l.h;a.draw(n,{w:h,h:g},function(v){v.drawImage(u,0,0,h,g,0,0,h,g)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])})();function xF(r,e){return r.intersection?r.intersection(e):new Set(Hd(r).filter(function(n){return e.has(n)}))}var bF=(function(){function r(e,n){Fs(this,r),this.r=e,this.globalOptions=n,this.atlasSize=n.webglTexSize,this.maxAtlasesPerBatch=n.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return ks(r,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(n,i){var a=this.globalOptions,s=a.webglTexSize,o=a.createTextureCanvas,l=i.texRows,c=this._cacheScratchCanvas(o),u=new AF(this.r,s,l,c);this.collections.set(n,u)}},{key:"addRenderType",value:function(n,i){var a=i.collection;if(!this.collections.has(a))throw new Error("invalid atlas collection name '".concat(a,"'"));var s=this.collections.get(a),o=et({type:n,atlasCollection:s},i);this.renderTypes.set(n,o)}},{key:"getRenderTypeOpts",value:function(n){return this.renderTypes.get(n)}},{key:"getAtlasCollection",value:function(n){return this.collections.get(n)}},{key:"_cacheScratchCanvas",value:function(n){var i=-1,a=-1,s=null;return function(o,l,c,u){return u?((!s||l!=i||c!=a)&&(i=l,a=c,s=n(o,l,c)),s):n(o,l,c)}}},{key:"_key",value:function(n,i){return"".concat(n,"-").concat(i)}},{key:"invalidate",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.forceRedraw,o=s===void 0?!1:s,l=a.filterEle,c=l===void 0?function(){return!0}:l,u=a.filterType,h=u===void 0?function(){return!0}:u,g=!1,v=!1,m=On(n),y;try{for(m.s();!(y=m.n()).done;){var b=y.value;if(c(b)){var x=On(this.renderTypes.values()),A;try{var C=function(){var S=A.value,M=S.type;if(h(M)){var R=i.collections.get(S.collection),T=S.getKey(b),B=Array.isArray(T)?T:[T];if(o)B.forEach(function(k){return R.markKeyForGC(k)}),v=!0;else{var F=S.getID?S.getID(b):b.id(),I=i._key(M,F),U=i.typeAndIdToKey.get(I);U!==void 0&&!uF(B,U)&&(g=!0,i.typeAndIdToKey.delete(I),U.forEach(function(k){return R.markKeyForGC(k)}))}}};for(x.s();!(A=x.n()).done;)C()}catch(E){x.e(E)}finally{x.f()}}}}catch(E){m.e(E)}finally{m.f()}return v&&(this.gc(),g=!1),g}},{key:"gc",value:function(){var n=On(this.collections.values()),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;a.gc()}}catch(s){n.e(s)}finally{n.f()}}},{key:"getOrCreateAtlas",value:function(n,i,a,s){var o=this.renderTypes.get(i),l=this.collections.get(o.collection),c=!1,u=l.draw(s,a,function(v){o.drawClipped?(v.save(),v.beginPath(),v.rect(0,0,a.w,a.h),v.clip(),o.drawElement(v,n,a,!0,!0),v.restore()):o.drawElement(v,n,a,!0,!0),c=!0});if(c){var h=o.getID?o.getID(n):n.id(),g=this._key(i,h);this.typeAndIdToKey.has(g)?this.typeAndIdToKey.get(g).push(s):this.typeAndIdToKey.set(g,[s])}return u}},{key:"getAtlasInfo",value:function(n,i){var a=this,s=this.renderTypes.get(i),o=s.getKey(n),l=Array.isArray(o)?o:[o];return l.map(function(c){var u=s.getBoundingBox(n,c),h=a.getOrCreateAtlas(n,i,u,c),g=h.getOffsets(c),v=Ir(g,2),m=v[0],y=v[1];return{atlas:h,tex:m,tex1:m,tex2:y,bb:u}})}},{key:"getDebugInfo",value:function(){var n=[],i=On(this.collections),a;try{for(i.s();!(a=i.n()).done;){var s=Ir(a.value,2),o=s[0],l=s[1],c=l.getCounts(),u=c.keyCount,h=c.atlasCount;n.push({type:o,keyCount:u,atlasCount:h})}}catch(g){i.e(g)}finally{i.f()}return n}}])})(),wF=(function(){function r(e){Fs(this,r),this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.batchAtlases=[]}return ks(r,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(n,i){return i})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(n){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(n):!0}},{key:"getAtlasIndexForBatch",value:function(n){var i=this.batchAtlases.indexOf(n);if(i<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(n),i=this.batchAtlases.length-1}return i}}])})(),CF=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,EF=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,SF=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,TF=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,Dc={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},i0={IGNORE:1,USE_BB:2},_1=0,e4=1,t4=2,z1=3,xl=4,Wh=5,Zu=6,Wu=7,MF=(function(){function r(e,n,i){Fs(this,r),this.r=e,this.gl=n,this.maxInstances=i.webglBatchSize,this.atlasSize=i.webglTexSize,this.bgColor=i.bgColor,this.debug=i.webglDebug,this.batchDebugInfo=[],i.enableWrapping=!0,i.createTextureCanvas=aF,this.atlasManager=new bF(e,i),this.batchManager=new wF(i),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(Dc.SCREEN),this.pickingProgram=this._createShaderProgram(Dc.PICKING),this.vao=this._createVAO()}return ks(r,[{key:"addAtlasCollection",value:function(n,i){this.atlasManager.addAtlasCollection(n,i)}},{key:"addTextureAtlasRenderType",value:function(n,i){this.atlasManager.addRenderType(n,i)}},{key:"addSimpleShapeRenderType",value:function(n,i){this.simpleShapeOptions.set(n,i)}},{key:"invalidate",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.type,s=this.atlasManager;return a?s.invalidate(n,{filterType:function(l){return l===a},forceRedraw:!0}):s.invalidate(n)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(n){var i=this.gl,a=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(_1,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(xl," || aVertType == ").concat(Wu,` 
             || aVertType == `).concat(Wh," || aVertType == ").concat(Zu,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(e4,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(t4,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(z1,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),s=this.batchManager.getIndexArray(),o=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(s.map(function(u){return"uniform sampler2D uTexture".concat(u,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(CF,`
      `).concat(EF,`
      `).concat(SF,`
      `).concat(TF,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(_1,`) {
          // look up the texel from the texture unit
          `).concat(s.map(function(u){return"if(vAtlasId == ".concat(u,") outColor = texture(uTexture").concat(u,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(z1,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(xl,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(xl," || vVertType == ").concat(Wu,` 
          || vVertType == `).concat(Wh," || vVertType == ").concat(Zu,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(xl,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(Wu,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(Wu,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(n.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),l=iF(i,a,o);l.aPosition=i.getAttribLocation(l,"aPosition"),l.aIndex=i.getAttribLocation(l,"aIndex"),l.aVertType=i.getAttribLocation(l,"aVertType"),l.aTransform=i.getAttribLocation(l,"aTransform"),l.aAtlasId=i.getAttribLocation(l,"aAtlasId"),l.aTex=i.getAttribLocation(l,"aTex"),l.aPointAPointB=i.getAttribLocation(l,"aPointAPointB"),l.aPointCPointD=i.getAttribLocation(l,"aPointCPointD"),l.aLineWidth=i.getAttribLocation(l,"aLineWidth"),l.aColor=i.getAttribLocation(l,"aColor"),l.aCornerRadius=i.getAttribLocation(l,"aCornerRadius"),l.aBorderColor=i.getAttribLocation(l,"aBorderColor"),l.uPanZoomMatrix=i.getUniformLocation(l,"uPanZoomMatrix"),l.uAtlasSize=i.getUniformLocation(l,"uAtlasSize"),l.uBGColor=i.getUniformLocation(l,"uBGColor"),l.uZoom=i.getUniformLocation(l,"uZoom"),l.uTextures=[];for(var c=0;c<this.batchManager.getMaxAtlasesPerBatch();c++)l.uTextures.push(i.getUniformLocation(l,"uTexture".concat(c)));return l}},{key:"_createVAO",value:function(){var n=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=n.length/2;var i=this.maxInstances,a=this.gl,s=this.program,o=a.createVertexArray();return a.bindVertexArray(o),dF(a,"vec2",s.aPosition,n),this.transformBuffer=gF(a,i,s.aTransform),this.indexBuffer=zi(a,i,"vec4",s.aIndex),this.vertTypeBuffer=zi(a,i,"int",s.aVertType),this.atlasIdBuffer=zi(a,i,"int",s.aAtlasId),this.texBuffer=zi(a,i,"vec4",s.aTex),this.pointAPointBBuffer=zi(a,i,"vec4",s.aPointAPointB),this.pointCPointDBuffer=zi(a,i,"vec4",s.aPointCPointD),this.lineWidthBuffer=zi(a,i,"vec2",s.aLineWidth),this.colorBuffer=zi(a,i,"vec4",s.aColor),this.cornerRadiusBuffer=zi(a,i,"vec4",s.aCornerRadius),this.borderColorBuffer=zi(a,i,"vec4",s.aBorderColor),a.bindVertexArray(null),o}},{key:"buffers",get:function(){var n=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(i){return As(i,"Buffer")}).map(function(i){return n[i]})),this._buffers}},{key:"startFrame",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Dc.SCREEN;this.panZoomMatrix=n,this.renderTarget=i,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(n,i){return n.visible()?i&&i.isVisible?i.isVisible(n):!0:!1}},{key:"drawTexture",value:function(n,i,a){var s=this.atlasManager,o=this.batchManager,l=s.getRenderTypeOpts(a);if(this._isVisible(n,l)&&!(n.isEdge()&&!this._isValidEdge(n))){if(this.renderTarget.picking&&l.getTexPickingMode){var c=l.getTexPickingMode(n);if(c===i0.IGNORE)return;if(c==i0.USE_BB){this.drawPickingRectangle(n,i,a);return}}var u=s.getAtlasInfo(n,a),h=On(u),g;try{for(h.s();!(g=h.n()).done;){var v=g.value,m=v.atlas,y=v.tex1,b=v.tex2;o.canAddToCurrentBatch(m)||this.endBatch();for(var x=o.getAtlasIndexForBatch(m),A=0,C=[[y,!0],[b,!1]];A<C.length;A++){var E=Ir(C[A],2),S=E[0],M=E[1];if(S.w!=0){var R=this.instanceCount;this.vertTypeBuffer.getView(R)[0]=_1;var T=this.indexBuffer.getView(R);Al(i,T);var B=this.atlasIdBuffer.getView(R);B[0]=x;var F=this.texBuffer.getView(R);F[0]=S.x,F[1]=S.y,F[2]=S.w,F[3]=S.h;var I=this.transformBuffer.getMatrixView(R);this.setTransformMatrix(n,I,l,v,M),this.instanceCount++,M||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(U){h.e(U)}finally{h.f()}}}},{key:"setTransformMatrix",value:function(n,i,a,s){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,l=0;if(a.shapeProps&&a.shapeProps.padding&&(l=n.pstyle(a.shapeProps.padding).pfValue),s){var c=s.bb,u=s.tex1,h=s.tex2,g=u.w/(u.w+h.w);o||(g=1-g);var v=this._getAdjustedBB(c,l,o,g);this._applyTransformMatrix(i,v,a,n)}else{var m=a.getBoundingBox(n),y=this._getAdjustedBB(m,l,!0,1);this._applyTransformMatrix(i,y,a,n)}}},{key:"_applyTransformMatrix",value:function(n,i,a,s){var o,l;J3(n);var c=a.getRotation?a.getRotation(s):0;if(c!==0){var u=a.getRotationPoint(s),h=u.x,g=u.y;Nd(n,n,[h,g]),$3(n,n,c);var v=a.getRotationOffset(s);o=v.x+(i.xOffset||0),l=v.y+(i.yOffset||0)}else o=i.x1,l=i.y1;Nd(n,n,[o,l]),Op(n,n,[i.w,i.h])}},{key:"_getAdjustedBB",value:function(n,i,a,s){var o=n.x1,l=n.y1,c=n.w,u=n.h,h=n.yOffset;i&&(o-=i,l-=i,c+=2*i,u+=2*i);var g=0,v=c*s;return a&&s<1?c=v:!a&&s<1&&(g=c-v,o+=g,c=v),{x1:o,y1:l,w:c,h:u,xOffset:g,yOffset:h}}},{key:"drawPickingRectangle",value:function(n,i,a){var s=this.atlasManager.getRenderTypeOpts(a),o=this.instanceCount;this.vertTypeBuffer.getView(o)[0]=xl;var l=this.indexBuffer.getView(o);Al(i,l);var c=this.colorBuffer.getView(o);ro([0,0,0],1,c);var u=this.transformBuffer.getMatrixView(o);this.setTransformMatrix(n,u,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(n,i,a){var s=this.simpleShapeOptions.get(a);if(this._isVisible(n,s)){var o=s.shapeProps,l=this._getVertTypeForShape(n,o.shape);if(l===void 0||s.isSimple&&!s.isSimple(n)){this.drawTexture(n,i,a);return}var c=this.instanceCount;if(this.vertTypeBuffer.getView(c)[0]=l,l===Wh||l===Zu){var u=s.getBoundingBox(n),h=this._getCornerRadius(n,o.radius,u),g=this.cornerRadiusBuffer.getView(c);g[0]=h,g[1]=h,g[2]=h,g[3]=h,l===Zu&&(g[0]=0,g[2]=0)}var v=this.indexBuffer.getView(c);Al(i,v);var m=n.pstyle(o.color).value,y=n.pstyle(o.opacity).value,b=this.colorBuffer.getView(c);ro(m,y,b);var x=this.lineWidthBuffer.getView(c);if(x[0]=0,x[1]=0,o.border){var A=n.pstyle("border-width").value;if(A>0){var C=n.pstyle("border-color").value,E=n.pstyle("border-opacity").value,S=this.borderColorBuffer.getView(c);ro(C,E,S);var M=n.pstyle("border-position").value;if(M==="inside")x[0]=0,x[1]=-A;else if(M==="outside")x[0]=A,x[1]=0;else{var R=A/2;x[0]=R,x[1]=-R}}}var T=this.transformBuffer.getMatrixView(c);this.setTransformMatrix(n,T,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(n,i){var a=n.pstyle(i).value;switch(a){case"rectangle":return xl;case"ellipse":return Wu;case"roundrectangle":case"round-rectangle":return Wh;case"bottom-round-rectangle":return Zu;default:return}}},{key:"_getCornerRadius",value:function(n,i,a){var s=a.w,o=a.h;if(n.pstyle(i).value==="auto")return Rs(s,o);var l=n.pstyle(i).pfValue,c=s/2,u=o/2;return Math.min(l,u,c)}},{key:"drawEdgeArrow",value:function(n,i,a){if(n.visible()){var s=n._private.rscratch,o,l,c;if(a==="source"?(o=s.arrowStartX,l=s.arrowStartY,c=s.srcArrowAngle):(o=s.arrowEndX,l=s.arrowEndY,c=s.tgtArrowAngle),!(isNaN(o)||o==null||isNaN(l)||l==null||isNaN(c)||c==null)){var u=n.pstyle(a+"-arrow-shape").value;if(u!=="none"){var h=n.pstyle(a+"-arrow-color").value,g=n.pstyle("opacity").value,v=n.pstyle("line-opacity").value,m=g*v,y=n.pstyle("width").pfValue,b=n.pstyle("arrow-scale").value,x=this.r.getArrowWidth(y,b),A=this.instanceCount,C=this.transformBuffer.getMatrixView(A);J3(C),Nd(C,C,[o,l]),Op(C,C,[x,x]),$3(C,C,c),this.vertTypeBuffer.getView(A)[0]=z1;var E=this.indexBuffer.getView(A);Al(i,E);var S=this.colorBuffer.getView(A);ro(h,m,S),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(n,i){if(n.visible()){var a=this._getEdgePoints(n);if(a){var s=n.pstyle("opacity").value,o=n.pstyle("line-opacity").value,l=n.pstyle("width").pfValue,c=n.pstyle("line-color").value,u=s*o;if(a.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),a.length==4){var h=this.instanceCount;this.vertTypeBuffer.getView(h)[0]=e4;var g=this.indexBuffer.getView(h);Al(i,g);var v=this.colorBuffer.getView(h);ro(c,u,v);var m=this.lineWidthBuffer.getView(h);m[0]=l;var y=this.pointAPointBBuffer.getView(h);y[0]=a[0],y[1]=a[1],y[2]=a[2],y[3]=a[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var b=0;b<a.length-2;b+=2){var x=this.instanceCount;this.vertTypeBuffer.getView(x)[0]=t4;var A=this.indexBuffer.getView(x);Al(i,A);var C=this.colorBuffer.getView(x);ro(c,u,C);var E=this.lineWidthBuffer.getView(x);E[0]=l;var S=a[b-2],M=a[b-1],R=a[b],T=a[b+1],B=a[b+2],F=a[b+3],I=a[b+4],U=a[b+5];b==0&&(S=2*R-B+.001,M=2*T-F+.001),b==a.length-4&&(I=2*B-R+.001,U=2*F-T+.001);var k=this.pointAPointBBuffer.getView(x);k[0]=S,k[1]=M,k[2]=R,k[3]=T;var O=this.pointCPointDBuffer.getView(x);O[0]=B,O[1]=F,O[2]=I,O[3]=U,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(n){var i=n._private.rscratch;return!(i.badLine||i.allpts==null||isNaN(i.allpts[0]))}},{key:"_getEdgePoints",value:function(n){var i=n._private.rscratch;if(this._isValidEdge(n)){var a=i.allpts;if(a.length==4)return a;var s=this._getNumSegments(n);return this._getCurveSegmentPoints(a,s)}}},{key:"_getNumSegments",value:function(n){var i=15;return Math.min(Math.max(i,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(n,i){if(n.length==4)return n;for(var a=Array((i+1)*2),s=0;s<=i;s++)if(s==0)a[0]=n[0],a[1]=n[1];else if(s==i)a[s*2]=n[n.length-2],a[s*2+1]=n[n.length-1];else{var o=s/i;this._setCurvePoint(n,o,a,s*2)}return a}},{key:"_setCurvePoint",value:function(n,i,a,s){if(n.length<=2)a[s]=n[0],a[s+1]=n[1];else{for(var o=Array(n.length-2),l=0;l<o.length;l+=2){var c=(1-i)*n[l]+i*n[l+2],u=(1-i)*n[l+1]+i*n[l+3];o[l]=c,o[l+1]=u}return this._setCurvePoint(o,i,a,s)}}},{key:"endBatch",value:function(){var n=this.gl,i=this.vao,a=this.vertexCount,s=this.instanceCount;if(s!==0){var o=this.renderTarget.picking?this.pickingProgram:this.program;n.useProgram(o),n.bindVertexArray(i);var l=On(this.buffers),c;try{for(l.s();!(c=l.n()).done;){var u=c.value;u.bufferSubData(s)}}catch(y){l.e(y)}finally{l.f()}for(var h=this.batchManager.getAtlases(),g=0;g<h.length;g++)h[g].bufferIfNeeded(n);for(var v=0;v<h.length;v++)n.activeTexture(n.TEXTURE0+v),n.bindTexture(n.TEXTURE_2D,h[v].texture),n.uniform1i(o.uTextures[v],v);n.uniform1f(o.uZoom,sF(this.r)),n.uniformMatrix3fv(o.uPanZoomMatrix,!1,this.panZoomMatrix),n.uniform1i(o.uAtlasSize,this.batchManager.getAtlasSize());var m=ro(this.bgColor,1);n.uniform4fv(o.uBGColor,m),n.drawArraysInstanced(n.TRIANGLES,0,a,s),n.bindVertexArray(null),n.bindTexture(n.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:s,atlasCount:h.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var n=this.atlasManager.getDebugInfo(),i=n.reduce(function(o,l){return o+l.atlasCount},0),a=this.batchDebugInfo,s=a.reduce(function(o,l){return o+l.count},0);return{atlasInfo:n,totalAtlases:i,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:a.length,batchInfo:a,totalInstances:s}}}])})(),US={};US.initWebgl=function(r,e){var n=this,i=n.data.contexts[n.WEBGL];r.bgColor=DF(n),r.webglTexSize=Math.min(r.webglTexSize,i.getParameter(i.MAX_TEXTURE_SIZE)),r.webglTexRows=Math.min(r.webglTexRows,54),r.webglTexRowsNodes=Math.min(r.webglTexRowsNodes,54),r.webglBatchSize=Math.min(r.webglBatchSize,16384),r.webglTexPerBatch=Math.min(r.webglTexPerBatch,i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS)),n.webglDebug=r.webglDebug,n.webglDebugShowAtlases=r.webglDebugShowAtlases,n.pickingFrameBuffer=vF(i),n.pickingFrameBuffer.needsDraw=!0,n.drawing=new MF(n,i,r);var a=function(g){return function(v){return n.getTextAngle(v,g)}},s=function(g){return function(v){var m=v.pstyle(g);return m&&m.value}},o=function(g){return function(v){return v.pstyle("".concat(g,"-opacity")).value>0}},l=function(g){var v=g.pstyle("text-events").strValue==="yes";return v?i0.USE_BB:i0.IGNORE},c=function(g){var v=g.position(),m=v.x,y=v.y,b=g.outerWidth(),x=g.outerHeight();return{w:b,h:x,x1:m-b/2,y1:y-x/2}};n.drawing.addAtlasCollection("node",{texRows:r.webglTexRowsNodes}),n.drawing.addAtlasCollection("label",{texRows:r.webglTexRows}),n.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement}),n.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:c,isSimple:lF,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),n.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:c,isVisible:o("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),n.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:c,isVisible:o("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),n.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:l,getKey:G1(e.getLabelKey,null),getBoundingBox:q1(e.getLabelBox,null),drawClipped:!0,drawElement:e.drawLabel,getRotation:a(null),getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:s("label")}),n.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:l,getKey:G1(e.getSourceLabelKey,"source"),getBoundingBox:q1(e.getSourceLabelBox,"source"),drawClipped:!0,drawElement:e.drawSourceLabel,getRotation:a("source"),getRotationPoint:e.getSourceLabelRotationPoint,getRotationOffset:e.getSourceLabelRotationOffset,isVisible:s("source-label")}),n.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:l,getKey:G1(e.getTargetLabelKey,"target"),getBoundingBox:q1(e.getTargetLabelBox,"target"),drawClipped:!0,drawElement:e.drawTargetLabel,getRotation:a("target"),getRotationPoint:e.getTargetLabelRotationPoint,getRotationOffset:e.getTargetLabelRotationOffset,isVisible:s("target-label")});var u=of(function(){console.log("garbage collect flag set"),n.data.gc=!0},1e4);n.onUpdateEleCalcs(function(h,g){var v=!1;g&&g.length>0&&(v|=n.drawing.invalidate(g)),v&&u()}),RF(n)};function DF(r){var e=r.cy.container(),n=e&&e.style&&e.style.backgroundColor||"white";return uE(n)}function VS(r,e){var n=r._private.rscratch;return Un(n,"labelWrapCachedLines",e)||[]}var G1=function(e,n){return function(i){var a=e(i),s=VS(i,n);return s.length>1?s.map(function(o,l){return"".concat(a,"_").concat(l)}):a}},q1=function(e,n){return function(i,a){var s=e(i);if(typeof a=="string"){var o=a.indexOf("_");if(o>0){var l=Number(a.substring(o+1)),c=VS(i,n),u=s.h/c.length,h=u*l,g=s.y1+h;return{x1:s.x1,w:s.w,y1:g,h:u,yOffset:h}}}return s}};function RF(r){{var e=r.render;r.render=function(s){s=s||{};var o=r.cy;r.webgl&&(o.zoom()>DS?(BF(r),e.call(r,s)):(IF(r),PS(r,s,Dc.SCREEN)))}}{var n=r.matchCanvasSize;r.matchCanvasSize=function(s){n.call(r,s),r.pickingFrameBuffer.setFramebufferAttachmentSizes(r.canvasWidth,r.canvasHeight),r.pickingFrameBuffer.needsDraw=!0}}r.findNearestElements=function(s,o,l,c){return OF(r,s,o)};{var i=r.invalidateCachedZSortedEles;r.invalidateCachedZSortedEles=function(){i.call(r),r.pickingFrameBuffer.needsDraw=!0}}{var a=r.notify;r.notify=function(s,o){a.call(r,s,o),s==="viewport"||s==="bounds"?r.pickingFrameBuffer.needsDraw=!0:s==="background"&&r.drawing.invalidate(o,{type:"node-body"})}}}function BF(r){var e=r.data.contexts[r.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function IF(r){var e=function(i){i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,r.canvasWidth,r.canvasHeight),i.restore()};e(r.data.contexts[r.NODE]),e(r.data.contexts[r.DRAG])}function NF(r){var e=r.canvasWidth,n=r.canvasHeight,i=G2(r),a=i.pan,s=i.zoom,o=L1();Nd(o,o,[a.x,a.y]),Op(o,o,[s,s]);var l=L1();pF(l,e,n);var c=L1();return mF(c,l,o),c}function OS(r,e){var n=r.canvasWidth,i=r.canvasHeight,a=G2(r),s=a.pan,o=a.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,n,i),e.translate(s.x,s.y),e.scale(o,o)}function FF(r,e){r.drawSelectionRectangle(e,function(n){return OS(r,n)})}function kF(r){var e=r.data.contexts[r.NODE];e.save(),OS(r,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function UF(r){var e=function(a,s,o){for(var l=a.atlasManager.getAtlasCollection(s),c=r.data.contexts[r.NODE],u=l.atlases,h=0;h<u.length;h++){var g=u[h],v=g.canvas;if(v){var m=v.width,y=v.height,b=m*h,x=v.height*o,A=.4;c.save(),c.scale(A,A),c.drawImage(v,b,x),c.strokeStyle="black",c.rect(b,x,m,y),c.stroke(),c.restore()}}},n=0;e(r.drawing,"node",n++),e(r.drawing,"label",n++)}function VF(r,e,n,i,a){var s,o,l,c,u=G2(r),h=u.pan,g=u.zoom;{var v=oF(r,h,g,e,n),m=Ir(v,2),y=m[0],b=m[1],x=6;s=y-x/2,o=b-x/2,l=x,c=x}if(l===0||c===0)return[];var A=r.data.contexts[r.WEBGL];A.bindFramebuffer(A.FRAMEBUFFER,r.pickingFrameBuffer),r.pickingFrameBuffer.needsDraw&&(A.viewport(0,0,A.canvas.width,A.canvas.height),PS(r,null,Dc.PICKING),r.pickingFrameBuffer.needsDraw=!1);var C=l*c,E=new Uint8Array(C*4);A.readPixels(s,o,l,c,A.RGBA,A.UNSIGNED_BYTE,E),A.bindFramebuffer(A.FRAMEBUFFER,null);for(var S=new Set,M=0;M<C;M++){var R=E.slice(M*4,M*4+4),T=cF(R)-1;T>=0&&S.add(T)}return S}function OF(r,e,n){var i=VF(r,e,n),a=r.getCachedZSortedEles(),s,o,l=On(i),c;try{for(l.s();!(c=l.n()).done;){var u=c.value,h=a[u];if(!s&&h.isNode()&&(s=h),!o&&h.isEdge()&&(o=h),s&&o)break}}catch(g){l.e(g)}finally{l.f()}return[s,o].filter(Boolean)}function Y1(r,e,n){var i=r.drawing;e+=1,n.isNode()?(i.drawNode(n,e,"node-underlay"),i.drawNode(n,e,"node-body"),i.drawTexture(n,e,"label"),i.drawNode(n,e,"node-overlay")):(i.drawEdgeLine(n,e),i.drawEdgeArrow(n,e,"source"),i.drawEdgeArrow(n,e,"target"),i.drawTexture(n,e,"label"),i.drawTexture(n,e,"edge-source-label"),i.drawTexture(n,e,"edge-target-label"))}function PS(r,e,n){var i;r.webglDebug&&(i=performance.now());var a=r.drawing,s=0;if(n.screen&&r.data.canvasNeedsRedraw[r.SELECT_BOX]&&FF(r,e),r.data.canvasNeedsRedraw[r.NODE]||n.picking){var o=r.data.contexts[r.WEBGL];n.screen?(o.clearColor(0,0,0,0),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA)):o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.viewport(0,0,o.canvas.width,o.canvas.height);var l=NF(r),c=r.getCachedZSortedEles();if(s=c.length,a.startFrame(l,n),n.screen){for(var u=0;u<c.nondrag.length;u++)Y1(r,u,c.nondrag[u]);for(var h=0;h<c.drag.length;h++)Y1(r,h,c.drag[h])}else if(n.picking)for(var g=0;g<c.length;g++)Y1(r,g,c[g]);a.endFrame(),n.screen&&r.webglDebugShowAtlases&&(kF(r),UF(r)),r.data.canvasNeedsRedraw[r.NODE]=!1,r.data.canvasNeedsRedraw[r.DRAG]=!1}if(r.webglDebug){var v=performance.now(),m=!1,y=Math.ceil(v-i),b=a.getDebugInfo(),x=["".concat(s," elements"),"".concat(b.totalInstances," instances"),"".concat(b.batchCount," batches"),"".concat(b.totalAtlases," atlases"),"".concat(b.wrappedCount," wrapped textures"),"".concat(b.simpleCount," simple shapes")].join(", ");if(m)console.log("WebGL (".concat(n.name,") - time ").concat(y,"ms, ").concat(x));else{console.log("WebGL (".concat(n.name,") - frame time ").concat(y,"ms")),console.log("Totals:"),console.log("  ".concat(x)),console.log("Texture Atlases Used:");var A=b.atlasInfo,C=On(A),E;try{for(C.s();!(E=C.n()).done;){var S=E.value;console.log("  ".concat(S.type,": ").concat(S.keyCount," keys, ").concat(S.atlasCount," atlases"))}}catch(M){C.e(M)}finally{C.f()}console.log("")}}r.data.gc&&(console.log("Garbage Collect!"),r.data.gc=!1,a.gc())}var Os={};Os.drawPolygonPath=function(r,e,n,i,a,s){var o=i/2,l=a/2;r.beginPath&&r.beginPath(),r.moveTo(e+o*s[0],n+l*s[1]);for(var c=1;c<s.length/2;c++)r.lineTo(e+o*s[c*2],n+l*s[c*2+1]);r.closePath()};Os.drawRoundPolygonPath=function(r,e,n,i,a,s,o){o.forEach(function(l){return AS(r,l)}),r.closePath()};Os.drawRoundRectanglePath=function(r,e,n,i,a,s){var o=i/2,l=a/2,c=s==="auto"?Rs(i,a):Math.min(s,l,o);r.beginPath&&r.beginPath(),r.moveTo(e,n-l),r.arcTo(e+o,n-l,e+o,n,c),r.arcTo(e+o,n+l,e,n+l,c),r.arcTo(e-o,n+l,e-o,n,c),r.arcTo(e-o,n-l,e,n-l,c),r.lineTo(e,n-l),r.closePath()};Os.drawBottomRoundRectanglePath=function(r,e,n,i,a,s){var o=i/2,l=a/2,c=s==="auto"?Rs(i,a):s;r.beginPath&&r.beginPath(),r.moveTo(e,n-l),r.lineTo(e+o,n-l),r.lineTo(e+o,n),r.arcTo(e+o,n+l,e,n+l,c),r.arcTo(e-o,n+l,e-o,n,c),r.lineTo(e-o,n-l),r.lineTo(e,n-l),r.closePath()};Os.drawCutRectanglePath=function(r,e,n,i,a,s,o){var l=i/2,c=a/2,u=o==="auto"?D2():o;r.beginPath&&r.beginPath(),r.moveTo(e-l+u,n-c),r.lineTo(e+l-u,n-c),r.lineTo(e+l,n-c+u),r.lineTo(e+l,n+c-u),r.lineTo(e+l-u,n+c),r.lineTo(e-l+u,n+c),r.lineTo(e-l,n+c-u),r.lineTo(e-l,n-c+u),r.closePath()};Os.drawBarrelPath=function(r,e,n,i,a){var s=i/2,o=a/2,l=e-s,c=e+s,u=n-o,h=n+o,g=Cp(i,a),v=g.widthOffset,m=g.heightOffset,y=g.ctrlPtOffsetPct*v;r.beginPath&&r.beginPath(),r.moveTo(l,u+m),r.lineTo(l,h-m),r.quadraticCurveTo(l+y,h,l+v,h),r.lineTo(c-v,h),r.quadraticCurveTo(c-y,h,c,h-m),r.lineTo(c,u+m),r.quadraticCurveTo(c-y,u,c-v,u),r.lineTo(l+v,u),r.quadraticCurveTo(l+y,u,l,u+m),r.closePath()};var r4=Math.sin(0),n4=Math.cos(0),Pp={},Lp={},LS=Math.PI/40;for(var bl=0*Math.PI;bl<2*Math.PI;bl+=LS)Pp[bl]=Math.sin(bl),Lp[bl]=Math.cos(bl);Os.drawEllipsePath=function(r,e,n,i,a){if(r.beginPath&&r.beginPath(),r.ellipse)r.ellipse(e,n,i/2,a/2,0,0,2*Math.PI);else for(var s,o,l=i/2,c=a/2,u=0*Math.PI;u<2*Math.PI;u+=LS)s=e-l*Pp[u]*r4+l*Lp[u]*n4,o=n+c*Lp[u]*r4+c*Pp[u]*n4,u===0?r.moveTo(s,o):r.lineTo(s,o);r.closePath()};var df={};df.createBuffer=function(r,e){var n=document.createElement("canvas");return n.width=r,n.height=e,[n,n.getContext("2d")]};df.bufferCanvasImage=function(r){var e=this.cy,n=e.mutableElements(),i=n.boundingBox(),a=this.findContainerClientCoords(),s=r.full?Math.ceil(i.w):a[2],o=r.full?Math.ceil(i.h):a[3],l=Be(r.maxWidth)||Be(r.maxHeight),c=this.getPixelRatio(),u=1;if(r.scale!==void 0)s*=r.scale,o*=r.scale,u=r.scale;else if(l){var h=1/0,g=1/0;Be(r.maxWidth)&&(h=u*r.maxWidth/s),Be(r.maxHeight)&&(g=u*r.maxHeight/o),u=Math.min(h,g),s*=u,o*=u}l||(s*=c,o*=c,u*=c);var v=document.createElement("canvas");v.width=s,v.height=o,v.style.width=s+"px",v.style.height=o+"px";var m=v.getContext("2d");if(s>0&&o>0){m.clearRect(0,0,s,o),m.globalCompositeOperation="source-over";var y=this.getCachedZSortedEles();if(r.full)m.translate(-i.x1*u,-i.y1*u),m.scale(u,u),this.drawElements(m,y),m.scale(1/u,1/u),m.translate(i.x1*u,i.y1*u);else{var b=e.pan(),x={x:b.x*u,y:b.y*u};u*=e.zoom(),m.translate(x.x,x.y),m.scale(u,u),this.drawElements(m,y),m.scale(1/u,1/u),m.translate(-x.x,-x.y)}r.bg&&(m.globalCompositeOperation="destination-over",m.fillStyle=r.bg,m.rect(0,0,s,o),m.fill())}return v};function PF(r,e){for(var n=atob(r),i=new ArrayBuffer(n.length),a=new Uint8Array(i),s=0;s<n.length;s++)a[s]=n.charCodeAt(s);return new Blob([i],{type:e})}function i4(r){var e=r.indexOf(",");return r.substr(e+1)}function _S(r,e,n){var i=function(){return e.toDataURL(n,r.quality)};switch(r.output){case"blob-promise":return new Ql(function(a,s){try{e.toBlob(function(o){o!=null?a(o):s(new Error("`canvas.toBlob()` sent a null value in its callback"))},n,r.quality)}catch(o){s(o)}});case"blob":return PF(i4(i()),n);case"base64":return i4(i());case"base64uri":default:return i()}}df.png=function(r){return _S(r,this.bufferCanvasImage(r),"image/png")};df.jpg=function(r){return _S(r,this.bufferCanvasImage(r),"image/jpeg")};var zS={};zS.nodeShapeImpl=function(r,e,n,i,a,s,o,l){switch(r){case"ellipse":return this.drawEllipsePath(e,n,i,a,s);case"polygon":return this.drawPolygonPath(e,n,i,a,s,o);case"round-polygon":return this.drawRoundPolygonPath(e,n,i,a,s,o,l);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,n,i,a,s,l);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,n,i,a,s,o,l);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,n,i,a,s,l);case"barrel":return this.drawBarrelPath(e,n,i,a,s)}};var LF=GS,mt=GS.prototype;mt.CANVAS_LAYERS=3;mt.SELECT_BOX=0;mt.DRAG=1;mt.NODE=2;mt.WEBGL=3;mt.CANVAS_TYPES=["2d","2d","2d","webgl2"];mt.BUFFER_COUNT=3;mt.TEXTURE_BUFFER=0;mt.MOTIONBLUR_BUFFER_NODE=1;mt.MOTIONBLUR_BUFFER_DRAG=2;function GS(r){var e=this,n=e.cy.window(),i=n.document;r.webgl&&(mt.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(mt.CANVAS_LAYERS),contexts:new Array(mt.CANVAS_LAYERS),canvasNeedsRedraw:new Array(mt.CANVAS_LAYERS),bufferCanvases:new Array(mt.BUFFER_COUNT),bufferContexts:new Array(mt.CANVAS_LAYERS)};var a="-webkit-tap-highlight-color",s="rgba(0,0,0,0)";e.data.canvasContainer=i.createElement("div");var o=e.data.canvasContainer.style;e.data.canvasContainer.style[a]=s,o.position="relative",o.zIndex="0",o.overflow="hidden";var l=r.cy.container();l.appendChild(e.data.canvasContainer),l.style[a]=s;var c={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};F8()&&(c["-ms-touch-action"]="none",c["touch-action"]="none");for(var u=0;u<mt.CANVAS_LAYERS;u++){var h=e.data.canvases[u]=i.createElement("canvas"),g=mt.CANVAS_TYPES[u];e.data.contexts[u]=h.getContext(g),e.data.contexts[u]||ur("Could not create canvas of type "+g),Object.keys(c).forEach(function(le){h.style[le]=c[le]}),h.style.position="absolute",h.setAttribute("data-id","layer"+u),h.style.zIndex=String(mt.CANVAS_LAYERS-u),e.data.canvasContainer.appendChild(h),e.data.canvasNeedsRedraw[u]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[mt.NODE].setAttribute("data-id","layer"+mt.NODE+"-node"),e.data.canvases[mt.SELECT_BOX].setAttribute("data-id","layer"+mt.SELECT_BOX+"-selectbox"),e.data.canvases[mt.DRAG].setAttribute("data-id","layer"+mt.DRAG+"-drag"),e.data.canvases[mt.WEBGL]&&e.data.canvases[mt.WEBGL].setAttribute("data-id","layer"+mt.WEBGL+"-webgl");for(var u=0;u<mt.BUFFER_COUNT;u++)e.data.bufferCanvases[u]=i.createElement("canvas"),e.data.bufferContexts[u]=e.data.bufferCanvases[u].getContext("2d"),e.data.bufferCanvases[u].style.position="absolute",e.data.bufferCanvases[u].setAttribute("data-id","buffer"+u),e.data.bufferCanvases[u].style.zIndex=String(-u-1),e.data.bufferCanvases[u].style.visibility="hidden";e.pathsEnabled=!0;var v=wn(),m=function(ie){return{x:(ie.x1+ie.x2)/2,y:(ie.y1+ie.y2)/2}},y=function(ie){return{x:-ie.w/2,y:-ie.h/2}},b=function(ie){var se=ie[0]._private,fe=se.oldBackgroundTimestamp===se.backgroundTimestamp;return!fe},x=function(ie){return ie[0]._private.nodeKey},A=function(ie){return ie[0]._private.labelStyleKey},C=function(ie){return ie[0]._private.sourceLabelStyleKey},E=function(ie){return ie[0]._private.targetLabelStyleKey},S=function(ie,se,fe,xe,De){return e.drawElement(ie,se,fe,!1,!1,De)},M=function(ie,se,fe,xe,De){return e.drawElementText(ie,se,fe,xe,"main",De)},R=function(ie,se,fe,xe,De){return e.drawElementText(ie,se,fe,xe,"source",De)},T=function(ie,se,fe,xe,De){return e.drawElementText(ie,se,fe,xe,"target",De)},B=function(ie){return ie.boundingBox(),ie[0]._private.bodyBounds},F=function(ie){return ie.boundingBox(),ie[0]._private.labelBounds.main||v},I=function(ie){return ie.boundingBox(),ie[0]._private.labelBounds.source||v},U=function(ie){return ie.boundingBox(),ie[0]._private.labelBounds.target||v},k=function(ie,se){return se},O=function(ie){return m(B(ie))},V=function(ie,se,fe){var xe=ie?ie+"-":"";return{x:se.x+fe.pstyle(xe+"text-margin-x").pfValue,y:se.y+fe.pstyle(xe+"text-margin-y").pfValue}},L=function(ie,se,fe){var xe=ie[0]._private.rscratch;return{x:xe[se],y:xe[fe]}},P=function(ie){return V("",L(ie,"labelX","labelY"),ie)},_=function(ie){return V("source",L(ie,"sourceLabelX","sourceLabelY"),ie)},q=function(ie){return V("target",L(ie,"targetLabelX","targetLabelY"),ie)},H=function(ie){return y(B(ie))},W=function(ie){return y(I(ie))},G=function(ie){return y(U(ie))},K=function(ie){var se=F(ie),fe=y(F(ie));if(ie.isNode()){switch(ie.pstyle("text-halign").value){case"left":fe.x=-se.w-(se.leftPad||0);break;case"right":fe.x=-(se.rightPad||0);break}switch(ie.pstyle("text-valign").value){case"top":fe.y=-se.h-(se.topPad||0);break;case"bottom":fe.y=-(se.botPad||0);break}}return fe},$=e.data.eleTxrCache=new pc(e,{getKey:x,doesEleInvalidateKey:b,drawElement:S,getBoundingBox:B,getRotationPoint:O,getRotationOffset:H,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),te=e.data.lblTxrCache=new pc(e,{getKey:A,drawElement:M,getBoundingBox:F,getRotationPoint:P,getRotationOffset:K,isVisible:k}),ae=e.data.slbTxrCache=new pc(e,{getKey:C,drawElement:R,getBoundingBox:I,getRotationPoint:_,getRotationOffset:W,isVisible:k}),ue=e.data.tlbTxrCache=new pc(e,{getKey:E,drawElement:T,getBoundingBox:U,getRotationPoint:q,getRotationOffset:G,isVisible:k}),re=e.data.lyrTxrCache=new RS(e);e.onUpdateEleCalcs(function(ie,se){$.invalidateElements(se),te.invalidateElements(se),ae.invalidateElements(se),ue.invalidateElements(se),re.invalidateElements(se);for(var fe=0;fe<se.length;fe++){var xe=se[fe]._private;xe.oldBackgroundTimestamp=xe.backgroundTimestamp}});var ve=function(ie){for(var se=0;se<ie.length;se++)re.enqueueElementRefinement(ie[se].ele)};$.onDequeue(ve),te.onDequeue(ve),ae.onDequeue(ve),ue.onDequeue(ve),r.webgl&&e.initWebgl(r,{getStyleKey:x,getLabelKey:A,getSourceLabelKey:C,getTargetLabelKey:E,drawElement:S,drawLabel:M,drawSourceLabel:R,drawTargetLabel:T,getElementBox:B,getLabelBox:F,getSourceLabelBox:I,getTargetLabelBox:U,getElementRotationPoint:O,getElementRotationOffset:H,getLabelRotationPoint:P,getSourceLabelRotationPoint:_,getTargetLabelRotationPoint:q,getLabelRotationOffset:K,getSourceLabelRotationOffset:W,getTargetLabelRotationOffset:G})}mt.redrawHint=function(r,e){var n=this;switch(r){case"eles":n.data.canvasNeedsRedraw[mt.NODE]=e;break;case"drag":n.data.canvasNeedsRedraw[mt.DRAG]=e;break;case"select":n.data.canvasNeedsRedraw[mt.SELECT_BOX]=e;break;case"gc":n.data.gc=!0;break}};var _F=typeof Path2D<"u";mt.path2dEnabled=function(r){if(r===void 0)return this.pathsEnabled;this.pathsEnabled=!!r};mt.usePaths=function(){return _F&&this.pathsEnabled};mt.setImgSmoothing=function(r,e){r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled=e:(r.webkitImageSmoothingEnabled=e,r.mozImageSmoothingEnabled=e,r.msImageSmoothingEnabled=e)};mt.getImgSmoothing=function(r){return r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled:r.webkitImageSmoothingEnabled||r.mozImageSmoothingEnabled||r.msImageSmoothingEnabled};mt.makeOffscreenCanvas=function(r,e){var n;if((typeof OffscreenCanvas>"u"?"undefined":Or(OffscreenCanvas))!=="undefined")n=new OffscreenCanvas(r,e);else{var i=this.cy.window(),a=i.document;n=a.createElement("canvas"),n.width=r,n.height=e}return n};[BS,$i,Fa,z2,Io,Vs,Cn,US,Os,df,zS].forEach(function(r){et(mt,r)});var zF=[{name:"null",impl:mS},{name:"base",impl:TS},{name:"canvas",impl:LF}],GF=[{type:"layout",extensions:dN},{type:"renderer",extensions:zF}],qS={},YS={};function jS(r,e,n){var i=n,a=function(B){Pt("Can not register `"+e+"` for `"+r+"` since `"+B+"` already exists in the prototype and can not be overridden")};if(r==="core"){if(Yc.prototype[e])return a(e);Yc.prototype[e]=n}else if(r==="collection"){if(sn.prototype[e])return a(e);sn.prototype[e]=n}else if(r==="layout"){for(var s=function(B){this.options=B,n.call(this,B),Dt(this._private)||(this._private={}),this._private.cy=B.cy,this._private.listeners=[],this.createEmitter()},o=s.prototype=Object.create(n.prototype),l=[],c=0;c<l.length;c++){var u=l[c];o[u]=o[u]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var h=n.prototype.stop;o.stop=function(){var T=this.options;if(T&&T.animate){var B=this.animations;if(B)for(var F=0;F<B.length;F++)B[F].stop()}return h?h.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var g=function(B){return B._private.cy},v={addEventFields:function(B,F){F.layout=B,F.cy=g(B),F.target=B},bubble:function(){return!0},parent:function(B){return g(B)}};et(o,{createEmitter:function(){return this._private.emitter=new I0(v,this),this},emitter:function(){return this._private.emitter},on:function(B,F){return this.emitter().on(B,F),this},one:function(B,F){return this.emitter().one(B,F),this},once:function(B,F){return this.emitter().one(B,F),this},removeListener:function(B,F){return this.emitter().removeListener(B,F),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(B,F){return this.emitter().emit(B,F),this}}),Ot.eventAliasesOn(o),i=s}else if(r==="renderer"&&e!=="null"&&e!=="base"){var m=HS("renderer","base"),y=m.prototype,b=n,x=n.prototype,A=function(){m.apply(this,arguments),b.apply(this,arguments)},C=A.prototype;for(var E in y){var S=y[E],M=x[E]!=null;if(M)return a(E);C[E]=S}for(var R in x)C[R]=x[R];y.clientFunctions.forEach(function(T){C[T]=C[T]||function(){ur("Renderer does not implement `renderer."+T+"()` on its prototype")}}),i=A}else if(r==="__proto__"||r==="constructor"||r==="prototype")return ur(r+" is an illegal type to be registered, possibly lead to prototype pollutions");return cE({map:qS,keys:[r,e],value:i})}function HS(r,e){return fE({map:qS,keys:[r,e]})}function qF(r,e,n,i,a){return cE({map:YS,keys:[r,e,n,i],value:a})}function YF(r,e,n,i){return fE({map:YS,keys:[r,e,n,i]})}var _p=function(){if(arguments.length===2)return HS.apply(null,arguments);if(arguments.length===3)return jS.apply(null,arguments);if(arguments.length===4)return YF.apply(null,arguments);if(arguments.length===5)return qF.apply(null,arguments);ur("Invalid extension access syntax")};Yc.prototype.extension=_p;GF.forEach(function(r){r.extensions.forEach(function(e){jS(r.type,e.name,e.impl)})});var a0=function(){if(!(this instanceof a0))return new a0;this.length=0},So=a0.prototype;So.instanceString=function(){return"stylesheet"};So.selector=function(r){var e=this.length++;return this[e]={selector:r,properties:[]},this};So.css=function(r,e){var n=this.length-1;if(We(r))this[n].properties.push({name:r,value:e});else if(Dt(r))for(var i=r,a=Object.keys(i),s=0;s<a.length;s++){var o=a[s],l=i[o];if(l!=null){var c=Qr.properties[o]||Qr.properties[b0(o)];if(c!=null){var u=c.name,h=l;this[n].properties.push({name:u,value:h})}}}return this};So.style=So.css;So.generateStyle=function(r){var e=new Qr(r);return this.appendToStyle(e)};So.appendToStyle=function(r){for(var e=0;e<this.length;e++){var n=this[e],i=n.selector,a=n.properties;r.selector(i);for(var s=0;s<a.length;s++){var o=a[s];r.css(o.name,o.value)}}return r};var jF="3.33.1",To=function(e){if(e===void 0&&(e={}),Dt(e))return new Yc(e);if(We(e))return _p.apply(_p,arguments)};To.use=function(r){var e=Array.prototype.slice.call(arguments,1);return e.unshift(To),r.apply(null,e),this};To.warnings=function(r){return yE(r)};To.version=jF;To.stylesheet=To.Stylesheet=a0;const{string:Jh,array:a4,object:$h,number:Ju,bool:Xn,oneOfType:wl,any:ed,func:$u}=Q,HF={id:Jh,className:Jh,style:wl([Jh,$h]),elements:wl([a4,ed]),stylesheet:wl([a4,ed]),layout:wl([$h,ed]),pan:wl([$h,ed]),zoom:Ju,panningEnabled:Xn,userPanningEnabled:Xn,minZoom:Ju,maxZoom:Ju,zoomingEnabled:Xn,userZoomingEnabled:Xn,boxSelectionEnabled:Xn,autoungrabify:Xn,autolock:Xn,autounselectify:Xn,get:$u,toJson:$u,diff:$u,forEach:$u,cy:$u,headless:Xn,styleEnabled:Xn,hideEdgesOnViewport:Xn,textureOnViewport:Xn,motionBlur:Xn,motionBlurOpacity:Ju,wheelSensitivity:Ju,pixelRatio:wl([Jh,$h])},KS=(r,e)=>{if(((s,o)=>s==null||o==null)(r,e)&&(r!=null||e!=null))return!0;if(r===e)return!1;if(typeof r!="object"||typeof e!="object")return r!==e;const n=Object.keys(r),i=Object.keys(e),a=s=>r[s]!==e[s];return n.length!==i.length||!(!n.some(a)&&!i.some(a))},Ti=(r,e)=>r!=null?r[e]:null,KF={diff:KS,get:Ti,toJson:r=>r,forEach:(r,e)=>r.forEach(e),elements:[{data:{id:"a",label:"Example node A"}},{data:{id:"b",label:"Example node B"}},{data:{id:"e",source:"a",target:"b"}}],stylesheet:[{selector:"node",style:{label:"data(label)"}}],zoom:1,pan:{x:0,y:0}},td=(r,e,n,i)=>n(Ti(r,i),Ti(e,i)),XF=(r,e,n,i,a,s,o)=>{r.batch(()=>{(i===KS||td(e,n,i,"elements"))&&JF(r,Ti(e,"elements"),Ti(n,"elements"),a,s,o,i),td(e,n,i,"stylesheet")&&WF(r,Ti(e,"stylesheet"),Ti(n,"stylesheet"),a),["zoom","minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","pan","panningEnabled","userPanningEnabled","boxSelectionEnabled","autoungrabify","autolock","autounselectify"].forEach(l=>{td(e,n,i,l)&&QF(r,l,Ti(e,l),Ti(n,l),a)})}),td(e,n,i,"layout")&&ZF(r,Ti(e,"layout"),Ti(n,"layout"),a)},QF=(r,e,n,i,a)=>{r[e](a(i))},ZF=(r,e,n,i)=>{const a=i(n);a!=null&&r.layout(a).run()},WF=(r,e,n,i)=>{const a=r.style();a?.fromJson(i(n)).update()},JF=(r,e,n,i,a,s,o)=>{const l=[],c=r.collection(),u=[],h={},g={},v=m=>a(a(m,"data"),"id");s(n,m=>{const y=v(m);g[y]=m}),e!=null&&s(e,m=>{const y=v(m);h[y]=m,(b=>g[b]!=null)(y)||c.merge(r.getElementById(y))}),s(n,m=>{const y=v(m),b=(x=>h[x])(y);(x=>h[x]!=null)(y)?u.push({ele1:b,ele2:m}):l.push(i(m))}),c.length>0&&r.remove(c),l.length>0&&r.add(l),u.forEach(({ele1:m,ele2:y})=>$F(r,m,y,i,a,o))},$F=(r,e,n,i,a,s)=>{const o=a(a(n,"data"),"id"),l=r.getElementById(o),c={};["data","position","selected","selectable","locked","grabbable","classes"].forEach(h=>{const g=a(n,h);s(g,a(e,h))&&(c[h]=i(g))});const u=a(n,"scratch");s(u,a(e,"scratch"))&&l.scratch(i(u)),Object.keys(c).length>0&&l.json(c)};let e9=class extends bd.Component{static get propTypes(){return HF}static get defaultProps(){return KF}static normalizeElements(e){if(e.length!=null)return e;{let{nodes:n,edges:i}=e;return n==null&&(n=[]),i==null&&(i=[]),n.concat(i)}}constructor(e){super(e),this.displayName="CytoscapeComponent",this.containerRef=bd.createRef()}componentDidMount(){const e=this.containerRef.current,{global:n,headless:i,styleEnabled:a,hideEdgesOnViewport:s,textureOnViewport:o,motionBlur:l,motionBlurOpacity:c,wheelSensitivity:u,pixelRatio:h}=this.props,g=this._cy=new To({container:e,headless:i,styleEnabled:a,hideEdgesOnViewport:s,textureOnViewport:o,motionBlur:l,motionBlurOpacity:c,wheelSensitivity:u,pixelRatio:h});n&&(window[n]=g),this.updateCytoscape(null,this.props)}updateCytoscape(e,n){const i=this._cy,{diff:a,toJson:s,get:o,forEach:l}=n;XF(i,e,n,a,s,o,l),n.cy!=null&&n.cy(i)}componentDidUpdate(e){this.updateCytoscape(e,this.props)}componentWillUnmount(){this._cy.destroy()}render(){const{id:e,className:n,style:i}=this.props;return bd.createElement("div",{ref:this.containerRef,id:e,className:n,style:i})}};const t9={name:"cose",fit:!0,padding:20,animate:!1},r9=[{selector:"node",style:{"background-color":"data(color)",label:"data(label)",color:"#f5f5f5","font-size":"10px","text-valign":"center","text-halign":"center","text-wrap":"wrap","text-max-width":"120px","border-width":2,"border-color":"#1e3a8a"}},{selector:"edge",style:{width:2,"line-color":"#8ecae6","target-arrow-color":"#8ecae6","target-arrow-shape":"triangle","curve-style":"bezier",opacity:.75,label:"data(label)","font-size":"8px",color:"#bbdefb"}},{selector:"node:selected",style:{"border-width":6,"border-color":"#f97316","shadow-blur":16,"shadow-color":"rgba(249, 115, 22, 0.55)","shadow-opacity":.8}}],rd=["#5a6acf","#8b5cf6","#ec4899","#0ea5e9","#22c55e","#f59e0b"];function n9(r,e){if(!r)return rd[e%rd.length];const n=Math.abs([...r].reduce((i,a)=>i*33+a.charCodeAt(0),7));return rd[n%rd.length]}function q2({elements:r,selectedId:e,onSelect:n}){const i=Ne.useRef(null),a=Ne.useMemo(()=>r.map((s,o)=>s.data?.id?{...s,data:{...s.data,color:n9(s.data.category,o)}}:s),[r]);return Ne.useEffect(()=>{const s=i.current;s&&(s.off("tap"),s.on("tap","node",o=>{const l=o.target.id();n&&n(l)}))},[n]),Ne.useEffect(()=>{const s=i.current;if(s&&(s.nodes().unselect(),e)){const o=s.getElementById(e);o&&(o.select(),s.animate({center:{eles:o}},{duration:250}))}},[e]),J.jsx("div",{className:"cytoscape-wrapper","data-testid":"cytoscape-view",children:J.jsx(e9,{cy:s=>{i.current=s},elements:a,layout:t9,stylesheet:r9,style:{width:"100%",height:"100%"}})})}q2.propTypes={elements:Q.arrayOf(Q.shape({data:Q.shape({id:Q.string,label:Q.string,category:Q.string})})),selectedId:Q.string,onSelect:Q.func};q2.defaultProps={elements:[],selectedId:null,onSelect:void 0};function i9(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,a=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function a9(r,e,n){return e=d9(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function s4(r,e){return l9(r)||i9(r,e)||XS(r,e)||f9()}function s9(r){return o9(r)||u9(r)||XS(r)||c9()}function o9(r){if(Array.isArray(r))return zp(r)}function l9(r){if(Array.isArray(r))return r}function u9(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function XS(r,e){if(r){if(typeof r=="string")return zp(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zp(r,e)}}function zp(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function c9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h9(r,e){if(typeof r!="object"||r===null)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function d9(r){var e=h9(r,"string");return typeof e=="symbol"?e:String(e)}var g9=function(e,n){var i=new Set(n);return Object.assign.apply(Object,[{}].concat(s9(Object.entries(e).filter(function(a){var s=s4(a,1),o=s[0];return!i.has(o)}).map(function(a){var s=s4(a,2),o=s[0],l=s[1];return a9({},o,l)}))))};function Gp(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function v9(r){if(Array.isArray(r))return r}function m9(r){if(Array.isArray(r))return Gp(r)}function p9(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function y9(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(c=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,a=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function A9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x9(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b9(r,e){return v9(r)||y9(r,e)||QS(r,e)||A9()}function o4(r){return m9(r)||p9(r)||QS(r)||x9()}function QS(r,e){if(r){if(typeof r=="string")return Gp(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gp(r,e):void 0}}function w9(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.wrapperElementType,i=n===void 0?"div":n,a=e.nodeMapper,s=a===void 0?function(h){return h}:a,o=e.methodNames,l=o===void 0?[]:o,c=e.initPropNames,u=c===void 0?[]:c;return Ne.forwardRef(function(h,g){var v=Ne.useRef(),m=Ne.useMemo(function(){var x=Object.fromEntries(u.filter(function(A){return h.hasOwnProperty(A)}).map(function(A){return[A,h[A]]}));return r(x)},[]);l4(function(){m(s(v.current))},Ne.useLayoutEffect),l4(function(){return m._destructor instanceof Function?m._destructor:void 0});var y=Ne.useCallback(function(x){for(var A=arguments.length,C=new Array(A>1?A-1:0),E=1;E<A;E++)C[E-1]=arguments[E];return m[x]instanceof Function?m[x].apply(m,C):void 0},[m]),b=Ne.useRef({});return Object.keys(g9(h,[].concat(o4(l),o4(u)))).filter(function(x){return b.current[x]!==h[x]}).forEach(function(x){return y(x,h[x])}),b.current=h,Ne.useImperativeHandle(g,function(){return Object.fromEntries(l.map(function(x){return[x,function(){for(var A=arguments.length,C=new Array(A),E=0;E<A;E++)C[E]=arguments[E];return y.apply(void 0,[x].concat(C))}]}))},[y]),bd.createElement(i,{ref:v})})}function l4(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ne.useEffect,n=Ne.useRef(),i=Ne.useRef(!1),a=Ne.useRef(!1),s=Ne.useState(0),o=b9(s,2);o[0];var l=o[1];i.current&&(a.current=!0),e(function(){return i.current||(n.current=r(),i.current=!0),l(function(c){return c+1}),function(){a.current&&n.current&&n.current()}},[])}var qp="http://www.w3.org/1999/xhtml";const u4={svg:"http://www.w3.org/2000/svg",xhtml:qp,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function L0(r){var e=r+="",n=e.indexOf(":");return n>=0&&(e=r.slice(0,n))!=="xmlns"&&(r=r.slice(n+1)),u4.hasOwnProperty(e)?{space:u4[e],local:r}:r}function C9(r){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===qp&&e.documentElement.namespaceURI===qp?e.createElement(r):e.createElementNS(n,r)}}function E9(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function ZS(r){var e=L0(r);return(e.local?E9:C9)(e)}function S9(){}function Y2(r){return r==null?S9:function(){return this.querySelector(r)}}function T9(r){typeof r!="function"&&(r=Y2(r));for(var e=this._groups,n=e.length,i=new Array(n),a=0;a<n;++a)for(var s=e[a],o=s.length,l=i[a]=new Array(o),c,u,h=0;h<o;++h)(c=s[h])&&(u=r.call(c,c.__data__,h,s))&&("__data__"in c&&(u.__data__=c.__data__),l[h]=u);return new $n(i,this._parents)}function M9(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function D9(){return[]}function WS(r){return r==null?D9:function(){return this.querySelectorAll(r)}}function R9(r){return function(){return M9(r.apply(this,arguments))}}function B9(r){typeof r=="function"?r=R9(r):r=WS(r);for(var e=this._groups,n=e.length,i=[],a=[],s=0;s<n;++s)for(var o=e[s],l=o.length,c,u=0;u<l;++u)(c=o[u])&&(i.push(r.call(c,c.__data__,u,o)),a.push(c));return new $n(i,a)}function JS(r){return function(){return this.matches(r)}}function $S(r){return function(e){return e.matches(r)}}var I9=Array.prototype.find;function N9(r){return function(){return I9.call(this.children,r)}}function F9(){return this.firstElementChild}function k9(r){return this.select(r==null?F9:N9(typeof r=="function"?r:$S(r)))}var U9=Array.prototype.filter;function V9(){return Array.from(this.children)}function O9(r){return function(){return U9.call(this.children,r)}}function P9(r){return this.selectAll(r==null?V9:O9(typeof r=="function"?r:$S(r)))}function L9(r){typeof r!="function"&&(r=JS(r));for(var e=this._groups,n=e.length,i=new Array(n),a=0;a<n;++a)for(var s=e[a],o=s.length,l=i[a]=[],c,u=0;u<o;++u)(c=s[u])&&r.call(c,c.__data__,u,s)&&l.push(c);return new $n(i,this._parents)}function e6(r){return new Array(r.length)}function _9(){return new $n(this._enter||this._groups.map(e6),this._parents)}function s0(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}s0.prototype={constructor:s0,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function z9(r){return function(){return r}}function G9(r,e,n,i,a,s){for(var o=0,l,c=e.length,u=s.length;o<u;++o)(l=e[o])?(l.__data__=s[o],i[o]=l):n[o]=new s0(r,s[o]);for(;o<c;++o)(l=e[o])&&(a[o]=l)}function q9(r,e,n,i,a,s,o){var l,c,u=new Map,h=e.length,g=s.length,v=new Array(h),m;for(l=0;l<h;++l)(c=e[l])&&(v[l]=m=o.call(c,c.__data__,l,e)+"",u.has(m)?a[l]=c:u.set(m,c));for(l=0;l<g;++l)m=o.call(r,s[l],l,s)+"",(c=u.get(m))?(i[l]=c,c.__data__=s[l],u.delete(m)):n[l]=new s0(r,s[l]);for(l=0;l<h;++l)(c=e[l])&&u.get(v[l])===c&&(a[l]=c)}function Y9(r){return r.__data__}function j9(r,e){if(!arguments.length)return Array.from(this,Y9);var n=e?q9:G9,i=this._parents,a=this._groups;typeof r!="function"&&(r=z9(r));for(var s=a.length,o=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var h=i[u],g=a[u],v=g.length,m=H9(r.call(h,h&&h.__data__,u,i)),y=m.length,b=l[u]=new Array(y),x=o[u]=new Array(y),A=c[u]=new Array(v);n(h,g,b,x,A,m,e);for(var C=0,E=0,S,M;C<y;++C)if(S=b[C]){for(C>=E&&(E=C+1);!(M=x[E])&&++E<y;);S._next=M||null}}return o=new $n(o,i),o._enter=l,o._exit=c,o}function H9(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function K9(){return new $n(this._exit||this._groups.map(e6),this._parents)}function X9(r,e,n){var i=this.enter(),a=this,s=this.exit();return typeof r=="function"?(i=r(i),i&&(i=i.selection())):i=i.append(r+""),e!=null&&(a=e(a),a&&(a=a.selection())),n==null?s.remove():n(s),i&&a?i.merge(a).order():a}function Q9(r){for(var e=r.selection?r.selection():r,n=this._groups,i=e._groups,a=n.length,s=i.length,o=Math.min(a,s),l=new Array(a),c=0;c<o;++c)for(var u=n[c],h=i[c],g=u.length,v=l[c]=new Array(g),m,y=0;y<g;++y)(m=u[y]||h[y])&&(v[y]=m);for(;c<a;++c)l[c]=n[c];return new $n(l,this._parents)}function Z9(){for(var r=this._groups,e=-1,n=r.length;++e<n;)for(var i=r[e],a=i.length-1,s=i[a],o;--a>=0;)(o=i[a])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function W9(r){r||(r=J9);function e(g,v){return g&&v?r(g.__data__,v.__data__):!g-!v}for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s){for(var o=n[s],l=o.length,c=a[s]=new Array(l),u,h=0;h<l;++h)(u=o[h])&&(c[h]=u);c.sort(e)}return new $n(a,this._parents).order()}function J9(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function $9(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function ek(){return Array.from(this)}function tk(){for(var r=this._groups,e=0,n=r.length;e<n;++e)for(var i=r[e],a=0,s=i.length;a<s;++a){var o=i[a];if(o)return o}return null}function rk(){let r=0;for(const e of this)++r;return r}function nk(){return!this.node()}function ik(r){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var a=e[n],s=0,o=a.length,l;s<o;++s)(l=a[s])&&r.call(l,l.__data__,s,a);return this}function ak(r){return function(){this.removeAttribute(r)}}function sk(r){return function(){this.removeAttributeNS(r.space,r.local)}}function ok(r,e){return function(){this.setAttribute(r,e)}}function lk(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function uk(r,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(r):this.setAttribute(r,n)}}function ck(r,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,n)}}function fk(r,e){var n=L0(r);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?sk:ak:typeof e=="function"?n.local?ck:uk:n.local?lk:ok)(n,e))}function t6(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function hk(r){return function(){this.style.removeProperty(r)}}function dk(r,e,n){return function(){this.style.setProperty(r,e,n)}}function gk(r,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(r):this.style.setProperty(r,i,n)}}function vk(r,e,n){return arguments.length>1?this.each((e==null?hk:typeof e=="function"?gk:dk)(r,e,n??"")):jl(this.node(),r)}function jl(r,e){return r.style.getPropertyValue(e)||t6(r).getComputedStyle(r,null).getPropertyValue(e)}function mk(r){return function(){delete this[r]}}function pk(r,e){return function(){this[r]=e}}function yk(r,e){return function(){var n=e.apply(this,arguments);n==null?delete this[r]:this[r]=n}}function Ak(r,e){return arguments.length>1?this.each((e==null?mk:typeof e=="function"?yk:pk)(r,e)):this.node()[r]}function r6(r){return r.trim().split(/^|\s+/)}function j2(r){return r.classList||new n6(r)}function n6(r){this._node=r,this._names=r6(r.getAttribute("class")||"")}n6.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function i6(r,e){for(var n=j2(r),i=-1,a=e.length;++i<a;)n.add(e[i])}function a6(r,e){for(var n=j2(r),i=-1,a=e.length;++i<a;)n.remove(e[i])}function xk(r){return function(){i6(this,r)}}function bk(r){return function(){a6(this,r)}}function wk(r,e){return function(){(e.apply(this,arguments)?i6:a6)(this,r)}}function Ck(r,e){var n=r6(r+"");if(arguments.length<2){for(var i=j2(this.node()),a=-1,s=n.length;++a<s;)if(!i.contains(n[a]))return!1;return!0}return this.each((typeof e=="function"?wk:e?xk:bk)(n,e))}function Ek(){this.textContent=""}function Sk(r){return function(){this.textContent=r}}function Tk(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function Mk(r){return arguments.length?this.each(r==null?Ek:(typeof r=="function"?Tk:Sk)(r)):this.node().textContent}function Dk(){this.innerHTML=""}function Rk(r){return function(){this.innerHTML=r}}function Bk(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function Ik(r){return arguments.length?this.each(r==null?Dk:(typeof r=="function"?Bk:Rk)(r)):this.node().innerHTML}function Nk(){this.nextSibling&&this.parentNode.appendChild(this)}function Fk(){return this.each(Nk)}function kk(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Uk(){return this.each(kk)}function Vk(r){var e=typeof r=="function"?r:ZS(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Ok(){return null}function Pk(r,e){var n=typeof r=="function"?r:ZS(r),i=e==null?Ok:typeof e=="function"?e:Y2(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Lk(){var r=this.parentNode;r&&r.removeChild(this)}function _k(){return this.each(Lk)}function zk(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function Gk(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function qk(r){return this.select(r?Gk:zk)}function Yk(r){return arguments.length?this.property("__data__",r):this.node().__data__}function jk(r){return function(e){r.call(this,e,this.__data__)}}function Hk(r){return r.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Kk(r){return function(){var e=this.__on;if(e){for(var n=0,i=-1,a=e.length,s;n<a;++n)s=e[n],(!r.type||s.type===r.type)&&s.name===r.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function Xk(r,e,n){return function(){var i=this.__on,a,s=jk(e);if(i){for(var o=0,l=i.length;o<l;++o)if((a=i[o]).type===r.type&&a.name===r.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=s,a.options=n),a.value=e;return}}this.addEventListener(r.type,s,n),a={type:r.type,name:r.name,value:e,listener:s,options:n},i?i.push(a):this.__on=[a]}}function Qk(r,e,n){var i=Hk(r+""),a,s=i.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,h;c<u;++c)for(a=0,h=l[c];a<s;++a)if((o=i[a]).type===h.type&&o.name===h.name)return h.value}return}for(l=e?Xk:Kk,a=0;a<s;++a)this.each(l(i[a],e,n));return this}function s6(r,e,n){var i=t6(r),a=i.CustomEvent;typeof a=="function"?a=new a(e,n):(a=i.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),r.dispatchEvent(a)}function Zk(r,e){return function(){return s6(this,r,e)}}function Wk(r,e){return function(){return s6(this,r,e.apply(this,arguments))}}function Jk(r,e){return this.each((typeof e=="function"?Wk:Zk)(r,e))}function*$k(){for(var r=this._groups,e=0,n=r.length;e<n;++e)for(var i=r[e],a=0,s=i.length,o;a<s;++a)(o=i[a])&&(yield o)}var o6=[null];function $n(r,e){this._groups=r,this._parents=e}function gf(){return new $n([[document.documentElement]],o6)}function eU(){return this}$n.prototype=gf.prototype={constructor:$n,select:T9,selectAll:B9,selectChild:k9,selectChildren:P9,filter:L9,data:j9,enter:_9,exit:K9,join:X9,merge:Q9,selection:eU,order:Z9,sort:W9,call:$9,nodes:ek,node:tk,size:rk,empty:nk,each:ik,attr:fk,style:vk,property:Ak,classed:Ck,text:Mk,html:Ik,raise:Fk,lower:Uk,append:Vk,insert:Pk,remove:_k,clone:qk,datum:Yk,on:Qk,dispatch:Jk,[Symbol.iterator]:$k};function mi(r){return typeof r=="string"?new $n([[document.querySelector(r)]],[document.documentElement]):new $n([[r]],o6)}function tU(r){let e;for(;e=r.sourceEvent;)r=e;return r}function ji(r,e){if(r=tU(r),e===void 0&&(e=r.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=r.clientX,i.y=r.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[r.clientX-a.left-e.clientLeft,r.clientY-a.top-e.clientTop]}}return[r.pageX,r.pageY]}var rU={value:()=>{}};function vf(){for(var r=0,e=arguments.length,n={},i;r<e;++r){if(!(i=arguments[r]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Fd(n)}function Fd(r){this._=r}function nU(r,e){return r.trim().split(/^|\s+/).map(function(n){var i="",a=n.indexOf(".");if(a>=0&&(i=n.slice(a+1),n=n.slice(0,a)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Fd.prototype=vf.prototype={constructor:Fd,on:function(r,e){var n=this._,i=nU(r+"",n),a,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((a=(r=i[s]).type)&&(a=iU(n[a],r.name)))return a;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(a=(r=i[s]).type)n[a]=c4(n[a],r.name,e);else if(e==null)for(a in n)n[a]=c4(n[a],r.name,null);return this},copy:function(){var r={},e=this._;for(var n in e)r[n]=e[n].slice();return new Fd(r)},call:function(r,e){if((a=arguments.length-2)>0)for(var n=new Array(a),i=0,a,s;i<a;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(s=this._[r],i=0,a=s.length;i<a;++i)s[i].value.apply(e,n)},apply:function(r,e,n){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var i=this._[r],a=0,s=i.length;a<s;++a)i[a].value.apply(e,n)}};function iU(r,e){for(var n=0,i=r.length,a;n<i;++n)if((a=r[n]).name===e)return a.value}function c4(r,e,n){for(var i=0,a=r.length;i<a;++i)if(r[i].name===e){r[i]=rU,r=r.slice(0,i).concat(r.slice(i+1));break}return n!=null&&r.push({name:e,value:n}),r}const aU={passive:!1},Hc={capture:!0,passive:!1};function j1(r){r.stopImmediatePropagation()}function _l(r){r.preventDefault(),r.stopImmediatePropagation()}function l6(r){var e=r.document.documentElement,n=mi(r).on("dragstart.drag",_l,Hc);"onselectstart"in e?n.on("selectstart.drag",_l,Hc):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function u6(r,e){var n=r.document.documentElement,i=mi(r).on("dragstart.drag",null);e&&(i.on("click.drag",_l,Hc),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const nd=r=>()=>r;function Yp(r,{sourceEvent:e,subject:n,target:i,identifier:a,active:s,x:o,y:l,dx:c,dy:u,dispatch:h}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:h}})}Yp.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function sU(r){return!r.ctrlKey&&!r.button}function oU(){return this.parentNode}function lU(r,e){return e??{x:r.x,y:r.y}}function uU(){return navigator.maxTouchPoints||"ontouchstart"in this}function cU(){var r=sU,e=oU,n=lU,i=uU,a={},s=vf("start","drag","end"),o=0,l,c,u,h,g=0;function v(S){S.on("mousedown.drag",m).filter(i).on("touchstart.drag",x).on("touchmove.drag",A,aU).on("touchend.drag touchcancel.drag",C).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(S,M){if(!(h||!r.call(this,S,M))){var R=E(this,e.call(this,S,M),S,M,"mouse");R&&(mi(S.view).on("mousemove.drag",y,Hc).on("mouseup.drag",b,Hc),l6(S.view),j1(S),u=!1,l=S.clientX,c=S.clientY,R("start",S))}}function y(S){if(_l(S),!u){var M=S.clientX-l,R=S.clientY-c;u=M*M+R*R>g}a.mouse("drag",S)}function b(S){mi(S.view).on("mousemove.drag mouseup.drag",null),u6(S.view,u),_l(S),a.mouse("end",S)}function x(S,M){if(r.call(this,S,M)){var R=S.changedTouches,T=e.call(this,S,M),B=R.length,F,I;for(F=0;F<B;++F)(I=E(this,T,S,M,R[F].identifier,R[F]))&&(j1(S),I("start",S,R[F]))}}function A(S){var M=S.changedTouches,R=M.length,T,B;for(T=0;T<R;++T)(B=a[M[T].identifier])&&(_l(S),B("drag",S,M[T]))}function C(S){var M=S.changedTouches,R=M.length,T,B;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),T=0;T<R;++T)(B=a[M[T].identifier])&&(j1(S),B("end",S,M[T]))}function E(S,M,R,T,B,F){var I=s.copy(),U=ji(F||R,M),k,O,V;if((V=n.call(S,new Yp("beforestart",{sourceEvent:R,target:v,identifier:B,active:o,x:U[0],y:U[1],dx:0,dy:0,dispatch:I}),T))!=null)return k=V.x-U[0]||0,O=V.y-U[1]||0,function L(P,_,q){var H=U,W;switch(P){case"start":a[B]=L,W=o++;break;case"end":delete a[B],--o;case"drag":U=ji(q||_,M),W=o;break}I.call(P,S,new Yp(P,{sourceEvent:_,subject:V,target:v,identifier:B,active:W,x:U[0]+k,y:U[1]+O,dx:U[0]-H[0],dy:U[1]-H[1],dispatch:I}),T)}}return v.filter=function(S){return arguments.length?(r=typeof S=="function"?S:nd(!!S),v):r},v.container=function(S){return arguments.length?(e=typeof S=="function"?S:nd(S),v):e},v.subject=function(S){return arguments.length?(n=typeof S=="function"?S:nd(S),v):n},v.touchable=function(S){return arguments.length?(i=typeof S=="function"?S:nd(!!S),v):i},v.on=function(){var S=s.on.apply(s,arguments);return S===s?v:S},v.clickDistance=function(S){return arguments.length?(g=(S=+S)*S,v):Math.sqrt(g)},v}function H2(r,e,n){r.prototype=e.prototype=n,n.constructor=r}function c6(r,e){var n=Object.create(r.prototype);for(var i in e)n[i]=e[i];return n}function mf(){}var Kc=.7,o0=1/Kc,zl="\\s*([+-]?\\d+)\\s*",Xc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fU=/^#([0-9a-f]{3,8})$/,hU=new RegExp(`^rgb\\(${zl},${zl},${zl}\\)$`),dU=new RegExp(`^rgb\\(${Xi},${Xi},${Xi}\\)$`),gU=new RegExp(`^rgba\\(${zl},${zl},${zl},${Xc}\\)$`),vU=new RegExp(`^rgba\\(${Xi},${Xi},${Xi},${Xc}\\)$`),mU=new RegExp(`^hsl\\(${Xc},${Xi},${Xi}\\)$`),pU=new RegExp(`^hsla\\(${Xc},${Xi},${Xi},${Xc}\\)$`),f4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};H2(mf,Qc,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:h4,formatHex:h4,formatHex8:yU,formatHsl:AU,formatRgb:d4,toString:d4});function h4(){return this.rgb().formatHex()}function yU(){return this.rgb().formatHex8()}function AU(){return f6(this).formatHsl()}function d4(){return this.rgb().formatRgb()}function Qc(r){var e,n;return r=(r+"").trim().toLowerCase(),(e=fU.exec(r))?(n=e[1].length,e=parseInt(e[1],16),n===6?g4(e):n===3?new Pn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?id(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?id(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=hU.exec(r))?new Pn(e[1],e[2],e[3],1):(e=dU.exec(r))?new Pn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=gU.exec(r))?id(e[1],e[2],e[3],e[4]):(e=vU.exec(r))?id(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=mU.exec(r))?p4(e[1],e[2]/100,e[3]/100,1):(e=pU.exec(r))?p4(e[1],e[2]/100,e[3]/100,e[4]):f4.hasOwnProperty(r)?g4(f4[r]):r==="transparent"?new Pn(NaN,NaN,NaN,0):null}function g4(r){return new Pn(r>>16&255,r>>8&255,r&255,1)}function id(r,e,n,i){return i<=0&&(r=e=n=NaN),new Pn(r,e,n,i)}function xU(r){return r instanceof mf||(r=Qc(r)),r?(r=r.rgb(),new Pn(r.r,r.g,r.b,r.opacity)):new Pn}function jp(r,e,n,i){return arguments.length===1?xU(r):new Pn(r,e,n,i??1)}function Pn(r,e,n,i){this.r=+r,this.g=+e,this.b=+n,this.opacity=+i}H2(Pn,jp,c6(mf,{brighter(r){return r=r==null?o0:Math.pow(o0,r),new Pn(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Kc:Math.pow(Kc,r),new Pn(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Pn(yo(this.r),yo(this.g),yo(this.b),l0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:v4,formatHex:v4,formatHex8:bU,formatRgb:m4,toString:m4}));function v4(){return`#${vo(this.r)}${vo(this.g)}${vo(this.b)}`}function bU(){return`#${vo(this.r)}${vo(this.g)}${vo(this.b)}${vo((isNaN(this.opacity)?1:this.opacity)*255)}`}function m4(){const r=l0(this.opacity);return`${r===1?"rgb(":"rgba("}${yo(this.r)}, ${yo(this.g)}, ${yo(this.b)}${r===1?")":`, ${r})`}`}function l0(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function yo(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function vo(r){return r=yo(r),(r<16?"0":"")+r.toString(16)}function p4(r,e,n,i){return i<=0?r=e=n=NaN:n<=0||n>=1?r=e=NaN:e<=0&&(r=NaN),new Bi(r,e,n,i)}function f6(r){if(r instanceof Bi)return new Bi(r.h,r.s,r.l,r.opacity);if(r instanceof mf||(r=Qc(r)),!r)return new Bi;if(r instanceof Bi)return r;r=r.rgb();var e=r.r/255,n=r.g/255,i=r.b/255,a=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,l=s-a,c=(s+a)/2;return l?(e===s?o=(n-i)/l+(n<i)*6:n===s?o=(i-e)/l+2:o=(e-n)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new Bi(o,l,c,r.opacity)}function wU(r,e,n,i){return arguments.length===1?f6(r):new Bi(r,e,n,i??1)}function Bi(r,e,n,i){this.h=+r,this.s=+e,this.l=+n,this.opacity=+i}H2(Bi,wU,c6(mf,{brighter(r){return r=r==null?o0:Math.pow(o0,r),new Bi(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Kc:Math.pow(Kc,r),new Bi(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,a=2*n-i;return new Pn(H1(r>=240?r-240:r+120,a,i),H1(r,a,i),H1(r<120?r+240:r-120,a,i),this.opacity)},clamp(){return new Bi(y4(this.h),ad(this.s),ad(this.l),l0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=l0(this.opacity);return`${r===1?"hsl(":"hsla("}${y4(this.h)}, ${ad(this.s)*100}%, ${ad(this.l)*100}%${r===1?")":`, ${r})`}`}}));function y4(r){return r=(r||0)%360,r<0?r+360:r}function ad(r){return Math.max(0,Math.min(1,r||0))}function H1(r,e,n){return(r<60?e+(n-e)*r/60:r<180?n:r<240?e+(n-e)*(240-r)/60:e)*255}const h6=r=>()=>r;function CU(r,e){return function(n){return r+n*e}}function EU(r,e,n){return r=Math.pow(r,n),e=Math.pow(e,n)-r,n=1/n,function(i){return Math.pow(r+i*e,n)}}function SU(r){return(r=+r)==1?d6:function(e,n){return n-e?EU(e,n,r):h6(isNaN(e)?n:e)}}function d6(r,e){var n=e-r;return n?CU(r,n):h6(isNaN(r)?e:r)}const A4=(function r(e){var n=SU(e);function i(a,s){var o=n((a=jp(a)).r,(s=jp(s)).r),l=n(a.g,s.g),c=n(a.b,s.b),u=d6(a.opacity,s.opacity);return function(h){return a.r=o(h),a.g=l(h),a.b=c(h),a.opacity=u(h),a+""}}return i.gamma=r,i})(1);function ps(r,e){return r=+r,e=+e,function(n){return r*(1-n)+e*n}}var Hp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,K1=new RegExp(Hp.source,"g");function TU(r){return function(){return r}}function MU(r){return function(e){return r(e)+""}}function DU(r,e){var n=Hp.lastIndex=K1.lastIndex=0,i,a,s,o=-1,l=[],c=[];for(r=r+"",e=e+"";(i=Hp.exec(r))&&(a=K1.exec(e));)(s=a.index)>n&&(s=e.slice(n,s),l[o]?l[o]+=s:l[++o]=s),(i=i[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:ps(i,a)})),n=K1.lastIndex;return n<e.length&&(s=e.slice(n),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?MU(c[0].x):TU(e):(e=c.length,function(u){for(var h=0,g;h<e;++h)l[(g=c[h]).i]=g.x(u);return l.join("")})}var x4=180/Math.PI,Kp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function g6(r,e,n,i,a,s){var o,l,c;return(o=Math.sqrt(r*r+e*e))&&(r/=o,e/=o),(c=r*n+e*i)&&(n-=r*c,i-=e*c),(l=Math.sqrt(n*n+i*i))&&(n/=l,i/=l,c/=l),r*i<e*n&&(r=-r,e=-e,c=-c,o=-o),{translateX:a,translateY:s,rotate:Math.atan2(e,r)*x4,skewX:Math.atan(c)*x4,scaleX:o,scaleY:l}}var sd;function RU(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?Kp:g6(e.a,e.b,e.c,e.d,e.e,e.f)}function BU(r){return r==null||(sd||(sd=document.createElementNS("http://www.w3.org/2000/svg","g")),sd.setAttribute("transform",r),!(r=sd.transform.baseVal.consolidate()))?Kp:(r=r.matrix,g6(r.a,r.b,r.c,r.d,r.e,r.f))}function v6(r,e,n,i){function a(u){return u.length?u.pop()+" ":""}function s(u,h,g,v,m,y){if(u!==g||h!==v){var b=m.push("translate(",null,e,null,n);y.push({i:b-4,x:ps(u,g)},{i:b-2,x:ps(h,v)})}else(g||v)&&m.push("translate("+g+e+v+n)}function o(u,h,g,v){u!==h?(u-h>180?h+=360:h-u>180&&(u+=360),v.push({i:g.push(a(g)+"rotate(",null,i)-2,x:ps(u,h)})):h&&g.push(a(g)+"rotate("+h+i)}function l(u,h,g,v){u!==h?v.push({i:g.push(a(g)+"skewX(",null,i)-2,x:ps(u,h)}):h&&g.push(a(g)+"skewX("+h+i)}function c(u,h,g,v,m,y){if(u!==g||h!==v){var b=m.push(a(m)+"scale(",null,",",null,")");y.push({i:b-4,x:ps(u,g)},{i:b-2,x:ps(h,v)})}else(g!==1||v!==1)&&m.push(a(m)+"scale("+g+","+v+")")}return function(u,h){var g=[],v=[];return u=r(u),h=r(h),s(u.translateX,u.translateY,h.translateX,h.translateY,g,v),o(u.rotate,h.rotate,g,v),l(u.skewX,h.skewX,g,v),c(u.scaleX,u.scaleY,h.scaleX,h.scaleY,g,v),u=h=null,function(m){for(var y=-1,b=v.length,x;++y<b;)g[(x=v[y]).i]=x.x(m);return g.join("")}}}var IU=v6(RU,"px, ","px)","deg)"),NU=v6(BU,", ",")",")"),FU=1e-12;function b4(r){return((r=Math.exp(r))+1/r)/2}function kU(r){return((r=Math.exp(r))-1/r)/2}function UU(r){return((r=Math.exp(2*r))-1)/(r+1)}const VU=(function r(e,n,i){function a(s,o){var l=s[0],c=s[1],u=s[2],h=o[0],g=o[1],v=o[2],m=h-l,y=g-c,b=m*m+y*y,x,A;if(b<FU)A=Math.log(v/u)/e,x=function(T){return[l+T*m,c+T*y,u*Math.exp(e*T*A)]};else{var C=Math.sqrt(b),E=(v*v-u*u+i*b)/(2*u*n*C),S=(v*v-u*u-i*b)/(2*v*n*C),M=Math.log(Math.sqrt(E*E+1)-E),R=Math.log(Math.sqrt(S*S+1)-S);A=(R-M)/e,x=function(T){var B=T*A,F=b4(M),I=u/(n*C)*(F*UU(e*B+M)-kU(M));return[l+I*m,c+I*y,u*F/b4(e*B+M)]}}return x.duration=A*1e3*e/Math.SQRT2,x}return a.rho=function(s){var o=Math.max(.001,+s),l=o*o,c=l*l;return r(o,l,c)},a})(Math.SQRT2,2,4);var Hl=0,yc=0,ec=0,m6=1e3,u0,Ac,c0=0,Mo=0,_0=0,Zc=typeof performance=="object"&&performance.now?performance:Date,p6=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function K2(){return Mo||(p6(OU),Mo=Zc.now()+_0)}function OU(){Mo=0}function f0(){this._call=this._time=this._next=null}f0.prototype=X2.prototype={constructor:f0,restart:function(r,e,n){if(typeof r!="function")throw new TypeError("callback is not a function");n=(n==null?K2():+n)+(e==null?0:+e),!this._next&&Ac!==this&&(Ac?Ac._next=this:u0=this,Ac=this),this._call=r,this._time=n,Xp()},stop:function(){this._call&&(this._call=null,this._time=1/0,Xp())}};function X2(r,e,n){var i=new f0;return i.restart(r,e,n),i}function PU(){K2(),++Hl;for(var r=u0,e;r;)(e=Mo-r._time)>=0&&r._call.call(void 0,e),r=r._next;--Hl}function w4(){Mo=(c0=Zc.now())+_0,Hl=yc=0;try{PU()}finally{Hl=0,_U(),Mo=0}}function LU(){var r=Zc.now(),e=r-c0;e>m6&&(_0-=e,c0=r)}function _U(){for(var r,e=u0,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),r=e,e=e._next):(n=e._next,e._next=null,e=r?r._next=n:u0=n);Ac=r,Xp(i)}function Xp(r){if(!Hl){yc&&(yc=clearTimeout(yc));var e=r-Mo;e>24?(r<1/0&&(yc=setTimeout(w4,r-Zc.now()-_0)),ec&&(ec=clearInterval(ec))):(ec||(c0=Zc.now(),ec=setInterval(LU,m6)),Hl=1,p6(w4))}}function C4(r,e,n){var i=new f0;return e=e==null?0:+e,i.restart(a=>{i.stop(),r(a+e)},e,n),i}var zU=vf("start","end","cancel","interrupt"),GU=[],y6=0,E4=1,Qp=2,kd=3,S4=4,Zp=5,Ud=6;function z0(r,e,n,i,a,s){var o=r.__transition;if(!o)r.__transition={};else if(n in o)return;qU(r,n,{name:e,index:i,group:a,on:zU,tween:GU,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:y6})}function Q2(r,e){var n=ki(r,e);if(n.state>y6)throw new Error("too late; already scheduled");return n}function ea(r,e){var n=ki(r,e);if(n.state>kd)throw new Error("too late; already running");return n}function ki(r,e){var n=r.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function qU(r,e,n){var i=r.__transition,a;i[e]=n,n.timer=X2(s,0,n.time);function s(u){n.state=E4,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var h,g,v,m;if(n.state!==E4)return c();for(h in i)if(m=i[h],m.name===n.name){if(m.state===kd)return C4(o);m.state===S4?(m.state=Ud,m.timer.stop(),m.on.call("interrupt",r,r.__data__,m.index,m.group),delete i[h]):+h<e&&(m.state=Ud,m.timer.stop(),m.on.call("cancel",r,r.__data__,m.index,m.group),delete i[h])}if(C4(function(){n.state===kd&&(n.state=S4,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=Qp,n.on.call("start",r,r.__data__,n.index,n.group),n.state===Qp){for(n.state=kd,a=new Array(v=n.tween.length),h=0,g=-1;h<v;++h)(m=n.tween[h].value.call(r,r.__data__,n.index,n.group))&&(a[++g]=m);a.length=g+1}}function l(u){for(var h=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Zp,1),g=-1,v=a.length;++g<v;)a[g].call(r,h);n.state===Zp&&(n.on.call("end",r,r.__data__,n.index,n.group),c())}function c(){n.state=Ud,n.timer.stop(),delete i[e];for(var u in i)return;delete r.__transition}}function Vd(r,e){var n=r.__transition,i,a,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((i=n[o]).name!==e){s=!1;continue}a=i.state>Qp&&i.state<Zp,i.state=Ud,i.timer.stop(),i.on.call(a?"interrupt":"cancel",r,r.__data__,i.index,i.group),delete n[o]}s&&delete r.__transition}}function YU(r){return this.each(function(){Vd(this,r)})}function jU(r,e){var n,i;return function(){var a=ea(this,r),s=a.tween;if(s!==n){i=n=s;for(var o=0,l=i.length;o<l;++o)if(i[o].name===e){i=i.slice(),i.splice(o,1);break}}a.tween=i}}function HU(r,e,n){var i,a;if(typeof n!="function")throw new Error;return function(){var s=ea(this,r),o=s.tween;if(o!==i){a=(i=o).slice();for(var l={name:e,value:n},c=0,u=a.length;c<u;++c)if(a[c].name===e){a[c]=l;break}c===u&&a.push(l)}s.tween=a}}function KU(r,e){var n=this._id;if(r+="",arguments.length<2){for(var i=ki(this.node(),n).tween,a=0,s=i.length,o;a<s;++a)if((o=i[a]).name===r)return o.value;return null}return this.each((e==null?jU:HU)(n,r,e))}function Z2(r,e,n){var i=r._id;return r.each(function(){var a=ea(this,i);(a.value||(a.value={}))[e]=n.apply(this,arguments)}),function(a){return ki(a,i).value[e]}}function A6(r,e){var n;return(typeof e=="number"?ps:e instanceof Qc?A4:(n=Qc(e))?(e=n,A4):DU)(r,e)}function XU(r){return function(){this.removeAttribute(r)}}function QU(r){return function(){this.removeAttributeNS(r.space,r.local)}}function ZU(r,e,n){var i,a=n+"",s;return function(){var o=this.getAttribute(r);return o===a?null:o===i?s:s=e(i=o,n)}}function WU(r,e,n){var i,a=n+"",s;return function(){var o=this.getAttributeNS(r.space,r.local);return o===a?null:o===i?s:s=e(i=o,n)}}function JU(r,e,n){var i,a,s;return function(){var o,l=n(this),c;return l==null?void this.removeAttribute(r):(o=this.getAttribute(r),c=l+"",o===c?null:o===i&&c===a?s:(a=c,s=e(i=o,l)))}}function $U(r,e,n){var i,a,s;return function(){var o,l=n(this),c;return l==null?void this.removeAttributeNS(r.space,r.local):(o=this.getAttributeNS(r.space,r.local),c=l+"",o===c?null:o===i&&c===a?s:(a=c,s=e(i=o,l)))}}function eV(r,e){var n=L0(r),i=n==="transform"?NU:A6;return this.attrTween(r,typeof e=="function"?(n.local?$U:JU)(n,i,Z2(this,"attr."+r,e)):e==null?(n.local?QU:XU)(n):(n.local?WU:ZU)(n,i,e))}function tV(r,e){return function(n){this.setAttribute(r,e.call(this,n))}}function rV(r,e){return function(n){this.setAttributeNS(r.space,r.local,e.call(this,n))}}function nV(r,e){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&rV(r,s)),n}return a._value=e,a}function iV(r,e){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&tV(r,s)),n}return a._value=e,a}function aV(r,e){var n="attr."+r;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=L0(r);return this.tween(n,(i.local?nV:iV)(i,e))}function sV(r,e){return function(){Q2(this,r).delay=+e.apply(this,arguments)}}function oV(r,e){return e=+e,function(){Q2(this,r).delay=e}}function lV(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?sV:oV)(e,r)):ki(this.node(),e).delay}function uV(r,e){return function(){ea(this,r).duration=+e.apply(this,arguments)}}function cV(r,e){return e=+e,function(){ea(this,r).duration=e}}function fV(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?uV:cV)(e,r)):ki(this.node(),e).duration}function hV(r,e){if(typeof e!="function")throw new Error;return function(){ea(this,r).ease=e}}function dV(r){var e=this._id;return arguments.length?this.each(hV(e,r)):ki(this.node(),e).ease}function gV(r,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ea(this,r).ease=n}}function vV(r){if(typeof r!="function")throw new Error;return this.each(gV(this._id,r))}function mV(r){typeof r!="function"&&(r=JS(r));for(var e=this._groups,n=e.length,i=new Array(n),a=0;a<n;++a)for(var s=e[a],o=s.length,l=i[a]=[],c,u=0;u<o;++u)(c=s[u])&&r.call(c,c.__data__,u,s)&&l.push(c);return new Ia(i,this._parents,this._name,this._id)}function pV(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,n=r._groups,i=e.length,a=n.length,s=Math.min(i,a),o=new Array(i),l=0;l<s;++l)for(var c=e[l],u=n[l],h=c.length,g=o[l]=new Array(h),v,m=0;m<h;++m)(v=c[m]||u[m])&&(g[m]=v);for(;l<i;++l)o[l]=e[l];return new Ia(o,this._parents,this._name,this._id)}function yV(r){return(r+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function AV(r,e,n){var i,a,s=yV(e)?Q2:ea;return function(){var o=s(this,r),l=o.on;l!==i&&(a=(i=l).copy()).on(e,n),o.on=a}}function xV(r,e){var n=this._id;return arguments.length<2?ki(this.node(),n).on.on(r):this.each(AV(n,r,e))}function bV(r){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==r)return;e&&e.removeChild(this)}}function wV(){return this.on("end.remove",bV(this._id))}function CV(r){var e=this._name,n=this._id;typeof r!="function"&&(r=Y2(r));for(var i=this._groups,a=i.length,s=new Array(a),o=0;o<a;++o)for(var l=i[o],c=l.length,u=s[o]=new Array(c),h,g,v=0;v<c;++v)(h=l[v])&&(g=r.call(h,h.__data__,v,l))&&("__data__"in h&&(g.__data__=h.__data__),u[v]=g,z0(u[v],e,n,v,u,ki(h,n)));return new Ia(s,this._parents,e,n)}function EV(r){var e=this._name,n=this._id;typeof r!="function"&&(r=WS(r));for(var i=this._groups,a=i.length,s=[],o=[],l=0;l<a;++l)for(var c=i[l],u=c.length,h,g=0;g<u;++g)if(h=c[g]){for(var v=r.call(h,h.__data__,g,c),m,y=ki(h,n),b=0,x=v.length;b<x;++b)(m=v[b])&&z0(m,e,n,b,v,y);s.push(v),o.push(h)}return new Ia(s,o,e,n)}var SV=gf.prototype.constructor;function TV(){return new SV(this._groups,this._parents)}function MV(r,e){var n,i,a;return function(){var s=jl(this,r),o=(this.style.removeProperty(r),jl(this,r));return s===o?null:s===n&&o===i?a:a=e(n=s,i=o)}}function x6(r){return function(){this.style.removeProperty(r)}}function DV(r,e,n){var i,a=n+"",s;return function(){var o=jl(this,r);return o===a?null:o===i?s:s=e(i=o,n)}}function RV(r,e,n){var i,a,s;return function(){var o=jl(this,r),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(r),jl(this,r))),o===c?null:o===i&&c===a?s:(a=c,s=e(i=o,l))}}function BV(r,e){var n,i,a,s="style."+e,o="end."+s,l;return function(){var c=ea(this,r),u=c.on,h=c.value[s]==null?l||(l=x6(e)):void 0;(u!==n||a!==h)&&(i=(n=u).copy()).on(o,a=h),c.on=i}}function IV(r,e,n){var i=(r+="")=="transform"?IU:A6;return e==null?this.styleTween(r,MV(r,i)).on("end.style."+r,x6(r)):typeof e=="function"?this.styleTween(r,RV(r,i,Z2(this,"style."+r,e))).each(BV(this._id,r)):this.styleTween(r,DV(r,i,e),n).on("end.style."+r,null)}function NV(r,e,n){return function(i){this.style.setProperty(r,e.call(this,i),n)}}function FV(r,e,n){var i,a;function s(){var o=e.apply(this,arguments);return o!==a&&(i=(a=o)&&NV(r,o,n)),i}return s._value=e,s}function kV(r,e,n){var i="style."+(r+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,FV(r,e,n??""))}function UV(r){return function(){this.textContent=r}}function VV(r){return function(){var e=r(this);this.textContent=e??""}}function OV(r){return this.tween("text",typeof r=="function"?VV(Z2(this,"text",r)):UV(r==null?"":r+""))}function PV(r){return function(e){this.textContent=r.call(this,e)}}function LV(r){var e,n;function i(){var a=r.apply(this,arguments);return a!==n&&(e=(n=a)&&PV(a)),e}return i._value=r,i}function _V(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,LV(r))}function zV(){for(var r=this._name,e=this._id,n=b6(),i=this._groups,a=i.length,s=0;s<a;++s)for(var o=i[s],l=o.length,c,u=0;u<l;++u)if(c=o[u]){var h=ki(c,e);z0(c,r,n,u,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Ia(i,this._parents,r,n)}function GV(){var r,e,n=this,i=n._id,a=n.size();return new Promise(function(s,o){var l={value:o},c={value:function(){--a===0&&s()}};n.each(function(){var u=ea(this,i),h=u.on;h!==r&&(e=(r=h).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(c)),u.on=e}),a===0&&s()})}var qV=0;function Ia(r,e,n,i){this._groups=r,this._parents=e,this._name=n,this._id=i}function b6(){return++qV}var Aa=gf.prototype;Ia.prototype={constructor:Ia,select:CV,selectAll:EV,selectChild:Aa.selectChild,selectChildren:Aa.selectChildren,filter:mV,merge:pV,selection:TV,transition:zV,call:Aa.call,nodes:Aa.nodes,node:Aa.node,size:Aa.size,empty:Aa.empty,each:Aa.each,on:xV,attr:eV,attrTween:aV,style:IV,styleTween:kV,text:OV,textTween:_V,remove:wV,tween:KU,delay:lV,duration:fV,ease:dV,easeVarying:vV,end:GV,[Symbol.iterator]:Aa[Symbol.iterator]};function YV(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var jV={time:null,delay:0,duration:250,ease:YV};function HV(r,e){for(var n;!(n=r.__transition)||!(n=n[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return n}function KV(r){var e,n;r instanceof Ia?(e=r._id,r=r._name):(e=b6(),(n=jV).time=K2(),r=r==null?null:r+"");for(var i=this._groups,a=i.length,s=0;s<a;++s)for(var o=i[s],l=o.length,c,u=0;u<l;++u)(c=o[u])&&z0(c,r,e,u,o,n||HV(c,e));return new Ia(i,this._parents,r,e)}gf.prototype.interrupt=YU;gf.prototype.transition=KV;const od=r=>()=>r;function XV(r,{sourceEvent:e,target:n,transform:i,dispatch:a}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:a}})}function Ta(r,e,n){this.k=r,this.x=e,this.y=n}Ta.prototype={constructor:Ta,scale:function(r){return r===1?this:new Ta(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new Ta(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var W2=new Ta(1,0,0);Yi.prototype=Ta.prototype;function Yi(r){for(;!r.__zoom;)if(!(r=r.parentNode))return W2;return r.__zoom}function X1(r){r.stopImmediatePropagation()}function tc(r){r.preventDefault(),r.stopImmediatePropagation()}function QV(r){return(!r.ctrlKey||r.type==="wheel")&&!r.button}function ZV(){var r=this;return r instanceof SVGElement?(r=r.ownerSVGElement||r,r.hasAttribute("viewBox")?(r=r.viewBox.baseVal,[[r.x,r.y],[r.x+r.width,r.y+r.height]]):[[0,0],[r.width.baseVal.value,r.height.baseVal.value]]):[[0,0],[r.clientWidth,r.clientHeight]]}function T4(){return this.__zoom||W2}function WV(r){return-r.deltaY*(r.deltaMode===1?.05:r.deltaMode?1:.002)*(r.ctrlKey?10:1)}function JV(){return navigator.maxTouchPoints||"ontouchstart"in this}function $V(r,e,n){var i=r.invertX(e[0][0])-n[0][0],a=r.invertX(e[1][0])-n[1][0],s=r.invertY(e[0][1])-n[0][1],o=r.invertY(e[1][1])-n[1][1];return r.translate(a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function eO(){var r=QV,e=ZV,n=$V,i=WV,a=JV,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,c=VU,u=vf("start","zoom","end"),h,g,v,m=500,y=150,b=0,x=10;function A(V){V.property("__zoom",T4).on("wheel.zoom",B,{passive:!1}).on("mousedown.zoom",F).on("dblclick.zoom",I).filter(a).on("touchstart.zoom",U).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",O).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}A.transform=function(V,L,P,_){var q=V.selection?V.selection():V;q.property("__zoom",T4),V!==q?M(V,L,P,_):q.interrupt().each(function(){R(this,arguments).event(_).start().zoom(null,typeof L=="function"?L.apply(this,arguments):L).end()})},A.scaleBy=function(V,L,P,_){A.scaleTo(V,function(){var q=this.__zoom.k,H=typeof L=="function"?L.apply(this,arguments):L;return q*H},P,_)},A.scaleTo=function(V,L,P,_){A.transform(V,function(){var q=e.apply(this,arguments),H=this.__zoom,W=P==null?S(q):typeof P=="function"?P.apply(this,arguments):P,G=H.invert(W),K=typeof L=="function"?L.apply(this,arguments):L;return n(E(C(H,K),W,G),q,o)},P,_)},A.translateBy=function(V,L,P,_){A.transform(V,function(){return n(this.__zoom.translate(typeof L=="function"?L.apply(this,arguments):L,typeof P=="function"?P.apply(this,arguments):P),e.apply(this,arguments),o)},null,_)},A.translateTo=function(V,L,P,_,q){A.transform(V,function(){var H=e.apply(this,arguments),W=this.__zoom,G=_==null?S(H):typeof _=="function"?_.apply(this,arguments):_;return n(W2.translate(G[0],G[1]).scale(W.k).translate(typeof L=="function"?-L.apply(this,arguments):-L,typeof P=="function"?-P.apply(this,arguments):-P),H,o)},_,q)};function C(V,L){return L=Math.max(s[0],Math.min(s[1],L)),L===V.k?V:new Ta(L,V.x,V.y)}function E(V,L,P){var _=L[0]-P[0]*V.k,q=L[1]-P[1]*V.k;return _===V.x&&q===V.y?V:new Ta(V.k,_,q)}function S(V){return[(+V[0][0]+ +V[1][0])/2,(+V[0][1]+ +V[1][1])/2]}function M(V,L,P,_){V.on("start.zoom",function(){R(this,arguments).event(_).start()}).on("interrupt.zoom end.zoom",function(){R(this,arguments).event(_).end()}).tween("zoom",function(){var q=this,H=arguments,W=R(q,H).event(_),G=e.apply(q,H),K=P==null?S(G):typeof P=="function"?P.apply(q,H):P,$=Math.max(G[1][0]-G[0][0],G[1][1]-G[0][1]),te=q.__zoom,ae=typeof L=="function"?L.apply(q,H):L,ue=c(te.invert(K).concat($/te.k),ae.invert(K).concat($/ae.k));return function(re){if(re===1)re=ae;else{var ve=ue(re),le=$/ve[2];re=new Ta(le,K[0]-ve[0]*le,K[1]-ve[1]*le)}W.zoom(null,re)}})}function R(V,L,P){return!P&&V.__zooming||new T(V,L)}function T(V,L){this.that=V,this.args=L,this.active=0,this.sourceEvent=null,this.extent=e.apply(V,L),this.taps=0}T.prototype={event:function(V){return V&&(this.sourceEvent=V),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(V,L){return this.mouse&&V!=="mouse"&&(this.mouse[1]=L.invert(this.mouse[0])),this.touch0&&V!=="touch"&&(this.touch0[1]=L.invert(this.touch0[0])),this.touch1&&V!=="touch"&&(this.touch1[1]=L.invert(this.touch1[0])),this.that.__zoom=L,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(V){var L=mi(this.that).datum();u.call(V,this.that,new XV(V,{sourceEvent:this.sourceEvent,target:A,transform:this.that.__zoom,dispatch:u}),L)}};function B(V,...L){if(!r.apply(this,arguments))return;var P=R(this,L).event(V),_=this.__zoom,q=Math.max(s[0],Math.min(s[1],_.k*Math.pow(2,i.apply(this,arguments)))),H=ji(V);if(P.wheel)(P.mouse[0][0]!==H[0]||P.mouse[0][1]!==H[1])&&(P.mouse[1]=_.invert(P.mouse[0]=H)),clearTimeout(P.wheel);else{if(_.k===q)return;P.mouse=[H,_.invert(H)],Vd(this),P.start()}tc(V),P.wheel=setTimeout(W,y),P.zoom("mouse",n(E(C(_,q),P.mouse[0],P.mouse[1]),P.extent,o));function W(){P.wheel=null,P.end()}}function F(V,...L){if(v||!r.apply(this,arguments))return;var P=V.currentTarget,_=R(this,L,!0).event(V),q=mi(V.view).on("mousemove.zoom",K,!0).on("mouseup.zoom",$,!0),H=ji(V,P),W=V.clientX,G=V.clientY;l6(V.view),X1(V),_.mouse=[H,this.__zoom.invert(H)],Vd(this),_.start();function K(te){if(tc(te),!_.moved){var ae=te.clientX-W,ue=te.clientY-G;_.moved=ae*ae+ue*ue>b}_.event(te).zoom("mouse",n(E(_.that.__zoom,_.mouse[0]=ji(te,P),_.mouse[1]),_.extent,o))}function $(te){q.on("mousemove.zoom mouseup.zoom",null),u6(te.view,_.moved),tc(te),_.event(te).end()}}function I(V,...L){if(r.apply(this,arguments)){var P=this.__zoom,_=ji(V.changedTouches?V.changedTouches[0]:V,this),q=P.invert(_),H=P.k*(V.shiftKey?.5:2),W=n(E(C(P,H),_,q),e.apply(this,L),o);tc(V),l>0?mi(this).transition().duration(l).call(M,W,_,V):mi(this).call(A.transform,W,_,V)}}function U(V,...L){if(r.apply(this,arguments)){var P=V.touches,_=P.length,q=R(this,L,V.changedTouches.length===_).event(V),H,W,G,K;for(X1(V),W=0;W<_;++W)G=P[W],K=ji(G,this),K=[K,this.__zoom.invert(K),G.identifier],q.touch0?!q.touch1&&q.touch0[2]!==K[2]&&(q.touch1=K,q.taps=0):(q.touch0=K,H=!0,q.taps=1+!!h);h&&(h=clearTimeout(h)),H&&(q.taps<2&&(g=K[0],h=setTimeout(function(){h=null},m)),Vd(this),q.start())}}function k(V,...L){if(this.__zooming){var P=R(this,L).event(V),_=V.changedTouches,q=_.length,H,W,G,K;for(tc(V),H=0;H<q;++H)W=_[H],G=ji(W,this),P.touch0&&P.touch0[2]===W.identifier?P.touch0[0]=G:P.touch1&&P.touch1[2]===W.identifier&&(P.touch1[0]=G);if(W=P.that.__zoom,P.touch1){var $=P.touch0[0],te=P.touch0[1],ae=P.touch1[0],ue=P.touch1[1],re=(re=ae[0]-$[0])*re+(re=ae[1]-$[1])*re,ve=(ve=ue[0]-te[0])*ve+(ve=ue[1]-te[1])*ve;W=C(W,Math.sqrt(re/ve)),G=[($[0]+ae[0])/2,($[1]+ae[1])/2],K=[(te[0]+ue[0])/2,(te[1]+ue[1])/2]}else if(P.touch0)G=P.touch0[0],K=P.touch0[1];else return;P.zoom("touch",n(E(W,G,K),P.extent,o))}}function O(V,...L){if(this.__zooming){var P=R(this,L).event(V),_=V.changedTouches,q=_.length,H,W;for(X1(V),v&&clearTimeout(v),v=setTimeout(function(){v=null},m),H=0;H<q;++H)W=_[H],P.touch0&&P.touch0[2]===W.identifier?delete P.touch0:P.touch1&&P.touch1[2]===W.identifier&&delete P.touch1;if(P.touch1&&!P.touch0&&(P.touch0=P.touch1,delete P.touch1),P.touch0)P.touch0[1]=this.__zoom.invert(P.touch0[0]);else if(P.end(),P.taps===2&&(W=ji(W,this),Math.hypot(g[0]-W[0],g[1]-W[1])<x)){var G=mi(this).on("dblclick.zoom");G&&G.apply(this,arguments)}}}return A.wheelDelta=function(V){return arguments.length?(i=typeof V=="function"?V:od(+V),A):i},A.filter=function(V){return arguments.length?(r=typeof V=="function"?V:od(!!V),A):r},A.touchable=function(V){return arguments.length?(a=typeof V=="function"?V:od(!!V),A):a},A.extent=function(V){return arguments.length?(e=typeof V=="function"?V:od([[+V[0][0],+V[0][1]],[+V[1][0],+V[1][1]]]),A):e},A.scaleExtent=function(V){return arguments.length?(s[0]=+V[0],s[1]=+V[1],A):[s[0],s[1]]},A.translateExtent=function(V){return arguments.length?(o[0][0]=+V[0][0],o[1][0]=+V[1][0],o[0][1]=+V[0][1],o[1][1]=+V[1][1],A):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},A.constrain=function(V){return arguments.length?(n=V,A):n},A.duration=function(V){return arguments.length?(l=+V,A):l},A.interpolate=function(V){return arguments.length?(c=V,A):c},A.on=function(){var V=u.on.apply(u,arguments);return V===u?A:V},A.clickDistance=function(V){return arguments.length?(b=(V=+V)*V,A):Math.sqrt(b)},A.tapDistance=function(V){return arguments.length?(x=+V,A):x},A}class M4 extends Map{constructor(e,n=nO){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,a]of e)this.set(i,a)}get(e){return super.get(D4(this,e))}has(e){return super.has(D4(this,e))}set(e,n){return super.set(tO(this,e),n)}delete(e){return super.delete(rO(this,e))}}function D4({_intern:r,_key:e},n){const i=e(n);return r.has(i)?r.get(i):n}function tO({_intern:r,_key:e},n){const i=e(n);return r.has(i)?r.get(i):(r.set(i,n),n)}function rO({_intern:r,_key:e},n){const i=e(n);return r.has(i)&&(n=r.get(i),r.delete(i)),n}function nO(r){return r!==null&&typeof r=="object"?r.valueOf():r}function R4(r,e){let n;if(e===void 0)for(const i of r)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let a of r)(a=e(a,++i,r))!=null&&(n<a||n===void 0&&a>=a)&&(n=a)}return n}function B4(r,e){let n;if(e===void 0)for(const i of r)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let a of r)(a=e(a,++i,r))!=null&&(n>a||n===void 0&&a>=a)&&(n=a)}return n}function iO(r,e){let n=0;for(let i of r)(i=+i)&&(n+=i);return n}var aO=typeof global=="object"&&global&&global.Object===Object&&global,sO=typeof self=="object"&&self&&self.Object===Object&&self,w6=aO||sO||Function("return this")(),h0=w6.Symbol,C6=Object.prototype,oO=C6.hasOwnProperty,lO=C6.toString,rc=h0?h0.toStringTag:void 0;function uO(r){var e=oO.call(r,rc),n=r[rc];try{r[rc]=void 0;var i=!0}catch{}var a=lO.call(r);return i&&(e?r[rc]=n:delete r[rc]),a}var cO=Object.prototype,fO=cO.toString;function hO(r){return fO.call(r)}var dO="[object Null]",gO="[object Undefined]",I4=h0?h0.toStringTag:void 0;function vO(r){return r==null?r===void 0?gO:dO:I4&&I4 in Object(r)?uO(r):hO(r)}function mO(r){return r!=null&&typeof r=="object"}var pO="[object Symbol]";function yO(r){return typeof r=="symbol"||mO(r)&&vO(r)==pO}var AO=/\s/;function xO(r){for(var e=r.length;e--&&AO.test(r.charAt(e)););return e}var bO=/^\s+/;function wO(r){return r&&r.slice(0,xO(r)+1).replace(bO,"")}function d0(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var N4=NaN,CO=/^[-+]0x[0-9a-f]+$/i,EO=/^0b[01]+$/i,SO=/^0o[0-7]+$/i,TO=parseInt;function F4(r){if(typeof r=="number")return r;if(yO(r))return N4;if(d0(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=d0(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=wO(r);var n=EO.test(r);return n||SO.test(r)?TO(r.slice(2),n?2:8):CO.test(r)?N4:+r}var Q1=function(){return w6.Date.now()},MO="Expected a function",DO=Math.max,RO=Math.min;function E6(r,e,n){var i,a,s,o,l,c,u=0,h=!1,g=!1,v=!0;if(typeof r!="function")throw new TypeError(MO);e=F4(e)||0,d0(n)&&(h=!!n.leading,g="maxWait"in n,s=g?DO(F4(n.maxWait)||0,e):s,v="trailing"in n?!!n.trailing:v);function m(R){var T=i,B=a;return i=a=void 0,u=R,o=r.apply(B,T),o}function y(R){return u=R,l=setTimeout(A,e),h?m(R):o}function b(R){var T=R-c,B=R-u,F=e-T;return g?RO(F,s-B):F}function x(R){var T=R-c,B=R-u;return c===void 0||T>=e||T<0||g&&B>=s}function A(){var R=Q1();if(x(R))return C(R);l=setTimeout(A,b(R))}function C(R){return l=void 0,v&&i?m(R):(i=a=void 0,o)}function E(){l!==void 0&&clearTimeout(l),u=0,i=c=a=l=void 0}function S(){return l===void 0?o:C(Q1())}function M(){var R=Q1(),T=x(R);if(i=arguments,a=this,c=R,T){if(l===void 0)return y(c);if(g)return clearTimeout(l),l=setTimeout(A,e),m(c)}return l===void 0&&(l=setTimeout(A,e)),o}return M.cancel=E,M.flush=S,M}var BO="Expected a function";function IO(r,e,n){var i=!0,a=!0;if(typeof r!="function")throw new TypeError(BO);return d0(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),E6(r,e,{leading:i,maxWait:e,trailing:a})}var Ao=Object.freeze({Linear:Object.freeze({None:function(r){return r},In:function(r){return r},Out:function(r){return r},InOut:function(r){return r}}),Quadratic:Object.freeze({In:function(r){return r*r},Out:function(r){return r*(2-r)},InOut:function(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)}}),Cubic:Object.freeze({In:function(r){return r*r*r},Out:function(r){return--r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)}}),Quartic:Object.freeze({In:function(r){return r*r*r*r},Out:function(r){return 1- --r*r*r*r},InOut:function(r){return(r*=2)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2)}}),Quintic:Object.freeze({In:function(r){return r*r*r*r*r},Out:function(r){return--r*r*r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2)}}),Sinusoidal:Object.freeze({In:function(r){return 1-Math.sin((1-r)*Math.PI/2)},Out:function(r){return Math.sin(r*Math.PI/2)},InOut:function(r){return .5*(1-Math.sin(Math.PI*(.5-r)))}}),Exponential:Object.freeze({In:function(r){return r===0?0:Math.pow(1024,r-1)},Out:function(r){return r===1?1:1-Math.pow(2,-10*r)},InOut:function(r){return r===0?0:r===1?1:(r*=2)<1?.5*Math.pow(1024,r-1):.5*(-Math.pow(2,-10*(r-1))+2)}}),Circular:Object.freeze({In:function(r){return 1-Math.sqrt(1-r*r)},Out:function(r){return Math.sqrt(1- --r*r)},InOut:function(r){return(r*=2)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1)}}),Elastic:Object.freeze({In:function(r){return r===0?0:r===1?1:-Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI)},Out:function(r){return r===0?0:r===1?1:Math.pow(2,-10*r)*Math.sin((r-.1)*5*Math.PI)+1},InOut:function(r){return r===0?0:r===1?1:(r*=2,r<1?-.5*Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI):.5*Math.pow(2,-10*(r-1))*Math.sin((r-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(r){var e=1.70158;return r===1?1:r*r*((e+1)*r-e)},Out:function(r){var e=1.70158;return r===0?0:--r*r*((e+1)*r+e)+1},InOut:function(r){var e=2.5949095;return(r*=2)<1?.5*(r*r*((e+1)*r-e)):.5*((r-=2)*r*((e+1)*r+e)+2)}}),Bounce:Object.freeze({In:function(r){return 1-Ao.Bounce.Out(1-r)},Out:function(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},InOut:function(r){return r<.5?Ao.Bounce.In(r*2)*.5:Ao.Bounce.Out(r*2-1)*.5+.5}}),generatePow:function(r){return r===void 0&&(r=4),r=r<Number.EPSILON?Number.EPSILON:r,r=r>1e4?1e4:r,{In:function(e){return Math.pow(e,r)},Out:function(e){return 1-Math.pow(1-e,r)},InOut:function(e){return e<.5?Math.pow(e*2,r)/2:(1-Math.pow(2-e*2,r))/2+.5}}}}),xc=function(){return performance.now()},S6=(function(){function r(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return r.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},r.prototype.removeAll=function(){this._tweens={}},r.prototype.add=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var a=0,s=n;a<s.length;a++){var o=s[a];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},r.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var i=0,a=e;i<a.length;i++){var s=a[i];s._group=void 0,delete this._tweens[s.getId()],delete this._tweensAddedDuringUpdate[s.getId()]}},r.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},r.prototype.update=function(e,n){e===void 0&&(e=xc()),n===void 0&&(n=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var a=0;a<i.length;a++){var s=this._tweens[i[a]],o=!n;s&&s.update(e,o)===!1&&!n&&this.remove(s)}i=Object.keys(this._tweensAddedDuringUpdate)}},r})(),Wp={Linear:function(r,e){var n=r.length-1,i=n*e,a=Math.floor(i),s=Wp.Utils.Linear;return e<0?s(r[0],r[1],i):e>1?s(r[n],r[n-1],n-i):s(r[a],r[a+1>n?n:a+1],i-a)},Utils:{Linear:function(r,e,n){return(e-r)*n+r}}},T6=(function(){function r(){}return r.nextId=function(){return r._nextId++},r._nextId=0,r})(),Jp=new S6,k4=(function(){function r(e,n){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Ao.Linear.None,this._interpolationFunction=Wp.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=T6.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof n=="object"?(this._group=n,n.add(this)):n===!0&&(this._group=Jp,Jp.add(this))}return r.prototype.getId=function(){return this._id},r.prototype.isPlaying=function(){return this._isPlaying},r.prototype.isPaused=function(){return this._isPaused},r.prototype.getDuration=function(){return this._duration},r.prototype.to=function(e,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},r.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},r.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},r.prototype.start=function(e,n){if(e===void 0&&(e=xc()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var a={};for(var s in this._valuesEnd)a[s]=this._valuesEnd[s];this._valuesEnd=a}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},r.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},r.prototype._setupProperties=function(e,n,i,a,s){for(var o in i){var l=e[o],c=Array.isArray(l),u=c?"array":typeof l,h=!c&&Array.isArray(i[o]);if(!(u==="undefined"||u==="function")){if(h){var g=i[o];if(g.length===0)continue;for(var v=[l],m=0,y=g.length;m<y;m+=1){var b=this._handleRelativeValue(l,g[m]);if(isNaN(b)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}v.push(b)}h&&(i[o]=v)}if((u==="object"||c)&&l&&!h){n[o]=c?[]:{};var x=l;for(var A in x)n[o][A]=x[A];a[o]=c?[]:{};var g=i[o];if(!this._isDynamic){var C={};for(var A in g)C[A]=g[A];i[o]=g=C}this._setupProperties(x,n[o],g,a[o],s)}else(typeof n[o]>"u"||s)&&(n[o]=l),c||(n[o]*=1),h?a[o]=i[o].slice().reverse():a[o]=n[o]||0}}},r.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},r.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},r.prototype.pause=function(e){return e===void 0&&(e=xc()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},r.prototype.resume=function(e){return e===void 0&&(e=xc()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},r.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},r.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},r.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},r.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},r.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},r.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},r.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},r.prototype.easing=function(e){return e===void 0&&(e=Ao.Linear.None),this._easingFunction=e,this},r.prototype.interpolation=function(e){return e===void 0&&(e=Wp.Linear),this._interpolationFunction=e,this},r.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},r.prototype.onStart=function(e){return this._onStartCallback=e,this},r.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},r.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},r.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},r.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},r.prototype.onStop=function(e){return this._onStopCallback=e,this},r.prototype.update=function(e,n){var i=this,a;if(e===void 0&&(e=xc()),n===void 0&&(n=r.autoStartOnUpdate),this._isPaused)return!0;var s;if(!this._goToEnd&&!this._isPlaying)if(n)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,l=this._duration+((a=this._repeatDelayTime)!==null&&a!==void 0?a:this._delayTime),c=this._duration+this._repeat*l,u=function(){if(i._duration===0||o>c)return 1;var b=Math.trunc(o/l),x=o-b*l,A=Math.min(x/i._duration,1);return A===0&&o===i._duration?1:A},h=u(),g=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,g),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),this._duration===0||o>=this._duration)if(this._repeat>0){var v=Math.min(Math.trunc((o-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=v);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*v,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var m=0,y=this._chainedTweens.length;m<y;m++)this._chainedTweens[m].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},r.prototype._updateProperties=function(e,n,i,a){for(var s in i)if(n[s]!==void 0){var o=n[s]||0,l=i[s],c=Array.isArray(e[s]),u=Array.isArray(l),h=!c&&u;h?e[s]=this._interpolationFunction(l,a):typeof l=="object"&&l?this._updateProperties(e[s],o,l,a):(l=this._handleRelativeValue(o,l),typeof l=="number"&&(e[s]=o+(l-o)*a))}},r.prototype._handleRelativeValue=function(e,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?e+parseFloat(n):parseFloat(n)},r.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=n},r.autoStartOnUpdate=!1,r})();T6.nextId;var Wi=Jp;Wi.getAll.bind(Wi);Wi.removeAll.bind(Wi);Wi.add.bind(Wi);Wi.remove.bind(Wi);Wi.update.bind(Wi);function U4(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function NO(r){if(Array.isArray(r))return r}function FO(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function kO(r,e,n){return Object.defineProperty(r,"prototype",{writable:!1}),r}function UO(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(c=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,a=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function VO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OO(r,e){return NO(r)||UO(r,e)||PO(r,e)||VO()}function PO(r,e){if(r){if(typeof r=="string")return U4(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U4(r,e):void 0}}var LO=kO(function r(e,n){var i=n.default,a=i===void 0?null:i,s=n.triggerUpdate,o=s===void 0?!0:s,l=n.onChange,c=l===void 0?function(u,h){}:l;FO(this,r),this.name=e,this.defaultVal=a,this.triggerUpdate=o,this.onChange=c});function J2(r){var e=r.stateInit,n=e===void 0?function(){return{}}:e,i=r.props,a=i===void 0?{}:i,s=r.methods,o=s===void 0?{}:s,l=r.aliases,c=l===void 0?{}:l,u=r.init,h=u===void 0?function(){}:u,g=r.update,v=g===void 0?function(){}:g,m=Object.keys(a).map(function(y){return new LO(y,a[y])});return function y(){for(var b=arguments.length,x=new Array(b),A=0;A<b;A++)x[A]=arguments[A];var C=!!(this instanceof y&&this.constructor),E=C?x.shift():void 0,S=x[0],M=S===void 0?{}:S,R=Object.assign({},n instanceof Function?n(M):n,{initialised:!1}),T={};function B(U){return F(U,M),I(),B}var F=function(k,O){h.call(B,k,R,O),R.initialised=!0},I=E6(function(){R.initialised&&(v.call(B,R,T),T={})},1);return m.forEach(function(U){B[U.name]=k(U);function k(O){var V=O.name,L=O.triggerUpdate,P=L===void 0?!1:L,_=O.onChange,q=_===void 0?function(G,K){}:_,H=O.defaultVal,W=H===void 0?null:H;return function(G){var K=R[V];if(!arguments.length)return K;var $=G===void 0?W:G;return R[V]=$,q.call(B,$,R,K),!T.hasOwnProperty(V)&&(T[V]=K),P&&I(),B}}}),Object.keys(o).forEach(function(U){B[U]=function(){for(var k,O=arguments.length,V=new Array(O),L=0;L<O;L++)V[L]=arguments[L];return(k=o[U]).call.apply(k,[B,R].concat(V))}}),Object.entries(c).forEach(function(U){var k=OO(U,2),O=k[0],V=k[1];return B[O]=B[V]}),B.resetProps=function(){return m.forEach(function(U){B[U.name](U.defaultVal)}),B},B.resetProps(),R._rerender=I,C&&E&&B(E),B}}var Ut=(function(r){return typeof r=="function"?r:typeof r=="string"?function(e){return e[r]}:function(e){return r}});function g0(r){"@babel/helpers - typeof";return g0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g0(r)}var _O=/^\s+/,zO=/\s+$/;function Ze(r,e){if(r=r||"",e=e||{},r instanceof Ze)return r;if(!(this instanceof Ze))return new Ze(r,e);var n=GO(r);this._originalInput=r,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}Ze.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,i,a,s,o,l;return n=e.r/255,i=e.g/255,a=e.b/255,n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),a<=.03928?l=a/12.92:l=Math.pow((a+.055)/1.055,2.4),.2126*s+.7152*o+.0722*l},setAlpha:function(e){return this._a=M6(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=O4(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=O4(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),a=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+i+"%, "+a+"%)":"hsva("+n+", "+i+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var e=V4(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=V4(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),a=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+i+"%, "+a+"%)":"hsla("+n+", "+i+"%, "+a+"%, "+this._roundA+")"},toHex:function(e){return P4(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return HO(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(lr(this._r,255)*100)+"%",g:Math.round(lr(this._g,255)*100)+"%",b:Math.round(lr(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(lr(this._r,255)*100)+"%, "+Math.round(lr(this._g,255)*100)+"%, "+Math.round(lr(this._b,255)*100)+"%)":"rgba("+Math.round(lr(this._r,255)*100)+"%, "+Math.round(lr(this._g,255)*100)+"%, "+Math.round(lr(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:iP[P4(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+L4(this._r,this._g,this._b,this._a),i=n,a=this._gradientType?"GradientType = 1, ":"";if(e){var s=Ze(e);i="#"+L4(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+n+",endColorstr="+i+")"},toString:function(e){var n=!!e;e=e||this._format;var i=!1,a=this._a<1&&this._a>=0,s=!n&&a&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return Ze(this.toString())},_applyModification:function(e,n){var i=e.apply(null,[this].concat([].slice.call(n)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(ZO,arguments)},brighten:function(){return this._applyModification(WO,arguments)},darken:function(){return this._applyModification(JO,arguments)},desaturate:function(){return this._applyModification(KO,arguments)},saturate:function(){return this._applyModification(XO,arguments)},greyscale:function(){return this._applyModification(QO,arguments)},spin:function(){return this._applyModification($O,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(rP,arguments)},complement:function(){return this._applyCombination(eP,arguments)},monochromatic:function(){return this._applyCombination(nP,arguments)},splitcomplement:function(){return this._applyCombination(tP,arguments)},triad:function(){return this._applyCombination(_4,[3])},tetrad:function(){return this._applyCombination(_4,[4])}};Ze.fromRatio=function(r,e){if(g0(r)=="object"){var n={};for(var i in r)r.hasOwnProperty(i)&&(i==="a"?n[i]=r[i]:n[i]=bc(r[i]));r=n}return Ze(r,e)};function GO(r){var e={r:0,g:0,b:0},n=1,i=null,a=null,s=null,o=!1,l=!1;return typeof r=="string"&&(r=lP(r)),g0(r)=="object"&&(xa(r.r)&&xa(r.g)&&xa(r.b)?(e=qO(r.r,r.g,r.b),o=!0,l=String(r.r).substr(-1)==="%"?"prgb":"rgb"):xa(r.h)&&xa(r.s)&&xa(r.v)?(i=bc(r.s),a=bc(r.v),e=jO(r.h,i,a),o=!0,l="hsv"):xa(r.h)&&xa(r.s)&&xa(r.l)&&(i=bc(r.s),s=bc(r.l),e=YO(r.h,i,s),o=!0,l="hsl"),r.hasOwnProperty("a")&&(n=r.a)),n=M6(n),{ok:o,format:r.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function qO(r,e,n){return{r:lr(r,255)*255,g:lr(e,255)*255,b:lr(n,255)*255}}function V4(r,e,n){r=lr(r,255),e=lr(e,255),n=lr(n,255);var i=Math.max(r,e,n),a=Math.min(r,e,n),s,o,l=(i+a)/2;if(i==a)s=o=0;else{var c=i-a;switch(o=l>.5?c/(2-i-a):c/(i+a),i){case r:s=(e-n)/c+(e<n?6:0);break;case e:s=(n-r)/c+2;break;case n:s=(r-e)/c+4;break}s/=6}return{h:s,s:o,l}}function YO(r,e,n){var i,a,s;r=lr(r,360),e=lr(e,100),n=lr(n,100);function o(u,h,g){return g<0&&(g+=1),g>1&&(g-=1),g<1/6?u+(h-u)*6*g:g<1/2?h:g<2/3?u+(h-u)*(2/3-g)*6:u}if(e===0)i=a=s=n;else{var l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;i=o(c,l,r+1/3),a=o(c,l,r),s=o(c,l,r-1/3)}return{r:i*255,g:a*255,b:s*255}}function O4(r,e,n){r=lr(r,255),e=lr(e,255),n=lr(n,255);var i=Math.max(r,e,n),a=Math.min(r,e,n),s,o,l=i,c=i-a;if(o=i===0?0:c/i,i==a)s=0;else{switch(i){case r:s=(e-n)/c+(e<n?6:0);break;case e:s=(n-r)/c+2;break;case n:s=(r-e)/c+4;break}s/=6}return{h:s,s:o,v:l}}function jO(r,e,n){r=lr(r,360)*6,e=lr(e,100),n=lr(n,100);var i=Math.floor(r),a=r-i,s=n*(1-e),o=n*(1-a*e),l=n*(1-(1-a)*e),c=i%6,u=[n,o,s,s,l,n][c],h=[l,n,n,o,s,s][c],g=[s,s,l,n,n,o][c];return{r:u*255,g:h*255,b:g*255}}function P4(r,e,n,i){var a=[Ii(Math.round(r).toString(16)),Ii(Math.round(e).toString(16)),Ii(Math.round(n).toString(16))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function HO(r,e,n,i,a){var s=[Ii(Math.round(r).toString(16)),Ii(Math.round(e).toString(16)),Ii(Math.round(n).toString(16)),Ii(D6(i))];return a&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function L4(r,e,n,i){var a=[Ii(D6(i)),Ii(Math.round(r).toString(16)),Ii(Math.round(e).toString(16)),Ii(Math.round(n).toString(16))];return a.join("")}Ze.equals=function(r,e){return!r||!e?!1:Ze(r).toRgbString()==Ze(e).toRgbString()};Ze.random=function(){return Ze.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function KO(r,e){e=e===0?0:e||10;var n=Ze(r).toHsl();return n.s-=e/100,n.s=G0(n.s),Ze(n)}function XO(r,e){e=e===0?0:e||10;var n=Ze(r).toHsl();return n.s+=e/100,n.s=G0(n.s),Ze(n)}function QO(r){return Ze(r).desaturate(100)}function ZO(r,e){e=e===0?0:e||10;var n=Ze(r).toHsl();return n.l+=e/100,n.l=G0(n.l),Ze(n)}function WO(r,e){e=e===0?0:e||10;var n=Ze(r).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),Ze(n)}function JO(r,e){e=e===0?0:e||10;var n=Ze(r).toHsl();return n.l-=e/100,n.l=G0(n.l),Ze(n)}function $O(r,e){var n=Ze(r).toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,Ze(n)}function eP(r){var e=Ze(r).toHsl();return e.h=(e.h+180)%360,Ze(e)}function _4(r,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=Ze(r).toHsl(),i=[Ze(r)],a=360/e,s=1;s<e;s++)i.push(Ze({h:(n.h+s*a)%360,s:n.s,l:n.l}));return i}function tP(r){var e=Ze(r).toHsl(),n=e.h;return[Ze(r),Ze({h:(n+72)%360,s:e.s,l:e.l}),Ze({h:(n+216)%360,s:e.s,l:e.l})]}function rP(r,e,n){e=e||6,n=n||30;var i=Ze(r).toHsl(),a=360/n,s=[Ze(r)];for(i.h=(i.h-(a*e>>1)+720)%360;--e;)i.h=(i.h+a)%360,s.push(Ze(i));return s}function nP(r,e){e=e||6;for(var n=Ze(r).toHsv(),i=n.h,a=n.s,s=n.v,o=[],l=1/e;e--;)o.push(Ze({h:i,s:a,v:s})),s=(s+l)%1;return o}Ze.mix=function(r,e,n){n=n===0?0:n||50;var i=Ze(r).toRgb(),a=Ze(e).toRgb(),s=n/100,o={r:(a.r-i.r)*s+i.r,g:(a.g-i.g)*s+i.g,b:(a.b-i.b)*s+i.b,a:(a.a-i.a)*s+i.a};return Ze(o)};Ze.readability=function(r,e){var n=Ze(r),i=Ze(e);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)};Ze.isReadable=function(r,e,n){var i=Ze.readability(r,e),a,s;switch(s=!1,a=uP(n),a.level+a.size){case"AAsmall":case"AAAlarge":s=i>=4.5;break;case"AAlarge":s=i>=3;break;case"AAAsmall":s=i>=7;break}return s};Ze.mostReadable=function(r,e,n){var i=null,a=0,s,o,l,c;n=n||{},o=n.includeFallbackColors,l=n.level,c=n.size;for(var u=0;u<e.length;u++)s=Ze.readability(r,e[u]),s>a&&(a=s,i=Ze(e[u]));return Ze.isReadable(r,i,{level:l,size:c})||!o?i:(n.includeFallbackColors=!1,Ze.mostReadable(r,["#fff","#000"],n))};var $p=Ze.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},iP=Ze.hexNames=aP($p);function aP(r){var e={};for(var n in r)r.hasOwnProperty(n)&&(e[r[n]]=n);return e}function M6(r){return r=parseFloat(r),(isNaN(r)||r<0||r>1)&&(r=1),r}function lr(r,e){sP(r)&&(r="100%");var n=oP(r);return r=Math.min(e,Math.max(0,parseFloat(r))),n&&(r=parseInt(r*e,10)/100),Math.abs(r-e)<1e-6?1:r%e/parseFloat(e)}function G0(r){return Math.min(1,Math.max(0,r))}function Qn(r){return parseInt(r,16)}function sP(r){return typeof r=="string"&&r.indexOf(".")!=-1&&parseFloat(r)===1}function oP(r){return typeof r=="string"&&r.indexOf("%")!=-1}function Ii(r){return r.length==1?"0"+r:""+r}function bc(r){return r<=1&&(r=r*100+"%"),r}function D6(r){return Math.round(parseFloat(r)*255).toString(16)}function z4(r){return Qn(r)/255}var Ei=(function(){var r="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+r+")",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",a="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function xa(r){return!!Ei.CSS_UNIT.exec(r)}function lP(r){r=r.replace(_O,"").replace(zO,"").toLowerCase();var e=!1;if($p[r])r=$p[r],e=!0;else if(r=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=Ei.rgb.exec(r))?{r:n[1],g:n[2],b:n[3]}:(n=Ei.rgba.exec(r))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Ei.hsl.exec(r))?{h:n[1],s:n[2],l:n[3]}:(n=Ei.hsla.exec(r))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Ei.hsv.exec(r))?{h:n[1],s:n[2],v:n[3]}:(n=Ei.hsva.exec(r))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Ei.hex8.exec(r))?{r:Qn(n[1]),g:Qn(n[2]),b:Qn(n[3]),a:z4(n[4]),format:e?"name":"hex8"}:(n=Ei.hex6.exec(r))?{r:Qn(n[1]),g:Qn(n[2]),b:Qn(n[3]),format:e?"name":"hex"}:(n=Ei.hex4.exec(r))?{r:Qn(n[1]+""+n[1]),g:Qn(n[2]+""+n[2]),b:Qn(n[3]+""+n[3]),a:z4(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=Ei.hex3.exec(r))?{r:Qn(n[1]+""+n[1]),g:Qn(n[2]+""+n[2]),b:Qn(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function uP(r){var e,n;return r=r||{level:"AA",size:"small"},e=(r.level||"AA").toUpperCase(),n=(r.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}function e2(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function cP(r){if(Array.isArray(r))return e2(r)}function R6(r,e,n){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function fP(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hP(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function hi(r,e){return r.get(R6(r,e))}function G4(r,e,n){fP(r,e),e.set(r,n)}function q4(r,e,n){return r.set(R6(r,e),n),n}function dP(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,AP(i.key),i)}}function gP(r,e,n){return e&&dP(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function vP(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function mP(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pP(r){return cP(r)||vP(r)||xP(r)||mP()}function yP(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function AP(r){var e=yP(r,"string");return typeof e=="symbol"?e:e+""}function xP(r,e){if(r){if(typeof r=="string")return e2(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e2(r,e):void 0}}var bP=123,wP=function(e){return"#".concat(Math.min(e,Math.pow(2,24)).toString(16).padStart(6,"0"))},B6=function(e,n,i){return(e<<16)+(n<<8)+i},CP=function(e){var n=Ze(e).toRgb(),i=n.r,a=n.g,s=n.b;return B6(i,a,s)},Y4=function(e,n){return e*bP%Math.pow(2,n)},no=new WeakMap,ba=new WeakMap,EP=(function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;hP(this,r),G4(this,no,void 0),G4(this,ba,void 0),q4(ba,this,e),this.reset()}return gP(r,[{key:"reset",value:function(){q4(no,this,["__reserved for background__"])}},{key:"register",value:function(n){if(hi(no,this).length>=Math.pow(2,24-hi(ba,this)))return null;var i=hi(no,this).length,a=Y4(i,hi(ba,this)),s=wP(i+(a<<24-hi(ba,this)));return hi(no,this).push(n),s}},{key:"lookup",value:function(n){if(!n)return null;var i=typeof n=="string"?CP(n):B6.apply(void 0,pP(n));if(!i)return null;var a=i&Math.pow(2,24-hi(ba,this))-1,s=i>>24-hi(ba,this)&Math.pow(2,hi(ba,this))-1;return Y4(a,hi(ba,this))!==s||a>=hi(no,this).length?null:hi(no,this)[a]}}])})(),pf,cr,I6,N6,fo,j4,F6,k6,U6,$2,t2,r2,Wc={},V6=[],SP=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,q0=Array.isArray;function Ki(r,e){for(var n in e)r[n]=e[n];return r}function ey(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function TP(r,e,n){var i,a,s,o={};for(s in e)s=="key"?i=e[s]:s=="ref"?a=e[s]:o[s]=e[s];if(arguments.length>2&&(o.children=arguments.length>3?pf.call(arguments,2):n),typeof r=="function"&&r.defaultProps!=null)for(s in r.defaultProps)o[s]===void 0&&(o[s]=r.defaultProps[s]);return Rc(r,o,i,a,null)}function Rc(r,e,n,i,a){var s={type:r,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++I6,__i:-1,__u:0};return a==null&&cr.vnode!=null&&cr.vnode(s),s}function Y0(r){return r.children}function Od(r,e){this.props=r,this.context=e}function Kl(r,e){if(e==null)return r.__?Kl(r.__,r.__i+1):null;for(var n;e<r.__k.length;e++)if((n=r.__k[e])!=null&&n.__e!=null)return n.__e;return typeof r.type=="function"?Kl(r):null}function O6(r){var e,n;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((n=r.__k[e])!=null&&n.__e!=null){r.__e=r.__c.base=n.__e;break}return O6(r)}}function H4(r){(!r.__d&&(r.__d=!0)&&fo.push(r)&&!v0.__r++||j4!=cr.debounceRendering)&&((j4=cr.debounceRendering)||F6)(v0)}function v0(){for(var r,e,n,i,a,s,o,l=1;fo.length;)fo.length>l&&fo.sort(k6),r=fo.shift(),l=fo.length,r.__d&&(n=void 0,i=void 0,a=(i=(e=r).__v).__e,s=[],o=[],e.__P&&((n=Ki({},i)).__v=i.__v+1,cr.vnode&&cr.vnode(n),ty(e.__P,n,i,e.__n,e.__P.namespaceURI,32&i.__u?[a]:null,s,a??Kl(i),!!(32&i.__u),o),n.__v=i.__v,n.__.__k[n.__i]=n,_6(s,n,o),i.__e=i.__=null,n.__e!=a&&O6(n)));v0.__r=0}function P6(r,e,n,i,a,s,o,l,c,u,h){var g,v,m,y,b,x,A,C=i&&i.__k||V6,E=e.length;for(c=MP(n,e,C,c,E),g=0;g<E;g++)(m=n.__k[g])!=null&&(v=m.__i==-1?Wc:C[m.__i]||Wc,m.__i=g,x=ty(r,m,v,a,s,o,l,c,u,h),y=m.__e,m.ref&&v.ref!=m.ref&&(v.ref&&ry(v.ref,null,m),h.push(m.ref,m.__c||y,m)),b==null&&y!=null&&(b=y),(A=!!(4&m.__u))||v.__k===m.__k?c=L6(m,c,r,A):typeof m.type=="function"&&x!==void 0?c=x:y&&(c=y.nextSibling),m.__u&=-7);return n.__e=b,c}function MP(r,e,n,i,a){var s,o,l,c,u,h=n.length,g=h,v=0;for(r.__k=new Array(a),s=0;s<a;s++)(o=e[s])!=null&&typeof o!="boolean"&&typeof o!="function"?(c=s+v,(o=r.__k[s]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Rc(null,o,null,null,null):q0(o)?Rc(Y0,{children:o},null,null,null):o.constructor==null&&o.__b>0?Rc(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=r,o.__b=r.__b+1,l=null,(u=o.__i=DP(o,n,c,g))!=-1&&(g--,(l=n[u])&&(l.__u|=2)),l==null||l.__v==null?(u==-1&&(a>h?v--:a<h&&v++),typeof o.type!="function"&&(o.__u|=4)):u!=c&&(u==c-1?v--:u==c+1?v++:(u>c?v--:v++,o.__u|=4))):r.__k[s]=null;if(g)for(s=0;s<h;s++)(l=n[s])!=null&&(2&l.__u)==0&&(l.__e==i&&(i=Kl(l)),G6(l,l));return i}function L6(r,e,n,i){var a,s;if(typeof r.type=="function"){for(a=r.__k,s=0;a&&s<a.length;s++)a[s]&&(a[s].__=r,e=L6(a[s],e,n,i));return e}r.__e!=e&&(i&&(e&&r.type&&!e.parentNode&&(e=Kl(r)),n.insertBefore(r.__e,e||null)),e=r.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function DP(r,e,n,i){var a,s,o,l=r.key,c=r.type,u=e[n],h=u!=null&&(2&u.__u)==0;if(u===null&&r.key==null||h&&l==u.key&&c==u.type)return n;if(i>(h?1:0)){for(a=n-1,s=n+1;a>=0||s<e.length;)if((u=e[o=a>=0?a--:s++])!=null&&(2&u.__u)==0&&l==u.key&&c==u.type)return o}return-1}function K4(r,e,n){e[0]=="-"?r.setProperty(e,n??""):r[e]=n==null?"":typeof n!="number"||SP.test(e)?n:n+"px"}function ld(r,e,n,i,a){var s,o;e:if(e=="style")if(typeof n=="string")r.style.cssText=n;else{if(typeof i=="string"&&(r.style.cssText=i=""),i)for(e in i)n&&e in n||K4(r.style,e,"");if(n)for(e in n)i&&n[e]==i[e]||K4(r.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(U6,"$1")),o=e.toLowerCase(),e=o in r||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),r.l||(r.l={}),r.l[e+s]=n,n?i?n.u=i.u:(n.u=$2,r.addEventListener(e,s?r2:t2,s)):r.removeEventListener(e,s?r2:t2,s);else{if(a=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in r)try{r[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?r.removeAttribute(e):r.setAttribute(e,e=="popover"&&n==1?"":n))}}function X4(r){return function(e){if(this.l){var n=this.l[e.type+r];if(e.t==null)e.t=$2++;else if(e.t<n.u)return;return n(cr.event?cr.event(e):e)}}}function ty(r,e,n,i,a,s,o,l,c,u){var h,g,v,m,y,b,x,A,C,E,S,M,R,T,B,F,I,U=e.type;if(e.constructor!=null)return null;128&n.__u&&(c=!!(32&n.__u),s=[l=e.__e=n.__e]),(h=cr.__b)&&h(e);e:if(typeof U=="function")try{if(A=e.props,C="prototype"in U&&U.prototype.render,E=(h=U.contextType)&&i[h.__c],S=h?E?E.props.value:h.__:i,n.__c?x=(g=e.__c=n.__c).__=g.__E:(C?e.__c=g=new U(A,S):(e.__c=g=new Od(A,S),g.constructor=U,g.render=BP),E&&E.sub(g),g.props=A,g.state||(g.state={}),g.context=S,g.__n=i,v=g.__d=!0,g.__h=[],g._sb=[]),C&&g.__s==null&&(g.__s=g.state),C&&U.getDerivedStateFromProps!=null&&(g.__s==g.state&&(g.__s=Ki({},g.__s)),Ki(g.__s,U.getDerivedStateFromProps(A,g.__s))),m=g.props,y=g.state,g.__v=e,v)C&&U.getDerivedStateFromProps==null&&g.componentWillMount!=null&&g.componentWillMount(),C&&g.componentDidMount!=null&&g.__h.push(g.componentDidMount);else{if(C&&U.getDerivedStateFromProps==null&&A!==m&&g.componentWillReceiveProps!=null&&g.componentWillReceiveProps(A,S),!g.__e&&g.shouldComponentUpdate!=null&&g.shouldComponentUpdate(A,g.__s,S)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(g.props=A,g.state=g.__s,g.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(k){k&&(k.__=e)}),M=0;M<g._sb.length;M++)g.__h.push(g._sb[M]);g._sb=[],g.__h.length&&o.push(g);break e}g.componentWillUpdate!=null&&g.componentWillUpdate(A,g.__s,S),C&&g.componentDidUpdate!=null&&g.__h.push(function(){g.componentDidUpdate(m,y,b)})}if(g.context=S,g.props=A,g.__P=r,g.__e=!1,R=cr.__r,T=0,C){for(g.state=g.__s,g.__d=!1,R&&R(e),h=g.render(g.props,g.state,g.context),B=0;B<g._sb.length;B++)g.__h.push(g._sb[B]);g._sb=[]}else do g.__d=!1,R&&R(e),h=g.render(g.props,g.state,g.context),g.state=g.__s;while(g.__d&&++T<25);g.state=g.__s,g.getChildContext!=null&&(i=Ki(Ki({},i),g.getChildContext())),C&&!v&&g.getSnapshotBeforeUpdate!=null&&(b=g.getSnapshotBeforeUpdate(m,y)),F=h,h!=null&&h.type===Y0&&h.key==null&&(F=z6(h.props.children)),l=P6(r,q0(F)?F:[F],e,n,i,a,s,o,l,c,u),g.base=e.__e,e.__u&=-161,g.__h.length&&o.push(g),x&&(g.__E=g.__=null)}catch(k){if(e.__v=null,c||s!=null)if(k.then){for(e.__u|=c?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;s[s.indexOf(l)]=null,e.__e=l}else{for(I=s.length;I--;)ey(s[I]);n2(e)}else e.__e=n.__e,e.__k=n.__k,k.then||n2(e);cr.__e(k,e,n)}else s==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=RP(n.__e,e,n,i,a,s,o,c,u);return(h=cr.diffed)&&h(e),128&e.__u?void 0:l}function n2(r){r&&r.__c&&(r.__c.__e=!0),r&&r.__k&&r.__k.forEach(n2)}function _6(r,e,n){for(var i=0;i<n.length;i++)ry(n[i],n[++i],n[++i]);cr.__c&&cr.__c(e,r),r.some(function(a){try{r=a.__h,a.__h=[],r.some(function(s){s.call(a)})}catch(s){cr.__e(s,a.__v)}})}function z6(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:q0(r)?r.map(z6):Ki({},r)}function RP(r,e,n,i,a,s,o,l,c){var u,h,g,v,m,y,b,x=n.props,A=e.props,C=e.type;if(C=="svg"?a="http://www.w3.org/2000/svg":C=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),s!=null){for(u=0;u<s.length;u++)if((m=s[u])&&"setAttribute"in m==!!C&&(C?m.localName==C:m.nodeType==3)){r=m,s[u]=null;break}}if(r==null){if(C==null)return document.createTextNode(A);r=document.createElementNS(a,C,A.is&&A),l&&(cr.__m&&cr.__m(e,s),l=!1),s=null}if(C==null)x===A||l&&r.data==A||(r.data=A);else{if(s=s&&pf.call(r.childNodes),x=n.props||Wc,!l&&s!=null)for(x={},u=0;u<r.attributes.length;u++)x[(m=r.attributes[u]).name]=m.value;for(u in x)if(m=x[u],u!="children"){if(u=="dangerouslySetInnerHTML")g=m;else if(!(u in A)){if(u=="value"&&"defaultValue"in A||u=="checked"&&"defaultChecked"in A)continue;ld(r,u,null,m,a)}}for(u in A)m=A[u],u=="children"?v=m:u=="dangerouslySetInnerHTML"?h=m:u=="value"?y=m:u=="checked"?b=m:l&&typeof m!="function"||x[u]===m||ld(r,u,m,x[u],a);if(h)l||g&&(h.__html==g.__html||h.__html==r.innerHTML)||(r.innerHTML=h.__html),e.__k=[];else if(g&&(r.innerHTML=""),P6(e.type=="template"?r.content:r,q0(v)?v:[v],e,n,i,C=="foreignObject"?"http://www.w3.org/1999/xhtml":a,s,o,s?s[0]:n.__k&&Kl(n,0),l,c),s!=null)for(u=s.length;u--;)ey(s[u]);l||(u="value",C=="progress"&&y==null?r.removeAttribute("value"):y!=null&&(y!==r[u]||C=="progress"&&!y||C=="option"&&y!=x[u])&&ld(r,u,y,x[u],a),u="checked",b!=null&&b!=r[u]&&ld(r,u,b,x[u],a))}return r}function ry(r,e,n){try{if(typeof r=="function"){var i=typeof r.__u=="function";i&&r.__u(),i&&e==null||(r.__u=r(e))}else r.current=e}catch(a){cr.__e(a,n)}}function G6(r,e,n){var i,a;if(cr.unmount&&cr.unmount(r),(i=r.ref)&&(i.current&&i.current!=r.__e||ry(i,null,e)),(i=r.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){cr.__e(s,e)}i.base=i.__P=null}if(i=r.__k)for(a=0;a<i.length;a++)i[a]&&G6(i[a],e,n||typeof r.type!="function");n||ey(r.__e),r.__c=r.__=r.__e=void 0}function BP(r,e,n){return this.constructor(r,n)}function IP(r,e,n){var i,a,s,o;e==document&&(e=document.documentElement),cr.__&&cr.__(r,e),a=(i=!1)?null:e.__k,s=[],o=[],ty(e,r=e.__k=TP(Y0,null,[r]),a||Wc,Wc,e.namespaceURI,a?null:e.firstChild?pf.call(e.childNodes):null,s,a?a.__e:e.firstChild,i,o),_6(s,r,o)}function q6(r,e,n){var i,a,s,o,l=Ki({},r.props);for(s in r.type&&r.type.defaultProps&&(o=r.type.defaultProps),e)s=="key"?i=e[s]:s=="ref"?a=e[s]:l[s]=e[s]===void 0&&o!=null?o[s]:e[s];return arguments.length>2&&(l.children=arguments.length>3?pf.call(arguments,2):n),Rc(r.type,l,i||r.key,a||r.ref,null)}pf=V6.slice,cr={__e:function(r,e,n,i){for(var a,s,o;e=e.__;)if((a=e.__c)&&!a.__)try{if((s=a.constructor)&&s.getDerivedStateFromError!=null&&(a.setState(s.getDerivedStateFromError(r)),o=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(r,i||{}),o=a.__d),o)return a.__E=a}catch(l){r=l}throw r}},I6=0,N6=function(r){return r!=null&&r.constructor==null},Od.prototype.setState=function(r,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Ki({},this.state),typeof r=="function"&&(r=r(Ki({},n),this.props)),r&&Ki(n,r),r!=null&&this.__v&&(e&&this._sb.push(e),H4(this))},Od.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),H4(this))},Od.prototype.render=Y0,fo=[],F6=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,k6=function(r,e){return r.__v.__b-e.__v.__b},v0.__r=0,U6=/(PointerCapture)$|Capture$/i,$2=0,t2=X4(!1),r2=X4(!0);function Q4(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function NP(r){if(Array.isArray(r))return r}function FP(r,e,n){return(e=LP(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function kP(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(c=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,a=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function UP(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z4(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),n.push.apply(n,i)}return n}function VP(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Z4(Object(n),!0).forEach(function(i){FP(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):Z4(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function OP(r,e){return NP(r)||kP(r,e)||_P(r,e)||UP()}function PP(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function LP(r){var e=PP(r,"string");return typeof e=="symbol"?e:e+""}function m0(r){"@babel/helpers - typeof";return m0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m0(r)}function _P(r,e){if(r){if(typeof r=="string")return Q4(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q4(r,e):void 0}}var i2=function(e){if(m0(e)!=="object")return e;var n=q6(e);if(n.props){var i;n.props=VP({},n.props),n!=null&&(i=n.props)!==null&&i!==void 0&&i.children&&(n.props.children=Array.isArray(n.props.children)?n.props.children.map(i2):i2(n.props.children))}return n},zP=function(e){return N6(q6(e))},GP=function(e,n){delete n.__k,IP(i2(e),n)};function qP(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",n==="top"&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=r:a.appendChild(document.createTextNode(r))}}var YP=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;qP(YP);var jP=J2({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.style,s=a===void 0?{}:a,o=!!e&&m0(e)==="object"&&!!e.node&&typeof e.node=="function",l=mi(o?e.node():e);l.style("position")==="static"&&l.style("position","relative"),n.tooltipEl=l.append("div").attr("class","float-tooltip-kap"),Object.entries(s).forEach(function(u){var h=OP(u,2),g=h[0],v=h[1];return n.tooltipEl.style(g,v)}),n.tooltipEl.style("left","-10000px").style("display","none");var c="tooltip-".concat(Math.round(Math.random()*1e12));n.mouseInside=!1,l.on("mousemove.".concat(c),function(u){n.mouseInside=!0;var h=ji(u),g=l.node(),v=g.offsetWidth,m=g.offsetHeight,y=[n.offsetX===null||n.offsetX===void 0?"-".concat(h[0]/v*100,"%"):typeof n.offsetX=="number"?"calc(-50% + ".concat(n.offsetX,"px)"):n.offsetX,n.offsetY===null||n.offsetY===void 0?m>130&&m-h[1]<100?"calc(-100% - 6px)":"21px":typeof n.offsetY=="number"?n.offsetY<0?"calc(-100% - ".concat(Math.abs(n.offsetY),"px)"):"".concat(n.offsetY,"px"):n.offsetY];n.tooltipEl.style("left",h[0]+"px").style("top",h[1]+"px").style("transform","translate(".concat(y.join(","),")")),n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseover.".concat(c),function(){n.mouseInside=!0,n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseout.".concat(c),function(){n.mouseInside=!1,n.tooltipEl.style("display","none")})},update:function(e){e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append(function(){return e.content})):typeof e.content=="string"?e.tooltipEl.html(e.content):zP(e.content)?(e.tooltipEl.text(""),GP(e.content,e.tooltipEl.node())):(e.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",e.content,e.content.toString())):e.tooltipEl.text("")}});function HP(r,e,n){var i,a=1;r==null&&(r=0),e==null&&(e=0),n==null&&(n=0);function s(){var o,l=i.length,c,u=0,h=0,g=0;for(o=0;o<l;++o)c=i[o],u+=c.x||0,h+=c.y||0,g+=c.z||0;for(u=(u/l-r)*a,h=(h/l-e)*a,g=(g/l-n)*a,o=0;o<l;++o)c=i[o],u&&(c.x-=u),h&&(c.y-=h),g&&(c.z-=g)}return s.initialize=function(o){i=o},s.x=function(o){return arguments.length?(r=+o,s):r},s.y=function(o){return arguments.length?(e=+o,s):e},s.z=function(o){return arguments.length?(n=+o,s):n},s.strength=function(o){return arguments.length?(a=+o,s):a},s}function KP(r){const e=+this._x.call(null,r);return Y6(this.cover(e),e,r)}function Y6(r,e,n){if(isNaN(e))return r;var i,a=r._root,s={data:n},o=r._x0,l=r._x1,c,u,h,g,v;if(!a)return r._root=s,r;for(;a.length;)if((h=e>=(c=(o+l)/2))?o=c:l=c,i=a,!(a=a[g=+h]))return i[g]=s,r;if(u=+r._x.call(null,a.data),e===u)return s.next=a,i?i[g]=s:r._root=s,r;do i=i?i[g]=new Array(2):r._root=new Array(2),(h=e>=(c=(o+l)/2))?o=c:l=c;while((g=+h)==(v=+(u>=c)));return i[v]=a,i[g]=s,r}function XP(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,n=new Float64Array(e);let i=1/0,a=-1/0;for(let s=0,o;s<e;++s)isNaN(o=+this._x.call(null,r[s]))||(n[s]=o,o<i&&(i=o),o>a&&(a=o));if(i>a)return this;this.cover(i).cover(a);for(let s=0;s<e;++s)Y6(this,n[s],r[s]);return this}function QP(r){if(isNaN(r=+r))return this;var e=this._x0,n=this._x1;if(isNaN(e))n=(e=Math.floor(r))+1;else{for(var i=n-e||1,a=this._root,s,o;e>r||r>=n;)switch(o=+(r<e),s=new Array(2),s[o]=a,a=s,i*=2,o){case 0:n=e+i;break;case 1:e=n-i;break}this._root&&this._root.length&&(this._root=a)}return this._x0=e,this._x1=n,this}function ZP(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function WP(r){return arguments.length?this.cover(+r[0][0]).cover(+r[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function Da(r,e,n){this.node=r,this.x0=e,this.x1=n}function JP(r,e){var n,i=this._x0,a,s,o=this._x1,l=[],c=this._root,u,h;for(c&&l.push(new Da(c,i,o)),e==null?e=1/0:(i=r-e,o=r+e);u=l.pop();)if(!(!(c=u.node)||(a=u.x0)>o||(s=u.x1)<i))if(c.length){var g=(a+s)/2;l.push(new Da(c[1],g,s),new Da(c[0],a,g)),(h=+(r>=g))&&(u=l[l.length-1],l[l.length-1]=l[l.length-1-h],l[l.length-1-h]=u)}else{var v=Math.abs(r-+this._x.call(null,c.data));v<e&&(e=v,i=r-v,o=r+v,n=c.data)}return n}function $P(r){if(isNaN(c=+this._x.call(null,r)))return this;var e,n=this._root,i,a,s,o=this._x0,l=this._x1,c,u,h,g,v;if(!n)return this;if(n.length)for(;;){if((h=c>=(u=(o+l)/2))?o=u:l=u,e=n,!(n=n[g=+h]))return this;if(!n.length)break;e[g+1&1]&&(i=e,v=g)}for(;n.data!==r;)if(a=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,a?(s?a.next=s:delete a.next,this):e?(s?e[g]=s:delete e[g],(n=e[0]||e[1])&&n===(e[1]||e[0])&&!n.length&&(i?i[v]=n:this._root=n),this):(this._root=s,this)}function eL(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function tL(){return this._root}function rL(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function nL(r){var e=[],n,i=this._root,a,s,o;for(i&&e.push(new Da(i,this._x0,this._x1));n=e.pop();)if(!r(i=n.node,s=n.x0,o=n.x1)&&i.length){var l=(s+o)/2;(a=i[1])&&e.push(new Da(a,l,o)),(a=i[0])&&e.push(new Da(a,s,l))}return this}function iL(r){var e=[],n=[],i;for(this._root&&e.push(new Da(this._root,this._x0,this._x1));i=e.pop();){var a=i.node;if(a.length){var s,o=i.x0,l=i.x1,c=(o+l)/2;(s=a[0])&&e.push(new Da(s,o,c)),(s=a[1])&&e.push(new Da(s,c,l))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.x1);return this}function aL(r){return r[0]}function sL(r){return arguments.length?(this._x=r,this):this._x}function j6(r,e){var n=new ny(e??aL,NaN,NaN);return r==null?n:n.addAll(r)}function ny(r,e,n){this._x=r,this._x0=e,this._x1=n,this._root=void 0}function W4(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var Ln=j6.prototype=ny.prototype;Ln.copy=function(){var r=new ny(this._x,this._x0,this._x1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=W4(e),r;for(n=[{source:e,target:r._root=new Array(2)}];e=n.pop();)for(var a=0;a<2;++a)(i=e.source[a])&&(i.length?n.push({source:i,target:e.target[a]=new Array(2)}):e.target[a]=W4(i));return r};Ln.add=KP;Ln.addAll=XP;Ln.cover=QP;Ln.data=ZP;Ln.extent=WP;Ln.find=JP;Ln.remove=$P;Ln.removeAll=eL;Ln.root=tL;Ln.size=rL;Ln.visit=nL;Ln.visitAfter=iL;Ln.x=sL;function oL(r){const e=+this._x.call(null,r),n=+this._y.call(null,r);return H6(this.cover(e,n),e,n,r)}function H6(r,e,n,i){if(isNaN(e)||isNaN(n))return r;var a,s=r._root,o={data:i},l=r._x0,c=r._y0,u=r._x1,h=r._y1,g,v,m,y,b,x,A,C;if(!s)return r._root=o,r;for(;s.length;)if((b=e>=(g=(l+u)/2))?l=g:u=g,(x=n>=(v=(c+h)/2))?c=v:h=v,a=s,!(s=s[A=x<<1|b]))return a[A]=o,r;if(m=+r._x.call(null,s.data),y=+r._y.call(null,s.data),e===m&&n===y)return o.next=s,a?a[A]=o:r._root=o,r;do a=a?a[A]=new Array(4):r._root=new Array(4),(b=e>=(g=(l+u)/2))?l=g:u=g,(x=n>=(v=(c+h)/2))?c=v:h=v;while((A=x<<1|b)===(C=(y>=v)<<1|m>=g));return a[C]=s,a[A]=o,r}function lL(r){var e,n,i=r.length,a,s,o=new Array(i),l=new Array(i),c=1/0,u=1/0,h=-1/0,g=-1/0;for(n=0;n<i;++n)isNaN(a=+this._x.call(null,e=r[n]))||isNaN(s=+this._y.call(null,e))||(o[n]=a,l[n]=s,a<c&&(c=a),a>h&&(h=a),s<u&&(u=s),s>g&&(g=s));if(c>h||u>g)return this;for(this.cover(c,u).cover(h,g),n=0;n<i;++n)H6(this,o[n],l[n],r[n]);return this}function uL(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,a=this._x1,s=this._y1;if(isNaN(n))a=(n=Math.floor(r))+1,s=(i=Math.floor(e))+1;else{for(var o=a-n||1,l=this._root,c,u;n>r||r>=a||i>e||e>=s;)switch(u=(e<i)<<1|r<n,c=new Array(4),c[u]=l,l=c,o*=2,u){case 0:a=n+o,s=i+o;break;case 1:n=a-o,s=i+o;break;case 2:a=n+o,i=s-o;break;case 3:n=a-o,i=s-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=i,this._x1=a,this._y1=s,this}function cL(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function fL(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function bn(r,e,n,i,a){this.node=r,this.x0=e,this.y0=n,this.x1=i,this.y1=a}function hL(r,e,n){var i,a=this._x0,s=this._y0,o,l,c,u,h=this._x1,g=this._y1,v=[],m=this._root,y,b;for(m&&v.push(new bn(m,a,s,h,g)),n==null?n=1/0:(a=r-n,s=e-n,h=r+n,g=e+n,n*=n);y=v.pop();)if(!(!(m=y.node)||(o=y.x0)>h||(l=y.y0)>g||(c=y.x1)<a||(u=y.y1)<s))if(m.length){var x=(o+c)/2,A=(l+u)/2;v.push(new bn(m[3],x,A,c,u),new bn(m[2],o,A,x,u),new bn(m[1],x,l,c,A),new bn(m[0],o,l,x,A)),(b=(e>=A)<<1|r>=x)&&(y=v[v.length-1],v[v.length-1]=v[v.length-1-b],v[v.length-1-b]=y)}else{var C=r-+this._x.call(null,m.data),E=e-+this._y.call(null,m.data),S=C*C+E*E;if(S<n){var M=Math.sqrt(n=S);a=r-M,s=e-M,h=r+M,g=e+M,i=m.data}}return i}function dL(r){if(isNaN(h=+this._x.call(null,r))||isNaN(g=+this._y.call(null,r)))return this;var e,n=this._root,i,a,s,o=this._x0,l=this._y0,c=this._x1,u=this._y1,h,g,v,m,y,b,x,A;if(!n)return this;if(n.length)for(;;){if((y=h>=(v=(o+c)/2))?o=v:c=v,(b=g>=(m=(l+u)/2))?l=m:u=m,e=n,!(n=n[x=b<<1|y]))return this;if(!n.length)break;(e[x+1&3]||e[x+2&3]||e[x+3&3])&&(i=e,A=x)}for(;n.data!==r;)if(a=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,a?(s?a.next=s:delete a.next,this):e?(s?e[x]=s:delete e[x],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[A]=n:this._root=n),this):(this._root=s,this)}function gL(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function vL(){return this._root}function mL(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function pL(r){var e=[],n,i=this._root,a,s,o,l,c;for(i&&e.push(new bn(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!r(i=n.node,s=n.x0,o=n.y0,l=n.x1,c=n.y1)&&i.length){var u=(s+l)/2,h=(o+c)/2;(a=i[3])&&e.push(new bn(a,u,h,l,c)),(a=i[2])&&e.push(new bn(a,s,h,u,c)),(a=i[1])&&e.push(new bn(a,u,o,l,h)),(a=i[0])&&e.push(new bn(a,s,o,u,h))}return this}function yL(r){var e=[],n=[],i;for(this._root&&e.push(new bn(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var a=i.node;if(a.length){var s,o=i.x0,l=i.y0,c=i.x1,u=i.y1,h=(o+c)/2,g=(l+u)/2;(s=a[0])&&e.push(new bn(s,o,l,h,g)),(s=a[1])&&e.push(new bn(s,h,l,c,g)),(s=a[2])&&e.push(new bn(s,o,g,h,u)),(s=a[3])&&e.push(new bn(s,h,g,c,u))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.y0,i.x1,i.y1);return this}function AL(r){return r[0]}function xL(r){return arguments.length?(this._x=r,this):this._x}function bL(r){return r[1]}function wL(r){return arguments.length?(this._y=r,this):this._y}function K6(r,e,n){var i=new iy(e??AL,n??bL,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function iy(r,e,n,i,a,s){this._x=r,this._y=e,this._x0=n,this._y0=i,this._x1=a,this._y1=s,this._root=void 0}function J4(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var En=K6.prototype=iy.prototype;En.copy=function(){var r=new iy(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=J4(e),r;for(n=[{source:e,target:r._root=new Array(4)}];e=n.pop();)for(var a=0;a<4;++a)(i=e.source[a])&&(i.length?n.push({source:i,target:e.target[a]=new Array(4)}):e.target[a]=J4(i));return r};En.add=oL;En.addAll=lL;En.cover=uL;En.data=cL;En.extent=fL;En.find=hL;En.remove=dL;En.removeAll=gL;En.root=vL;En.size=mL;En.visit=pL;En.visitAfter=yL;En.x=xL;En.y=wL;function CL(r){const e=+this._x.call(null,r),n=+this._y.call(null,r),i=+this._z.call(null,r);return X6(this.cover(e,n,i),e,n,i,r)}function X6(r,e,n,i,a){if(isNaN(e)||isNaN(n)||isNaN(i))return r;var s,o=r._root,l={data:a},c=r._x0,u=r._y0,h=r._z0,g=r._x1,v=r._y1,m=r._z1,y,b,x,A,C,E,S,M,R,T,B;if(!o)return r._root=l,r;for(;o.length;)if((S=e>=(y=(c+g)/2))?c=y:g=y,(M=n>=(b=(u+v)/2))?u=b:v=b,(R=i>=(x=(h+m)/2))?h=x:m=x,s=o,!(o=o[T=R<<2|M<<1|S]))return s[T]=l,r;if(A=+r._x.call(null,o.data),C=+r._y.call(null,o.data),E=+r._z.call(null,o.data),e===A&&n===C&&i===E)return l.next=o,s?s[T]=l:r._root=l,r;do s=s?s[T]=new Array(8):r._root=new Array(8),(S=e>=(y=(c+g)/2))?c=y:g=y,(M=n>=(b=(u+v)/2))?u=b:v=b,(R=i>=(x=(h+m)/2))?h=x:m=x;while((T=R<<2|M<<1|S)===(B=(E>=x)<<2|(C>=b)<<1|A>=y));return s[B]=o,s[T]=l,r}function EL(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,n=new Float64Array(e),i=new Float64Array(e),a=new Float64Array(e);let s=1/0,o=1/0,l=1/0,c=-1/0,u=-1/0,h=-1/0;for(let g=0,v,m,y,b;g<e;++g)isNaN(m=+this._x.call(null,v=r[g]))||isNaN(y=+this._y.call(null,v))||isNaN(b=+this._z.call(null,v))||(n[g]=m,i[g]=y,a[g]=b,m<s&&(s=m),m>c&&(c=m),y<o&&(o=y),y>u&&(u=y),b<l&&(l=b),b>h&&(h=b));if(s>c||o>u||l>h)return this;this.cover(s,o,l).cover(c,u,h);for(let g=0;g<e;++g)X6(this,n[g],i[g],a[g],r[g]);return this}function SL(r,e,n){if(isNaN(r=+r)||isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,a=this._y0,s=this._z0,o=this._x1,l=this._y1,c=this._z1;if(isNaN(i))o=(i=Math.floor(r))+1,l=(a=Math.floor(e))+1,c=(s=Math.floor(n))+1;else{for(var u=o-i||1,h=this._root,g,v;i>r||r>=o||a>e||e>=l||s>n||n>=c;)switch(v=(n<s)<<2|(e<a)<<1|r<i,g=new Array(8),g[v]=h,h=g,u*=2,v){case 0:o=i+u,l=a+u,c=s+u;break;case 1:i=o-u,l=a+u,c=s+u;break;case 2:o=i+u,a=l-u,c=s+u;break;case 3:i=o-u,a=l-u,c=s+u;break;case 4:o=i+u,l=a+u,s=c-u;break;case 5:i=o-u,l=a+u,s=c-u;break;case 6:o=i+u,a=l-u,s=c-u;break;case 7:i=o-u,a=l-u,s=c-u;break}this._root&&this._root.length&&(this._root=h)}return this._x0=i,this._y0=a,this._z0=s,this._x1=o,this._y1=l,this._z1=c,this}function TL(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function ML(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Xt(r,e,n,i,a,s,o){this.node=r,this.x0=e,this.y0=n,this.z0=i,this.x1=a,this.y1=s,this.z1=o}function DL(r,e,n,i){var a,s=this._x0,o=this._y0,l=this._z0,c,u,h,g,v,m,y=this._x1,b=this._y1,x=this._z1,A=[],C=this._root,E,S;for(C&&A.push(new Xt(C,s,o,l,y,b,x)),i==null?i=1/0:(s=r-i,o=e-i,l=n-i,y=r+i,b=e+i,x=n+i,i*=i);E=A.pop();)if(!(!(C=E.node)||(c=E.x0)>y||(u=E.y0)>b||(h=E.z0)>x||(g=E.x1)<s||(v=E.y1)<o||(m=E.z1)<l))if(C.length){var M=(c+g)/2,R=(u+v)/2,T=(h+m)/2;A.push(new Xt(C[7],M,R,T,g,v,m),new Xt(C[6],c,R,T,M,v,m),new Xt(C[5],M,u,T,g,R,m),new Xt(C[4],c,u,T,M,R,m),new Xt(C[3],M,R,h,g,v,T),new Xt(C[2],c,R,h,M,v,T),new Xt(C[1],M,u,h,g,R,T),new Xt(C[0],c,u,h,M,R,T)),(S=(n>=T)<<2|(e>=R)<<1|r>=M)&&(E=A[A.length-1],A[A.length-1]=A[A.length-1-S],A[A.length-1-S]=E)}else{var B=r-+this._x.call(null,C.data),F=e-+this._y.call(null,C.data),I=n-+this._z.call(null,C.data),U=B*B+F*F+I*I;if(U<i){var k=Math.sqrt(i=U);s=r-k,o=e-k,l=n-k,y=r+k,b=e+k,x=n+k,a=C.data}}return a}const RL=(r,e,n,i,a,s)=>Math.sqrt((r-i)**2+(e-a)**2+(n-s)**2);function BL(r,e,n,i){const a=[],s=r-i,o=e-i,l=n-i,c=r+i,u=e+i,h=n+i;return this.visit((g,v,m,y,b,x,A)=>{if(!g.length)do{const C=g.data;RL(r,e,n,this._x(C),this._y(C),this._z(C))<=i&&a.push(C)}while(g=g.next);return v>c||m>u||y>h||b<s||x<o||A<l}),a}function IL(r){if(isNaN(v=+this._x.call(null,r))||isNaN(m=+this._y.call(null,r))||isNaN(y=+this._z.call(null,r)))return this;var e,n=this._root,i,a,s,o=this._x0,l=this._y0,c=this._z0,u=this._x1,h=this._y1,g=this._z1,v,m,y,b,x,A,C,E,S,M,R;if(!n)return this;if(n.length)for(;;){if((C=v>=(b=(o+u)/2))?o=b:u=b,(E=m>=(x=(l+h)/2))?l=x:h=x,(S=y>=(A=(c+g)/2))?c=A:g=A,e=n,!(n=n[M=S<<2|E<<1|C]))return this;if(!n.length)break;(e[M+1&7]||e[M+2&7]||e[M+3&7]||e[M+4&7]||e[M+5&7]||e[M+6&7]||e[M+7&7])&&(i=e,R=M)}for(;n.data!==r;)if(a=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,a?(s?a.next=s:delete a.next,this):e?(s?e[M]=s:delete e[M],(n=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&n===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[R]=n:this._root=n),this):(this._root=s,this)}function NL(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function FL(){return this._root}function kL(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function UL(r){var e=[],n,i=this._root,a,s,o,l,c,u,h;for(i&&e.push(new Xt(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();)if(!r(i=n.node,s=n.x0,o=n.y0,l=n.z0,c=n.x1,u=n.y1,h=n.z1)&&i.length){var g=(s+c)/2,v=(o+u)/2,m=(l+h)/2;(a=i[7])&&e.push(new Xt(a,g,v,m,c,u,h)),(a=i[6])&&e.push(new Xt(a,s,v,m,g,u,h)),(a=i[5])&&e.push(new Xt(a,g,o,m,c,v,h)),(a=i[4])&&e.push(new Xt(a,s,o,m,g,v,h)),(a=i[3])&&e.push(new Xt(a,g,v,l,c,u,m)),(a=i[2])&&e.push(new Xt(a,s,v,l,g,u,m)),(a=i[1])&&e.push(new Xt(a,g,o,l,c,v,m)),(a=i[0])&&e.push(new Xt(a,s,o,l,g,v,m))}return this}function VL(r){var e=[],n=[],i;for(this._root&&e.push(new Xt(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();){var a=i.node;if(a.length){var s,o=i.x0,l=i.y0,c=i.z0,u=i.x1,h=i.y1,g=i.z1,v=(o+u)/2,m=(l+h)/2,y=(c+g)/2;(s=a[0])&&e.push(new Xt(s,o,l,c,v,m,y)),(s=a[1])&&e.push(new Xt(s,v,l,c,u,m,y)),(s=a[2])&&e.push(new Xt(s,o,m,c,v,h,y)),(s=a[3])&&e.push(new Xt(s,v,m,c,u,h,y)),(s=a[4])&&e.push(new Xt(s,o,l,y,v,m,g)),(s=a[5])&&e.push(new Xt(s,v,l,y,u,m,g)),(s=a[6])&&e.push(new Xt(s,o,m,y,v,h,g)),(s=a[7])&&e.push(new Xt(s,v,m,y,u,h,g))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function OL(r){return r[0]}function PL(r){return arguments.length?(this._x=r,this):this._x}function LL(r){return r[1]}function _L(r){return arguments.length?(this._y=r,this):this._y}function zL(r){return r[2]}function GL(r){return arguments.length?(this._z=r,this):this._z}function Q6(r,e,n,i){var a=new ay(e??OL,n??LL,i??zL,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?a:a.addAll(r)}function ay(r,e,n,i,a,s,o,l,c){this._x=r,this._y=e,this._z=n,this._x0=i,this._y0=a,this._z0=s,this._x1=o,this._y1=l,this._z1=c,this._root=void 0}function $4(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var un=Q6.prototype=ay.prototype;un.copy=function(){var r=new ay(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=$4(e),r;for(n=[{source:e,target:r._root=new Array(8)}];e=n.pop();)for(var a=0;a<8;++a)(i=e.source[a])&&(i.length?n.push({source:i,target:e.target[a]=new Array(8)}):e.target[a]=$4(i));return r};un.add=CL;un.addAll=EL;un.cover=SL;un.data=TL;un.extent=ML;un.find=DL;un.findAllWithinRadius=BL;un.remove=IL;un.removeAll=NL;un.root=FL;un.size=kL;un.visit=UL;un.visitAfter=VL;un.x=PL;un.y=_L;un.z=GL;function Ma(r){return function(){return r}}function Ea(r){return(r()-.5)*1e-6}function qL(r){return r.index}function eC(r,e){var n=r.get(e);if(!n)throw new Error("node not found: "+e);return n}function YL(r){var e=qL,n=v,i,a=Ma(30),s,o,l,c,u,h,g=1;r==null&&(r=[]);function v(A){return 1/Math.min(c[A.source.index],c[A.target.index])}function m(A){for(var C=0,E=r.length;C<g;++C)for(var S=0,M,R,T,B=0,F=0,I=0,U,k;S<E;++S)M=r[S],R=M.source,T=M.target,B=T.x+T.vx-R.x-R.vx||Ea(h),l>1&&(F=T.y+T.vy-R.y-R.vy||Ea(h)),l>2&&(I=T.z+T.vz-R.z-R.vz||Ea(h)),U=Math.sqrt(B*B+F*F+I*I),U=(U-s[S])/U*A*i[S],B*=U,F*=U,I*=U,T.vx-=B*(k=u[S]),l>1&&(T.vy-=F*k),l>2&&(T.vz-=I*k),R.vx+=B*(k=1-k),l>1&&(R.vy+=F*k),l>2&&(R.vz+=I*k)}function y(){if(o){var A,C=o.length,E=r.length,S=new Map(o.map((R,T)=>[e(R,T,o),R])),M;for(A=0,c=new Array(C);A<E;++A)M=r[A],M.index=A,typeof M.source!="object"&&(M.source=eC(S,M.source)),typeof M.target!="object"&&(M.target=eC(S,M.target)),c[M.source.index]=(c[M.source.index]||0)+1,c[M.target.index]=(c[M.target.index]||0)+1;for(A=0,u=new Array(E);A<E;++A)M=r[A],u[A]=c[M.source.index]/(c[M.source.index]+c[M.target.index]);i=new Array(E),b(),s=new Array(E),x()}}function b(){if(o)for(var A=0,C=r.length;A<C;++A)i[A]=+n(r[A],A,r)}function x(){if(o)for(var A=0,C=r.length;A<C;++A)s[A]=+a(r[A],A,r)}return m.initialize=function(A,...C){o=A,h=C.find(E=>typeof E=="function")||Math.random,l=C.find(E=>[1,2,3].includes(E))||2,y()},m.links=function(A){return arguments.length?(r=A,y(),m):r},m.id=function(A){return arguments.length?(e=A,m):e},m.iterations=function(A){return arguments.length?(g=+A,m):g},m.strength=function(A){return arguments.length?(n=typeof A=="function"?A:Ma(+A),b(),m):n},m.distance=function(A){return arguments.length?(a=typeof A=="function"?A:Ma(+A),x(),m):a},m}const jL=1664525,HL=1013904223,tC=4294967296;function KL(){let r=1;return()=>(r=(jL*r+HL)%tC)/tC}var rC=3;function Z1(r){return r.x}function nC(r){return r.y}function XL(r){return r.z}var QL=10,ZL=Math.PI*(3-Math.sqrt(5)),WL=Math.PI*20/(9+Math.sqrt(221));function JL(r,e){e=e||2;var n=Math.min(rC,Math.max(1,Math.round(e))),i,a=1,s=.001,o=1-Math.pow(s,1/300),l=0,c=.6,u=new Map,h=X2(m),g=vf("tick","end"),v=KL();r==null&&(r=[]);function m(){y(),g.call("tick",i),a<s&&(h.stop(),g.call("end",i))}function y(A){var C,E=r.length,S;A===void 0&&(A=1);for(var M=0;M<A;++M)for(a+=(l-a)*o,u.forEach(function(R){R(a)}),C=0;C<E;++C)S=r[C],S.fx==null?S.x+=S.vx*=c:(S.x=S.fx,S.vx=0),n>1&&(S.fy==null?S.y+=S.vy*=c:(S.y=S.fy,S.vy=0)),n>2&&(S.fz==null?S.z+=S.vz*=c:(S.z=S.fz,S.vz=0));return i}function b(){for(var A=0,C=r.length,E;A<C;++A){if(E=r[A],E.index=A,E.fx!=null&&(E.x=E.fx),E.fy!=null&&(E.y=E.fy),E.fz!=null&&(E.z=E.fz),isNaN(E.x)||n>1&&isNaN(E.y)||n>2&&isNaN(E.z)){var S=QL*(n>2?Math.cbrt(.5+A):n>1?Math.sqrt(.5+A):A),M=A*ZL,R=A*WL;n===1?E.x=S:n===2?(E.x=S*Math.cos(M),E.y=S*Math.sin(M)):(E.x=S*Math.sin(M)*Math.cos(R),E.y=S*Math.cos(M),E.z=S*Math.sin(M)*Math.sin(R))}(isNaN(E.vx)||n>1&&isNaN(E.vy)||n>2&&isNaN(E.vz))&&(E.vx=0,n>1&&(E.vy=0),n>2&&(E.vz=0))}}function x(A){return A.initialize&&A.initialize(r,v,n),A}return b(),i={tick:y,restart:function(){return h.restart(m),i},stop:function(){return h.stop(),i},numDimensions:function(A){return arguments.length?(n=Math.min(rC,Math.max(1,Math.round(A))),u.forEach(x),i):n},nodes:function(A){return arguments.length?(r=A,b(),u.forEach(x),i):r},alpha:function(A){return arguments.length?(a=+A,i):a},alphaMin:function(A){return arguments.length?(s=+A,i):s},alphaDecay:function(A){return arguments.length?(o=+A,i):+o},alphaTarget:function(A){return arguments.length?(l=+A,i):l},velocityDecay:function(A){return arguments.length?(c=1-A,i):1-c},randomSource:function(A){return arguments.length?(v=A,u.forEach(x),i):v},force:function(A,C){return arguments.length>1?(C==null?u.delete(A):u.set(A,x(C)),i):u.get(A)},find:function(){var A=Array.prototype.slice.call(arguments),C=A.shift()||0,E=(n>1?A.shift():null)||0,S=(n>2?A.shift():null)||0,M=A.shift()||1/0,R=0,T=r.length,B,F,I,U,k,O;for(M*=M,R=0;R<T;++R)k=r[R],B=C-k.x,F=E-(k.y||0),I=S-(k.z||0),U=B*B+F*F+I*I,U<M&&(O=k,M=U);return O},on:function(A,C){return arguments.length>1?(g.on(A,C),i):g.on(A)}}}function $L(){var r,e,n,i,a,s=Ma(-30),o,l=1,c=1/0,u=.81;function h(y){var b,x=r.length,A=(e===1?j6(r,Z1):e===2?K6(r,Z1,nC):e===3?Q6(r,Z1,nC,XL):null).visitAfter(v);for(a=y,b=0;b<x;++b)n=r[b],A.visit(m)}function g(){if(r){var y,b=r.length,x;for(o=new Array(b),y=0;y<b;++y)x=r[y],o[x.index]=+s(x,y,r)}}function v(y){var b=0,x,A,C=0,E,S,M,R,T=y.length;if(T){for(E=S=M=R=0;R<T;++R)(x=y[R])&&(A=Math.abs(x.value))&&(b+=x.value,C+=A,E+=A*(x.x||0),S+=A*(x.y||0),M+=A*(x.z||0));b*=Math.sqrt(4/T),y.x=E/C,e>1&&(y.y=S/C),e>2&&(y.z=M/C)}else{x=y,x.x=x.data.x,e>1&&(x.y=x.data.y),e>2&&(x.z=x.data.z);do b+=o[x.data.index];while(x=x.next)}y.value=b}function m(y,b,x,A,C){if(!y.value)return!0;var E=[x,A,C][e-1],S=y.x-n.x,M=e>1?y.y-n.y:0,R=e>2?y.z-n.z:0,T=E-b,B=S*S+M*M+R*R;if(T*T/u<B)return B<c&&(S===0&&(S=Ea(i),B+=S*S),e>1&&M===0&&(M=Ea(i),B+=M*M),e>2&&R===0&&(R=Ea(i),B+=R*R),B<l&&(B=Math.sqrt(l*B)),n.vx+=S*y.value*a/B,e>1&&(n.vy+=M*y.value*a/B),e>2&&(n.vz+=R*y.value*a/B)),!0;if(y.length||B>=c)return;(y.data!==n||y.next)&&(S===0&&(S=Ea(i),B+=S*S),e>1&&M===0&&(M=Ea(i),B+=M*M),e>2&&R===0&&(R=Ea(i),B+=R*R),B<l&&(B=Math.sqrt(l*B)));do y.data!==n&&(T=o[y.data.index]*a/B,n.vx+=S*T,e>1&&(n.vy+=M*T),e>2&&(n.vz+=R*T));while(y=y.next)}return h.initialize=function(y,...b){r=y,i=b.find(x=>typeof x=="function")||Math.random,e=b.find(x=>[1,2,3].includes(x))||2,g()},h.strength=function(y){return arguments.length?(s=typeof y=="function"?y:Ma(+y),g(),h):s},h.distanceMin=function(y){return arguments.length?(l=y*y,h):Math.sqrt(l)},h.distanceMax=function(y){return arguments.length?(c=y*y,h):Math.sqrt(c)},h.theta=function(y){return arguments.length?(u=y*y,h):Math.sqrt(u)},h}function e_(r,e,n,i){var a,s,o=Ma(.1),l,c;typeof r!="function"&&(r=Ma(+r)),e==null&&(e=0),n==null&&(n=0),i==null&&(i=0);function u(g){for(var v=0,m=a.length;v<m;++v){var y=a[v],b=y.x-e||1e-6,x=(y.y||0)-n||1e-6,A=(y.z||0)-i||1e-6,C=Math.sqrt(b*b+x*x+A*A),E=(c[v]-C)*l[v]*g/C;y.vx+=b*E,s>1&&(y.vy+=x*E),s>2&&(y.vz+=A*E)}}function h(){if(a){var g,v=a.length;for(l=new Array(v),c=new Array(v),g=0;g<v;++g)c[g]=+r(a[g],g,a),l[g]=isNaN(c[g])?0:+o(a[g],g,a)}}return u.initialize=function(g,...v){a=g,s=v.find(m=>[1,2,3].includes(m))||2,h()},u.strength=function(g){return arguments.length?(o=typeof g=="function"?g:Ma(+g),h(),u):o},u.radius=function(g){return arguments.length?(r=typeof g=="function"?g:Ma(+g),h(),u):r},u.x=function(g){return arguments.length?(e=+g,u):e},u.y=function(g){return arguments.length?(n=+g,u):n},u.z=function(g){return arguments.length?(i=+g,u):i},u}const{abs:nc,cos:wa,sin:Cl,acos:t_,atan2:ic,sqrt:cs,pow:gi}=Math;function ac(r){return r<0?-gi(-r,1/3):gi(r,1/3)}const Z6=Math.PI,ud=2*Z6,fs=Z6/2,r_=1e-6,W1=Number.MAX_SAFE_INTEGER||9007199254740991,J1=Number.MIN_SAFE_INTEGER||-9007199254740991,n_={x:0,y:0,z:0},Re={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,e){const n=e(r);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),cs(i)},compute:function(r,e,n){if(r===0)return e[0].t=0,e[0];const i=e.length-1;if(r===1)return e[i].t=1,e[i];const a=1-r;let s=e;if(i===0)return e[0].t=r,e[0];if(i===1){const l={x:a*s[0].x+r*s[1].x,y:a*s[0].y+r*s[1].y,t:r};return n&&(l.z=a*s[0].z+r*s[1].z),l}if(i<4){let l=a*a,c=r*r,u,h,g,v=0;i===2?(s=[s[0],s[1],s[2],n_],u=l,h=a*r*2,g=c):i===3&&(u=l*a,h=l*r*3,g=a*c*3,v=r*c);const m={x:u*s[0].x+h*s[1].x+g*s[2].x+v*s[3].x,y:u*s[0].y+h*s[1].y+g*s[2].y+v*s[3].y,t:r};return n&&(m.z=u*s[0].z+h*s[1].z+g*s[2].z+v*s[3].z),m}const o=JSON.parse(JSON.stringify(e));for(;o.length>1;){for(let l=0;l<o.length-1;l++)o[l]={x:o[l].x+(o[l+1].x-o[l].x)*r,y:o[l].y+(o[l+1].y-o[l].y)*r},typeof o[l].z<"u"&&(o[l].z=o[l].z+(o[l+1].z-o[l].z)*r);o.splice(o.length-1,1)}return o[0].t=r,o[0]},computeWithRatios:function(r,e,n,i){const a=1-r,s=n,o=e;let l=s[0],c=s[1],u=s[2],h=s[3],g;if(l*=a,c*=r,o.length===2)return g=l+c,{x:(l*o[0].x+c*o[1].x)/g,y:(l*o[0].y+c*o[1].y)/g,z:i?(l*o[0].z+c*o[1].z)/g:!1,t:r};if(l*=a,c*=2*a,u*=r*r,o.length===3)return g=l+c+u,{x:(l*o[0].x+c*o[1].x+u*o[2].x)/g,y:(l*o[0].y+c*o[1].y+u*o[2].y)/g,z:i?(l*o[0].z+c*o[1].z+u*o[2].z)/g:!1,t:r};if(l*=a,c*=1.5*a,u*=3*a,h*=r*r*r,o.length===4)return g=l+c+u+h,{x:(l*o[0].x+c*o[1].x+u*o[2].x+h*o[3].x)/g,y:(l*o[0].y+c*o[1].y+u*o[2].y+h*o[3].y)/g,z:i?(l*o[0].z+c*o[1].z+u*o[2].z+h*o[3].z)/g:!1,t:r}},derive:function(r,e){const n=[];for(let i=r,a=i.length,s=a-1;a>1;a--,s--){const o=[];for(let l=0,c;l<s;l++)c={x:s*(i[l+1].x-i[l].x),y:s*(i[l+1].y-i[l].y)},e&&(c.z=s*(i[l+1].z-i[l].z)),o.push(c);n.push(o),i=o}return n},between:function(r,e,n){return e<=r&&r<=n||Re.approximately(r,e)||Re.approximately(r,n)},approximately:function(r,e,n){return nc(r-e)<=(n||r_)},length:function(r){const n=Re.Tvalues.length;let i=0;for(let a=0,s;a<n;a++)s=.5*Re.Tvalues[a]+.5,i+=Re.Cvalues[a]*Re.arcfn(s,r);return .5*i},map:function(r,e,n,i,a){const s=n-e,o=a-i,l=r-e,c=l/s;return i+o*c},lerp:function(r,e,n){const i={x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(i.z=e.z+r*(n.z-e.z)),i},pointToString:function(r){let e=r.x+"/"+r.y;return typeof r.z<"u"&&(e+="/"+r.z),e},pointsToString:function(r){return"["+r.map(Re.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,e,n){const i=e.x-r.x,a=e.y-r.y,s=n.x-r.x,o=n.y-r.y,l=i*o-a*s,c=i*s+a*o;return ic(l,c)},round:function(r,e){const n=""+r,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(r,e){const n=r.x-e.x,i=r.y-e.y;return cs(n*n+i*i)},closest:function(r,e){let n=gi(2,63),i,a;return r.forEach(function(s,o){a=Re.dist(e,s),a<n&&(n=a,i=o)}),{mdist:n,mpos:i}},abcratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=gi(r,e)+gi(1-r,e),i=n-1;return nc(i/n)},projectionratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=gi(1-r,e),i=gi(r,e)+n;return n/i},lli8:function(r,e,n,i,a,s,o,l){const c=(r*i-e*n)*(a-o)-(r-n)*(a*l-s*o),u=(r*i-e*n)*(s-l)-(e-i)*(a*l-s*o),h=(r-n)*(s-l)-(e-i)*(a-o);return h==0?!1:{x:c/h,y:u/h}},lli4:function(r,e,n,i){const a=r.x,s=r.y,o=e.x,l=e.y,c=n.x,u=n.y,h=i.x,g=i.y;return Re.lli8(a,s,o,l,c,u,h,g)},lli:function(r,e){return Re.lli4(r,r.c,e,e.c)},makeline:function(r,e){return new rr(r.x,r.y,(r.x+e.x)/2,(r.y+e.y)/2,e.x,e.y)},findbbox:function(r){let e=W1,n=W1,i=J1,a=J1;return r.forEach(function(s){const o=s.bbox();e>o.x.min&&(e=o.x.min),n>o.y.min&&(n=o.y.min),i<o.x.max&&(i=o.x.max),a<o.y.max&&(a=o.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+a)/2,max:a,size:a-n}}},shapeintersections:function(r,e,n,i,a){if(!Re.bboxoverlap(e,i))return[];const s=[],o=[r.startcap,r.forward,r.back,r.endcap],l=[n.startcap,n.forward,n.back,n.endcap];return o.forEach(function(c){c.virtual||l.forEach(function(u){if(u.virtual)return;const h=c.intersects(u,a);h.length>0&&(h.c1=c,h.c2=u,h.s1=r,h.s2=n,s.push(h))})}),s},makeshape:function(r,e,n){const i=e.points.length,a=r.points.length,s=Re.makeline(e.points[i-1],r.points[0]),o=Re.makeline(r.points[a-1],e.points[0]),l={startcap:s,forward:r,back:e,endcap:o,bbox:Re.findbbox([s,r,e,o])};return l.intersections=function(c){return Re.shapeintersections(l,l.bbox,c,c.bbox,n)},l},getminmax:function(r,e,n){if(!n)return{min:0,max:0};let i=W1,a=J1,s,o;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let l=0,c=n.length;l<c;l++)s=n[l],o=r.get(s),o[e]<i&&(i=o[e]),o[e]>a&&(a=o[e]);return{min:i,mid:(i+a)/2,max:a,size:a-i}},align:function(r,e){const n=e.p1.x,i=e.p1.y,a=-ic(e.p2.y-i,e.p2.x-n),s=function(o){return{x:(o.x-n)*wa(a)-(o.y-i)*Cl(a),y:(o.x-n)*Cl(a)+(o.y-i)*wa(a)}};return r.map(s)},roots:function(r,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=r.length-1,i=Re.align(r,e),a=function(T){return 0<=T&&T<=1};if(n===2){const T=i[0].y,B=i[1].y,F=i[2].y,I=T-2*B+F;if(I!==0){const U=-cs(B*B-T*F),k=-T+B,O=-(U+k)/I,V=-(-U+k)/I;return[O,V].filter(a)}else if(B!==F&&I===0)return[(2*B-F)/(2*B-2*F)].filter(a);return[]}const s=i[0].y,o=i[1].y,l=i[2].y,c=i[3].y;let u=-s+3*o-3*l+c,h=3*s-6*o+3*l,g=-3*s+3*o,v=s;if(Re.approximately(u,0)){if(Re.approximately(h,0))return Re.approximately(g,0)?[]:[-v/g].filter(a);const T=cs(g*g-4*h*v),B=2*h;return[(T-g)/B,(-g-T)/B].filter(a)}h/=u,g/=u,v/=u;const m=(3*g-h*h)/3,y=m/3,b=(2*h*h*h-9*h*g+27*v)/27,x=b/2,A=x*x+y*y*y;let C,E,S,M,R;if(A<0){const T=-m/3,B=T*T*T,F=cs(B),I=-b/(2*F),U=I<-1?-1:I>1?1:I,k=t_(U),O=ac(F),V=2*O;return S=V*wa(k/3)-h/3,M=V*wa((k+ud)/3)-h/3,R=V*wa((k+2*ud)/3)-h/3,[S,M,R].filter(a)}else{if(A===0)return C=x<0?ac(-x):-ac(x),S=2*C-h/3,M=-C-h/3,[S,M].filter(a);{const T=cs(A);return C=ac(-x+T),E=ac(x+T),[C-E-h/3].filter(a)}}},droots:function(r){if(r.length===3){const e=r[0],n=r[1],i=r[2],a=e-2*n+i;if(a!==0){const s=-cs(n*n-e*i),o=-e+n,l=-(s+o)/a,c=-(-s+o)/a;return[l,c]}else if(n!==i&&a===0)return[(2*n-i)/(2*(n-i))];return[]}if(r.length===2){const e=r[0],n=r[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(r,e,n,i,a){let s,o,l,c,u=0,h=0;const g=Re.compute(r,e),v=Re.compute(r,n),m=g.x*g.x+g.y*g.y;if(i?(s=cs(gi(g.y*v.z-v.y*g.z,2)+gi(g.z*v.x-v.z*g.x,2)+gi(g.x*v.y-v.x*g.y,2)),o=gi(m+g.z*g.z,3/2)):(s=g.x*v.y-g.y*v.x,o=gi(m,3/2)),s===0||o===0)return{k:0,r:0};if(u=s/o,h=o/s,!a){const y=Re.curvature(r-.001,e,n,i,!0).k,b=Re.curvature(r+.001,e,n,i,!0).k;c=(b-u+(u-y))/2,l=(nc(b-u)+nc(u-y))/2}return{k:u,r:h,dk:c,adk:l}},inflections:function(r){if(r.length<4)return[];const e=Re.align(r,{p1:r[0],p2:r.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,a=e[1].x*e[2].y,s=e[3].x*e[2].y,o=18*(-3*n+2*i+3*a-s),l=18*(3*n-i-3*a),c=18*(a-n);if(Re.approximately(o,0)){if(!Re.approximately(l,0)){let v=-c/l;if(0<=v&&v<=1)return[v]}return[]}const u=2*o;if(Re.approximately(u,0))return[];const h=l*l-4*o*c;if(h<0)return[];const g=Math.sqrt(h);return[(g-l)/u,-(l+g)/u].filter(function(v){return 0<=v&&v<=1})},bboxoverlap:function(r,e){const n=["x","y"],i=n.length;for(let a=0,s,o,l,c;a<i;a++)if(s=n[a],o=r[s].mid,l=e[s].mid,c=(r[s].size+e[s].size)/2,nc(o-l)>=c)return!1;return!0},expandbox:function(r,e){e.x.min<r.x.min&&(r.x.min=e.x.min),e.y.min<r.y.min&&(r.y.min=e.y.min),e.z&&e.z.min<r.z.min&&(r.z.min=e.z.min),e.x.max>r.x.max&&(r.x.max=e.x.max),e.y.max>r.y.max&&(r.y.max=e.y.max),e.z&&e.z.max>r.z.max&&(r.z.max=e.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,e,n){const i=r.bbox(),a=e.bbox(),s=1e5,o=n||.5;if(i.x.size+i.y.size<o&&a.x.size+a.y.size<o)return[(s*(r._t1+r._t2)/2|0)/s+"/"+(s*(e._t1+e._t2)/2|0)/s];let l=r.split(.5),c=e.split(.5),u=[{left:l.left,right:c.left},{left:l.left,right:c.right},{left:l.right,right:c.right},{left:l.right,right:c.left}];u=u.filter(function(g){return Re.bboxoverlap(g.left.bbox(),g.right.bbox())});let h=[];return u.length===0||(u.forEach(function(g){h=h.concat(Re.pairiteration(g.left,g.right,o))}),h=h.filter(function(g,v){return h.indexOf(g)===v})),h},getccenter:function(r,e,n){const i=e.x-r.x,a=e.y-r.y,s=n.x-e.x,o=n.y-e.y,l=i*wa(fs)-a*Cl(fs),c=i*Cl(fs)+a*wa(fs),u=s*wa(fs)-o*Cl(fs),h=s*Cl(fs)+o*wa(fs),g=(r.x+e.x)/2,v=(r.y+e.y)/2,m=(e.x+n.x)/2,y=(e.y+n.y)/2,b=g+l,x=v+c,A=m+u,C=y+h,E=Re.lli8(g,v,b,x,m,y,A,C),S=Re.dist(E,r);let M=ic(r.y-E.y,r.x-E.x),R=ic(e.y-E.y,e.x-E.x),T=ic(n.y-E.y,n.x-E.x),B;return M<T?((M>R||R>T)&&(M+=ud),M>T&&(B=T,T=M,M=B)):T<R&&R<M?(B=T,T=M,M=B):T+=ud,E.s=M,E.e=T,E.r=S,E},numberSort:function(r,e){return r-e}};class Bc{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return Re.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var n=e[0].bbox(),i=1;i<e.length;i++)Re.expandbox(n,e[i].bbox());return n}offset(e){const n=[];return this.curves.forEach(function(i){n.push(...i.offset(e))}),new Bc(n)}}const{abs:sc,min:iC,max:aC,cos:i_,sin:a_,acos:s_,sqrt:oc}=Math,o_=Math.PI;class rr{constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;const m=[];n.forEach(function(y){["x","y","z"].forEach(function(b){typeof y[b]<"u"&&m.push(y[b])})}),n=m}let a=!1;const s=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");a=!0}}else if(s!==6&&s!==8&&s!==9&&s!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!a&&(s===9||s===12)||e&&e[0]&&typeof e[0].z<"u",l=this.points=[];for(let m=0,y=o?3:2;m<s;m+=y){var c={x:n[m],y:n[m+1]};o&&(c.z=n[m+2]),l.push(c)}const u=this.order=l.length-1,h=this.dims=["x","y"];o&&h.push("z"),this.dimlen=h.length;const g=Re.align(l,{p1:l[0],p2:l[u]}),v=Re.dist(l[0],l[u]);this._linear=g.reduce((m,y)=>m+sc(y.y),0)<v/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,i,a){if(typeof a>"u"&&(a=.5),a===0)return new rr(n,n,i);if(a===1)return new rr(e,n,n);const s=rr.getABC(2,e,n,i,a);return new rr(e,s.A,i)}static cubicFromPoints(e,n,i,a,s){typeof a>"u"&&(a=.5);const o=rr.getABC(3,e,n,i,a);typeof s>"u"&&(s=Re.dist(n,o.C));const l=s*(1-a)/a,c=Re.dist(e,i),u=(i.x-e.x)/c,h=(i.y-e.y)/c,g=s*u,v=s*h,m=l*u,y=l*h,b={x:n.x-g,y:n.y-v},x={x:n.x+m,y:n.y+y},A=o.A,C={x:A.x+(b.x-A.x)/(1-a),y:A.y+(b.y-A.y)/(1-a)},E={x:A.x+(x.x-A.x)/a,y:A.y+(x.y-A.y)/a},S={x:e.x+(C.x-e.x)/a,y:e.y+(C.y-e.y)/a},M={x:i.x+(E.x-i.x)/(1-a),y:i.y+(E.y-i.y)/(1-a)};return new rr(e,S,M,i)}static getUtils(){return Re}getUtils(){return rr.getUtils()}static get PolyBezier(){return Bc}valueOf(){return this.toString()}toString(){return Re.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,n=e[0].x,i=e[0].y,a=["M",n,i,this.order===2?"Q":"C"];for(let s=1,o=e.length;s<o;s++)a.push(e[s].x),a.push(e[s].y);return a.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=Re.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,n=Re.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return Re.length(this.derivative.bind(this))}static getABC(e=2,n,i,a,s=.5){const o=Re.projectionratio(s,e),l=1-o,c={x:o*n.x+l*a.x,y:o*n.y+l*a.y},u=Re.abcratio(s,e);return{A:{x:i.x+(i.x-c.x)/u,y:i.y+(i.y-c.y)/u},B:i,C:c,S:n,E:a}}getABC(e,n){n=n||this.get(e);let i=this.points[0],a=this.points[this.order];return rr.getABC(this.order,i,n,a,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,i,a;n<e;n++)a=n/(e-1),i=this.compute(a),i.t=a,this._lut.push(i);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),a=[];for(let s=0,o,l=0;s<i.length;s++)o=i[s],Re.dist(o,e)<n&&(a.push(o),l+=s/i.length);return a.length?t/=a.length:!1}project(e){const n=this.getLUT(),i=n.length-1,a=Re.closest(n,e),s=a.mpos,o=(s-1)/i,l=(s+1)/i,c=.1/i;let u=a.mdist,h=o,g=h,v;u+=1;for(let m;h<l+c;h+=c)v=this.compute(h),m=Re.dist(e,v),m<u&&(u=m,g=h);return g=g<0?0:g>1?1:g,v=this.compute(g),v.t=g,v.d=u,v}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?Re.computeWithRatios(e,this.points,this.ratios,this._3d):Re.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,n=[e[0]],i=e.length;for(let a=1,s,o;a<i;a++)s=e[a],o=e[a-1],n[a]={x:(i-a)/i*s.x+a/i*o.x,y:(i-a)/i*s.y+a/i*o.y};return n[i]=e[i-1],new rr(n)}derivative(e){return Re.compute(e,this.dpoints[0],this._3d)}dderivative(e){return Re.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new rr(Re.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return Re.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return Re.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const n=this.derivative(e),i=oc(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/i,y:n.x/i}}__normal3(e){const n=this.derivative(e),i=this.derivative(e+.01),a=oc(n.x*n.x+n.y*n.y+n.z*n.z),s=oc(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=a,n.y/=a,n.z/=a,i.x/=s,i.y/=s,i.z/=s;const o={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},l=oc(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=l,o.y/=l,o.z/=l;const c=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:e,x:c[0]*n.x+c[1]*n.y+c[2]*n.z,y:c[3]*n.x+c[4]*n.y+c[5]*n.z,z:c[6]*n.x+c[7]*n.y+c[8]*n.z}}hull(e){let n=this.points,i=[],a=[],s=0;for(a[s++]=n[0],a[s++]=n[1],a[s++]=n[2],this.order===3&&(a[s++]=n[3]);n.length>1;){i=[];for(let o=0,l,c=n.length-1;o<c;o++)l=Re.lerp(e,n[o],n[o+1]),a[s++]=l,i.push(l);n=i}return a}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;const i=this.hull(e),a={left:this.order===2?new rr([i[0],i[3],i[5]]):new rr([i[0],i[4],i[7],i[9]]),right:this.order===2?new rr([i[5],i[4],i[2]]):new rr([i[9],i[8],i[6],i[3]]),span:i};return a.left._t1=Re.map(0,0,1,this._t1,this._t2),a.left._t2=Re.map(e,0,1,this._t1,this._t2),a.right._t1=Re.map(e,0,1,this._t1,this._t2),a.right._t2=Re.map(1,0,1,this._t1,this._t2),n?(n=Re.map(n,e,1,0,1),a.right.split(n).left):a}extrema(){const e={};let n=[];return this.dims.forEach((function(i){let a=function(o){return o[i]},s=this.dpoints[0].map(a);e[i]=Re.droots(s),this.order===3&&(s=this.dpoints[1].map(a),e[i]=e[i].concat(Re.droots(s))),e[i]=e[i].filter(function(o){return o>=0&&o<=1}),n=n.concat(e[i].sort(Re.numberSort))}).bind(this)),e.values=n.sort(Re.numberSort).filter(function(i,a){return n.indexOf(i)===a}),e}bbox(){const e=this.extrema(),n={};return this.dims.forEach((function(i){n[i]=Re.getminmax(this,i,e[i])}).bind(this)),n}overlaps(e){const n=this.bbox(),i=e.bbox();return Re.bboxoverlap(n,i)}offset(e,n){if(typeof n<"u"){const i=this.get(e),a=this.normal(e),s={c:i,n:a,x:i.x+a.x*n,y:i.y+a.y*n};return this._3d&&(s.z=i.z+a.z*n),s}if(this._linear){const i=this.normal(0),a=this.points.map(function(s){const o={x:s.x+e*i.x,y:s.y+e*i.y};return s.z&&i.z&&(o.z=s.z+e*i.z),o});return[new rr(a)]}return this.reduce().map(function(i){return i._linear?i.offset(e)[0]:i.scale(e)})}simple(){if(this.order===3){const a=Re.angle(this.points[0],this.points[3],this.points[1]),s=Re.angle(this.points[0],this.points[3],this.points[2]);if(a>0&&s<0||a<0&&s>0)return!1}const e=this.normal(0),n=this.normal(1);let i=e.x*n.x+e.y*n.y;return this._3d&&(i+=e.z*n.z),sc(s_(i))<o_/3}reduce(){let e,n=0,i=0,a=.01,s,o=[],l=[],c=this.extrema().values;for(c.indexOf(0)===-1&&(c=[0].concat(c)),c.indexOf(1)===-1&&c.push(1),n=c[0],e=1;e<c.length;e++)i=c[e],s=this.split(n,i),s._t1=n,s._t2=i,o.push(s),n=i;return o.forEach(function(u){for(n=0,i=0;i<=1;)for(i=n+a;i<=1+a;i+=a)if(s=u.split(n,i),!s.simple()){if(i-=a,sc(n-i)<a)return[];s=u.split(n,i),s._t1=Re.map(n,0,1,u._t1,u._t2),s._t2=Re.map(i,0,1,u._t1,u._t2),l.push(s),n=i;break}n<1&&(s=u.split(n,1),s._t1=Re.map(n,0,1,u._t1,u._t2),s._t2=u._t2,l.push(s))}),l}translate(e,n,i){i=typeof i=="number"?i:n;const a=this.order;let s=this.points.map((o,l)=>(1-l/a)*n+l/a*i);return new rr(this.points.map((o,l)=>({x:o.x+e.x*s[l],y:o.y+e.y*s[l]})))}scale(e){const n=this.order;let i=!1;if(typeof e=="function"&&(i=e),i&&n===2)return this.raise().scale(i);const a=this.clockwise,s=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):e,i?i(1):e);const o=i?i(0):e,l=i?i(1):e,c=[this.offset(0,10),this.offset(1,10)],u=[],h=Re.lli4(c[0],c[0].c,c[1],c[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(g){const v=u[g*n]=Re.copy(s[g*n]);v.x+=(g?l:o)*c[g].n.x,v.y+=(g?l:o)*c[g].n.y}),i?([0,1].forEach(function(g){if(!(n===2&&g)){var v=s[g+1],m={x:v.x-h.x,y:v.y-h.y},y=i?i((g+1)/n):e;i&&!a&&(y=-y);var b=oc(m.x*m.x+m.y*m.y);m.x/=b,m.y/=b,u[g+1]={x:v.x+y*m.x,y:v.y+y*m.y}}}),new rr(u)):([0,1].forEach(g=>{if(n===2&&g)return;const v=u[g*n],m=this.derivative(g),y={x:v.x+m.x,y:v.y+m.y};u[g+1]=Re.lli4(v,y,h,s[g+1])}),new rr(u))}outline(e,n,i,a){if(n=n===void 0?e:n,this._linear){const M=this.normal(0),R=this.points[0],T=this.points[this.points.length-1];let B,F,I;i===void 0&&(i=e,a=n),B={x:R.x+M.x*e,y:R.y+M.y*e},I={x:T.x+M.x*i,y:T.y+M.y*i},F={x:(B.x+I.x)/2,y:(B.y+I.y)/2};const U=[B,F,I];B={x:R.x-M.x*n,y:R.y-M.y*n},I={x:T.x-M.x*a,y:T.y-M.y*a},F={x:(B.x+I.x)/2,y:(B.y+I.y)/2};const k=[I,F,B],O=Re.makeline(k[2],U[0]),V=Re.makeline(U[2],k[0]),L=[O,new rr(U),V,new rr(k)];return new Bc(L)}const s=this.reduce(),o=s.length,l=[];let c=[],u,h=0,g=this.length();const v=typeof i<"u"&&typeof a<"u";function m(M,R,T,B,F){return function(I){const U=B/T,k=(B+F)/T,O=R-M;return Re.map(I,0,1,M+U*O,M+k*O)}}s.forEach(function(M){const R=M.length();v?(l.push(M.scale(m(e,i,g,h,R))),c.push(M.scale(m(-n,-a,g,h,R)))):(l.push(M.scale(e)),c.push(M.scale(-n))),h+=R}),c=c.map(function(M){return u=M.points,u[3]?M.points=[u[3],u[2],u[1],u[0]]:M.points=[u[2],u[1],u[0]],M}).reverse();const y=l[0].points[0],b=l[o-1].points[l[o-1].points.length-1],x=c[o-1].points[c[o-1].points.length-1],A=c[0].points[0],C=Re.makeline(x,y),E=Re.makeline(b,A),S=[C].concat(l).concat([E]).concat(c);return new Bc(S)}outlineshapes(e,n,i){n=n||e;const a=this.outline(e,n).curves,s=[];for(let o=1,l=a.length;o<l/2;o++){const c=Re.makeshape(a[o],a[l-o],i);c.startcap.virtual=o>1,c.endcap.virtual=o<l/2-1,s.push(c)}return s}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof rr&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){const n=iC(e.p1.x,e.p2.x),i=iC(e.p1.y,e.p2.y),a=aC(e.p1.x,e.p2.x),s=aC(e.p1.y,e.p2.y);return Re.roots(this.points,e).filter(o=>{var l=this.get(o);return Re.between(l.x,n,a)&&Re.between(l.y,i,s)})}selfintersects(e){const n=this.reduce(),i=n.length-2,a=[];for(let s=0,o,l,c;s<i;s++)l=n.slice(s,s+1),c=n.slice(s+2),o=this.curveintersects(l,c,e),a.push(...o);return a}curveintersects(e,n,i){const a=[];e.forEach(function(o){n.forEach(function(l){o.overlaps(l)&&a.push({left:o,right:l})})});let s=[];return a.forEach(function(o){const l=Re.pairiteration(o.left,o.right,i);l.length>0&&(s=s.concat(l))}),s}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,i,a){const s=(a-i)/4,o=this.get(i+s),l=this.get(a-s),c=Re.dist(e,n),u=Re.dist(e,o),h=Re.dist(e,l);return sc(u-c)+sc(h-c)}_iterate(e,n){let i=0,a=1,s;do{s=0,a=1;let o=this.get(i),l,c,u,h,g=!1,v=!1,m,y=a,b=1;do if(v=g,h=u,y=(i+a)/2,l=this.get(y),c=this.get(a),u=Re.getccenter(o,l,c),u.interval={start:i,end:a},g=this._error(u,o,i,a)<=e,m=v&&!g,m||(b=a),g){if(a>=1){if(u.interval.end=b=1,h=u,a>1){let A={x:u.x+u.r*i_(u.e),y:u.y+u.r*a_(u.e)};u.e+=Re.angle({x:u.x,y:u.y},A,this.get(1))}break}a=a+(a-i)/2}else a=y;while(!m&&s++<100);if(s>=100)break;h=h||u,n.push(h),i=b}while(a<1);return n}}function a2(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function l_(r){if(Array.isArray(r))return r}function u_(r){if(Array.isArray(r))return a2(r)}function c_(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function f_(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(c=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,a=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function h_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d_(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g_(r,e){if(r==null)return{};var n,i,a=v_(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(i=0;i<s.length;i++)n=s[i],e.includes(n)||{}.propertyIsEnumerable.call(r,n)&&(a[n]=r[n])}return a}function v_(r,e){if(r==null)return{};var n={};for(var i in r)if({}.hasOwnProperty.call(r,i)){if(e.includes(i))continue;n[i]=r[i]}return n}function m_(r,e){return l_(r)||f_(r,e)||W6(r,e)||h_()}function p_(r){return u_(r)||c_(r)||W6(r)||d_()}function y_(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function A_(r){var e=y_(r,"string");return typeof e=="symbol"?e:e+""}function W6(r,e){if(r){if(typeof r=="string")return a2(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a2(r,e):void 0}}var x_=(function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(l){return{keyAccessor:l,isProp:!(l instanceof Function)}}),s=r.reduce(function(l,c){var u=l,h=c;return a.forEach(function(g,v){var m=g.keyAccessor,y=g.isProp,b;if(y){var x=h,A=x[m],C=g_(x,[m].map(A_));b=A,h=C}else b=m(h,v);v+1<a.length?(u.hasOwnProperty(b)||(u[b]={}),u=u[b]):n?(u.hasOwnProperty(b)||(u[b]=[]),u[b].push(h)):u[b]=h}),l},{});n instanceof Function&&(function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;u===a.length?Object.keys(c).forEach(function(h){return c[h]=n(c[h])}):Object.values(c).forEach(function(h){return l(h,u+1)})})(s);var o=s;return i&&(o=[],(function l(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];u.length===a.length?o.push({keys:u,vals:c}):Object.entries(c).forEach(function(h){var g=m_(h,2),v=g[0],m=g[1];return l(m,[].concat(p_(u),[v]))})})(s),e instanceof Array&&e.length===0&&o.length===1&&(o[0].keys=[])),o});function b_(r,e){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(e).domain(r);break}return this}const sC=Symbol("implicit");function J6(){var r=new M4,e=[],n=[],i=sC;function a(s){let o=r.get(s);if(o===void 0){if(i!==sC)return i;r.set(s,o=e.push(s)-1)}return n[o%n.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],r=new M4;for(const o of s)r.has(o)||r.set(o,e.push(o)-1);return a},a.range=function(s){return arguments.length?(n=Array.from(s),a):n.slice()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.copy=function(){return J6(e,n).unknown(i)},b_.apply(a,arguments),a}function w_(r){for(var e=r.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+r.slice(i*6,++i*6);return n}const C_=w_("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function E_(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",n==="top"&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=r:a.appendChild(document.createTextNode(r))}}var S_=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;E_(S_);function s2(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function T_(r){if(Array.isArray(r))return r}function M_(r){if(Array.isArray(r))return s2(r)}function oC(r,e,n){if($6())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var a=new(r.bind.apply(r,i));return a}function Jc(r,e,n){return(e=F_(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function $6(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($6=function(){return!!r})()}function D_(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function R_(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],c=!0,u=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(c=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);c=!0);}catch(h){u=!0,a=h}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function B_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I_(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lC(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),n.push.apply(n,i)}return n}function El(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lC(Object(n),!0).forEach(function(i){Jc(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):lC(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Ic(r,e){return T_(r)||R_(r,e)||eT(r,e)||B_()}function pi(r){return M_(r)||D_(r)||eT(r)||I_()}function N_(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function F_(r){var e=N_(r,"string");return typeof e=="symbol"?e:e+""}function o2(r){"@babel/helpers - typeof";return o2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o2(r)}function eT(r,e){if(r){if(typeof r=="string")return s2(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s2(r,e):void 0}}var k_=J6(C_);function uC(r,e,n){!e||typeof n!="string"||r.filter(function(i){return!i[n]}).forEach(function(i){i[n]=k_(e(i))})}function U_(r,e){var n=r.nodes,i=r.links,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=a.nodeFilter,o=s===void 0?function(){return!0}:s,l=a.onLoopError,c=l===void 0?function(m){throw"Invalid DAG structure! Found cycle in node path: ".concat(m.join(" -> "),".")}:l,u={};n.forEach(function(m){return u[e(m)]={data:m,out:[],depth:-1,skip:!o(m)}}),i.forEach(function(m){var y=m.source,b=m.target,x=S(y),A=S(b);if(!u.hasOwnProperty(x))throw"Missing source node with id: ".concat(x);if(!u.hasOwnProperty(A))throw"Missing target node with id: ".concat(A);var C=u[x],E=u[A];C.out.push(E);function S(M){return o2(M)==="object"?e(M):M}});var h=[];v(Object.values(u));var g=Object.assign.apply(Object,[{}].concat(pi(Object.entries(u).filter(function(m){var y=Ic(m,2),b=y[1];return!b.skip}).map(function(m){var y=Ic(m,2),b=y[0],x=y[1];return Jc({},b,x.depth)}))));return g;function v(m){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=function(){var S=m[A];if(y.indexOf(S)!==-1){var M=[].concat(pi(y.slice(y.indexOf(S))),[S]).map(function(R){return e(R.data)});return h.some(function(R){return R.length===M.length&&R.every(function(T,B){return T===M[B]})})||(h.push(M),c(M)),1}b>S.depth&&(S.depth=b,v(S.out,[].concat(pi(y),[S]),b+(S.skip?0:1)))},A=0,C=m.length;A<C;A++)x()}}var V_=2,dn=function(e,n){return n.onNeedsRedraw&&n.onNeedsRedraw()},cC=function(e,n){if(!n.isShadow){var i=Ut(n.linkDirectionalParticles);n.graphData.links.forEach(function(a){var s=Math.round(Math.abs(i(a)));s?a.__photons=pi(Array(s)).map(function(){return{}}):delete a.__photons})}},p0=J2({props:{graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1,cC(e,n)}},dagMode:{onChange:function(e,n){!e&&(n.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:dn},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:dn},nodeColor:{default:"color",triggerUpdate:!1,onChange:dn},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:dn},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:dn},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:dn},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:dn},linkColor:{default:"color",triggerUpdate:!1,onChange:dn},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:dn},linkWidth:{default:1,triggerUpdate:!1,onChange:dn},linkCurvature:{default:0,triggerUpdate:!1,onChange:dn},linkCanvasObject:{triggerUpdate:!1,onChange:dn},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:dn},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:dn},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:dn},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:dn},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:cC},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleOffset:{default:0,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},linkDirectionalParticleCanvasObject:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.velocityDecay(e)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(e,n,i){return i===void 0?e.forceLayout.force(n):(e.forceLayout.force(n,i),this)},d3ReheatSimulation:function(e){return e.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},isEngineRunning:function(e){return!!e.engineRunning},tickFrame:function(e){return!e.isShadow&&n(),a(),!e.isShadow&&s(),!e.isShadow&&o(),i(),this;function n(){e.engineRunning&&(++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.forceLayout.tick(),e.onEngineTick()))}function i(){var l=Ut(e.nodeVisibility),c=Ut(e.nodeVal),u=Ut(e.nodeColor),h=Ut(e.nodeCanvasObjectMode),g=e.ctx,v=e.isShadow/e.globalScale,m=e.graphData.nodes.filter(l);g.save(),m.forEach(function(y){var b=h(y);if(e.nodeCanvasObject&&(b==="before"||b==="replace")&&(e.nodeCanvasObject(y,g,e.globalScale),b==="replace")){g.restore();return}var x=Math.sqrt(Math.max(0,c(y)||1))*e.nodeRelSize+v;g.beginPath(),g.arc(y.x,y.y,x,0,2*Math.PI,!1),g.fillStyle=u(y)||"rgba(31, 120, 180, 0.92)",g.fill(),e.nodeCanvasObject&&b==="after"&&e.nodeCanvasObject(y,e.ctx,e.globalScale)}),g.restore()}function a(){var l=Ut(e.linkVisibility),c=Ut(e.linkColor),u=Ut(e.linkWidth),h=Ut(e.linkLineDash),g=Ut(e.linkCurvature),v=Ut(e.linkCanvasObjectMode),m=e.ctx,y=e.isShadow*2,b=e.graphData.links.filter(l);b.forEach(R);var x=[],A=[],C=b;if(e.linkCanvasObject){var E=[],S=[];b.forEach(function(T){return({before:x,after:A,replace:E}[v(T)]||S).push(T)}),C=[].concat(pi(x),A,S),x=x.concat(E)}m.save(),x.forEach(function(T){return e.linkCanvasObject(T,m,e.globalScale)}),m.restore();var M=x_(C,[c,u,h]);m.save(),Object.entries(M).forEach(function(T){var B=Ic(T,2),F=B[0],I=B[1],U=!F||F==="undefined"?"rgba(0,0,0,0.15)":F;Object.entries(I).forEach(function(k){var O=Ic(k,2),V=O[0],L=O[1],P=(V||1)/e.globalScale+y;Object.entries(L).forEach(function(_){var q=Ic(_,2);q[0];var H=q[1],W=h(H[0]);m.beginPath(),H.forEach(function(G){var K=G.source,$=G.target;if(!(!K||!$||!K.hasOwnProperty("x")||!$.hasOwnProperty("x"))){m.moveTo(K.x,K.y);var te=G.__controlPoints;te?m[te.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(m,pi(te).concat([$.x,$.y])):m.lineTo($.x,$.y)}}),m.strokeStyle=U,m.lineWidth=P,m.setLineDash(W||[]),m.stroke()})})}),m.restore(),m.save(),A.forEach(function(T){return e.linkCanvasObject(T,m,e.globalScale)}),m.restore();function R(T){var B=g(T);if(!B){T.__controlPoints=null;return}var F=T.source,I=T.target;if(!(!F||!I||!F.hasOwnProperty("x")||!I.hasOwnProperty("x"))){var U=Math.sqrt(Math.pow(I.x-F.x,2)+Math.pow(I.y-F.y,2));if(U>0){var k=Math.atan2(I.y-F.y,I.x-F.x),O=U*B,V={x:(F.x+I.x)/2+O*Math.cos(k-Math.PI/2),y:(F.y+I.y)/2+O*Math.sin(k-Math.PI/2)};T.__controlPoints=[V.x,V.y]}else{var L=B*70;T.__controlPoints=[I.x,I.y-L,I.x+L,I.y]}}}}function s(){var l=1.6,c=.2,u=Ut(e.linkDirectionalArrowLength),h=Ut(e.linkDirectionalArrowRelPos),g=Ut(e.linkVisibility),v=Ut(e.linkDirectionalArrowColor||e.linkColor),m=Ut(e.nodeVal),y=e.ctx;y.save(),e.graphData.links.filter(g).forEach(function(b){var x=u(b);if(!(!x||x<0)){var A=b.source,C=b.target;if(!(!A||!C||!A.hasOwnProperty("x")||!C.hasOwnProperty("x"))){var E=Math.sqrt(Math.max(0,m(A)||1))*e.nodeRelSize,S=Math.sqrt(Math.max(0,m(C)||1))*e.nodeRelSize,M=Math.min(1,Math.max(0,h(b))),R=v(b)||"rgba(0,0,0,0.28)",T=x/l/2,B=b.__controlPoints&&oC(rr,[A.x,A.y].concat(pi(b.__controlPoints),[C.x,C.y])),F=B?function(P){return B.get(P)}:function(P){return{x:A.x+(C.x-A.x)*P||0,y:A.y+(C.y-A.y)*P||0}},I=B?B.length():Math.sqrt(Math.pow(C.x-A.x,2)+Math.pow(C.y-A.y,2)),U=E+x+(I-E-S-x)*M,k=F(U/I),O=F((U-x)/I),V=F((U-x*(1-c))/I),L=Math.atan2(k.y-O.y,k.x-O.x)-Math.PI/2;y.beginPath(),y.moveTo(k.x,k.y),y.lineTo(O.x+T*Math.cos(L),O.y+T*Math.sin(L)),y.lineTo(V.x,V.y),y.lineTo(O.x-T*Math.cos(L),O.y-T*Math.sin(L)),y.fillStyle=R,y.fill()}}}),y.restore()}function o(){var l=Ut(e.linkDirectionalParticles),c=Ut(e.linkDirectionalParticleSpeed),u=Ut(e.linkDirectionalParticleOffset),h=Ut(e.linkDirectionalParticleWidth),g=Ut(e.linkVisibility),v=Ut(e.linkDirectionalParticleColor||e.linkColor),m=e.ctx;m.save(),e.graphData.links.filter(g).forEach(function(y){var b=l(y);if(!(!y.hasOwnProperty("__photons")||!y.__photons.length)){var x=y.source,A=y.target;if(!(!x||!A||!x.hasOwnProperty("x")||!A.hasOwnProperty("x"))){var C=c(y),E=Math.abs(u(y)),S=y.__photons||[],M=Math.max(0,h(y)/2)/Math.sqrt(e.globalScale),R=v(y)||"rgba(0,0,0,0.28)";m.fillStyle=R;var T=y.__controlPoints?oC(rr,[x.x,x.y].concat(pi(y.__controlPoints),[A.x,A.y])):null,B=0,F=!1;S.forEach(function(I){var U=!!I.__singleHop;if(I.hasOwnProperty("__progressRatio")||(I.__progressRatio=U?0:(B+E)/b),!U&&B++,I.__progressRatio+=C,I.__progressRatio>=1)if(!U)I.__progressRatio=I.__progressRatio%1;else{F=!0;return}var k=I.__progressRatio,O=T?T.get(k):{x:x.x+(A.x-x.x)*k||0,y:x.y+(A.y-x.y)*k||0};e.linkDirectionalParticleCanvasObject?e.linkDirectionalParticleCanvasObject(O.x,O.y,y,m,e.globalScale):(m.beginPath(),m.arc(O.x,O.y,M,0,2*Math.PI,!1),m.fill())}),F&&(y.__photons=y.__photons.filter(function(I){return!I.__singleHop||I.__progressRatio<=1}))}}}),m.restore()}},emitParticle:function(e,n){return n&&(!n.__photons&&(n.__photons=[]),n.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:JL().force("link",YL()).force("charge",$L()).force("center",HP()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.ctx=e},update:function(e,n){e.engineRunning=!1,e.onUpdate(),e.nodeAutoColorBy!==null&&uC(e.graphData.nodes,Ut(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&uC(e.graphData.links,Ut(e.linkAutoColorBy),e.linkColor),e.graphData.links.forEach(function(v){v.source=v[e.linkSource],v.target=v[e.linkTarget]}),e.forceLayout.stop().alpha(1).nodes(e.graphData.nodes);var i=e.forceLayout.force("link");i&&i.id(function(v){return v[e.nodeId]}).links(e.graphData.links);var a=e.dagMode&&U_(e.graphData,function(v){return v[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),s=Math.max.apply(Math,pi(Object.values(a||[]))),o=e.dagLevelDistance||e.graphData.nodes.length/(s||1)*V_*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(n.dagMode)){var l=["lr","rl"].includes(n.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(v){return delete v[l]})}if(["lr","rl","td","bu"].includes(e.dagMode)){var c=["rl","bu"].includes(e.dagMode),u=function(m){return(a[m[e.nodeId]]-s/2)*o*(c?-1:1)},h=["lr","rl"].includes(e.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(v){return v[h]=u(v)})}e.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?e_(function(v){var m=a[v[e.nodeId]]||-1;return(e.dagMode==="radialin"?s-m:m)*o}).strength(function(v){return e.dagNodeFilter(v)?1:0}):null);for(var g=0;g<e.warmupTicks&&!(e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin);g++)e.forceLayout.tick();this.resetCountdown(),e.onFinishUpdate()}});function tT(r,e){var n=r instanceof Array?r:[r],i=new e;return i._destructor&&i._destructor(),{linkProp:function(s){return{default:i[s](),onChange:function(l,c){n.forEach(function(u){return c[u][s](l)})},triggerUpdate:!1}},linkMethod:function(s){return function(o){for(var l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];var h=[];return n.forEach(function(g){var v=o[g],m=v[s].apply(v,c);m!==v&&h.push(m)}),h.length?h[0]:this}}}}var O_=800,P_=4,L_=5,rT=tT("forceGraph",p0),__=tT(["forceGraph","shadowGraph"],p0),z_=Object.assign.apply(Object,pi(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleOffset","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleCanvasObject","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return Jc({},r,rT.linkProp(r))})).concat(pi(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(r){return Jc({},r,__.linkProp(r))})))),G_=Object.assign.apply(Object,pi(["d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return Jc({},r,rT.linkMethod(r))})));function $1(r){if(r.canvas){var e=r.canvas.width,n=r.canvas.height;e===300&&n===150&&(e=n=0);var i=window.devicePixelRatio;e/=i,n/=i,[r.canvas,r.shadowCanvas].forEach(function(s){s.style.width="".concat(r.width,"px"),s.style.height="".concat(r.height,"px"),s.width=r.width*i,s.height=r.height*i,!e&&!n&&s.getContext("2d").scale(i,i)});var a=Yi(r.canvas).k;r.zoom.translateBy(r.zoom.__baseElem,(r.width-e)/2/a,(r.height-n)/2/a),r.needsRedraw=!0}}function nT(r){var e=window.devicePixelRatio;r.setTransform(e,0,0,e,0,0)}function fC(r,e,n){r.save(),nT(r),r.clearRect(0,0,e,n),r.restore()}var q_=J2({props:El({width:{default:window.innerWidth,onChange:function(e,n){return $1(n)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(e,n){return $1(n)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){[e.nodes,e.links].every(function(a){return(a||[]).every(function(s){return!s.hasOwnProperty("__indexColor")})})&&n.colorTracker.reset(),[{type:"Node",objs:e.nodes},{type:"Link",objs:e.links}].forEach(i),n.forceGraph.graphData(e),n.shadowGraph.graphData(e);function i(a){var s=a.type,o=a.objs;o.filter(function(l){if(!l.hasOwnProperty("__indexColor"))return!0;var c=n.colorTracker.lookup(l.__indexColor);return!c||!c.hasOwnProperty("d")||c.d!==l}).forEach(function(l){l.__indexColor=n.colorTracker.register({type:s,d:l})})}},triggerUpdate:!1},backgroundColor:{onChange:function(e,n){n.canvas&&e&&(n.canvas.style.background=e)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(e,n){n.shadowGraph.nodeCanvasObject(e?function(i,a,s){return e(i,i.__indexColor,a,s)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(e,n){n.shadowGraph.linkCanvasObject(e?function(i,a,s){return e(i,i.__indexColor,a,s)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(e,n){n.zoom.scaleExtent([e,n.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(e,n){n.zoom.scaleExtent([n.zoom.scaleExtent()[0],e])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},showPointerCursor:{default:!0,triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},z_),aliases:{stopAnimation:"pauseAnimation"},methods:El({graph2ScreenCoords:function(e,n,i){var a=Yi(e.canvas);return{x:n*a.k+a.x,y:i*a.k+a.y}},screen2GraphCoords:function(e,n,i){var a=Yi(e.canvas);return{x:(n-a.x)/a.k,y:(i-a.y)/a.k}},centerAt:function(e,n,i,a){if(!e.canvas)return null;if(n!==void 0||i!==void 0){var s=Object.assign({},n!==void 0?{x:n}:{},i!==void 0?{y:i}:{});return a?e.tweenGroup.add(new k4(o()).to(s,a).easing(Ao.Quadratic.Out).onUpdate(l).start()):l(s),this}return o();function o(){var c=Yi(e.canvas);return{x:(e.width/2-c.x)/c.k,y:(e.height/2-c.y)/c.k}}function l(c){var u=c.x,h=c.y;e.zoom.translateTo(e.zoom.__baseElem,u===void 0?o().x:u,h===void 0?o().y:h),e.needsRedraw=!0}},zoom:function(e,n,i){if(!e.canvas)return null;if(n!==void 0)return i?e.tweenGroup.add(new k4({k:a()}).to({k:n},i).easing(Ao.Quadratic.Out).onUpdate(function(o){var l=o.k;return s(l)}).start()):s(n),this;return a();function a(){return Yi(e.canvas).k}function s(o){e.zoom.scaleTo(e.zoom.__baseElem,o),e.needsRedraw=!0}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,a=arguments.length,s=new Array(a>3?a-3:0),o=3;o<a;o++)s[o-3]=arguments[o];var l=this.getGraphBbox.apply(this,s);if(l){var c={x:(l.x[0]+l.x[1])/2,y:(l.y[0]+l.y[1])/2},u=Math.max(1e-12,Math.min(1e12,(e.width-i*2)/(l.x[1]-l.x[0]),(e.height-i*2)/(l.y[1]-l.y[0])));this.centerAt(c.x,c.y,n),this.zoom(u,n)}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=Ut(e.nodeVal),a=function(l){return Math.sqrt(Math.max(0,i(l)||1))*e.nodeRelSize},s=e.graphData.nodes.filter(n).map(function(o){return{x:o.x,y:o.y,r:a(o)}});return s.length?{x:[B4(s,function(o){return o.x-o.r}),R4(s,function(o){return o.x+o.r})],y:[B4(s,function(o){return o.y-o.r}),R4(s,function(o){return o.y+o.r})]}:null},pauseAnimation:function(e){return e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},G_),stateInit:function(){return{lastSetZoom:1,zoom:eO(),forceGraph:new p0,shadowGraph:new p0().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new EP,tweenGroup:new S6}},init:function(e,n){var i=this;e.innerHTML="";var a=document.createElement("div");a.classList.add("force-graph-container"),a.style.position="relative",e.appendChild(a),n.canvas=document.createElement("canvas"),n.backgroundColor&&(n.canvas.style.background=n.backgroundColor),a.appendChild(n.canvas),n.shadowCanvas=document.createElement("canvas");var s=n.canvas.getContext("2d"),o=n.shadowCanvas.getContext("2d",{willReadFrequently:!0}),l={x:-1e12,y:-1e12},c=function(){var g=null,v=window.devicePixelRatio,m=l.x>0&&l.y>0?o.getImageData(l.x*v,l.y*v,1,1):null;return m&&(g=n.colorTracker.lookup(m.data)),g};mi(n.canvas).call(cU().subject(function(){if(!n.enableNodeDrag)return null;var h=c();return h&&h.type==="Node"?h.d:null}).on("start",function(h){var g=h.subject;g.__initialDragPos={x:g.x,y:g.y,fx:g.fx,fy:g.fy},h.active||(g.fx=g.x,g.fy=g.y),n.canvas.classList.add("grabbable")}).on("drag",function(h){var g=h.subject,v=g.__initialDragPos,m=h,y=Yi(n.canvas).k,b={x:v.x+(m.x-v.x)/y-g.x,y:v.y+(m.y-v.y)/y-g.y};["x","y"].forEach(function(x){return g["f".concat(x)]=g[x]=v[x]+(m[x]-v[x])/y}),!(!g.__dragged&&L_>=Math.sqrt(iO(["x","y"].map(function(x){return Math.pow(h[x]-v[x],2)}))))&&(n.forceGraph.d3AlphaTarget(.3).resetCountdown(),n.isPointerDragging=!0,g.__dragged=!0,n.onNodeDrag(g,b))}).on("end",function(h){var g=h.subject,v=g.__initialDragPos,m={x:g.x-v.x,y:g.y-v.y};v.fx===void 0&&(g.fx=void 0),v.fy===void 0&&(g.fy=void 0),delete g.__initialDragPos,n.forceGraph.d3AlphaTarget()&&n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.canvas.classList.remove("grabbable"),n.isPointerDragging=!1,g.__dragged&&(delete g.__dragged,n.onNodeDragEnd(g,m))})),n.zoom(n.zoom.__baseElem=mi(n.canvas)),n.zoom.__baseElem.on("dblclick.zoom",null),n.zoom.filter(function(h){return!h.button&&n.enableZoomPanInteraction&&(h.type!=="wheel"||Ut(n.enableZoomInteraction)(h))&&(h.type==="wheel"||Ut(n.enablePanInteraction)(h))}).on("zoom",function(h){var g=h.transform;[s,o].forEach(function(v){nT(v),v.translate(g.x,g.y),v.scale(g.k,g.k)}),n.isPointerDragging=!0,n.onZoom&&n.onZoom(El(El({},g),i.centerAt())),n.needsRedraw=!0}).on("end",function(h){n.isPointerDragging=!1,n.onZoomEnd&&n.onZoomEnd(El(El({},h.transform),i.centerAt()))}),$1(n),n.forceGraph.onNeedsRedraw(function(){return n.needsRedraw=!0}).onFinishUpdate(function(){Yi(n.canvas).k===n.lastSetZoom&&n.graphData.nodes.length&&(n.zoom.scaleTo(n.zoom.__baseElem,n.lastSetZoom=P_/Math.cbrt(n.graphData.nodes.length)),n.needsRedraw=!0)}),n.tooltip=new jP(a),["pointermove","pointerdown"].forEach(function(h){return a.addEventListener(h,function(g){h==="pointerdown"&&(n.isPointerPressed=!0,n.pointerDownEvent=g),!n.isPointerDragging&&g.type==="pointermove"&&n.onBackgroundClick&&(g.pressure>0||n.isPointerPressed)&&(g.pointerType==="mouse"||g.movementX===void 0||[g.movementX,g.movementY].some(function(y){return Math.abs(y)>1}))&&(n.isPointerDragging=!0);var v=m(a);l.x=g.pageX-v.left,l.y=g.pageY-v.top;function m(y){var b=y.getBoundingClientRect(),x=window.pageXOffset||document.documentElement.scrollLeft,A=window.pageYOffset||document.documentElement.scrollTop;return{top:b.top+A,left:b.left+x}}},{passive:!0})}),a.addEventListener("pointerup",function(h){if(n.isPointerPressed){if(n.isPointerPressed=!1,n.isPointerDragging){n.isPointerDragging=!1;return}var g=[h,n.pointerDownEvent];requestAnimationFrame(function(){if(h.button===0)if(n.hoverObj){var v=n["on".concat(n.hoverObj.type,"Click")];v&&v.apply(void 0,[n.hoverObj.d].concat(g))}else n.onBackgroundClick&&n.onBackgroundClick.apply(n,g);if(h.button===2)if(n.hoverObj){var m=n["on".concat(n.hoverObj.type,"RightClick")];m&&m.apply(void 0,[n.hoverObj.d].concat(g))}else n.onBackgroundRightClick&&n.onBackgroundRightClick.apply(n,g)})}},{passive:!0}),a.addEventListener("contextmenu",function(h){return!n.onBackgroundRightClick&&!n.onNodeRightClick&&!n.onLinkRightClick?!0:(h.preventDefault(),!1)}),n.forceGraph(s),n.shadowGraph(o);var u=IO(function(){fC(o,n.width,n.height),n.shadowGraph.linkWidth(function(g){return Ut(n.linkWidth)(g)+n.linkHoverPrecision});var h=Yi(n.canvas);n.shadowGraph.globalScale(h.k).tickFrame()},O_);n.flushShadowCanvas=u.flush,(this._animationCycle=function h(){var g=!n.autoPauseRedraw||!!n.needsRedraw||n.forceGraph.isEngineRunning()||n.graphData.links.some(function(E){return E.__photons&&E.__photons.length});if(n.needsRedraw=!1,n.enablePointerInteraction){var v=n.isPointerDragging?null:c();if(v!==n.hoverObj){var m=n.hoverObj,y=m?m.type:null,b=v?v.type:null;if(y&&y!==b){var x=n["on".concat(y,"Hover")];x&&x(null,m.d)}if(b){var A=n["on".concat(b,"Hover")];A&&A(v.d,y===b?m.d:null)}n.tooltip.content(v&&Ut(n["".concat(v.type.toLowerCase(),"Label")])(v.d)||null),n.canvas.classList[(v&&n["on".concat(b,"Click")]||!v&&n.onBackgroundClick)&&Ut(n.showPointerCursor)(v?.d)?"add":"remove"]("clickable"),n.hoverObj=v}g&&u()}if(g){fC(s,n.width,n.height);var C=Yi(n.canvas).k;n.onRenderFramePre&&n.onRenderFramePre(s,C),n.forceGraph.globalScale(C).tickFrame(),n.onRenderFramePost&&n.onRenderFramePost(s,C)}n.tweenGroup.update(),n.animationFrameRequestId=requestAnimationFrame(h)})()},update:function(e){}});const j0={width:Q.number,height:Q.number,graphData:Q.shape({nodes:Q.arrayOf(Q.object).isRequired,links:Q.arrayOf(Q.object).isRequired}),backgroundColor:Q.string,nodeRelSize:Q.number,nodeId:Q.string,nodeLabel:Q.oneOfType([Q.string,Q.func]),nodeVal:Q.oneOfType([Q.number,Q.string,Q.func]),nodeVisibility:Q.oneOfType([Q.bool,Q.string,Q.func]),nodeColor:Q.oneOfType([Q.string,Q.func]),nodeAutoColorBy:Q.oneOfType([Q.string,Q.func]),onNodeHover:Q.func,onNodeClick:Q.func,linkSource:Q.string,linkTarget:Q.string,linkLabel:Q.oneOfType([Q.string,Q.func]),linkVisibility:Q.oneOfType([Q.bool,Q.string,Q.func]),linkColor:Q.oneOfType([Q.string,Q.func]),linkAutoColorBy:Q.oneOfType([Q.string,Q.func]),linkWidth:Q.oneOfType([Q.number,Q.string,Q.func]),linkCurvature:Q.oneOfType([Q.number,Q.string,Q.func]),linkDirectionalArrowLength:Q.oneOfType([Q.number,Q.string,Q.func]),linkDirectionalArrowColor:Q.oneOfType([Q.string,Q.func]),linkDirectionalArrowRelPos:Q.oneOfType([Q.number,Q.string,Q.func]),linkDirectionalParticles:Q.oneOfType([Q.number,Q.string,Q.func]),linkDirectionalParticleSpeed:Q.oneOfType([Q.number,Q.string,Q.func]),linkDirectionalParticleOffset:Q.oneOfType([Q.number,Q.string,Q.func]),linkDirectionalParticleWidth:Q.oneOfType([Q.number,Q.string,Q.func]),linkDirectionalParticleColor:Q.oneOfType([Q.string,Q.func]),onLinkHover:Q.func,onLinkClick:Q.func,dagMode:Q.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:Q.number,dagNodeFilter:Q.func,onDagError:Q.func,d3AlphaMin:Q.number,d3AlphaDecay:Q.number,d3VelocityDecay:Q.number,warmupTicks:Q.number,cooldownTicks:Q.number,cooldownTime:Q.number,onEngineTick:Q.func,onEngineStop:Q.func,getGraphBbox:Q.func},iT={zoomToFit:Q.func,onNodeRightClick:Q.func,onNodeDrag:Q.func,onNodeDragEnd:Q.func,onLinkRightClick:Q.func,linkHoverPrecision:Q.number,onBackgroundClick:Q.func,onBackgroundRightClick:Q.func,showPointerCursor:Q.oneOfType([Q.bool,Q.func]),enablePointerInteraction:Q.bool,enableNodeDrag:Q.bool},sy={showNavInfo:Q.bool,nodeOpacity:Q.number,nodeResolution:Q.number,nodeThreeObject:Q.oneOfType([Q.object,Q.string,Q.func]),nodeThreeObjectExtend:Q.oneOfType([Q.bool,Q.string,Q.func]),nodePositionUpdate:Q.func,linkOpacity:Q.number,linkResolution:Q.number,linkCurveRotation:Q.oneOfType([Q.number,Q.string,Q.func]),linkMaterial:Q.oneOfType([Q.object,Q.string,Q.func]),linkThreeObject:Q.oneOfType([Q.object,Q.string,Q.func]),linkThreeObjectExtend:Q.oneOfType([Q.bool,Q.string,Q.func]),linkPositionUpdate:Q.func,linkDirectionalArrowResolution:Q.number,linkDirectionalParticleResolution:Q.number,linkDirectionalParticleThreeObject:Q.oneOfType([Q.object,Q.string,Q.func]),forceEngine:Q.oneOf(["d3","ngraph"]),ngraphPhysics:Q.object,numDimensions:Q.oneOf([1,2,3])},Y_=Object.assign({},j0,iT,{linkLineDash:Q.oneOfType([Q.arrayOf(Q.number),Q.string,Q.func]),nodeCanvasObjectMode:Q.oneOfType([Q.string,Q.func]),nodeCanvasObject:Q.func,nodePointerAreaPaint:Q.func,linkCanvasObjectMode:Q.oneOfType([Q.string,Q.func]),linkCanvasObject:Q.func,linkPointerAreaPaint:Q.func,linkDirectionalParticleCanvasObject:Q.func,autoPauseRedraw:Q.bool,minZoom:Q.number,maxZoom:Q.number,enableZoomInteraction:Q.oneOfType([Q.bool,Q.func]),enablePanInteraction:Q.oneOfType([Q.bool,Q.func]),onZoom:Q.func,onZoomEnd:Q.func,onRenderFramePre:Q.func,onRenderFramePost:Q.func});Object.assign({},j0,iT,sy,{enableNavigationControls:Q.bool,controlType:Q.oneOf(["trackball","orbit","fly"]),rendererConfig:Q.object,extraRenderers:Q.arrayOf(Q.shape({render:Q.func.isRequired}))});Object.assign({},j0,sy,{nodeDesc:Q.oneOfType([Q.string,Q.func]),linkDesc:Q.oneOfType([Q.string,Q.func])});Object.assign({},j0,sy,{markerAttrs:Q.object,yOffset:Q.number,glScale:Q.number});const oy=w9(q_,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});oy.displayName="ForceGraph2D";oy.propTypes=Y_;function j_(r){if(!r)return"#34d399";const e=["#34d399","#60a5fa","#a855f7","#f97316","#f43f5e"],n=Math.abs([...r].reduce((i,a)=>i*17+a.charCodeAt(0),11));return e[n%e.length]}function ly({graph:r,onNodeSelect:e}){const n=Ne.useMemo(()=>({nodes:r.nodes.map(i=>({id:i.id,name:i.name,category:i.category,val:i.value??3,color:j_(i.category)})),links:r.links.map(i=>({id:i.id,source:i.source,target:i.target,label:i.label,confidence:i.confidence}))}),[r]);return J.jsx("div",{className:"force-graph-wrapper","data-testid":"force-graph-view",children:J.jsx(oy,{graphData:n,nodeLabel:i=>`${i.name}
${i.category??"unknown"}`,linkDirectionalParticles:2,linkDirectionalParticleWidth:i=>2+(i.confidence??.3)*2,linkDirectionalParticleSpeed:.005,linkColor:()=>"rgba(129, 199, 212, 0.7)",nodeRelSize:6,width:void 0,height:void 0,backgroundColor:"rgba(9, 13, 26, 0.85)",onNodeClick:i=>{e&&e(i.id)}})})}ly.propTypes={graph:Q.shape({nodes:Q.arrayOf(Q.shape({id:Q.string.isRequired,name:Q.string,category:Q.string,value:Q.number})),links:Q.arrayOf(Q.shape({id:Q.string,source:Q.oneOfType([Q.string,Q.object]).isRequired,target:Q.oneOfType([Q.string,Q.object]).isRequired,label:Q.string,confidence:Q.number}))}),onNodeSelect:Q.func};ly.defaultProps={graph:{nodes:[],links:[]},onNodeSelect:void 0};var H_=1e-6,Zr=typeof Float32Array<"u"?Float32Array:Array;function K_(){var r=new Zr(9);return Zr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function mo(r,e,n,i,a,s,o,l,c){var u=new Zr(9);return u[0]=r,u[1]=e,u[2]=n,u[3]=i,u[4]=a,u[5]=s,u[6]=o,u[7]=l,u[8]=c,u}function aT(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],c=e[5],u=e[6],h=e[7],g=e[8],v=n[0],m=n[1],y=n[2],b=n[3],x=n[4],A=n[5],C=n[6],E=n[7],S=n[8];return r[0]=v*i+m*o+y*u,r[1]=v*a+m*l+y*h,r[2]=v*s+m*c+y*g,r[3]=b*i+x*o+A*u,r[4]=b*a+x*l+A*h,r[5]=b*s+x*c+A*g,r[6]=C*i+E*o+S*u,r[7]=C*a+E*l+S*h,r[8]=C*s+E*c+S*g,r}function bt(){var r=new Zr(16);return Zr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function Er(r){var e=new Zr(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function X_(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Wn(r,e,n,i,a,s,o,l,c,u,h,g,v,m,y,b){var x=new Zr(16);return x[0]=r,x[1]=e,x[2]=n,x[3]=i,x[4]=a,x[5]=s,x[6]=o,x[7]=l,x[8]=c,x[9]=u,x[10]=h,x[11]=g,x[12]=v,x[13]=m,x[14]=y,x[15]=b,x}function sT(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Zn(r,e){if(r===e){var n=e[1],i=e[2],a=e[3],s=e[6],o=e[7],l=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=n,r[6]=e[9],r[7]=e[13],r[8]=i,r[9]=s,r[11]=e[14],r[12]=a,r[13]=o,r[14]=l}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function kn(r,e){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],c=e[6],u=e[7],h=e[8],g=e[9],v=e[10],m=e[11],y=e[12],b=e[13],x=e[14],A=e[15],C=n*l-i*o,E=n*c-a*o,S=n*u-s*o,M=i*c-a*l,R=i*u-s*l,T=a*u-s*c,B=h*b-g*y,F=h*x-v*y,I=h*A-m*y,U=g*x-v*b,k=g*A-m*b,O=v*A-m*x,V=C*O-E*k+S*U+M*I-R*F+T*B;return V?(V=1/V,r[0]=(l*O-c*k+u*U)*V,r[1]=(a*k-i*O-s*U)*V,r[2]=(b*T-x*R+A*M)*V,r[3]=(v*R-g*T-m*M)*V,r[4]=(c*I-o*O-u*F)*V,r[5]=(n*O-a*I+s*F)*V,r[6]=(x*S-y*T-A*E)*V,r[7]=(h*T-v*S+m*E)*V,r[8]=(o*k-l*I+u*B)*V,r[9]=(i*I-n*k-s*B)*V,r[10]=(y*R-b*S+A*C)*V,r[11]=(g*S-h*R-m*C)*V,r[12]=(l*F-o*U-c*B)*V,r[13]=(n*U-i*F+a*B)*V,r[14]=(b*E-y*M-x*C)*V,r[15]=(h*M-g*E+v*C)*V,r):null}function ys(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],c=e[5],u=e[6],h=e[7],g=e[8],v=e[9],m=e[10],y=e[11],b=e[12],x=e[13],A=e[14],C=e[15],E=n[0],S=n[1],M=n[2],R=n[3];return r[0]=E*i+S*l+M*g+R*b,r[1]=E*a+S*c+M*v+R*x,r[2]=E*s+S*u+M*m+R*A,r[3]=E*o+S*h+M*y+R*C,E=n[4],S=n[5],M=n[6],R=n[7],r[4]=E*i+S*l+M*g+R*b,r[5]=E*a+S*c+M*v+R*x,r[6]=E*s+S*u+M*m+R*A,r[7]=E*o+S*h+M*y+R*C,E=n[8],S=n[9],M=n[10],R=n[11],r[8]=E*i+S*l+M*g+R*b,r[9]=E*a+S*c+M*v+R*x,r[10]=E*s+S*u+M*m+R*A,r[11]=E*o+S*h+M*y+R*C,E=n[12],S=n[13],M=n[14],R=n[15],r[12]=E*i+S*l+M*g+R*b,r[13]=E*a+S*c+M*v+R*x,r[14]=E*s+S*u+M*m+R*A,r[15]=E*o+S*h+M*y+R*C,r}function Rl(r,e,n){var i=n[0],a=n[1],s=n[2],o,l,c,u,h,g,v,m,y,b,x,A;return e===r?(r[12]=e[0]*i+e[4]*a+e[8]*s+e[12],r[13]=e[1]*i+e[5]*a+e[9]*s+e[13],r[14]=e[2]*i+e[6]*a+e[10]*s+e[14],r[15]=e[3]*i+e[7]*a+e[11]*s+e[15]):(o=e[0],l=e[1],c=e[2],u=e[3],h=e[4],g=e[5],v=e[6],m=e[7],y=e[8],b=e[9],x=e[10],A=e[11],r[0]=o,r[1]=l,r[2]=c,r[3]=u,r[4]=h,r[5]=g,r[6]=v,r[7]=m,r[8]=y,r[9]=b,r[10]=x,r[11]=A,r[12]=o*i+h*a+y*s+e[12],r[13]=l*i+g*a+b*s+e[13],r[14]=c*i+v*a+x*s+e[14],r[15]=u*i+m*a+A*s+e[15]),r}function hC(r,e,n){var i=n[0],a=n[1],s=n[2];return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r[4]=e[4]*a,r[5]=e[5]*a,r[6]=e[6]*a,r[7]=e[7]*a,r[8]=e[8]*s,r[9]=e[9]*s,r[10]=e[10]*s,r[11]=e[11]*s,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function cd(r,e,n){var i=Math.sin(n),a=Math.cos(n),s=e[4],o=e[5],l=e[6],c=e[7],u=e[8],h=e[9],g=e[10],v=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=s*a+u*i,r[5]=o*a+h*i,r[6]=l*a+g*i,r[7]=c*a+v*i,r[8]=u*a-s*i,r[9]=h*a-o*i,r[10]=g*a-l*i,r[11]=v*a-c*i,r}function fd(r,e,n){var i=Math.sin(n),a=Math.cos(n),s=e[0],o=e[1],l=e[2],c=e[3],u=e[4],h=e[5],g=e[6],v=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*a+u*i,r[1]=o*a+h*i,r[2]=l*a+g*i,r[3]=c*a+v*i,r[4]=u*a-s*i,r[5]=h*a-o*i,r[6]=g*a-l*i,r[7]=v*a-c*i,r}function Q_(r,e,n){var i=n[0],a=n[1],s=n[2],o=Math.sqrt(i*i+a*a+s*s),l,c,u;return o<H_?null:(o=1/o,i*=o,a*=o,s*=o,l=Math.sin(e),c=Math.cos(e),u=1-c,r[0]=i*i*u+c,r[1]=a*i*u+s*l,r[2]=s*i*u-a*l,r[3]=0,r[4]=i*a*u-s*l,r[5]=a*a*u+c,r[6]=s*a*u+i*l,r[7]=0,r[8]=i*s*u+a*l,r[9]=a*s*u-i*l,r[10]=s*s*u+c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function Z_(r,e,n,i,a,s,o){var l=1/(e-n),c=1/(i-a),u=1/(s-o);return r[0]=-2*l,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*u,r[11]=0,r[12]=(e+n)*l,r[13]=(a+i)*c,r[14]=(o+s)*u,r[15]=1,r}var hd=Z_;function W_(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*n,r[9]=e[9]*n,r[10]=e[10]*n,r[11]=e[11]*n,r[12]=e[12]*n,r[13]=e[13]*n,r[14]=e[14]*n,r[15]=e[15]*n,r}var oT=ys;function Kt(){var r=new Zr(3);return Zr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Ri(r){var e=new Zr(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function Ts(r){var e=r[0],n=r[1],i=r[2];return Math.sqrt(e*e+n*n+i*i)}function Me(r,e,n){var i=new Zr(3);return i[0]=r,i[1]=e,i[2]=n,i}function dC(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function xo(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r}function Wt(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r}function uy(r,e,n){return r[0]=Math.min(e[0],n[0]),r[1]=Math.min(e[1],n[1]),r[2]=Math.min(e[2],n[2]),r}function cy(r,e,n){return r[0]=Math.max(e[0],n[0]),r[1]=Math.max(e[1],n[1]),r[2]=Math.max(e[2],n[2]),r}function J_(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r}function $_(r,e){var n=e[0]-r[0],i=e[1]-r[1],a=e[2]-r[2];return Math.sqrt(n*n+i*i+a*a)}function ez(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r}function yi(r,e){var n=e[0],i=e[1],a=e[2],s=n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r}function tz(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Pd(r,e,n){var i=e[0],a=e[1],s=e[2],o=n[0],l=n[1],c=n[2];return r[0]=a*c-s*l,r[1]=s*o-i*c,r[2]=i*l-a*o,r}function rz(r,e,n,i){var a=e[0],s=e[1],o=e[2];return r[0]=a+i*(n[0]-a),r[1]=s+i*(n[1]-s),r[2]=o+i*(n[2]-o),r}function ep(r,e){var n=r[0],i=r[1],a=r[2],s=e[0],o=e[1],l=e[2],c=Math.sqrt((n*n+i*i+a*a)*(s*s+o*o+l*l)),u=c&&tz(r,e)/c;return Math.acos(Math.min(Math.max(u,-1),1))}var gC=Wt,$c=Ts;(function(){var r=Kt();return function(e,n,i,a,s,o){var l,c;for(n||(n=3),i||(i=0),a?c=Math.min(a*n+i,e.length):c=e.length,l=i;l<c;l+=n)r[0]=e[l],r[1]=e[l+1],r[2]=e[l+2],s(r,r,o),e[l]=r[0],e[l+1]=r[1],e[l+2]=r[2];return e}})();function Qi(){var r=new Zr(4);return Zr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function ws(r){var e=new Zr(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function Jt(r,e,n,i){var a=new Zr(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=i,a}function vC(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r}function nz(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r}function iz(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r}function Kr(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3];return r[0]=n[0]*i+n[4]*a+n[8]*s+n[12]*o,r[1]=n[1]*i+n[5]*a+n[9]*s+n[13]*o,r[2]=n[2]*i+n[6]*a+n[10]*s+n[14]*o,r[3]=n[3]*i+n[7]*a+n[11]*s+n[15]*o,r}var az=nz;(function(){var r=Qi();return function(e,n,i,a,s,o){var l,c;for(n||(n=4),i||(i=0),a?c=Math.min(a*n+i,e.length):c=e.length,l=i;l<c;l+=n)r[0]=e[l],r[1]=e[l+1],r[2]=e[l+2],r[3]=e[l+3],s(r,r,o),e[l]=r[0],e[l+1]=r[1],e[l+2]=r[2],e[l+3]=r[3];return e}})();function sz(){var r=new Zr(2);return Zr!=Float32Array&&(r[0]=0,r[1]=0),r}function mC(r,e){var n=new Zr(2);return n[0]=r,n[1]=e,n}function oz(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r}function pC(r){var e=r[0],n=r[1];return Math.sqrt(e*e+n*n)}function lz(r,e){var n=e[0],i=e[1],a=n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),r[0]=e[0]*a,r[1]=e[1]*a,r}(function(){var r=sz();return function(e,n,i,a,s,o){var l,c;for(n||(n=2),i||(i=0),a?c=Math.min(a*n+i,e.length):c=e.length,l=i;l<c;l+=n)r[0]=e[l],r[1]=e[l+1],s(r,r,o),e[l]=r[0],e[l+1]=r[1];return e}})();var po=256,Ld=[],dd;for(;po--;)Ld[po]=(po+256).toString(16).substring(1);function l2(){var r=0,e,n="";if(!dd||po+16>256){for(dd=Array(r=256);r--;)dd[r]=256*Math.random()|0;r=po=0}for(;r<16;r++)e=dd[po+r],r==6?n+=Ld[e&15|64]:r==8?n+=Ld[e&63|128]:n+=Ld[e],r&1&&r>1&&r<11&&(n+="-");return po++,n}var tp,yC;function uz(){return yC||(yC=1,tp=function(e,n){var i=e.length;if(e===n)return!0;if(i!==n.length)return!1;for(var a=0;a<i;a++)if(e[a]!==n[a])return!1;return!0}),tp}var cz=uz();const fz=v2(cz),lT=-1,H0=0,Nc=1,y0=2,fy=3,hy=4,dy=5,gy=6,uT=7,cT=8,AC=typeof self=="object"?self:globalThis,hz=(r,e)=>{const n=(a,s)=>(r.set(s,a),a),i=a=>{if(r.has(a))return r.get(a);const[s,o]=e[a];switch(s){case H0:case lT:return n(o,a);case Nc:{const l=n([],a);for(const c of o)l.push(i(c));return l}case y0:{const l=n({},a);for(const[c,u]of o)l[i(c)]=i(u);return l}case fy:return n(new Date(o),a);case hy:{const{source:l,flags:c}=o;return n(new RegExp(l,c),a)}case dy:{const l=n(new Map,a);for(const[c,u]of o)l.set(i(c),i(u));return l}case gy:{const l=n(new Set,a);for(const c of o)l.add(i(c));return l}case uT:{const{name:l,message:c}=o;return n(new AC[l](c),a)}case cT:return n(BigInt(o),a);case"BigInt":return n(Object(BigInt(o)),a);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new AC[s](o),a)};return i},dz=r=>hz(new Map,r)(0),Sl="",{toString:gz}={},{keys:vz}=Object,lc=r=>{const e=typeof r;if(e!=="object"||!r)return[H0,e];const n=gz.call(r).slice(8,-1);switch(n){case"Array":return[Nc,Sl];case"Object":return[y0,Sl];case"Date":return[fy,Sl];case"RegExp":return[hy,Sl];case"Map":return[dy,Sl];case"Set":return[gy,Sl];case"DataView":return[Nc,n]}return n.includes("Array")?[Nc,n]:n.includes("Error")?[uT,n]:[y0,n]},gd=([r,e])=>r===H0&&(e==="function"||e==="symbol"),mz=(r,e,n,i)=>{const a=(o,l)=>{const c=i.push(o)-1;return n.set(l,c),c},s=o=>{if(n.has(o))return n.get(o);let[l,c]=lc(o);switch(l){case H0:{let h=o;switch(c){case"bigint":l=cT,h=o.toString();break;case"function":case"symbol":if(r)throw new TypeError("unable to serialize "+c);h=null;break;case"undefined":return a([lT],o)}return a([l,h],o)}case Nc:{if(c){let v=o;return c==="DataView"?v=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(v=new Uint8Array(o)),a([c,[...v]],o)}const h=[],g=a([l,h],o);for(const v of o)h.push(s(v));return g}case y0:{if(c)switch(c){case"BigInt":return a([c,o.toString()],o);case"Boolean":case"Number":case"String":return a([c,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const h=[],g=a([l,h],o);for(const v of vz(o))(r||!gd(lc(o[v])))&&h.push([s(v),s(o[v])]);return g}case fy:return a([l,o.toISOString()],o);case hy:{const{source:h,flags:g}=o;return a([l,{source:h,flags:g}],o)}case dy:{const h=[],g=a([l,h],o);for(const[v,m]of o)(r||!(gd(lc(v))||gd(lc(m))))&&h.push([s(v),s(m)]);return g}case gy:{const h=[],g=a([l,h],o);for(const v of o)(r||!gd(lc(v)))&&h.push(s(v));return g}}const{message:u}=o;return a([l,{name:c,message:u}],o)};return s},pz=(r,{json:e,lossy:n}={})=>{const i=[];return mz(!(e||n),!!e,new Map,i)(r),i};var Xr=Uint8Array,Ul=Uint16Array,yz=Int32Array,fT=new Xr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hT=new Xr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Az=new Xr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),dT=function(r,e){for(var n=new Ul(31),i=0;i<31;++i)n[i]=e+=1<<r[i-1];for(var a=new yz(n[30]),i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)a[s]=s-n[i]<<5|i;return{b:n,r:a}},gT=dT(fT,2),vT=gT.b,xz=gT.r;vT[28]=258,xz[258]=28;var bz=dT(hT,0),wz=bz.b,u2=new Ul(32768);for(var nr=0;nr<32768;++nr){var hs=(nr&43690)>>1|(nr&21845)<<1;hs=(hs&52428)>>2|(hs&13107)<<2,hs=(hs&61680)>>4|(hs&3855)<<4,u2[nr]=((hs&65280)>>8|(hs&255)<<8)>>1}var Fc=(function(r,e,n){for(var i=r.length,a=0,s=new Ul(e);a<i;++a)r[a]&&++s[r[a]-1];var o=new Ul(e);for(a=1;a<e;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(n){l=new Ul(1<<e);var c=15-e;for(a=0;a<i;++a)if(r[a])for(var u=a<<4|r[a],h=e-r[a],g=o[r[a]-1]++<<h,v=g|(1<<h)-1;g<=v;++g)l[u2[g]>>c]=u}else for(l=new Ul(i),a=0;a<i;++a)r[a]&&(l[a]=u2[o[r[a]-1]++]>>15-r[a]);return l}),yf=new Xr(288);for(var nr=0;nr<144;++nr)yf[nr]=8;for(var nr=144;nr<256;++nr)yf[nr]=9;for(var nr=256;nr<280;++nr)yf[nr]=7;for(var nr=280;nr<288;++nr)yf[nr]=8;var mT=new Xr(32);for(var nr=0;nr<32;++nr)mT[nr]=5;var Cz=Fc(yf,9,1),Ez=Fc(mT,5,1),rp=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},Ci=function(r,e,n){var i=e/8|0;return(r[i]|r[i+1]<<8)>>(e&7)&n},np=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},pT=function(r){return(r+7)/8|0},_d=function(r,e,n){return(e==null||e<0)&&(e=0),(n==null||n>r.length)&&(n=r.length),new Xr(r.subarray(e,n))},Sz=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],xn=function(r,e,n){var i=new Error(e||Sz[r]);if(i.code=r,Error.captureStackTrace&&Error.captureStackTrace(i,xn),!n)throw i;return i},K0=function(r,e,n,i){var a=r.length,s=0;if(!a||e.f&&!e.l)return n||new Xr(0);var o=!n,l=o||e.i!=2,c=e.i;o&&(n=new Xr(a*3));var u=function(se){var fe=n.length;if(se>fe){var xe=new Xr(Math.max(fe*2,se));xe.set(n),n=xe}},h=e.f||0,g=e.p||0,v=e.b||0,m=e.l,y=e.d,b=e.m,x=e.n,A=a*8;do{if(!m){h=Ci(r,g,1);var C=Ci(r,g+1,3);if(g+=3,C)if(C==1)m=Cz,y=Ez,b=9,x=5;else if(C==2){var R=Ci(r,g,31)+257,T=Ci(r,g+10,15)+4,B=R+Ci(r,g+5,31)+1;g+=14;for(var F=new Xr(B),I=new Xr(19),U=0;U<T;++U)I[Az[U]]=Ci(r,g+U*3,7);g+=T*3;for(var k=rp(I),O=(1<<k)-1,V=Fc(I,k,1),U=0;U<B;){var L=V[Ci(r,g,O)];g+=L&15;var E=L>>4;if(E<16)F[U++]=E;else{var P=0,_=0;for(E==16?(_=3+Ci(r,g,3),g+=2,P=F[U-1]):E==17?(_=3+Ci(r,g,7),g+=3):E==18&&(_=11+Ci(r,g,127),g+=7);_--;)F[U++]=P}}var q=F.subarray(0,R),H=F.subarray(R);b=rp(q),x=rp(H),m=Fc(q,b,1),y=Fc(H,x,1)}else xn(1);else{var E=pT(g)+4,S=r[E-4]|r[E-3]<<8,M=E+S;if(M>a){c&&xn(0);break}l&&u(v+S),n.set(r.subarray(E,M),v),e.b=v+=S,e.p=g=M*8,e.f=h;continue}if(g>A){c&&xn(0);break}}l&&u(v+131072);for(var W=(1<<b)-1,G=(1<<x)-1,K=g;;K=g){var P=m[np(r,g)&W],$=P>>4;if(g+=P&15,g>A){c&&xn(0);break}if(P||xn(2),$<256)n[v++]=$;else if($==256){K=g,m=null;break}else{var te=$-254;if($>264){var U=$-257,ae=fT[U];te=Ci(r,g,(1<<ae)-1)+vT[U],g+=ae}var ue=y[np(r,g)&G],re=ue>>4;ue||xn(3),g+=ue&15;var H=wz[re];if(re>3){var ae=hT[re];H+=np(r,g)&(1<<ae)-1,g+=ae}if(g>A){c&&xn(0);break}l&&u(v+131072);var ve=v+te;if(v<H){var le=s-H,ie=Math.min(H,ve);for(le+v<0&&xn(3);v<ie;++v)n[v]=i[le+v]}for(;v<ve;++v)n[v]=n[v-H]}}e.l=m,e.p=K,e.b=v,e.f=h,m&&(h=1,e.m=b,e.d=y,e.n=x)}while(!h);return v!=n.length&&o?_d(n,0,v):n.subarray(0,v)},Tz=new Xr(0),yT=function(r){(r[0]!=31||r[1]!=139||r[2]!=8)&&xn(6,"invalid gzip data");var e=r[3],n=10;e&4&&(n+=(r[10]|r[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!r[n++]);return n+(e&2)},Mz=function(r){var e=r.length;return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0},Dz=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&xn(6,"invalid zlib data"),(r[1]>>5&1)==1&&xn(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2},ip=(function(){function r(e,n){typeof e=="function"&&(n=e,e={}),this.ondata=n;var i=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:i?i.length:0},this.o=new Xr(32768),this.p=new Xr(0),i&&this.o.set(i)}return r.prototype.e=function(e){if(this.ondata||xn(5),this.d&&xn(4),!this.p.length)this.p=e;else if(e.length){var n=new Xr(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length),this.p=n}},r.prototype.c=function(e){this.s.i=+(this.d=e||!1);var n=this.s.b,i=K0(this.p,this.s,this.o);this.ondata(_d(i,n,this.s.b),this.d),this.o=_d(i,this.s.b-32768),this.s.b=this.o.length,this.p=_d(this.p,this.s.p/8|0),this.s.p&=7},r.prototype.push=function(e,n){this.e(e),this.c(n)},r})();function Rz(r,e){return K0(r,{i:2},e,e)}var Bz=(function(){function r(e,n){this.v=1,this.r=0,ip.call(this,e,n)}return r.prototype.push=function(e,n){if(ip.prototype.e.call(this,e),this.r+=e.length,this.v){var i=this.p.subarray(this.v-1),a=i.length>3?yT(i):4;if(a>i.length){if(!n)return}else this.v>1&&this.onmember&&this.onmember(this.r-i.length);this.p=i.subarray(a),this.v=0}ip.prototype.c.call(this,n),this.s.f&&!this.s.l&&!n&&(this.v=pT(this.s.p)+9,this.s={i:0},this.o=new Xr(0),this.push(new Xr(0),n))},r})();function Iz(r,e){var n=yT(r);return n+8>r.length&&xn(6,"invalid gzip data"),K0(r.subarray(n,-8),{i:2},new Xr(Mz(r)),e)}function Nz(r,e){return K0(r.subarray(Dz(r),-4),{i:2},e,e)}function Fz(r,e){return r[0]==31&&r[1]==139&&r[2]==8?Iz(r,e):(r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31?Rz(r,e):Nz(r,e)}var kz=typeof TextDecoder<"u"&&new TextDecoder,Uz=0;try{kz.decode(Tz,{stream:!0}),Uz=1}catch{}class AT{esize;ecode;edata;littleEndian;constructor(e,n,i,a){if(e%16!=0)throw new Error("This does not appear to be a NIFTI extension");this.esize=e,this.ecode=n,this.edata=i,this.littleEndian=a}toArrayBuffer(){let e=new Uint8Array(this.esize),n=new Uint8Array(this.edata);e.set(n,8);let i=new DataView(e.buffer);return i.setInt32(0,this.esize,this.littleEndian),i.setInt32(4,this.ecode,this.littleEndian),e.buffer}}class Te{static crcTable=null;static GUNZIP_MAGIC_COOKIE1=31;static GUNZIP_MAGIC_COOKIE2=139;static getStringAt(e,n,i){var a="",s,o;for(s=n;s<i;s+=1)o=e.getUint8(s),o!==0&&(a+=String.fromCharCode(o));return a}static getByteAt=function(e,n){return e.getUint8(n)};static getShortAt=function(e,n,i){return e.getInt16(n,i)};static getIntAt(e,n,i){return e.getInt32(n,i)}static getFloatAt(e,n,i){return e.getFloat32(n,i)}static getDoubleAt(e,n,i){return e.getFloat64(n,i)}static getInt64At(e,n,i){const a=e.getUint32(n,i),s=e.getInt32(n+4,i);let o;return i?o=s*2**32+a:o=a*2**32+s,s<0&&(o+=-1*2**32*2**32),o}static getUint64At(e,n,i){const a=e.getUint32(n+(i?0:4),i),s=e.getUint32(n+(i?4:0),i);return i?s*2**32+a:a*2**32+s}static getExtensionsAt(e,n,i,a){let s=[],o=n;for(;o<a;){let l=i,c=Te.getIntAt(e,o,i);if(!c)break;if(c+o>a&&(l=!l,c=Te.getIntAt(e,o,l),c+o>a))throw new Error("This does not appear to be a valid NIFTI extension");if(c%16!=0)throw new Error("This does not appear to be a NIFTI extension");let u=Te.getIntAt(e,o+4,l),h=e.buffer.slice(o+8,o+c),g=new AT(c,u,h,l);s.push(g),o+=c}return s}static toArrayBuffer(e){var n,i,a;for(n=new ArrayBuffer(e.length),i=new Uint8Array(n),a=0;a<e.length;a+=1)i[a]=e[a];return n}static isString(e){return typeof e=="string"||e instanceof String}static formatNumber(e,n=void 0){let i;return Te.isString(e)?i=Number(e):i=e,n?i=i.toPrecision(5):i=i.toPrecision(7),parseFloat(i)}static makeCRCTable(){let e,n=[];for(var i=0;i<256;i++){e=i;for(var a=0;a<8;a++)e=e&1?3988292384^e>>>1:e>>>1;n[i]=e}return n}static crc32(e){Te.crcTable||(Te.crcTable=Te.makeCRCTable());const n=Te.crcTable;let i=-1;for(var a=0;a<e.byteLength;a++)i=i>>>8^n[(i^e.getUint8(a))&255];return(i^-1)>>>0}}class Fe{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_a=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];qfac=1;quatern_R;magic="0";isHDR=!1;extensionFlag=[0,0,0,0];extensionSize=0;extensionCode=0;extensions=[];static TYPE_NONE=0;static TYPE_BINARY=1;static TYPE_UINT8=2;static TYPE_INT16=4;static TYPE_INT32=8;static TYPE_FLOAT32=16;static TYPE_COMPLEX64=32;static TYPE_FLOAT64=64;static TYPE_RGB24=128;static TYPE_INT8=256;static TYPE_UINT16=512;static TYPE_UINT32=768;static TYPE_INT64=1024;static TYPE_UINT64=1280;static TYPE_FLOAT128=1536;static TYPE_COMPLEX128=1792;static TYPE_COMPLEX256=2048;static XFORM_UNKNOWN=0;static XFORM_SCANNER_ANAT=1;static XFORM_ALIGNED_ANAT=2;static XFORM_TALAIRACH=3;static XFORM_MNI_152=4;static SPATIAL_UNITS_MASK=7;static TEMPORAL_UNITS_MASK=56;static UNITS_UNKNOWN=0;static UNITS_METER=1;static UNITS_MM=2;static UNITS_MICRON=3;static UNITS_SEC=8;static UNITS_MSEC=16;static UNITS_USEC=24;static UNITS_HZ=32;static UNITS_PPM=40;static UNITS_RADS=48;static MAGIC_COOKIE=348;static STANDARD_HEADER_SIZE=348;static MAGIC_NUMBER_LOCATION=344;static MAGIC_NUMBER=[110,43,49];static MAGIC_NUMBER2=[110,105,49];static EXTENSION_HEADER_SIZE=8;readHeader(e){var n=new DataView(e),i=Te.getIntAt(n,0,this.littleEndian),a,s,o,l;if(i!==Fe.MAGIC_COOKIE&&(this.littleEndian=!0,i=Te.getIntAt(n,0,this.littleEndian)),i!==Fe.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=Te.getByteAt(n,39),a=0;a<8;a+=1)l=40+a*2,this.dims[a]=Te.getShortAt(n,l,this.littleEndian);for(this.intent_p1=Te.getFloatAt(n,56,this.littleEndian),this.intent_p2=Te.getFloatAt(n,60,this.littleEndian),this.intent_p3=Te.getFloatAt(n,64,this.littleEndian),this.intent_code=Te.getShortAt(n,68,this.littleEndian),this.datatypeCode=Te.getShortAt(n,70,this.littleEndian),this.numBitsPerVoxel=Te.getShortAt(n,72,this.littleEndian),this.slice_start=Te.getShortAt(n,74,this.littleEndian),a=0;a<8;a+=1)l=76+a*4,this.pixDims[a]=Te.getFloatAt(n,l,this.littleEndian);if(this.vox_offset=Te.getFloatAt(n,108,this.littleEndian),this.scl_slope=Te.getFloatAt(n,112,this.littleEndian),this.scl_inter=Te.getFloatAt(n,116,this.littleEndian),this.slice_end=Te.getShortAt(n,120,this.littleEndian),this.slice_code=Te.getByteAt(n,122),this.xyzt_units=Te.getByteAt(n,123),this.cal_max=Te.getFloatAt(n,124,this.littleEndian),this.cal_min=Te.getFloatAt(n,128,this.littleEndian),this.slice_duration=Te.getFloatAt(n,132,this.littleEndian),this.toffset=Te.getFloatAt(n,136,this.littleEndian),this.description=Te.getStringAt(n,148,228),this.aux_file=Te.getStringAt(n,228,252),this.qform_code=Te.getShortAt(n,252,this.littleEndian),this.sform_code=Te.getShortAt(n,254,this.littleEndian),this.quatern_b=Te.getFloatAt(n,256,this.littleEndian),this.quatern_c=Te.getFloatAt(n,260,this.littleEndian),this.quatern_d=Te.getFloatAt(n,264,this.littleEndian),this.quatern_a=Math.sqrt(1-(Math.pow(this.quatern_b,2)+Math.pow(this.quatern_c,2)+Math.pow(this.quatern_d,2))),this.qoffset_x=Te.getFloatAt(n,268,this.littleEndian),this.qoffset_y=Te.getFloatAt(n,272,this.littleEndian),this.qoffset_z=Te.getFloatAt(n,276,this.littleEndian),this.qform_code<1&&this.sform_code<1&&(this.affine[0][0]=this.pixDims[1],this.affine[1][1]=this.pixDims[2],this.affine[2][2]=this.pixDims[3]),this.qform_code>0&&this.sform_code<this.qform_code){const c=this.quatern_a,u=this.quatern_b,h=this.quatern_c,g=this.quatern_d;for(this.qfac=this.pixDims[0]===0?1:this.pixDims[0],this.quatern_R=[[c*c+u*u-h*h-g*g,2*u*h-2*c*g,2*u*g+2*c*h],[2*u*h+2*c*g,c*c+h*h-u*u-g*g,2*h*g-2*c*u],[2*u*g-2*c*h,2*h*g+2*c*u,c*c+g*g-h*h-u*u]],s=0;s<3;s+=1)for(o=0;o<3;o+=1)this.affine[s][o]=this.quatern_R[s][o]*this.pixDims[o+1],o===2&&(this.affine[s][o]*=this.qfac);this.affine[0][3]=this.qoffset_x,this.affine[1][3]=this.qoffset_y,this.affine[2][3]=this.qoffset_z}else if(this.sform_code>0)for(s=0;s<3;s+=1)for(o=0;o<4;o+=1)l=280+(s*4+o)*4,this.affine[s][o]=Te.getFloatAt(n,l,this.littleEndian);if(this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=Te.getStringAt(n,328,344),this.magic=Te.getStringAt(n,344,348),this.isHDR=this.magic===String.fromCharCode.apply(null,Fe.MAGIC_NUMBER2),n.byteLength>Fe.MAGIC_COOKIE){this.extensionFlag[0]=Te.getByteAt(n,348),this.extensionFlag[1]=Te.getByteAt(n,349),this.extensionFlag[2]=Te.getByteAt(n,350),this.extensionFlag[3]=Te.getByteAt(n,351);let c=!0;!this.isHDR&&this.vox_offset<=352&&(c=!1),n.byteLength<=368&&(c=!1),c&&this.extensionFlag[0]&&(this.extensions=Te.getExtensionsAt(n,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode)}}toFormattedString(){var e=Te.formatNumber,n="";return n+="Dim Info = "+this.dim_info+`
`,n+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,n+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,n+="Intent Code = "+this.intent_code+`
`,n+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,n+="Bits Per Voxel = "+this.numBitsPerVoxel+`
`,n+="Slice Start = "+this.slice_start+`
`,n+="Voxel Dimensions (1-8): "+e(this.pixDims[0])+", "+e(this.pixDims[1])+", "+e(this.pixDims[2])+", "+e(this.pixDims[3])+", "+e(this.pixDims[4])+", "+e(this.pixDims[5])+", "+e(this.pixDims[6])+", "+e(this.pixDims[7])+`
`,n+="Image Offset = "+this.vox_offset+`
`,n+="Data Scale:  Slope = "+e(this.scl_slope)+"  Intercept = "+e(this.scl_inter)+`
`,n+="Slice End = "+this.slice_end+`
`,n+="Slice Code = "+this.slice_code+`
`,n+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(Fe.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(Fe.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,n+="Display Range:  Max = "+e(this.cal_max)+"  Min = "+e(this.cal_min)+`
`,n+="Slice Duration = "+this.slice_duration+`
`,n+="Time Axis Shift = "+this.toffset+`
`,n+='Description: "'+this.description+`"
`,n+='Auxiliary File: "'+this.aux_file+`"
`,n+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,n+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,n+="Quaternion Parameters:  b = "+e(this.quatern_b)+"  c = "+e(this.quatern_c)+"  d = "+e(this.quatern_d)+`
`,n+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,n+="S-Form Parameters X: "+e(this.affine[0][0])+", "+e(this.affine[0][1])+", "+e(this.affine[0][2])+", "+e(this.affine[0][3])+`
`,n+="S-Form Parameters Y: "+e(this.affine[1][0])+", "+e(this.affine[1][1])+", "+e(this.affine[1][2])+", "+e(this.affine[1][3])+`
`,n+="S-Form Parameters Z: "+e(this.affine[2][0])+", "+e(this.affine[2][1])+", "+e(this.affine[2][2])+", "+e(this.affine[2][3])+`
`,n+='Intent Name: "'+this.intent_name+`"
`,this.extensionFlag[0]&&(n+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+`
`),n}getDatatypeCodeString=function(e){return e===Fe.TYPE_UINT8?"1-Byte Unsigned Integer":e===Fe.TYPE_INT16?"2-Byte Signed Integer":e===Fe.TYPE_INT32?"4-Byte Signed Integer":e===Fe.TYPE_FLOAT32?"4-Byte Float":e===Fe.TYPE_FLOAT64?"8-Byte Float":e===Fe.TYPE_RGB24?"RGB":e===Fe.TYPE_INT8?"1-Byte Signed Integer":e===Fe.TYPE_UINT16?"2-Byte Unsigned Integer":e===Fe.TYPE_UINT32?"4-Byte Unsigned Integer":e===Fe.TYPE_INT64?"8-Byte Signed Integer":e===Fe.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"};getTransformCodeString=function(e){return e===Fe.XFORM_SCANNER_ANAT?"Scanner":e===Fe.XFORM_ALIGNED_ANAT?"Aligned":e===Fe.XFORM_TALAIRACH?"Talairach":e===Fe.XFORM_MNI_152?"MNI":"Unknown"};getUnitsCodeString=function(e){return e===Fe.UNITS_METER?"Meters":e===Fe.UNITS_MM?"Millimeters":e===Fe.UNITS_MICRON?"Microns":e===Fe.UNITS_SEC?"Seconds":e===Fe.UNITS_MSEC?"Milliseconds":e===Fe.UNITS_USEC?"Microseconds":e===Fe.UNITS_HZ?"Hz":e===Fe.UNITS_PPM?"PPM":e===Fe.UNITS_RADS?"Rads":"Unknown"};getQformMat(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])}convertNiftiQFormToNiftiSForm(e,n,i,a,s,o,l,c,u,h){var g=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],v,m=e,y=n,b=i,x,A,C;return g[3][0]=g[3][1]=g[3][2]=0,g[3][3]=1,v=1-(m*m+y*y+b*b),v<1e-7?(v=1/Math.sqrt(m*m+y*y+b*b),m*=v,y*=v,b*=v,v=0):v=Math.sqrt(v),x=l>0?l:1,A=c>0?c:1,C=u>0?u:1,h<0&&(C=-C),g[0][0]=(v*v+m*m-y*y-b*b)*x,g[0][1]=2*(m*y-v*b)*A,g[0][2]=2*(m*b+v*y)*C,g[1][0]=2*(m*y+v*b)*x,g[1][1]=(v*v+y*y-m*m-b*b)*A,g[1][2]=2*(y*b-v*m)*C,g[2][0]=2*(m*b-v*y)*x,g[2][1]=2*(y*b+v*m)*A,g[2][2]=(v*v+b*b-y*y-m*m)*C,g[0][3]=a,g[1][3]=s,g[2][3]=o,g}convertNiftiSFormToNEMA(e){var n,i,a,s,o,l,c,u,h,g,v,m,y,b,x,A,C,E,S,M,R,T,B,F,I,U,k,O,V,L,P,_,q,H;if(x=0,k=[[0,0,0],[0,0,0],[0,0,0]],O=[[0,0,0],[0,0,0],[0,0,0]],n=e[0][0],i=e[0][1],a=e[0][2],s=e[1][0],o=e[1][1],l=e[1][2],c=e[2][0],u=e[2][1],h=e[2][2],g=Math.sqrt(n*n+s*s+c*c),g===0||(n/=g,s/=g,c/=g,g=Math.sqrt(i*i+o*o+u*u),g===0))return null;if(i/=g,o/=g,u/=g,g=n*i+s*o+c*u,Math.abs(g)>1e-4){if(i-=g*n,o-=g*s,u-=g*c,g=Math.sqrt(i*i+o*o+u*u),g===0)return null;i/=g,o/=g,u/=g}if(g=Math.sqrt(a*a+l*l+h*h),g===0?(a=s*u-c*o,l=c*i-u*n,h=n*o-s*i):(a/=g,l/=g,h/=g),g=n*a+s*l+c*h,Math.abs(g)>1e-4){if(a-=g*n,l-=g*s,h-=g*c,g=Math.sqrt(a*a+l*l+h*h),g===0)return null;a/=g,l/=g,h/=g}if(g=i*a+o*l+u*h,Math.abs(g)>1e-4){if(a-=g*i,l-=g*o,h-=g*u,g=Math.sqrt(a*a+l*l+h*h),g===0)return null;a/=g,l/=g,h/=g}if(k[0][0]=n,k[0][1]=i,k[0][2]=a,k[1][0]=s,k[1][1]=o,k[1][2]=l,k[2][0]=c,k[2][1]=u,k[2][2]=h,v=this.nifti_mat33_determ(k),v===0)return null;for(U=-666,S=T=B=F=1,M=2,R=3,y=1;y<=3;y+=1)for(b=1;b<=3;b+=1)if(y!==b){for(x=1;x<=3;x+=1)if(!(y===x||b===x))for(O[0][0]=O[0][1]=O[0][2]=O[1][0]=O[1][1]=O[1][2]=O[2][0]=O[2][1]=O[2][2]=0,A=-1;A<=1;A+=2)for(C=-1;C<=1;C+=2)for(E=-1;E<=1;E+=2)O[0][y-1]=A,O[1][b-1]=C,O[2][x-1]=E,m=this.nifti_mat33_determ(O),m*v>0&&(I=this.nifti_mat33_mul(O,k),g=I[0][0]+I[1][1]+I[2][2],g>U&&(U=g,S=y,M=b,R=x,T=A,B=C,F=E))}switch(V=L=P=_=q=H="",S*T){case 1:V="X",_="+";break;case-1:V="X",_="-";break;case 2:V="Y",_="+";break;case-2:V="Y",_="-";break;case 3:V="Z",_="+";break;case-3:V="Z",_="-";break}switch(M*B){case 1:L="X",q="+";break;case-1:L="X",q="-";break;case 2:L="Y",q="+";break;case-2:L="Y",q="-";break;case 3:L="Z",q="+";break;case-3:L="Z",q="-";break}switch(R*F){case 1:P="X",H="+";break;case-1:P="X",H="-";break;case 2:P="Y",H="+";break;case-2:P="Y",H="-";break;case 3:P="Z",H="+";break;case-3:P="Z",H="-";break}return V+L+P+_+q+H}nifti_mat33_mul=function(e,n){var i=[[0,0,0],[0,0,0],[0,0,0]],a,s;for(a=0;a<3;a+=1)for(s=0;s<3;s+=1)i[a][s]=e[a][0]*n[0][s]+e[a][1]*n[1][s]+e[a][2]*n[2][s];return i};nifti_mat33_determ=function(e){var n,i,a,s,o,l,c,u,h;return n=e[0][0],i=e[0][1],a=e[0][2],s=e[1][0],o=e[1][1],l=e[1][2],c=e[2][0],u=e[2][1],h=e[2][2],n*o*h-n*u*l-s*i*h+s*u*a+c*i*l-c*o*a};getExtensionLocation(){return Fe.MAGIC_COOKIE+4}getExtensionSize(e){return Te.getIntAt(e,this.getExtensionLocation(),this.littleEndian)}getExtensionCode(e){return Te.getIntAt(e,this.getExtensionLocation()+4,this.littleEndian)}addExtension(e,n=-1){n==-1?this.extensions.push(e):this.extensions.splice(n,0,e),this.vox_offset+=e.esize}removeExtension(e){let n=this.extensions[e];n&&(this.vox_offset-=n.esize),this.extensions.splice(e,1)}toArrayBuffer(e=!1){let a=352;if(e)for(let c of this.extensions)a+=c.esize;let s=new Uint8Array(a),o=new DataView(s.buffer);o.setInt32(0,348,this.littleEndian),o.setUint8(39,this.dim_info);for(let c=0;c<8;c++)o.setUint16(40+2*c,this.dims[c],this.littleEndian);o.setFloat32(56,this.intent_p1,this.littleEndian),o.setFloat32(60,this.intent_p2,this.littleEndian),o.setFloat32(64,this.intent_p3,this.littleEndian),o.setInt16(68,this.intent_code,this.littleEndian),o.setInt16(70,this.datatypeCode,this.littleEndian),o.setInt16(72,this.numBitsPerVoxel,this.littleEndian),o.setInt16(74,this.slice_start,this.littleEndian);for(let c=0;c<8;c++)o.setFloat32(76+4*c,this.pixDims[c],this.littleEndian);o.setFloat32(108,this.vox_offset,this.littleEndian),o.setFloat32(112,this.scl_slope,this.littleEndian),o.setFloat32(116,this.scl_inter,this.littleEndian),o.setInt16(120,this.slice_end,this.littleEndian),o.setUint8(122,this.slice_code),o.setUint8(123,this.xyzt_units),o.setFloat32(124,this.cal_max,this.littleEndian),o.setFloat32(128,this.cal_min,this.littleEndian),o.setFloat32(132,this.slice_duration,this.littleEndian),o.setFloat32(136,this.toffset,this.littleEndian),s.set(new TextEncoder().encode(this.description),148),s.set(new TextEncoder().encode(this.aux_file),228),o.setInt16(252,this.qform_code,this.littleEndian),o.setInt16(254,this.sform_code,this.littleEndian),o.setFloat32(256,this.quatern_b,this.littleEndian),o.setFloat32(260,this.quatern_c,this.littleEndian),o.setFloat32(264,this.quatern_d,this.littleEndian),o.setFloat32(268,this.qoffset_x,this.littleEndian),o.setFloat32(272,this.qoffset_y,this.littleEndian),o.setFloat32(276,this.qoffset_z,this.littleEndian);const l=this.affine.flat();for(let c=0;c<12;c++)o.setFloat32(280+4*c,l[c],this.littleEndian);if(s.set(new TextEncoder().encode(this.intent_name),328),s.set(new TextEncoder().encode(this.magic),344),e){s.set(Uint8Array.from([1,0,0,0]),348);let c=this.getExtensionLocation();for(const u of this.extensions)o.setInt32(c,u.esize,u.littleEndian),o.setInt32(c+4,u.ecode,u.littleEndian),s.set(new Uint8Array(u.edata),c+8),c+=u.esize}else s.set(new Uint8Array(4).fill(0),348);return s.buffer}}class nn{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];magic="0";extensionFlag=[0,0,0,0];extensions=[];extensionSize=0;extensionCode=0;static MAGIC_COOKIE=540;static MAGIC_NUMBER_LOCATION=4;static MAGIC_NUMBER=[110,43,50,0,13,10,26,10];static MAGIC_NUMBER2=[110,105,50,0,13,10,26,10];readHeader(e){var n=new DataView(e),i=Te.getIntAt(n,0,this.littleEndian),a,s,o,l;if(i!==nn.MAGIC_COOKIE&&(this.littleEndian=!0,i=Te.getIntAt(n,0,this.littleEndian)),i!==nn.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.magic=Te.getStringAt(n,4,12),this.datatypeCode=Te.getShortAt(n,12,this.littleEndian),this.numBitsPerVoxel=Te.getShortAt(n,14,this.littleEndian),a=0;a<8;a+=1)l=16+a*8,this.dims[a]=Te.getInt64At(n,l,this.littleEndian);for(this.intent_p1=Te.getDoubleAt(n,80,this.littleEndian),this.intent_p2=Te.getDoubleAt(n,88,this.littleEndian),this.intent_p3=Te.getDoubleAt(n,96,this.littleEndian),a=0;a<8;a+=1)l=104+a*8,this.pixDims[a]=Te.getDoubleAt(n,l,this.littleEndian);for(this.vox_offset=Te.getInt64At(n,168,this.littleEndian),this.scl_slope=Te.getDoubleAt(n,176,this.littleEndian),this.scl_inter=Te.getDoubleAt(n,184,this.littleEndian),this.cal_max=Te.getDoubleAt(n,192,this.littleEndian),this.cal_min=Te.getDoubleAt(n,200,this.littleEndian),this.slice_duration=Te.getDoubleAt(n,208,this.littleEndian),this.toffset=Te.getDoubleAt(n,216,this.littleEndian),this.slice_start=Te.getInt64At(n,224,this.littleEndian),this.slice_end=Te.getInt64At(n,232,this.littleEndian),this.description=Te.getStringAt(n,240,320),this.aux_file=Te.getStringAt(n,320,344),this.qform_code=Te.getIntAt(n,344,this.littleEndian),this.sform_code=Te.getIntAt(n,348,this.littleEndian),this.quatern_b=Te.getDoubleAt(n,352,this.littleEndian),this.quatern_c=Te.getDoubleAt(n,360,this.littleEndian),this.quatern_d=Te.getDoubleAt(n,368,this.littleEndian),this.qoffset_x=Te.getDoubleAt(n,376,this.littleEndian),this.qoffset_y=Te.getDoubleAt(n,384,this.littleEndian),this.qoffset_z=Te.getDoubleAt(n,392,this.littleEndian),s=0;s<3;s+=1)for(o=0;o<4;o+=1)l=400+(s*4+o)*8,this.affine[s][o]=Te.getDoubleAt(n,l,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=Te.getIntAt(n,496,this.littleEndian),this.xyzt_units=Te.getIntAt(n,500,this.littleEndian),this.intent_code=Te.getIntAt(n,504,this.littleEndian),this.intent_name=Te.getStringAt(n,508,524),this.dim_info=Te.getByteAt(n,524),n.byteLength>nn.MAGIC_COOKIE&&(this.extensionFlag[0]=Te.getByteAt(n,540),this.extensionFlag[1]=Te.getByteAt(n,541),this.extensionFlag[2]=Te.getByteAt(n,542),this.extensionFlag[3]=Te.getByteAt(n,543),this.extensionFlag[0]&&(this.extensions=Te.getExtensionsAt(n,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode))}toFormattedString(){var e=Te.formatNumber,n="";return n+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,n+="Bits Per Voxel =  = "+this.numBitsPerVoxel+`
`,n+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,n+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,n+="Voxel Dimensions (1-8): "+e(this.pixDims[0])+", "+e(this.pixDims[1])+", "+e(this.pixDims[2])+", "+e(this.pixDims[3])+", "+e(this.pixDims[4])+", "+e(this.pixDims[5])+", "+e(this.pixDims[6])+", "+e(this.pixDims[7])+`
`,n+="Image Offset = "+this.vox_offset+`
`,n+="Data Scale:  Slope = "+e(this.scl_slope)+"  Intercept = "+e(this.scl_inter)+`
`,n+="Display Range:  Max = "+e(this.cal_max)+"  Min = "+e(this.cal_min)+`
`,n+="Slice Duration = "+this.slice_duration+`
`,n+="Time Axis Shift = "+this.toffset+`
`,n+="Slice Start = "+this.slice_start+`
`,n+="Slice End = "+this.slice_end+`
`,n+='Description: "'+this.description+`"
`,n+='Auxiliary File: "'+this.aux_file+`"
`,n+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,n+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,n+="Quaternion Parameters:  b = "+e(this.quatern_b)+"  c = "+e(this.quatern_c)+"  d = "+e(this.quatern_d)+`
`,n+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,n+="S-Form Parameters X: "+e(this.affine[0][0])+", "+e(this.affine[0][1])+", "+e(this.affine[0][2])+", "+e(this.affine[0][3])+`
`,n+="S-Form Parameters Y: "+e(this.affine[1][0])+", "+e(this.affine[1][1])+", "+e(this.affine[1][2])+", "+e(this.affine[1][3])+`
`,n+="S-Form Parameters Z: "+e(this.affine[2][0])+", "+e(this.affine[2][1])+", "+e(this.affine[2][2])+", "+e(this.affine[2][3])+`
`,n+="Slice Code = "+this.slice_code+`
`,n+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(Fe.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(Fe.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,n+="Intent Code = "+this.intent_code+`
`,n+='Intent Name: "'+this.intent_name+`"
`,n+="Dim Info = "+this.dim_info+`
`,n}getExtensionLocation=function(){return nn.MAGIC_COOKIE+4};getExtensionSize=Fe.prototype.getExtensionSize;getExtensionCode=Fe.prototype.getExtensionCode;addExtension=Fe.prototype.addExtension;removeExtension=Fe.prototype.removeExtension;getDatatypeCodeString=Fe.prototype.getDatatypeCodeString;getTransformCodeString=Fe.prototype.getTransformCodeString;getUnitsCodeString=Fe.prototype.getUnitsCodeString;getQformMat=Fe.prototype.getQformMat;convertNiftiQFormToNiftiSForm=Fe.prototype.convertNiftiQFormToNiftiSForm;convertNiftiSFormToNEMA=Fe.prototype.convertNiftiSFormToNEMA;nifti_mat33_mul=Fe.prototype.nifti_mat33_mul;nifti_mat33_determ=Fe.prototype.nifti_mat33_determ;toArrayBuffer(e=!1){let a=544;if(e)for(let c of this.extensions)a+=c.esize;let s=new Uint8Array(a),o=new DataView(s.buffer);o.setInt32(0,540,this.littleEndian),s.set(new TextEncoder().encode(this.magic),4),o.setInt16(12,this.datatypeCode,this.littleEndian),o.setInt16(14,this.numBitsPerVoxel,this.littleEndian);for(let c=0;c<8;c++)o.setBigInt64(16+8*c,BigInt(this.dims[c]),this.littleEndian);o.setFloat64(80,this.intent_p1,this.littleEndian),o.setFloat64(88,this.intent_p2,this.littleEndian),o.setFloat64(96,this.intent_p3,this.littleEndian);for(let c=0;c<8;c++)o.setFloat64(104+8*c,this.pixDims[c],this.littleEndian);o.setBigInt64(168,BigInt(this.vox_offset),this.littleEndian),o.setFloat64(176,this.scl_slope,this.littleEndian),o.setFloat64(184,this.scl_inter,this.littleEndian),o.setFloat64(192,this.cal_max,this.littleEndian),o.setFloat64(200,this.cal_min,this.littleEndian),o.setFloat64(208,this.slice_duration,this.littleEndian),o.setFloat64(216,this.toffset,this.littleEndian),o.setBigInt64(224,BigInt(this.slice_start),this.littleEndian),o.setBigInt64(232,BigInt(this.slice_end),this.littleEndian),s.set(new TextEncoder().encode(this.description),240),s.set(new TextEncoder().encode(this.aux_file),320),o.setInt32(344,this.qform_code,this.littleEndian),o.setInt32(348,this.sform_code,this.littleEndian),o.setFloat64(352,this.quatern_b,this.littleEndian),o.setFloat64(360,this.quatern_c,this.littleEndian),o.setFloat64(368,this.quatern_d,this.littleEndian),o.setFloat64(376,this.qoffset_x,this.littleEndian),o.setFloat64(384,this.qoffset_y,this.littleEndian),o.setFloat64(392,this.qoffset_z,this.littleEndian);const l=this.affine.flat();for(let c=0;c<12;c++)o.setFloat64(400+8*c,l[c],this.littleEndian);if(o.setInt32(496,this.slice_code,this.littleEndian),o.setInt32(500,this.xyzt_units,this.littleEndian),o.setInt32(504,this.intent_code,this.littleEndian),s.set(new TextEncoder().encode(this.intent_name),508),o.setUint8(524,this.dim_info),e){s.set(Uint8Array.from([1,0,0,0]),540);let c=this.getExtensionLocation();for(const u of this.extensions)o.setInt32(c,u.esize,u.littleEndian),o.setInt32(c+4,u.ecode,u.littleEndian),s.set(new Uint8Array(u.edata),c+8),c+=u.esize}else s.set(new Uint8Array(4).fill(0),540);return s.buffer}}function Vz(r,e=!1){var n,i,a,s;return r.byteLength<Fe.STANDARD_HEADER_SIZE?!1:(n=new DataView(r),n&&(i=n.getUint8(Fe.MAGIC_NUMBER_LOCATION)),a=n.getUint8(Fe.MAGIC_NUMBER_LOCATION+1),s=n.getUint8(Fe.MAGIC_NUMBER_LOCATION+2),e&&i===Fe.MAGIC_NUMBER2[0]&&a===Fe.MAGIC_NUMBER2[1]&&s===Fe.MAGIC_NUMBER2[2]?!0:i===Fe.MAGIC_NUMBER[0]&&a===Fe.MAGIC_NUMBER[1]&&s===Fe.MAGIC_NUMBER[2])}function Oz(r,e=!1){var n,i,a,s;return r.byteLength<Fe.STANDARD_HEADER_SIZE?!1:(n=new DataView(r),i=n.getUint8(nn.MAGIC_NUMBER_LOCATION),a=n.getUint8(nn.MAGIC_NUMBER_LOCATION+1),s=n.getUint8(nn.MAGIC_NUMBER_LOCATION+2),e&&i===nn.MAGIC_NUMBER2[0]&&a===nn.MAGIC_NUMBER2[1]&&s===nn.MAGIC_NUMBER2[2]?!0:i===nn.MAGIC_NUMBER[0]&&a===nn.MAGIC_NUMBER[1]&&s===nn.MAGIC_NUMBER[2])}function vy(r){var e,n,i;return!!(r&&(e=new DataView(r),n=e.getUint8(0),i=e.getUint8(1),n===Te.GUNZIP_MAGIC_COOKIE1||i===Te.GUNZIP_MAGIC_COOKIE2))}function Pz(r){return Fz(new Uint8Array(r)).buffer}async function Lz(r){const e=new Uint8Array(r),n=e[0]===31&&e[1]===139&&e[2]===8?"gzip":e[0]===120&&(e[1]===1||e[1]===94||e[1]===156||e[1]===218)?"deflate":"deflate-raw",i=new DecompressionStream(n),a=i.writable.getWriter();a.write(e).catch(console.error);const s=a.close().catch(console.error),l=await new Response(i.readable).arrayBuffer();return await s,l}async function xC(r,e=1/0){const n=m=>m[0]===31&&m[1]===139&&m[2]===8?"gzip":m[0]===120&&[1,94,156,218].includes(m[1])?"deflate":"deflate-raw",i=new Uint8Array(r),a=n(i),s=new DecompressionStream(a),o=new TransformStream({transform(m,y){y.enqueue(m)},flush(m){m.terminate()}}),{readable:l,writable:c}=s,u=c.getWriter(),h=l.pipeThrough(o).getReader();u.write(i).catch(m=>{m instanceof Error&&m.name==="AbortError"||console.error("Error during write:",m)});const g=[];let v=0;try{for(;v<e;){const{done:m,value:y}=await h.read();if(m)break;const b=e-v,x=y.subarray(0,Math.min(y.length,b));if(g.push(x),v+=x.length,v>=e){await Promise.all([h.cancel().catch(()=>{}),u.abort().catch(()=>{})]);break}}}catch(m){m instanceof Error&&m.name==="AbortError"||console.error("Error during decompression:",m)}finally{await Promise.allSettled([h.cancel().catch(()=>{}),u.close().catch(()=>{})])}return g.length===1?g[0].buffer:g.reduce((m,y)=>{const b=new Uint8Array(m.byteLength+y.byteLength);return b.set(new Uint8Array(m),0),b.set(y,m.byteLength),b.buffer},new ArrayBuffer(0))}function _z(r,e=!1){let n=null;if(vy(r)&&(r=Pz(r)),Vz(r,e)?n=new Fe:Oz(r,e)&&(n=new nn),n)n.readHeader(r);else throw new Error("That file does not appear to be NIFTI!");return n}async function wc(r,e=!1){if(!vy(r))return _z(r,e);let n=null,i=await xC(r,540),a=!0,s=!0;var o=new DataView(i);const l=o.getInt32(0,!0),c=o.getInt32(0,!1);if(l!==348)if(c===348)a=!1;else if(l===540)s=!1;else if(c===540)s=!1,a=!1;else throw new Error("That file does not appear to be NIFTI!");let u=Math.round(o.getFloat32(108,a));return nn&&(u=Te.getUint64At(o,168,a)),u>i.byteLength&&(i=await xC(r,u)),s?n=new Fe:n=new nn,n.readHeader(i),n}function zz(r){return r.extensionFlag[0]!=0}function Gz(r,e){var n=r.vox_offset,i=1,a=1;r.dims[4]&&(i=r.dims[4]),r.dims[5]&&(a=r.dims[5]);var s=r.dims[1]*r.dims[2]*r.dims[3]*i*a*(r.numBitsPerVoxel/8);return e.slice(n,n+s)}function xT(r,e,n,i={}){return e!==void 0&&n!==void 0&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+n-1}`}}),fetch(r,i)}function qz(r,e){return{...r,...e,headers:{...r.headers,...e.headers}}}function bC(r,e){const n=typeof r=="string"?new URL(r):r;n.pathname.endsWith("/")||(n.pathname+="/");const i=new URL(e.slice(1),n);return i.search=n.search,i}async function wC(r){if(r.status!==404){if(r.status===200||r.status===206)return new Uint8Array(await r.arrayBuffer());throw new Error(`Unexpected response status ${r.status} ${r.statusText}`)}}async function Yz(r,e,n,i){if(i)return fetch(r,{...n,headers:{...n.headers,Range:`bytes=-${e}`}});let a=await fetch(r,{...n,method:"HEAD"});if(!a.ok)return a;let s=a.headers.get("Content-Length"),o=Number(s);return xT(r,o-e,o,n)}class jz{url;#e;#t;constructor(e,n={}){this.url=e,this.#e=n.overrides??{},this.#t=n.useSuffixRequest??!1}#r(e){return qz(this.#e,e)}async get(e,n={}){let i=bC(this.url,e).href,a=await fetch(i,this.#r(n));return wC(a)}async getRange(e,n,i={}){let a=bC(this.url,e),s=this.#r(i),o;return"suffixLength"in n?o=await Yz(a,n.suffixLength,s,this.#t):o=await xT(a,n.offset,n.length,s),wC(o)}}const Hz="modulepreload",Kz=function(r){return"/"+r},CC={},ap=function(e,n,i){let a=Promise.resolve();if(n&&n.length>0){let u=function(h){return Promise.all(h.map(g=>Promise.resolve(g).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};var o=u;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");a=u(n.map(h=>{if(h=Kz(h),h in CC)return;CC[h]=!0;const g=h.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${v}`))return;const m=document.createElement("link");if(m.rel=g?"stylesheet":Hz,g||(m.as="script"),m.crossOrigin="",m.href=h,c&&m.setAttribute("nonce",c),document.head.appendChild(m),g)return new Promise((y,b)=>{m.addEventListener("load",y),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};class bT{#e;constructor(e,n,i){typeof e=="number"?this.#e=new Uint8Array(e):e instanceof ArrayBuffer?this.#e=new Uint8Array(e,n,i):this.#e=new Uint8Array(Array.from(e,a=>a?1:0))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return this.#e.byteOffset}get byteLength(){return this.#e.byteLength}get buffer(){return this.#e.buffer}get length(){return this.#e.length}get(e){let n=this.#e[e];return typeof n=="number"?n!==0:n}set(e,n){this.#e[e]=n?1:0}fill(e){this.#e.fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}class my{_data;chars;#e;constructor(e,n,i,a){if(this.chars=e,this.#e=new TextEncoder,typeof n=="number")this._data=new Uint8Array(n*e);else if(n instanceof ArrayBuffer)a&&(a=a*e),this._data=new Uint8Array(n,i,a);else{let s=Array.from(n);this._data=new Uint8Array(s.length*e);for(let o=0;o<s.length;o++)this.set(o,s[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(n).replace(/\x00/g,"")}set(e,n){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);i.fill(0),i.set(this.#e.encode(n))}fill(e){const n=this.#e.encode(e);for(let i=0;i<this.length;i++)this._data.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}class Af{#e;chars;constructor(e,n,i,a){if(this.chars=e,typeof n=="number")this.#e=new Int32Array(n*e);else if(n instanceof ArrayBuffer)a&&(a*=e),this.#e=new Int32Array(n,i,a);else{const s=n,o=new Af(e,1);this.#e=new Int32Array((function*(){for(let l of s)o.set(0,l),yield*o.#e})())}}get BYTES_PER_ELEMENT(){return this.#e.BYTES_PER_ELEMENT*this.chars}get byteLength(){return this.#e.byteLength}get byteOffset(){return this.#e.byteOffset}get buffer(){return this.#e.buffer}get length(){return this.#e.length/this.chars}get(e){const n=this.chars*e;let i="";for(let a=0;a<this.chars;a++)i+=String.fromCodePoint(this.#e[n+a]);return i.replace(/\u0000/g,"")}set(e,n){const i=this.chars*e,a=this.#e.subarray(i,i+this.chars);a.fill(0);for(let s=0;s<this.chars;s++)a[s]=n.codePointAt(s)??0}fill(e){this.set(0,e);let n=this.#e.subarray(0,this.chars);for(let i=1;i<this.length;i++)this.#e.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}function xf(r){const e=new TextDecoder().decode(r);return JSON.parse(e)}function EC(r,e){const n=e/2,i=e-1;let a=0;for(let s=0;s<r.length;s+=e)for(let o=0;o<n;o+=1)a=r[s+o],r[s+o]=r[s+i-o],r[s+i-o]=a}function wT(r){if(r==="v2:object")return globalThis.Array;let e=r.match(/v2:([US])(\d+)/);if(e){let[,i,a]=e;return(i==="U"?Af:my).bind(null,Number(a))}let n={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:bT}[r];return Vr(n,`Unknown or unsupported data_type: ${r}`),n}function Do(r,e){const n=r.length;typeof e=="string"&&(e=e==="C"?Array.from({length:n},(s,o)=>o):Array.from({length:n},(s,o)=>n-1-o)),Vr(n===e.length,"Order length must match the number of dimensions.");let i=1,a=new Array(n);for(let s=e.length-1;s>=0;s--)a[e[s]]=i,i*=r[e[s]];return a}function Xz({name:r,configuration:e}){if(r==="default"){const n=e?.separator??"/";return i=>["c",...i].join(n)}if(r==="v2"){const n=e?.separator??".";return i=>i.join(n)||"0"}throw new Error(`Unknown chunk key encoding: ${r}`)}function Qz(r){if(r==="|O")return{data_type:"v2:object"};let e=r.match(/^([<|>])(.*)$/);Vr(e,`Invalid dtype: ${r}`);let[,n,i]=e,a={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);return Vr(a,`Unsupported or unknown dtype: ${r}`),n==="|"?{data_type:a}:{data_type:a,endian:n==="<"?"little":"big"}}function Zz(r,e={}){let n=[],i=Qz(r.dtype);r.order==="F"&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:a,...s}of r.filters??[])n.push({name:a,configuration:s});if(r.compressor){let{id:a,...s}=r.compressor;n.push({name:a,configuration:s})}return{zarr_format:3,node_type:"array",shape:r.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:r.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:r.dimension_separator??"."}},codecs:n,fill_value:r.fill_value,attributes:e}}function Wz(r,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function Jz(r,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return r===e;let n=r==="bool";if(e==="boolean")return n;let i=r.startsWith("v2:U")||r.startsWith("v2:S");if(e==="string")return i;let a=r==="int64"||r==="uint64";if(e==="bigint")return a;let s=r==="v2:object";return e==="object"?s:!i&&!a&&!n&&!s}function $z(r){return r?.name==="sharding_indexed"}function CT(r){return(r.data_type==="uint64"||r.data_type==="int64")&&r.fill_value!=null?BigInt(r.fill_value):r.fill_value}function ET(r,...e){if(!e.some(n=>r instanceof n))throw r}function Vr(r,e=""){if(!r)throw new Error(e)}async function ST(r,{format:e,signal:n}){const i=r instanceof Response?r:new Response(r);Vr(i.body,"Response does not contain body.");try{return await new Response(i.body.pipeThrough(new DecompressionStream(e),{signal:n})).arrayBuffer()}catch{throw n?.throwIfAborted(),new Error(`Failed to decode ${e}`)}}class py{kind="array_to_array";constructor(e,n){Vr(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,n){return new py(e,n)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const SC=eG();function eG(){const r=new Uint32Array([305419896]);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)[0]!==18}function TC(r){return"BYTES_PER_ELEMENT"in r?r.BYTES_PER_ELEMENT:4}class X0{kind="array_to_bytes";#e;#t;#r;#i;#n;constructor(e,n){this.#n=e?.endian,this.#t=wT(n.data_type),this.#i=n.shape,this.#e=Do(n.shape,"C");const i=new this.#t(0);this.#r=i.BYTES_PER_ELEMENT}static fromConfig(e,n){return new X0(e,n)}encode(e){let n=new Uint8Array(e.data.buffer);return SC&&this.#n==="big"&&EC(n,TC(this.#t)),n}decode(e){return SC&&this.#n==="big"&&EC(e,TC(this.#t)),{data:new this.#t(e.buffer,e.byteOffset,e.byteLength/this.#r),shape:this.#i,stride:this.#e}}}class yy{kind="bytes_to_bytes";static fromConfig(){return new yy}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}class Ay{kind="bytes_to_bytes";static fromConfig(e){return new Ay}encode(e){throw new Error("Gzip encoding is not enabled by default. Please register a custom codec with `numcodecs/gzip`.")}async decode(e){const n=await ST(e,{format:"gzip"});return new Uint8Array(n)}}function tG(r,e){return Vr(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),Vr(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),Vr(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function rG(r,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((n,i)=>(n[i]=e[i],n),{}):e}class xy{configuration;kind="array_to_bytes";#e;#t;constructor(e={}){this.configuration=e;const{encoding:n="utf-8",skipkeys:i=!1,ensure_ascii:a=!0,check_circular:s=!0,allow_nan:o=!0,sort_keys:l=!0,indent:c,strict:u=!0}=e;let h=e.separators;h||(c?h=[", ",": "]:h=[",",":"]),this.#e={encoding:n,skipkeys:i,ensure_ascii:a,check_circular:s,allow_nan:o,indent:c,separators:h,sort_keys:l},this.#t={strict:u}}static fromConfig(e){return new xy(e)}encode(e){const{indent:n,encoding:i,ensure_ascii:a,check_circular:s,allow_nan:o,sort_keys:l}=this.#e;Vr(i==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const c=[];Vr(s,"JsonCodec does not yet support skipping the check for circular references during encoding."),o||c.push(tG),l&&c.push(rG);const u=Array.from(e.data);u.push("|O"),u.push(e.shape);let h;c.length&&(h=(v,m)=>{let y=m;for(let b of c)y=b(v,y);return y});let g=JSON.stringify(u,h,n);return a&&(g=g.replace(/[\u007F-\uFFFF]/g,v=>{const m=`0000${v.charCodeAt(0).toString(16)}`;return`\\u${m.substring(m.length-4)}`})),new TextEncoder().encode(g)}decode(e){const{strict:n}=this.#t;Vr(n,"JsonCodec does not yet support non-strict decoding.");const i=xf(e),a=i.pop();i.pop(),Vr(a,"0D not implemented for JsonCodec.");const s=Do(a,"C");return{data:i,shape:a,stride:s}}}function MC(r){return r instanceof bT||r instanceof my||r instanceof Af?new Proxy(r,{get(n,i){return n.get(Number(i))},set(n,i,a){return n.set(Number(i),a),!0}}):r}function nG(r,e){let n;return r.data instanceof my||r.data instanceof Af?n=new r.constructor(r.data.length,r.data.chars):n=new r.constructor(r.data.length),{data:n,shape:r.shape,stride:Do(r.shape,e)}}function iG(r,e){let n=nG(r,e),i=r.shape.length,a=r.data.length,s=Array(i).fill(0),o=MC(r.data),l=MC(n.data);for(let c=0;c<a;c++){let u=0;for(let h=0;h<i;h++)u+=s[h]*n.stride[h];l[u]=o[c],s[0]+=1;for(let h=0;h<i;h++)if(s[h]===r.shape[h]){if(h+1===i)break;s[h]=0,s[h+1]+=1}}return n}function aG(r){let e=r.shape.length;return Vr(e===r.stride.length,"Shape and stride must have the same length."),r.stride.map((n,i)=>({stride:n,index:i})).sort((n,i)=>i.stride-n.stride).map(n=>n.index)}function sG(r,e){let n=aG(r);return Vr(n.length===e.length,"Orders must match"),n.every((i,a)=>i===e[a])}class by{kind="array_to_array";#e;#t;constructor(e,n){let i=e.order??"C",a=n.shape.length,s=new Array(a),o=new Array(a);if(i==="C")for(let l=0;l<a;++l)s[l]=l,o[l]=l;else if(i==="F")for(let l=0;l<a;++l)s[l]=a-l-1,o[l]=a-l-1;else s=i,s.forEach((l,c)=>{Vr(o[l]===void 0,`Invalid permutation: ${JSON.stringify(i)}`),o[l]=c});this.#e=s,this.#t=o}static fromConfig(e,n){return new by(e,n)}encode(e){return sG(e,this.#t)?e:iG(e,this.#t)}decode(e){return{data:e.data,shape:e.shape,stride:Do(e.shape,this.#e)}}}class wy{kind="array_to_bytes";#e;#t;constructor(e){this.#e=e,this.#t=Do(e,"C")}static fromConfig(e,n){return new wy(n.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let n=new TextDecoder,i=new DataView(e.buffer),a=Array(i.getUint32(0,!0)),s=4;for(let o=0;o<a.length;o++){let l=i.getUint32(s,!0);s+=4,a[o]=n.decode(e.buffer.slice(s,s+l)),s+=l}return{data:a,shape:this.#e,stride:this.#t}}}class Cy{kind="bytes_to_bytes";static fromConfig(e){return new Cy}encode(e){throw new Error("Zlib encoding is not enabled by default. Please register a codec with `numcodecs/zlib`.")}async decode(e){const n=await ST(e,{format:"deflate"});return new Uint8Array(n)}}function oG(){return new Map().set("blosc",()=>ap(()=>import("./blosc-CrUiACa7.js"),__vite__mapDeps([0,1])).then(r=>r.default)).set("lz4",()=>ap(()=>import("./lz4-B_Exjfmr.js"),__vite__mapDeps([2,1])).then(r=>r.default)).set("zstd",()=>ap(()=>import("./zstd-u5eweWyS.js"),__vite__mapDeps([3,1])).then(r=>r.default)).set("gzip",()=>Ay).set("zlib",()=>Cy).set("transpose",()=>by).set("bytes",()=>X0).set("crc32c",()=>yy).set("vlen-utf8",()=>wy).set("json2",()=>xy).set("bitround",()=>py)}const lG=oG();function c2(r){let e;return{async encode(n){e||(e=await DC(r));for(const a of e.array_to_array)n=await a.encode(n);let i=await e.array_to_bytes.encode(n);for(const a of e.bytes_to_bytes)i=await a.encode(i);return i},async decode(n){e||(e=await DC(r));for(let a=e.bytes_to_bytes.length-1;a>=0;a--)n=await e.bytes_to_bytes[a].decode(n);let i=await e.array_to_bytes.decode(n);for(let a=e.array_to_array.length-1;a>=0;a--)i=await e.array_to_array[a].decode(i);return i}}}async function DC(r){let e=r.codecs.map(async s=>{let o=await lG.get(s.name)?.();return Vr(o,`Unknown codec: ${s.name}`),{Codec:o,meta:s}}),n=[],i,a=[];for await(let{Codec:s,meta:o}of e){let l=s.fromConfig(o.configuration,r);switch(l.kind){case"array_to_array":n.push(l);break;case"array_to_bytes":i=l;break;default:a.push(l)}}return i||(Vr(uG(r),`Cannot encode ${r.data_type} to bytes without a codec`),i=X0.fromConfig({endian:"little"},r)),{array_to_array:n,array_to_bytes:i,bytes_to_bytes:a}}function uG(r){return r.data_type!=="v2:object"}class bf extends Error{constructor(e,n={}){super(`Node not found: ${e}`,n),this.name="NodeNotFoundError"}}class Ey extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}const RC=18446744073709551615n;function cG(r,e,n,i){Vr(r.store.getRange,"Store does not support range requests");let a=r.store.getRange.bind(r.store),s=e.map((c,u)=>c/i.chunk_shape[u]),o=c2({data_type:"uint64",shape:[...s,2],codecs:i.index_codecs}),l={};return async c=>{let u=c.map((C,E)=>Math.floor(C/s[E])),h=r.resolve(n(u)).path,g;if(h in l)g=l[h];else{let C=4,E=16*s.reduce((M,R)=>M*R,1),S=await a(h,{suffixLength:E+C});g=l[h]=S?await o.decode(S):null}if(g===null)return;let{data:v,shape:m,stride:y}=g,b=c.map((C,E)=>C%m[E]).reduce((C,E,S)=>C+E*y[S],0),x=v[b],A=v[b+1];if(!(x===RC&&A===RC))return a(h,{offset:Number(x),length:Number(A)})}}class No{store;path;constructor(e,n="/"){this.store=e,this.path=n}resolve(e){let n=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new No(this.store,decodeURIComponent(new URL(e,n).pathname))}}function fG(r){return new No(r??new Map)}class Sy extends No{kind="group";#e;constructor(e,n,i){super(e,n),this.#e=i}get attrs(){return this.#e.attributes}}function BC(r){return r.find(n=>n.name==="transpose")?.configuration?.order??"C"}const Cc=Symbol("zarrita.context");function hG(r){return r[Cc]}function dG(r,e){let{configuration:n}=e.codecs.find($z)??{},i={encode_chunk_key:Xz(e.chunk_key_encoding),TypedArray:wT(e.data_type),fill_value:e.fill_value};if(n){let s=BC(n.codecs);return{...i,kind:"sharded",chunk_shape:n.chunk_shape,codec:c2({data_type:e.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides(o){return Do(o,s)},get_chunk_bytes:cG(r,e.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,n)}}let a=BC(e.codecs);return{...i,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:c2({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(s){return Do(s,a)},async get_chunk_bytes(s,o){let l=i.encode_chunk_key(s),c=r.resolve(l).path;return r.store.get(c,o)}}}let A0=class extends No{kind="array";#e;[Cc];constructor(e,n,i){super(e,n),this.#e={...i,fill_value:CT(i)},this[Cc]=dG(this,i)}get attrs(){return this.#e.attributes}get shape(){return this.#e.shape}get chunks(){return this[Cc].chunk_shape}get dtype(){return this.#e.data_type}async getChunk(e,n){let i=this[Cc],a=await i.get_chunk_bytes(e,n);if(!a){let s=i.chunk_shape.reduce((l,c)=>l*c,1),o=new i.TypedArray(s);return o.fill(i.fill_value),{data:o,shape:i.chunk_shape,stride:i.get_strides(i.chunk_shape)}}return i.codec.decode(a)}is(e){return Jz(this.dtype,e)}};function*gG(r,e,n=1){e===void 0&&(e=r,r=0);for(let i=r;i<e;i+=n)yield i}function*vG(...r){if(r.length===0)return;const e=r.map(i=>i[Symbol.iterator]()),n=e.map(i=>i.next());if(n.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(n[i].done){if(e[i]=r[i][Symbol.iterator](),n[i]=e[i].next(),++i>=e.length)return}else yield n.map(({value:a})=>a),i=0;n[i]=e[i].next()}}function mG({start:r,stop:e,step:n},i){if(n===0)throw new Error("slice step cannot be zero");n=n??1;const a=n<0,[s,o]=a?[-1,i-1]:[0,i];return r===null?r=a?o:s:r<0?(r+=i,r<s&&(r=s)):r>o&&(r=o),e===null?e=a?s:o:e<0?(e+=i,e<s&&(e=s)):e>o&&(e=o),[r,e,n]}function kc(r,e,n=null){return e===void 0&&(e=r,r=null),{start:r,stop:e,step:n}}function pG(){const r=[];return{add:e=>r.push(e()),onIdle:()=>Promise.all(r)}}class Ty extends Error{constructor(e){super(e),this.name="IndexError"}}function yG(r,e){throw new Ty(`too many indicies for array; expected ${e.length}, got ${r.length}`)}function AG(r){throw new Ty(`index out of bounds for dimension with length ${r}`)}function xG(){throw new Ty("only slices with step >= 1 are supported")}function bG(r,e){r.length>e.length&&yG(r,e)}function wG(r,e){return r=Math.trunc(r),r<0&&(r=e+r),(r>=e||r<0)&&AG(e),r}class CG{dim_sel;dim_len;dim_chunk_len;nitems;constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){e=wG(e,n),this.dim_sel=e,this.dim_len=n,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),n=e*this.dim_chunk_len,i=this.dim_sel-n;yield{dim_chunk_ix:e,dim_chunk_sel:i}}}class IC{start;stop;step;dim_len;dim_chunk_len;nitems;nchunks;constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){const[a,s,o]=mG(e,n);this.start=a,this.stop=s,this.step=o,this.step<1&&xG(),this.dim_len=n,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),n=Math.ceil(this.stop/this.dim_chunk_len);for(const i of gG(e,n)){const a=i*this.dim_chunk_len,s=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),o=s-a;let l=0,c=0;if(this.start<a){const m=(a-this.start)%this.step;m&&(c+=this.step-m),l=Math.ceil((a-this.start)/this.step)}else c=this.start-a;const u=this.stop>s?o:this.stop-a,h=[c,u,this.step],g=Math.ceil((u-c)/this.step),v=[l,l+g,1];yield{dim_chunk_ix:i,dim_chunk_sel:h,dim_out_sel:v}}}}function EG(r,e){let n=[];return r===null?n=e.map(i=>kc(null)):Array.isArray(r)&&(n=r.map(i=>i??kc(null))),bG(n,e),n}class SG{dim_indexers;shape;constructor({selection:e,shape:n,chunk_shape:i}){this.dim_indexers=EG(e,n).map((a,s)=>new(typeof a=="number"?CG:IC)({dim_sel:a,dim_len:n[s],dim_chunk_len:i[s]})),this.shape=this.dim_indexers.filter(a=>a instanceof IC).map(a=>a.nitems)}*[Symbol.iterator](){for(const e of vG(...this.dim_indexers)){const n=e.map(a=>a.dim_chunk_ix),i=e.map(a=>"dim_out_sel"in a?{from:a.dim_chunk_sel,to:a.dim_out_sel}:{from:a.dim_chunk_sel,to:null});yield{chunk_coords:n,mapping:i}}}}function TG(r,e){return"get"in r?r.get(e):r[e]}async function MG(r,e,n,i){let a=hG(r),s=new SG({selection:e,shape:r.shape,chunk_shape:r.chunks}),o=i.prepare(new a.TypedArray(s.shape.reduce((c,u)=>c*u,1)),s.shape,a.get_strides(s.shape)),l=n.create_queue?.()??pG();for(const{chunk_coords:c,mapping:u}of s)l.add(async()=>{let{data:h,shape:g,stride:v}=await r.getChunk(c,n.opts),m=i.prepare(h,g,v);i.set_from_chunk(o,m,u)});return await l.onIdle(),s.shape.length===0?TG(o.data,0):o}function My(r,e=0,n){let i=n??r.length-e;return{length:i,subarray(a,s=i){return My(r,e+a,s-a)},set(a,s=0){for(let o=0;o<a.length;o++)r[e+s+o]=a.get(o)},get(a){return r[e+a]}}}function sp(r){return globalThis.Array.isArray(r.data)?{data:My(r.data),stride:r.stride,bytes_per_element:1}:{data:new Uint8Array(r.data.buffer,r.data.byteOffset,r.data.byteLength),stride:r.stride,bytes_per_element:r.data.BYTES_PER_ELEMENT}}function DG(r){return"chars"in r?r.constructor.bind(null,r.chars):r.constructor}function RG(r,e){if(globalThis.Array.isArray(r.data))return My([e]);let n=DG(r.data),i=new n([e]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const BG={prepare(r,e,n){return{data:r,shape:e,stride:n}},set_scalar(r,e,n){let i=sp(r);f2(i,e,RG(r,n),i.bytes_per_element)},set_from_chunk(r,e,n){let i=sp(r);zd(i,sp(e),i.bytes_per_element,n)}};async function NC(r,e=null,n={}){return MG(r,e,n,BG)}function TT(r,e,n){return n<0&&e<r?Math.floor((r-e-1)/-n)+1:r<e?Math.floor((e-r-1)/n)+1:0}function f2(r,e,n,i){if(e.length===0){r.data.set(n,0);return}const[a,...s]=e,[o,...l]=r.stride;if(typeof a=="number"){const v=r.data.subarray(o*a*i);f2({data:v,stride:l},s,n,i);return}const[c,u,h]=a,g=TT(c,u,h);if(s.length===0){for(let v=0;v<g;v++)r.data.set(n,o*(c+h*v)*i);return}for(let v=0;v<g;v++){const m=r.data.subarray(o*(c+h*v)*i);f2({data:m,stride:l},s,n,i)}}function zd(r,e,n,i){const[a,...s]=i,[o,...l]=r.stride,[c,...u]=e.stride;if(a.from===null){if(s.length===0){r.data.set(e.data.subarray(0,n),a.to*n);return}zd({data:r.data.subarray(o*a.to*n),stride:l},e,n,s);return}if(a.to===null){if(s.length===0){let A=a.from*n;r.data.set(e.data.subarray(A,A+n),0);return}zd(r,{data:e.data.subarray(c*a.from*n),stride:u},n,s);return}const[h,g,v]=a.to,[m,y,b]=a.from,x=TT(h,g,v);if(s.length===0){if(v===1&&b===1&&o===1&&c===1){let A=m*n,C=x*n;r.data.set(e.data.subarray(A,A+C),h*n);return}for(let A=0;A<x;A++){let C=c*(m+b*A)*n;r.data.set(e.data.subarray(C,C+n),o*(h+v*A)*n)}return}for(let A=0;A<x;A++)zd({data:r.data.subarray(o*(h+A*v)*n),stride:l},{data:e.data.subarray(c*(m+A*b)*n),stride:u},n,s)}let Q0=IG();function IG(){let r=new WeakMap;function e(n){let i=r.get(n)??{v2:0,v3:0};return r.set(n,i),i}return{increment(n,i){e(n)[i]+=1},version_max(n){let i=e(n);return i.v3>i.v2?"v3":"v2"}}}async function NG(r){let e=await r.store.get(r.resolve(".zattrs").path);return e?xf(e):{}}async function FG(r,e={}){let n="store"in r?r:new No(r),i={};return(e.attrs??!0)&&(i=await NG(n)),e.kind==="array"?FC(n,i):e.kind==="group"?kC(n,i):FC(n,i).catch(a=>(ET(a,bf),kC(n,i)))}async function FC(r,e){let{path:n}=r.resolve(".zarray"),i=await r.store.get(n);if(!i)throw new bf("v2 array",{cause:new Ey(n)});return Q0.increment(r.store,"v2"),new A0(r.store,r.path,Zz(xf(i),e))}async function kC(r,e){let{path:n}=r.resolve(".zgroup"),i=await r.store.get(n);if(!i)throw new bf("v2 group",{cause:new Ey(n)});return Q0.increment(r.store,"v2"),new Sy(r.store,r.path,Wz(xf(i),e))}async function kG(r){let{store:e,path:n}=r.resolve("zarr.json"),i=await r.store.get(n);if(!i)throw new bf("v3 array or group",{cause:new Ey(n)});let a=xf(i);return a.node_type==="array"&&(a.fill_value=CT(a)),a.node_type==="array"?new A0(e,r.path,a):new Sy(e,r.path,a)}async function UG(r,e={}){let n="store"in r?r:new No(r),i=await kG(n);if(Q0.increment(n.store,"v3"),e.kind===void 0||e.kind==="array"&&i instanceof A0||e.kind==="group"&&i instanceof Sy)return i;let a=i instanceof A0?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${a}.`)}async function Cs(r,e={}){let n="store"in r?r.store:r,i=Q0.version_max(n),a=i==="v2"?Cs.v2:Cs.v3,s=i==="v2"?Cs.v3:Cs.v2;return a(r,e).catch(o=>(ET(o,bf),s(r,e)))}Cs.v2=FG;Cs.v3=UG;var MT=Object.defineProperty,DT=r=>{throw TypeError(r)},VG=(r,e,n)=>e in r?MT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,Z0=(r,e)=>{for(var n in e)MT(r,n,{get:e[n],enumerable:!0})},j=(r,e,n)=>VG(r,typeof e!="symbol"?e+"":e,n),RT=(r,e,n)=>e.has(r)||DT("Cannot "+n),He=(r,e,n)=>(RT(r,e,"read from private field"),n?n.call(r):e.get(r)),uc=(r,e,n)=>e.has(r)?DT("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,n),Tl=(r,e,n,i)=>(RT(r,e,"write to private field"),e.set(r,n),n),OG={version:"0.62.1"},PG=new Float32Array([-1,-1,-1,.28,.28,.28,-1,-1,-1,.28,.28,.28,-1,1,-1,.28,.28,.28,1,-1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,-1,-1,1,.8,.8,.8,-1,-1,1,.8,.8,.8,1,-1,1,.8,.8,.8,-1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,-1,1,-1,0,0,.74,-1,1,-1,0,0,.74,-1,1,1,0,0,.74,1,1,-1,0,0,.74,1,1,1,0,0,.74,1,1,1,0,0,.74,-1,-1,-1,.42,0,.42,-1,-1,-1,.42,0,.42,1,-1,-1,.42,0,.42,-1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,-1,-1,-1,.64,0,0,-1,-1,-1,.64,0,0,-1,-1,1,.64,0,0,-1,1,-1,.64,0,0,-1,1,1,.64,0,0,-1,1,1,.64,0,0,1,-1,-1,0,.5,0,1,-1,-1,0,.5,0,1,1,-1,0,.5,0,1,-1,1,0,.5,0,1,1,1,0,.5,0,1,1,1,0,.5,0,-.45,1,-.8,0,0,0,-.45,1,-.8,0,0,0,-.45,1,.8,0,0,0,-.25,1,-.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.6,0,0,0,-.25,1,.6,0,0,0,-.25,1,.8,0,0,0,.45,1,.6,0,0,0,.25,1,.8,0,0,0,.25,1,.8,0,0,0,.25,1,.1,0,0,0,.25,1,.1,0,0,0,.25,1,.6,0,0,0,.45,1,.1,0,0,0,.45,1,.6,0,0,0,.45,1,.6,0,0,0,-.25,1,-.1,0,0,0,-.25,1,-.1,0,0,0,-.25,1,.1,0,0,0,.25,1,-.1,0,0,0,.45,1,.1,0,0,0,.45,1,.1,0,0,0,.45,-1,-.8,0,0,0,.45,-1,-.8,0,0,0,.05,-1,.8,0,0,0,.25,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,-.25,-1,-.8,0,0,0,-.25,-1,-.8,0,0,0,.05,-1,.8,0,0,0,-.45,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,.13,-1,-.3,0,0,0,.13,-1,-.3,0,0,0,.07,-1,-.1,0,0,0,-.33,-1,-.3,0,0,0,-.27,-1,-.1,0,0,0,-.27,-1,-.1,0,0,0,-.45,.6,1,0,0,0,-.45,.6,1,0,0,0,-.45,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.4,1,0,0,0,-.25,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.8,1,0,0,0,-.25,.6,1,0,0,0,.25,.8,1,0,0,0,.45,.6,1,0,0,0,.45,.6,1,0,0,0,.25,.8,1,0,0,0,.25,.8,1,0,0,0,.25,-.1,1,0,0,0,.45,.6,1,0,0,0,.45,.1,1,0,0,0,.45,.1,1,0,0,0,-.25,.1,1,0,0,0,-.25,.1,1,0,0,0,-.45,-.1,1,0,0,0,.25,.1,1,0,0,0,.25,-.1,1,0,0,0,.25,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.6,1,0,0,0,-.25,-.1,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.8,1,0,0,0,.45,-.6,1,0,0,0,.25,-.8,1,0,0,0,.25,-.8,1,0,0,0,.25,-.4,1,0,0,0,.25,-.4,1,0,0,0,.25,-.6,1,0,0,0,.45,-.4,1,0,0,0,.45,-.6,1,0,0,0,.45,-.6,1,0,0,0,-.1,-.8,-1,0,0,0,-.1,-.8,-1,0,0,0,-.1,.8,-1,0,0,0,.1,-.8,-1,0,0,0,.1,.8,-1,0,0,0,.1,.8,-1,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.6,0,0,0,-1,.45,-.8,0,0,0,-1,.45,-.6,0,0,0,-1,.45,-.6,0,0,0,1,.45,-.8,0,0,0,1,.45,-.8,0,0,0,1,.45,.8,0,0,0,1,.25,-.8,0,0,0,1,.25,.8,0,0,0,1,.25,.8,0,0,0,1,.25,.6,0,0,0,1,.25,.6,0,0,0,1,.25,.8,0,0,0,1,-.45,.6,0,0,0,1,-.25,.8,0,0,0,1,-.25,.8,0,0,0,1,-.25,.1,0,0,0,1,-.25,.1,0,0,0,1,-.25,.6,0,0,0,1,-.45,.1,0,0,0,1,-.45,.6,0,0,0,1,-.45,.6,0,0,0,1,.25,-.1,0,0,0,1,.25,-.1,0,0,0,1,.25,.1,0,0,0,1,-.25,-.1,0,0,0,1,-.45,.1,0,0,0,1,-.45,.1,0,0,0,1,-.25,-.8,0,0,0,1,-.25,-.8,0,0,0,1,-.05,-.1,0,0,0,1,-.45,-.8,0,0,0,1,-.25,-.1,0,0,0,1,-.25,-.1,0,0,0]),Nt=class{constructor(e,n,i,a,s=null,o=null){j(this,"sphereIdx",[]),j(this,"sphereVtx",[]),j(this,"renderShaders",[]),j(this,"isVisible",!0),j(this,"isPickable",!0),j(this,"vertexBuffer"),j(this,"indexCount"),j(this,"indexBuffer"),j(this,"vao"),j(this,"mode"),j(this,"glFlags",0),j(this,"id"),j(this,"colorId"),j(this,"modelMatrix",bt()),j(this,"scale",[1,1,1]),j(this,"position",[0,0,0]),j(this,"rotation",[0,0,0]),j(this,"rotationRadians",0),j(this,"extentsMin",[]),j(this,"extentsMax",[]),j(this,"furthestVertexFromOrigin"),j(this,"originNegate"),j(this,"fieldOfViewDeObliqueMM"),j(this,"mm"),this.vertexBuffer=n,this.indexCount=a,this.indexBuffer=s,this.vao=o,this.mode=i,this.id=e,this.colorId=[(e>>0&255)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255]}};j(Nt,"BLEND",1);j(Nt,"CULL_FACE",2);j(Nt,"CULL_FRONT",4);j(Nt,"CULL_BACK",8);j(Nt,"ENABLE_DEPTH_TEST",16);j(Nt,"generateCrosshairs",function(r,e,n,i,a,s,o=20,l=0){const c=Nt.generateCrosshairsGeometry(r,n,i,a,s,o,l);return new Nt(e,c.vertexBuffer,r.TRIANGLES,c.indexCount,c.indexBuffer,c.vao)});j(Nt,"generateCrosshairsGeometry",function(r,e,n,i,a,s=20,o=0){const l=[],c=[],u=a*o;if(u<=0){let m=Me(n[0],e[1],e[2]),y=Me(i[0],e[1],e[2]);Nt.makeCylinder(l,c,m,y,a,s),m=Me(e[0],n[1],e[2]),y=Me(e[0],i[1],e[2]),Nt.makeCylinder(l,c,m,y,a,s),m=Me(e[0],e[1],n[2]),y=Me(e[0],e[1],i[2]),Nt.makeCylinder(l,c,m,y,a,s)}else{let m=Me(n[0],e[1],e[2]),y=Me(e[0]-u,e[1],e[2]);Nt.makeCylinder(l,c,m,y,a,s,!1),m=Me(e[0]+u,e[1],e[2]),y=Me(i[0],e[1],e[2]),Nt.makeCylinder(l,c,m,y,a,s,!1),m=Me(e[0],n[1],e[2]),y=Me(e[0],e[1]-u,e[2]),Nt.makeCylinder(l,c,m,y,a,s,!1),m=Me(e[0],e[1]+u,e[2]),y=Me(e[0],i[1],e[2]),Nt.makeCylinder(l,c,m,y,a,s,!1),m=Me(e[0],e[1],n[2]),y=Me(e[0],e[1],e[2]-u),Nt.makeCylinder(l,c,m,y,a,s,!1),m=Me(e[0],e[1],e[2]+u),y=Me(e[0],e[1],i[2]),Nt.makeCylinder(l,c,m,y,a,s,!1)}const h=r.createBuffer();if(h===null)throw new Error("could not instantiate vertex buffer");r.bindBuffer(r.ARRAY_BUFFER,h),r.bufferData(r.ARRAY_BUFFER,new Float32Array(l),r.STATIC_DRAW);const g=r.createBuffer();if(g===null)throw new Error("could not instantiate index buffer");r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,g),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint32Array(c),r.STATIC_DRAW);const v=r.createVertexArray();return r.bindVertexArray(v),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,g),r.bindBuffer(r.ARRAY_BUFFER,h),r.enableVertexAttribArray(0),r.vertexAttribPointer(0,3,r.FLOAT,!1,0,0),r.bindVertexArray(null),{vertexBuffer:h,indexBuffer:g,indexCount:c.length,vao:v}});j(Nt,"getFirstPerpVector",function(r){const e=Me(0,0,0);return r[0]===0?e[0]=1:r[1]===0?e[1]=1:r[2]===0?e[2]=1:(e[0]=r[2],e[1]=r[2],e[2]=-(r[0]+r[1]),yi(e,e)),e});j(Nt,"subdivide",function(r,e){let n=r.length/3,i=e.length/3;const a=i,s=Kt(),o=Kt();for(let l=0;l<a;l++){const c=e[l*3+0],u=e[l*3+1],h=e[l*3+2],g=Me(r[c*3+0],r[c*3+1],r[c*3+2]),v=Me(r[u*3+0],r[u*3+1],r[u*3+2]),m=Me(r[h*3+0],r[h*3+1],r[h*3+2]);xo(s,g,v),yi(o,s),r.push(...o),xo(s,v,m),yi(o,s),r.push(...o),xo(s,g,m),yi(o,s),r.push(...o);let y=[n,n+1,n+2];e.push(...y),y=[c,n,n+2],e.push(...y),y=[n,u,n+1],e.push(...y),e[l*3+0]=n+2,e[l*3+1]=n+1,e[l*3+2]=h,i=i+3,n=n+3}});j(Nt,"weldVertices",function(r,e){const n=r.length/3;let i=0;const a=new Int32Array(n);for(let l=0;l<n-1;l++){if(a[l]!==0)continue;a[l]=i;let c=l*3;const u=r[c],h=r[c+1],g=r[c+2];for(let v=l+1;v<n;v++)c+=3,u===r[c]&&h===r[c+1]&&g===r[c+2]&&(a[v]=i);i++}if(i===n)return r;const s=e.length;for(let l=0;l<s;l++)e[l]=a[e[l]];const o=r.slice(0,i*3-1);for(let l=0;l<n-1;l++){const c=l*3,u=a[l]*3;o[u]=r[c],o[u+1]=r[c+1],o[u+2]=r[c+2]}return o});j(Nt,"makeSphere",function(r,e,n,i=[0,0,0]){let a=[0,0,1,.894,0,.447,.276,.851,.447,-.724,.526,.447,-.724,-.526,.447,.276,-.851,.447,.724,.526,-.447,-.276,.851,-.447,-.894,0,-.447,-.276,-.851,-.447,.724,-.526,-.447,0,0,-1];const s=[0,1,2,0,2,3,0,3,4,0,4,5,0,5,1,7,6,11,8,7,11,9,8,11,10,9,11,6,10,11,6,2,1,7,3,2,8,4,3,9,5,4,10,1,5,6,7,2,7,8,3,8,9,4,9,10,5,10,6,1];Nt.subdivide(a,s),Nt.subdivide(a,s),a=Nt.weldVertices(a,s);for(let u=0;u<a.length;u++)a[u]=a[u]*n;const o=a.length/3;let l=0;for(let u=0;u<o;u++)a[l]=a[l]+i[0],l++,a[l]=a[l]+i[1],l++,a[l]=a[l]+i[2],l++;const c=Math.floor(r.length/3);for(let u=0;u<s.length;u++)s[u]=s[u]+c;e.push(...s),r.push(...a)});j(Nt,"makeCylinder",function(r,e,n,i,a,s=20,o=!0){s<3&&(s=3);const l=Kt();Wt(l,i,n),yi(l,l);const c=Nt.getFirstPerpVector(l),u=Kt();Pd(u,l,c),yi(u,u);let h=2*s,g=2*s;o&&(g+=2*s,h+=2);const v=Math.floor(r.length/3),m=new Uint32Array(g*3),y=new Float32Array(h*3);function b(M,R){y[M*3+0]=R[0],y[M*3+1]=R[1],y[M*3+2]=R[2]}function x(M,R,T,B){m[M*3+0]=R+v,m[M*3+1]=T+v,m[M*3+2]=B+v}const A=2*s,C=A+1;o&&(b(A,n),b(C,i));const E=Kt(),S=Kt();for(let M=0;M<s;M++){const R=Math.cos(M/s*2*Math.PI),T=Math.sin(M/s*2*Math.PI);E[0]=a*(R*c[0]+T*u[0]),E[1]=a*(R*c[1]+T*u[1]),E[2]=a*(R*c[2]+T*u[2]),xo(S,n,E),b(M,S),xo(S,i,E),b(M+s,S);let B=0;M<s-1&&(B=M+1),x(M*2,M,B,M+s),x(M*2+1,B,B+s,M+s),o&&(x(s*2+M,M,A,B),x(s*2+M+s,C,M+s,B+s))}e.push(...m),r.push(...y)});j(Nt,"makeColoredCylinder",function(r,e,n,i,a,s,o=[192,0,0,255],l=20,c=!1){let u=r.length/3;Nt.makeCylinder(r,e,i,a,s,l,c),u=r.length/3-u;const h=[];for(let g=0;g<u*4-1;g+=4)h[g]=o[0],h[g+1]=o[1],h[g+2]=o[2],h[g+3]=o[3];n.push(...h)});j(Nt,"makeColoredSphere",function(r,e,n,i,a=[0,0,0],s=[0,0,192,255]){let o=r.length/3;Nt.makeSphere(r,e,i,a),o=r.length/3-o;const l=[];for(let c=0;c<o*4-1;c+=4)l[c]=s[0],l[c+1]=s[1],l[c+2]=s[2],l[c+3]=s[3];n.push(...l)});var Ro=Nt,BT=class Si{constructor({name:e="niivue",level:n="info"}={}){j(this,"level"),j(this,"name"),this.name=`${e}`,this.level=n}debug(...e){Si.levels[this.level]>Si.levels.debug||console.debug(`${this.name}-debug`,...e)}info(...e){Si.levels[this.level]>Si.levels.info||console.info(`${this.name}-info`,...e)}warn(...e){Si.levels[this.level]>Si.levels.warn||console.warn(`${this.name}-warn`,...e)}error(...e){Si.levels[this.level]>Si.levels.error||console.error(`${this.name}-error`,...e)}fatal(...e){Si.levels[this.level]>Si.levels.fatal||console.error(`${this.name}-fatal`,...e)}setLogLevel(e){this.level=e}setName(e){this.name=e}};j(BT,"levels",{debug:0,info:1,warn:2,error:3,fatal:4,silent:1/0});var LG=BT,Z=new LG({name:"niivue",level:"info"}),Gd={};Z0(Gd,{$itksnap:()=>_G,$slicer3d:()=>zG,actc:()=>GG,afni_blues_inv:()=>tY,afni_reds_inv:()=>rY,batlow:()=>qG,bcgwhw:()=>jG,bcgwhw_dark:()=>YG,blue:()=>ZG,blue2cyan:()=>XG,blue2magenta:()=>KG,blue2red:()=>HG,bluegrn:()=>QG,bone:()=>WG,bronze:()=>JG,cet_l17:()=>$G,cividis:()=>eq,cool:()=>tq,copper:()=>nq,copper2:()=>rq,ct_airways:()=>iq,ct_artery:()=>aq,ct_bones:()=>sq,ct_brain:()=>lq,ct_brain_gray:()=>oq,ct_cardiac:()=>uq,ct_head:()=>cq,ct_kidneys:()=>fq,ct_liver:()=>hq,ct_muscles:()=>dq,ct_scalp:()=>gq,ct_skull:()=>vq,ct_soft:()=>mq,ct_soft_tissue:()=>pq,ct_surface:()=>yq,ct_vessels:()=>Aq,ct_w_contrast:()=>xq,cubehelix:()=>bq,electric_blue:()=>wq,freesurfer:()=>Cq,ge_color:()=>Eq,gold:()=>Sq,gray:()=>Tq,green:()=>Mq,green2cyan:()=>Dq,green2orange:()=>Rq,hot:()=>Iq,hotiron:()=>Bq,hsv:()=>Nq,inferno:()=>Fq,jet:()=>kq,kry:()=>Uq,linspecer:()=>Vq,lipari:()=>Oq,magma:()=>Pq,mako:()=>Lq,navia:()=>_q,nih:()=>zq,plasma:()=>Gq,random:()=>qq,red:()=>Yq,redyell:()=>jq,rocket:()=>Hq,roi_i256:()=>nY,surface:()=>Kq,thermal:()=>Xq,turbo:()=>Qq,violet:()=>Zq,viridis:()=>Wq,warm:()=>Jq,winter:()=>$q,x_rain:()=>eY});var _G={R:[0,255,0,0,255,0,255,255,0,205,210,102,0,0,46,255,106,221,233,165,255,147,218,75,255,60,255,255,218,0,188,255,255,222,127,139,124,255,70,0,238,238,240,245,184,32,255,25,112,34,248,245,255,144,173,65,255,250,128,50,244,255,123,255,173,255,127,255,143,220,253,255,0,0,128,255,250,148,178,255,135,100,240,250,255,107,135,0,139,245,186,255,255,0,210,255,47,72,175,128,176,255,139,240,255,216,119,219,72,255,199,154,189,240,230,0,85,64,153,205,250,95,0,255,224,176,138,30,240,152,160],G:[0,0,255,0,255,255,0,239,0,133,180,205,0,139,139,228,90,160,150,42,250,112,112,0,182,179,235,228,165,128,143,105,218,184,255,69,252,255,130,100,130,232,255,222,134,178,20,25,128,139,248,255,160,238,255,105,99,240,0,205,164,255,104,165,216,192,255,140,188,20,245,250,206,255,0,250,128,0,34,127,206,149,230,235,245,142,206,0,0,245,85,228,222,191,105,248,79,61,238,128,224,240,0,255,215,191,136,112,209,0,21,205,183,248,230,250,107,224,50,92,250,158,128,69,255,196,43,144,128,251,82],B:[0,0,0,255,0,255,255,213,205,63,140,170,128,139,87,225,205,221,122,42,250,219,214,130,193,113,205,196,32,128,143,180,185,135,0,19,0,224,180,0,238,170,240,179,11,170,147,112,144,34,255,250,122,144,47,225,71,230,0,50,96,240,238,0,230,203,212,0,143,60,230,240,209,127,128,205,114,211,34,80,235,237,140,215,238,35,250,139,139,220,211,181,173,255,30,220,79,139,238,0,230,245,0,255,0,216,153,147,204,255,133,50,107,255,250,154,47,208,204,92,210,160,0,0,255,222,226,255,128,152,45],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130]},zG={labels:["background","tissue","bone","skin","connective tissue","blood","organ","mass","muscle","foreign object","waste","teeth","fat","gray matter","white matter","nerve","vein","artery","capillary","ligament","tendon","cartilage","meniscus","lymph node","lymphatic vessel","cerebro-spinal fluid","bile","urine","feces","gas","fluid","edema","bleeding","necrosis","clot","embolism","head","central nervous system","brain","gray matter of brain","telencephalon","cerebral cortex","right frontal lobe","left frontal lobe","right temporal lobe","left temporal lobe","right parietal lobe","left parietal lobe","right occipital lobe","left occipital lobe","right insular lobe","left insular lobe","right limbic lobe","left limbic lobe","right striatum","left striatum","right caudate nucleus","left caudate nucleus","right putamen","left putamen","right pallidum","left pallidum","right amygdaloid complex","left amygdaloid complex","diencephalon","thalamus","right thalamus","left thalamus","pineal gland","midbrain","substantia nigra","right substantia nigra","left substantia nigra","cerebral white matter","right superior longitudinal fasciculus","left superior longitudinal fasciculus","right inferior longitudinal fasciculus","left inferior longitudinal fasciculus","right arcuate fasciculus","left arcuate fasciculus","right uncinate fasciculus","left uncinate fasciculus","right cingulum bundle","left cingulum bundle","projection fibers","right corticospinal tract","left corticospinal tract","right optic radiation","left optic radiation","right medial lemniscus","left medial lemniscus","right superior cerebellar peduncle","left superior cerebellar peduncle","right middle cerebellar peduncle","left middle cerebellar peduncle","right inferior cerebellar peduncle","left inferior cerebellar peduncle","optic chiasm","right optic tract","left optic tract","right fornix","left fornix","commissural fibers","corpus callosum","posterior commissure","cerebellar white matter","CSF space","ventricles of brain","right lateral ventricle","left lateral ventricle","right third ventricle","left third ventricle","cerebral aqueduct","fourth ventricle","subarachnoid space","spinal cord","gray matter of spinal cord","white matter of spinal cord","endocrine system of brain","pituitary gland","adenohypophysis","neurohypophysis","meninges","dura mater","arachnoid","pia mater","muscles of head","salivary glands","lips","nose","tongue","soft palate","right inner ear","left inner ear","right external ear","left external ear","right middle ear","left middle ear","right eyeball","left eyeball","skull","right frontal bone","left frontal bone","right parietal bone","left parietal bone","right temporal bone","left temporal bone","right sphenoid bone","left sphenoid bone","right ethmoid bone","left ethmoid bone","occipital bone","maxilla","right zygomatic bone","right lacrimal bone","vomer bone","right palatine bone","left palatine bone","mandible","neck","muscles of neck","pharynx","larynx","thyroid gland","right parathyroid glands","left parathyroid glands","skeleton of neck","hyoid bone","cervical vertebral column","thorax","trachea","bronchi","right lung","left lung","superior lobe of right lung","superior lobe of left lung","middle lobe of right lung","inferior lobe of right lung","inferior lobe of left lung","pleura","heart","right atrium","left atrium","atrial septum","ventricular septum","right ventricle of heart","left ventricle of heart","mitral valve","tricuspid valve","aortic valve","pulmonary valve","aorta","pericardium","pericardial cavity","esophagus","thymus","mediastinum","skin of thoracic wall","muscles of thoracic wall","skeleton of thorax","thoracic vertebral column","ribs","sternum","right clavicle","left clavicle","abdominal cavity","abdomen","peritoneum","omentum","peritoneal cavity","retroperitoneal space","stomach","duodenum","small bowel","colon","anus","liver","biliary tree","gallbladder","pancreas","spleen","urinary system","right kidney","left kidney","right ureter","left ureter","urinary bladder","urethra","right adrenal gland","left adrenal gland","female internal genitalia","uterus","right fallopian tube","left fallopian tube","right ovary","left ovary","vagina","male internal genitalia","prostate","right seminal vesicle","left seminal vesicle","right deferent duct","left deferent duct","skin of abdominal wall","muscles of abdominal wall","skeleton of abdomen","lumbar vertebral column","female external genitalia","male external genitalia","skeleton of upper limb","muscles of upper limb","right upper limb","left upper limb","right shoulder","left shoulder","right arm"],R:[0,128,241,177,111,216,221,144,192,220,78,255,230,200,250,244,0,216,183,183,152,111,178,68,111,85,0,214,78,218,170,140,188,216,145,150,177,244,250,200,68,128,83,83,162,162,141,141,182,182,188,188,154,154,177,177,30,30,210,210,48,48,98,98,69,166,122,122,253,145,46,0,0,250,127,127,159,159,125,125,106,106,154,154,126,201,201,78,78,174,174,139,139,148,148,186,186,99,156,156,64,64,138,97,126,194,85,88,88,88,88,88,88,88,88,244,200,250,82,57,60,92,255,255,255,255,201,70,188,177,166,182,229,229,174,174,201,201,194,194,241,203,203,229,229,255,255,209,209,248,248,255,196,255,255,255,242,242,222,177,213,184,150,62,62,62,242,250,255,177,182,175,197,197,172,172,202,224,224,255,206,210,203,233,195,181,152,159,166,218,225,224,255,184,211,47,255,173,188,255,226,253,244,205,205,186,177,255,234,204,180,216,255,205,204,255,221,0,139,249,157,203,185,185,247,247,222,124,249,249,244,255,255,227,213,213,193,216,230,245,245,241,241,177,171,217,212,185,185,198,194,177,177,177,177,177],G:[0,174,214,122,184,101,130,238,104,245,63,250,220,200,250,214,151,101,156,214,189,184,212,172,197,188,145,230,63,255,250,224,65,191,60,98,122,214,250,200,131,174,146,146,115,115,93,93,166,166,135,135,150,150,140,140,111,111,157,157,129,129,153,153,110,113,101,101,135,92,101,108,108,250,150,150,116,116,102,102,174,174,146,146,126,160,160,152,152,140,140,126,126,120,120,135,135,106,171,171,123,123,95,113,161,195,188,106,106,106,106,106,106,106,106,214,200,250,174,157,143,162,244,244,244,244,121,163,91,122,84,105,147,147,122,122,112,112,142,142,213,179,179,204,204,243,243,185,185,223,223,230,172,255,250,237,217,217,198,122,124,105,208,162,162,162,206,210,255,122,228,216,165,165,138,138,164,186,186,245,110,115,108,138,100,85,55,63,70,123,130,97,244,122,171,150,244,121,95,239,202,232,217,179,179,124,122,255,234,142,119,132,253,167,168,224,130,145,150,180,108,136,102,102,182,182,154,186,186,186,170,181,190,153,141,141,123,146,158,172,172,172,172,124,85,198,188,135,135,175,98,122,122,122,122,122],B:[0,128,145,101,210,79,101,144,88,20,0,220,70,235,210,49,206,79,220,211,207,210,242,100,131,255,30,130,0,255,250,228,28,216,66,83,101,49,225,215,98,128,164,164,105,105,137,137,110,110,166,166,201,201,190,190,85,85,166,166,126,126,112,112,53,137,38,38,192,109,131,112,112,225,88,88,163,163,154,154,155,155,83,83,55,133,133,141,141,103,103,177,177,72,72,135,135,24,108,108,147,147,74,158,197,164,255,215,215,215,215,215,215,215,215,49,215,225,128,110,83,109,209,209,209,209,77,117,95,101,94,107,118,118,90,90,73,73,0,0,144,77,77,109,109,152,152,85,85,131,131,138,68,167,160,145,123,123,101,101,109,108,243,114,114,114,142,139,207,101,255,244,145,145,115,115,140,162,162,217,84,89,81,112,73,57,13,27,38,97,104,76,209,154,143,103,209,88,76,172,134,158,154,108,108,161,101,220,194,178,153,105,229,142,143,199,101,30,98,111,162,116,83,83,164,164,132,223,150,150,147,158,165,130,113,113,103,127,140,147,147,151,151,92,68,131,102,134,134,125,79,101,101,101,101,101],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},GG={R:[0,0,24,248,255],G:[0,0,177,254,0],B:[0,136,0,0,0],A:[0,32,64,78,128],I:[0,64,128,156,255]},qG={R:[1,10,15,17,21,27,36,49,65,82,99,118,140,161,183,203,222,238,248,253,253,253,252,250],G:[25,42,56,68,79,88,97,105,111,116,122,127,133,138,142,146,150,155,162,170,178,186,195,204],B:[89,92,95,96,98,98,96,91,83,74,64,55,46,43,49,62,79,100,126,151,175,199,223,250],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},YG={R:[0,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[0,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[0,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},jG={R:[255,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[255,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[255,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},HG={R:[0,0,0,0,196,255],G:[0,32,128,128,128,32],B:[0,255,196,0,0,0],A:[0,128,64,64,64,128],I:[0,1,64,128,192,255]},KG={R:[0,255],G:[0,0],B:[255,255],A:[0,128],I:[0,255]},XG={R:[0,0],G:[0,255],B:[255,255],A:[0,128],I:[0,255]},QG={R:[0,0,0,0],G:[0,1,128,255],B:[0,222,127,32],A:[0,0,64,128],I:[0,1,128,255]},ZG={R:[0,0,0],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},WG={R:[0,103,255],G:[0,126,255],B:[0,165,255],A:[0,76,128],I:[0,153,255]},JG={R:[0,43,103,199,216,255],G:[0,0,37,155,213,255],B:[0,0,20,97,201,255],A:[0,44,48,54,56,56],I:[0,64,128,196,240,255]},$G={R:[0,9,24,33,40,46,52,57,62,66,70,74,78,81,85,88,91,94,98,101,103,106,109,112,114,117,119,121,124,126,128,130,133,135,137,139,141,143,145,147,149,151,153,155,157,159,161,163,164,166,168,169,171,172,174,175,177,178,180,181,183,184,186,187,189,190,191,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,222,223,224,224,225,226,226,227,228,228,229,229,230,231,231,232,233,233,234,234,235,235,236,236,236,237,237,237,238,238,238,239,239,239,240,240,240,241,241,241,242,242,242,243,243,243,243,243,243,243,243,244,244,244,244,244,244,244,244,244,244,244,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,244,244,244,244,244,244,244,244,244,244,244,244,244,244,244,243,243,243,243,243,243,243,243,243,243,243,243,242,242,242,242,242,242,242,242,241,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,243,243,244,244,245,246,246,247,247,248,249,249,250,250,251,251,252,252,253,253,254,254,254],G:[42,41,41,41,40,40,40,39,39,39,38,38,37,37,36,36,35,35,34,34,33,32,32,31,30,30,30,30,29,29,29,29,28,28,28,27,27,27,26,26,26,25,25,25,24,24,24,24,24,25,25,26,27,27,28,28,29,30,30,31,31,32,33,33,34,34,35,36,36,37,38,39,40,42,43,44,45,47,48,49,50,51,53,54,55,56,57,58,59,60,62,63,64,65,66,68,69,71,72,73,75,76,77,79,80,81,83,84,85,87,88,89,90,92,93,94,95,97,98,100,101,102,104,105,107,108,109,111,112,113,115,116,117,119,120,121,122,124,125,126,128,129,130,132,133,134,136,137,138,140,141,142,144,145,146,147,149,150,151,153,154,155,156,158,159,160,161,163,164,165,167,168,169,170,172,173,174,175,176,178,179,180,181,183,184,185,186,187,189,190,191,192,193,194,196,197,198,199,200,201,203,204,205,206,207,208,209,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,228,229,230,231,232,233,234,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,248,248,249,250,251,251,252,253,254,255],B:[167,167,166,166,166,165,165,165,164,164,164,163,163,162,162,162,161,161,161,160,160,160,159,159,158,158,157,157,156,155,155,154,154,153,153,152,151,151,150,150,149,149,148,147,147,146,146,145,144,144,143,143,142,141,141,140,139,139,138,137,137,136,135,135,134,133,133,132,131,131,130,130,129,128,128,127,127,126,125,125,124,124,123,123,122,121,121,120,119,119,118,118,117,116,116,116,115,115,114,114,113,113,113,112,112,111,111,110,110,109,109,109,108,108,107,107,106,106,106,106,106,105,105,105,105,105,105,105,104,104,104,104,104,103,103,103,103,103,102,102,102,103,103,103,103,104,104,104,104,104,105,105,105,105,106,106,106,106,106,107,107,107,107,108,108,109,110,111,111,112,113,113,114,115,115,116,117,117,118,119,120,120,121,122,122,123,124,125,126,128,129,130,131,132,134,135,136,137,138,140,141,142,143,144,146,147,148,149,150,152,153,155,157,158,160,162,163,165,167,168,170,172,173,175,177,178,180,182,183,185,187,188,190,193,196,199,201,204,207,210,212,215,218,221,224,226,229,232,235,238,240,243,246,249,252,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},eq={R:[0,86,166,255],G:[32,92,156,233],B:[76,108,117,69],A:[0,56,80,88],I:[0,64,192,255]},tq={R:[0,0,0],G:[127,196,254],B:[255,255,255],A:[0,64,128],I:[0,128,255]},rq={R:[0,61,122,183,244,255],G:[0,41,81,122,163,255],B:[0,25,51,76,102,255],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},nq={R:[0,61,122,183,244,255],G:[0,41,81,122,163,203],B:[0,25,51,76,102,127],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},iq={min:-643,max:-235,R:[0,0,0],G:[154,154,154],B:[179,179,101],A:[0,32,0],I:[0,163,255]},aq={min:114,max:800,R:[0,255,255,255],G:[0,0,129,255],B:[0,0,0,255],A:[0,64,88,228],I:[0,80,160,255]},sq={min:180,max:600,R:[0,0,113,255],G:[0,0,109,250],B:[0,0,101,245],A:[0,0,100,160],I:[0,1,128,255]},oq={min:-10,max:110,R:[0,127,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},lq={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},uq={min:-80,max:1e3,R:[0,189,150,150,150,150,255],G:[0,169,54,54,54,54,240],B:[0,153,52,52,52,52,242],A:[0,32,64,0,0,64,64],I:[0,1,82,92,234,242,255]},cq={min:-590,max:600,R:[0,241,241,248,248,178,178,232,255,255,255],G:[0,156,156,222,222,36,36,51,255,255,255],B:[0,130,130,169,169,24,24,37,255,255,255],A:[0,8,0,0,0,64,64,0,0,222,222],I:[0,2,3,64,122,142,172,182,252,253,255]},fq={min:114,max:302,R:[0,255,255],G:[0,129,255],B:[0,0,255],A:[0,88,228],I:[0,103,255]},hq={min:-23,max:246,R:[0,44,255,255,255],G:[0,128,90,255,255],B:[0,0,70,0,255],A:[0,0,82,184,228],I:[0,64,131,196,255]},dq={min:-100,max:246,R:[0,128,159,255,255,255,255],G:[0,0,56,90,0,255,255],B:[0,0,41,70,0,0,255],A:[0,63,105,135,167,184,228],I:[0,100,128,155,180,209,255]},gq={min:-590,max:600,R:[0,241,241,248,248,178,232,255,255],G:[0,156,156,222,222,36,51,255,255],B:[0,130,130,169,169,24,37,255,255],A:[0,63,105,135,167,184,228,228,228],I:[0,1,52,127,137,162,172,252,255]},vq={min:140,max:1024,R:[0,2,113,255],G:[0,1,109,250],B:[0,1,101,245],A:[0,1,96,168],I:[0,1,128,255]},mq={min:-923,max:679,R:[0,0,0,0,0,255,255,255],G:[154,154,154,154,0,0,254,255],B:[179,179,179,179,0,0,0,255],A:[0,3,8,0,0,10,15,20],I:[0,30,62,88,170,200,232,255]},pq={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},yq={min:-600,max:100,R:[0,134,255],G:[0,109,250],B:[0,101,245],A:[0,60,148],I:[0,128,255]},Aq={min:114,max:246,R:[0,255,255],G:[0,128,255],B:[0,128,255],A:[0,64,96],I:[0,87,255]},xq={min:50,max:1e3,R:[98,210,169,128,255],G:[94,26,77,128,255],B:[45,21,74,128,255],A:[0,25,0,4,168],I:[0,41,87,154,255]},bq={R:[0,13,21,26,27,25,22,21,22,28,39,54,75,98,124,148,171,189,202,210,213,211,206,200,195,193,195,201,211,225,240,255],G:[0,5,11,20,31,44,58,72,86,99,109,116,120,122,122,122,121,121,124,129,137,147,161,175,190,205,218,229,238,245,251,255],B:[0,14,30,46,61,71,77,78,75,68,60,52,48,47,53,65,83,105,131,157,183,205,222,235,241,243,242,240,239,240,245,255],A:[0,4,8,12,17,21,25,29,33,37,41,45,50,54,58,62,66,70,74,78,83,87,91,95,99,103,107,111,116,120,124,128],I:[0,8,16,25,33,41,49,58,66,74,82,90,99,107,115,123,132,140,148,156,165,173,181,189,197,206,214,222,230,239,247,255]},wq={R:[0,10,136,255],G:[0,39,220,255],B:[0,223,253,255],A:[0,48,64,70],I:[0,92,192,255]},Cq={R:[0,245,205,120,196,220,230,0,122,236,12,204,42,119,220,103,60,255,165,160,0,245,205,120,196,220,230,0,122,236,13,220,103,255,165,160,0,120,200,255,255,164,164,164,234,0,0,0,0,0],G:[0,245,62,18,58,248,148,118,186,13,48,182,204,159,216,255,60,165,42,32,200,245,62,18,58,248,148,118,186,13,48,216,255,165,42,32,200,190,70,148,148,108,108,108,169,0,0,0,0,0],B:[0,245,78,134,250,164,34,14,220,176,255,142,164,176,20,255,60,0,42,240,200,245,78,134,250,164,34,14,220,176,255,20,255,0,42,240,221,150,255,10,10,226,226,226,30,64,112,160,208,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,2,3,4,5,7,8,10,11,12,13,14,15,16,17,18,24,26,28,30,31,41,42,43,44,46,47,49,50,51,52,53,54,58,60,62,63,72,77,78,79,80,81,82,85,251,252,253,254,255]},Eq={R:[0,0,128,255,255],G:[0,128,0,128,255],B:[0,125,255,0,255],A:[0,32,64,96,128],I:[0,63,128,192,255]},Sq={R:[0,142,227,255],G:[0,85,170,255],B:[0,14,76,255],A:[0,42,84,128],I:[0,85,170,255]},Tq={R:[0,255],G:[0,255],B:[0,255],A:[0,128],I:[0,255]},Mq={R:[0,0,0],G:[0,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},Dq={R:[0,0,0],G:[72,72,255],B:[0,255,255],A:[0,64,128],I:[0,88,255]},Rq={R:[0,255,255],G:[72,88,255],B:[0,0,0],A:[0,64,128],I:[0,88,255]},Bq={R:[0,255,255,255],G:[0,0,126,255],B:[0,0,0,255],A:[0,64,96,128],I:[0,128,191,255]},Iq={R:[3,255,255,255],G:[0,0,255,255],B:[0,0,0,255],A:[0,48,96,128],I:[0,95,191,255]},Nq={R:[255,255,0,0,0,255,255],G:[0,255,255,255,0,0,0],B:[0,0,0,255,255,255,0],A:[0,14,28,43,57,71,85],I:[0,43,85,128,170,213,255]},Fq={R:[0,120,237,240],G:[0,28,105,249],B:[4,109,37,33],A:[0,56,80,88],I:[0,64,192,255]},kq={R:[0,0,127,255,127],G:[0,127,255,127,0],B:[127,255,127,0,0],A:[0,32,64,96,128],I:[0,63,128,192,255]},Uq={R:[0,255,255],G:[0,0,255],B:[0,0,0],A:[0,64,64],I:[0,86,255]},Vq={R:[94,50,90,152,215,238,249,254,252,241,209,158],G:[79,131,186,214,240,244,237,210,157,100,57,1],B:[162,189,167,164,155,169,168,123,86,68,79,66],A:[0,12,23,35,47,58,70,81,93,105,116,128],I:[0,23,46,70,93,116,139,162,185,209,232,255]},Oq={R:[3,7,13,25,45,67,84,98,110,124,138,154,173,191,210,225,233,233,231,229,230,235,243,253],G:[19,33,48,63,77,87,92,94,95,96,96,97,99,101,106,118,133,149,163,177,192,208,225,245],B:[38,58,79,99,114,122,122,120,117,113,110,105,101,97,94,96,103,112,122,134,149,169,192,218],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},Pq={R:[0,148,183,223,247,252],G:[0,44,55,74,112,253],B:[4,128,121,104,92,191],A:[0,44,53,64,75,107],I:[0,107,128,154,179,255]},Lq={R:[11,59,55,222],G:[4,45,165,245],B:[5,91,172,229],A:[0,23,70,107],I:[0,56,167,255]},_q={R:[3,5,6,8,12,19,28,36,42,48,54,61,68,76,86,96,110,129,154,181,205,224,239,252],G:[19,32,44,58,72,86,98,108,116,122,128,134,141,149,157,167,178,191,204,216,225,232,239,244],B:[39,60,82,104,123,137,144,145,142,138,134,130,126,121,116,110,105,104,112,131,155,178,198,217],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},zq={R:[0,85,0,0,0,0,0,0,85,255,255,255,172],G:[0,0,0,0,85,170,255,255,255,255,85,0,0],B:[0,170,85,255,255,170,170,0,85,0,0,0,0],A:[0,5,10,21,26,32,37,42,48,53,64,72,85],I:[0,15,31,63,79,95,111,127,143,159,191,217,255]},Gq={R:[13,156,237,240],G:[8,23,121,249],B:[135,158,83,33],A:[0,56,80,88],I:[0,64,192,255]},qq={R:[208,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248],G:[182,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21],B:[191,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},Yq={R:[0,128,255],G:[0,0,0],B:[0,0,0],A:[0,64,128],I:[0,128,255]},jq={R:[192,224,255],G:[1,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},Hq={R:[3,112,144,188,236,246,255],G:[5,31,29,22,76,158,250],B:[26,87,91,86,62,117,235],A:[0,30,38,49,67,85,107],I:[0,73,92,118,160,205,255]},Kq={R:[1,240,255],G:[1,128,255],B:[1,128,255],A:[0,76,128],I:[0,153,255]},Xq={R:[0,5,18,34,53,72,90,107,126,144,161,178,194,209,222,233,242,248,251,251,249,244,241,252],G:[0,4,10,11,9,11,17,23,30,36,43,50,59,70,83,98,117,136,157,177,199,220,240,254],B:[3,24,50,76,96,106,109,110,108,104,97,89,79,67,55,42,26,12,6,22,47,79,121,164],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},Qq={R:[48,48,64,70,65,25,132,195,244,254,218,122],G:[18,18,64,107,150,226,255,241,199,158,57,4],B:[59,59,162,227,255,187,81,52,58,47,7,3],A:[0,22,26,30,34,43,52,57,63,67,77,86],I:[0,1,16,32,49,83,118,140,164,181,219,255]},Zq={R:[0,128,255],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},Wq={R:[68,49,53,253],G:[1,104,183,231],B:[84,142,121,37],A:[0,56,80,88],I:[0,64,192,255]},Jq={R:[255,255,255],G:[127,196,254],B:[0,0,0],A:[0,64,128],I:[0,128,255]},$q={R:[0,0,0],G:[0,128,255],B:[255,196,128],A:[0,64,128],I:[0,128,255]},eY={R:[3,64,0,0,255,255,255],G:[0,0,0,255,255,192,3],B:[0,32,48,56,64,96,128],A:[0,8,16,24,32,52,80],I:[0,32,64,96,160,192,255]},tY={min:0,max:0,R:[0,37],G:[242,0],B:[255,255],A:[0,64],I:[0,255]},rY={R:[255,255],G:[255,11],B:[0,0],A:[0,64],I:[0,255]},nY={min:0,max:0,R:[65,10,223,120,216,207,251,93,252,217,21,253,131,165,173,143,144,217,86,89,63,254,172,1,142,107,42,78,221,8,222,71,127,126,167,33,104,2,208,216,0,251,7,105,2,101,248,190,253,62,255,224,166,37,110,138,45,34,6,37,69,201,43,122,199,37,173,194,103,211,75,159,96,4,239,98,110,193,253,166,40,255,48,130,140,243,101,9,177,220,133,32,4,81,48,48,210,109,60,132,1,119,1,159,247,33,212,187,253,144,196,254,168,79,64,196,39,97,73,173,104,216,217,43,101,119,254,5,237,103,203,122,57,87,251,164,19,75,200,2,252,150,66,0,255,157,23,254,55,16,240,161,69,253,207,195,5,60,255,251,200,217,134,123,253,180,27,246,130,136,250,232,4,125,140,22,253,255,13,180,123,61,254,111,10,185,76,192,255,223,186,61,198,5,172,13,83,172,171,6,23,73,134,133,109,61,213,55,57,132,36,209,2,144,1,253,68,155,3,160,2,77,121,70,67,176,223,131,4,162,232,255,150,94,235,191,207,10,246,0,225,4,209,116,57,112,172,253,1,6,92,227,73,62,135,223],G:[162,50,112,245,4,124,176,243,56,125,183,139,182,68,189,4,225,10,20,223,7,46,31,193,225,250,219,41,2,100,83,181,34,150,72,223,168,248,80,253,7,117,214,2,248,10,3,59,179,160,90,244,146,4,207,4,125,255,96,100,1,208,130,51,116,181,236,53,244,5,165,28,181,86,96,42,254,1,134,194,214,92,41,204,137,86,207,3,143,3,100,239,164,94,65,251,131,244,173,57,143,107,217,53,210,0,148,250,45,198,81,40,61,218,252,88,171,0,248,24,248,4,41,100,187,46,208,145,43,168,121,46,175,250,125,107,233,112,207,231,174,215,53,9,43,153,52,124,128,65,210,147,255,147,63,200,148,254,0,179,241,42,239,2,230,8,82,135,87,16,3,87,86,151,254,8,255,86,53,19,7,192,171,201,253,247,197,103,251,126,0,149,54,183,61,126,79,113,10,103,184,75,11,195,222,136,149,131,8,99,240,177,252,255,198,16,7,68,178,66,191,150,73,26,211,109,78,209,240,254,1,166,247,131,2,0,167,127,133,10,43,99,235,3,214,142,176,82,132,38,10,249,255,215,44,81],B:[176,182,248,37,117,35,96,69,32,152,108,20,237,250,2,89,141,216,111,251,211,149,10,44,214,103,31,251,3,32,252,246,97,1,219,167,197,4,36,116,206,118,106,43,205,204,114,69,127,205,87,80,41,251,145,204,253,161,247,1,149,9,43,253,97,72,136,161,171,181,26,255,108,80,218,214,231,255,84,31,109,4,218,3,217,36,68,85,241,39,221,2,240,2,173,42,206,5,110,46,103,27,212,184,2,207,246,45,116,72,110,253,38,105,248,159,243,81,192,93,141,145,24,157,234,131,57,178,62,75,65,176,148,40,253,66,76,240,51,154,17,251,139,253,207,9,114,49,200,254,96,73,138,118,204,102,137,89,145,161,4,112,66,234,147,178,212,205,185,11,203,131,2,250,118,169,1,185,154,53,171,197,61,175,249,96,15,254,95,5,222,75,246,194,2,61,180,25,133,165,15,233,59,35,221,140,109,7,114,255,198,0,115,168,252,23,242,80,75,142,137,255,12,182,68,201,4,111,37,228,83,248,24,192,249,5,54,223,160,122,160,114,145,119,252,31,253,250,10,214,8,47,0,142,222,70],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},iY=class{constructor(){j(this,"gamma",1),j(this,"version",.1),j(this,"cluts",{});const e=Object.keys(Gd).filter(n=>!n.startsWith("$")).sort(new Intl.Collator("en").compare);for(const n of e)this.cluts[n]=Gd[n]}addColormap(r,e){this.cluts[r]=e}colormaps(){return Object.keys(this.cluts)}colorMaps(){return this.colormaps()}colormapFromKey(r){let e=this.cluts[r];return e!==void 0||(e=this.cluts[r.toLowerCase()],e!==void 0)?e:(r.length>0&&Z.warn("No color map named "+r),{min:0,max:0,R:[0,255],G:[0,255],B:[0,255],A:[0,255],I:[0,255]})}colormap(r="",e=!1){const n=this.colormapFromKey(r);return this.makeLut(n.R,n.G,n.B,n.A,n.I,e)}makeLabelLut(r,e=255){if(r.R===void 0||r.G===void 0||r.B===void 0)throw new Error(`Invalid colormap table: ${r}`);const n=r.R.length,i=r.I??[...Array(n).keys()];if(n!==r.G.length||n!==r.B.length||n!==i.length)throw new Error(`colormap does not make sense: ${r} Rs ${r.R.length} Gs ${r.G.length} Bs ${r.B.length} Is ${i.length}`);let a=new Uint8ClampedArray(n).fill(e);a[0]=0,r.A!==void 0&&(a=Uint8ClampedArray.from(r.A));const s=Math.min(...i),o=Math.max(...i),l=o-s+1,c=new Uint8ClampedArray(l*4).fill(0);for(let h=0;h<n;h++){let g=(i[h]-s)*4;c[g++]=r.R[h],c[g++]=r.G[h],c[g++]=r.B[h],c[g++]=a[h]}const u={lut:c,min:s,max:o};if(r.labels){const h=r.labels.length;if(h===l)u.labels=r.labels;else if(h===n){u.labels=Array(l).fill("?");for(let g=0;g<n;g++){const v=i[g];u.labels[v]=r.labels[g]}}}return u}async makeLabelLutFromUrl(r){const n=await(await fetch(r)).json();return this.makeLabelLut(n)}makeDrawLut(r){let e=typeof r=="object"?r:Gd[r];e===void 0&&(Z.warn("colormap undefined ",r),e=this.colormapFromKey(""));const n=this.makeLabelLut(e,255);if(n.labels===void 0&&(n.labels=[]),n.labels.length<256){const o=n.labels.length;for(let l=o;l<256;l++)n.labels.push(l.toString())}const i=new Uint8ClampedArray(256*4);let a=0;for(let o=0;o<256;o++)i[a++]=255,i[a++]=0,i[a++]=0,i[a++]=255;i[3]=0;const s=Math.min(n.lut.length,256*4);if(s>0)for(let o=0;o<s;o++)i[o]=n.lut[o];return{lut:i,labels:n.labels}}makeLut(r,e,n,i,a,s){const o=r.length,l=[...r],c=[...e],u=[...n];if(!a){a=new Array(o);for(let m=0;m<o;m++)a[m]=m/(o-1)*255}i||(i=new Array(o).fill(64),i[0]=0);let h=Uint8ClampedArray.from(i),g=Uint8ClampedArray.from(a);if(s)for(let m=0;m<o;m++)l[m]=r[o-1-m],c[m]=e[o-1-m],u[m]=n[o-1-m],h[m]=255-i[o-1-m],g[m]=255-a[o-1-m];const v=new Uint8ClampedArray(256*4);if(typeof g>"u"){g=new Uint8ClampedArray(o).fill(0);for(let m=0;m<o;m++)g[m]=Math.round(m*255/(o-1))}typeof h>"u"&&(h=new Uint8ClampedArray(o).fill(64),h[0]=0);for(let m=0;m<o-1;m++){const y=g[m];let b=g[m+1];m===0&&y!==0&&Z.warn("colormap issue: indices expected to start with 0 not ",y),m===g.length-2&&b!==255&&(Z.warn("padding colormap: indices expected end with 255 not ",b),b=255);const x=b-y;let A=y*4;for(let C=y;C<=b;C++){const E=(C-y)/x;v[A++]=l[m]+E*(l[m+1]-l[m]),v[A++]=c[m]+E*(c[m+1]-c[m]),v[A++]=u[m]+E*(u[m+1]-u[m]),v[A++]=h[m]+E*(h[m+1]-h[m])}}if(this.gamma===1)return v;for(let m=0;m<1020;m++)m%4!==3&&(v[m]=Math.pow(v[m]/255,1/this.gamma)*255);return v}},Vt=new iY,ho=class{static getClusterBoundaryU8(r,e){const n=new Array(r.length).fill(!1),i=new Array(r.length).fill(!1);for(let o=0;o<r.length;o++)r[o]>0&&(i[o]=!0);const a=e.length/3;let s=0;for(let o=0;o<a;o++){const l=e[s],c=e[s+1],u=e[s+2];s+=3,!(i[l]===i[c]&&i[l]===i[u]&&i[c]===i[u])&&(n[l]=!0,n[c]=!0,n[u]=!0)}return n}static async gzip(r){const e=new CompressionStream("gzip"),n=e.writable.getWriter();n.write(r).catch(console.error);const i=n.close().catch(console.error),a=new Response(e.readable),s=new Uint8Array(await a.arrayBuffer());return await i,s}static createMZ3(r,e,n=!1,i=null){const s=i instanceof Uint8Array&&i.length===r.length/3*4,o=s?7:3,l=e.length/3,c=r.length/3,u=0,h=16,g=l*3*4,v=c*3*4,m=h+g+v,y=new ArrayBuffer(m),b=new DataView(y);b.setUint16(0,23117,!0),b.setUint16(2,o,!0),b.setUint32(4,l,!0),b.setUint32(8,c,!0),b.setUint32(12,u,!0);let x=h;if(new Uint32Array(y,x,e.length).set(e),x+=g,new Float32Array(y,x,r.length).set(r),s&&(x+=v,new Uint8Array(y,x,i.length).set(i)),n)throw new Error("Call async createMZ3Async() for compression");return y}static async createMZ3Async(r,e,n=!1,i=null){const a=this.createMZ3(r,e,n,i);return n?await this.gzip(new Uint8Array(a)):a}static createOBJ(r,e){let n="";for(let s=0;s<r.length;s+=3)n+=`v ${r[s]} ${r[s+1]} ${r[s+2]}
`;for(let s=0;s<e.length;s+=3)n+=`f ${e[s]+1} ${e[s+1]+1} ${e[s+2]+1}
`;return new TextEncoder().encode(n).buffer}static createSTL(r,e){const n=e.length/3,i=84+n*50,a=new ArrayBuffer(i),s=new DataView(a);for(let l=0;l<80;l++)s.setUint8(l,0);s.setUint32(80,n,!0);let o=84;for(let l=0;l<e.length;l+=3){const c=e[l]*3,u=e[l+1]*3,h=e[l+2]*3;s.setFloat32(o,0,!0),s.setFloat32(o+4,0,!0),s.setFloat32(o+8,0,!0),o+=12,s.setFloat32(o,r[c],!0),s.setFloat32(o+4,r[c+1],!0),s.setFloat32(o+8,r[c+2],!0),o+=12,s.setFloat32(o,r[u],!0),s.setFloat32(o+4,r[u+1],!0),s.setFloat32(o+8,r[u+2],!0),o+=12,s.setFloat32(o,r[h],!0),s.setFloat32(o+4,r[h+1],!0),s.setFloat32(o+8,r[h+2],!0),o+=12,s.setUint16(o,0,!0),o+=2}return a}static downloadArrayBuffer(r,e){const n=new Blob([r],{type:"application/octet-stream"}),i=URL.createObjectURL(n),a=document.createElement("a");a.href=i,a.download=e,document.body.appendChild(a),a.style.display="none",a.click(),setTimeout(()=>{document.body.removeChild(a),URL.revokeObjectURL(i)},0)}static async saveMesh(r,e,n=".mz3",i=!1){let a=new ArrayBuffer(0);return/\.obj$/i.test(n)?a=this.createOBJ(r,e):/\.stl$/i.test(n)?a=this.createSTL(r,e):(/\.mz3$/i.test(n)||(n+=".mz3"),a=await this.createMZ3Async(r,e,i)),n.length>4&&this.downloadArrayBuffer(a,n),a}static getClusterBoundary(r,e){const n=new Uint32Array(r.buffer),i=new Array(n.length).fill(!1),a=e.length/3;let s=0;for(let o=0;o<a;o++){const l=e[s],c=e[s+1],u=e[s+2];s+=3,!(n[l]===n[c]&&n[l]===n[u]&&n[c]===n[u])&&(i[l]=!0,i[c]=!0,i[u]=!0)}return i}static getExtents(r){if(!ArrayBuffer.isView(r)&&!Array.isArray(r)||r.length<3)return{mxDx:0,extentsMin:0,extentsMax:0};let e=0;const n=Me(r[0],r[1],r[2]),i=Me(r[0],r[1],r[2]);for(let o=0;o<r.length;o+=3){const l=Me(r[o],r[o+1],r[o+2]);e=Math.max(e,$c(l)),uy(n,n,l),cy(i,i,l)}const a=[n[0],n[1],n[2]],s=[i[0],i[1],i[2]];return{mxDx:e,extentsMin:a,extentsMax:s}}static generateNormals(r,e){const n=[];let i;const a=r.length;let s,o,l,c,u,h,g,v,m;const y=new Float32Array(a),b=e.length;for(i=0;i<b;i+=3){g=e[i]*3,v=e[i+1]*3,m=e[i+2]*3;const x=[r[g],r[g+1],r[g+2]],A=[r[v],r[v+1],r[v+2]],C=[r[m],r[m+1],r[m+2]];s=A[0]-x[0],o=A[1]-x[1],l=A[2]-x[2],c=C[0]-x[0],u=C[1]-x[1],h=C[2]-x[2],n[0]=u*l-h*o,n[1]=h*s-c*l,n[2]=c*o-u*s,y[g]+=n[0],y[g+1]+=n[1],y[g+2]+=n[2],y[v]+=n[0],y[v+1]+=n[1],y[v+2]+=n[2],y[m]+=n[0],y[m+1]+=n[1],y[m+2]+=n[2]}for(i=0;i<a;i+=3){n[0]=-1*y[i],n[1]=-1*y[i+1],n[2]=-1*y[i+2];let x=n[0]*n[0]+n[1]*n[1]+n[2]*n[2];x>0&&(x=1/Math.sqrt(x),n[0]*=x,n[1]*=x,n[2]*=x),y[i]=n[0],y[i+1]=n[1],y[i+2]=n[2]}return y}},rt,Fn,qd,h2,Ec,IT=class{constructor(r){uc(this,rt),uc(this,Fn,0),uc(this,qd,[]),uc(this,h2,[]),uc(this,Ec),Tl(this,rt,new DataView(r)),this.read()}async extract(r){const e=new Uint8Array(He(this,rt).buffer.slice(r.startsAt,r.startsAt+r.compressedSize));if(r.compressionMethod===0)return e;if(r.compressionMethod===8){const n=new DecompressionStream("deflate-raw"),i=n.writable.getWriter();i.write(e).catch(console.error);const a=i.close().catch(console.error),s=new Response(n.readable),o=new Uint8Array(await s.arrayBuffer());return await a,o}throw new Error(`Unsupported compression method: ${r.compressionMethod}`)}read(){for(;!He(this,Ec)&&He(this,Fn)<He(this,rt).byteLength;){const r=He(this,rt).getUint32(He(this,Fn),!0);if(r===67324752){const e=this.readLocalFile(He(this,Fn));e.extract=this.extract.bind(this,e),He(this,qd).push(e);const n=(e.generalPurpose&8)!==0;if(e.startsAt=He(this,Fn)+30+e.fileNameLength+e.extraLength,e.compressedSize===0&&n){let i=e.startsAt;for(;i+20<=He(this,rt).byteLength;){if(He(this,rt).getUint32(i,!0)===134695760&&He(this,rt).getUint16(i+16,!0)===19280){i+=4;break}i++}e.crc=He(this,rt).getUint32(i,!0),e.compressedSize=He(this,rt).getUint32(i+4,!0),e.uncompressedSize=He(this,rt).getUint32(i+8,!0),Tl(this,Fn,i+12)}else Tl(this,Fn,e.startsAt+e.compressedSize)}else if(r===33639248){const e=this.readCentralDirectory(He(this,Fn));He(this,h2).push(e),Tl(this,Fn,He(this,Fn)+(46+e.fileNameLength+e.extraLength+e.fileCommentLength))}else if(r===101010256){Tl(this,Ec,this.readEndCentralDirectory(He(this,Fn)));break}else if(r===101075792){Tl(this,Ec,this.readEndCentralDirectory64(He(this,Fn)));break}else{console.error(`Unexpected ZIP signature 0x${r.toString(16).padStart(8,"0")} at index ${He(this,Fn)}`);break}}}readLocalFile(r){let e=He(this,rt).getUint32(r+18,!0),n=He(this,rt).getUint32(r+22,!0);const i=He(this,rt).getUint16(r+26,!0),a=He(this,rt).getUint16(r+28,!0),s=r+30+i;if(this.readString(s,a),e===4294967295&&n===4294967295){let o=s,l=!1;for(;o<s+a-4;){const c=He(this,rt).getUint16(o,!0),u=He(this,rt).getUint16(o+2,!0);if(o+=4,c===1)if(u>=16){n=Number(He(this,rt).getBigUint64(o,!0)),o+=8,e=Number(He(this,rt).getBigUint64(o,!0)),l=!0;break}else throw new Error(`ZIP64 extra field found but is too small (expected at least 16 bytes, got ${u}).`);o+=u}if(!l)throw new Error("ZIP64 format missing extra field with signature 0x0001.")}return{signature:this.readString(r,4),version:He(this,rt).getUint16(r+4,!0),generalPurpose:He(this,rt).getUint16(r+6,!0),compressionMethod:He(this,rt).getUint16(r+8,!0),lastModifiedTime:He(this,rt).getUint16(r+10,!0),lastModifiedDate:He(this,rt).getUint16(r+12,!0),crc:He(this,rt).getUint32(r+14,!0),compressedSize:e,uncompressedSize:n,fileNameLength:i,extraLength:a,fileName:this.readString(r+30,i),extra:this.readString(r+30+i,a)}}readCentralDirectory(r){return{versionCreated:He(this,rt).getUint16(r+4,!0),versionNeeded:He(this,rt).getUint16(r+6,!0),fileNameLength:He(this,rt).getUint16(r+28,!0),extraLength:He(this,rt).getUint16(r+30,!0),fileCommentLength:He(this,rt).getUint16(r+32,!0),diskNumber:He(this,rt).getUint16(r+34,!0),internalAttributes:He(this,rt).getUint16(r+36,!0),externalAttributes:He(this,rt).getUint32(r+38,!0),offset:He(this,rt).getUint32(r+42,!0),comments:this.readString(r+46,He(this,rt).getUint16(r+32,!0))}}readEndCentralDirectory(r){const e=He(this,rt).getUint16(r+20,!0);return{numberOfDisks:He(this,rt).getUint16(r+4,!0),centralDirectoryStartDisk:He(this,rt).getUint16(r+6,!0),numberCentralDirectoryRecordsOnThisDisk:He(this,rt).getUint16(r+8,!0),numberCentralDirectoryRecords:He(this,rt).getUint16(r+10,!0),centralDirectorySize:He(this,rt).getUint32(r+12,!0),centralDirectoryOffset:He(this,rt).getUint32(r+16,!0),commentLength:e,comment:this.readString(r+22,e)}}readEndCentralDirectory64(r){const e=Number(He(this,rt).getBigUint64(r+0,!0));return{numberOfDisks:He(this,rt).getUint32(r+16,!0),centralDirectoryStartDisk:He(this,rt).getUint32(r+20,!0),numberCentralDirectoryRecordsOnThisDisk:Number(He(this,rt).getBigUint64(r+24,!0)),numberCentralDirectoryRecords:Number(He(this,rt).getBigUint64(r+32,!0)),centralDirectorySize:Number(He(this,rt).getBigUint64(r+40,!0)),centralDirectoryOffset:Number(He(this,rt).getBigUint64(r+48,!0)),commentLength:e,comment:""}}readString(r,e){return Array.from({length:e},(n,i)=>String.fromCharCode(He(this,rt).getUint8(r+i))).join("")}get entries(){return He(this,qd)}};rt=new WeakMap;Fn=new WeakMap;qd=new WeakMap;h2=new WeakMap;Ec=new WeakMap;var qe=class Bl{static arrayBufferToBase64(e){const n=new Uint8Array(e);return Bl.uint8tob64(n)}static async decompress(e){const n=e[0]===31&&e[1]===139&&e[2]===8?"gzip":e[0]===120&&(e[1]===1||e[1]===94||e[1]===156||e[1]===218)?"deflate":"deflate-raw",i=new DecompressionStream(n),a=i.writable.getWriter();a.write(e).catch(console.error);const s=a.close().catch(console.error),o=new Response(i.readable),l=new Uint8Array(await o.arrayBuffer());return await s,l}static async decompressToBuffer(e){const n=await Bl.decompress(e);return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}static async readMatV4(e,n=!1){let i=e.byteLength;if(i<40)throw new Error("File too small to be MAT v4: bytes = "+e.byteLength);let a=new DataView(e),s=a.getUint16(0,!0),o=e;if(s===35615||s===8075){const y=await this.decompress(new Uint8Array(e));a=new DataView(y.buffer),s=a.getUint16(0,!0),o=y.buffer,i=o.byteLength}const l=new TextDecoder("utf-8"),c=new Uint8Array(o);let u=0;const h={};function g(y){return Math.floor(y/10)%10}function v(y,b,x){const A=new Uint8Array(c.subarray(b,x));return y===1?new Float32Array(A.buffer):y===2?new Int32Array(A.buffer):y===3?new Int16Array(A.buffer):y===4?new Uint16Array(A.buffer):y===5?new Uint8Array(A.buffer):new Float64Array(A.buffer)}function m(){const y=a.getUint32(u,!0),b=a.getUint32(u+4,!0),x=a.getUint32(u+8,!0),A=a.getUint32(u+12,!0),C=a.getUint32(u+16,!0);if(u+=20,A!==0)throw new Error("Matlab V4 reader does not support imaginary numbers");const E=b*x;if(E<1)throw new Error("mrows * ncols must be greater than one");const S=new Uint8Array(c.subarray(u,u+C));let M=l.decode(S).trim().replaceAll("\0","");n&&(M=M.replaceAll(".","_"));const R=g(y);let T=8;if(R>=1&&R<=2)T=4;else if(R>=3&&R<=4)T=2;else if(R===5)T=1;else if(R!==0)throw new Error("impossible Matlab v4 datatype");if(u+=C,y>50)throw new Error("Does not appear to be little-endian V4 Matlab file");const B=u+E*T;h[M]=v(R,u,B),u=B}for(;u+20<i;)m();return h}static b64toUint8(e){const n=atob(e),i=n.length,a=new Uint8Array(i);for(let s=0;s<i;s++)a[s]=n.charCodeAt(s);return a}static uint8tob64(e){let n="";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=e.byteLength,s=a%3,o=a-s;let l,c,u,h,g;for(let v=0;v<o;v=v+3)g=e[v]<<16|e[v+1]<<8|e[v+2],l=(g&16515072)>>18,c=(g&258048)>>12,u=(g&4032)>>6,h=g&63,n+=i[l]+i[c]+i[u]+i[h];return s===1?(g=e[o],l=(g&252)>>2,c=(g&3)<<4,n+=i[l]+i[c]+"=="):s===2&&(g=e[o]<<8|e[o+1],l=(g&64512)>>10,c=(g&1008)>>4,u=(g&15)<<2,n+=i[l]+i[c]+i[u]+"="),n}static download(e,n,i){const a=document.createElement("a"),s=Array.isArray(e)?e:[e],o=new Blob(s,{type:i});a.href=URL.createObjectURL(o),a.download=n,a.click()}static readFileAsync(e){return new Promise((n,i)=>{const a=new FileReader;a.onload=()=>{n(a.result)},a.onerror=i,a.readAsArrayBuffer(e)})}static blobToBase64(e){return new Promise(n=>{const i=new FileReader;i.onloadend=()=>n(i.result),i.readAsDataURL(e)})}static async decompressBase64String(e){const n=atob(e),i=new ArrayBuffer(n.length),a=new Uint8Array(i);for(let s=0;s<n.length;s++)a[s]=n.charCodeAt(s);return Bl.decompressArrayBuffer(a)}static async compressToBase64String(e){const n=await Bl.compressStringToArrayBuffer(e);return Bl.uint8tob64(new Uint8Array(n))}static strToU8(e,n){if(n){const c=new Uint8Array(e.length);for(let u=0;u<e.length;++u)c[u]=e.charCodeAt(u);return c}const i=e.length,a=(c,u,h)=>((h==null||h>c.length)&&(h=c.length),new Uint8Array(c.subarray(u,h)));let s=new Uint8Array(e.length+(e.length>>1)),o=0;const l=c=>{s[o++]=c};for(let c=0;c<i;++c){if(o+5>s.length){const h=new Uint8Array(o+8+(i-c<<1));h.set(s),s=h}let u=e.charCodeAt(c);u<128||n?l(u):u<2048?(l(192|u>>6),l(128|u&63)):(u>55295&&u<57344,u=65536+(u&1047552)|e.charCodeAt(++c)&1023,l(240|u>>18),l(128|u>>12&63),l(128|u>>6&63),l(128|u&63))}return a(s,0,o)}static async compress(e,n="gzip"){const i=new CompressionStream(n),a=i.writable.getWriter();a.write(e).catch(console.error);const s=a.close().catch(console.error),l=await new Response(i.readable).arrayBuffer();return await s,l}static async compressStringToArrayBuffer(e){const n=this.strToU8(e);return await this.compress(n)}static isArrayBufferCompressed(e){if(e&&e.byteLength){const n=new Uint8Array(e);return(n[0]<<8|n[1])===8075}else return!1}static strFromU8(e,n){if(n){let i="";for(let a=0;a<e.length;a+=16384)i+=String.fromCharCode.apply(null,e.subarray(a,a+16384));return i}else{const i=(l,c,u)=>((c==null||c<0)&&(c=0),(u==null||u>l.length)&&(u=l.length),new Uint8Array(l.subarray(c,u))),a=l=>{for(let c="",u=0;;){let h=l[u++];const g=(h>127)+(h>223)+(h>239);if(u+g>l.length)return{s:c,r:i(l,u-1)};g?g===3?(h=((h&15)<<18|(l[u++]&63)<<12|(l[u++]&63)<<6|l[u++]&63)-65536,c+=String.fromCharCode(55296|h>>10,56320|h&1023)):g&1?c+=String.fromCharCode((h&31)<<6|l[u++]&63):c+=String.fromCharCode((h&15)<<12|(l[u++]&63)<<6|l[u++]&63):c+=String.fromCharCode(h)}},{s,r:o}=a(e);if(o.length)throw new Error("Unexpected trailing bytes in UTF-8 decoding");return s}}static async decompressArrayBuffer(e){const n=await this.decompress(new Uint8Array(e));return this.strFromU8(n)}static arraysAreEqual(e,n){return fz(e,n)}static range(e,n,i){return Array.from({length:(n-e)/i+1},(a,s)=>e+s*i)}static sph2cartDeg(e,n){const i=-n*(Math.PI/180),a=(e-90)%360*(Math.PI/180),s=[Math.cos(i)*Math.cos(a),Math.cos(i)*Math.sin(a),Math.sin(i)],o=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);return o<=0||(s[0]/=o,s[1]/=o,s[2]/=o),s}static vox2mm(e,n){const i=Er(n);Zn(i,i);const a=Jt(e[0],e[1],e[2],1);return Kr(a,a,i),Me(a[0],a[1],a[2])}},cc=Z,or=class jr{static readTRACT(e){const n=e.byteLength;if(n<20)throw new Error("File too small to be niml.tract: bytes = "+n);const i=new DataView(e),a=new Uint8Array(e);let s=0;function o(){for(;s<n&&a[s]!==60;)s++;const b=s;for(;s<n&&a[s]!==62;)s++;return s++,s-b<1?"":new TextDecoder().decode(e.slice(b,s-1)).trim()}let l=o();function c(b){const x=l.indexOf(b);if(x<0)return 0;const A=l.indexOf('"',x)+1,C=l.indexOf('"',A),E=l.slice(A,C);return parseInt(E)}const u=c("N_tracts=");(!l.startsWith("<network")||u<1)&&Z.warn("This is not a valid niml.tract file "+l);let h=0;const g=[];g.push(h);const v=[],m=[];for(let b=0;b<u;b++){l=o();const x=c("ni_dimen="),A=c("Bundle_Tag="),C=l.includes("binary.lsbfirst");for(let E=0;E<x;E++){s+=4;const S=i.getUint32(s,C)/3;s+=4;for(let M=0;M<S;M++)v.push(i.getFloat32(s,C)),s+=4,v.push(-i.getFloat32(s,C)),s+=4,v.push(i.getFloat32(s,C)),s+=4;h+=S,g.push(h),m.push(A)}l=o()}const y=[];return y.push({id:"tract",vals:Float32Array.from(m)}),{pts:new Float32Array(v),offsetPt0:new Uint32Array(g),dps:y}}static async readTT(e){let n=new Uint32Array(0),i=new Float32Array(0);const a=await qe.readMatV4(e);if(!("trans_to_mni"in a))throw new Error("TT format file must have 'trans_to_mni'");if(!("voxel_size"in a))throw new Error("TT format file must have 'voxel_size'");if(!("track"in a))throw new Error("TT format file must have 'track'");let s=bt();const o=a.trans_to_mni;s=Wn(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15]),Zn(s,s);function l(c){const u=new DataView(c.buffer),h=[];let g=0,v=0;for(;v<c.length;){h.push(v);const b=u.getUint32(v,!0);v=v+b+13,g+=b}n=new Uint32Array(h.length+1),i=new Float32Array(g);let m=0;for(let b=0;b<h.length;b++){n[b]=m/3;let x=h[b];const A=u.getUint32(x,!0)/3;let C=u.getInt32(x+4,!0),E=u.getInt32(x+8,!0),S=u.getInt32(x+12,!0);x+=16,i[m++]=C,i[m++]=E,i[m++]=S;for(let M=2;M<=A;M++)C=C+u.getInt8(x++),E=E+u.getInt8(x++),S=S+u.getInt8(x++),i[m++]=C,i[m++]=E,i[m++]=S}for(let b=0;b<m;b++)i[b]=i[b]/32;let y=0;for(let b=0;b<m/3;b++){const x=Jt(i[y],i[y+1],i[y+2],1);Kr(x,x,s),i[y++]=x[0],i[y++]=x[1],i[y++]=x[2]}n[h.length]=m/3}return l(a.track),{pts:i,offsetPt0:n}}static async readTRX(e){function n(m){const y=(m&31744)>>10,b=m&1023;return(m>>15?-1:1)*(y?y===31?b?NaN:1/0:Math.pow(2,y-15)*(1+b/1024):6103515625e-14*(b/1024))}let i=0,a=0,s=new Float32Array([]);const o=[],l=[],c=[],u=[];let h=[],g=!1;const v=new IT(e);for(let m=0;m<v.entries.length;m++){const y=v.entries[m];if(y.uncompressedSize===0)continue;const b=y.fileName.split("/"),x=b.slice(-1)[0];if(x.startsWith("."))continue;const A=b.slice(-2)[0],C=x.split(".")[0],E=await y.extract();if(x.includes("header.json")){const R=new TextDecoder().decode(E);h=JSON.parse(R);continue}let S=0,M=[];if(x.endsWith(".uint64")||x.endsWith(".int64")){S=E.length/8,M=new Uint32Array(S);const R=new Uint32Array(E.buffer);let T=0;for(let B=0;B<S;B++)M[B]=R[T],R[T+1]!==0&&(g=!0),T+=2}else if(x.endsWith(".uint32"))M=new Uint32Array(E.buffer);else if(x.endsWith(".uint16"))M=new Uint16Array(E.buffer);else if(x.endsWith(".uint8"))M=new Uint8Array(E.buffer);else if(x.endsWith(".int32"))M=new Int32Array(E.buffer);else if(x.endsWith(".int16"))M=new Int16Array(E.buffer);else if(x.endsWith(".int8"))M=new Int8Array(E.buffer);else if(x.endsWith(".float64"))M=new Float64Array(E.buffer);else if(x.endsWith(".float32"))M=new Float32Array(E.buffer);else if(x.endsWith(".float16")){S=E.length/2,M=new Float32Array(S);const R=new Uint16Array(E.buffer),T=new Float32Array(65536);for(let B=0;B<65536;B++)T[B]=n(B);for(let B=0;B<S;B++)M[B]=T[R[B]]}else continue;if(S=M.length,A.includes("groups")){l.push({id:C,vals:Float32Array.from(M.slice())});continue}if(A.includes("dpv")){u.push({id:C,vals:Float32Array.from(M.slice())});continue}if(A.includes("dps")){c.push({id:C,vals:Float32Array.from(M.slice())});continue}if(x.startsWith("offsets.")){i=S;for(let R=0;R<S;R++)o[R]=M[R]}x.startsWith("positions.3.")&&(a=S,s=new Float32Array(M))}if(i===0||a===0)throw new Error("Failure reading TRX format (no offsets or points).");if(g)throw new Error("Too many vertices: JavaScript does not support 64 bit integers");return o[i]=a/3,{pts:s,offsetPt0:new Uint32Array(o),dpg:l,dps:c,dpv:u,header:h}}static readTSF(e,n=0){const i=new Float32Array(n),a=e.byteLength;if(a<20)throw new Error("File too small to be TSF: bytes = "+a);const s=new Uint8Array(e);let o=0;function l(){for(;o<a&&s[o]===10;)o++;const v=o;for(;o<a&&s[o]!==10;)o++;return o++,o-v<1?"":new TextDecoder().decode(e.slice(v,o-1))}let c=l();if(!c.includes("mrtrix track scalars"))throw new Error("Not a valid TSF file");let u=-1;for(;o<a&&!c.includes("END");)if(c=l(),c.toLowerCase().startsWith("file:")&&(u=parseInt(c.split(" ").pop())),c.toLowerCase().startsWith("datatype:")&&!c.endsWith("Float32LE"))throw new Error("Only supports TSF files with Float32LE");if(u<20)throw new Error("Not a valid TSF file (missing file offset)");o=u;const h=new DataView(e);let g=0;for(;o+4<=a&&g<n;){const v=h.getFloat32(o,!0);if(o+=4,isFinite(v))i[g++]=v;else if(!isNaN(v))break}return i}static readTCK(e){const n=e.byteLength;if(n<20)throw new Error("File too small to be TCK: bytes = "+n);const i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]===10;)a++;const y=a;for(;a<n&&i[a]!==10;)a++;return a++,a-y<1?"":new TextDecoder().decode(e.slice(y,a-1))}let o=s();if(!o.includes("mrtrix tracks"))throw new Error("Not a valid TCK file");let l=-1;for(;a<n&&!o.includes("END");)o=s(),o.toLowerCase().startsWith("file:")&&(l=parseInt(o.split(" ").pop()));if(l<20)throw new Error("Not a valid TCK file (missing file offset)");a=l;const c=new DataView(e);let u=0,h=new Uint32Array(n/16),g=0,v=0,m=new Float32Array(n/4);for(h[0]=0;a+12<n;){const y=c.getFloat32(a,!0);a+=4;const b=c.getFloat32(a,!0);a+=4;const x=c.getFloat32(a,!0);if(a+=4,isFinite(y))m[v++]=y,m[v++]=b,m[v++]=x,u++;else if(h[g++]=u,!isNaN(y))break}return m=m.slice(0,v),h=h.slice(0,g),{pts:m,offsetPt0:h}}static async readTRK(e){let n=new DataView(e),i=n.getUint32(0,!0);if(i!==1128354388){let U;if(i===4247762216)throw new Error("zstd TRK decompression is not supported");U=await qe.decompress(new Uint8Array(e)),e=U.buffer,n=new DataView(e),i=n.getUint32(0,!0)}const a=n.getUint32(992,!0),s=n.getUint32(996,!0);if(a>2||s!==1e3||i!==1128354388)throw new Error("Not a valid TRK file");const o=n.getInt16(36,!0),l=[];for(let U=0;U<o;U++){const k=new Uint8Array(e.slice(38+U*20,58+U*20)),O=new TextDecoder().decode(k).split("\0").shift();l.push({id:O.trim(),vals:[]})}const c=n.getFloat32(12,!0),u=n.getFloat32(16,!0),h=n.getFloat32(20,!0),g=Wn(1/c,0,0,-.5,0,1/u,0,-.5,0,0,1/h,-.5,0,0,0,1),v=n.getInt16(238,!0),m=[];for(let U=0;U<v;U++){const k=new Uint8Array(e.slice(240+U*20,260+U*20)),O=new TextDecoder().decode(k).split("\0").shift();m.push({id:O.trim(),vals:[]})}const y=bt();for(let U=0;U<16;U++)y[U]=n.getFloat32(440+U*4,!0);y[15]===0&&(Z.warn("TRK vox_to_ras not set"),sT(y));const b=bt();oT(b,g,y);let x=null,A=null;x=new Int32Array(e.slice(s)),A=new Float32Array(x.buffer);const C=x.length;if(C<1)throw new Error("Empty TRK file.");let E=0,S=0,M=new Uint32Array(x.length/4),R=0,T=new Float32Array(x.length),B=0;for(;E<C;){const U=x[E];E=E+1,M[R++]=S;for(let k=0;k<U;k++){const O=A[E+0],V=A[E+1],L=A[E+2];if(E+=3,T[B++]=O*b[0]+V*b[1]+L*b[2]+b[3],T[B++]=O*b[4]+V*b[5]+L*b[6]+b[7],T[B++]=O*b[8]+V*b[9]+L*b[10]+b[11],o>0)for(let P=0;P<o;P++)l[P].vals.push(A[E]),E++;S++}if(v>0)for(let k=0;k<v;k++)m[k].vals.push(A[E]),E++}const F=[];for(let U=0;U<m.length;U++)F.push({id:m[U].id,vals:Float32Array.from(m[U].vals)});const I=[];for(let U=0;U<l.length;U++)I.push({id:l[U].id,vals:Float32Array.from(l[U].vals)});return M[R++]=S,T=T.slice(0,B),M=M.slice(0,R),{pts:T,offsetPt0:M,dps:F,dpv:I}}static readTxtVTK(e){const a=new TextDecoder("utf-8").decode(e).split(`
`);if(a.length<7||!a[0].startsWith("# vtk DataFile"))throw new Error("Invalid VTK image");if(!a[2].startsWith("ASCII"))throw new Error("Not ASCII VTK mesh");let o=3;for(;a[o].length<1;)o++;if(!a[o].includes("POLYDATA"))throw new Error("Not ASCII VTK polydata");for(o++;a[o].length<1;)o++;if(!a[o].startsWith("POINTS"))throw new Error("Not VTK POINTS");let l=a[o].trim().split(/\s+/);const c=parseInt(l[1]),u=c*3,h=new Float32Array(c*3);let g=0;for(;g<c*3;){o++;const b=a[o].trim().trim().split(/\s+/);for(let x=0;x<b.length&&!(g>=u);x++)h[g]=parseFloat(b[x]),g++}const v=[];for(o++;a[o].length<1;)o++;if(a[o].startsWith("METADATA")){for(;a[o].length>1;)o++;o++}if(l=a[o].trim().split(/\s+/),o++,l[0].includes("LINES")){const y=parseInt(l[1]);if(y<1)throw new Error("Corrupted VTK ASCII");let b=a[o].trim();const x=[];let A=[];if(b.startsWith("OFFSETS")){o++;let C=0;for(;C<y;){b=a[o].trim(),o++;const E=b.trim().split(/\s+/);for(let S=0;S<E.length&&(x[C]=parseInt(E[S]),C++,!(C>=y));S++);}A=Array.from(h)}else{let C=function(){b=a[o].trim();const R=b.trim().split(/\s+/);S=[];for(let T=0;T<R.length;T++)S.push(parseInt(R[T]));M=0,o++},E=0;x[0]=0;let S=[],M=0;C();for(let R=0;R<y;R++){M>=S.length&&C();const T=S[M++];E+=T,x[R+1]=E;for(let B=0;B<T;B++){M>=S.length&&C();const F=S[M++]*3;A.push(h[F+0]),A.push(h[F+1]),A.push(h[F+2])}}}return{pts:Float32Array.from(A),offsetPt0:Uint32Array.from(x)}}else if(l[0].includes("TRIANGLE_STRIPS")){const y=parseInt(l[1]);for(let b=0;b<y;b++){const x=a[o].trim();o++;const A=x.trim().split(/\s+/),C=parseInt(A[0])-2;let E=1;for(let S=0;S<C;S++)S%2?(v.push(parseInt(A[E+2])),v.push(parseInt(A[E+1])),v.push(parseInt(A[E]))):(v.push(parseInt(A[E])),v.push(parseInt(A[E+1])),v.push(parseInt(A[E+2]))),E+=1}}else if(l[0].includes("POLYGONS")){const y=parseInt(l[1]);for(let b=0;b<y;b++){const x=a[o].trim();o++;const A=x.trim().split(/\s+/),C=parseInt(A[0])-2,E=parseInt(A[1]);let S=parseInt(A[2]);for(let M=0;M<C;M++){const R=parseInt(A[3+M]);v.push(E),v.push(S),v.push(R),S=R}}}else throw new Error("Unsupported ASCII VTK datatype "+l[0]);const m=new Uint32Array(v);return{positions:h,indices:m}}static async readLayer(e="",n,i,a=.5,s="warm",o="winter",l=!1,c=null,u=null,h=0){const g={...vY,colormapInvert:!1,colormapType:0,isTransparentBelowCalMin:!0,isAdditiveBlend:!1,colorbarVisible:!0,colormapLabel:null},v=/(?:\.([^.]+))?$/;let m=v.exec(e)[1];m=m.toUpperCase(),m==="GZ"&&(m=v.exec(e.slice(0,-3))[1],m=m.toUpperCase());const y=i.vertexCount/3;if(i.offsetPt0){if(m!=="TSF")throw new Error("readLayer for streamlines only supports TSF files.");const A=i.pts.length/3,C=e.split("/");let E="Unknown";C.length>1&&C.pop()&&(E=E.split(".").slice(0,-1).join("."));const S=jr.readTSF(n,A);i.dpv||(i.dpv=[]);const M=S.reduce((T,B)=>Math.min(T,B)),R=S.reduce((T,B)=>Math.max(T,B));return i.dpv.push({id:E,vals:Float32Array.from(S.slice()),global_min:M,global_max:R,cal_min:M,cal_max:R}),g}if(y<3){Z.error("n_vert < 3 in layer");return}if(m==="MZ3"){const A=await jr.readMZ3(n,y);g.values=A.scalars,"colormapLabel"in A&&(g.colormapLabel=A.colormapLabel)}else if(m==="ANNOT"){const A=jr.readANNOT(n,y,!0);A instanceof Uint32Array?g.values=A:(g.values=A.scalars,g.colormapLabel=A.colormapLabel)}else if(m==="CRV"||m==="CURV"||m==="THICKNESS"||m==="AREA")g.values=jr.readCURV(n,y),g.isTransparentBelowCalMin=!1;else if(m==="GII"){const A=await jr.readGII(n,y);g.values=A.scalars,g.colormapLabel=A.colormapLabel}else if(m==="MGH"||m==="MGZ"){const A=await jr.readMGH(n,y,!0);"scalars"in A?(g.values=A.scalars,g.colormapLabel=A.colormapLabel):g.values=A}else if(m==="NII")g.values=await jr.readNII(n,y,i.anatomicalStructurePrimary);else if(m==="SMP")g.values=await jr.readSMP(n,y);else if(m==="STC")g.values=jr.readSTC(n,y);else if(jr.isCurv(n))g.values=jr.readCURV(n,y),g.isTransparentBelowCalMin=!1;else return Z.warn("Unknown layer overlay format "+e),g;if(!g.values){Z.error("no values in layer");return}g.nFrame4D=g.values.length/y,g.frame4D=0,g.outlineBorder=h;let b=g.values[0],x=g.values[0];for(let A=0;A<g.values.length;A++)b=Math.min(b,g.values[A]),x=Math.max(x,g.values[A]);return g.global_min=b,g.global_max=x,g.cal_min=c||0,c||(g.cal_min=b),g.cal_max=u||0,u||(g.cal_max=x),g.cal_minNeg=NaN,g.cal_maxNeg=NaN,g.opacity=a,g.colormap=s,g.colormapNegative=o,g.useNegativeCmap=l,g}static async readSMP(e,n){const i=e.byteLength;let a=new DataView(e),s=a.getUint16(0,!0);if(s>5){const g=await qe.decompress(new Uint8Array(e));a=new DataView(g.buffer),s=a.getUint16(0,!0),e=g.buffer}s>5&&Z.error("Unsupported or invalid BrainVoyager SMP version "+s);const o=a.getUint32(2,!0);o!==n&&Z.error("SMP file has "+o+" vertices, background mesh has "+n);const l=a.getUint16(6,!0),c=new Float32Array(o*l);let u=9;function h(){const g=u;for(;u<i&&a.getUint8(u)!==0;)u++;return u++,new TextDecoder().decode(e.slice(g,u-1))}h();for(let g=0;g<l;g++){const v={};v.mapType=a.getUint32(u,!0),u+=4,s>=3&&v.mapType===3&&(v.nLags=a.getUint32(u,!0),u+=4,v.mnLag=a.getUint32(u,!0),u+=4,v.mxLag=a.getUint32(u,!0),u+=4,v.ccOverlay=a.getUint32(u,!0),u+=4),v.clusterSize=a.getUint32(u,!0),u+=4,v.clusterCheck=a.getUint8(u),u+=1,v.critThresh=a.getFloat32(u,!0),u+=4,v.maxThresh=a.getFloat32(u,!0),u+=4,s>=4&&(v.includeValuesGreaterThreshMax=a.getUint32(u,!0),u+=4),v.df1=a.getUint32(u,!0),u+=4,v.df2=a.getUint32(u,!0),u+=4,s>=5?(v.posNegFlag=a.getUint32(u,!0),u+=4):v.posNegFlag=3,v.cortexBonferroni=a.getUint32(u,!0),u+=4,v.posMinRGB=[0,0,0],v.posMaxRGB=[0,0,0],v.negMinRGB=[0,0,0],v.negMaxRGB=[0,0,0],s>=2&&(v.posMinRGB[0]=a.getUint8(u),u++,v.posMinRGB[1]=a.getUint8(u),u++,v.posMinRGB[2]=a.getUint8(u),u++,v.posMaxRGB[0]=a.getUint8(u),u++,v.posMaxRGB[1]=a.getUint8(u),u++,v.posMaxRGB[2]=a.getUint8(u),u++,s>=4&&(v.negMinRGB[0]=a.getUint8(u),u++,v.negMinRGB[1]=a.getUint8(u),u++,v.negMinRGB[2]=a.getUint8(u),u++,v.negMaxRGB[0]=a.getUint8(u),u++,v.negMaxRGB[1]=a.getUint8(u),u++,v.negMaxRGB[2]=a.getUint8(u),u++),v.enableSMPColor=a.getUint8(u),u++,s>=4&&(v.lut=h()),v.colorAlpha=a.getFloat32(u,!0),u+=4),v.name=h();const m=new Float32Array(e,u,o);c.set(m,g*o),u+=o*4}return c}static readSTC(e,n){const i=new DataView(e),a=i.getInt32(8,!1);if(a!==n)throw new Error("Overlay has "+a+" vertices, expected "+n);let s=12+a*4;const o=i.getUint32(s,!1);s+=4;const l=new Float32Array(o*a);for(let c=0;c<o*a;c++)l[c]=i.getFloat32(s,!1),s+=4;return l}static isCurv(e){const n=new DataView(e),i=n.getUint8(0),a=n.getUint8(1),s=n.getUint8(2);return i!==255||a!==255||s!==255?(cc.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),!1):!0}static readCURV(e,n){const i=new DataView(e),a=i.getUint8(0),s=i.getUint8(1),o=i.getUint8(2),l=i.getUint32(3,!1),c=i.getUint32(11,!1);if((a!==255||s!==255||o!==255)&&cc.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),n!==l)throw new Error("CURV file has different number of vertices ( "+l+")than mesh ("+n+")");if(e.byteLength<15+4*l*c)throw new Error("CURV file smaller than specified");const u=new Float32Array(c*l);let h=15;for(let y=0;y<c*l;y++)u[y]=i.getFloat32(h,!1),h+=4;let g=u[0],v=u[0];for(let y=0;y<u.length;y++)g=Math.min(g,u[y]),v=Math.max(v,u[y]);const m=1/(v-g);for(let y=0;y<u.length;y++)u[y]=1-(u[y]-g)*m;return u}static readANNOT(e,n,i=!1){const a=new DataView(e),s=a.getUint32(0,!1),o=this.decimateLayerVertices(s,n);if(n!==o)throw new Error("ANNOT file has different number of vertices than mesh");if(e.byteLength<4+8*s)throw new Error("ANNOT file smaller than specified");let l=0;const c=new Uint32Array(s);for(let E=0;E<s;E++){const S=a.getUint32(l+=4,!1);c[S]=a.getUint32(l+=4,!1)}if(!i)return c;let u=0;try{u=a.getInt32(l+=4,!1)}catch{return c}if(u!==1||a.getInt32(l+=4,!1)>0)return c;const v=a.getInt32(l+=4,!1),m=a.getInt32(l+=4,!1);l+=m;const y=a.getInt32(l+=4,!1);if(y<1)return c;const b={R:Array(v).fill(0),G:Array(v).fill(0),B:Array(v).fill(0),A:Array(v).fill(0),I:Array(v).fill(0),labels:Array(v).fill("")};for(let E=0;E<y;E++){const S=a.getInt32(l+=4,!1),M=a.getInt32(l+=4,!1);l+=4;let R="";for(let U=0;U<M;U++){const k=a.getUint8(l++);if(k===0)break;R+=String.fromCharCode(k)}l-=4;const T=a.getInt32(l+=4,!1),B=a.getInt32(l+=4,!1),F=a.getInt32(l+=4,!1),I=a.getInt32(l+=4,!1);if(S<0||S>=v){Z.warn("annot entry out of range");continue}b.R[S]=T,b.G[S]=B,b.B[S]=F,b.A[S]=I,b.I[S]=(I<<24)+(F<<16)+(B<<8)+T,b.labels[S]=R}const x=new Float32Array(s);x.fill(-1);let A=0;for(let E=0;E<n;E++){const S=c[E];for(let M=0;M<v;M++)if(b.I[M]===S){x[E]=M;break}x[E]<0&&(A++,x[E]=0)}A>0&&Z.error(`annot vertex colors do not match ${A} of ${s} vertices.`);for(let E=0;E<v;E++)b.I[E]=E;const C=Vt.makeLabelLut(b);return{scalars:x,colormapLabel:C}}static readNV(e){const n=e.byteLength,i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]===10;)a++;const v=a;for(;a<n&&i[a]!==10;)a++;return a++,a-v<1?"":new TextDecoder().decode(e.slice(v,a-1))}let o=0,l=0,c=0,u=0,h,g;for(;a<n;){const v=s();if(v.startsWith("#"))continue;const m=v.trim().split(/\s+/);if(o<1){o=parseInt(m[0]),h=new Float32Array(o*3);continue}if(c<o*3){h[c]=parseFloat(m[0]),h[c+1]=parseFloat(m[1]),h[c+2]=parseFloat(m[2]),c+=3;continue}if(l<1){l=parseInt(m[0]),g=new Uint32Array(l*3);continue}if(u>=l*3)break;g[u+2]=parseInt(m[0])-1,g[u+1]=parseInt(m[1])-1,g[u+0]=parseInt(m[2])-1,u+=3}return{positions:h,indices:g}}static readASC(e){const n=e.byteLength,i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]===10;)a++;const m=a;for(;a<n&&i[a]!==10;)a++;return a++,a-m<1?"":new TextDecoder().decode(e.slice(m,a-1))}let o=s();o.startsWith("#!ascii")||Z.warn("Invalid ASC mesh"),o=s();let l=o.trim().split(/\s+/);const c=parseInt(l[0]),u=parseInt(l[1]),h=new Float32Array(c*3);let g=0;for(let m=0;m<c;m++)o=s(),l=o.trim().split(/\s+/),h[g]=parseFloat(l[0]),h[g+1]=parseFloat(l[1]),h[g+2]=parseFloat(l[2]),g+=3;const v=new Uint32Array(u*3);g=0;for(let m=0;m<u;m++)o=s(),l=o.trim().split(/\s+/),v[g]=parseInt(l[0]),v[g+1]=parseInt(l[1]),v[g+2]=parseInt(l[2]),g+=3;return{positions:h,indices:v}}static readVTK(e){const n=e.byteLength;if(n<20)throw new Error("File too small to be VTK: bytes = "+e.byteLength);const i=new Uint8Array(e);let a=0;function s(b=!0){if(b)for(;a<n&&i[a]===10;)a++;const x=a;for(;a<n&&i[a]!==10;)a++;return a++,a-x<1?"":new TextDecoder().decode(e.slice(x,a-1))}let o=s();if(!o.startsWith("# vtk DataFile"))throw new Error("Invalid VTK mesh");if(o=s(!1),o=s(),o.startsWith("ASCII"))return jr.readTxtVTK(e);if(!o.startsWith("BINARY"))throw new Error("Invalid VTK image, expected ASCII or BINARY "+o);if(o=s(),!o.includes("POLYDATA"))throw new Error("Only able to read VTK POLYDATA "+o);o=s(),(!o.includes("POINTS")||!o.includes("double")&&!o.includes("float"))&&Z.warn("Only able to read VTK float or double POINTS"+o);const l=o.includes("double");let c=o.trim().split(/\s+/);const h=parseInt(c[1])*3,g=new Float32Array(h),v=new DataView(e);if(l)for(let b=0;b<h;b++)g[b]=v.getFloat64(a,!1),a+=8;else for(let b=0;b<h;b++)g[b]=v.getFloat32(a,!1),a+=4;o=s(),c=o.trim().split(/\s+/);const m=[];if(c[0].includes("LINES")){const b=parseInt(c[1]),x=a;if(o=s(),o.startsWith("OFFSETS")){let S=!1;o.includes("int64")&&(S=!0);const M=new Uint32Array(b);if(S){let T=!1;for(let B=0;B<b;B++){let F=v.getInt32(a,!1);F!==0&&(T=!0),a+=4,F=v.getInt32(a,!1),a+=4,M[B]=F}T&&Z.warn("int32 overflow: JavaScript does not support int64")}else for(let T=0;T<b;T++){const B=v.getInt32(a,!1);a+=4,M[T]=B}return{pts:g,offsetPt0:M}}a=x;let A=0;const C=[],E=[];C.push(A);for(let S=0;S<b;S++){const M=v.getInt32(a,!1);a+=4,A+=M,C.push(A);for(let R=0;R<M;R++){const T=v.getInt32(a,!1)*3;a+=4,E.push(g[T+0]),E.push(g[T+1]),E.push(g[T+2])}}return{pts:Float32Array.from(E),offsetPt0:Uint32Array.from(C)}}else if(c[0].includes("TRIANGLE_STRIPS")){const b=parseInt(c[1]);for(let x=0;x<b;x++){const A=v.getInt32(a,!1)-2;a+=4;for(let C=0;C<A;C++)C%2?(m.push(v.getInt32(a+8,!1)),m.push(v.getInt32(a+4,!1)),m.push(v.getInt32(a,!1))):(m.push(v.getInt32(a,!1)),m.push(v.getInt32(a+4,!1)),m.push(v.getInt32(a+8,!1))),a+=4;a+=8}}else if(c[0].includes("POLYGONS")){const b=parseInt(c[1]),x=a,A=s();if(A.startsWith("OFFSETS")){let C=A.includes("int64");const E=new Uint32Array(b);let S=!1;for(let B=0;B<b;B++)C&&(v.getInt32(a,!1)!==0&&(S=!0),a+=4),E[B]=v.getInt32(a,!1),a+=4;if(!Number.isSafeInteger(b)||b>=2147483648||S)throw new Error("values exceed 2GB limit");const M=s();if(!M.startsWith("CONNECTIVITY"))throw new Error("Expected CONNECTIVITY after OFFSETS");C=M.includes("int64");const R=E[b-1],T=new Uint32Array(R);for(let B=0;B<R;B++)C&&(a+=4),T[B]=v.getInt32(a,!1),a+=4;for(let B=0;B<b;B++){const F=B===0?0:E[B-1],I=E[B];for(let U=1;U<I-F-1;U++)m.push(T[F]),m.push(T[F+U]),m.push(T[F+U+1])}}else{a=x;for(let C=0;C<b;C++){const E=v.getInt32(a,!1)-2;if(C===0&&E>65535)throw new Error("Invalid VTK binary polygons using little-endian data (MRtrix)");a+=4;const S=v.getInt32(a,!1);a+=4;let M=v.getInt32(a,!1);a+=4;for(let R=0;R<E;R++){const T=v.getInt32(a,!1);a+=4,m.push(S,M,T),M=T}}}}else throw new Error("Unsupported binary VTK datatype "+c[0]);const y=new Uint32Array(m);return{positions:g,indices:y}}static readWRL(e){const n=new TextDecoder("utf-8").decode(e),i=/coord\s+Coordinate\s*\{\s*point\s*\[([\s\S]*?)\]/,a=/coordIndex\s*\[([\s\S]*?)\]/,s=/color\s+Color\s*\{\s*color\s*\[([\s\S]*?)\]/,o=i.exec(n),l=a.exec(n),c=s.exec(n);if(!o||!l)throw new Error("Invalid WRL file: Could not find vertices or indices.");const u=new Float32Array(o[1].trim().split(/[\s,]+/).map(Number));let h=null;if(c){h=new Float32Array(c[1].trim().split(/[\s,]+/).map(Number));const v=u.length/3;h.length!==v*3&&(console.warn(`Unexpected color count: expected ${v*3}, got ${h.length}`),h=null)}const g=new Uint32Array(l[1].trim().split(/[\s,]+/).map(Number).filter(v=>v!==-1));return{positions:u,indices:g,colors:h}}static readDFS(e){const n=new DataView(e),i=n.getUint32(0,!0),a=n.getUint16(4,!0);(i!==1599292996||a!==17740)&&Z.warn("Not a little-endian brainsuite DFS mesh");const s=n.getUint32(12,!0),o=n.getUint32(24,!0),l=n.getUint32(28,!0),c=n.getUint32(48,!0);let u=s;const h=new Uint32Array(e,u,o*3);u+=o*3*4;const g=new Float32Array(e,u,l*3);for(let m=0;m<l*3;m+=3){const y=g[m];g[m]=g[m+1],g[m+1]=y}let v;return c>=0&&(v=new Float32Array(e,c,l*3)),{positions:g,indices:h,colors:v}}static async readMZ3(e,n=0){if(e.byteLength<20)throw new Error("File too small to be mz3: bytes = "+e.byteLength);let i=new DataView(e),a=e,s=i.getUint16(0,!0);if(s===35615||s===8075){const F=await qe.decompress(new Uint8Array(e));i=new DataView(F.buffer),s=i.getUint16(0,!0),a=F.buffer}const o=i.getUint16(2,!0),l=i.getUint32(4,!0);let c=i.getUint32(8,!0);const u=i.getUint32(12,!0);if(cc.debug("MZ3 magic %d attr %d face %d vert %d skip %d",s,o,l,c,u),s!==23117)throw new Error("Invalid MZ3 file");const h=(o&1)!==0,g=(o&2)!==0,v=(o&4)!==0;let m=(o&8)!==0;const y=(o&16)!==0,b=(o&32)!==0,x=(o&64)!==0;if(cc.debug(`isFace=${h} isVert=${g} isRGBA=${v} isSCALAR=${m} isDOUBLE=${y} isAOMAP=${b} isLOOKUP=${x}`),o>127)throw new Error("Unsupported future version of MZ3 file");let A=4;y&&(A=8);let C=0;if(n>0&&!h&&l<1&&!v&&(m=!0),m){const F=n||c,I=16+u+(h?l*12:0)+(g?F*12:0)+(v?F*4:0),U=Math.floor((a.byteLength-I)/A);c!==n&&U%n===0&&(c=n),C=Math.floor(U/c),C<1&&(Z.warn("Corrupt MZ3: file reports NSCALAR but not enough bytes"),m=!1)}if(c<3&&n<3)throw new Error("Not a mesh MZ3 file (maybe scalar)");n>0&&n!==c&&Z.warn("Layer has "+c+"vertices, but background mesh has "+n);let E=16+u;const S=new DataView(a);let M=null;if(h){M=new Uint32Array(l*3);for(let F=0;F<l*3;F++)M[F]=S.getUint32(E,!0),E+=4}let R=null;if(g){R=new Float32Array(c*3);for(let F=0;F<c*3;F++)R[F]=S.getFloat32(E,!0),E+=4}let T=null;if(v){T=new Float32Array(c*3);for(let F=0;F<c;F++){for(let I=0;I<3;I++)T[F*3+I]=S.getUint8(E++)/255;E++}}let B=new Float32Array;if(m&&C>0)if(y){const F=new Float64Array(C*c);for(let I=0;I<C*c;I++)F[I]=S.getFloat64(E,!0),E+=8;B=Float32Array.from(F)}else{B=new Float32Array(C*c);for(let F=0;F<C*c;F++)B[F]=S.getFloat32(E,!0),E+=4}if(n>0&&x&&m){const F=new TextDecoder("utf-8"),I=new Uint8Array(a,16,u),U=F.decode(I),k=JSON.parse(U),O=Vt.makeLabelLut(k);return{scalars:B,colormapLabel:O}}if(n>0&&v&&m){let F=B[0];for(let k=0;k<c;k++)F=Math.max(F,B[k]);const I={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let k=0;k<=F;k++)for(let O=0;O<c;O++)if(k===B[O]){const V=O*3;I.I.push(k),I.R.push(T[V]*255),I.G.push(T[V+1]*255),I.B.push(T[V+2]*255),I.A.push(255),I.labels.push(`${k}`);break}const U=Vt.makeLabelLut(I);return{scalars:B,colormapLabel:U}}return n>0?{scalars:B}:{positions:R,indices:M,scalars:B,colors:T}}static readPLY(e){const n=e.byteLength,i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]===10;)a++;const B=a;for(;a<n&&i[a]!==10;)a++;return a++,a-B<1?"":new TextDecoder().decode(e.slice(B,a-1))}let o=s();if(!o.startsWith("ply"))throw new Error("Not a valid PLY file");o=s();const l=o.includes("ascii");function c(B){if(B==="char"||B==="uchar"||B==="int8"||B==="uint8")return 1;if(B==="short"||B==="ushort"||B==="int16"||B==="uint16")return 2;if(B==="int"||B==="uint"||B==="int32"||B==="uint32"||B==="float"||B==="float32")return 4;if(B==="double")return 8;throw new Error("Unknown data type: "+B)}const u=o.includes("binary_little_endian");let h=0,g=!1,v=0,m=0,y=0,b=0,x=0,A=0,C=0;for(;a<n&&!o.startsWith("end_header");){if(o=s(),o.startsWith("comment"))continue;let B=o.split(/\s/);if(o.startsWith("element vertex"))for(h=parseInt(B[B.length-1]),o=s(),B=o.split(/\s/);o.startsWith("property");){const F=B[1];B[2]==="x"&&F.startsWith("double")?g=!0:B[2]==="x"&&!F.startsWith("float")&&Z.error("Error: expect ply xyz to be float or double: "+o),v+=c(F),o=s(),B=o.split(/\s/)}if(o.startsWith("element face"))for(C=parseInt(B[B.length-1]),o=s(),B=o.split(/\s/);o.startsWith("property");){if(B[1]==="list")y=c(B[2]),b=c(B[3]),m+=y+3*b;else{const F=c(B[1]);m+=F,b===0&&(x+=F,A++)}o=s(),B=o.split(/\s/)}}if(l){C<1&&Z.error(`Malformed ply format: faces ${C} `);const B=new Float32Array(h*3);let F=0;for(let k=0;k<h;k++){o=s();const O=o.split(/\s/);B[F]=parseFloat(O[0]),B[F+1]=parseFloat(O[1]),B[F+2]=parseFloat(O[2]),F+=3}let I=new Uint32Array(C*3),U=0;for(let k=0;k<C;k++){o=s();const O=o.split(/\s/),V=parseInt(O[A])-2;if(V<1)break;if(U+V*3>I.length){const _=new Uint32Array(I.length+I.length);_.set(I),I=_.slice()}const L=parseInt(O[A+1]);let P=parseInt(O[A+2]);for(let _=0;_<V;_++){const q=parseInt(O[A+3+_]);I[U+0]=L,I[U+1]=P,I[U+2]=q,P=q,U+=3}}return I.length!==U&&(I=I.slice(0,U)),{positions:B,indices:I}}(v<12||y<1||b<1||C<1)&&Z.warn(`Malformed ply format: stride ${v} count ${y} iBytes ${b} iStrideBytes ${m} iPadBytes ${x} faces ${C}`);const E=new DataView(e);let S;if(a%4===0&&v===12&&u)S=new Float32Array(e,a,h*3),a+=h*v;else{S=new Float32Array(h*3);let B=0;for(let F=0;F<h;F++)g?(S[B]=E.getFloat64(a,u),S[B+1]=E.getFloat64(a+8,u),S[B+2]=E.getFloat64(a+16,u)):(S[B]=E.getFloat32(a,u),S[B+1]=E.getFloat32(a+4,u),S[B+2]=E.getFloat32(a+8,u)),B+=3,a+=v}const M=new Uint32Array(C*3);let R=!0,T=0;if(y===1&&b===4&&m===13)for(let B=0;B<C;B++){const F=E.getUint8(a);a+=y,F!==3&&(R=!1),M[T]=E.getUint32(a,u),a+=4,M[T+1]=E.getUint32(a,u),a+=4,M[T+2]=E.getUint32(a,u),a+=4,T+=3}else{let B=a;for(let F=0;F<C;F++){a=B+x;let I=0;y===1?I=E.getUint8(a):y===2?I=E.getUint16(a,u):y===4&&(I=E.getUint32(a,u)),a+=y,I!==3&&(R=!1);for(let U=0;U<3;U++)b===1?M[T]=E.getUint8(a):b===2?M[T]=E.getUint16(a,u):b===4&&(M[T]=E.getUint32(a,u)),T++,a+=b;B+=m}}return R||Z.warn("Only able to read PLY meshes limited to triangles."),{positions:S,indices:M}}static readICO(e){const a=new TextDecoder("utf-8").decode(e).split(`
`);let s=a[0].trim().split(/\s+/);s.length>1&&Z.warn("This is not a valid FreeSurfer ICO/TRI mesh.");const o=parseInt(s[0]),l=new Float32Array(o*3);let c=1;for(let g=0;g<o;g++){const v=a[c].trim().split(/\s+/);c++;let m=parseInt(v[0])-1;const y=parseFloat(v[1]),b=parseFloat(v[2]),x=parseFloat(v[3]);if(m<0||m>=o){Z.error("ICO vertices corrupted");break}m*=3,l[m]=y,l[m+1]=b,l[m+2]=x}s=a[c].trim().split(/\s+/),c++;const u=parseInt(s[0]),h=new Uint32Array(u*3);for(let g=0;g<u;g++){const v=a[c].trim().split(/\s+/);c++;let m=parseInt(v[0])-1;const y=parseInt(v[1])-1,b=parseInt(v[2])-1,x=parseInt(v[3])-1;if(m<0||m>=u){Z.error("ICO indices corrupted");break}m*=3,h[m]=y,h[m+1]=b,h[m+2]=x}for(let g=0;g<h.length;g+=3){const v=h[g];h[g]=h[g+1],h[g+1]=v}return{positions:l,indices:h}}static readGEO(e,n=!1){const s=new TextDecoder("utf-8").decode(e).split(`
`),o=s[0].trim().split(/\s+/),l=parseInt(o[0]);let c=parseInt(o[1]),u=parseInt(o[2]);const h=parseInt(o[3]);(l>1||h!==u*3)&&Z.warn("Multi-part BYU/GEO header or not a triangular mesh.");const g=[];c*=3;let v=0,m=2;for(;v<c;){const C=s[m].trim().split(/\s+/);m++;for(let E=0;E<C.length&&(g.push(parseFloat(C[E])),v++,!(v>=c));E++);}const y=[];u*=3;let b=0;for(;b<u;){const C=s[m].trim().split(/\s+/);m++;for(let E=0;E<C.length&&(y.push(Math.abs(parseInt(C[E]))-1),b++,!(b>=u));E++);}if(n)for(let C=0;C<y.length;C+=3){const E=y[C];y[C]=y[C+1],y[C+1]=E}const x=new Float32Array(g),A=new Uint32Array(y);return{positions:x,indices:A}}static readOFF(e){const a=new TextDecoder("utf-8").decode(e).split(`
`),s=[],o=[];let l=0;a[l].includes("OFF")?l++:Z.warn("File does not start with OFF");let c=a[l].trim().split(/\s+/);const u=parseInt(c[0]),h=parseInt(c[1]);l++;for(let m=0;m<u;m++)c=a[l].trim().split(/\s+/),s.push(parseFloat(c[0])),s.push(parseFloat(c[1])),s.push(parseFloat(c[2])),l++;for(let m=0;m<h;m++)c=a[l].trim().split(/\s+/),parseInt(c[0])!==3&&Z.warn("Only able to read OFF files with triangular meshes"),o.push(parseInt(c[1])),o.push(parseInt(c[2])),o.push(parseInt(c[3])),l++;const g=new Float32Array(s),v=new Uint32Array(o);return{positions:g,indices:v}}static readOBJMNI(e){const a=new TextDecoder("utf-8").decode(e).trim().split(/\s*,\s*|\s+/);(a.length<1||a[0]!=="P")&&Z.warn("This is not a valid MNI OBJ mesh.");let s=6;const o=parseInt(a[s++]),l=o*3,c=new Float32Array(l);for(let y=0;y<l;y++)c[y]=parseFloat(a[s++]);s+=l;const u=parseInt(a[s++]),h=parseInt(a[s++]);(u<1||h<0||h>2)&&Z.warn("This is not a valid MNI OBJ mesh.");let g=1;h===1?g=u:h===1&&(g=o),s+=g*4,s+=u;const v=u*3,m=new Uint32Array(v);for(let y=0;y<v;y++)m[y]=parseInt(a[s++]);return{positions:c,indices:m}}static async readOBJ(e){const n=new Uint8Array(e,0,2);n[0]===31&&n[1]===139&&(e=await qe.decompressToBuffer(new Uint8Array(e)));const a=new TextDecoder("utf-8").decode(e);if(a[0]==="P")return this.readOBJMNI(e);const s=a.split(`
`),o=s.length,l=[],c=[];for(let m=0;m<o;m++){const y=s[m];if(y[0]==="v"&&y[1]===" "){const b=y.trim().split(/\s+/);l.push(parseFloat(b[1])),l.push(parseFloat(b[2])),l.push(parseFloat(b[3]))}if(y[0]==="f"){const b=y.trim().split(/\s+/),x=b.length-3;if(x<1)break;let A=b[1].split("/");const C=parseInt(A[0])-1;A=b[2].split("/");let E=parseInt(A[0])-1;for(let S=0;S<x;S++){A=b[3+S].split("/");const M=parseInt(A[0])-1;c.push(C),c.push(E),c.push(M),E=M}}}const u=new Float32Array(l),h=new Uint32Array(c);let g=h[0],v=h[0];for(let m=1;m<h.length;m++)h[m]<g&&(g=h[m]),h[m]>v&&(v=h[m]);if(v-g+1>u.length/3)throw new Error("Not a valid OBJ file");for(let m=0;m<h.length;m++)h[m]-=g;return{positions:u,indices:h}}static readFreeSurfer(e){const n=new Uint8Array(e);if(n[0]===35&&n[1]===33&&n[2]===97)return jr.readASC(e);const i=new DataView(e),a=i.getUint32(0,!1),s=i.getUint32(4,!1);(a!==4294966883||s!==1919246708)&&cc.debug("Unable to recognize file type: does not appear to be FreeSurfer format.");let o=0;for(;i.getUint8(o)!==10;)o++;o+=2;let l=i.getUint32(o,!1);o+=4;let c=i.getUint32(o,!1);o+=4,l*=3;const u=new Float32Array(l);for(let m=0;m<l;m++)u[m]=i.getFloat32(o,!1),o+=4;c*=3;const h=new Uint32Array(c);for(let m=0;m<c;m++)h[m]=i.getUint32(o,!1),o+=4;const g=i.getUint32(o,!1);o+=4;let v=g===20;if(!v){const m=i.getUint32(o,!1);o+=4;const y=i.getUint32(o,!1);o+=4,v=g===2&&m===0&&y===20}if(!v)Z.warn("Unknown FreeSurfer Mesh extension code.");else{const y=new TextDecoder().decode(e.slice(o)).trim().split(`
`);for(let b=0;b<y.length;b++){if(!y[b].startsWith("cras"))continue;const A=y[b].split("=")[1].trim().split(" ").map(Number),C=Math.floor(u.length/3);let E=0;for(let S=0;S<C;S++)u[E]+=A[0],E++,u[E]+=A[1],E++,u[E]+=A[2],E++}}return{positions:u,indices:h}}static async readSRF(e){const n=new Uint8Array(e);if(n[0]===35&&n[1]===33&&n[2]===97)return jr.readASC(e);n[0]===31&&n[1]===139&&(e=(await qe.decompress(new Uint8Array(e))).buffer);const i=new DataView(e),a=i.getFloat32(0,!0),s=i.getUint32(8,!0),o=i.getUint32(12,!0),l=i.getFloat32(16,!0),c=i.getFloat32(20,!0),u=i.getFloat32(24,!0),h=new Float32Array(s*3);let g=28,v=1;for(let R=0;R<s;R++)h[v]=-i.getFloat32(g,!0)+l,v+=3,g+=4;v=2;for(let R=0;R<s;R++)h[v]=-i.getFloat32(g,!0)+c,v+=3,g+=4;v=0;for(let R=0;R<s;R++)h[v]=-i.getFloat32(g,!0)+u,v+=3,g+=4;g=28+24*s;const m=i.getFloat32(g,!0),y=i.getFloat32(g+4,!0),b=i.getFloat32(g+8,!0),x=i.getFloat32(g+16,!0),A=i.getFloat32(g+20,!0),C=i.getFloat32(g+24,!0);g+=32;const E=new Float32Array(s*3),S=new Uint32Array(e,g,s);v=0;for(let R=0;R<s;R++){const T=S[R];T>1056964608&&(E[v+0]=(T>>16&255)/255,E[v+1]=(T>>8&255)/255,E[v+2]=(T&255)/255),T===0&&(E[v+0]=m,E[v+1]=y,E[v+2]=b),T===1&&(E[v+0]=x,E[v+1]=A,E[v+2]=C),v+=3}g+=s*4;for(let R=0;R<s;R++){const T=i.getUint32(g,!0);g+=4+4*T}const M=new Uint32Array(o*3);for(let R=0;R<o*3;R++)M[R]=i.getInt32(g,!0),g+=4;return a!==4&&Z.warn("Not valid SRF"),{positions:h,indices:M,colors:E}}static readTxtSTL(e){const a=new TextDecoder("utf-8").decode(e).split(`
`);if(!a[0].startsWith("solid"))throw new Error("Not a valid STL file");const s=[];for(let u=1;u<a.length;u++){if(!a[u].includes("vertex"))continue;const h=a[u].trim().split(/\s+/);for(let g=1;g<h.length;g++)s.push(parseFloat(h[g]))}const o=Math.floor(s.length/3);if(o*3!==s.length)throw new Error("Unable to parse ASCII STL file.");const l=new Float32Array(s),c=new Uint32Array(o);for(let u=0;u<o;u++)c[u]=u;return{positions:l,indices:c}}static readSTL(e){if(e.byteLength<134)throw new Error("File too small to be STL: bytes = "+e.byteLength);const n=new DataView(e);if(n.getUint32(0,!0)===1768714099)return jr.readTxtSTL(e);const a=n.getUint32(80,!0),s=3*a;if(e.byteLength<84+a*50)throw new Error("STL file too small to store triangles = "+a);const o=new Uint32Array(s),l=new Float32Array(s*3);let c=96,u=0;for(let h=0;h<a;h++){for(let g=0;g<9;g++)l[u]=n.getFloat32(c,!0),u+=1,c+=4;c+=14}for(let h=0;h<s;h++)o[h]=h;return{positions:l,indices:o}}static decimateLayerVertices(e,n){if(e%n===0)return e;const i=12,a=Math.round(Math.log((e-2)/(i-2))/Math.log(4)),s=Math.round(Math.log((n-2)/(i-2))/Math.log(4)),o=Math.pow(4,a)*(i-2)+2,l=Math.pow(4,s)*(i-2)+2;return o!==e||l!==n?e:n}static async readNII2(e,n=0,i=""){let a=new Float32Array;const s=e.byteLength;let o=!0;const l=new DataView(e);let c=l.getUint16(0,o);if(c===469893120&&(o=!1,c=l.getUint16(0,o)),c!==540)throw new Error("Not a valid NIfTI-2 dataset");const u=Number(l.getBigInt64(168,o)),h=l.getFloat64(176,o),g=l.getFloat64(184,o);(h!==1||g!==0)&&Z.warn("ignoring scale slope and intercept");const v=l.getUint32(504,o),m=l.getUint16(12,o);if(m!==2&&m!==4&&m!==8&&m!==16)throw new Error("Unsupported NIfTI datatype "+m);let y=1;const b=[1,1,1,1,1,1,1,1];for(let x=1;x<8;x++)b[x]=Math.max(Number(l.getBigInt64(16+x*8,o)),1),y*=b[x];if(v>=3e3&&v<=3099&&u>580){let x=function(){for(;F<s&&B[F]===10;)F++;const P=F;for(;F<s&&B[F]!==10;)F++;return F++,F-P<1?"":new TextDecoder().decode(e.slice(P,F-1)).trim()},A=function(){let P=x();if(!P.startsWith("<")||P.endsWith(">"))return P;for(;F<s&&!P.endsWith(">");)P+=x();return P},C=function(P,_=!1){const q=I.indexOf(P);if(q<0)return 1;const H=I.indexOf('"',q)+1,W=I.indexOf('"',H),G=I.slice(H,W);return _?G:parseInt(G)},E=0,S=0,M=0,R="",T=new Uint32Array;const B=new Uint8Array(e);let F=552,I;const U=b[5],k=new Float32Array(n*U);for(;F<s&&(I=A(),!I.includes("</CIFTI>"));)if(I.includes("<BrainModel")){const P=C("SurfaceNumberOfVertices="),_=C("BrainStructure=",!0).toUpperCase();if(P%n!==0)continue;let q=!1;if(i.includes("CORTEX")&&_.includes("CORTEX")&&(q=!0),!q||(q=!1,i.includes("LEFT")&&_.includes("LEFT")&&(q=!0),i.includes("RIGHT")&&_.includes("RIGHT")&&(q=!0),!q))continue;if(M=P,E=C("IndexOffset="),S=C("IndexCount="),R=_,I.includes("<VertexIndices>")||(I=A()),!I.startsWith("<VertexIndices>")||!I.endsWith("</VertexIndices>"))return Z.warn("Unable to find CIfTI <VertexIndices>"),k;I=I.slice(15,-16);const H=I.trim().split(/\s+/);H.length<S&&Z.error("Error parsing VertexIndices"),T=new Uint32Array(S);for(let W=0;W<S;W++)T[W]=parseInt(H[W])}if(M===0||T.length===0)return Z.warn("Unable to find CIfTI structure that matches the mesh."),k;if(m!==16)return Z.warn("Only able to read float32 CIfTI (only known datatype)."),k;const O=new Float32Array(S*U),V=u+U*E*4;for(let P=0;P<S*U;P++)O[P]=l.getFloat32(V+P*4,o);let L=0;for(let P=0;P<S;P++)for(let _=0;_<U;_++)k[T[P]+_*n]=O[L],L++;return Z.debug("CIfTI diagnostics",M,R,E,S,E,i),k}if(y=this.decimateLayerVertices(y,n),y%n!==0)throw new Error("Vertices in layer ("+y+") is not a multiple of number of vertices ("+n+")");if(o)m===16?a=new Float32Array(e,u,y):m===8?a=new Int32Array(e,u,y):m===4&&(a=new Int16Array(e,u,y));else if(m===16){a=new Float32Array(y);for(let x=0;x<y;x++)a[x]=l.getFloat32(u+x*4,o)}else if(m===8){a=new Int32Array(y);for(let x=0;x<y;x++)a[x]=l.getInt32(u+x*4,o)}else if(m===4){a=new Int16Array(y);for(let x=0;x<y;x++)a[x]=l.getInt16(u+x*2,o)}return m===2&&(a=new Uint8Array(e,u,y)),a}static async readNII(e,n=0,i=""){let a=new Float32Array,s=!0,o=new DataView(e),l=o.getUint16(0,s);if(l===540||l===469893120)return jr.readNII2(e,n,i);if(l===23553&&(s=!1,l=o.getUint16(0,s)),l!==348){const m=await qe.decompress(new Uint8Array(e));if(o=new DataView(m.buffer),e=m.buffer,l=o.getUint16(0,s),l===540||l===469893120)return jr.readNII2(e,n,i);l===23553&&(s=!1,l=o.getUint16(0,s))}l!==348&&Z.error("Not a valid NIfTI image.");const c=o.getFloat32(108,s),u=o.getFloat32(112,s),h=o.getFloat32(116,s);(u!==1||h!==0)&&Z.warn("ignoring scale slope and intercept");const g=o.getUint16(70,s);if(g!==2&&g!==4&&g!==8&&g!==16)throw new Error("Unsupported NIfTI datatype "+g);let v=1;for(let m=1;m<8;m++){const y=o.getUint16(40+m*2,s);v*=Math.max(y,1)}if(v=this.decimateLayerVertices(v,n),v%n!==0)throw new Error("Vertices in layer ("+v+") is not a multiple of number of vertices ("+n+")");if(s)g===16?a=new Float32Array(e,c,v):g===8?a=new Int32Array(e,c,v):g===4&&(a=new Int16Array(e,c,v));else if(g===16){a=new Float32Array(v);for(let m=0;m<v;m++)a[m]=o.getFloat32(c+m*4,s)}else if(g===8){a=new Int32Array(v);for(let m=0;m<v;m++)a[m]=o.getInt32(c+m*4,s)}else if(g===4){a=new Int16Array(v);for(let m=0;m<v;m++)a[m]=o.getInt16(c+m*2,s)}return g===2&&(a=new Uint8Array(e,c,v)),a}static async readMGH(e,n=0,i=!1){let a=new DataView(e),s=e;if(a.getUint8(0)===31&&a.getUint8(1)===139){const T=await qe.decompress(new Uint8Array(e));s=new ArrayBuffer(T.byteLength),new Uint8Array(s).set(new Uint8Array(T)),a=new DataView(T.buffer)}const o=a.getInt32(0,!1),l=Math.max(1,a.getInt32(4,!1)),c=Math.max(1,a.getInt32(8,!1)),u=Math.max(1,a.getInt32(12,!1)),h=Math.max(1,a.getInt32(16,!1)),g=a.getInt32(20,!1);let v=284;const m=!1;(o!==1||g<0||g>4)&&Z.warn("Not a valid MGH file");let y=l*c*u*h,b=[];if(y=this.decimateLayerVertices(y,n),y%n!==0)return Z.warn("Vertices in layer ("+y+") is not a multiple of number of vertices ("+n+")"),b;if(g===3){b=new Float32Array(y);for(let T=0;T<y;T++)b[T]=a.getFloat32(v+T*4,m)}else if(g===1){b=new Int32Array(y);for(let T=0;T<y;T++)b[T]=a.getInt32(v+T*4,m)}else if(g===4){b=new Int16Array(y);for(let T=0;T<y;T++)b[T]=a.getInt16(v+T*2,m)}else g===0&&(b=new Uint8Array(e,v,y));if(!i)return b;let x=4;g===4&&(x=2),g===0&&(x=1),v+=x*y,v+=16;const A=1,C=2,E=20,S=30,M=s.byteLength;let R;for(;v<M-8;){const T=a.getInt32(v+=4,m);let B=0;switch(T){case S:B=a.getInt32(v+=4,m)-1;break;case E:case C:B=0;break;case A:B=0;{let F=a.getInt32(v+=4,m);if(F>0)return Z.warn("unsupported CTABreadFromBinaryV1"),b;if(F=-F,F!==2)return Z.warn("CTABreadFromBinary: unknown version"),b;const I=a.getInt32(v+=4,m);if(I<0)return Z.warn("CTABreadFromBinaryV2: nentries was ",I),b;const U=a.getInt32(v+=4,m);v+=U;const k=a.getInt32(v+=4,m);if(k<0)return b;const O={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let V=0;V<k;V++){const L=a.getInt32(v+=4,m),P=a.getInt32(v+=4,m);let _=v+4,q="";for(let $=0;$<P;$++){const te=a.getUint8(_++);if(te===0)break;q+=String.fromCharCode(te)}v+=P;const H=a.getInt32(v+=4,m),W=a.getInt32(v+=4,m),G=a.getInt32(v+=4,m),K=255-a.getInt32(v+=4,m);O.I.push(L),O.R.push(H),O.G.push(W),O.B.push(G),O.A.push(K),O.labels.push(q)}R=Vt.makeLabelLut(O)}break;default:B=a.getInt32(v+=8,m)}v+=B}return{scalars:b,colormapLabel:R}}static readX3D(e){const n=e.byteLength;if(n<20)throw new Error("File too small to be X3D: bytes = "+n);const i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]!==60;)a++;const E=a;for(;a<n&&i[a]!==62;)a++;const S=a;return new TextDecoder().decode(e.slice(E,S+1)).trim()}let o=s();function l(E){const S=o.indexOf(E+"=");if(S<0)return"";const M=o[S+E.length+1],R=o.indexOf(M,S)+1,T=o.indexOf(M,R);return o.slice(R,T)}function c(E){const S=o.indexOf(E+"=");if(S<0)return 1;const M=o[S+E.length+1],R=o.indexOf(M,S)+1,T=o.indexOf(M,R);let B=o.slice(R,T).trim();B=B.replace(/,\s*$/,"");const F=B.trim().split(/\s*,\s*|\s+/);if(F.length<2)return parseFloat(B);let I=new Array(F.length),U=0;for(let k=0;k<F.length;k++){const O=parseFloat(F[k]);isFinite(O)&&(I[U]=O,U++)}return I=I.slice(0,U),I}o.includes("xml version")||Z.warn("Not a X3D image");let u=[],h=[],g=[],v=[],m=[0,0,0,0],y=[0,0,0,0],b=[255,255,255,255],x=[255,255,255,255];const A={};function C(){if(!o.endsWith("/>"))if(o.startsWith("<Appearance>"))for(;a<n&&!o.endsWith("</Appearance>");)o+=s();else for(;a<n&&!o.endsWith("/>");)o+=s();const E=l("USE");if(E.length>1){E in A?b=A[E]:Z.warn("Unable to find DEF for "+E);return}const S=c("diffuseColor");if(S.length<3)return;b[0]=Math.round(S[0]*255),b[1]=Math.round(S[1]*255),b[2]=Math.round(S[2]*255);const M=l("DEF");M.length<1||(A[M]=b)}for(;a<n;)if(o=s(),b=x.slice(),o.startsWith("<Transform")&&(m=c("translation"),y=c("rotation")),o.startsWith("<Appearance")&&(C(),x=b.slice()),o.startsWith("<Shape")){let E=1,S=1,M=[],R=[];for(;a<n&&(o=s(),o.startsWith("<Appearance")&&C(),!o.startsWith("</Shape"));){if(o.startsWith("<Sphere")&&(E=c("radius"),S=-1),o.startsWith("<Cylinder")&&(E=c("radius"),S=c("height")),o.startsWith("<IndexedFaceSet")&&(S=-2,M=c("coordIndex")),o.startsWith("<IndexedTriangleSet")&&(S=-7,M=c("index")),o.startsWith("<IndexedTriangleStripSet")&&(S=-3,M=c("index")),o.startsWith("<Coordinate")){R=c("point");const T=R.length%3;T!==0&&(R=R.slice(0,-T))}o.startsWith("<Color")&&(v=c("color")),o.startsWith("<Box")&&(S=-4,Z.warn("Unsupported x3d shape: Box")),o.startsWith("<Cone")&&(S=-5,Z.warn("Unsupported x3d shape: Cone")),o.startsWith("<ElevationGrid")&&(S=-6,Z.warn("Unsupported x3d shape: ElevationGrid"))}if(!(S<-3&&S!==-7))if(S<-1){if(M.length<1||R.length<3||R.length===void 0){Z.warn("Indexed mesh must specify indices and points");break}const T=Math.floor(u.length/3);let B=2;if(S===-7)h=[...h,...M];else if(S===-2){let U=0;for(;B<M.length;)M[B]>=0?(h.push(M[U]+T),h.push(M[B-1]+T),h.push(M[B-0]+T),B+=1):(B+=3,U=B-2)}else for(;B<M.length;)M[B]>=0?(h.push(M[B-2]+T),h.push(M[B-1]+T),h.push(M[B-0]+T),B+=1):B+=3;u=[...u,...R];const F=Math.floor(R.length/3),I=Array(F).fill(b).flat();if(v.length===F*3){let U=0,k=0;for(let O=0;O<F;O++){for(let V=0;V<3;V++)I[k]=Math.round(v[U]*255),U++,k++;k++}}g=[...g,...I]}else if(S<0)Ro.makeColoredSphere(u,h,g,E,m,b);else{const T=bt();Q_(T,y[3],[y[0],y[1],y[2]]);const B=Jt(0,-S*.5,0,1),F=Jt(0,+S*.5,0,1);Kr(B,B,T),Kr(F,F,T),vC(B,B,m),vC(F,F,m);const I=Me(B[0],B[1],B[2]),U=Me(F[0],F[1],F[2]);Ro.makeColoredCylinder(u,h,g,I,U,E,b)}}return{positions:Float32Array.from(u),indices:Uint32Array.from(h),rgba255:Uint8Array.from(g)}}static async readGII(e,n=0){let i=e.byteLength;if(i<20)throw new Error("File too small to be GII: bytes = "+i);let a=new TextDecoder("ascii").decode(e);if(a[0].charCodeAt(0)===31){const k=await qe.decompress(new Uint8Array(e));e=k.buffer,a=new TextDecoder("ascii").decode(k.buffer)}let s=0;function o(){let k=!0,O=s;for(;k;){for(;s<i&&a[s]!=="<";)s++;for(O=s;s<i&&a[s]!==">";)s++;if(k=a[s-1]==="/",O+1<i&&a[O+1]==="/"&&(s+=1,k=!0),s>=i)break}const V=new TextDecoder().decode(e.slice(O+1,s)).trim(),L=V.split(" ")[0].trim(),P=s;let _=s,q=s;if(a[O+1]!=="?"&&a[O+1]!=="!"){const H="</"+L+">";_=a.indexOf(H,P),q=_+H.length-1}return{name:V,startPos:O,contentStartPos:P,contentEndPos:_,endPos:q}}let l=o();if(!l.name.startsWith("?xml"))throw new Error("readGII: Invalid XML file");for(;!l.name.startsWith("GIFTI")&&l.endPos<i;)l=o();if(!l.name.startsWith("GIFTI")||l.contentStartPos===l.contentEndPos)throw new Error("readGII: XML file does not include GIFTI tag");i=l.contentEndPos;let c=new Float32Array,u=new Uint32Array,h=new Float32Array,g="",v=!1,m=!1,y=!1,b=!1,x=[1,1,1];const A=[0,0,0];let C=0,E=!1,S=!1,M=0,R=!1;l.endPos=l.contentStartPos;let T="";function B(k,O=!1){const V=T.indexOf(k);if(V<0)return 1;const L=T.indexOf('"',V)+1,P=T.indexOf('"',L),_=T.slice(L,P);return O?parseFloat(_):parseInt(_)}function F(k){const O=T.indexOf(k);if(O<0)return"";const V=O+k.length,L=T.indexOf("]",V);return T.slice(V,L)}const I={R:[],G:[],B:[],A:[],I:[],labels:[]};for(;l.endPos<i&&l.name.length>1;){if(l=o(),l.name.startsWith("Label Key")&&(T=l.name,I.I.push(B("Key=")),I.R.push(Math.round(255*B("Red=",!0))),I.G.push(Math.round(255*B("Green=",!0))),I.B.push(Math.round(255*B("Blue=",!0))),I.A.push(Math.round(255*B("Alpha",!0))),T=new TextDecoder().decode(e.slice(l.contentStartPos+1,l.contentEndPos)).trim(),I.labels.push(F("<![CDATA["))),l.name.trim()==="Data"){if(y)continue;T=new TextDecoder().decode(e.slice(l.contentStartPos+1,l.contentEndPos)).trim();let k;if(S){const O=x[0]*x[1]*x[2],V=T.split(/\s+/);if(O!==V.length)throw new Error("Unable to parse ASCII GIfTI");if(C===2&&(C=8),C===32&&(C=16),C===8){k=new Int32Array(O);for(let L=0;L<O;L++)k[L]=parseInt(V[L])}if(C===16){k=new Float32Array(O);for(let L=0;L<O;L++)k[L]=parseFloat(V[L])}}else if(typeof Buffer>"u"){let O=function(V){const L=atob(V),P=L.length,_=new Uint8Array(P);for(let q=0;q<P;q++)_[q]=L.charCodeAt(q);return _};if(E){const V=O(T.slice());k=await qe.decompress(new Uint8Array(V))}else k=O(T.slice())}else if(E){const O=Buffer.from(T.slice(),"base64");k=await qe.decompress(new Uint8Array(O))}else k=Buffer.from(T.slice(),"base64");if(m){if(C!==16&&Z.warn("expect positions as FLOAT32"),c=new Float32Array(k.buffer),b){const O=c.slice(),V=O.length/3;let L=0;for(let P=0;P<V;P++)for(let _=0;_<3;_++)c[L]=O[_*V+P],L++}}else if(v){if(C!==8&&Z.warn("expect indices as INT32"),u=new Uint32Array(k.buffer),b){const O=u.slice(),V=O.length/3;let L=0;for(let P=0;P<V;P++)for(let _=0;_<3;_++)u[L]=O[_*V+P],L++}}else{let O=function(L,P){const _=L.length,q=new Float32Array(_+P.length);return q.set(L),q.set(P,_),q};M=x[0]*x[1]*x[2],n!==0&&M%n!==0&&Z.warn("Number of vertices in scalar overlay ("+M+") does not match mesh ("+n+")");let V;if(C===2){const L=new Uint8Array(k.buffer);V=Float32Array.from(L)}else if(C===8){const L=new Int32Array(k.buffer);V=Float32Array.from(L)}else if(C===16)V=new Float32Array(k.buffer);else if(C===32){const L=new Float64Array(k.buffer);V=Float32Array.from(L)}else throw new Error(`Invalid dataType: ${C}`);h=O(h,V)}continue}if(l.name.trim()==="DataSpace"&&(T=new TextDecoder().decode(e.slice(l.contentStartPos+1,l.contentEndPos)).trim(),T.includes("NIFTI_XFORM_SCANNER_ANAT")&&(R=!0)),l.name.trim()==="MD"&&(T=new TextDecoder().decode(e.slice(l.contentStartPos+1,l.contentEndPos)).trim(),T.includes("AnatomicalStructurePrimary")&&T.includes("CDATA[")&&(g=F("<Value><![CDATA[").toUpperCase()),T.includes("VolGeom")&&T.includes("CDATA["))){let k=-1;if(T.includes("VolGeomC_R")&&(k=0),T.includes("VolGeomC_A")&&(k=1),T.includes("VolGeomC_S")&&(k=2),k<0)continue;A[k]=parseFloat(F("<Value><![CDATA["))}l.name.startsWith("DataArray")&&(T=l.name,x=[1,1,1],E=T.includes('Encoding="GZipBase64Binary"'),S=T.includes('Encoding="ASCII"'),v=T.includes('Intent="NIFTI_INTENT_TRIANGLE"'),m=T.includes('Intent="NIFTI_INTENT_POINTSET"'),y=T.includes('Intent="NIFTI_INTENT_VECTOR"'),b=T.includes('ArrayIndexingOrder="ColumnMajorOrder"'),T.includes('DataType="NIFTI_TYPE_UINT8"')&&(C=2),T.includes('DataType="NIFTI_TYPE_INT32"')&&(C=8),T.includes('DataType="NIFTI_TYPE_FLOAT32"')&&(C=16),T.includes('DataType="NIFTI_TYPE_FLOAT64"')&&(C=32),x[0]=B("Dim0="),x[1]=B("Dim1="),x[2]=B("Dim2="))}let U;if(I.I.length>1&&(U=Vt.makeLabelLut(I)),n>0)return{scalars:h,colormapLabel:U,anatomicalStructurePrimary:g};if(c.length>2&&!R&&(A[0]!==0||A[1]!==0||A[2]!==0)){M=Math.floor(c.length/3);let k=0;for(let O=0;O<M;O++)c[k]+=A[0],k++,c[k]+=A[1],k++,c[k]+=A[2],k++}return{positions:c,indices:u,scalars:h,colormapLabel:U,anatomicalStructurePrimary:g}}},Dy=class{constructor(r,e,n,i,a){j(this,"text"),j(this,"style"),j(this,"points"),j(this,"anchor"),j(this,"onClick"),this.text=r,this.style=e,this.points=n,this.anchor=i||0,this.onClick=a}},d2=()=>{const r=new ArrayBuffer(2);return new DataView(r).setInt16(0,256,!0),new Int16Array(r)[0]===256},NT=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.NII=1]="NII",r[r.DCM=2]="DCM",r[r.DCM_MANIFEST=3]="DCM_MANIFEST",r[r.MIH=4]="MIH",r[r.MIF=5]="MIF",r[r.NHDR=6]="NHDR",r[r.NRRD=7]="NRRD",r[r.MHD=8]="MHD",r[r.MHA=9]="MHA",r[r.MGH=10]="MGH",r[r.MGZ=11]="MGZ",r[r.V=12]="V",r[r.V16=13]="V16",r[r.VMR=14]="VMR",r[r.HEAD=15]="HEAD",r[r.DCM_FOLDER=16]="DCM_FOLDER",r[r.SRC=17]="SRC",r[r.FIB=18]="FIB",r[r.BMP=19]="BMP",r[r.ZARR=20]="ZARR",r[r.NPY=21]="NPY",r[r.NPZ=22]="NPZ",r))(NT||{}),ut=Object.freeze({...NT,parse:r=>{let e=0;switch(r.toUpperCase()){case"":case"DCM":e=2;break;case"TXT":e=3;break;case"FZ":case"GQI":case"QSDR":case"FIB":e=18;break;case"NII":e=1;break;case"MIH":e=4;break;case"MIF":e=5;break;case"NHDR":e=6;break;case"NRRD":e=7;break;case"MHD":e=8;break;case"MHA":e=9;break;case"MGH":e=10;break;case"MGZ":e=11;break;case"NPY":e=21;break;case"NPZ":e=22;break;case"SRC":e=17;break;case"V":e=12;break;case"V16":e=13;break;case"VMR":e=14;break;case"HEAD":e=15;break;case"PNG":case"BMP":case"GIF":case"JPG":case"JPEG":e=19;break;case"ZARR":e=20;break}return e}}),Yd=(r,e="",n="",i="gray",a=1,s=NaN,o=NaN,l=!0,c=.02,u=!1,h=!1,g="",v=0,m=ut.UNKNOWN,y=NaN,b=NaN,x=!0,A=!1,C=null)=>({url:r,urlImageData:e,name:n,colormap:i,colorMap:i,opacity:a,cal_min:s,cal_max:o,trustCalMinMax:l,percentileFrac:c,ignoreZeroVoxels:u,useQFormNotSForm:h,colormapNegative:g,imageType:m,cal_minNeg:y,cal_maxNeg:b,colorbarVisible:x,frame4D:v,alphaThreshold:A,colormapLabel:C});function UC(r,e=80){r=r.replace(/[`$]/g,"");const n=[],i=Math.min(e,r.length);for(let a=0;a<i;a++){const s=r.charCodeAt(a);n.push(s&255)}return n}function x0(r,e=!1,n=!1){let s=!0;n&&(s=r.littleEndian);const o=new Uint8Array(348),l=new DataView(o.buffer);l.setInt32(0,348,s),l.setUint8(38,114),l.setUint8(39,r.dim_info);for(let u=0;u<8;u++)l.setUint16(40+2*u,r.dims[u],s);l.setFloat32(56,r.intent_p1,s),l.setFloat32(60,r.intent_p2,s),l.setFloat32(64,r.intent_p3,s),l.setInt16(68,r.intent_code,s),e?(l.setInt16(70,2,s),l.setInt16(72,8,s)):(l.setInt16(70,r.datatypeCode,s),l.setInt16(72,r.numBitsPerVoxel,s)),l.setInt16(74,r.slice_start,s);for(let u=0;u<8;u++)l.setFloat32(76+4*u,r.pixDims[u],s);e?(l.setFloat32(108,352,s),l.setFloat32(112,1,s),l.setFloat32(116,0,s)):(l.setFloat32(108,r.vox_offset,s),l.setFloat32(112,r.scl_slope,s),l.setFloat32(116,r.scl_inter,s)),l.setInt16(120,r.slice_end,s),l.setUint8(122,r.slice_code),r.xyzt_units===0?l.setUint8(123,10):l.setUint8(123,r.xyzt_units),e?(l.setFloat32(124,0,s),l.setFloat32(128,0,s)):(l.setFloat32(124,r.cal_max,s),l.setFloat32(128,r.cal_min,s)),l.setFloat32(132,r.slice_duration,s),l.setFloat32(136,r.toffset,s),o.set(UC(r.description),148),o.set(UC(r.aux_file),228),l.setInt16(252,r.qform_code,s),r.sform_code<1||r.sform_code<1?l.setInt16(254,1,s):l.setInt16(254,r.sform_code,s),l.setFloat32(256,r.quatern_b,s),l.setFloat32(260,r.quatern_c,s),l.setFloat32(264,r.quatern_d,s),l.setFloat32(268,r.qoffset_x,s),l.setFloat32(272,r.qoffset_y,s),l.setFloat32(276,r.qoffset_z,s);const c=r.affine.flat();for(let u=0;u<12;u++)l.setFloat32(280+4*u,c[u],s);return l.setInt32(344,3222382,!0),o}function aY(r,e=!0){const n=Math.round(r.length/3),i=Me(0,0,0),a=Kt(),s=Kt();let o=0,l=1;e&&(l=2);for(let g=0;g<l;g++){o=0;for(let m=0;m<n;m++){const y=Me(r[m*3],r[m*3+1],r[m*3+2]);m===0&&(dC(a,y),dC(s,y)),uy(a,a,y),cy(s,s,y),Wt(y,y,i);const b=$c(y);o=Math.max(o,b)}if(g+1>=l)break;let v=!0;for(let m=0;m<3;++m)a[m]>i[m]&&(v=!1),s[m]<i[m]&&(v=!1);if(v)break;rz(i,a,s,.5),Z.debug("origin moved inside volume: ",i)}const c=[a[0],a[1],a[2]],u=[s[0],s[1],s[2]];return{min:c,max:u,furthestVertexFromOrigin:o,origin:i}}function VC(r){const e=[!1,!1,!1,!1],n=[!1,!1,!1,!1];for(let i=0;i<4;i++)for(let a=0;a<4;a++)if(isNaN(r[i][a]))return!1;for(let i=0;i<3;i++)for(let a=0;a<3;a++)r[i][a]!==0&&(e[i]=!0,n[a]=!0);for(let i=0;i<3;i++)if(!e[i]||!n[i])return!1;return!0}async function op(r){const e=r.getReader(),{done:n,value:i}=await e.read();if(n)return e.releaseLock(),new ReadableStream({start(o){o.close()}});if(!i||i.length<2)return e.releaseLock(),new ReadableStream({start(o){i&&o.enqueue(i),o.close()}});const a=i[0]===31&&i[1]===139,s=new ReadableStream({async start(o){try{for(o.enqueue(i);;){const{done:l,value:c}=await e.read();if(l){o.close(),e.releaseLock();break}o.enqueue(c)}}catch(l){o.error(l),e.releaseLock()}}});return a?s.pipeThrough(new DecompressionStream("gzip")):s}function FT(r=[256,256,256],e=[1,1,1],n=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],i=2){const a=new Fe;a.littleEndian=!0,a.dims=[3,1,1,1,0,0,0,0],a.dims[0]=Math.max(3,r.length);for(let o=0;o<r.length;o++)a.dims[o+1]=r[o];a.pixDims=[1,1,1,1,1,0,0,0];for(let o=0;o<r.length;o++)a.pixDims[o+1]=e[o];if(n.length===16){let o=0;for(let l=0;l<4;l++)for(let c=0;c<4;c++)a.affine[l][c]=n[o],o++}let s=8;return i===256||i===2?s=8:i===512||i===4?s=16:i===16||i===768||i===8||i===2304?s=32:i===64?s=64:Z.warn("Unsupported NIfTI datatypeCode for header creation: "+i),a.datatypeCode=i,a.numBitsPerVoxel=s,a.scl_inter=0,a.scl_slope=1,a.sform_code=2,a.magic="n+1",a.vox_offset=352,a}function sY(r=[256,256,256],e=[1,1,1],n=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],i=2,a=new Uint8Array){const s=FT(r,e,n,i),o=x0(s,!1);s.vox_offset=Math.max(352,o.length);const l=x0(s,!1);if(a.length<1)return l;const c=Math.max(0,s.vox_offset-l.length),u=new Uint8Array(c),h=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),g=s.vox_offset+h.length,v=new Uint8Array(g);return v.set(l,0),v.set(u,l.length),v.set(h,s.vox_offset),v}function kT(r,e=null){if(!r.hdr)throw new Error("NVImage header is not defined for toUint8Array");if(!r.img&&e===null)throw new Error("NVImage image data is not defined for toUint8Array");const n=e!==null,i=JSON.parse(JSON.stringify(r.hdr)),a=r.extensions&&r.extensions.length>0,s=new Uint8Array(4);s[0]=a?1:0;let o=new Uint8Array(0);if(a){const x=[];let A=0;for(const E of r.extensions){const S=new Uint8Array(E.edata),M=new Uint8Array(8+S.length),R=new DataView(M.buffer);R.setInt32(0,E.esize,!0),R.setInt32(4,E.ecode,!0),M.set(S,8),x.push(M),A+=M.length}o=new Uint8Array(A);let C=0;for(const E of x)o.set(E,C),C+=E.length}const l=348;i.vox_offset=Math.max(352,l+s.length+o.length),n&&(i.datatypeCode=2,i.numBitsPerVoxel=8,i.scl_slope=1,i.scl_inter=0);const c=x0(i,n);let u;if(n){const x=e,A=r.permRAS;if(A&&(A[0]!==1||A[1]!==2||A[2]!==3)){Z.debug("Reorienting drawing bytes back to native space for saving...");const C=r.hdr.dims,E=C[1]*C[2]*C[3],S=r.dimsRAS?r.dimsRAS[1]*r.dimsRAS[2]*r.dimsRAS[3]:E;if(x.length!==S)console.warn(`Drawing length (${x.length}) does not match expected RAS voxel count (${S}). Cannot reorient drawing reliably.`),u=x;else if(!r.img2RASstep||!r.img2RASstart||!r.dimsRAS)console.warn("Missing RAS transformation info (img2RASstep, img2RASstart, dimsRAS). Cannot reorient drawing reliably."),u=x;else{const M=r.img2RASstep,R=r.img2RASstart,T=r.dimsRAS,B=new Uint8Array(E);B.fill(0);const F=x;let I=0;for(let U=0;U<T[3];U++){const k=R[2]+U*M[2];for(let O=0;O<T[2];O++){const V=R[1]+O*M[1];for(let L=0;L<T[1];L++){const _=R[0]+L*M[0]+V+k;_>=0&&_<E?B[_]=F[I]:I<F.length&&console.warn(`Calculated native index ${_} is out of bounds [0..${E-1}] during drawing reorientation.`),I++}}}u=B}}else u=x}else{if(!r.img)throw new Error("NVImage image data is null when trying to save non-drawing.");u=new Uint8Array(r.img.buffer,r.img.byteOffset,r.img.byteLength)}const h=c.length+s.length+o.length,g=Math.max(0,i.vox_offset-h),v=new Uint8Array(g),m=i.vox_offset+u.length,y=new Uint8Array(m);let b=0;return y.set(c,b),b+=c.length,y.set(s,b),b+=s.length,y.set(o,b),b+=o.length,y.set(v,b),b+=v.length,y.set(u,i.vox_offset),y}async function UT(r,e,n=null){const i=kT(r,n);if(e.toLowerCase().endsWith(".gz"))try{const s=await qe.compress(i,"gzip");return new Uint8Array(s)}catch(s){return Z.error("Compression failed:",s),Z.warn("Returning uncompressed data due to compression error."),i}else return i}async function oY(r,e="",n=null){const i=await UT(r,e,n);if(!e)return Z.debug("saveToDisk: empty file name, returning data as Uint8Array rather than triggering download"),i;try{const a=new Blob([i.buffer],{type:"application/octet-stream"}),s=URL.createObjectURL(a),o=document.createElement("a");o.setAttribute("href",s),o.setAttribute("download",e),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>URL.revokeObjectURL(s),100)}catch(a){Z.error("Failed to trigger download:",a)}return i}function VT(r,e,n,i,a=0,s=!1){if(!r.hdr)throw new Error("getValue: NVImage header is not defined.");if(!s&&!r.img)throw new Error("getValue: NVImage image data is not defined.");if(s&&!r.imaginary)return Z.warn("getValue: Attempted to read imaginary data, but none exists."),[0];const o=r.hdr.dims[1],l=r.hdr.dims[2],c=r.hdr.dims[3],u=r.permRAS.slice();if(u[0]!==1||u[1]!==2||u[2]!==3){const C=Jt(e,n,i,1);Kr(C,C,r.toRASvox),e=C[0],n=C[1],i=C[2]}e=Math.max(0,Math.min(Math.round(e),o-1)),n=Math.max(0,Math.min(Math.round(n),l-1)),i=Math.max(0,Math.min(Math.round(i),c-1)),a=Math.max(0,a);let h=e+n*o+i*o*l;if(r.hdr.datatypeCode===2304)return r.img?(h*=4,h+3>=r.img.length?(Z.warn(`getValue: Calculated index ${h} out of bounds for RGBA data.`),[0]):[r.img[h],r.img[h+1],r.img[h+2],r.img[h+3]]):[0];if(r.hdr.datatypeCode===128)return r.img?(h*=3,h+2>=r.img.length?(Z.warn(`getValue: Calculated index ${h} out of bounds for RGB data.`),[0]):[r.img[h],r.img[h+1],r.img[h+2]]):[0];const g=o*l*c,v=a*g,m=h+v,y=s?r.imaginary:r.img;if(m<0||m>=y.length)return[0];const b=y[m],x=isNaN(r.hdr.scl_slope)||r.hdr.scl_slope===0?1:r.hdr.scl_slope,A=isNaN(r.hdr.scl_inter)?0:r.hdr.scl_inter;return[x*b+A]}function lY(r,e,n,i,a=0,s=!1){const o=VT(r,e,n,i,a,s);return o.length<3?o[0]:o[0]*.2126+o[1]*.7152+o[2]*.0722}function uY(r,e=[-1,0,0],n=[0,0,0],i="same"){const a=[new Uint8Array,[0,0,0]];if(!r.hdr||!r.img||!r.dimsRAS||!r.img2RASstep||!r.img2RASstart)return Z.error("getVolumeData: Missing required NVImage properties (hdr, img, dimsRAS, img2RASstep/start)."),a;if(e=e.slice(0,3),n=n.slice(0,3),Math.min(...e)<0||Math.min(...n)<0)return Z.warn("getVolumeData: Invalid start or end coordinates provided."),a;const s=r.dimsRAS.slice(1,4);for(let x=0;x<3;x++)if(e[x]=Math.max(0,Math.min(Math.round(e[x]),s[x]-1)),n[x]=Math.max(0,Math.min(Math.round(n[x]),s[x]-1)),n[x]<e[x]){const A=n[x];n[x]=e[x],e[x]=A}const o=[n[0]-e[0]+1,n[1]-e[1]+1,n[2]-e[2]+1],l=o[0]*o[1]*o[2];if(l<=0)return Z.warn("getVolumeData: Calculated slab size is zero or negative."),a;let c=r.img.constructor;i==="uint8"?c=Uint8Array:i==="int16"?c=Int16Array:i==="uint16"?c=Uint16Array:i==="float32"||i==="scaled"||i==="normalized"||i==="windowed"?c=Float32Array:i==="float64"?c=Float64Array:i!=="same"&&Z.warn(`getVolumeData: Unsupported dataType '${i}'. Using 'same'.`);let u;try{u=new c(l)}catch(x){return Z.error(`getVolumeData: Failed to create output array for dataType '${i}'.`,x),a}const h=r.img2RASstep,g=r.img2RASstart,v=r.img;let m=0;for(let x=e[2];x<=n[2];x++){const A=g[2]+x*h[2];for(let C=e[1];C<=n[1];C++){const E=g[1]+C*h[1];for(let S=e[0];S<=n[0];S++){const R=g[0]+S*h[0]+E+A;let T=0;R>=0&&R<v.length&&(T=v[R]),u[m++]=T}}}const y=isNaN(r.hdr.scl_slope)||r.hdr.scl_slope===0?1:r.hdr.scl_slope,b=isNaN(r.hdr.scl_inter)?0:r.hdr.scl_inter;if(i==="scaled"||i==="normalized"||i==="windowed"){u instanceof Float32Array||(Z.warn(`getVolumeData: Converting output to Float32 for scaling type '${i}'.`),u=Float32Array.from(u));for(let x=0;x<u.length;x++)u[x]=u[x]*y+b}if(i==="normalized"||i==="windowed"){let x=r.cal_min,A=r.cal_max;i==="normalized"&&(x=r.global_min,A=r.global_max);const C=A-x,E=C===0?0:1/C;for(let S=0;S<u.length;S++)u[S]=(u[S]-x)*E,u[S]=Math.max(0,Math.min(u[S],1))}return[u,o]}function cY(r,e=[-1,0,0],n=[0,0,0],i=new Uint8Array){if(!r.hdr||!r.img||!r.dimsRAS||!r.img2RASstep||!r.img2RASstart){Z.error("setVolumeData: Missing required NVImage properties (hdr, img, dimsRAS, img2RASstep/start).");return}if(i.length<1){Z.warn("setVolumeData: Input slabData is empty.");return}if(e=e.slice(0,3),n=n.slice(0,3),Math.min(...e)<0||Math.min(...n)<0){Z.warn("setVolumeData: Invalid start or end coordinates provided.");return}const a=r.dimsRAS.slice(1,4);for(let g=0;g<3;g++)if(e[g]=Math.max(0,Math.min(Math.round(e[g]),a[g]-1)),n[g]=Math.max(0,Math.min(Math.round(n[g]),a[g]-1)),n[g]<e[g]){const v=n[g];n[g]=e[g],e[g]=v}const s=[n[0]-e[0]+1,n[1]-e[1]+1,n[2]-e[2]+1],o=s[0]*s[1]*s[2];if(o<=0){Z.warn("setVolumeData: Calculated slab size is zero or negative.");return}if(i.length<o){Z.error(`setVolumeData: Input slabData length (${i.length}) is less than the calculated slab size (${o}).`);return}const l=r.img2RASstep,c=r.img2RASstart,u=r.img;let h=0;for(let g=e[2];g<=n[2];g++){const v=c[2]+g*l[2];for(let m=e[1];m<=n[1];m++){const y=c[1]+m*l[1];for(let b=e[0];b<=n[0];b++){const A=c[0]+b*l[0]+y+v;A>=0&&A<u.length&&(u[A]=i[h]),h++}}}}var OT={};Z0(OT,{isFreeSurferLabelImage:()=>LT,optimizeFreeSurferLabels:()=>PT,readMgh:()=>fY});function OC(r,e,n,i=1){const a=e+n;let s=e;const o=[];for(;s+12<=a;){const l=r.getInt32(s,!1),c=r.getInt32(s+8,!1);if(s+=12,c<=0||s+c>a)break;if(l!==i){s+=c;continue}let u=c,h=s;if(i===1){if(s+4>a)break;u=r.getInt32(s,!1),h+=4}if(u>1&&h+u<=a){const g=new Uint8Array(r.buffer,h,u),v=new TextDecoder("utf-8").decode(g.slice(0,-1));o.push(v)}s+=c}return o.join(`

`)}function PT(r,e){if(r.intent_code=1002,r.datatypeCode!==16&&r.datatypeCode!==8)return e;let n=new Float32Array(e);if(r.datatypeCode===8&&(n=new Int32Array(e)),d2()){const o=new Uint32Array(e);for(let l=0;l<o.length;l++){const c=o[l];o[l]=(c&255)<<24|(c&65280)<<8|(c&16711680)>>>8|(c&4278190080)>>>24}}r.littleEndian=d2();let i=!0,a=1/0,s=-1/0;for(let o=0;o<n.length;o++){const l=n[o];Number.isFinite(l)&&(Number.isInteger(l)||(i=!1),l<a&&(a=l),l>s&&(s=l))}if(!i||a<0||s>2147483647)return Z.warn(`FreeSurfer Labels must be integers in INT32 range. range ${a}..${s}`),e;if(s>32767){r.datatypeCode=8;const o=new Int32Array(n.length);for(let l=0;l<n.length;l++)o[l]=Math.trunc(n[l]);return o.buffer}else if(s>255){r.datatypeCode=4,r.numBitsPerVoxel=16;const o=new Int16Array(n.length);for(let l=0;l<n.length;l++)o[l]=Math.trunc(n[l]);return o.buffer}else{r.datatypeCode=2,r.numBitsPerVoxel=8;const o=new Uint8Array(n.length);for(let l=0;l<n.length;l++)o[l]=Math.trunc(n[l]);return o.buffer}}function LT(r,e,n){const i=r.byteLength-e.vox_offset;if(i<n)return Z.error(`MGH image data size mismatch: expected ${n}, found ${i}`),!1;if(i===n)return!1;const a=e.vox_offset+n+20,s=r.byteLength-a;return s<=12?!1:OC(new DataView(r),a,s).toLowerCase().endsWith("lut.txt")?!0:OC(new DataView(r),a,s,3).includes("mri_label2vol")}async function fY(r,e){r.hdr||(Z.debug("readMgh called before nvImage.hdr was initialized. Creating default."),r.hdr=new Fe);const n=r.hdr;n.littleEndian=!1;let i=e,a=new DataView(i);if(i.byteLength>=2&&a.getUint8(0)===31&&a.getUint8(1)===139)try{i=await qe.decompressToBuffer(new Uint8Array(e)),a=new DataView(i)}catch(q){return Z.error("Failed to decompress MGZ file.",q),null}if(i.byteLength<284)return Z.error("File too small to be a valid MGH/MGZ header."),null;const s=a.getInt32(0,!1),o=a.getInt32(4,!1),l=a.getInt32(8,!1),c=a.getInt32(12,!1),u=a.getInt32(16,!1),h=a.getInt32(20,!1),g=a.getFloat32(30,!1),v=a.getFloat32(34,!1),m=a.getFloat32(38,!1),y=a.getFloat32(42,!1),b=a.getFloat32(46,!1),x=a.getFloat32(50,!1),A=a.getFloat32(54,!1),C=a.getFloat32(58,!1),E=a.getFloat32(62,!1),S=a.getFloat32(66,!1),M=a.getFloat32(70,!1),R=a.getFloat32(74,!1),T=a.getFloat32(78,!1),B=a.getFloat32(82,!1),F=a.getFloat32(86,!1);if(s!==1&&Z.warn(`Unexpected MGH version: ${s}.`),o<=0||l<=0||c<=0)return Z.error(`Invalid MGH dimensions: ${o}x${l}x${c}`),null;switch(h){case 0:n.numBitsPerVoxel=8,n.datatypeCode=2;break;case 4:n.numBitsPerVoxel=16,n.datatypeCode=4;break;case 1:n.numBitsPerVoxel=32,n.datatypeCode=8;break;case 3:n.numBitsPerVoxel=32,n.datatypeCode=16;break;default:return Z.error(`Unsupported MGH data type: ${h}`),null}n.dims[1]=o,n.dims[2]=l,n.dims[3]=c,n.dims[4]=Math.max(1,u),n.dims[0]=n.dims[4]>1?4:3,n.pixDims[1]=Math.abs(g),n.pixDims[2]=Math.abs(v),n.pixDims[3]=Math.abs(m),n.pixDims[4]=0,n.sform_code=1,n.qform_code=0;const I=Wn(y*n.pixDims[1],A*n.pixDims[2],S*n.pixDims[3],0,b*n.pixDims[1],C*n.pixDims[2],M*n.pixDims[3],0,x*n.pixDims[1],E*n.pixDims[2],R*n.pixDims[3],0,0,0,0,1),U=Jt(n.dims[1]/2,n.dims[2]/2,n.dims[3]/2,1),k=Qi();Kr(k,U,I);const O=Me(T-k[0],B-k[1],F-k[2]);n.affine=[[I[0],I[1],I[2],O[0]],[I[4],I[5],I[6],O[1]],[I[8],I[9],I[10],O[2]],[0,0,0,1]],n.vox_offset=284,n.magic="n+1";const V=n.numBitsPerVoxel/8,P=o*l*c*n.dims[4]*V,_=i.slice(n.vox_offset,n.vox_offset+P);return LT(i,n,P)?PT(n,_):_}var _T={};Z0(_T,{readNifti:()=>hY});async function hY(r,e){let n=e,i=null;try{if(vy(n)&&(Z.debug(`Decompressing NIfTI file: ${r.name}`),n=await Lz(n),Z.debug(`Decompression complete for: ${r.name}`)),!n||n.byteLength===0)throw new Error("Buffer became invalid after decompression attempt.");if(r.hdr=await wc(n),zz(r.hdr)&&(r.extensions=r.hdr.extensions),r.hdr===null)throw new Error(`Failed to read NIfTI header: ${r.name}`);if(r.hdr.cal_min===0&&r.hdr.cal_max===255&&r.hdr.datatypeCode!==2&&(Z.debug(`Resetting suspicious cal_min/max (0/255) for non-uint8 NIfTI: ${r.name}`),r.hdr.cal_min=0,r.hdr.cal_max=0),i=Gz(r.hdr,n),i===null)throw new Error(`nifti-reader-js readImage returned null for ${r.name}`);return i}catch(a){return Z.error(`Error processing NIfTI file ${r.name}:`,a),r.hdr=null,null}}var zT={};Z0(zT,{readNrrd:()=>dY});async function dY(r,e,n=null){r.hdr||(Z.warn("readNrrd called before nvImage.hdr was initialized. Creating default."),r.hdr=new Fe);const i=r.hdr;i.pixDims=[1,1,1,1,1,0,0,0];const a=e.byteLength;let s=null;const o=new Uint8Array(e);for(let R=1;R<a;R++)if(o[R-1]===10&&o[R]===10){const T=e.slice(0,R-1);s=new TextDecoder().decode(T),i.vox_offset=R+1;break}if(s===null)return Z.error("readNrrd: could not extract txt"),null;const l=s.split(`
`);if(!l[0].startsWith("NRRD"))return Z.error("Invalid NRRD image (magic signature missing)"),null;const c=l.length;let u=!1,h=!1,g=!1;const v=mo(NaN,0,0,0,1,0,0,0,1),m=Me(0,0,0);let y=K_();for(let R=1;R<c;R++){let T=l[R];if((T.length===0||T[0]==="#")&&(T.startsWith("#")||T.trim().length===0))continue;T=T.toLowerCase();const B=T.split(":");if(B.length<2)continue;const F=B[0].trim();let I=B[1].trim();switch(I=I.replaceAll(")"," "),I=I.replaceAll("("," "),I=I.trim(),F){case"data file":g=!0;break;case"encoding":if(I.includes("raw"))u=!1;else if(I.includes("gz"))u=!0;else return Z.error("Unsupported NRRD encoding"),null;break;case"type":switch(I){case"uchar":case"unsigned char":case"uint8":case"uint8_t":i.numBitsPerVoxel=8,i.datatypeCode=2;break;case"signed char":case"int8":case"int8_t":i.numBitsPerVoxel=8,i.datatypeCode=256;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":i.numBitsPerVoxel=16,i.datatypeCode=4;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":i.numBitsPerVoxel=16,i.datatypeCode=512;break;case"int":case"signed int":case"int32":case"int32_t":i.numBitsPerVoxel=32,i.datatypeCode=8;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":i.numBitsPerVoxel=32,i.datatypeCode=768;break;case"float":i.numBitsPerVoxel=32,i.datatypeCode=16;break;case"double":i.numBitsPerVoxel=64,i.datatypeCode=64;break;default:return Z.error("Unsupported NRRD data type: "+I),null}break;case"spacings":{const U=I.split(/[ ,]+/);for(let k=0;k<U.length;k++)i.pixDims[k+1]=parseFloat(U[k])}break;case"sizes":{const U=I.split(/[ ,]+/);i.dims[0]=U.length;for(let k=0;k<U.length;k++)i.dims[k+1]=parseInt(U[k])}break;case"endian":I.includes("little")?i.littleEndian=!0:I.includes("big")&&(i.littleEndian=!1);break;case"space directions":{const U=I.split(/[ ,]+/);if(U.length===9)for(let k=0;k<9;k++)v[k]=parseFloat(U[k])}break;case"space origin":{const U=I.split(/[ ,]+/);U.length===3&&(m[0]=parseFloat(U[0]),m[1]=parseFloat(U[1]),m[2]=parseFloat(U[2]))}break;case"space units":I.includes("microns")&&(h=!0);break;case"space":I.includes("right-anterior-superior")||I.includes("ras")?y=mo(1,0,0,0,1,0,0,0,1):I.includes("left-anterior-superior")||I.includes("las")?y=mo(-1,0,0,0,1,0,0,0,1):I.includes("left-posterior-superior")||I.includes("lps")?y=mo(-1,0,0,0,-1,0,0,0,1):Z.warn("Unsupported NRRD space value:",I);break;default:Z.warn("Unknown:",F);break}}if(!isNaN(v[0])){i.sform_code=2,h&&(W_(v,v,.001),m[0]*=.001,m[1]*=.001,m[2]*=.001),y[0]<0&&(m[0]=-m[0]),y[4]<0&&(m[1]=-m[1]),y[8]<0&&(m[2]=-m[2]),aT(v,y,v);const R=Wn(v[0],v[3],v[6],m[0],v[1],v[4],v[7],m[1],v[2],v[5],v[8],m[2],0,0,0,1);if(!r.vox2mm)return null;const T=r.vox2mm([0,0,0],R),B=r.vox2mm([1,0,0],R);Wt(B,B,T);const F=r.vox2mm([0,1,0],R);Wt(F,F,T);const I=r.vox2mm([0,0,1],R);Wt(I,I,T),i.pixDims[1]=Ts(B),i.pixDims[2]=Ts(F),i.pixDims[3]=Ts(I),i.affine=[[R[0],R[1],R[2],R[3]],[R[4],R[5],R[6],R[7]],[R[8],R[9],R[10],R[11]],[0,0,0,1]]}let b=null;const x=g?n:e,A=g?0:i.vox_offset;if(g&&!x)return Z.warn("Missing data: NRRD header describes detached data file but only one URL provided"),null;if(!x||A>=x.byteLength)return Z.error(`NRRD data offset (${A}) invalid for buffer length (${x?.byteLength??0})`),null;let C=x.slice(A);if(u)try{Z.debug("Decompressing NRRD data..."),C=await qe.decompressToBuffer(new Uint8Array(C)),Z.debug("Decompression complete.")}catch(R){return Z.error("Failed to decompress NRRD data.",R),null}const E=i.numBitsPerVoxel/8,M=i.dims.slice(1,i.dims[0]+1).reduce((R,T)=>R*Math.max(1,T),1)*E;return C.byteLength<M?(Z.error(`NRRD image data size mismatch: expected ${M}, found ${C.byteLength}`),null):(C.byteLength>M&&(Z.warn(`NRRD has extra ${C.byteLength-M} bytes after expected image data. Truncating.`),C=C.slice(0,M)),b=C,i.datatypeCode?i.numBitsPerVoxel?b:(Z.error("NRRD parsing failed to set numBitsPerVoxel."),null):(Z.error("NRRD parsing failed to set datatypeCode."),null))}var yn=class jd{constructor(e=null,n="",i="gray",a=1,s=null,o=NaN,l=NaN,c=!0,u=.02,h=!1,g=!1,v="",m=0,y=ut.UNKNOWN,b=NaN,x=NaN,A=!0,C=null,E=0){j(this,"name"),j(this,"id"),j(this,"url"),j(this,"headers"),j(this,"_colormap"),j(this,"_opacity"),j(this,"percentileFrac"),j(this,"ignoreZeroVoxels"),j(this,"trustCalMinMax"),j(this,"colormapNegative"),j(this,"colormapLabel"),j(this,"colormapInvert"),j(this,"nFrame4D"),j(this,"frame4D"),j(this,"nTotalFrame4D"),j(this,"cal_minNeg"),j(this,"cal_maxNeg"),j(this,"colorbarVisible",!0),j(this,"modulationImage",null),j(this,"modulateAlpha",0),j(this,"series",[]),j(this,"nVox3D"),j(this,"oblique_angle"),j(this,"maxShearDeg"),j(this,"useQFormNotSForm"),j(this,"colormapType"),j(this,"pixDims"),j(this,"matRAS"),j(this,"pixDimsRAS"),j(this,"obliqueRAS"),j(this,"dimsRAS"),j(this,"permRAS"),j(this,"img2RASstep"),j(this,"img2RASstart"),j(this,"toRAS"),j(this,"toRASvox"),j(this,"frac2mm"),j(this,"frac2mmOrtho"),j(this,"extentsMinOrtho"),j(this,"extentsMaxOrtho"),j(this,"mm2ortho"),j(this,"hdr",null),j(this,"extensions"),j(this,"imageType"),j(this,"img"),j(this,"imaginary"),j(this,"v1"),j(this,"fileObject"),j(this,"dims"),j(this,"onColormapChange",()=>{}),j(this,"onOpacityChange",()=>{}),j(this,"mm000"),j(this,"mm100"),j(this,"mm010"),j(this,"mm001"),j(this,"cal_min"),j(this,"cal_max"),j(this,"robust_min"),j(this,"robust_max"),j(this,"global_min"),j(this,"global_max"),j(this,"urlImgData"),j(this,"isManifest"),j(this,"limitFrames4D"),this.init(e,n,i,a,s,o,l,c,u,h,g,v,m,y,b,x,A,C,E)}init(e=null,n="",i="",a=1,s=null,o=NaN,l=NaN,c=!0,u=.02,h=!1,g=!1,v="",m=0,y=ut.UNKNOWN,b=NaN,x=NaN,A=!0,C=null,E=0,S=null){const M=i==="";if(M&&(i="gray"),this.name=n,this.imageType=y,this.id=l2(),this._colormap=i,this._opacity=a>1?1:a,this.percentileFrac=u,this.ignoreZeroVoxels=h,this.trustCalMinMax=c,this.colormapNegative=v,this.colormapLabel=C,this.frame4D=m,this.cal_minNeg=b,this.cal_maxNeg=x,this.colorbarVisible=A,this.colormapType=E,this.useQFormNotSForm=g,!e)return;if(M&&this.hdr&&this.hdr.intent_code===1002&&(i="random",this._colormap=i),this.hdr&&typeof this.hdr.magic=="number"&&(this.hdr.magic="n+1"),this.nFrame4D=1,this.hdr)for(let F=4;F<7;F++)this.hdr.dims[F]>1&&(this.nFrame4D*=this.hdr.dims[F]);if(this.frame4D=Math.min(this.frame4D,this.nFrame4D-1),this.nTotalFrame4D=this.nFrame4D,!this.hdr||!S)return;this.nVox3D=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const R=this.nVox3D*(this.hdr.numBitsPerVoxel/8),T=S.byteLength/R;T!==this.nFrame4D&&(T>0&&T*R===S.byteLength?Z.debug("Loading the first "+T+" of "+this.nFrame4D+" volumes"):Z.warn("This header does not match voxel data",this.hdr,S.byteLength),this.nFrame4D=T),(this.hdr.intent_code===1007||this.hdr.intent_code===2003)&&this.nFrame4D===3&&this.hdr.datatypeCode===16&&(S=this.float32V1asRGBA(new Float32Array(S)).buffer),(this.hdr.pixDims[1]===0||this.hdr.pixDims[2]===0||this.hdr.pixDims[3]===0)&&Z.error("pixDims not plausible",this.hdr),(isNaN(this.hdr.scl_slope)||this.hdr.scl_slope===0)&&(this.hdr.scl_slope=1),isNaN(this.hdr.scl_inter)&&(this.hdr.scl_inter=0);let B=VC(this.hdr.affine);if(g||!B||this.hdr.qform_code>this.hdr.sform_code){Z.debug("spatial transform based on QForm");const F=this.hdr.quatern_b,I=this.hdr.quatern_c,U=this.hdr.quatern_d,k=Math.sqrt(1-(Math.pow(F,2)+Math.pow(I,2)+Math.pow(U,2))),O=this.hdr.pixDims[0]===0?1:this.hdr.pixDims[0],V=[[k*k+F*F-I*I-U*U,2*F*I-2*k*U,2*F*U+2*k*I],[2*F*I+2*k*U,k*k+I*I-F*F-U*U,2*I*U-2*k*F],[2*F*U-2*k*I,2*I*U+2*k*F,k*k+U*U-I*I-F*F]],L=this.hdr.affine;for(let P=0;P<3;P+=1)for(let _=0;_<3;_+=1)L[P][_]=V[P][_]*this.hdr.pixDims[_+1],_===2&&(L[P][_]*=O);L[0][3]=this.hdr.qoffset_x,L[1][3]=this.hdr.qoffset_y,L[2][3]=this.hdr.qoffset_z,this.hdr.affine=L}if(B=VC(this.hdr.affine),!B){Z.debug("Defective NIfTI: spatial transform does not make sense");let F=this.hdr.pixDims[1],I=this.hdr.pixDims[2],U=this.hdr.pixDims[3];(isNaN(F)||F===0)&&(F=1),(isNaN(I)||I===0)&&(I=1),(isNaN(U)||U===0)&&(U=1),this.hdr.pixDims[1]=F,this.hdr.pixDims[2]=I,this.hdr.pixDims[3]=U;const k=[[F,0,0,0],[0,I,0,0],[0,0,U,0],[0,0,0,1]];this.hdr.affine=k}if(this.hdr.datatypeCode!==128&&this.hdr.datatypeCode!==2304&&this.hdr.littleEndian!==d2()&&this.hdr.numBitsPerVoxel>8){if(this.hdr.numBitsPerVoxel===16){const F=new Uint16Array(S);for(let I=0;I<F.length;I++){const U=F[I];F[I]=((U&255)<<8|U>>8&255)<<16>>16}}else if(this.hdr.numBitsPerVoxel===32){const F=new Uint32Array(S);for(let I=0;I<F.length;I++){const U=F[I];F[I]=(U&255)<<24|(U&65280)<<8|U>>8&65280|U>>24&255}}else if(this.hdr.numBitsPerVoxel===64){const F=this.hdr.numBitsPerVoxel/8,I=new Uint8Array(S);for(let U=0;U<I.length;U+=F){let k=F-1;for(let O=0;O<k;O++){const V=I[U+O];I[U+O]=I[U+k],I[U+k]=V,k--}}}}switch(this.hdr.datatypeCode){case 2:this.img=new Uint8Array(S);break;case 4:this.img=new Int16Array(S);break;case 16:this.img=new Float32Array(S);break;case 64:this.img=new Float64Array(S);break;case 128:this.img=new Uint8Array(S);break;case 512:this.img=new Uint16Array(S);break;case 2304:this.img=new Uint8Array(S);break;case 256:{const F=new Int8Array(S),I=F.length;this.img=new Int16Array(I);for(let U=0;U<I;U++)this.img[U]=F[U];this.hdr.datatypeCode=4,this.hdr.numBitsPerVoxel=16;break}case 1:{const F=this.hdr.dims[1]*this.hdr.dims[2]*Math.max(1,this.hdr.dims[3])*Math.max(1,this.hdr.dims[4]),I=new Uint8Array(S);this.img=new Uint8Array(F);const U=new Uint8Array(8);for(let O=0;O<8;O++)U[O]=Math.pow(2,O);let k=-1;for(let O=0;O<F;O++){const V=O%8;V===0&&k++,(I[k]&U[V])!==0&&(this.img[O]=1)}this.hdr.datatypeCode=2,this.hdr.numBitsPerVoxel=8;break}case 768:{const F=new Uint32Array(S),I=F.length;this.img=new Float64Array(I);for(let U=0;U<I-1;U++)this.img[U]=F[U];this.hdr.datatypeCode=64;break}case 8:{const F=new Int32Array(S),I=F.length;this.img=new Float64Array(I);for(let U=0;U<I-1;U++)this.img[U]=F[U];this.hdr.datatypeCode=64;break}case 1024:{const F=new BigInt64Array(S),I=F.length;this.img=new Float64Array(I);for(let U=0;U<I-1;U++)this.img[U]=Number(F[U]);this.hdr.datatypeCode=64;break}case 32:{const F=new Float32Array(S),I=Math.floor(F.length/2);this.imaginary=new Float32Array(I),this.img=new Float32Array(I);let U=0;for(let k=0;k<I-1;k++)this.img[k]=F[U],this.imaginary[k]=F[U+1],U+=2;this.hdr.datatypeCode=16;break}default:throw new Error("datatype "+this.hdr.datatypeCode+" not supported")}this.calculateRAS(),isNaN(o)||(this.hdr.cal_min=o),isNaN(l)||(this.hdr.cal_max=l),this.calMinMax()}static async new(e=null,n="",i="",a=1,s=null,o=NaN,l=NaN,c=!0,u=.02,h=!1,g=!1,v="",m=0,y=ut.UNKNOWN,b=NaN,x=NaN,A=!0,C=null,E=0,S){const M=new jd,R=/(?:\.([^.]+))?$/;let T=R.exec(n)[1]||"";T=T.toUpperCase(),T==="GZ"&&(T=R.exec(n.slice(0,-3))[1],T=T.toUpperCase());let B=null;if(y===ut.UNKNOWN&&(y=ut.parse(T)),e instanceof ArrayBuffer&&e.byteLength>=2&&y===ut.DCM){const F=new Uint8Array(e);(F[0]===92&&F[1]===1||F[1]===92&&F[0]===1)&&(y=ut.NII)}switch(M.imageType=y,y){case ut.DCM_FOLDER:case ut.DCM_MANIFEST:case ut.DCM:return;case ut.FIB:[B,M.v1]=await M.readFIB(e);break;case ut.MIH:case ut.MIF:B=await M.readMIF(e,s);break;case ut.NHDR:case ut.NRRD:if(B=await zT.readNrrd(M,e),B===null)throw new Error(`Failed to parse NHDR/NRRD file ${n}`);break;case ut.MHD:case ut.MHA:B=await M.readMHA(e,s);break;case ut.MGH:case ut.MGZ:if(B=await OT.readMgh(M,e),B===null)throw new Error(`Failed to parse MGH/MGZ file ${n}`);break;case ut.SRC:B=await M.readSRC(e);break;case ut.V:B=M.readECAT(e);break;case ut.V16:B=M.readV16(e);break;case ut.VMR:B=M.readVMR(e);break;case ut.HEAD:B=await M.readHEAD(e,s);break;case ut.BMP:B=await M.readBMP(e);break;case ut.NPY:B=await M.readNPY(e);break;case ut.NPZ:B=await M.readNPZ(e);break;case ut.ZARR:B=await M.readZARR(e,S);break;case ut.NII:if(B=await _T.readNifti(M,e),B===null)throw new Error(`Failed to parse NIfTI file ${n}.`);break;default:throw new Error("Image type not supported")}return M.init(e,n,i,a,s,o,l,c,u,h,g,v,m,y,b,x,A,C,E,B),M}computeObliqueAngle(e){const n=Er(e);Zn(n,e);const i=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),a=Math.max(Math.max(Math.abs(n[0]),Math.abs(n[1])),Math.abs(n[2]))/i,s=Math.sqrt(n[4]*n[4]+n[5]*n[5]+n[6]*n[6]),o=Math.max(Math.max(Math.abs(n[4]),Math.abs(n[5])),Math.abs(n[6]))/s,l=Math.sqrt(n[8]*n[8]+n[9]*n[9]+n[10]*n[10]),c=Math.max(Math.max(Math.abs(n[8]),Math.abs(n[9])),Math.abs(n[10]))/l,u=Math.min(Math.min(a,o),c);let h=Math.abs(Math.acos(u)*180/3.141592653);return h>.01?Z.warn("Warning voxels not aligned with world space: "+h+` degrees from plumb.
`):h=0,h}float32V1asRGBA(e){e.length!==this.nVox3D*3&&Z.warn("float32V1asRGBA() expects "+this.nVox3D*3+"voxels, got ",+e.length);const n=e.slice();this.hdr.datatypeCode=2304,this.nFrame4D=1;for(let c=4;c<7;c++)this.hdr.dims[c]=1;this.hdr.dims[0]=3;const i=new Uint8Array(this.nVox3D*4);let a=1;for(let c=0;c<this.nVox3D*3;c++)isNaN(n[c])||(a=Math.max(a,Math.abs(n[c])));const s=255/a,o=this.nVox3D*2;let l=0;for(let c=0;c<this.nVox3D;c++){const u=n[c],h=n[c+this.nVox3D],g=n[c+o];i[l]=Math.abs(u*s),i[l+1]=Math.abs(h*s),i[l+2]=Math.abs(g*s);const v=+(u>0)*1,m=+(h>0)*2,y=+(g>0)*4;let b=248+v+m+y;Math.abs(u)+Math.abs(h)+Math.abs(g)<.1&&(b=0),i[l+3]=b,l+=4}return i}loadImgV1(e=!1,n=!1,i=!1){let a=this.v1;if(!a&&this.nFrame4D===3&&this.img.constructor===Float32Array&&(a=this.img.slice()),!a)return Z.warn("Image does not have V1 data"),!1;if(e)for(let s=0;s<this.nVox3D;s++)a[s]=-a[s];if(n)for(let s=this.nVox3D;s<2*this.nVox3D;s++)a[s]=-a[s];if(i)for(let s=2*this.nVox3D;s<3*this.nVox3D;s++)a[s]=-a[s];return this.img=this.float32V1asRGBA(a),!0}calculateOblique(){if(!this.matRAS)throw new Error("matRAS not defined");if(this.pixDimsRAS===void 0)throw new Error("pixDimsRAS not defined");if(!this.dimsRAS)throw new Error("dimsRAS not defined");this.oblique_angle=this.computeObliqueAngle(this.matRAS);const e=this.vox2mm([0,0,0],this.matRAS),n=this.vox2mm([1/this.pixDimsRAS[1],0,0],this.matRAS),i=this.vox2mm([0,1/this.pixDimsRAS[2],0],this.matRAS),a=this.vox2mm([0,0,1/this.pixDimsRAS[3]],this.matRAS);Wt(n,n,e),Wt(i,i,e),Wt(a,a,e);const s=Wn(n[0],n[1],n[2],0,i[0],i[1],i[2],0,a[0],a[1],a[2],0,0,0,0,1);this.obliqueRAS=Er(s);const o=Math.abs(90-ep(n,i)*(180/Math.PI)),l=Math.abs(90-ep(n,a)*(180/Math.PI)),c=Math.abs(90-ep(i,a)*(180/Math.PI));this.maxShearDeg=Math.max(Math.max(o,l),c),this.maxShearDeg>.1&&Z.warn("Warning: voxels are rhomboidal, maximum shear is %f degrees.",this.maxShearDeg);const u=Jt(this.dimsRAS[1],this.dimsRAS[2],this.dimsRAS[3],1),h=Er(this.matRAS);Zn(h,h);const g=Jt(-.5,-.5,-.5,0);Rl(h,h,Me(g[0],g[1],g[2])),h[0]*=u[0],h[1]*=u[0],h[2]*=u[0],h[4]*=u[1],h[5]*=u[1],h[6]*=u[1],h[8]*=u[2],h[9]*=u[2],h[10]*=u[2],this.frac2mm=Er(h);const v=this.pixDimsRAS[1],m=this.pixDimsRAS[2],y=this.pixDimsRAS[3],b=Er(h);b[0]=v*u[0],b[1]=0,b[2]=0,b[4]=0,b[5]=m*u[1],b[6]=0,b[8]=0,b[9]=0,b[10]=y*u[2];const x=this.mm2vox([0,0,0],!0);b[12]=(-x[0]-.5)*v,b[13]=(-x[1]-.5)*m,b[14]=(-x[2]-.5)*y,this.frac2mmOrtho=Er(b),this.extentsMinOrtho=[b[12],b[13],b[14]],this.extentsMaxOrtho=[b[0]+b[12],b[5]+b[13],b[10]+b[14]],this.mm2ortho=bt(),kn(this.mm2ortho,s)}THD_daxes_to_NIFTI(e,n,i){const a=this.hdr;if(a===null)throw new Error("HDR is not set");a.sform_code=2;const s="xxyyzzg";let o=-1,l=-1,c=-1;const u=["x","y","z"];u[0]=s[i[0]],u[1]=s[i[1]],u[2]=s[i[2]];const h=e.slice(0,3),g=n.slice(0,3);for(let v=0;v<3;v++)u[v]==="x"?o=v:u[v]==="y"?l=v:c=v;o<0||l<0||c<0||o===l||o===c||l===c||(a.pixDims[1]=Math.abs(h[0]),a.pixDims[2]=Math.abs(h[1]),a.pixDims[3]=Math.abs(h[2]),a.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],a.affine[0][o]=-h[o],a.affine[1][l]=-h[l],a.affine[2][c]=h[c],a.affine[0][3]=-g[o],a.affine[1][3]=-g[l],a.affine[2][3]=g[c])}SetPixDimFromSForm(){if(!this.hdr)throw new Error("hdr not defined");const e=this.hdr.affine,n=Wn(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],e[3][0],e[3][1],e[3][2],e[3][3]),i=this.vox2mm([0,0,0],n),a=this.vox2mm([1,0,0],n);Wt(a,a,i);const s=this.vox2mm([0,1,0],n);Wt(s,s,i);const o=this.vox2mm([0,0,1],n);Wt(o,o,i),this.hdr.pixDims[1]=Ts(a),this.hdr.pixDims[2]=Ts(s),this.hdr.pixDims[3]=Ts(o)}readECAT(e){this.hdr=new Fe;const n=this.hdr;n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=new DataView(e),a=i.getInt32(0,!1),s=i.getInt16(50,!1);if(a!==1296127058||s<1||s>14)throw new Error("Not a valid ECAT file");let o=512,l=0;const c=[];let u=new Float32Array;for(;;){const h=i.getInt32(o,!1),g=i.getInt32(o+12,!1);if(h+g!==31)break;let v=o+20,m=0,y=0;for(;m<31&&(y=i.getInt32(v,!1),v+=16,y!==0);){m++;let b=y*512;const x=b-512,A=i.getUint16(x,!1);n.dims[1]=i.getUint16(x+4,!1),n.dims[2]=i.getUint16(x+6,!1),n.dims[3]=i.getUint16(x+8,!1);const C=i.getFloat32(x+26,!1);n.pixDims[1]=i.getFloat32(x+34,!1)*10,n.pixDims[2]=i.getFloat32(x+38,!1)*10,n.pixDims[3]=i.getFloat32(x+42,!1)*10,n.pixDims[4]=i.getUint32(x+46,!1)/1e3,c.push(n.pixDims[4]);const E=n.dims[1]*n.dims[2]*n.dims[3],S=new Float32Array(E);if(A===1)for(let R=0;R<E;R++)S[R]=i.getUint8(b)*C,b++;else if(A===6)for(let R=0;R<E;R++)S[R]=i.getUint16(b,!1)*C,b+=2;else if(A===7)for(let R=0;R<E;R++)S[R]=i.getUint32(b,!1)*C,b+=4;else Z.warn("Unknown ECAT data type "+A);const M=u.slice(0);u=new Float32Array(M.length+S.length),u.set(M),u.set(S,M.length),l++}if(y===0)break;o+=512}if(n.dims[4]=l,n.pixDims[4]=c[0],l>1){n.dims[0]=4;let h=!1;for(let g=0;g<l;g++)c[g]!==c[0]&&(h=!0);h&&Z.warn("Frame durations vary")}return n.sform_code=1,n.affine=[[-n.pixDims[1],0,0,(n.dims[1]-2)*.5*n.pixDims[1]],[0,-n.pixDims[2],0,(n.dims[2]-2)*.5*n.pixDims[2]],[0,0,-n.pixDims[3],(n.dims[3]-2)*.5*n.pixDims[3]],[0,0,0,1]],n.numBitsPerVoxel=32,n.datatypeCode=16,u.buffer}readV16(e){this.hdr=new Fe;const n=this.hdr;n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=new DataView(e);return n.dims[1]=i.getUint16(0,!0),n.dims[2]=i.getUint16(2,!0),n.dims[3]=i.getUint16(4,!0),2*n.dims[1]*n.dims[2]*n.dims[3]+6!==e.byteLength&&Z.warn("This does not look like a valid BrainVoyager V16 file"),n.numBitsPerVoxel=16,n.datatypeCode=512,Z.warn("Warning: V16 files have no spatial transforms"),n.affine=[[0,0,-n.pixDims[1],(n.dims[1]-2)*.5*n.pixDims[1]],[-n.pixDims[2],0,0,(n.dims[2]-2)*.5*n.pixDims[2]],[0,-n.pixDims[3],0,(n.dims[3]-2)*.5*n.pixDims[3]],[0,0,0,1]],n.littleEndian=!0,e.slice(6)}async readNPY(e){function n(S){return{"|b1":1,"<i1":1,"<u1":1,"<i2":2,"<u2":2,"<i4":4,"<u4":4,"<f4":4,"<f8":8}[S]??1}function i(S){return{"|b1":2,"<i1":256,"<u1":2,"<i2":4,"<u2":512,"<i4":8,"<u4":768,"<f4":16,"<f8":64}[S]??16}const a=new DataView(e),s=[a.getUint8(0),a.getUint8(1),a.getUint8(2),a.getUint8(3),a.getUint8(4),a.getUint8(5)],o=[147,78,85,77,80,89];if(!s.every((S,M)=>S===o[M]))throw new Error("Not a valid NPY file: Magic number mismatch");const l=a.getUint16(8,!0),c=new TextDecoder("utf-8").decode(e.slice(10,10+l)),u=c.match(/'shape': \((.*?)\)/);if(!u)throw new Error("Invalid NPY header: Shape not found");const h=u[1].split(",").map(S=>S.trim()).filter(S=>S!=="").map(Number),g=c.match(/'descr': '([^']+)'/);if(!g)throw new Error("Invalid NPY header: Data type not found");const v=g[1],m=h.reduce((S,M)=>S*M,1),y=10+l,b=e.slice(y,y+m*n(v)),x=h.length>0?h[h.length-1]:1,A=h.length>1?h[h.length-2]:1,C=h.length>2?h[h.length-3]:1;this.hdr=new Fe;const E=this.hdr;return E.dims=[3,x,A,C,0,0,0,0],E.pixDims=[1,1,1,1,1,0,0,0],E.affine=[[E.pixDims[1],0,0,-(E.dims[1]-2)*.5*E.pixDims[1]],[0,-E.pixDims[2],0,(E.dims[2]-2)*.5*E.pixDims[2]],[0,0,-E.pixDims[3],(E.dims[3]-2)*.5*E.pixDims[3]],[0,0,0,1]],E.numBitsPerVoxel=n(v)*8,E.datatypeCode=i(v),b}async readNPZ(e){const n=new IT(e);for(let i=0;i<n.entries.length;i++){const a=n.entries[i];if(a.fileName.toLowerCase().endsWith(".npy")){const s=await a.extract();return await this.readNPY(s.buffer)}}}async imageDataFromArrayBuffer(e){return new Promise((n,i)=>{const a=new Blob([e]),s=URL.createObjectURL(a),o=new Image;o.crossOrigin="Anonymous",o.src=s,o.onload=()=>{URL.revokeObjectURL(s);const l=document.createElement("canvas");l.width=o.width,l.height=o.height;const c=l.getContext("2d");if(!c){i(new Error("Failed to get 2D context"));return}c.drawImage(o,0,0),n(c.getImageData(0,0,o.width,o.height))},o.onerror=l=>{URL.revokeObjectURL(s),i(l)}})}async readBMP(e){const n=await this.imageDataFromArrayBuffer(e),{width:i,height:a,data:s}=n;this.hdr=new Fe;const o=this.hdr;o.dims=[3,i,a,1,0,0,0,0],o.pixDims=[1,1,1,1,1,0,0,0],o.affine=[[o.pixDims[1],0,0,-(o.dims[1]-2)*.5*o.pixDims[1]],[0,-o.pixDims[2],0,(o.dims[2]-2)*.5*o.pixDims[2]],[0,0,-o.pixDims[3],(o.dims[3]-2)*.5*o.pixDims[3]],[0,0,0,1]],o.numBitsPerVoxel=8,o.datatypeCode=2304;let l=!0;for(let c=0;c<s.length;c+=4)if(s[c]!==s[c+1]||s[c]!==s[c+2]){l=!1;break}if(l){o.datatypeCode=2;const c=new Uint8Array(i*a);for(let u=0,h=0;u<s.length;u+=4,h++)c[h]=s[u];return c.buffer}return s.buffer}async readZARR(e,n){let{width:i,height:a,depth:s=1,data:o}=n??{},l=i*a*s*3,c=l===o.length;if(c||(l=i*a*s,s===3&&(c=!0,s=1)),l!==o.length)throw new Error(`Expected RGB ${i}×${a}×${s}×3 =  ${l}, but ZARR length ${o.length}`);this.hdr=new Fe;const u=this.hdr;if(u.dims=[3,i,a,s,1,1,1,1],u.pixDims=[1,1,1,1,0,0,0,0],u.affine=[[u.pixDims[1],0,0,-(u.dims[1]-2)*.5*u.pixDims[1]],[0,-u.pixDims[2],0,(u.dims[2]-2)*.5*u.pixDims[2]],[0,0,-u.pixDims[3],(u.dims[3]-2)*.5*u.pixDims[3]],[0,0,0,1]],!c){if(u.numBitsPerVoxel=8,u.datatypeCode=2,o instanceof Uint8Array){const y=new ArrayBuffer(o.length);return new Uint8Array(y).set(o),y}return o}u.numBitsPerVoxel=24,u.datatypeCode=128;function h(y,b,x,A){const C=b*x,E=new Uint8Array(C*A*3),S=new Array(A);for(let T=0;T<A;T++)S[T]=C*3*T;let M=0,R=0;for(let T=0;T<C;T++){for(let B=0;B<A;B++)E[S[B]+R]=y[M++],E[S[B]+R+1]=y[M++],E[S[B]+R+2]=y[M++];R+=3}return E}const g=h(o,u.dims[1],u.dims[2],u.dims[3]),v=new ArrayBuffer(g.length);return new Uint8Array(v).set(g),v}readVMR(e){this.hdr=new Fe;const n=this.hdr;n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=new DataView(e),a=i.getUint16(0,!0);a!==4&&Z.warn("Not a valid version 4 VMR image"),n.dims[1]=i.getUint16(2,!0),n.dims[2]=i.getUint16(4,!0),n.dims[3]=i.getUint16(6,!0);const s=n.dims[1]*n.dims[2]*n.dims[3];if(a>=4){let o=8+s;const l=i.getUint32(o+88,!0);if(o=o+92,l>0){const c=e.byteLength;for(let u=0;u<l;u++){for(;o<c&&i.getUint8(o)!==0;)o++;for(o++,o+=4;o<c&&i.getUint8(o)!==0;)o++;o++;const h=i.getUint32(o,!0);o+=4;for(let g=0;g<h;g++)o+=4}}n.pixDims[1]=i.getFloat32(o+2,!0),n.pixDims[2]=i.getFloat32(o+6,!0),n.pixDims[3]=i.getFloat32(o+10,!0)}return Z.warn("Warning: VMR spatial transform not implemented"),n.affine=[[0,0,-n.pixDims[1],(n.dims[1]-2)*.5*n.pixDims[1]],[-n.pixDims[2],0,0,(n.dims[2]-2)*.5*n.pixDims[2]],[0,-n.pixDims[3],0,(n.dims[3]-2)*.5*n.pixDims[3]],[0,0,0,1]],Z.debug(n),n.numBitsPerVoxel=8,n.datatypeCode=2,e.slice(8,8+s)}async readFIB(e){this.hdr=new Fe;const n=this.hdr;n.littleEndian=!1,n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=await qe.readMatV4(e,!0);if(!("dimension"in i)||!("dti_fa"in i))throw new Error("Not a valid DSIstudio FIB file");const a="index0"in i&&"index1"in i&&"index2"in i&&"odf_vertices"in i;n.numBitsPerVoxel=32,n.datatypeCode=16,n.dims[1]=i.dimension[0],n.dims[2]=i.dimension[1],n.dims[3]=i.dimension[2],n.dims[4]=1,n.pixDims[1]=i.voxel_size[0],n.pixDims[2]=i.voxel_size[1],n.pixDims[3]=i.voxel_size[2],n.sform_code=1;const s=(n.dims[1]-1)*.5*n.pixDims[1],o=(n.dims[2]-1)*.5*n.pixDims[2],l=(n.dims[3]-1)*.5*n.pixDims[3];n.affine=[[n.pixDims[1],0,0,-s],[0,-n.pixDims[2],0,o],[0,0,n.pixDims[2],-l],[0,0,0,1]],n.littleEndian=!0;const c=n.dims[1]*n.dims[2]*n.dims[3],u=c*Math.ceil(n.numBitsPerVoxel/8),h=u*n.dims[4],g=new Uint8Array(new ArrayBuffer(c*4*3));if(a){const b=n.dims[1]*n.dims[2]*n.dims[3],x=new Float32Array(b),A=new Float32Array(b),C=new Float32Array(b),E=i.index0,S=i.odf_vertices;for(let M=0;M<b;M++){const R=E[M]*3;x[M]=S[R+0],A[M]=S[R+1],C[M]=-S[R+2]}g.set(new Uint8Array(x.buffer,x.byteOffset,x.byteLength),0*u),g.set(new Uint8Array(A.buffer,A.byteOffset,A.byteLength),1*u),g.set(new Uint8Array(C.buffer,C.byteOffset,C.byteLength),2*u)}"report"in i&&(n.description=new TextDecoder().decode(i.report.subarray(0,Math.min(79,i.report.byteLength))));const v=new Uint8Array(new ArrayBuffer(h)),m=Float32Array.from(i.dti_fa);if("mask"in i){let b=1;"dti_fa_slope"in i&&(b=i.dti_fa_slope[0]);let x=1;"dti_fa_inter"in i&&(x=i.dti_fa_inter[0]);const A=n.dims[1]*n.dims[2]*n.dims[3],C=i.mask,E=new Float32Array(A);let S=0;for(let M=0;M<A;M++)C[M]!==0&&(E[M]=m[S]*b+x,S++);return[E.buffer,new Float32Array(g.buffer)]}const y=new Uint8Array(m.buffer,m.byteOffset,m.byteLength);return v.set(y,0),[v.buffer,new Float32Array(g.buffer)]}async readSRC(e){this.hdr=new Fe;const n=this.hdr;n.littleEndian=!1,n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=await qe.readMatV4(e);if(!("dimension"in i)||!("image0"in i))throw new Error("Not a valid DSIstudio SRC file");let a=0,s=0;for(const[m,y]of Object.entries(i))if(m.startsWith("image")){if(a===0?s=y.length:s!==y.length&&(s=-1),y.constructor!==Uint16Array)throw new Error("DSIstudio SRC files always use Uint16 datatype");a++}if(s<1||a<1)throw new Error("SRC file not valid DSI Studio data. The image(s) should have the same length");n.numBitsPerVoxel=16,n.datatypeCode=512,n.dims[1]=i.dimension[0],n.dims[2]=i.dimension[1],n.dims[3]=i.dimension[2],n.dims[4]=a,n.dims[4]>1&&(n.dims[0]=4),n.pixDims[1]=i.voxel_size[0],n.pixDims[2]=i.voxel_size[1],n.pixDims[3]=i.voxel_size[2],n.sform_code=1;const o=(n.dims[1]-1)*.5*n.pixDims[1],l=(n.dims[2]-1)*.5*n.pixDims[2],c=(n.dims[3]-1)*.5*n.pixDims[3];n.affine=[[n.pixDims[1],0,0,-o],[0,-n.pixDims[2],0,l],[0,0,n.pixDims[2],-c],[0,0,0,1]],n.littleEndian=!0;const u=n.dims[1]*n.dims[2]*n.dims[3]*(n.numBitsPerVoxel/8),h=u*n.dims[4],g=new Uint8Array(new ArrayBuffer(h));let v=0;for(let m=0;m<a;m++){const y=i[`image${m}`],b=new Uint8Array(y.buffer,y.byteOffset,y.byteLength);g.set(b,v),v+=u}return"report"in i&&(n.description=new TextDecoder().decode(i.report.subarray(0,Math.min(79,i.report.byteLength)))),g.buffer}async readHEAD(e,n){this.hdr=new Fe;const i=this.hdr;i.dims[0]=3,i.pixDims=[1,1,1,1,1,0,0,0];let a=[0,0,0],s=[0,0,0],o=[1,1,1];const c=new TextDecoder().decode(e).split(/\r?\n/),u=(e.byteLength+8)%16,h=e.byteLength+(16-u);Z.debug(e.byteLength,"len",h);const g=new ArrayBuffer(h);new Uint8Array(g).set(new Uint8Array(e));const v=new AT(h+8,42,g,!0);i.addExtension(v),i.extensionCode=42,i.extensionFlag[0]=1,i.extensionSize=h+8;const m=c.length;let y=0,b=!1;for(;y<m;){let A=c[y];if(y++,!A.startsWith("type"))continue;const C=A.includes("integer-attribute"),E=A.includes("float-attribute");if(A=c[y],y++,!A.startsWith("name"))continue;let S=A.split("= ");const M=S[1];A=c[y],y++,S=A.split("= ");let R=parseInt(S[1]);if(!(R<1)){if(A=c[y],y++,S=A.trim().split(/\s+/),E||C){for(;S.length<R;){A=c[y],y++;const T=A.trim().split(/\s+/);S.push(...T)}for(let T=0;T<R;T++)S[T]=parseFloat(S[T])}switch(M){case"BYTEORDER_STRING":S[0].includes("LSB_FIRST")?i.littleEndian=!0:S[0].includes("MSB_FIRST")&&(i.littleEndian=!1);break;case"BRICK_TYPES":{i.dims[4]=R;const T=parseInt(S[0]);T===0?(i.numBitsPerVoxel=8,i.datatypeCode=2):T===1?(i.numBitsPerVoxel=16,i.datatypeCode=4):T===3?(i.numBitsPerVoxel=32,i.datatypeCode=16):Z.warn("Unknown BRICK_TYPES ",T)}break;case"IJK_TO_DICOM_REAL":if(R<12)break;b=!0,i.sform_code=2,i.affine=[[-S[0],-S[1],-S[2],-S[3]],[-S[4],-S[5],-S[6],-S[7]],[S[8],S[9],S[10],S[11]],[0,0,0,1]];break;case"DATASET_DIMENSIONS":R=Math.max(R,3);for(let T=0;T<R;T++)i.dims[T+1]=S[T];break;case"ORIENT_SPECIFIC":a=S;break;case"ORIGIN":s=S;break;case"DELTA":o=S;break;case"TAXIS_FLOATS":i.pixDims[4]=S[0];break;default:Z.warn("Unknown:",M)}}}b?this.SetPixDimFromSForm():this.THD_daxes_to_NIFTI(o,s,a);const x=i.numBitsPerVoxel/8*i.dims[1]*i.dims[2]*i.dims[3]*i.dims[4];if(!n)throw new Error("pairedImgData not set");return n.byteLength<x?await qe.decompressToBuffer(new Uint8Array(n)):n.slice(0)}async readMHA(e,n){const i=e.byteLength;if(i<20)throw new Error("File too small to be VTK: bytes = "+e.byteLength);const a=new Uint8Array(e);let s=0;function o(b){return b===10||b===13}function l(){for(;s<i&&o(a[s]);)s++;const b=s;for(;s<i&&!o(a[s]);)s++;return s-b<2?"":new TextDecoder().decode(e.slice(b,s))}let c=l();this.hdr=new Fe;const u=this.hdr;u.pixDims=[1,1,1,1,1,0,0,0],u.dims=[1,1,1,1,1,1,1,1],u.littleEndian=!0;let h=!1,g=!1;const v=mo(NaN,0,0,0,1,0,0,0,1),m=Me(0,0,0);for(;c!=="";){let b=c.split(" ");if(b.length>2&&(b=b.slice(2)),c.startsWith("BinaryDataByteOrderMSB")&&b[0].includes("False")&&(u.littleEndian=!0),c.startsWith("BinaryDataByteOrderMSB")&&b[0].includes("True")&&(u.littleEndian=!1),c.startsWith("CompressedData")&&b[0].includes("True")&&(h=!0),c.startsWith("TransformMatrix"))for(let x=0;x<9;x++)v[x]=parseFloat(b[x]);if(c.startsWith("Offset"))for(let x=0;x<Math.min(b.length,3);x++)m[x]=parseFloat(b[x]);if(c.startsWith("ElementSpacing"))for(let x=0;x<b.length;x++)u.pixDims[x+1]=parseFloat(b[x]);if(c.startsWith("DimSize")){u.dims[0]=b.length;for(let x=0;x<b.length;x++)u.dims[x+1]=parseInt(b[x])}if(c.startsWith("ElementType"))switch(b[0]){case"MET_UCHAR":u.numBitsPerVoxel=8,u.datatypeCode=2;break;case"MET_CHAR":u.numBitsPerVoxel=8,u.datatypeCode=256;break;case"MET_SHORT":u.numBitsPerVoxel=16,u.datatypeCode=4;break;case"MET_USHORT":u.numBitsPerVoxel=16,u.datatypeCode=512;break;case"MET_INT":u.numBitsPerVoxel=32,u.datatypeCode=8;break;case"MET_UINT":u.numBitsPerVoxel=32,u.datatypeCode=768;break;case"MET_FLOAT":u.numBitsPerVoxel=32,u.datatypeCode=16;break;case"MET_DOUBLE":u.numBitsPerVoxel=64,u.datatypeCode=64;break;default:throw new Error("Unsupported MHA data type: "+b[0])}if(c.startsWith("ObjectType")&&!b[0].includes("Image")&&Z.warn("Only able to read ObjectType = Image, not "+c),c.startsWith("ElementDataFile")){b[0]!=="LOCAL"&&(g=!0);break}c=l()}const y=mo(u.pixDims[1],0,0,0,u.pixDims[2],0,0,0,u.pixDims[3]);for(aT(v,v,y),u.affine=[[-v[0],-v[3],-v[6],-m[0]],[-v[1],-v[4],-v[7],-m[1]],[v[2],v[5],v[8],m[2]],[0,0,0,1]];a[s]===10;)s++;return u.vox_offset=s,g&&n?h?await qe.decompressToBuffer(new Uint8Array(n.slice(0))):n.slice(0):h?await qe.decompressToBuffer(new Uint8Array(e.slice(u.vox_offset))):e.slice(u.vox_offset)}async readMIF(e,n){this.hdr=new Fe;const i=this.hdr;i.pixDims=[1,1,1,1,1,0,0,0],i.dims=[1,1,1,1,1,1,1,1];let a=e.byteLength;if(a<20)throw new Error("File too small to be MIF: bytes = "+a);let s=new Uint8Array(e);s[0]===31&&s[1]===139&&(Z.debug("MIF with GZ decompression"),e=await qe.decompressToBuffer(new Uint8Array(e)),a=e.byteLength,s=new Uint8Array(e));let o=0;function l(){for(;o<a&&s[o]===10;)o++;const k=o;for(;o<a&&s[o]!==10;)o++;return o++,o-k<1?"":new TextDecoder().decode(e.slice(k,o-1))}let c=l();if(!c.startsWith("mrtrix image"))throw new Error("Not a valid MIF file");const u=[];let h=!1,g=0,v=0,m=!1;for(c=l();o<a&&!c.startsWith("END");){let k=c.split(":");if(c=l(),k.length<2)break;const O=k[0];k=k[1].split(",");for(let V=0;V<k.length;V++)k[V]=k[V].trim();switch(O){case"dim":i.dims[0]=k.length;for(let V=0;V<k.length;V++)i.dims[V+1]=parseInt(k[V]);break;case"vox":for(let V=0;V<k.length;V++)i.pixDims[V+1]=parseFloat(k[V]),isNaN(i.pixDims[V+1])&&(i.pixDims[V+1]=0);break;case"layout":for(let V=0;V<k.length;V++)u.push(parseInt(k[V]));break;case"datatype":{const V=k[0];V.startsWith("Bit")?(h=!0,i.datatypeCode=2):V.startsWith("Int8")?i.datatypeCode=256:V.startsWith("UInt8")?i.datatypeCode=2:V.startsWith("Int16")?i.datatypeCode=4:V.startsWith("UInt16")?i.datatypeCode=512:V.startsWith("Int32")?i.datatypeCode=8:V.startsWith("UInt32")?i.datatypeCode=768:V.startsWith("Float32")?i.datatypeCode=16:V.startsWith("Float64")?i.datatypeCode=64:Z.warn("Unsupported datatype "+V),V.includes("8")?i.numBitsPerVoxel=8:V.includes("16")?i.numBitsPerVoxel=16:V.includes("32")?i.numBitsPerVoxel=32:V.includes("64")&&(i.numBitsPerVoxel=64),i.littleEndian=!0,V.endsWith("LE")&&(i.littleEndian=!0),V.endsWith("BE")&&(i.littleEndian=!1)}break;case"transform":if(g>2||k.length!==4)break;i.affine[g][0]=parseFloat(k[0]),i.affine[g][1]=parseFloat(k[1]),i.affine[g][2]=parseFloat(k[2]),i.affine[g][3]=parseFloat(k[3]),g++;break;case"comments":i.description=k[0].substring(0,Math.min(79,k[0].length));break;case"RepetitionTime":v=parseFloat(k[0]);break;case"file":m=!k[0].startsWith(". "),m||(k=k[0].split(" "),i.vox_offset=parseInt(k[1]));break}}const y=i.dims[0];y>5&&Z.warn("reader only designed for a maximum of 5 dimensions (XYZTD)");let b=1;for(let k=0;k<y;k++)b*=Math.max(i.dims[k+1],1);for(let k=0;k<3;k++)for(let O=0;O<3;O++)i.affine[k][O]*=i.pixDims[O+1];Z.debug("mif affine:"+i.affine[0]),v>0&&(i.pixDims[4]=v),m&&!n&&Z.warn("MIH header provided without paired image data");let x;if(n&&m)x=n.slice(0);else if(h){i.numBitsPerVoxel=8;const k=new Uint8Array(b),O=e.slice(i.vox_offset,i.vox_offset+Math.ceil(b/8)),V=new Uint8Array(O);let L=0;for(let P=0;P<b;P++){const _=P%8;k[P]=V[L]>>7-_&1,_===7&&L++}x=k.buffer}else x=e.slice(i.vox_offset,i.vox_offset+b*(i.numBitsPerVoxel/8));u.length!==i.dims[0]&&Z.warn("dims does not match layout");let A=1;const C=[1,1,1,1,1],E=[!1,!1,!1,!1,!1];for(let k=0;k<u.length;k++)for(let O=0;O<u.length;O++)Math.abs(u[O])===k&&(C[O]=A,(u[O]<0||Object.is(u[O],-0))&&(E[O]=!0),A*=i.dims[O+1]);let S=qe.range(0,i.dims[1]-1,1);E[0]&&(S=qe.range(i.dims[1]-1,0,-1));for(let k=0;k<i.dims[1];k++)S[k]*=C[0];let M=qe.range(0,i.dims[2]-1,1);E[1]&&(M=qe.range(i.dims[2]-1,0,-1));for(let k=0;k<i.dims[2];k++)M[k]*=C[1];let R=qe.range(0,i.dims[3]-1,1);E[2]&&(R=qe.range(i.dims[3]-1,0,-1));for(let k=0;k<i.dims[3];k++)R[k]*=C[2];let T=qe.range(0,i.dims[4]-1,1);E[3]&&(T=qe.range(i.dims[4]-1,0,-1));for(let k=0;k<i.dims[4];k++)T[k]*=C[3];let B=qe.range(0,i.dims[5]-1,1);E[4]&&(B=qe.range(i.dims[5]-1,0,-1));for(let k=0;k<i.dims[5];k++)B[k]*=C[4];let F=0,I,U;switch(i.datatypeCode){case 256:I=new Int8Array(x),U=new Int8Array(b);break;case 2:I=new Uint8Array(x),U=new Uint8Array(b);break;case 4:I=new Int16Array(x),U=new Int16Array(b);break;case 512:I=new Uint16Array(x),U=new Uint16Array(b);break;case 8:I=new Int32Array(x),U=new Int32Array(b);break;case 768:I=new Uint32Array(x),U=new Uint32Array(b);break;case 16:I=new Float32Array(x),U=new Float32Array(b);break;case 64:I=new Float64Array(x),U=new Float64Array(b);break;default:throw new Error("unknown datatypeCode")}for(let k=0;k<i.dims[5];k++)for(let O=0;O<i.dims[4];O++)for(let V=0;V<i.dims[3];V++)for(let L=0;L<i.dims[2];L++)for(let P=0;P<i.dims[1];P++)U[F]=I[S[P]+M[L]+R[V]+T[O]+B[k]],F++;return U.buffer}calculateRAS(){if(!this.hdr)throw new Error("hdr not set");const e=this.hdr.affine,n=this.hdr,i=mo(Math.abs(e[0][0]),Math.abs(e[0][1]),Math.abs(e[0][2]),Math.abs(e[1][0]),Math.abs(e[1][1]),Math.abs(e[1][2]),Math.abs(e[2][0]),Math.abs(e[2][1]),Math.abs(e[2][2])),a=[1,1,1];i[3]>i[0]&&(a[0]=2),i[6]>i[0]&&i[6]>i[3]&&(a[0]=3),a[1]=1,a[0]===1?i[4]>i[7]?a[1]=2:a[1]=3:a[0]===2?i[1]>i[7]?a[1]=1:a[1]=3:i[1]>i[4]?a[1]=1:a[1]=2,a[2]=6-a[1]-a[0];let s=[1,2,3];s[a[0]-1]=1,s[a[1]-1]=2,s[a[2]-1]=3;let o=Wn(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],0,0,0,1);this.mm000=this.vox2mm([-.5,-.5,-.5],o),this.mm100=this.vox2mm([n.dims[1]-.5,-.5,-.5],o),this.mm010=this.vox2mm([-.5,n.dims[2]-.5,-.5],o),this.mm001=this.vox2mm([-.5,-.5,n.dims[3]-.5],o);const l=bt();X_(l,o);for(let x=0;x<3;x++)for(let A=0;A<3;A++)l[x*4+A]=o[x*4+s[A]-1];const c=[0,0,0];l[0]<0&&(c[0]=1),l[5]<0&&(c[1]=1),l[10]<0&&(c[2]=1),this.dimsRAS=[n.dims[0],n.dims[s[0]],n.dims[s[1]],n.dims[s[2]]],this.pixDimsRAS=[n.pixDims[0],n.pixDims[s[0]],n.pixDims[s[1]],n.pixDims[s[2]]],this.permRAS=s.slice();for(let x=0;x<3;x++)c[x]===1&&(this.permRAS[x]=-this.permRAS[x]);if(this.arrayEquals(s,[1,2,3])&&this.arrayEquals(c,[0,0,0])){this.toRAS=bt(),this.matRAS=Er(o),this.calculateOblique(),this.img2RASstep=[1,this.dimsRAS[1],this.dimsRAS[1]*this.dimsRAS[2]],this.img2RASstart=[0,0,0];return}sT(o),o[0]=1-c[0]*2,o[5]=1-c[1]*2,o[10]=1-c[2]*2,o[3]=(n.dims[s[0]]-1)*c[0],o[7]=(n.dims[s[1]]-1)*c[1],o[11]=(n.dims[s[2]]-1)*c[2];const u=bt();kn(u,o),ys(u,u,l),this.matRAS=Er(u),o=Wn(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1),o[s[0]-1+0]=-c[0]*2+1,o[s[1]-1+4]=-c[1]*2+1,o[s[2]-1+8]=-c[2]*2+1,o[3]=c[0],o[7]=c[1],o[11]=c[2],this.toRAS=Er(o),o[3]=0,o[7]=0,o[11]=0,o[12]=0,(this.permRAS[0]===-1||this.permRAS[1]===-1||this.permRAS[2]===-1)&&(o[12]=n.dims[1]-1),o[13]=0,(this.permRAS[0]===-2||this.permRAS[1]===-2||this.permRAS[2]===-2)&&(o[13]=n.dims[2]-1),o[14]=0,(this.permRAS[0]===-3||this.permRAS[1]===-3||this.permRAS[2]===-3)&&(o[14]=n.dims[3]-1),this.toRASvox=Er(o),Z.debug(this.hdr.dims),Z.debug(this.dimsRAS);const h=this.hdr;s=this.permRAS;const g=[Math.abs(s[0]),Math.abs(s[1]),Math.abs(s[2])],v=[h.dims[g[0]],h.dims[g[1]],h.dims[g[2]]],m=[1,h.dims[1],h.dims[1]*h.dims[2]],y=[m[g[0]-1],m[g[1]-1],m[g[2]-1]],b=[0,0,0];for(let x=0;x<3;x++)s[x]<0&&(b[x]=y[x]*(v[x]-1),y[x]=-y[x]);this.img2RASstep=y,this.img2RASstart=b,this.calculateOblique()}async hdr2RAS(e=1){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.hdr)throw new Error("hdr undefined");const n=x0({...this.hdr,vox_offset:352},!1),i=await wc(n.buffer,!0);e===1?(i.dims[0]=3,i.dims[4]=1):e>1&&(i.dims[0]=4,i.dims[4]=e);const a=this.permRAS.slice();if(a[0]===1&&a[1]===2&&a[2]===3)return i;i.qform_code=0;for(let o=1;o<4;o++)i.dims[o]=this.dimsRAS[o];for(let o=0;o<this.pixDimsRAS.length;o++)i.pixDims[o]=this.pixDimsRAS[o];let s=0;for(let o=0;o<4;o++)for(let l=0;l<4;l++)i.affine[o][l]=this.matRAS[s],s++;return i}img2RAS(e=0){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.img)throw new Error("img undefined");if(!this.hdr)throw new Error("hdr undefined");const n=this.permRAS.slice();if(n[0]===1&&n[1]===2&&n[2]===3)return this.img;const i=this.hdr,a=i.dims[1]*i.dims[2]*i.dims[3];let s=e*a;(s+a>this.img.length||s<0)&&(s=0,Z.warn(`img2RAS nVolume (${e}) out of bounds (${e}+1)×${a} > ${this.img.length}`));const o=this.img.slice(0,a),l=[Math.abs(n[0]),Math.abs(n[1]),Math.abs(n[2])],c=[i.dims[l[0]],i.dims[l[1]],i.dims[l[2]]],u=[1,i.dims[1],i.dims[1]*i.dims[2]],h=[u[l[0]-1],u[l[1]-1],u[l[2]-1]],g=[0,0,0];for(let m=0;m<3;m++)n[m]<0&&(g[m]=h[m]*(c[m]-1),h[m]=-h[m]);let v=0;for(let m=0;m<c[2];m++){const y=g[2]+m*h[2];for(let b=0;b<c[1];b++){const x=g[1]+b*h[1];for(let A=0;A<c[0];A++){const C=g[0]+A*h[0];o[v]=this.img[C+x+y+s],v++}}}return o}vox2mm(e,n){const i=Er(n);Zn(i,i);const a=Jt(e[0],e[1],e[2],1);return Kr(a,a,i),Me(a[0],a[1],a[2])}mm2vox(e,n=!1){if(!this.matRAS)throw new Error("matRAS undefined");const i=Er(this.matRAS),a=Er(i);Zn(a,i),kn(a,a);const s=Jt(e[0],e[1],e[2],1);Kr(s,s,a);const o=Me(s[0],s[1],s[2]);return n?o:[Math.round(o[0]),Math.round(o[1]),Math.round(o[2])]}arrayEquals(e,n){return Array.isArray(e)&&Array.isArray(n)&&e.length===n.length&&e.every((i,a)=>i===n[a])}setColormap(e){this._colormap=e,this.calMinMax(),this.onColormapChange&&this.onColormapChange(this)}setColormapLabel(e){this.colormapLabel=Vt.makeLabelLut(e)}async setColormapLabelFromUrl(e){this.colormapLabel=await Vt.makeLabelLutFromUrl(e)}get colormap(){return this._colormap}get colorMap(){return this._colormap}set colormap(e){this.setColormap(e)}set colorMap(e){this.setColormap(e)}get opacity(){return this._opacity}set opacity(e){this._opacity=e,this.onOpacityChange&&this.onOpacityChange(this)}calMinMax(e=Number.POSITIVE_INFINITY,n=!0){if(!this.hdr)throw new Error("hdr undefined");if(!this.img)throw new Error("img undefined");let i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=0,o=0,l=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const c=Math.floor(this.img.length/l);e>=c&&(e=this.frame4D),e=Math.min(e,c-1);const u=e*l;let h=[];if(n){const O=[Math.floor(.25*this.hdr.dims[1]),Math.floor(.25*this.hdr.dims[2]),Math.floor(.25*this.hdr.dims[3])],V=[this.hdr.dims[1]-2*O[0],this.hdr.dims[2]-2*O[1],this.hdr.dims[3]-2*O[2]],L=[V[0]+O[0],V[1]+O[1],V[2]+O[2]];l=V[0]*V[1]*V[2],h=new this.img.constructor(l);let P=-1,_=0;for(let q=0;q<this.hdr.dims[3];q++)for(let H=0;H<this.hdr.dims[2];H++)for(let W=0;W<this.hdr.dims[1];W++)P++,!(W<O[0]||H<O[1]||q<O[2])&&(W>=L[0]||H>=L[1]||q>=L[2]||(h[_]=this.img[P+u],_++))}else{h=new this.img.constructor(l);for(let k=0;k<l;k++)h[k]=this.img[k+u]}const g=h.constructor!==Float64Array&&h.constructor!==Float32Array&&this.ignoreZeroVoxels;if(g)for(let k=0;k<l;k++)i=Math.min(h[k],i),a=Math.max(h[k],a),h[k]===0&&s++;else for(let k=0;k<l;k++){if(isNaN(h[k])){o++;continue}h[k]===0&&(s++,this.ignoreZeroVoxels)||(i=Math.min(h[k],i),a=Math.max(h[k],a))}this.ignoreZeroVoxels&&i===a&&s>0&&(i=0);const v=this.intensityRaw2Scaled(i),m=this.intensityRaw2Scaled(a),y=Vt.colormapFromKey(this._colormap);let b=0,x=0;if(y.min!==void 0&&(b=y.min),y.max!==void 0&&(x=y.max),b===x&&this.trustCalMinMax&&isFinite(this.hdr.cal_min)&&isFinite(this.hdr.cal_max)&&this.hdr.cal_max>this.hdr.cal_min)return this.cal_min=this.hdr.cal_min,this.cal_max=this.hdr.cal_max,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=v,this.global_max=m,[this.hdr.cal_min,this.hdr.cal_max,this.hdr.cal_min,this.hdr.cal_max];if(b!==x)return this.cal_min=b,this.cal_max=x,this.robust_min=this.cal_min,this.robust_max=this.cal_max,[b,x,b,x];const A=100*s/(l-0);let C=!1;A>60&&!this.ignoreZeroVoxels&&(Z.warn(`${Math.round(A)}% of voxels are zero: ignoring zeros for cal_max`),C=!0,this.ignoreZeroVoxels=!0),this.ignoreZeroVoxels||(s=0),s+=o;const E=Math.round((l-0-s)*this.percentileFrac);if(E<1||i===a)return n?this.calMinMax(e,!1):(Z.debug("no variability in image intensity?"),this.cal_min=v,this.cal_max=m,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=v,this.global_max=m,[v,m,v,m]);const S=1001,M=(S-1)/(a-i),R=new Array(S);for(let k=0;k<S;k++)R[k]=0;if(g)for(let k=0;k<l;k++)R[Math.round((h[k]-i)*M)]++;else if(this.ignoreZeroVoxels)for(let k=0;k<l;k++)h[k]!==0&&(isNaN(h[k])||R[Math.round((h[k]-i)*M)]++);else for(let k=0;k<l;k++)isNaN(h[k])||R[Math.round((h[k]-i)*M)]++;let T=0,B=0;for(;T<E;)T+=R[B],B++;B--,T=0;let F=S;for(;T<E;)F--,T+=R[F];if(B===F){let k=-1;for(;k!==0;)B>0&&(B--,R[B]>0&&(k=0)),k!==0&&F<S-1&&(F++,R[F]>0&&(k=0)),B===0&&F===S-1&&(k=0)}let I=this.intensityRaw2Scaled(B/M+i),U=this.intensityRaw2Scaled(F/M+i);return this.hdr.cal_min<this.hdr.cal_max&&this.hdr.cal_min>=v&&this.hdr.cal_max<=m&&(I=this.hdr.cal_min,U=this.hdr.cal_max),C&&(I=Math.min(I,0)),this.cal_min=I,this.cal_max=U,this.hdr.intent_code===1002&&(this.cal_min=v,this.cal_max=m),this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=v,this.global_max=m,[I,U,v,m]}intensityRaw2Scaled(e){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),e*this.hdr.scl_slope+this.hdr.scl_inter}intensityScaled2Raw(e){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),(e-this.hdr.scl_inter)/this.hdr.scl_slope}async saveToUint8Array(e,n=null){return UT(this,e,n)}async saveToDisk(e="",n=null){return oY(this,e,n)}static async fetchDicomData(e,n={}){if(e==="")throw Error("url must not be empty");let a=/^(?:[a-z+]+:)?\/\//i.test(e)?e:new URL(e,window.location.href);/(?:.([^.]+))?$/.exec(a.pathname)||(a=new URL("niivue-manifest.txt",e));let l=await fetch(a,{headers:n});if(!l.ok)throw Error(l.statusText);const u=(await l.text()).split(`
`),g=/(.*\/).*/.exec(a)[0],v=[];for(const m of u){const y=new URL(m,g);if(l=await fetch(y,{headers:n}),!l.ok)throw Error(l.statusText);const b=await l.arrayBuffer();v.push({name:m,data:b})}return v}static async readFirstDecompressedBytes(e,n){const i=e.getReader(),a=new Bz,s=[];let o=0,l=!1,c,u;const h=new Promise((v,m)=>{c=v,u=m});function g(){const v=new Uint8Array(o);let m=0;for(const y of s)v.set(y,m),m+=y.length;c(v)}return a.ondata=v=>{s.push(v),o+=v.length,o>=n&&(l=!0,i.cancel().catch(()=>{}),g())},(async()=>{try{for(;!l;){const{done:v,value:m}=await i.read();if(v){l=!0,a.push(new Uint8Array,!0);return}a.push(m,!1)}}catch(v){u(v)}})().catch(()=>{}),h}static extractFilenameFromUrl(e){const i=new URL(e).searchParams.get("response-content-disposition");if(i){const a=i.match(/filename\*?=(?:UTF-8'')?"?([^";]+)"?/);if(a)return decodeURIComponent(a[1])}return e.split("/").pop().split("?")[0]}static async loadInitialVolumesGz(e="",n={},i=NaN){if(isNaN(i))return null;const a=await fetch(e,{headers:n,cache:"force-cache"});let s=352,o=await this.readFirstDecompressedBytes(a.body,s);const l=new DataView(o.buffer,o.byteOffset,o.byteLength),c=l.getUint16(0,!0),u=c===348;if(!u&&!(c===23553)||(o.length>111&&(s=l.getFloat32(108,u)),s>o.length&&(o=await this.readFirstDecompressedBytes(a.body,s)),!(o[0]===92&&o[1]===1||o[1]===92&&o[0]===1)))return null;const v=await wc(o.buffer);if(!v)throw new Error("Could not read NIfTI header");const m=v.numBitsPerVoxel/8,y=[1,2,3].reduce((S,M)=>S*(v.dims[M]>1?v.dims[M]:1),1),b=[4,5,6].reduce((S,M)=>S*(v.dims[M]>1?v.dims[M]:1),1),x=Math.max(Math.min(i,b),1),A=v.vox_offset+x*y*m;if(x===b)return null;const C=await fetch(e,{headers:n,cache:"force-cache"});return(await this.readFirstDecompressedBytes(C.body,A)).buffer.slice(0,A)}static async loadInitialVolumes(e="",n={},i=NaN){if(isNaN(i))return null;const s=(await fetch(e,{headers:n,cache:"force-cache"})).body.getReader(),{value:o,done:l}=await s.read();let c=o;if(l||!c||c.length<2)throw new Error("Not enough data to determine compression");const u=new DataView(c.buffer,c.byteOffset,c.byteLength),h=u.getUint16(0,!0);if(h===35615)return await s.cancel(),this.loadInitialVolumesGz(e,n,i);const v=h===348;if(!v&&!(h===23553))return await s.cancel(),null;let y=352;for(c.length>111&&(y=u.getFloat32(108,v));c.length<y;){let B=function(U,k){const O=new Uint8Array(U.length+k.length);return O.set(U,0),O.set(k,U.length),O};const{value:F,done:I}=await s.read();if(I||!F)break;c=B(c,F)}const b=await wc(c.buffer);if(!b)throw new Error("Could not read NIfTI header");const x=b.numBitsPerVoxel/8,A=[1,2,3].reduce((B,F)=>B*(b.dims[F]>1?b.dims[F]:1),1),C=[4,5,6].reduce((B,F)=>B*(b.dims[F]>1?b.dims[F]:1),1),E=Math.max(Math.min(i,C),1),S=b.vox_offset+E*A*x,M=new Uint8Array(S),R=Math.min(c.length,S);M.set(c.subarray(0,R),0);let T=R;for(;T<S;){const{value:B,done:F}=await s.read();if(F||!B)return await s.cancel(),null;const I=Math.min(B.length,S-T);M.set(B.subarray(0,I),T),T+=I}return await s.cancel(),M.buffer}static async loadFromUrl({url:e="",urlImgData:n="",headers:i={},name:a="",colormap:s="",opacity:o=1,cal_min:l=NaN,cal_max:c=NaN,trustCalMinMax:u=!0,percentileFrac:h=.02,ignoreZeroVoxels:g=!1,useQFormNotSForm:v=!1,colormapNegative:m="",frame4D:y=0,isManifest:b=!1,limitFrames4D:x=NaN,imageType:A=ut.UNKNOWN,colorbarVisible:C=!0,buffer:E=new ArrayBuffer(0)}={}){if(e==="")throw Error("url must not be empty");let S=null,M=null,R=null;if(e instanceof Uint8Array&&(e=e.slice().buffer),E.byteLength>0&&(e=E),e instanceof ArrayBuffer)if(M=e,a!=="")e=a;else{const U=new Uint8Array(M);e=U[0]===31&&U[1]===139?"array.nii.gz":"array.nii"}function T(U){const k=U.match(/\.([^.]+)(?:\.gz|\.bz2|\.xz)?$/);return k?k[1]:""}let B="";if(a===""?B=T(e):B=T(a),A===ut.UNKNOWN&&(A=ut.parse(B)),A===ut.UNKNOWN&&typeof e=="string"){const U=await fetch(e,{});if(U.redirected){const k=this.extractFilenameFromUrl(U.url);k&&k.length>0&&a===""&&(a=k,B=T(a),A=ut.parse(B))}}if(A===ut.ZARR){const U=new URL(e).searchParams,k=U.get("z"),O=U.get("y"),V=U.get("x"),L=k?kc(parseInt(k),parseInt(k)+1):null,P=O?kc(parseInt(O),parseInt(O)+1):null,_=V?kc(parseInt(V),parseInt(V)+1):null,q=e.split("?")[0],H=new jz(q),W=fG(H);let G;try{G=await Cs(W.resolve(e),{kind:"array"})}catch{G=await Cs(W,{kind:"array"})}let K;if(G.shape.length===4){const ve=G.shape[2],le=G.shape[1],ie=G.shape[0];L&&L[0]>=ve&&(L[0]=ve-1),P&&P[0]>=le&&(P[0]=le-1),_&&_[0]>=ie&&(_[0]=ie-1),K=await NC(G,[_,P,L,null])}else K=await NC(G,[_,P,L]);M=K.data;const[$,te,ae,ue]=K.shape;R={data:M,width:te,height:$,depth:ae,channels:ue}}const F=A===ut.DCM||ut.NII;if(!M&&F&&(M=await this.loadInitialVolumes(e,i,x)),!M)if(b)M=await jd.fetchDicomData(e,i),A=ut.DCM_MANIFEST;else{const U=await fetch(e,{headers:i});if(!U.ok)throw Error(U.statusText);if(!U.body)throw new Error("No readable stream available");const k=await op(U.body),O=[],V=k.getReader();for(;;){const{done:q,value:H}=await V.read();if(q)break;O.push(H)}const L=O.reduce((q,H)=>q+H.length,0);M=new ArrayBuffer(L);const P=new Uint8Array(M);let _=0;for(const q of O)P.set(q,_),_+=q.length}B.toUpperCase()==="HEAD"&&n===""&&(n=e.substring(0,e.lastIndexOf("HEAD"))+"BRIK");let I=null;if(n)try{let U=await fetch(n,{headers:i});if(U.status===404&&n.includes("BRIK")&&(U=await fetch(`${n}.gz`,{headers:i})),U.ok&&U.body){const k=await op(U.body),O=[],V=k.getReader();for(;;){const{done:q,value:H}=await V.read();if(q)break;O.push(H)}const L=O.reduce((q,H)=>q+H.length,0);I=new ArrayBuffer(L);const P=new Uint8Array(I);let _=0;for(const q of O)P.set(q,_),_+=q.length}}catch(U){console.error("Error loading paired image data:",U)}if(!M)throw new Error("Unable to load buffer properly from volume");if(!a){let U;try{U=new URL(e).pathname.split("/")}catch{U=e.split("/")}a=U.slice(-1)[0],a.indexOf("?")>-1&&(a=a.slice(0,a.indexOf("?")))}return S=await this.new(M,a,s,o,I,l,c,u,h,g,v,m,y,A,NaN,NaN,!0,null,0,R),S.url=e,S.colorbarVisible=C,S}static async readFileAsync(e,n=NaN){let i=e.stream();if(!isNaN(n)){let g=0;const v=new TransformStream({transform(m,y){if(g>=n){y.terminate();return}const b=n-g;m.length>b?(y.enqueue(m.slice(0,b)),y.terminate()):y.enqueue(m),g+=m.length}});i=i.pipeThrough(v)}const a=await op(i),s=[],o=a.getReader();for(;;){const{done:g,value:v}=await o.read();if(g)break;s.push(v)}const l=s.reduce((g,v)=>g+v.length,0),c=new ArrayBuffer(l),u=new Uint8Array(c);let h=0;for(const g of s)u.set(g,h),h+=g.length;return c}static async loadFromFile({file:e,name:n="",colormap:i="",opacity:a=1,urlImgData:s=null,cal_min:o=NaN,cal_max:l=NaN,trustCalMinMax:c=!0,percentileFrac:u=.02,ignoreZeroVoxels:h=!1,useQFormNotSForm:g=!1,colormapNegative:v="",frame4D:m=0,limitFrames4D:y=NaN,imageType:b=ut.UNKNOWN}){let x=null,A=[];try{if(Array.isArray(e))A=await Promise.all(e.map(E=>this.readFileAsync(E)));else{if(isNaN(y))A=await this.readFileAsync(e);else{const E=await this.readFileAsync(e,512),S=new Uint8Array(E);if(!(S[0]===92&&S[1]===1||S[1]===92&&S[0]===1))A=await this.readFileAsync(e);else{const R=await wc(E);if(!R)throw new Error("could not read nifti header");const T=R.numBitsPerVoxel/8,B=[1,2,3].reduce((k,O)=>k*(R.dims[O]>1?R.dims[O]:1),1),F=[4,5,6].reduce((k,O)=>k*(R.dims[O]>1?R.dims[O]:1),1),I=Math.max(Math.min(y,F),1),U=R.vox_offset+I*B*T;A=await this.readFileAsync(e,U)}}n=e.name}let C=null;s&&(C=await this.readFileAsync(s)),x=await this.new(A,n,i,a,C,o,l,c,u,h,g,v,m,b,NaN,NaN,!0,null,0,null),x.fileObject=e}catch(C){throw Z.error(C),new Error("could not build NVImage")}if(x===null)throw new Error("could not build NVImage");return x}static createNiftiArray(e=[256,256,256],n=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],a=2,s=new Uint8Array){return sY(e,n,i,a,s)}static createNiftiHeader(e=[256,256,256],n=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],a=2){return FT(e,n,i,a)}getVolumeData(e=[-1,0,0],n=[0,0,0],i="same"){return uY(this,e,n,i)}setVolumeData(e=[-1,0,0],n=[0,0,0],i=new Uint8Array){cY(this,e,n,i)}static async loadFromBase64({base64:e,name:n="",colormap:i="",opacity:a=1,cal_min:s=NaN,cal_max:o=NaN,trustCalMinMax:l=!0,percentileFrac:c=.02,ignoreZeroVoxels:u=!1,useQFormNotSForm:h=!1,colormapNegative:g="",frame4D:v=0,imageType:m=ut.UNKNOWN,cal_minNeg:y=NaN,cal_maxNeg:b=NaN,colorbarVisible:x=!0,colormapLabel:A=null}){function C(S){const M=window.atob(S),R=M.length,T=new Uint8Array(R);for(let B=0;B<R;B++)T[B]=M.charCodeAt(B);return T.buffer}let E=null;try{const S=C(e);E=await this.new(S,n,i,a,null,s,o,l,c,u,h,g,v,m,y,b,x,A,0,null)}catch(S){Z.debug(S)}if(E===null)throw new Error("could not load NVImage");return E}clone(){const e=new jd;return e.id=l2(),e.hdr=Object.assign({},this.hdr),e.img=this.img.slice(),e.calculateRAS(),e.calMinMax(),e}zeroImage(){this.img.fill(0)}getImageMetadata(){if(!this.hdr)throw new Error("hdr undefined");const e=this.id,n=this.hdr.datatypeCode,i=this.hdr.dims,a=i[1],s=i[2],o=i[3],l=Math.max(1,i[4]),c=this.hdr.pixDims,u=c[1],h=c[2],g=c[3],v=c[4],m=Math.floor(this.hdr.numBitsPerVoxel/8);return{id:e,datatypeCode:n,nx:a,ny:s,nz:o,nt:l,dx:u,dy:h,dz:g,dt:v,bpv:m}}static zerosLike(e,n="same"){const i=e.clone();return i.zeroImage(),n==="uint8"&&(i.img=Uint8Array.from(i.img),i.hdr.datatypeCode=2,i.hdr.numBitsPerVoxel=8),n==="float32"&&(i.img=Float32Array.from(i.img),i.hdr.datatypeCode=16,i.hdr.numBitsPerVoxel=32),i}getValue(e,n,i,a=0,s=!1){return lY(this,e,n,i,a,s)}getValues(e,n,i,a=0,s=!1){return VT(this,e,n,i,a,s)}applyOptionsUpdate(e){this.hdr.cal_min=e.cal_min,this.hdr.cal_max=e.cal_max,Object.assign(this,e)}getImageOptions(){return Yd("","",this.name,this._colormap,this.opacity,this.hdr.cal_min,this.hdr.cal_max,this.trustCalMinMax,this.percentileFrac,this.ignoreZeroVoxels,this.useQFormNotSForm,this.colormapNegative,this.frame4D,this.imageType,this.colormapType)}toUint8Array(e=null){return kT(this,e)}convertVox2Frac(e){return Me((e[0]+.5)/this.dimsRAS[1],(e[1]+.5)/this.dimsRAS[2],(e[2]+.5)/this.dimsRAS[3])}convertFrac2Vox(e){return Me(Math.round(e[0]*this.dims[1]-.5),Math.round(e[1]*this.dims[2]-.5),Math.round(e[2]*this.dims[3]-.5))}convertFrac2MM(e,n=!1){const i=Jt(e[0],e[1],e[2],1);return n?Kr(i,i,this.frac2mm):Kr(i,i,this.frac2mmOrtho),i}convertMM2Frac(e,n=!1){const i=Jt(e[0],e[1],e[2],1),a=this.dimsRAS,s=Me(0,0,0);if(typeof a>"u")return s;if(!n){const l=Er(this.frac2mmOrtho);return kn(l,l),Kr(i,i,l),s[0]=i[0],s[1]=i[1],s[2]=i[2],s}if(a[1]<1||a[2]<1||a[3]<1)return s;const o=Er(this.matRAS);return kn(o,o),Zn(o,o),Kr(i,i,o),s[0]=(i[0]+.5)/a[1],s[1]=(i[1]+.5)/a[2],s[2]=(i[2]+.5)/a[3],s}},GT=(r=>(r[r.none=0]="none",r[r.contrast=1]="contrast",r[r.measurement=2]="measurement",r[r.pan=3]="pan",r[r.slicer3D=4]="slicer3D",r[r.callbackOnly=5]="callbackOnly",r[r.roiSelection=6]="roiSelection",r[r.angle=7]="angle",r[r.crosshair=8]="crosshair",r[r.windowing=9]="windowing",r))(GT||{}),Di={textHeight:-1,fontSizeScaling:.4,fontMinPx:13,colorbarHeight:.05,colorbarWidth:-1,showColorbarBorder:!0,crosshairWidth:1,crosshairWidthUnit:"voxels",crosshairGap:0,rulerWidth:4,show3Dcrosshair:!1,backColor:[0,0,0,1],crosshairColor:[1,0,0,1],fontColor:[.5,.5,.5,1],selectionBoxColor:[1,1,1,.5],clipPlaneColor:[.7,0,.7,.5],paqdUniforms:[.3,.5,.5,1],clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1],rulerColor:[1,0,0,.8],colorbarMargin:.05,trustCalMinMax:!0,clipPlaneHotKey:"KeyC",viewModeHotKey:"KeyV",doubleTouchTimeout:500,longTouchTimeout:1e3,keyDebounceTime:50,isNearestInterpolation:!1,isResizeCanvas:!0,atlasOutline:0,atlasActiveIndex:0,isRuler:!1,isColorbar:!1,isOrientCube:!1,tileMargin:0,multiplanarPadPixels:0,multiplanarForceRender:!1,multiplanarEqualSize:!1,multiplanarShowRender:2,isRadiologicalConvention:!1,meshThicknessOn2D:1/0,dragMode:1,dragModePrimary:8,mouseEventConfig:void 0,touchEventConfig:void 0,yoke3Dto2DZoom:!1,isDepthPickMesh:!1,isCornerOrientationText:!1,isOrientationTextVisible:!0,showAllOrientationMarkers:!1,heroImageFraction:0,heroSliceType:4,sagittalNoseLeft:!1,isSliceMM:!1,isV1SliceShader:!1,forceDevicePixelRatio:0,logLevel:"info",loadingText:"loading ...",isForceMouseClickToVoxelCenters:!1,dragAndDropEnabled:!0,drawingEnabled:!1,penValue:1,penType:0,floodFillNeighbors:6,isFilledPen:!1,thumbnail:"",maxDrawUndoBitmaps:8,sliceType:3,meshXRay:0,isAntiAlias:null,limitFrames4D:NaN,isAdditiveBlend:!1,showLegend:!0,legendBackgroundColor:[.3,.3,.3,.5],legendTextColor:[1,1,1,1],multiplanarLayout:0,renderOverlayBlend:1,sliceMosaicString:"",centerMosaic:!1,penSize:1,interactive:!0,clickToSegment:!1,clickToSegmentRadius:3,clickToSegmentBright:!0,clickToSegmentAutoIntensity:!1,clickToSegmentIntensityMax:NaN,clickToSegmentIntensityMin:NaN,clickToSegmentPercent:0,clickToSegmentMaxDistanceMM:Number.POSITIVE_INFINITY,clickToSegmentIs2D:!1,selectionBoxLineThickness:4,selectionBoxIsOutline:!1,scrollRequiresFocus:!1,showMeasureUnits:!0,measureTextJustify:"center",measureTextColor:[1,0,0,1],measureLineColor:[1,0,0,1],measureTextHeight:.06,isAlphaClipDark:!1,gradientOrder:1,gradientOpacity:0,renderSilhouette:0,gradientAmount:0,invertScrollDirection:!1,is2DSliceShader:!1},Sc={gamma:1,azimuth:110,elevation:10,crosshairPos:Me(.5,.5,.5),clipPlane:[0,0,0,0],clipPlaneDepthAziElev:[2,0,0],volScaleMultiplier:1,pan2Dxyzmm:Jt(0,0,0,1),clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1]};function gY(r,e){const n={};for(const i in r){const a=r[i],s=e[i],o=Array.isArray(a)&&Array.isArray(s);(o&&a.some((l,c)=>l!==s[c])||!o&&a!==s)&&(n[i]=a)}return n}var lp=class vs{constructor(){j(this,"data",{title:"Untitled document",imageOptionsArray:[],meshOptionsArray:[],opts:{...Di},previewImageDataURL:"",labels:[],encodedImageBlobs:[],encodedDrawingBlob:""}),j(this,"scene"),j(this,"volumes",[]),j(this,"meshDataObjects"),j(this,"meshes",[]),j(this,"drawBitmap",null),j(this,"imageOptionsMap",new Map),j(this,"meshOptionsMap",new Map),j(this,"completedMeasurements",[]),j(this,"completedAngles",[]),j(this,"_optsProxy",null),j(this,"_optsChangeCallback",null),this.scene={onAzimuthElevationChange:()=>{},onZoom3DChange:()=>{},sceneData:{...Sc,pan2Dxyzmm:Jt(0,0,0,1),crosshairPos:Me(.5,.5,.5)},get renderAzimuth(){return this.sceneData.azimuth},set renderAzimuth(e){this.sceneData.azimuth=e,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get renderElevation(){return this.sceneData.elevation},set renderElevation(e){this.sceneData.elevation=e,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get volScaleMultiplier(){return this.sceneData.volScaleMultiplier},set volScaleMultiplier(e){this.sceneData.volScaleMultiplier=e,this.onZoom3DChange(e)},get crosshairPos(){return this.sceneData.crosshairPos},set crosshairPos(e){this.sceneData.crosshairPos=e},get clipPlane(){return this.sceneData.clipPlane},set clipPlane(e){this.sceneData.clipPlane=e},get clipPlaneDepthAziElev(){return this.sceneData.clipPlaneDepthAziElev},set clipPlaneDepthAziElev(e){this.sceneData.clipPlaneDepthAziElev=e},get pan2Dxyzmm(){return this.sceneData.pan2Dxyzmm},set pan2Dxyzmm(e){this.sceneData.pan2Dxyzmm=e},get gamma(){return this.sceneData.gamma},set gamma(e){this.sceneData.gamma=e}}}get title(){return this.data.title}get previewImageDataURL(){return this.data.previewImageDataURL}set previewImageDataURL(e){this.data.previewImageDataURL=e}set title(e){this.data.title=e}get imageOptionsArray(){return this.data.imageOptionsArray}get encodedImageBlobs(){return this.data.encodedImageBlobs}get encodedDrawingBlob(){return this.data.encodedDrawingBlob}get opts(){return this._optsProxy||this._createOptsProxy(),this._optsProxy}set opts(e){this.data.opts={...e},this._optsProxy=null}get labels(){return this.data.labels}set labels(e){this.data.labels=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}hasImage(e){return this.volumes.find(n=>n.id===e.id)!==void 0}hasImageFromUrl(e){return this.data.imageOptionsArray.find(n=>n.url===e)!==void 0}addImageOptions(e,n){if(!this.hasImage(e)&&!n.name)if(n.url){const a=/^(?:[a-z+]+:)?\/\//i.test(n.url)?new URL(n.url):new URL(n.url,window.location.href);n.name=a.pathname.split("/").pop(),n.name.toLowerCase().endsWith(".gz")&&(n.name=n.name.slice(0,-3)),n.name.toLowerCase().endsWith(".nii")||(n.name+=".nii")}else n.name="untitled.nii";n.imageType=ut.NII,this.data.imageOptionsArray.push(n),this.imageOptionsMap.set(e.id,this.data.imageOptionsArray.length-1)}removeImage(e){if(this.imageOptionsMap.has(e.id)){const n=this.imageOptionsMap.get(e.id);this.data.imageOptionsArray.length>n&&this.data.imageOptionsArray.splice(n,1),this.imageOptionsMap.delete(e.id)}this.volumes=this.volumes.filter(n=>n.id!==e.id)}async fetchLinkedData(){if(this.data.encodedImageBlobs=[],!!this.imageOptionsArray?.length){for(const e of this.imageOptionsArray)if(e.url)try{const n=await fetch(e.url);if(!n.ok){console.warn("Failed to fetch image:",e.url);continue}const i=await n.arrayBuffer(),a=new Uint8Array(i),s=qe.uint8tob64(a);this.data.encodedImageBlobs.push(s),console.info("fetch linked data fetched from ",e.url)}catch(n){console.warn(`Failed to fetch/encode image from ${e.url}:`,n)}}}getImageOptions(e){return this.imageOptionsMap.has(e.id)?this.data.imageOptionsArray[this.imageOptionsMap.get(e.id)]:null}json(e=!0,n=!0){const i={encodedImageBlobs:[],previewImageDataURL:this.data.previewImageDataURL,imageOptionsMap:new Map},a=[];i.sceneData={...this.scene.sceneData},i.opts=gY(this.opts,Di),this.opts.meshThicknessOn2D===1/0&&(i.opts.meshThicknessOn2D="infinity"),this.opts.meshThicknessOn2D===1/0&&(i.opts.meshThicknessOn2D="infinity"),i.labels=[...this.data.labels];for(const o of i.labels)delete o.onClick;if(i.customData=this.customData,i.completedMeasurements=[...this.completedMeasurements],i.completedAngles=[...this.completedAngles],this.volumes.length)for(let o=0;o<this.volumes.length;o++){const l=this.volumes[o];let c=this.getImageOptions(l);if(c===null?(Z.warn("no options found for image, using options from the volume directly"),c={name:l?.name??"",colormap:l?._colormap??"gray",opacity:l?._opacity??1,pairedImgData:null,cal_min:l?.cal_min??NaN,cal_max:l?.cal_max??NaN,trustCalMinMax:l?.trustCalMinMax??!0,percentileFrac:l?.percentileFrac??.02,ignoreZeroVoxels:l?.ignoreZeroVoxels??!1,useQFormNotSForm:l?.useQFormNotSForm??!1,colormapNegative:l?.colormapNegative??"",colormapLabel:l?.colormapLabel??null,imageType:l?.imageType??ut.NII,frame4D:l?.frame4D??0,limitFrames4D:l?.limitFrames4D??NaN,url:l?.url??"",urlImageData:l?.urlImgData??"",alphaThreshold:!1,cal_minNeg:l?.cal_minNeg??NaN,cal_maxNeg:l?.cal_maxNeg??NaN,colorbarVisible:l?.colorbarVisible??!0}):"imageType"in c||(c.imageType=ut.NII),c.colormap=l.colormap,c.colormapLabel=l.colormapLabel,c.opacity=l.opacity,c.cal_max=l.cal_max??NaN,c.cal_min=l.cal_min??NaN,a.push(c),e){const u=qe.uint8tob64(l.toUint8Array());i.encodedImageBlobs.push(u)}i.imageOptionsMap.set(l.id,o)}i.imageOptionsArray=[...a];const s=[];i.connectomes=[];for(const o of this.meshes){if(o.type==="connectome"){i.connectomes.push(JSON.stringify(o.json()));continue}const l={pts:o.pts,tris:o.tris,name:o.name,rgba255:Uint8Array.from(o.rgba255),opacity:o.opacity,connectome:o.connectome,dpg:o.dpg,dps:o.dps,dpv:o.dpv,meshShaderIndex:o.meshShaderIndex,layers:o.layers.map(c=>({values:c.values,nFrame4D:c.nFrame4D,frame4D:0,outlineBorder:c.outlineBorder,global_min:c.global_min,global_max:c.global_max,cal_min:c.cal_min,cal_max:c.cal_max,opacity:c.opacity,colormap:c.colormap,colormapNegative:c.colormapNegative,colormapLabel:c.colormapLabel,useNegativeCmap:c.useNegativeCmap})),hasConnectome:o.hasConnectome,edgeColormap:o.edgeColormap,edgeColormapNegative:o.edgeColormapNegative,edgeMax:o.edgeMax,edgeMin:o.edgeMin,edges:o.edges&&Array.isArray(o.edges)?[...o.edges]:[],extentsMax:o.extentsMax,extentsMin:o.extentsMin,furthestVertexFromOrigin:o.furthestVertexFromOrigin,nodeColormap:o.nodeColormap,nodeColormapNegative:o.nodeColormapNegative,nodeMaxColor:o.nodeMaxColor,nodeMinColor:o.nodeMinColor,nodeScale:o.nodeScale,legendLineThickness:o.legendLineThickness,offsetPt0:o.offsetPt0,nodes:o.nodes};o.offsetPt0&&o.offsetPt0.length>0&&(l.offsetPt0=o.offsetPt0,l.fiberGroupColormap=o.fiberGroupColormap,l.fiberColor=o.fiberColor,l.fiberDither=o.fiberDither,l.fiberRadius=o.fiberRadius,l.colormap=o.colormap),s.push(l)}return i.meshesString=JSON.stringify(pz(s)),n&&this.drawBitmap&&(i.encodedDrawingBlob=qe.uint8tob64(this.drawBitmap)),i}async download(e,n,i={embedImages:!0}){const a=this.json(i.embedImages),s=JSON.stringify(a),o=n?"application/gzip":"application/json",l=n?await qe.compressStringToArrayBuffer(s):s;qe.download(l,e,o)}static deserializeMeshDataObjects(e){if(!e.data.meshesString||e.data.meshesString==="[]"){e.meshDataObjects=[];return}if(e.data.meshesString){e.meshDataObjects=dz(JSON.parse(e.data.meshesString));for(const n of e.meshDataObjects)for(const i of n.layers)"colorMap"in i&&(i.colormap=i.colorMap,delete i.colorMap),"colorMapNegative"in i&&(i.colormapNegative=i.colorMapNegative,delete i.colorMapNegative)}}static async loadFromUrl(e){const i=await(await fetch(e)).arrayBuffer();let a;if(qe.isArrayBufferCompressed(i)){const s=await qe.decompressArrayBuffer(i);a=JSON.parse(s)}else{const s=new TextDecoder;a=JSON.parse(s.decode(i))}return vs.loadFromJSON(a)}static async loadFromFile(e){const n=await qe.readFileAsync(e);let i;const a=new vs;return qe.isArrayBufferCompressed(n)?i=await qe.decompressArrayBuffer(n):i=new TextDecoder().decode(n),a.data=JSON.parse(i),a.data.opts.meshThicknessOn2D==="infinity"&&(a.data.opts.meshThicknessOn2D=1/0),a.scene.sceneData={...Sc,...a.data.sceneData},vs.deserializeMeshDataObjects(a),a}static loadFromJSON(e){const n=new vs;return Object.assign(n.data,{...e,imageOptionsArray:e.imageOptionsArray??[],encodedImageBlobs:e.encodedImageBlobs??[],labels:e.labels??[],meshOptionsArray:e.meshOptionsArray??[],connectomes:e.connectomes??[],encodedDrawingBlob:e.encodedDrawingBlob??"",previewImageDataURL:e.previewImageDataURL??"",customData:e.customData??"",title:e.title??"untitled"}),n.data.opts={...Di,...e.opts||{}},n.data.opts.meshThicknessOn2D==="infinity"&&(n.data.opts.meshThicknessOn2D=1/0),n.scene.sceneData={...Sc,...e.sceneData||{}},e.completedMeasurements&&(n.completedMeasurements=e.completedMeasurements.map(i=>({...i,startMM:Ri(i.startMM),endMM:Ri(i.endMM)}))),e.completedAngles&&(n.completedAngles=e.completedAngles.map(i=>({...i,firstLineMM:{start:Ri(i.firstLineMM.start),end:Ri(i.firstLineMM.end)},secondLineMM:{start:Ri(i.secondLineMM.start),end:Ri(i.secondLineMM.end)}}))),n.data.meshesString&&vs.deserializeMeshDataObjects(n),n}static oldloadFromJSON(e){const n=new vs;return n.data=e,n.data.opts.meshThicknessOn2D==="infinity"&&(n.data.opts.meshThicknessOn2D=1/0),n.scene.sceneData={...Sc,...e.sceneData},vs.deserializeMeshDataObjects(n),n}setOptsChangeCallback(e){this._optsChangeCallback=e,this._optsProxy=null}removeOptsChangeCallback(){this._optsChangeCallback=null,this._optsProxy=null}_createOptsProxy(){const e=this.data.opts;this._optsProxy=new Proxy(e,{set:(n,i,a)=>{const s=n[i];return s!==a&&(n[i]=a,this._optsChangeCallback&&typeof i=="string"&&i in Di&&this._optsChangeCallback(i,a,s)),!0},get:(n,i)=>n[i]})}},vY={colormap:"gray",opacity:0,nFrame4D:0,frame4D:0,outlineBorder:0,cal_min:0,cal_max:0,cal_minNeg:0,cal_maxNeg:0,colormapType:0,values:new Array,useNegativeCmap:!1,showLegend:!0},Il=class qi{constructor(e,n,i="",a=new Uint8Array([255,255,255,255]),s=1,o=!0,l,c=null,u=null,h=null,g=null,v=!0,m=""){j(this,"id"),j(this,"name"),j(this,"anatomicalStructurePrimary"),j(this,"colorbarVisible"),j(this,"furthestVertexFromOrigin"),j(this,"extentsMin"),j(this,"extentsMax"),j(this,"opacity"),j(this,"visible"),j(this,"meshShaderIndex",0),j(this,"offsetPt0",null),j(this,"colormapInvert",!1),j(this,"fiberGroupColormap",null),j(this,"indexBuffer"),j(this,"vertexBuffer"),j(this,"vao"),j(this,"vaoFiber"),j(this,"pts"),j(this,"tris"),j(this,"layers"),j(this,"type","mesh"),j(this,"data_type"),j(this,"rgba255"),j(this,"fiberLength"),j(this,"fiberLengths"),j(this,"fiberDensity"),j(this,"fiberDither",.1),j(this,"fiberColor","Global"),j(this,"fiberDecimationStride",1),j(this,"fiberSides",5),j(this,"fiberRadius",0),j(this,"fiberOcclusion",0),j(this,"f32PerVertex",5),j(this,"fiberMask"),j(this,"colormap"),j(this,"dpg"),j(this,"dps"),j(this,"dpv"),j(this,"hasConnectome",!1),j(this,"connectome"),j(this,"indexCount"),j(this,"vertexCount",1),j(this,"nodeScale",4),j(this,"edgeScale",1),j(this,"legendLineThickness",0),j(this,"showLegend",!0),j(this,"nodeColormap","warm"),j(this,"edgeColormap","warm"),j(this,"nodeColormapNegative"),j(this,"edgeColormapNegative"),j(this,"nodeMinColor"),j(this,"nodeMaxColor"),j(this,"edgeMin"),j(this,"edgeMax"),j(this,"nodes"),j(this,"edges"),j(this,"points"),this.anatomicalStructurePrimary=m,this.name=i,this.colorbarVisible=v,this.id=l2();const y=ho.getExtents(e);if(this.furthestVertexFromOrigin=y.mxDx,this.extentsMin=y.extentsMin,this.extentsMax=y.extentsMax,this.opacity=s>1?1:s,this.visible=o,this.meshShaderIndex=0,this.indexBuffer=l.createBuffer(),this.vertexBuffer=l.createBuffer(),this.vao=l.createVertexArray(),l.bindVertexArray(this.vao),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer),l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer),l.enableVertexAttribArray(0),l.enableVertexAttribArray(1),this.f32PerVertex!==7?(l.vertexAttribPointer(0,3,l.FLOAT,!1,20,0),l.vertexAttribPointer(1,4,l.BYTE,!0,20,12),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,4,l.UNSIGNED_BYTE,!0,20,16)):(l.vertexAttribPointer(0,3,l.FLOAT,!1,28,0),l.vertexAttribPointer(1,3,l.FLOAT,!1,28,12),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,4,l.UNSIGNED_BYTE,!0,28,24)),l.bindVertexArray(null),this.vaoFiber=l.createVertexArray(),this.offsetPt0=null,this.hasConnectome=!1,this.colormapInvert=!1,this.fiberGroupColormap=null,this.pts=e,this.layers=[],this.type="mesh",this.tris=n,a[3]<1){this.rgba255=a,this.fiberLength=2,this.fiberDither=.1,this.fiberColor="Global",this.fiberDecimationStride=1,this.fiberMask=[],this.colormap=c,this.dpg=u,this.dps=h,this.dpv=g,u&&this.initValuesArray(u),h&&this.initValuesArray(h),g&&this.initValuesArray(g),this.offsetPt0=new Uint32Array(n),this.tris=new Uint32Array(0),this.updateFibers(l),l.bindVertexArray(this.vaoFiber),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer),l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer),l.enableVertexAttribArray(0),l.vertexAttribPointer(0,3,l.FLOAT,!1,16,0),l.enableVertexAttribArray(1),l.vertexAttribPointer(1,4,l.UNSIGNED_BYTE,!0,16,12),l.bindVertexArray(null);return}if(c){this.connectome=c,this.hasConnectome=!0;const x=Object.keys(c);for(let A=0,C=x.length;A<C;A++)this[x[A]]=c[x[A]]}this.rgba255=a,this.updateMesh(l)}initValuesArray(e){for(let n=0;n<e.length;n++){const i=e[n].vals.reduce((s,o)=>Math.min(s,o)),a=e[n].vals.reduce((s,o)=>Math.max(s,o));e[n].global_min=i,e[n].global_max=a,e[n].cal_min=i,e[n].cal_max=a}return e}linesToCylinders(e,n,i){function a(F){return Me(F[0],F[1],F[2])}const s=Math.pow(2,32)-1,o=i.length;let l=0,c=0;for(let F=0;F<o;F++){if(i[F]===s){c++;continue}l++}const u=this.fiberSides,h=u*l,g=this.f32PerVertex;if(g!==5)throw Error("fiberSides > 1 requires f32PerVertex == 5");const v=new Float32Array(h*g),m=new Uint8Array(v.buffer);let y=0,b=Qi(),x=Qi(),A=Qi();const C=Kt();let E=Kt(),S=0;const M=this.fiberRadius;for(let F=0;F<o;F++){const I=i[F]===s;if(I&&S<1)continue;let U=i[F]*4;if(S++,S<=1){b=Jt(n[U+0],n[U+1],n[U+2],n[U+3]),x=ws(b),F+1<o&&i[F+1]!==s&&(U=i[F+1]*4,A=Jt(n[U+0],n[U+1],n[U+2],n[U+3]),Wt(C,a(b),a(A)),yi(C,C),E=Ro.getFirstPerpVector(C));continue}I?A=ws(x):A=Jt(n[U+0],n[U+1],n[U+2],n[U+3]),Wt(C,a(b),a(A)),yi(C,C);const k=Kt();Pd(k,E,C);const O=Kt();Pd(O,C,k),E=Ri(E);const V=Kt();Pd(V,C,O),yi(V,V);const L=Kt();for(let P=0;P<u;P++){const _=Math.cos(P/u*2*Math.PI),q=Math.sin(P/u*2*Math.PI);L[0]=M*(_*O[0]+q*V[0]),L[1]=M*(_*O[1]+q*V[1]),L[2]=M*(_*O[2]+q*V[2]),xo(L,a(x),L);const H=y*g;v[H+0]=L[0],v[H+1]=L[1],v[H+2]=L[2];const W=Kt();Wt(W,L,a(x)),yi(W,W);const G=(H+3)*4;m[G+0]=W[0]*127,m[G+1]=W[1]*127,m[G+2]=W[2]*127,v[H+4]=x[3],y++}b=ws(x),x=ws(A),I&&(S=0)}const R=(l-c)*u*2*3,T=new Uint32Array(R);let B=0;y=0;for(let F=1;F<o;F++){if(i[F]===s){y+=u;continue}if(i[F-1]===s)continue;let I=y,U=y+u;const k=U,O=U+u;for(let V=0;V<u;V++)T[B++]=I,T[B++]=U++,U===O&&(U=O-u),T[B++]=U,T[B++]=I++,I===k&&(I=k-u),T[B++]=U,T[B++]=I;y+=u}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(T),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,m,e.STATIC_DRAW),this.indexCount=R}createFiberDensityMap(){if(this.fiberDensity)return;const e=this.pts,n=e.length/3;let i=0;for(let C=0;C<3;C++){const E=this.extentsMax[C]-this.extentsMin[C];i=Math.max(i,E)}if(this.fiberDensity=new Float32Array(n),i===0)return;const a=64,o=i/(a-1)/2,l=(a-1)/i;let c=new Float32Array(a*a*a);const u=[this.extentsMin[0]-o,this.extentsMin[1]-o,this.extentsMin[2]-o],h=[0,0,0],g=-1,v=a*a;let m=0;for(let C=0;C<n;C++){h[0]=Math.round((e[m++]-u[0])*l),h[1]=Math.round((e[m++]-u[1])*l),h[2]=Math.round((e[m++]-u[2])*l);const E=h[0]+h[1]*a+h[2]*v;E!==g&&c[E]++}function y(C,E){let S=C.slice(),M=-1;const R=E-1;for(let B=0;B<E;B++)for(let F=0;F<E;F++)for(let I=0;I<E;I++)M++,!(I<1||I>=R)&&(C[M]=S[M-1]+S[M]+S[M]+S[M+1]);M=-1,S=C.slice();for(let B=0;B<E;B++)for(let F=0;F<E;F++)for(let I=0;I<E;I++)M++,!(F<1||F>=R)&&(C[M]=S[M-E]+S[M]+S[M]+S[M+E]);const T=E*E;M=-1,S=C.slice();for(let B=0;B<E;B++)for(let F=0;F<E;F++)for(let I=0;I<E;I++)M++,!(B<1||B>=R)&&(C[M]=S[M-T]+S[M]+S[M]+S[T]);return C}c=y(c,a),c=y(c,a);let b=0,x=1/0;const A=a*a*a;for(let C=0;C<A;C++)c[C]<=0||(b=Math.max(b,c[C]),x=Math.min(x,c[C]));if(!(b<=1||b<=x)){m=0;for(let C=0;C<A;C++)c[C]=Math.max(0,c[C]-x);b-=x;for(let C=0;C<n;C++){h[0]=Math.round((e[m++]-u[0])*l),h[1]=Math.round((e[m++]-u[1])*l),h[2]=Math.round((e[m++]-u[2])*l);const E=h[0]+h[1]*a+h[2]*v;this.fiberDensity[C]=c[E]/b}}}updateFibers(e){if(!this.offsetPt0||!this.fiberLength)return;const n=this.pts,i=this.offsetPt0,a=i.length-1,s=n.length/3;if(!this.fiberLengths){this.fiberLengths=new Uint32Array(a);for(let R=0;R<a;R++){const T=i[R]*3,B=(i[R+1]-1)*3;let F=0;for(let I=T;I<B;I+=3){const U=Me(n[I+0]-n[I+3],n[I+1]-n[I+4],n[I+2]-n[I+5]);F+=$c(U)}this.fiberLengths[R]=F}}const o=new Float32Array(s*4),l=new Uint32Array(o.buffer);let c=0,u=0;for(let R=0;R<s;R++)o[u+0]=n[c+0],o[u+1]=n[c+1],o[u+2]=n[c+2],c+=3,u+=4;const h=this.fiberDither,g=h*.5;function v(R,T,B){const I=255*(h*Math.random()-g);return R=Math.max(Math.min(R+I,255),0),T=Math.max(Math.min(T+I,255),0),B=Math.max(Math.min(B+I,255),0),R+(T<<8)+(B<<16)}function m(R,T,B,F,I,U,k){const O=Me(Math.abs(R-F),Math.abs(T-I),Math.abs(B-U));yi(O,O);const V=k-g;for(let L=0;L<3;L++)O[L]=255*Math.max(Math.min(Math.abs(O[L])+V,1),0);return O[0]+(O[1]<<8)+(O[2]<<16)}const y=this.fiberColor.toLowerCase();let b=null,x=null;if(y.startsWith("dps")&&this.dps&&this.dps.length>0){const R=parseInt(y.substring(3));R<this.dps.length&&this.dps[R].vals.length===a&&(b=this.dps[R].vals)}if(y.startsWith("dpv")&&this.dpv&&this.dpv.length>0){const R=parseInt(y.substring(3));R<this.dpv.length&&this.dpv[R].vals.length===s&&(x=this.dpv[R])}const A=new Int16Array(a);if(this.dpg&&this.fiberGroupColormap!==null){const R=new Uint8ClampedArray(this.dpg.length*4),T=new Array(this.dpg.length).fill(!1),B=this.fiberGroupColormap;B.A===void 0&&(B.A=Array.from(new Uint8ClampedArray(B.I.length).fill(255)));for(let F=0;F<B.I.length;F++){let I=B.I[F];I<0||I>=this.dpg.length||B.A[F]<1||(T[I]=!0,I*=4,R[I]=B.R[F],R[I+1]=B.G[F],R[I+2]=B.B[F],R[I+3]=255)}A.fill(-1);for(let F=0;F<this.dpg.length;F++)if(T[F])for(let I=0;I<this.dpg[F].vals.length;I++)A[this.dpg[F].vals[I]]=F;for(let F=0;F<a;F++){if(A[F]<0)continue;const I=A[F]%256*4,U=v(R[I],R[I+1],R[I+2]),k=i[F],O=i[F+1]-1,V=k*4+3,L=O*4+3;for(let P=V;P<=L;P+=4)l[P]=U}}else if(x){const R=Vt.colormap(this.colormap,this.colormapInvert),T=x.cal_min,B=x.cal_max;let F=3;for(let I=0;I<s;I++){let U=Math.min(Math.max((x.vals[I]-T)/(B-T),0),1);U=Math.round(Math.max(Math.min(255,U*255)))*4;const k=R[U]+(R[U+1]<<8)+(R[U+2]<<16);l[F]=k,F+=4}}else if(b){const R=Vt.colormap(this.colormap,this.colormapInvert);let T=b[0],B=b[0];for(let F=0;F<a;F++)T=Math.min(T,b[F]),B=Math.max(B,b[F]);B===T&&(T-=1);for(let F=0;F<a;F++){let I=(b[F]-T)/(B-T);I=Math.round(Math.max(Math.min(255,I*255)))*4;const U=R[I]+(R[I+1]<<8)+(R[I+2]<<16),k=i[F],O=i[F+1]-1,V=k*4+3,L=O*4+3;for(let P=V;P<=L;P+=4)l[P]=U}}else if(y.includes("fixed"))if(h===0){const R=this.rgba255[0]+(this.rgba255[1]<<8)+(this.rgba255[2]<<16);let T=3;for(let B=0;B<s;B++)l[T]=R,T+=4}else for(let R=0;R<a;R++){const T=v(this.rgba255[0],this.rgba255[1],this.rgba255[2]),B=i[R],F=i[R+1]-1,I=B*4+3,U=F*4+3;for(let k=I;k<=U;k+=4)l[k]=T}else if(y.includes("local"))for(let R=0;R<a;R++){const T=i[R],B=i[R+1]-1;let F=T*3;const I=B*3,U=h*Math.random();let k=m(n[F],n[F+1],n[F+2],n[F+4],n[F+5],n[F+6],U),O=T*4+3;for(;F<I;)l[O]=k,O+=4,F+=3,k=m(n[F-3],n[F-2],n[F-1],n[F+3],n[F+4],n[F+5],U);l[O]=l[O-4]}else for(let R=0;R<a;R++){const T=i[R],B=i[R+1]-1,F=T*3,I=B*3,U=m(n[F],n[F+1],n[F+2],n[I],n[I+1],n[I+2],h*Math.random()),k=T*4+3,O=B*4+3;for(let V=k;V<=O;V+=4)l[V]=U}if(this.fiberOcclusion>0){let R=function(T,B){const F=B*(T&255),I=B*(T>>8&255),U=B*(T>>16&255);return F+(I<<8)+(U<<16)};this.createFiberDensityMap();for(let T=0;T<a;T++){const B=i[T],F=i[T+1]-1,I=B*4+3,U=F*4+3;let k=B;const O=Math.min(this.fiberOcclusion,.99);for(let V=I;V<=U;V+=4){let L=this.fiberDensity[k++];if(L<=0)continue;L=L/((1/O-2)*(1-L)+1);const P=1-Math.min(L,.9);let _=l[V];_=R(_,P),l[V]=_}}}const C=this.fiberLength,E=Math.pow(2,32)-1,S=[];let M=-1;for(let R=0;R<a;R++)if(!(A[R]<0)&&!(this.fiberLengths[R]<C)&&(M++,M%this.fiberDecimationStride===0)){for(let T=i[R];T<i[R+1];T++)S.push(T);S.push(E)}this.fiberSides>2&&this.fiberRadius>0?this.linesToCylinders(e,o,S):(this.indexCount=S.length,e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Uint32Array.from(l),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(S),e.STATIC_DRAW))}indexNearestXYZmm(e,n,i){const a=this.pts,s=this.pts.length/3;let o=0,l=1/0,c=0;for(let u=0;u<s;u++){const h=Math.pow(a[o]-e,2)+Math.pow(a[o+1]-n,2)+Math.pow(a[o+2]-i,2);h<l&&(l=h,c=u),o+=3}return l=Math.sqrt(l),[c,l]}unloadMesh(e){if(e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindVertexArray(null),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteVertexArray(this.vao),e.deleteVertexArray(this.vaoFiber),this.offsetPt0=null,this.tris=null,this.pts=null,this.layers&&this.layers.length>0)for(let n=0;n<this.layers.length;n++)this.layers[n].values=null;if(this.dpg&&this.dpg.length>0)for(let n=0;n<this.dpg.length;n++)this.dpg[n].vals=null;if(this.dps&&this.dps.length>0)for(let n=0;n<this.dps.length;n++)this.dps[n].vals=null}scalars2RGBA(e,n,i,a=!1){const s=i.length;if(4*s<e.length)return Z.error(`colormap2RGBA incorrectly specified ${s}*4 != ${e.length}`),e;const o=Math.round(n.opacity*255);let l=n.cal_min,c=n.cal_max,u=Vt.colormap(n.colormap,this.colormapInvert),h=1;if(a){if(!n.useNegativeCmap)return e;h=-1,u=Vt.colormap(n.colormapNegative,n.colormapInvert),l=n.cal_min,c=n.cal_max,isFinite(n.cal_minNeg)&&isFinite(n.cal_minNeg)&&(l=-n.cal_minNeg,c=-n.cal_maxNeg)}let g=l;n.isTransparentBelowCalMin||(g=Number.NEGATIVE_INFINITY);const v=n.colormapType===2;n.colormapType!==0&&(l=Math.min(l,0));const m=255/(c-l);for(let y=0;y<s;y++){let b=i[y]*h;if(isNaN(b))continue;let x=o;if(b<g)if(b>0&&v)x=Math.round(n.opacity*255*Math.pow(b/g,2));else continue;if(b=(b-l)*m,b<0&&n.isTransparentBelowCalMin)continue;b=Math.min(255,Math.max(0,Math.round(b)))*4;const A=y*4;e[A+0]=u[b+0],e[A+1]=u[b+1],e[A+2]=u[b+2],e[A+3]=x}return e}blendColormap(e,n,i,a,s,o,l=!1){const c=this.pts.length/3,u=Math.min(i.opacity,1);function h(E,S,M){return E*(1-M)+S*M}function g(E,S){return Math.min(E+S,255)}const v=l?-1:1,m=Math.min(Math.max(i.frame4D,0),i.nFrame4D-1),y=c*m;let b=a;i.isTransparentBelowCalMin||(b=Number.NEGATIVE_INFINITY),i.colormapType!==0&&(a=Math.min(a,0));const x=255/(s-a);let A=new Array(c).fill(!1);if(i.outlineBorder!==0){const E=new Uint8Array(c).fill(0);for(let S=0;S<c;S++)v*i.values[S+y]>=b&&(E[S]=1);A=ho.getClusterBoundaryU8(E,this.tris);for(let S=0;S<c;S++)v*i.values[S+y]<b&&(A[S]=!1)}const C=new Float32Array(256).fill(u);if(b>a&&i.colormapType===2){let E=Math.round((b-a)*x);E=Math.max(E,1);for(let S=1;S<E;S++)C[S]=u*Math.pow(S/E,2);C[0]=0,b=a+Number.EPSILON}for(let E=0;E<c;E++){const S=v*i.values[E+y];if(S<b)continue;let M=Math.round((S-a)*x);if(M<0&&i.isTransparentBelowCalMin)continue;M=Math.max(0,M),M=Math.min(255,M);let R=C[M];M*=4;let T=E*28+24;if(this.f32PerVertex!==7&&(T=E*20+16),i.isAdditiveBlend){const B=E*4;n[B+0]=g(n[B+0],o[M+0]),n[B+1]=g(n[B+1],o[M+1]),n[B+2]=g(n[B+2],o[M+2]),n[B+3]=g(n[B+3],255)}else{if(A[E]&&(R=i.outlineBorder,i.outlineBorder<0)){e[T+0]=0,e[T+1]=0,e[T+2]=0;continue}e[T+0]=h(e[T+0],o[M+0],R),e[T+1]=h(e[T+1],o[M+1],R),e[T+2]=h(e[T+2],o[M+2],R)}}}updateMesh(e){if(this.offsetPt0){this.updateFibers(e);return}if(this.hasConnectome)return;if(!this.pts||!this.tris||!this.rgba255){Z.warn("underspecified mesh");return}function n(u,h,g){return u*(1-g)+h*g}const i=this.generatePosNormClr(this.pts,this.tris,this.rgba255),a=this.pts.length/3,s=new Uint8Array(i.buffer);let o=0;const l=new Uint8Array(a*4);let c=this.tris;if(this.layers&&this.layers.length>0)for(let u=0;u<this.layers.length;u++){const h=this.layers[u],g=h.opacity;if(g<=0||h.cal_min>h.cal_max)continue;if(h.outlineBorder===void 0&&(h.outlineBorder=0),h.isAdditiveBlend===void 0&&(h.isAdditiveBlend=!1),h.colormapLabel&&h.colormapLabel.R&&!h.colormapLabel.lut&&(h.colormapLabel=Vt.makeLabelLut(h.colormapLabel)),h.colormapLabel&&h.colormapLabel.lut){const m=h.colormapLabel;let y=0;h.colormapLabel.min&&(y=h.colormapLabel.min);let b=m.lut;const x=Math.round(h.opacity*255);b[3]>0&&(b[3]=x);for(let T=7;T<b.length;T+=4)b[T]=x;const A=Math.floor(b.length/4);if(h.atlasValues&&A>0&&A===h.atlasValues.length&&h.colormap){const T=h.atlasValues;let B=!1,F=!0;for(let I=0;I<A;I++)isNaN(T[I])?B=!0:F=!1;if(F){Z.debug("invisible mesh: all atlasValues are NaN.");return}if(B){Z.debug("some vertices have NaN atlasValues (mesh will be decimated).");const I=new Array(a).fill(!1);for(let L=0;L<a;L++){const P=Math.round(h.values[L])-y;isNaN(T[P])&&(I[L]=!0)}const U=new Array(c.length).fill(!1);for(let L=0;L<c.length;L++)I[c[L]]&&(U[L]=!0);const k=this.tris;let O=0;for(let L=0;L<k.length;L+=3)!U[L]&&!U[L+1]&&!U[L+2]&&O++;O===0&&Z.debug("invisible mesh: all triangles of a vertex with a NaN atlasValue."),c=new Uint32Array(O*3);let V=0;for(let L=0;L<k.length;L+=3)!U[L]&&!U[L+1]&&!U[L+2]&&(c[V++]=k[L],c[V++]=k[L+1],c[V++]=k[L+2])}b.fill(0),b=this.scalars2RGBA(b,h,T),h.useNegativeCmap&&(b=this.scalars2RGBA(b,h,T,!0))}else h.atlasValues&&Z.warn(`Expected ${A} atlasValues but got ${h.atlasValues.length} for mesh layer`);if(h.showLegend&&A===h.colormapLabel.labels.length){h.labels=[];for(let T=0;T<A;T++){const B=Array.from(b.slice(T*4,T*4+4)).map(O=>O/255),F=h.colormapLabel.labels[T],I=[0,0,0];let U=0;for(let O=0;O<a;O++)if(h.values[O]===T){const V=O*3;I[0]+=this.pts[V],I[1]+=this.pts[V+1],I[2]+=this.pts[V+2],U++}if(U>0&&(I[0]/=U,I[1]/=U,I[2]/=U),B[3]===0||!F||F.startsWith("_"))continue;B[3]=1;const k=new Dy(F,{textColor:B,bulletScale:1,bulletColor:B,lineWidth:0,lineColor:B,textScale:1,textAlignment:"left",lineTerminator:"none"},I);h.labels.push(k),Z.debug("label for mesh layer:",k)}}else delete h.labels;const C=Math.min(Math.max(h.frame4D,0),h.nFrame4D-1),E=a*C,S=new Uint8Array(a*4);let M=0;for(let T=0;T<a;T++){const B=h.values[T+E]-y,F=4*Math.min(Math.max(B,0),A-1);S[M+0]=b[F+0],S[M+1]=b[F+1],S[M+2]=b[F+2],S[M+3]=b[F+3],M+=4}let R=new Array(a).fill(!1);h.outlineBorder!==0&&(R=ho.getClusterBoundary(S,this.tris)),M=0;for(let T=0;T<a;T++){let B=T*28+24;this.f32PerVertex!==7&&(B=T*20+16);let F=S[M+3]/255;if(R[T]&&(F=h.outlineBorder,h.outlineBorder<0)){s[B+0]=0,s[B+1]=0,s[B+2]=0,M+=4;continue}s[B+0]=n(s[B+0],S[M+0],F),s[B+1]=n(s[B+1],S[M+1],F),s[B+2]=n(s[B+2],S[M+2],F),M+=4}continue}if(h.values instanceof Uint8Array){const m=new Uint8Array(h.values.buffer);let y=new Array(a).fill(!0);h.outlineBorder!==0&&(y=ho.getClusterBoundary(m,this.tris));let b=0;for(let x=0;x<h.values.length;x++){let A=x*28+24;this.f32PerVertex!==7&&(A=x*20+16);let C=g;if(y[x]&&(C=h.outlineBorder,h.outlineBorder<0)){s[A+0]=0,s[A+1]=0,s[A+2]=0,b+=4;continue}s[A+0]=n(s[A+0],m[b+0],C),s[A+1]=n(s[A+1],m[b+1],C),s[A+2]=n(s[A+2],m[b+2],C),b+=4}continue}h.useNegativeCmap&&(h.cal_min=Math.max(Number.EPSILON,h.cal_min),h.cal_max=Math.max(h.cal_min+1e-6,h.cal_max)),h.isTransparentBelowCalMin===void 0&&(h.isTransparentBelowCalMin=!0);const v=Vt.colormap(h.colormap,h.colormapInvert);if(h.isAdditiveBlend&&o++,this.blendColormap(s,l,h,h.cal_min,h.cal_max,v),h.useNegativeCmap){const m=Vt.colormap(h.colormapNegative,h.colormapInvert);let y=h.cal_min,b=h.cal_max;isFinite(h.cal_minNeg)&&isFinite(h.cal_minNeg)&&(y=-h.cal_minNeg,b=-h.cal_maxNeg),this.blendColormap(s,l,h,y,b,m,!0)}}if(o>0)for(let u=0;u<a;u++){let h=function(y,b){return Math.min(y*b*.00392156862745098,255)},g=u*28+24;this.f32PerVertex!==7&&(g=u*20+16);const v=u*4,m=Math.min(o,l[v+3]/255);m<=0||(s[g+0]=h(s[g+0],l[v+0]),s[g+1]=h(s[g+1],l[v+1]),s[g+2]=h(s[g+2],l[v+2]),s[g+0]=n(s[g+0],l[v+0],m),s[g+1]=n(s[g+1],l[v+1],m),s[g+2]=n(s[g+2],l[v+2],m))}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(c),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),this.indexCount=c.length,this.vertexCount=this.pts.length}reverseFaces(e){if(this.offsetPt0||this.hasConnectome)return;const n=this.tris||[];for(let i=0;i<n.length;i+=3){const a=n[i];n[i]=n[i+1],n[i+1]=a}this.updateMesh(e)}hierarchicalOrder(){const i=this.tris.length/3,a=Math.log(i/20)/Math.log(4);if(i!==Math.pow(4,a)*20)return NaN;if(this.pts.length/3!==Math.pow(4,a)*10+2)return NaN;for(let o=0;o<15;o+=3)if(this.tris[o]!==0)return NaN;for(let o=15;o<24;o+=3)if(this.tris[o]!==3)return NaN;for(let o=24;o<30;o+=3)if(this.tris[o]!==4)return NaN;return a}decimateFaces(e,n){let i=this.tris;const a=12,s=20;for(let o=e-1;o>=n;o--){const l=Math.pow(4,o+1)*(a-2)+2,c=Math.pow(4,o)*(a-2)+2,u=i.length/3,h=Math.pow(4,o)*s;console.log(`order ${o+1} -> ${o} vertices ${l} -> ${c} faces ${u} -> ${h}`);const g=Array.from({length:l},(m,y)=>y+1);for(let m=0;m<u;m++){const y=i[3*m],b=i[3*m+1],x=i[3*m+2];g[y-1]=Math.min(g[y-1],b,x)}const v=new Uint32Array(h*3);for(let m=0;m<h;m++)v[3*m]=g[i[3*m]-1],v[3*m+1]=g[i[3*m+1]-1],v[3*m+2]=g[i[3*m+2]-1];i=v}this.tris=new Uint32Array(i)}decimateHierarchicalMesh(e,n=4){const i=this.hierarchicalOrder();if(isNaN(i))return Z.warn("Unable to decimate mesh: it does not have a hierarchical structure"),!1;if(n>=i)return Z.warn(`Unable to decimate mesh: input order (${i}) must be larger than downsampled order (${n})`),!1;const a=this.pts.length/3,o=Math.pow(4,n)*(12-2)+2;if(this.pts=new Float32Array(this.pts.slice(0,o*3)),this.decimateFaces(i,n),this.layers&&this.layers.length>0)for(let l=0;l<this.layers.length;l++){const c=this.layers[l];c.values instanceof Float32Array||c.values.length!==a?c.values=new Float32Array(c.values.slice(0,o)):Z.warn("decimation logic needs to be updated")}return this.updateMesh(e),!0}async setLayerProperty(e,n,i,a){const s=this.layers[e];if(!s||!(n in s)){Z.warn("mesh does not have property ",n," for layer ",s);return}if(n==="colormapLabel")if(typeof i=="object")s[n]=Vt.makeLabelLut(i);else if(typeof i=="string"){const o=await Vt.makeLabelLutFromUrl(i);s[n]=o,this.updateMesh(a);return}else Z.error("colormapLabel requires a string or object");else s[n]=i;this.updateMesh(a)}setProperty(e,n,i){if(!(e in this)){console.warn("Mesh does not have property:",e,this);return}this[e]=n,this.updateMesh(i)}generatePosNormClr(e,n,i){(e.length<3||i.length<4)&&(Z.error("Catastrophic failure generatePosNormClr()"),Z.debug("this",this),Z.debug("pts",e),Z.debug("rgba",i));const a=ho.generateNormals(e,n),s=e.length/3,o=s===i.length/4,l=this.f32PerVertex,c=new Float32Array(s*l),u=new Uint8Array(c.buffer);let h=0,g=0,v=0,m=(l-1)*4;for(let y=0;y<s;y++)c[v+0]=e[h+0],c[v+1]=e[h+1],c[v+2]=e[h+2],l!==7?(u[m-4]=a[h+0]*127,u[m-3]=a[h+1]*127,u[m-2]=a[h+2]*127):(c[v+3]=a[h+0],c[v+4]=a[h+1],c[v+5]=a[h+2]),u[m]=i[g+0],u[m+1]=i[g+1],u[m+2]=i[g+2],u[m+3]=i[g+3],o&&(g+=4),h+=3,v+=l,m+=l*4;return c}static async readMesh(e,n,i,a=1,s=new Uint8Array([255,255,255,255]),o=!0){let l=new Uint32Array([]),c=new Float32Array([]),u="",h;const g=/(?:\.([^.]+))?$/;let v=g.exec(n)[1];if(v=v.toUpperCase(),v==="GZ"&&(v=g.exec(n.slice(0,-3))[1],v=v.toUpperCase()),v==="JCON"&&Z.error("you should never see this message: load using nvconnectome not nvmesh"),v==="JSON"&&Z.error("you should never see this message: load using nvconnectome not nvmesh"),s[3]=Math.max(1,s[3]),v==="TCK"||v==="TRK"||v==="TT"||v==="TRX"||v==="TRACT"){if(v==="TCK"?h=or.readTCK(e):v==="TRACT"?h=or.readTRACT(e):v==="TT"?h=await or.readTT(e):v==="TRX"?h=await or.readTRX(e):h=await or.readTRK(e),typeof h>"u"){const x=new Float32Array([0,0,0,0,0,0]),A=new Uint32Array([0]);h={pts:x,offsetPt0:A},Z.error("Creating empty tracts")}return s[3]=0,new qi(h.pts,h.offsetPt0,n,s,a,o,i,"inferno",h.dpg||null,h.dps||null,h.dpv||null)}if(v==="GII")h=await or.readGII(e);else if(v==="MZ3")h=await or.readMZ3(e),"positions"in h||Z.warn("MZ3 does not have positions (statistical overlay?)");else if(v==="ASC")h=or.readASC(e);else if(v==="DFS")h=or.readDFS(e);else if(v==="BYU"||v==="G")h=or.readGEO(e);else if(v==="GEO")h=or.readGEO(e,!0);else if(v==="ICO"||v==="TRI")h=or.readICO(e);else if(v==="OFF")h=or.readOFF(e);else if(v==="NV")h=or.readNV(e);else if(v==="OBJ")h=await or.readOBJ(e);else if(v==="PLY")h=or.readPLY(e);else if(v==="WRL")h=or.readWRL(e);else if(v==="X3D")h=or.readX3D(e);else if(v==="FIB"||v==="VTK"){if(h=or.readVTK(e),"offsetPt0"in h)return s[3]=0,new qi(h.pts,h.offsetPt0,n,s,a,o,i,"inferno")}else v==="SRF"?h=await or.readSRF(e):v==="STL"?h=or.readSTL(e):h=or.readFreeSurfer(e);if(h.anatomicalStructurePrimary&&(u=h.anatomicalStructurePrimary),h instanceof Float32Array)throw new Error("fatal: unknown mesh type loaded");if(!("positions"in h))throw new Error("positions not loaded");if(!h.indices)throw new Error("indices not loaded");if(c=h.positions,l=h.indices,"rgba255"in h&&h.rgba255.length>0&&(s=h.rgba255),"colors"in h&&h.colors&&h.colors.length===c.length){const x=c.length/3;s=new Uint8Array(x*4);let A=0,C=0;for(let E=0;E<x;E++)s[C++]=h.colors[A]*255,s[C++]=h.colors[A+1]*255,s[C++]=h.colors[A+2]*255,s[C++]=255,A+=3}const m=c.length/3;if(l.length/3<1||m<3)throw new Error("Mesh should have at least one triangle and three vertices");s[3]=Math.max(1,s[3]);const b=new qi(c,l,n,s,a,o,i,null,null,null,null,!0,u);if("scalars"in h&&h.scalars.length>0){const x=await or.readLayer(n,e,b,a,"gray");typeof x>"u"?Z.warn("readLayer() failed to convert scalars"):(b.layers.push(x),b.updateMesh(i))}return b}static async loadLayer(e,n){let i=new Uint8Array().buffer;function a(y){const b=window.atob(y),x=b.length,A=new Uint8Array(x);for(let C=0;C<x;C++)A[C]=b.charCodeAt(C);return A.buffer}if(e.base64!==void 0)i=a(e.base64);else{if(!e.url)throw new Error("layer: missing url");const y=await fetch(e.url,{headers:e.headers});if(!y.ok)throw Error(y.statusText);i=await y.arrayBuffer()}let s,o=[];if(e.name&&e.name!=="")s=e.name;else{if(!e.url)throw new Error("layer: missing url");try{o=new URL(e.url).pathname.split("/")}catch{o=e.url.split("/")}finally{s=o.slice(-1)[0]}}s.indexOf("?")>-1&&(s=s.slice(0,s.indexOf("?")));let l=.5;"opacity"in e&&(l=e.opacity);let c="warm";"colormap"in e&&(c=e.colormap);let u="winter";"colormapNegative"in e&&(u=e.colormapNegative);let h=!1;"useNegativeCmap"in e&&(h=e.useNegativeCmap);let g=null;"cal_min"in e&&(g=e.cal_min);let v=null;"cal_max"in e&&(v=e.cal_max);const m=await or.readLayer(s,i,n,l,c,u,h,g,v);m&&n.layers.push(m)}static async loadFromUrl({url:e="",headers:n={},gl:i,name:a="",opacity:s=1,rgba255:o=[255,255,255,255],visible:l=!0,layers:c=[],buffer:u=new ArrayBuffer(0)}={}){let h=e.split("/");if(a===""){try{h=new URL(e).pathname.split("/")}catch{h=e.split("/")}a=h.slice(-1)[0],a.indexOf("?")>-1&&(a=a.slice(0,a.indexOf("?")))}if(e==="")throw Error("url must not be empty");if(!i)throw Error("gl context is null");let g;if(u.byteLength>0)g=u;else{const m=await fetch(e,{headers:n});if(!m.ok)throw Error(m.statusText);g=await m.arrayBuffer()}const v=await this.readMesh(g,a,i,s,new Uint8Array(o),l);if(!c||c.length<1)return v;for(let m=0;m<c.length;m++)await qi.loadLayer(c[m],v);return v.updateMesh(i),v}static async readFileAsync(e){return new Promise((n,i)=>{const a=new FileReader;a.onload=()=>{n(a.result)},a.onerror=i,a.readAsArrayBuffer(e)})}static async loadFromFile({file:e,gl:n,name:i="",opacity:a=1,rgba255:s=[255,255,255,255],visible:o=!0,layers:l=[]}={}){if(!e)throw new Error("file must be set");if(!n)throw new Error("rendering context must be set");const c=await qi.readFileAsync(e),u=await qi.readMesh(c,i,n,a,new Uint8Array(s),o);if(!l||l.length<1)return u;for(let h=0;h<l.length;h++)await qi.loadLayer(l[h],u);return u.updateMesh(n),u}async loadFromBase64({base64:e,gl:n,name:i="",opacity:a=1,rgba255:s=[255,255,255,255],visible:o=!0,layers:l=[]}={}){if(!e)throw new Error("base64 must bet set");if(!n)throw new Error("rendering context must be set");function c(g){const v=window.atob(g),m=v.length,y=new Uint8Array(m);for(let b=0;b<m;b++)y[b]=v.charCodeAt(b);return y.buffer}const u=c(e),h=await qi.readMesh(u,i,n,a,new Uint8Array(s),o);if(!l||l.length<1)return h;for(let g=0;g<l.length;g++)await qi.loadLayer(l[g],h);return h.updateMesh(n),h}},mY="data:image/jpeg;base64,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ZwAAAAAAAAALY3JvcFJlY3RUb3Bsb25nAAAAAAA4QklNA+0AAAAAABAASAAAAAEAAQBIAAAAAQABOEJJTQQmAAAAAAAOAAAAAAAAAAAAAD+AAAA4QklNBA0AAAAAAAQAAAAeOEJJTQQZAAAAAAAEAAAAHjhCSU0D8wAAAAAACQAAAAAAAAAAAQA4QklNJxAAAAAAAAoAAQAAAAAAAAABOEJJTQP1AAAAAABIAC9mZgABAGxmZgAGAAAAAAABAC9mZgABAKGZmgAGAAAAAAABADIAAAABAFoAAAAGAAAAAAABADUAAAABAC0AAAAGAAAAAAABOEJJTQP4AAAAAABwAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAADhCSU0EAAAAAAAAAgAAOEJJTQQCAAAAAAACAAA4QklNBDAAAAAAAAEBADhCSU0ELQAAAAAABgABAAAAMjhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAAM9AAAABgAAAAAAAAAAAAACAAAAAgAAAAAEAG0AYwA2ADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAAIAAAAAAFJnaHRsb25nAAACAAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElEbG9uZwAAAAAAAAAGb3JpZ2luZW51bQAAAAxFU2xpY2VPcmlnaW4AAAANYXV0b0dlbmVyYXRlZAAAAABUeXBlZW51bQAAAApFU2xpY2VUeXBlAAAAAEltZyAAAAAGYm91bmRzT2JqYwAAAAEAAAAAAABSY3QxAAAABAAA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bnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDctMTJUMjA6MDc6NDcrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0OGNjMGI3YS1iYTJkLWZmNDAtYmNkNC1jNGQzMzIyZjBiNzQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphYzFjM2NhNS1hYTg4LWI5NGMtOGE4MS05YmU4MjA3ZGZiODciPiA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8cmRmOkJhZz4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6YThjMGNhZTYtODNjYy1hYzQ4LWI2YzAtN2FiODNlOWJkMGM3PC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YWMxYzNjYTUtYWE4OC1iOTRjLThhODEtOWJlODIwN2RmYjg3IiBzdEV2dDp3aGVuPSIyMDE4LTA3LTEyVDIwOjA3OjQ3KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjYmI3MzZlZC0zOTRhLTM2NDgtYThiOC02Mzk1MmY0NDcxMjIiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTY6MTM6NTgrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RFdnQ6d2hlbj0iMjAxOC0wNy0xM1QxNzo1NDoyNyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvanBlZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9qcGVnIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTc6NTQ6MjcrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjg3NjM1NDk5LWZiMTItYWU0MC04NWEzLThkMWFiN2NkZGVhOSIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmFjMWMzY2E1LWFhODgtYjk0Yy04YTgxLTliZTgyMDdkZmI4NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAAAVAAAAAzZGVzYwAAAYQAAABsd3RwdAAAAfAAAAAUYmtwdAAAAgQAAAAUclhZWgAAAhgAAAAUZ1hZWgAAAiwAAAAUYlhZWgAAAkAAAAAUZG1uZAAAAlQAAABwZG1kZAAAAsQAAACIdnVlZAAAA0wAAACGdmlldwAAA9QAAAAkbHVtaQAAA/gAAAAUbWVhcwAABAwAAAAkdGVjaAAABDAAAAAMclRSQwAABDwAAAgMZ1RSQwAABDwAAAgMYlRSQwAABDwAAAgMdGV4dAAAAABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1Q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",PC="data:image/png;base64,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",LC={atlas:{type:"msdf",distanceRange:2,size:59.65625,width:512,height:256,yOrigin:"bottom"},metrics:{emSize:1,lineHeight:1.171875,ascender:.927734375,descender:-.244140625,underlineY:-.09765625,underlineThickness:.048828125},glyphs:[{unicode:32,advance:.24755859375},{unicode:33,advance:.25732421875,planeBounds:{left:.056159633438645884,bottom:-.02437761405677056,right:.20702396031135412,top:.7299440203067705},atlasBounds:{left:488.5,bottom:145.5,right:497.5,top:190.5}},{unicode:34,advance:.31982421875,planeBounds:{left:.049409125974004715,bottom:.48691155587022,right:.2840869677759953,top:.77187750662978},atlasBounds:{left:486.5,bottom:213.5,right:500.5,top:230.5}},{unicode:35,advance:.61572265625,planeBounds:{left:.037219103997511785,bottom:-.02169206718177056,right:.6239137085024882,top:.7326295671817705},atlasBounds:{left:66.5,bottom:51.5,right:101.5,top:96.5}},{unicode:36,advance:.5615234375,planeBounds:{left:.02956531458715296,bottom:-.12381369908983761,right:.5324464041628472,top:.8484230740898377},atlasBounds:{left:109.5,bottom:197.5,right:139.5,top:255.5}},{unicode:37,advance:.732421875,planeBounds:{left:.026481776289942378,bottom:-.030073418674698794,right:.7137525987100576,top:.7410109186746989},atlasBounds:{left:88.5,bottom:144.5,right:129.5,top:190.5}},{unicode:38,advance:.62158203125,planeBounds:{left:.03225572125458355,bottom:-.030073418674698794,right:.6357130287454166,top:.7410109186746989},atlasBounds:{left:130.5,bottom:144.5,right:166.5,top:190.5}},{unicode:39,advance:.17431640625,planeBounds:{left:.028244602049502358,bottom:.49895501673814824,right:.14558352295049765,top:.7671582645118518},atlasBounds:{left:498.5,bottom:62.5,right:505.5,top:78.5}},{unicode:40,advance:.341796875,planeBounds:{left:.042983329377291775,bottom:-.250029542422407,right:.34471198312270823,top:.8227834486724072},atlasBounds:{left:.5,bottom:191.5,right:18.5,top:255.5}},{unicode:41,advance:.34765625,planeBounds:{left:-.003159248747708225,bottom:-.250029542422407,right:.29856940499770823,top:.8227834486724072},atlasBounds:{left:19.5,bottom:191.5,right:37.5,top:255.5}},{unicode:42,advance:.4306640625,planeBounds:{left:-.011208599684062338,bottom:.27785390031593765,right:.44138438093406235,top:.7304468809340623},atlasBounds:{left:449.5,bottom:23.5,right:476.5,top:50.5}},{unicode:43,advance:.56689453125,planeBounds:{left:.01353503347629649,bottom:.053493525733368255,right:.5499415290237036,top:.6066627242666317},atlasBounds:{left:361.5,bottom:17.5,right:393.5,top:50.5}},{unicode:44,advance:.1962890625,planeBounds:{left:-.009919475797210583,bottom:-.15981695975478,right:.1744702570472106,top:.12514899100478},atlasBounds:{left:498.5,bottom:79.5,right:509.5,top:96.5}},{unicode:45,advance:.27587890625,planeBounds:{left:-.00527594412977999,bottom:.24333249267450235,right:.27969000662978,top:.36067141357549765},atlasBounds:{left:52.5,bottom:7.5,right:69.5,top:14.5}},{unicode:46,advance:.26318359375,planeBounds:{left:.051032680313645884,bottom:-.027092319686354116,right:.20189700718635412,top:.12377200718635412},atlasBounds:{left:501.5,bottom:221.5,right:510.5,top:230.5}},{unicode:47,advance:.412109375,planeBounds:{left:-.013733006073205867,bottom:-.08573505127848349,right:.4053345685732059,top:.7356373950284835},atlasBounds:{left:252.5,bottom:206.5,right:277.5,top:255.5}},{unicode:48,advance:.5615234375,planeBounds:{left:.037458384830081196,bottom:-.030073418674698794,right:.5235767714199189,top:.7410109186746989},atlasBounds:{left:167.5,bottom:144.5,right:196.5,top:190.5}},{unicode:49,advance:.5615234375,planeBounds:{left:.06023674350936354,bottom:-.01998308280677056,right:.37872810024063647,top:.7343385515567705},atlasBounds:{left:488.5,bottom:97.5,right:507.5,top:142.5}},{unicode:50,advance:.5615234375,planeBounds:{left:.025334353719224725,bottom:-.01680925468177056,right:.5449781462807752,top:.7375123796817705},atlasBounds:{left:278.5,bottom:51.5,right:309.5,top:96.5}},{unicode:51,advance:.5615234375,planeBounds:{left:.028181041080081196,bottom:-.030073418674698794,right:.5142994276699189,top:.7410109186746989},atlasBounds:{left:197.5,bottom:144.5,right:226.5,top:190.5}},{unicode:52,advance:.5615234375,planeBounds:{left:.005886103858368255,bottom:-.02169206718177056,right:.5590553023916317,top:.7326295671817705},atlasBounds:{left:310.5,bottom:51.5,right:343.5,top:96.5}},{unicode:53,advance:.5615234375,planeBounds:{left:.055524791080081196,bottom:-.02657487968177056,right:.5416431776699189,top:.7277467546817705},atlasBounds:{left:344.5,bottom:51.5,right:373.5,top:96.5}},{unicode:54,advance:.5615234375,planeBounds:{left:.046003306705081196,bottom:-.034712090549698794,right:.5321216932949189,top:.7363722467996989},atlasBounds:{left:227.5,bottom:144.5,right:256.5,top:190.5}},{unicode:55,advance:.5615234375,planeBounds:{left:.018010134969224725,bottom:-.02169206718177056,right:.5376539275307752,top:.7326295671817705},atlasBounds:{left:374.5,bottom:51.5,right:405.5,top:96.5}},{unicode:56,advance:.5615234375,planeBounds:{left:.037702525455081196,bottom:-.030073418674698794,right:.5238209120449189,top:.7410109186746989},atlasBounds:{left:257.5,bottom:144.5,right:286.5,top:190.5}},{unicode:57,advance:.5615234375,planeBounds:{left:.029401744205081196,bottom:-.025434746799698794,right:.5155201307949189,top:.7456495905496989},atlasBounds:{left:287.5,bottom:144.5,right:316.5,top:190.5}},{unicode:58,advance:.2421875,planeBounds:{left:.046394008438645884,bottom:-.029431286627488215,right:.19725833531135412,top:.5572633178774882},atlasBounds:{left:439.5,bottom:61.5,right:448.5,top:96.5}},{unicode:59,advance:.21142578125,planeBounds:{left:.001066852327789419,bottom:-.16459733294591408,right:.1854565851722106,top:.556198895445914},atlasBounds:{left:406.5,bottom:53.5,right:417.5,top:96.5}},{unicode:60,advance:.50830078125,planeBounds:{left:.016948142433865897,bottom:.0726146348300812,right:.4527784200661341,top:.5587330214199189},atlasBounds:{left:394.5,bottom:21.5,right:420.5,top:50.5}},{unicode:61,advance:.548828125,planeBounds:{left:.051535540940937666,bottom:.17620354038436353,right:.5041285215590624,top:.49469489711563647},atlasBounds:{left:477.5,bottom:31.5,right:504.5,top:50.5}},{unicode:62,advance:.5224609375,planeBounds:{left:.047629290940937666,bottom:.0731029160800812,right:.5002222715590624,top:.5592213026699189},atlasBounds:{left:421.5,bottom:21.5,right:448.5,top:50.5}},{unicode:63,advance:.47216796875,planeBounds:{left:.016704001808865897,bottom:-.027876153049698794,right:.4525342794411341,top:.7432081842996989},atlasBounds:{left:317.5,bottom:144.5,right:343.5,top:190.5}},{unicode:64,advance:.89794921875,planeBounds:{left:.034064457306783605,bottom:-.23896750384690937,right:.8721996065996072,top:.7165065663469093},atlasBounds:{left:155.5,bottom:198.5,right:205.5,top:255.5}},{unicode:65,advance:.65234375,planeBounds:{left:-.008838044092129387,bottom:-.02169206718177056,right:.6616700753421295,top:.7326295671817705},atlasBounds:{left:237.5,bottom:51.5,right:277.5,top:96.5}},{unicode:66,advance:.62255859375,planeBounds:{left:.06464099434422473,bottom:-.02169206718177056,right:.5842847869057752,top:.7326295671817705},atlasBounds:{left:205.5,bottom:51.5,right:236.5,top:96.5}},{unicode:67,advance:.65087890625,planeBounds:{left:.038439807122511785,bottom:-.030073418674698794,right:.6251344116274882,top:.7410109186746989},atlasBounds:{left:344.5,bottom:144.5,right:379.5,top:190.5}},{unicode:68,advance:.65576171875,planeBounds:{left:.06301501010836826,bottom:-.02169206718177056,right:.6161842086416317,top:.7326295671817705},atlasBounds:{left:162.5,bottom:51.5,right:195.5,top:96.5}},{unicode:69,advance:.568359375,planeBounds:{left:.0652904160800812,bottom:-.02169206718177056,right:.5514088026699189,top:.7326295671817705},atlasBounds:{left:132.5,bottom:51.5,right:161.5,top:96.5}},{unicode:70,advance:.552734375,planeBounds:{left:.059675181705081196,bottom:-.02169206718177056,right:.5457935682949189,top:.7326295671817705},atlasBounds:{left:102.5,bottom:51.5,right:131.5,top:96.5}},{unicode:71,advance:.68115234375,planeBounds:{left:.040148791497511785,bottom:-.030073418674698794,right:.6268433960024882,top:.7410109186746989},atlasBounds:{left:380.5,bottom:144.5,right:415.5,top:190.5}},{unicode:72,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:30.5,bottom:51.5,right:65.5,top:96.5}},{unicode:73,advance:.27197265625,planeBounds:{left:.06917965680657412,bottom:-.02169206718177056,right:.20328128069342588,top:.7326295671817705},atlasBounds:{left:196.5,bottom:51.5,right:204.5,top:96.5}},{unicode:74,advance:.5517578125,planeBounds:{left:.007184947330081194,bottom:-.02657487968177056,right:.4933033339199188,top:.7277467546817705},atlasBounds:{left:.5,bottom:51.5,right:29.5,top:96.5}},{unicode:75,advance:.626953125,planeBounds:{left:.061633166497511785,bottom:-.02169206718177056,right:.6483277710024882,top:.7326295671817705},atlasBounds:{left:452.5,bottom:97.5,right:487.5,top:142.5}},{unicode:76,advance:.5380859375,planeBounds:{left:.06341786132300943,bottom:-.02169206718177056,right:.5327735449269906,top:.7326295671817705},atlasBounds:{left:423.5,bottom:97.5,right:451.5,top:142.5}},{unicode:77,advance:.873046875,planeBounds:{left:.05911847969322944,bottom:-.02169206718177056,right:.8134401140567705,top:.7326295671817705},atlasBounds:{left:377.5,bottom:97.5,right:422.5,top:142.5}},{unicode:78,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:341.5,bottom:97.5,right:376.5,top:142.5}},{unicode:79,advance:.6875,planeBounds:{left:.033395854136655315,bottom:-.030073418674698794,right:.6536158646133446,top:.7410109186746989},atlasBounds:{left:416.5,bottom:144.5,right:453.5,top:190.5}},{unicode:80,advance:.630859375,planeBounds:{left:.061550166358368255,bottom:-.02169206718177056,right:.6147193648916317,top:.7326295671817705},atlasBounds:{left:273.5,bottom:97.5,right:306.5,top:142.5}},{unicode:81,advance:.6875,planeBounds:{left:.030466166636655315,bottom:-.14391866037519643,right:.6506861771133446,top:.7445045978751964},atlasBounds:{left:214.5,bottom:202.5,right:251.5,top:255.5}},{unicode:82,advance:.61572265625,planeBounds:{left:.06350329135836826,bottom:-.02169206718177056,right:.6166724898916317,top:.7326295671817705},atlasBounds:{left:186.5,bottom:97.5,right:219.5,top:142.5}},{unicode:83,advance:.59326171875,planeBounds:{left:.020778681983368255,bottom:-.030073418674698794,right:.5739478805166317,top:.7410109186746989},atlasBounds:{left:454.5,bottom:144.5,right:487.5,top:190.5}},{unicode:84,advance:.5966796875,planeBounds:{left:.005480822747511787,bottom:-.02169206718177056,right:.5921754272524882,top:.7326295671817705},atlasBounds:{left:112.5,bottom:97.5,right:147.5,top:142.5}},{unicode:85,advance:.6484375,planeBounds:{left:.049098994483368255,bottom:-.02657487968177056,right:.6022681930166317,top:.7277467546817705},atlasBounds:{left:78.5,bottom:97.5,right:111.5,top:142.5}},{unicode:86,advance:.63623046875,planeBounds:{left:-.008269192599201152,bottom:-.02169206718177056,right:.6454762238492011,top:.7326295671817705},atlasBounds:{left:38.5,bottom:97.5,right:77.5,top:142.5}},{unicode:87,advance:.88720703125,planeBounds:{left:.011923628617731797,bottom:-.02169206718177056,right:.8835841838822683,top:.7326295671817705},atlasBounds:{left:220.5,bottom:97.5,right:272.5,top:142.5}},{unicode:88,advance:.626953125,planeBounds:{left:.004098979136655316,bottom:-.02169206718177056,right:.6243189896133446,top:.7326295671817705},atlasBounds:{left:.5,bottom:97.5,right:37.5,top:142.5}},{unicode:89,advance:.6005859375,planeBounds:{left:-.010793598988344685,bottom:-.02169206718177056,right:.6094264114883446,top:.7326295671817705},atlasBounds:{left:148.5,bottom:97.5,right:185.5,top:142.5}},{unicode:90,advance:.5986328125,planeBounds:{left:.024196650733368255,bottom:-.02169206718177056,right:.5773658492666317,top:.7326295671817705},atlasBounds:{left:307.5,bottom:97.5,right:340.5,top:142.5}},{unicode:91,advance:.26513671875,planeBounds:{left:.05437250871693295,bottom:-.17280296457569408,right:.27228764753306706,top:.8329592145756942},atlasBounds:{left:59.5,bottom:195.5,right:72.5,top:255.5}},{unicode:92,advance:.41015625,planeBounds:{left:.0014037126767941326,bottom:-.08573505127848349,right:.4204712873232059,top:.7356373950284835},atlasBounds:{left:278.5,bottom:206.5,right:303.5,top:255.5}},{unicode:93,advance:.26513671875,planeBounds:{left:-.020659233400995285,bottom:-.17280296457569408,right:.2140186084009953,top:.8329592145756942},atlasBounds:{left:94.5,bottom:195.5,right:108.5,top:255.5}},{unicode:94,advance:.41796875,planeBounds:{left:.006855376669722368,bottom:.33229482979472236,right:.40916024833027764,top:.7345997014552776},atlasBounds:{left:486.5,bottom:231.5,right:510.5,top:255.5}},{unicode:95,advance:.451171875,planeBounds:{left:-.017473255794918804,bottom:-.09553469482549765,right:.4686451307949188,top:.021804226075497646},atlasBounds:{left:70.5,bottom:7.5,right:99.5,top:14.5}},{unicode:96,advance:.30908203125,planeBounds:{left:.00391839948107648,bottom:.5860277898277895,right:.2553589442689235,top:.7704175226722105},atlasBounds:{left:36.5,bottom:3.5,right:51.5,top:14.5}},{unicode:97,advance:.5439453125,planeBounds:{left:.028181041080081196,bottom:-.029187146002488215,right:.5142994276699189,top:.5575074585024882},atlasBounds:{left:30.5,bottom:15.5,right:59.5,top:50.5}},{unicode:98,advance:.56103515625,planeBounds:{left:.048932994205081196,bottom:-.032187684160555265,right:.5350513807949189,top:.7724220591605554},atlasBounds:{left:304.5,bottom:207.5,right:333.5,top:255.5}},{unicode:99,advance:.5234375,planeBounds:{left:.024518931705081196,bottom:-.029187146002488215,right:.5106373182949189,top:.5575074585024882},atlasBounds:{left:.5,bottom:15.5,right:29.5,top:50.5}},{unicode:100,advance:.56396484375,planeBounds:{left:.026227916080081196,bottom:-.032187684160555265,right:.5123463026699189,top:.7724220591605554},atlasBounds:{left:334.5,bottom:207.5,right:363.5,top:255.5}},{unicode:101,advance:.52978515625,planeBounds:{left:.026472056705081196,bottom:-.029187146002488215,right:.5125904432949189,top:.5575074585024882},atlasBounds:{left:468.5,bottom:61.5,right:497.5,top:96.5}},{unicode:102,advance:.34716796875,planeBounds:{left:.004575110905578838,bottom:-.022177918535555265,right:.3733545765944212,top:.7824318247855554},atlasBounds:{left:364.5,bottom:207.5,right:386.5,top:255.5}},{unicode:103,advance:.56103515625,planeBounds:{left:.026960337955081196,bottom:-.22888445766762702,right:.5130787245449189,top:.558962582667627},atlasBounds:{left:28.5,bottom:143.5,right:57.5,top:190.5}},{unicode:104,advance:.55078125,planeBounds:{left:.049826556565937666,bottom:-.01892352016762703,right:.5024195371840624,top:.768923520167627},atlasBounds:{left:.5,bottom:143.5,right:27.5,top:190.5}},{unicode:105,advance:.24267578125,planeBounds:{left:.046882289688645884,bottom:-.01680925468177056,right:.19774661656135412,top:.7375123796817705},atlasBounds:{left:498.5,bottom:145.5,right:507.5,top:190.5}},{unicode:106,advance:.23876953125,planeBounds:{left:-.048979545900995285,bottom:-.2324562772148376,right:.1856982959009953,top:.7397804959648377},atlasBounds:{left:140.5,bottom:197.5,right:154.5,top:255.5}},{unicode:107,advance:.5068359375,planeBounds:{left:.044294322330081196,bottom:-.01892352016762703,right:.5304127089199189,top:.768923520167627},atlasBounds:{left:58.5,bottom:143.5,right:87.5,top:190.5}},{unicode:108,advance:.24267578125,planeBounds:{left:.05428707868157412,bottom:-.01892352016762703,right:.18838870256842588,top:.768923520167627},atlasBounds:{left:477.5,bottom:208.5,right:485.5,top:255.5}},{unicode:109,advance:.87646484375,planeBounds:{left:.04430890170737297,bottom:-.024304333502488215,right:.832155942042627,top:.5623902710024882},atlasBounds:{left:116.5,bottom:15.5,right:163.5,top:50.5}},{unicode:110,advance:.5517578125,planeBounds:{left:.049826556565937666,bottom:-.024304333502488215,right:.5024195371840624,top:.5623902710024882},atlasBounds:{left:60.5,bottom:15.5,right:87.5,top:50.5}},{unicode:111,advance:.5703125,planeBounds:{left:.025090213094224725,bottom:-.029187146002488215,right:.5447340056557752,top:.5575074585024882},atlasBounds:{left:193.5,bottom:15.5,right:224.5,top:50.5}},{unicode:112,advance:.56103515625,planeBounds:{left:.048444712955081196,bottom:-.22644305141762702,right:.5345630995449189,top:.561403988917627},atlasBounds:{left:447.5,bottom:208.5,right:476.5,top:255.5}},{unicode:113,advance:.568359375,planeBounds:{left:.025983775455081196,bottom:-.22644305141762702,right:.5121021620449189,top:.561403988917627},atlasBounds:{left:417.5,bottom:208.5,right:446.5,top:255.5}},{unicode:114,advance:.33837890625,planeBounds:{left:.045180595002291775,bottom:-.024304333502488215,right:.34690924874770823,top:.5623902710024882},atlasBounds:{left:449.5,bottom:61.5,right:467.5,top:96.5}},{unicode:115,advance:.515625,planeBounds:{left:.021669814448009427,bottom:-.029187146002488215,right:.4910254980519906,top:.5575074585024882},atlasBounds:{left:164.5,bottom:15.5,right:192.5,top:50.5}},{unicode:116,advance:.32666015625,planeBounds:{left:-.019433670483564695,bottom:-.02877457520298586,right:.3158203892335647,top:.675258950202986},atlasBounds:{left:418.5,bottom:54.5,right:438.5,top:96.5}},{unicode:117,advance:.55126953125,planeBounds:{left:.048117572190937666,bottom:-.034069958502488215,right:.5007105528090624,top:.5526246460024882},atlasBounds:{left:88.5,bottom:15.5,right:115.5,top:50.5}},{unicode:118,advance:.484375,planeBounds:{left:-.002092396419918806,bottom:-.02080579450955998,right:.4840259901699188,top:.5491261070095601},atlasBounds:{left:331.5,bottom:16.5,right:360.5,top:50.5}},{unicode:119,advance:.75146484375,planeBounds:{left:-.002649098431770561,bottom:-.02080579450955998,right:.7516725359317705,top:.5491261070095601},atlasBounds:{left:225.5,bottom:16.5,right:270.5,top:50.5}},{unicode:120,advance:.49560546875,planeBounds:{left:-.0046143729128470395,bottom:-.02080579450955998,right:.4982667166628471,top:.5491261070095601},atlasBounds:{left:300.5,bottom:16.5,right:330.5,top:50.5}},{unicode:121,advance:.47314453125,planeBounds:{left:-.007219349544918806,bottom:-.23645281704262702,right:.4788990370449188,top:.551394223292627},atlasBounds:{left:387.5,bottom:208.5,right:416.5,top:255.5}},{unicode:122,advance:.49560546875,planeBounds:{left:.018007705073009427,bottom:-.02080579450955998,right:.4873633886769906,top:.5491261070095601},atlasBounds:{left:271.5,bottom:16.5,right:299.5,top:50.5}},{unicode:123,advance:.33837890625,planeBounds:{left:.011572188891435306,bottom:-.20234398020069408,right:.3468262486085647,top:.8034181989506942},atlasBounds:{left:73.5,bottom:195.5,right:93.5,top:255.5}},{unicode:124,advance:.24365234375,planeBounds:{left:.06315671142450235,bottom:-.15466084787519643,right:.18049563232549765,top:.7337624103751964},atlasBounds:{left:206.5,bottom:202.5,right:213.5,top:255.5}},{unicode:125,advance:.33837890625,planeBounds:{left:-.010156326733564695,bottom:-.20234398020069408,right:.3250977329835647,top:.8034181989506942},atlasBounds:{left:38.5,bottom:195.5,right:58.5,top:255.5}},{unicode:126,advance:.68017578125,planeBounds:{left:.046984728997511785,bottom:.1766063915990047,right:.6336793335024882,top:.4112842334009953},atlasBounds:{left:.5,bottom:.5,right:35.5,top:14.5}}],kerning:[]},vd={name:"untitled connectome",nodeColormap:"warm",nodeColormapNegative:"winter",nodeMinColor:0,nodeMaxColor:4,nodeScale:3,edgeColormap:"warm",edgeColormapNegative:"winter",edgeMin:2,edgeMax:6,edgeScale:1,legendLineThickness:0,showLegend:!0},md=class qT extends Il{constructor(e,n){super(new Float32Array([]),new Uint32Array([]),n.name,new Uint8Array([]),1,!0,e,n),j(this,"gl"),j(this,"nodesChanged"),this.gl=e,this.type="connectome",this.nodes&&this.updateLabels(),this.nodesChanged=new EventTarget}static convertLegacyConnectome(e){const n={nodes:[],edges:[],...vd};for(const a in e)if(a in vd){const s=a;n[s]=e[s]}const i=e.nodes;for(let a=0;a<i.names.length;a++)n.nodes.push({name:i.names[a],x:i.X[a],y:i.Y[a],z:i.Z[a],colorValue:i.Color[a],sizeValue:i.Size[a]});for(let a=0;a<i.names.length-1;a++)for(let s=a+1;s<i.names.length;s++){const o=e.edges[a*i.names.length+s];n.edges.push({first:a,second:s,colorValue:o})}return n}static convertFreeSurferConnectome(e,n="warm"){let i=!0;if("data_type"in e?e.data_type!=="fs_pointset"&&(i=!1):i=!1,"points"in e||(i=!1),!i)throw Error("not a valid FreeSurfer json pointset");const a=e.points.map(o=>({name:Array.isArray(o.comments)&&o.comments.length>0&&"text"in o.comments[0]?o.comments[0].text:"",x:o.coordinates.x,y:o.coordinates.y,z:o.coordinates.z,colorValue:1,sizeValue:1,metadata:o.comments}));return{...vd,nodeColormap:n,edgeColormap:n,nodes:a,edges:[]}}updateLabels(){const e=this.nodes;if(e&&e.length>0){const n=e.reduce((u,h)=>u.sizeValue>h.sizeValue?u:h).sizeValue;let i,a;if(typeof this.nodeMinColor<"u"&&isFinite(this.nodeMinColor))i=this.nodeMinColor;else{i=e[0].colorValue;for(let u=1;u<e.length;u++)e[u].colorValue<i&&(i=e[u].colorValue)}if(typeof this.nodeMaxColor<"u"&&isFinite(this.nodeMaxColor))a=this.nodeMaxColor;else{a=e[0].colorValue;for(let u=1;u<e.length;u++)e[u].colorValue>a&&(a=e[u].colorValue)}const s=Vt.colormap(this.nodeColormap,this.colormapInvert),o=Vt.colormap(this.nodeColormapNegative,this.colormapInvert),l="nodeColormapNegative"in this;let c=this.legendLineThickness?this.legendLineThickness:0;this.showLegend===!1&&(c=0);for(let u=0;u<e.length;u++){let h=e[u].colorValue,g=!1;if(l&&h<0&&(g=!0,h=-h),i<a){if(h<i){Z.warn("color value lower than min");continue}h=(h-i)/(a-i)}else h=1;h=Math.round(Math.max(Math.min(255,h*255)))*4;let v=[s[h],s[h+1],s[h+2],255];g&&(v=[o[h],o[h+1],o[h+2],255]),v=v.map(m=>m/255),Z.debug("adding label for ",e[u]),e[u].label=new Dy(e[u].name,{textColor:v,bulletScale:e[u].sizeValue/n,bulletColor:v,lineWidth:c,lineColor:v,textScale:1,textAlignment:"left",lineTerminator:"none"},[e[u].x,e[u].y,e[u].z]),Z.debug("label for node:",e[u].label)}}}addConnectomeNode(e){if(Z.debug("adding node",e),!this.nodes)throw new Error("nodes not defined");this.nodes.push(e),this.updateLabels(),this.nodesChanged.dispatchEvent(new CustomEvent("nodeAdded",{detail:{node:e}}))}deleteConnectomeNode(e){const n=this.nodes.indexOf(e),i=this.edges;i&&(this.edges=i.filter(a=>a.first!==n&&a.second!==n)),this.nodes=this.nodes.filter(a=>a!==e),this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeDeleted",{detail:{node:e}}))}updateConnectomeNodeByIndex(e,n){this.nodes[e]=n,this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeChanged",{detail:{node:n}}))}updateConnectomeNodeByPoint(e,n){const i=this.nodes;if(!i)throw new Error("Node to update does not exist");const a=i.find(o=>qe.arraysAreEqual([o.x,o.y,o.z],e));if(!a)throw new Error(`Node with point ${e} to update does not exist`);const s=i.findIndex(o=>o===a);this.updateConnectomeNodeByIndex(s,n)}addConnectomeEdge(e,n,i){const a=this.edges;let s=a.find(o=>(o.first===e||o.second===e)&&o.first+o.second===e+n);return s||(s={first:e,second:n,colorValue:i},a.push(s),this.updateConnectome(this.gl),s)}deleteConnectomeEdge(e,n){const i=this.edges,a=i.find(s=>(s.first===e||s.first===n)&&s.first+s.second===e+n);if(a)this.edges=i.filter(s=>s!==a);else throw new Error(`edge between ${e} and ${n} not found`);return this.updateConnectome(this.gl),a}findClosestConnectomeNode(e,n){const i=this.nodes;if(!i||i.length===0)return null;const a=i.map((s,o)=>({node:s,distance:Math.sqrt(Math.pow(s.x-e[0],2)+Math.pow(s.y-e[1],2)+Math.pow(s.z-e[2],2)),index:o})).filter(s=>s.distance<n).sort((s,o)=>s.distance-o.distance);return a.length>0?a[0].node:null}updateConnectome(e){const n=[],i=[],a=[];let s=Vt.colormap(this.nodeColormap,this.colormapInvert),o=Vt.colormap(this.nodeColormapNegative,this.colormapInvert),l="nodeColormapNegative"in this;this.nodeMinColor===void 0&&(this.nodeMinColor=NaN),this.nodeMaxColor===void 0&&(this.nodeMaxColor=NaN),this.edgeMin===void 0&&(this.edgeMin=NaN),this.edgeMax===void 0&&(this.edgeMax=NaN);let c=this.nodeMinColor,u=this.nodeMaxColor;if(!isFinite(c)||!isFinite(c)){const A=this.nodes;c=A[0].colorValue,u=A[0].colorValue;for(let C=0;C<A.length;C++)c=Math.min(c,A[C].colorValue),u=Math.max(u,A[C].colorValue)}const h=this.nodes,g=h.length;for(let A=0;A<g;A++){const C=h[A].sizeValue*this.nodeScale;if(C<=0)continue;let E=h[A].colorValue,S=!1;if(l&&E<0&&(S=!0,E=-E),c<u){if(E<c)continue;E=(E-c)/(u-c)}else E=1;E=Math.round(Math.max(Math.min(255,E*255)))*4;let M=[s[E],s[E+1],s[E+2],255];S&&(M=[o[E],o[E+1],o[E+2],255]);const R=Me(h[A].x,h[A].y,h[A].z);Ro.makeColoredSphere(i,n,a,C,R,M)}s=Vt.colormap(this.edgeColormap,this.colormapInvert),o=Vt.colormap(this.edgeColormapNegative,this.colormapInvert),l="edgeColormapNegative"in this;const v=this.edges;if(v!==void 0&&v.length>0){if(c=this.edgeMin,u=this.edgeMax,!isFinite(c)||!isFinite(c)){c=v[0].colorValue,u=v[0].colorValue;for(let A=0;A<v.length;A++)c=Math.min(c,v[A].colorValue),u=Math.max(u,v[A].colorValue)}for(const A of v){let C=A.colorValue;const E=l&&C<0;E&&(C=-C);const S=C*this.edgeScale;if(S<=0)continue;if(c<u){if(C<c)continue;C=(C-c)/(u-c)}else C=1;C=Math.round(Math.max(Math.min(255,C*255)))*4;let M=[s[C],s[C+1],s[C+2],255];E&&(M=[o[C],o[C+1],o[C+2],255]);const R=Me(h[A.first].x,h[A.first].y,h[A.first].z),T=Me(h[A.second].x,h[A.second].y,h[A.second].z);Ro.makeColoredCylinder(i,n,a,R,T,S,M)}}const m=new Float32Array(i),y=new Uint32Array(n),b=ho.getExtents(m);this.furthestVertexFromOrigin=b.mxDx,this.extentsMin=b.extentsMin,this.extentsMax=b.extentsMax;const x=this.generatePosNormClr(m,y,new Uint8Array(a));e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(y),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Float32Array.from(x),e.STATIC_DRAW),this.indexCount=n.length}updateMesh(e){this.updateConnectome(e),this.updateLabels()}json(){const e={};for(const n in this)(n in vd||n==="nodes"||n==="edges")&&(e[n]=this[n]);return e}static async loadConnectomeFromUrl(e,n){const a=await(await fetch(n)).json();return new qT(e,a)}};function pY(r,e,n){if(!r.dimsRAS||!r.matRAS||!r.pixDimsRAS||!r.vox2mm)throw new Error("Cannot create NiivueObject3D: Missing required RAS properties or vox2mm access on NVImage.");const i=r.dimsRAS,a=r.matRAS,s=r.pixDimsRAS,o=-.5,l=-.5,c=-.5,u=i[1]-1+.5,h=i[2]-1+.5,g=i[3]-1+.5,v=r.vox2mm,m=v.call(r,[o,l,c],a),y=v.call(r,[o,h,c],a),b=v.call(r,[o,l,g],a),x=v.call(r,[o,h,g],a),A=v.call(r,[u,l,c],a),C=v.call(r,[u,h,c],a),E=v.call(r,[u,l,g],a),S=v.call(r,[u,h,g],a),M=[...b,0,0,1,...E,1,0,1,...S,1,1,1,...x,0,1,1,...m,0,0,0,...y,0,1,0,...C,1,1,0,...A,1,0,0],R=n.createBuffer();if(!R)throw new Error("Failed to create GL index buffer");n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,R);const T=[0,3,2,2,1,0,4,7,6,6,5,4,5,6,2,2,3,5,4,0,1,1,7,4,7,1,2,2,6,7,4,5,3,3,0,4];n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(T),n.STATIC_DRAW);const B=n.createBuffer();if(!B)throw new Error("Failed to create GL vertex buffer");n.bindBuffer(n.ARRAY_BUFFER,B),n.bufferData(n.ARRAY_BUFFER,new Float32Array(M),n.STATIC_DRAW);const F=n.createVertexArray();if(!F)throw new Error("Failed to create GL VAO");n.bindVertexArray(F),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,R),n.bindBuffer(n.ARRAY_BUFFER,B);const I=24;n.enableVertexAttribArray(0),n.vertexAttribPointer(0,3,n.FLOAT,!1,I,0),n.enableVertexAttribArray(1),n.vertexAttribPointer(1,3,n.FLOAT,!1,I,12),n.bindVertexArray(null);const U=new Ro(e,B,n.TRIANGLES,T.length,R,F),k=[...b,...E,...S,...x,...m,...y,...C,...A],O=aY(k);return U.extentsMin=O.min.slice(),U.extentsMax=O.max.slice(),U.furthestVertexFromOrigin=O.furthestVertexFromOrigin,U.originNegate=Ri(O.origin),ez(U.originNegate,U.originNegate),U.fieldOfViewDeObliqueMM=[i[1]*s[1],i[2]*s[2],i[3]*s[3]],U}function yY(r){const e=r.length;let n=0;const i=new Uint8Array(e+Math.ceil(.01*e)),a=new Int8Array(i.buffer);let s=0;for(;n<e;){let o=r[n];n++;let l=1;for(;l<129&&n<e&&r[n]===o;)n++,l++;if(l>1){a[s]=-l+1,s++,i[s]=o,s++;continue}for(;n<e&&!(l>127||n+2<e&&o!==r[n]&&r[n+2]===r[n]&&r[n+1]===r[n]);)o=r[n],n++,l++;i[s]=l-1,s++;for(let c=0;c<l;c++)i[s]=r[n-l+c],s++}return Z.debug("PackBits "+e+" -> "+s+" bytes (x"+e/s+")"),i.slice(0,s)}function g2(r,e){const n=new Uint8Array(r.buffer),i=new Int8Array(n.buffer);let a=0;const s=new Uint8Array(e);let o=0;for(;a<n.length;){const l=i[a];if(a++,l<0){const c=i[a];a++;for(let u=0;u<1-l;u++)s[o]=c,o++}else for(let c=0;c<l+1;c++)s[o]=i[a],a++,o++}return s}var AY=({drawUndoBitmaps:r,currentDrawUndoBitmap:e,drawBitmap:n})=>{const i=r.length;if(i<1){Z.debug("undo bitmaps not loaded");return}if(e--,e<0&&(e=i-1),e>=i&&(e=0),r[e].length<2){Z.debug("drawUndo is misbehaving");return}return n=g2(r[e],n.length),{drawBitmap:n,currentDrawUndoBitmap:e}};function xY(r,e,n){const{dimX:i,dimY:a,dimZ:s}=n;let o;if(r===0)o=s;else if(r===1)o=a;else if(r===2)o=i;else return null;let l=-1,c=-1;for(let u=0;u<o;u++){let h=!1;if(r===0){const g=u*i*a;for(let v=0;v<i*a;v++)if(e[g+v]>0){h=!0;break}}else if(r===1)for(let g=0;g<s;g++){for(let v=0;v<i;v++){const m=v+u*i+g*i*a;if(e[m]>0){h=!0;break}}if(h)break}else if(r===2)for(let g=0;g<s;g++){for(let v=0;v<a;v++){const m=u+v*i+g*i*a;if(e[m]>0){h=!0;break}}if(h)break}h&&(l===-1&&(l=u),c=u)}return l===-1||c===-1?null:{first:l,last:c}}function up(r,e,n,i){const{dimX:a,dimY:s,dimZ:o}=i;let l;if(e===0){l=new Float32Array(a*s);const c=r*a*s;for(let u=0;u<a*s;u++)l[u]=n[c+u]}else if(e===1){l=new Float32Array(a*o);for(let c=0;c<o;c++)for(let u=0;u<a;u++){const h=u+r*a+c*a*s,g=u+c*a;l[g]=n[h]}}else if(e===2){l=new Float32Array(s*o);for(let c=0;c<o;c++)for(let u=0;u<s;u++){const h=r+u*a+c*a*s,g=u+c*s;l[g]=n[h]}}else throw new Error("Invalid slice type");return l}function cp(r,e,n,i,a){const{dimX:s,dimY:o,dimZ:l}=i;let c;if(e===0){c=new Float32Array(s*o);const u=r*s*o;for(let h=0;h<s*o;h++)c[h]=n[u+h]/a}else if(e===1){c=new Float32Array(s*l);for(let u=0;u<l;u++)for(let h=0;h<s;h++){const g=h+r*s+u*s*o,v=h+u*s;c[v]=n[g]/a}}else if(e===2){c=new Float32Array(o*l);for(let u=0;u<l;u++)for(let h=0;h<o;h++){const g=r+h*s+u*s*o,v=h+u*o;c[v]=n[g]/a}}else throw new Error("Invalid slice type");return c}function bY(r,e,n,i,a,s,o){const{dimX:l,dimY:c,dimZ:u}=a;if(n===0){const h=e*l*c;for(let g=0;g<r.length;g++)r[g]>=s&&(i[h+g]=o)}else if(n===1)for(let h=0;h<u;h++)for(let g=0;g<l;g++){const v=g+h*l,m=g+e*l+h*l*c;r[v]>=s&&(i[m]=o)}else if(n===2)for(let h=0;h<u;h++)for(let g=0;g<c;g++){const v=g+h*c,m=e+g*l+h*l*c;r[v]>=s&&(i[m]=o)}else throw new Error("Invalid slice type")}function _C(r,e,n){if(e<3||n<3)return;const i=new Float32Array(r.length);for(let a=0;a<n;a++)for(let s=0;s<e;s++){const o=s+a*e;s===0||s===e-1?i[o]=r[o]:i[o]=(r[o-1]+2*r[o]+r[o+1])*.25}for(let a=0;a<n;a++)for(let s=0;s<e;s++){const o=s+a*e;a===0||a===n-1?r[o]=i[o]:r[o]=(i[o-e]+2*i[o]+i[o+e])*.25}}function wY(r,e,n,i){const a=Math.abs(n-r),s=Math.abs(n-e),o=Math.exp(-a*a/(2*i*i)),l=Math.exp(-s*s/(2*i*i)),c=o+l;return c<1e-6?.5:o/c}function CY(r,e,n,i,a,s){const o=(n-i)/(a-i),l=1-o;for(let c=0;c<r.length;c++)s[c]=r[c]*l+e[c]*o}function EY(r,e,n,i,a,s,o,l,c,u){const h=(n-i)/(a-i),g=1-h;for(let v=0;v<r.length;v++)if(r[v]>0||e[v]>0){const m=wY(l[v],c[v],u[v],o.intensitySigma),y=o.intensityWeight,b=y*m+(1-y)*g,x=1-b;s[v]=r[v]*b+e[v]*x}else s[v]=r[v]*g+e[v]*h}function SY(r,e,n,i,a,s,o,l){const{dimX:c,dimY:u,dimZ:h}=e,g=o.sliceType??0;let v,m,y;if(g===0)v=c,m=u,y=h-1;else if(g===1)v=c,m=h,y=u-1;else if(g===2)v=u,m=h,y=c-1;else throw new Error("Invalid slice type. Must be AXIAL, CORONAL, or SAGITTAL");const b={intensityWeight:o.intensityWeight??.7,binaryThreshold:o.binaryThreshold??.375,intensitySigma:o.intensitySigma??.1,applySmoothingToSlices:o.applySmoothingToSlices??!0,useIntensityGuided:o.useIntensityGuided??!0};if(a!==void 0&&s!==void 0){if(a>=s)throw new Error("Low slice index must be less than high slice index");if(a<0||s>y)throw new Error(`Slice indices out of bounds [0, ${y}]`)}const x=new Map;for(let A=0;A<=y;A++){const C=up(A,g,r,e);for(let E=0;E<C.length;E++){const S=C[E];if(S>0)if(!x.has(S))x.set(S,{min:A,max:A});else{const M=x.get(S);M.min=Math.min(M.min,A),M.max=Math.max(M.max,A)}}}for(const[A,C]of x){const E=a!==void 0?Math.max(a,C.min):C.min,S=s!==void 0?Math.min(s,C.max):C.max;if(E>=S||S-E<2)continue;const M=up(E,g,r,e),R=up(S,g,r,e),T=new Float32Array(M.length),B=new Float32Array(R.length);for(let F=0;F<M.length;F++)T[F]=M[F]===A?1:0,B[F]=R[F]===A?1:0;b.applySmoothingToSlices&&(_C(T,v,m),_C(B,v,m));for(let F=E+1;F<S;F++){const I=new Float32Array(v*m);if(b.useIntensityGuided&&n){const U=cp(E,g,n,e,i),k=cp(S,g,n,e,i),O=cp(F,g,n,e,i);EY(T,B,F,E,S,I,b,U,k,O)}else CY(T,B,F,E,S,I);bY(I,F,g,r,e,b.binaryThreshold,A)}}l()}var fc=`#version 300 es
#line 4
layout(location=0) in vec3 pos;
layout(location=1) in vec3 texCoords;
uniform mat4 mvpMtx;
out vec3 vColor;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vColor = texCoords;
}`,Ry=`
	vec4 drawColor(float scalar, float drawOpacity) {
		float nlayer = float(textureSize(colormap, 0).y);
		float layer = (nlayer - 0.5) / nlayer;
		vec4 dcolor = texture(colormap, vec2((scalar * 255.0)/256.0 + 0.5/256.0, layer)).rgba;
		dcolor.a *= drawOpacity;
		return dcolor;
}`,wf=`vec3 GetBackPosition(vec3 startPositionTex) {
	vec3 startPosition = startPositionTex * volScale;
	vec3 invR = 1.0 / rayDir;
	vec3 tbot = invR * (vec3(0.0)-startPosition);
	vec3 ttop = invR * (volScale-startPosition);
	vec3 tmax = max(ttop, tbot);
	vec2 t = min(tmax.xx, tmax.yz);
	vec3 endPosition = startPosition + (rayDir * min(t.x, t.y));
	//convert world position back to texture position:
	endPosition = endPosition / volScale;
	return endPosition;
}

vec4 applyClip (vec3 dir, inout vec4 samplePos, inout float len, inout bool isClip) {
	float cdot = dot(dir,clipPlane.xyz);
	isClip = false;
	if  ((clipPlane.a > 1.0) || (cdot == 0.0)) return samplePos;
	bool frontface = (cdot > 0.0);
	float dis = (-clipPlane.a - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	float thick = clipThick;
	if (thick <= 0.0) thick = 2.0;
	float  disBackFace = (-(clipPlane.a-thick) - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	if (((frontface) && (dis >= len)) || ((!frontface) && (dis <= 0.0))) {
		samplePos.a = len + 1.0;
		return samplePos;
	}
	if (frontface) {
		dis = max(0.0, dis);
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		if (dis > 0.0) isClip = true;
		len = min(disBackFace, len);
	}
	if (!frontface) {
		len = min(dis, len);
		disBackFace = max(0.0, disBackFace);
		if (len == dis) isClip = true;
		samplePos = vec4(samplePos.xyz+dir * disBackFace, disBackFace);
	}
	return samplePos;
}

void clipVolume(inout vec3 startPos, inout vec3 backPos, int dim, float frac, bool isLo) {
	vec3 dir = backPos - startPos;
	float len = length(dir);
	dir = normalize(dir);
	// Discard if both startPos and backPos are outside the clipping plane
	if (isLo && startPos[dim] < frac && backPos[dim] < frac) {
		discard;
	}
	if (!isLo && startPos[dim] > frac && backPos[dim] > frac) {
		discard;
	}
	vec4 plane = vec4(0.0, 0.0, 0.0, 0.5 - frac);
	plane[dim] = 1.0;
	float cdot = dot(dir, plane.xyz);
	float dis = (-plane.w - dot(plane.xyz, startPos - vec3(0.5))) / cdot;
	// Adjust startPos or backPos based on the intersection with the plane
	bool isFrontFace = (cdot > 0.0);
	if (!isLo)
		isFrontFace = !isFrontFace;
	if (dis > 0.0) {
		if (isFrontFace) {
				if (dis <= len) {
					startPos = startPos + dir * dis;
				}
		} else {
			if (dis < len) {
				backPos = startPos + dir * dis;
			}
		}
	}
}

void clipVolumeStart (inout vec3 startPos, inout vec3 backPos) {
	// vec3 clipLo = vec3(0.1, 0.2, 0.4);
	// vec3 clipHi = vec3(0.8, 0.7, 0.7);
	for (int i = 0; i < 3; i++) {
		if (clipLo[i] > 0.0)
			clipVolume(startPos, backPos, i, clipLo[i], true);
	}
	for (int i = 0; i < 3; i++) {
		if (clipHi[i] < 1.0)
			clipVolume(startPos, backPos, i, clipHi[i], false);
	}
}

float frac2ndc(vec3 frac) {
//https://stackoverflow.com/questions/7777913/how-to-render-depth-linearly-in-modern-opengl-with-gl-fragcoord-z-in-fragment-sh
	vec4 pos = vec4(frac.xyz, 1.0); //fraction
	vec4 dim = vec4(vec3(textureSize(volume, 0)), 1.0);
	pos = pos * dim;
	vec4 shim = vec4(-0.5, -0.5, -0.5, 0.0);
	pos += shim;
	vec4 mm = transpose(matRAS) * pos;
	float z_ndc = (mvpMtx * vec4(mm.xyz, 1.0)).z;
	return (z_ndc + 1.0) / 2.0;
}`+Ry,By=`void main() {
	if (fColor.x > 2.0) {
		fColor = vec4(1.0, 0.0, 0.0, 0.5);
		return;
	}
	fColor = vec4(0.0,0.0,0.0,0.0);
	vec4 clipPlaneColorX = clipPlaneColor;
	//if (clipPlaneColor.a < 0.0)
	//	clipPlaneColorX.a = - 1.0;
	bool isColorPlaneInVolume = false;
	if (clipPlaneColorX.a < 0.0) {
		isColorPlaneInVolume = true;
		clipPlaneColorX.a = 0.0;
	}
	//fColor = vec4(vColor.rgb, 1.0); return;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	// fColor = vec4(backPosition, 1.0); return;
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	dir = normalize(dir);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	//if ((clipPos.a != samplePos.a) && (len < 3.0)) {
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	float drawOpacityA = renderDrawAmbientOcclusionXY.y;
	if ((samplePos.a >= len) && (((overlays < 1.0) && (drawOpacityA <= 0.0) ) || (backgroundMasksOverlays > 0)))  {
		if (isClip)
			fColor += clipPlaneColorX;
		return;
	}
	fColor = vec4(1.0, 1.0, 1.0, 1.0);
	//gl_FragDepth = frac2ndc(samplePos.xyz); //crude due to fast pass resolution
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * lenNoClip);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`,W0=`
	if (firstHit.a < len) {
		gl_FragDepth = frac2ndc(firstHit.xyz);
		vec4 paqdSample = texture(paqd, samplePos.xyz);
		if (paqdSample.a > 0.0) {
			//colAcc.rgb = paqdSample.rgb;
			float a = max(abs(paqdUniforms[2]), abs(paqdUniforms[3]));
			colAcc.rgb = mix(colAcc.rgb, paqdSample.rgb, 0.5 * paqdSample.a * a);
		}
		
	}
	colAcc.a = (colAcc.a / earlyTermination) * backOpacity;
	fColor = colAcc;
	//if (isClip) //CR
	if ((isColorPlaneInVolume) && (clipPos.a != samplePos.a) && (abs(firstHit.a - clipPos.a) < deltaDir.a))
		fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, abs(clipPlaneColor.a));
		//fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, clipPlaneColorX.a * 0.65);
	float renderDrawAmbientOcclusionX = renderDrawAmbientOcclusionXY.x;
	float drawOpacity = renderDrawAmbientOcclusionXY.y;
	if ((overlays < 1.0) && (drawOpacity <= 0.0))
		return;
	//overlay pass
	len = lenNoClip;
	samplePos = vec4(start.xyz, 0.0); //ray position
	//start: OPTIONAL fast pass: rapid traversal until first hit
	stepSizeFast = sliceSize * 1.0;
	deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (drawOpacity > 0.0)
			val = max(val, texture(drawing, samplePos.xyz).r);
		if (val > 0.001)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	if (samplePos.a >= len) {
		if (isClip && (fColor.a == 0.0))
				fColor += clipPlaneColorX;
			return;
	}
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	float overFarthest = len;
	colAcc = vec4(0.0, 0.0, 0.0, 0.0);

	samplePos += deltaDir * ran; //jitter ray
	vec4 overFirstHit = vec4(0.0,0.0,0.0,2.0 * len);
	if (backgroundMasksOverlays > 0)
		samplePos = firstHit;
	bool firstDraw = true;
	while (samplePos.a <= len) {
		vec4 colorSample = texture(overlay, samplePos.xyz);
		if ((colorSample.a < 0.01) && (drawOpacity > 0.0)) {
			float val = texture(drawing, samplePos.xyz).r;
			vec4 draw = drawColor(val, drawOpacity);
			if ((draw.a > 0.0) && (firstDraw)) {
				firstDraw = false;
				float sum = 0.0;
				const float mn = 1.0 / 256.0;
				const float sampleRadius = 1.1;
				float dx = sliceSize * sampleRadius;
				vec3 center = samplePos.xyz;
				//six neighbors that share a face
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,0.0), dir)).r, mn);
				//float proportion = (sum / mn) / 6.0;
				
				//12 neighbors that share an edge
				dx = sliceSize * sampleRadius * sqrt(2.0) * 0.5;
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,-dx,0.0), dir)).r, mn);

				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,-dx,0.0), dir)).r, mn);
				
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,+dx,0.0), dir)).r, mn);
				float proportion = (sum / mn) / 18.0; //proportion of six neighbors is non-zero
				
				//a high proportion of hits means crevice
				//since the AO term adds shadows that darken most voxels, it will result in dark surfaces
				//the term brighten adds a little illumination to balance this
				// without brighten, only the most extreme ridges will not be darker
				const float brighten = 1.2;
				vec3 ao = draw.rgb * (1.0 - proportion) * brighten;
				draw.rgb = mix (draw.rgb, ao , renderDrawAmbientOcclusionX);
			}
			colorSample = draw;
		}
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (overFirstHit.a > len)
				overFirstHit = samplePos;
			colorSample.a *= renderOverlayBlend;
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			overFarthest = samplePos.a;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
	//if (samplePos.a >= len) {
	if (colAcc.a <= 0.0) {
		if (isClip && (fColor.a == 0.0))
			fColor += clipPlaneColorX;
		return;
	}
	if (overFirstHit.a < firstHit.a)
		gl_FragDepth = frac2ndc(overFirstHit.xyz);
	float overMix = colAcc.a;
	float overlayDepth = 0.3;
	if (fColor.a <= 0.0)
		overMix = 1.0;
	else if (((overFarthest) > backNearest)) {
		float dx = (overFarthest - backNearest)/1.73;
		dx = fColor.a * pow(dx, overlayDepth);
		overMix *= 1.0 - dx;
	}
	fColor.rgb = mix(fColor.rgb, colAcc.rgb, overMix);
	fColor.a = max(fColor.a, colAcc.a);
}`,TY=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+wf+`
	void main() {
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		fColor = vec4(0.0,0.0,0.0,0.0);
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * len);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float dis = len;
	//check if axial plane is closest
	vec4 aClip = vec4(0.0, 0.0, 1.0, (1.0- clipPlane.z) - 0.5);
	float adis = (-aClip.a - dot(aClip.xyz, samplePos.xyz-0.5)) / dot(dir,aClip.xyz);
	if (adis > 0.0)
		dis = min(adis, dis);
	//check of coronal plane is closest
	vec4 cClip = vec4(0.0, 1.0, 0.0, (1.0- clipPlane.y) - 0.5);
	float cdis = (-cClip.a - dot(cClip.xyz, samplePos.xyz-0.5)) / dot(dir,cClip.xyz);
	if (cdis > 0.0)
		dis = min(cdis, dis);
	//check if coronal slice is closest
	vec4 sClip = vec4(1.0, 0.0, 0.0, (1.0- clipPlane.x) - 0.5);
	float sdis = (-sClip.a - dot(sClip.xyz, samplePos.xyz-0.5)) / dot(dir,sClip.xyz);
	if (sdis > 0.0)
		dis = min(sdis, dis);
	if ((dis > 0.0) && (dis < len)) {
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		colAcc = texture(volume, samplePos.xyz);
		colAcc.a = earlyTermination;
		firstHit = samplePos;
		backNearest = min(backNearest, samplePos.a);
	}
	//the following are only used by overlays
	vec4 clipPlaneColorX = clipPlaneColor;
	bool isColorPlaneInVolume = false;
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`+W0,MY=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+wf+By+`while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
`+W0,Uc=192,YT=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 normMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing, gradient;
uniform highp sampler2D colormap;
uniform highp sampler2D matCap;
uniform vec2 renderDrawAmbientOcclusionXY;
uniform float gradientAmount;
uniform float silhouettePower;
uniform float gradientOpacity[${Uc}];
in vec3 vColor;
out vec4 fColor;
`,DY=YT+wf+By+`
	float startPos = samplePos.a;
	float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	float silhouetteThreshold = 1.0 - silhouettePower;
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			grad.rgb = normalize(grad.rgb*2.0 - 1.0);
			//if (grad.a < prevGrad.a)
			//	grad.rgb = prevGrad.rgb;
			//prevGrad = grad;
			vec3 n = mat3(normMtx) * grad.rgb;
			n.y = - n.y;
			vec4 mc = vec4(texture(matCap, n.xy * 0.5 + 0.5).rgb, 1.0) * brighten;
			mc = mix(vec4(1.0), mc, gradientAmount);
			if (samplePos.a > clipClose)
				colorSample.rgb *= mc.rgb;
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			int gradIdx = int(grad.a * ${Uc}.0);
			colorSample.a *= gradientOpacity[gradIdx];
			float lightNormDot = dot(grad.rgb, rayDir);
			// n.b. "lightNormDor" is cosTheta, "silhouettePower" is Fresnel effect exponent
 			colorSample.a *= pow(1.0 - abs(lightNormDot), silhouettePower);
 			float viewAlign = abs(lightNormDot); // 0 = perpendicular, 1 = aligned
 			// linearly map silhouettePower (0..1) to a threshold range, e.g., [1.0, 0.0]
 			// Cull voxels that are too aligned with the view direction
 			if (viewAlign > silhouetteThreshold)
 				colorSample.a = 0.0;
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+W0,RY=YT+wf+By+`
	float startPos = samplePos.a;
	float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			colorSample.rgb = abs(normalize(grad.rgb*2.0 - 1.0));
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+W0,pd=`#version 300 es
#line 392
layout(location=0) in vec3 pos;
uniform int axCorSag;
uniform mat4 mvpMtx;
uniform mat4 frac2mm;
uniform float slice;
out vec3 texPos;
void main(void) {
	texPos = vec3(pos.x, pos.y, slice);
	if (axCorSag > 1)
		texPos = vec3(slice, pos.x, pos.y);
	else if (axCorSag > 0)
		texPos = vec3(pos.x, slice, pos.y);
	vec4 mm = frac2mm * vec4(texPos, 1.0);
	gl_Position = mvpMtx * mm;
}`,jT=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform float drawRimOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;
`+Ry+`
vec4 blendRGBA(vec4 foreground, vec4 background) {
  float alphaOut = foreground.a + background.a * (1.0 - foreground.a);
  vec3 colorOut = (foreground.rgb * foreground.a + background.rgb * background.a * (1.0 - foreground.a)) / alphaOut;
  return vec4(colorOut, alphaOut);
}
float paqdEaseAlpha(float alpha) {
  // t are alpha transitions
  // <t0 -> y0
  // t0..t1  -> mix between y0..y1
  // t1..t2 -> mix between y1..y2
  // >t2 -> y2
  float t0 = paqdUniforms[0]; // 0.3;
  float t1 = 0.5 * (paqdUniforms[0] + paqdUniforms[1]); // 0.4;
  float t2 = paqdUniforms[1]; // 0.9;
  float y0 = 0.0;
  float y1 = abs(paqdUniforms[2]); // 1.0;
  float y2 = abs(paqdUniforms[3]); //0.25;
  if (alpha <= t0) {
    return y0;
  } else if (alpha <= t1) {
    return mix(y0, y1, (alpha - t0) / (t1 - t0)); // LERP 0.0 → 1.0
  } else if (alpha <= t2) {
    return mix(y1, y2, (alpha - t1) / (t2 - t1)); // LERP 1.0 → 0.2
  } else {
    return y2;
  }
}

void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 ocolor = vec4(0.0);
	float overlayAlpha = overlayAlphaShader;
	if (overlays > 0.0) {
		ocolor = texture(overlay, texPos);
		//dFdx for "boxing" issue 435 has aliasing on some implementations (coarse vs fine)
		//however, this only identifies 50% of the edges due to aliasing effects
		// http://www.aclockworkberry.com/shader-derivative-functions/
		// https://bgolus.medium.com/distinctive-derivative-differences-cce38d36797b
		//if ((ocolor.a >= 1.0) && ((dFdx(ocolor.a) != 0.0) || (dFdy(ocolor.a) != 0.0)  ))
		//	ocolor.rbg = vec3(0.0, 0.0, 0.0);
		bool isOutlineBelowNotAboveThreshold = true;
		if (isOutlineBelowNotAboveThreshold) {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a < 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				//6 voxel neighbors that share a face
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 0.0;
				if (axCorSag != 2) {
					a = max(a, texture(overlay, vxR).a);
					a = max(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = max(a, texture(overlay, vxA).a);
					a = max(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = max(a, texture(overlay, vxS).a);
					a = max(a, texture(overlay, vxI).a);
				}
				bool isCheckCorners = true;
				if (isCheckCorners) {
					//12 voxel neighbors that share an edge
					vec3 vxRA = vec3(texPos.x+vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxLA = vec3(texPos.x-vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxRP = vec3(texPos.x+vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxLP = vec3(texPos.x-vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxRS = vec3(texPos.x+vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxLS = vec3(texPos.x-vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxRI = vec3(texPos.x+vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxLI = vec3(texPos.x-vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxAS = vec3(texPos.x, texPos.y+vx.y, texPos.z+vx.z);
					vec3 vxPS = vec3(texPos.x, texPos.y-vx.y, texPos.z+vx.z);
					vec3 vxAI = vec3(texPos.x, texPos.y+vx.y, texPos.z-vx.z);
					vec3 vxPI = vec3(texPos.x, texPos.y-vx.y, texPos.z-vx.z);

					if (axCorSag == 0) { //axial corners
						a = max(a, texture(overlay, vxRA).a);
						a = max(a, texture(overlay, vxLA).a);
						a = max(a, texture(overlay, vxRP).a);
						a = max(a, texture(overlay, vxLP).a);
					}
					if (axCorSag == 1) { //coronal corners
						a = max(a, texture(overlay, vxRS).a);
						a = max(a, texture(overlay, vxLS).a);
						a = max(a, texture(overlay, vxRI).a);
						a = max(a, texture(overlay, vxLI).a);
					}
					if (axCorSag == 2) { //sagittal corners
						a = max(a, texture(overlay, vxAS).a);
						a = max(a, texture(overlay, vxPS).a);
						a = max(a, texture(overlay, vxAI).a);
						a = max(a, texture(overlay, vxPI).a);
					}
				}
				if (a >= 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}

		} else {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a >= 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 1.0;
				if (axCorSag != 2) {
					a = min(a, texture(overlay, vxR).a);
					a = min(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = min(a, texture(overlay, vxA).a);
					a = min(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = min(a, texture(overlay, vxS).a);
					a = min(a, texture(overlay, vxI).a);
				}
				if (a < 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}
		} //outline above threshold
	}

`,BY=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler2D volume, overlay;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler2D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;`+Ry+`void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos.xy);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 dcolor = drawColor(texture(drawing, texPos.xy).r, drawOpacity);
	if (dcolor.a > 0.0) {
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
}`,HT=`	ocolor.a *= overlayAlpha;
	float drawV = texture(drawing, texPos).r;
	vec4 dcolor = drawColor(drawV, drawOpacity);
	if (dcolor.a > 0.0) {
		if (drawRimOpacity >= 0.0) {
			vec3 vx = 1.0 / vec3(textureSize(drawing, 0));
			//6 voxel neighbors that share a face
			vec3 offsetX = dFdx(texPos); // left-right spacing
			vec3 offsetY = dFdy(texPos); // up-down spacing
			float L = texture(drawing, texPos - offsetX).r;
			float R = texture(drawing, texPos + offsetX).r;
			float T = texture(drawing, texPos - offsetY).r;
			float B = texture(drawing, texPos + offsetY).r;
			if (L != drawV || R != drawV || T != drawV || B != drawV)
				dcolor.a = drawRimOpacity;
		}
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
	vec4 pcolor = texture(paqd, texPos);
	if (pcolor.a > 0.0) {
		pcolor.a = paqdEaseAlpha(pcolor.a);
		if (pcolor.a > 0.0) {
			if (paqdUniforms[3] < 0.0)
				ocolor = blendRGBA(pcolor, ocolor);
			else
				ocolor = blendRGBA(ocolor, pcolor);
		}
	}
	if ((backgroundMasksOverlays > 0) && (background.a == 0.0))
		return;
	float a = color.a + ocolor.a * (1.0 - color.a); // premultiplied alpha
	if (a == 0.0) return;
	color.rgb = mix(color.rgb, ocolor.rgb, ocolor.a / a);
	color.a = a;
}`,IY=jT+HT,NY=jT+`	if (ocolor.a > 0.0) {
		//https://gamedev.stackexchange.com/questions/102889/is-it-possible-to-convert-vec4-to-int-in-glsl-using-opengl-es
		uint alpha = uint(ocolor.a * 255.0);
		vec3 xyzFlip = vec3(float((uint(1) & alpha) > uint(0)), float((uint(2) & alpha) > uint(0)), float((uint(4) & alpha) > uint(0)));
		//convert from 0 and 1 to -1 and 1
		xyzFlip = (xyzFlip * 2.0) - 1.0;
		//https://math.stackexchange.com/questions/1905533/find-perpendicular-distance-from-point-to-line-in-3d
		//v1 principle direction of tensor for this voxel
		vec3 v1 = ocolor.rgb;
		//flips encode polarity to convert from 0..1 to -1..1 (27 bits vs 24 bit precision)
		v1 = normalize( v1 * xyzFlip);
		vec3 vxl = fract(texPos * vec3(textureSize(volume, 0))) - 0.5;
		//vxl coordinates now -0.5..+0.5 so 0,0,0 is origin
		vxl.x = -vxl.x;
		float t = dot(vxl,v1);
		vec3 P = t * v1;
		float dx = length(P-vxl);
		ocolor.a = 1.0 - smoothstep(0.2,0.25, dx);
		//if modulation was applied, use that to scale alpha not color:
		ocolor.a *= length(ocolor.rgb);
		ocolor.rgb = normalize(ocolor.rgb);
		//compute distance one half voxel closer to viewer:
		float pan = 0.5;
		if (axCorSag == 0)
			vxl.z -= pan;
		if (axCorSag == 1)
			vxl.y -= pan;
		if (axCorSag == 2)
			vxl.x += pan;
		t = dot(vxl,v1);
		P = t * v1;
		float dx2 = length(P-vxl);
		ocolor.rgb += (dx2-dx-(0.5 * pan)) * 1.0;
	}
`+HT,fp=`#version 300 es
#line 480
precision highp int;
precision highp float;
uniform vec4 lineColor;
out vec4 color;
void main() {
	color = lineColor;
}`,FY=`#version 300 es
#line 723
precision highp int;
precision highp float;

uniform vec4 lineColor;
uniform vec4 leftTopWidthHeight;
uniform float thickness; // line thickness in pixels
uniform vec2 canvasWidthHeight;

out vec4 color;

void main() {
    // fragment position in screen coordinates
    vec2 fragCoord = gl_FragCoord.xy;

    // canvas height
    float canvasHeight = canvasWidthHeight.y;

    // 'top' and 'bottom' to match gl_FragCoord.y coordinate system
    float top = canvasHeight - leftTopWidthHeight.y;
    float bottom = top - leftTopWidthHeight.w;

    // left and right edges
    float left = leftTopWidthHeight.x;
    float right = left + leftTopWidthHeight.z;

    bool withinLeft = fragCoord.x >= left && fragCoord.x <= left + thickness;
    bool withinRight = fragCoord.x <= right && fragCoord.x >= right - thickness;
    bool withinTop = fragCoord.y <= top && fragCoord.y >= top - thickness;
    bool withinBottom = fragCoord.y >= bottom && fragCoord.y <= bottom + thickness;

    bool isOutline = withinLeft || withinRight || withinTop || withinBottom;

    if (isOutline) {
        color = lineColor;
    } else {
        discard; 
    }
}`,kY=`#version 300 es
#line 490
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vColor;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vColor = pos.xy;
}`,UY=`#version 300 es
#line 506
precision highp int;
precision highp float;
uniform highp sampler2D colormap;
uniform float layer;
in vec2 vColor;
out vec4 color;
void main() {
	float nlayer = float(textureSize(colormap, 0).y);
	float fmap = (0.5 + layer) / nlayer;
	color = vec4(texture(colormap, vec2(vColor.x, fmap)).rgb, 1.0);
}`,zC=`#version 300 es
#line 520
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
}`,VY=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec4 startXYendXY;
void main(void) {
	vec2 posXY = mix(startXYendXY.xy, startXYendXY.zw, pos.x);
	vec2 dir = normalize(startXYendXY.xy - startXYendXY.zw);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0
	gl_Position = vec4((posXY * 2.0) - 1.0, 0.0, 1.0);
}`,OY=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec2 startXY;
uniform vec3 endXYZ; // transformed XYZ point
void main(void) {	
	vec2 posXY = mix(startXY.xy, endXYZ.xy, pos.x);
	vec2 startDiff = endXYZ.xy - startXY.xy;
	float startDistance = length(startDiff);
	vec2 diff = endXYZ.xy - posXY;
	float currentDistance = length(diff);
	vec2 dir = normalize(startXY.xy - endXYZ.xy);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0	
	float z = endXYZ.z * ( 1.0 - abs(currentDistance/startDistance)); 
	gl_Position = vec4((posXY * 2.0) - 1.0, z, 1.0);
}`,PY=`#version 300 es
#line 549
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(pos.x, 1.0 - pos.y);
}`,LY=`#version 300 es
#line 565
precision highp int;
precision highp float;
uniform highp sampler2D bmpTexture;
in vec2 vUV;
out vec4 color;
void main() {
	color = texture(bmpTexture, vUV);
}`,_Y=`#version 300 es
#line 576
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(uvLeftTopWidthHeight.x + (pos.x * uvLeftTopWidthHeight.z), uvLeftTopWidthHeight.y  + ((1.0 - pos.y) * uvLeftTopWidthHeight.w) );
}`,zY=`#version 300 es
#line 593
precision highp int;
precision highp float;
uniform highp sampler2D fontTexture;
uniform vec4 fontColor;
uniform float screenPxRange;
in vec2 vUV;
out vec4 color;
float median(float r, float g, float b) {
	return max(min(r, g), min(max(r, g), b));
}
void main() {
	vec3 msd = texture(fontTexture, vUV).rgb;
	float sd = median(msd.r, msd.g, msd.b);
	float screenPxDistance = screenPxRange*(sd - 0.5);
	float opacity = clamp(screenPxDistance + 0.5, 0.0, 1.0);
	color = vec4(fontColor.rgb , fontColor.a * opacity);
}`,GY=`#version 300 es
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = pos.xy;
}`,qY=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 circleColor;
uniform float fillPercent;
in vec2 vUV;
out vec4 color;
void main() {
	/* Check if the pixel is inside the circle
		 and color it with a gradient. Otherwise, color it 
		 transparent   */
	float distance = length(vUV-vec2(0.5,0.5));
	if ( distance < 0.5 && distance >= (1.0 - fillPercent) / 2.0){
			color = vec4(circleColor.r,circleColor.g,circleColor.b,circleColor.a) ;			
	}else{
			color = vec4(0.0,0.0,0.0,0.0);
	}
}
`,io=`#version 300 es
#line 613
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4( (vPos.xy-vec2(0.5,0.5)) * 2.0, 0.0, 1.0);
}`,yd=`#version 300 es
uniform highp usampler3D intensityVol;
`,GC=`#version 300 es
uniform highp isampler3D intensityVol;
`,YY=`#version 300 es
uniform highp sampler3D intensityVol;
`,qC=`#line 1042
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform bool isAdditiveBlend;
uniform float coordZ;
uniform float layer;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform uint activeIndex;
uniform vec4 xyzaFrac;
uniform mat4 mtx;
float textureWidth;
float nlayer;
float layerY;

vec4 scalar2color(uint idx) {
	float fx = (float(idx) + 0.5) / textureWidth;
	vec4 clr = texture(colormap, vec2(fx, layerY)).rgba;
	if (clr.a > 0.0)
		clr.a = 1.0;
	clr.a *= opacity;
	return clr;
}
void main(void) {
	vec4 vx = vec4(TexCoord.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint idx = uint(texture(intensityVol, vx.xyz).r);
	if (idx == uint(0)) {
		if (layer < 1.0) {
			FragColor = vec4(0.0, 0.0, 0.0, 0.0);
			return;
		}
		FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		return;
	}
	textureWidth = float(textureSize(colormap, 0).x);
	nlayer = float(textureSize(colormap, 0).y);
	layerY = ((2.0 * layer) + 1.5) / nlayer;
	//idx = ((idx - uint(1)) % uint(100))+uint(1);
	FragColor = scalar2color(idx);
	bool isBorder = false;
	vx = vec4(TexCoord.x+xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint R = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x-xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint L = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y+xyzaFrac.y, coordZ, 1.0) * mtx;
	uint A = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y-xyzaFrac.y, coordZ, 1.0) * mtx;
	uint P = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y, coordZ+xyzaFrac.z, 1.0) * mtx;
	uint S = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y, coordZ-xyzaFrac.z, 1.0) * mtx;
	uint I = uint(texture(intensityVol, vx.xyz).r);
	vec4 centerColor = FragColor;
	FragColor.a += scalar2color(R).a;
	FragColor.a += scalar2color(L).a;
	FragColor.a += scalar2color(A).a;
	FragColor.a += scalar2color(P).a;
	FragColor.a += scalar2color(S).a;
	FragColor.a += scalar2color(I).a;
	FragColor.a /= 7.0;
	if ((!isBorder) &&(idx == activeIndex)) {
		if (centerColor.a > 0.5)
			FragColor.a *= 0.4;
		else
			FragColor.a =0.8;
	}
	if (xyzaFrac.a != 0.0) { //outline
		if ((idx != R) || (idx != L) || (idx != A) || (idx != P) || (idx != S) || (idx != I)) {
			isBorder = true;
			if (xyzaFrac.a > 0.0)
				FragColor.a = xyzaFrac.a;
			else
				FragColor = vec4(0.0, 0.0, 0.0, 1.0);
		}
	}
	if (layer < 1.0) return;
		vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		// https://en.wikipedia.org/wiki/Alpha_compositing
		float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
		if (aout <= 0.0) return;
		if (isAdditiveBlend)
			FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a)) / aout;
		else
			FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
		FragColor.a = aout;
}`,hp=`#line 691
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform float cal_maxNeg;
uniform float cal_minNeg;
uniform bool isAlphaThreshold;
uniform bool isColorbarFromZero;
uniform bool isAdditiveBlend;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform int modulation;
uniform highp sampler3D modulationVol;
uniform float opacity;
uniform mat4 mtx;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	if ((vx.x < 0.0) || (vx.x > 1.0) || (vx.y < 0.0) || (vx.y > 1.0) || (vx.z < 0.0) || (vx.z > 1.0)) {
		//set transparent if out of range
		//https://webglfundamentals.org/webgl/webgl-3d-textures-repeat-clamp.html
		FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		return;
	}
	float f = (scl_slope * float(texture(intensityVol, vx.xyz).r)) + scl_inter;
	float mn = cal_min;
	float mx = cal_max;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mn = 0.0;
	float r = max(0.00001, abs(mx - mn));
	mn = min(mn, mx);
	float txl = mix(0.0, 1.0, (f - mn) / r);
	if (f > mn) { //issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
	}
	//https://stackoverflow.com/questions/5879403/opengl-texture-coordinates-in-pixel-space
	float nlayer = float(textureSize(colormap, 0).y);
	//each volume has two color maps:
	// (layer*2) = negative and (layer * 2) + 1 = positive
	float y = ((2.0 * layer) + 1.5)/nlayer;
	FragColor = texture(colormap, vec2(txl, y)).rgba;
	//negative colors
	mn = cal_minNeg;
	mx = cal_maxNeg;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mx = 0.0;
	//if ((!isnan(cal_minNeg)) && ( f < mx)) {
	if ((cal_minNeg < cal_maxNeg) && ( f < mx)) {
		r = max(0.00001, abs(mx - mn));
		mn = min(mn, mx);
		txl = 1.0 - mix(0.0, 1.0, (f - mn) / r);
		//issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
		y = ((2.0 * layer) + 0.5)/nlayer;
		FragColor = texture(colormap, vec2(txl, y));
	}
	if (layer > 0.7)
		FragColor.a = step(0.00001, FragColor.a);
	//if (modulation > 10)
	//	FragColor.a *= texture(modulationVol, vx.xyz).r;
	//	FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (isAlphaThreshold) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = pow(-f / -cal_maxNeg, 2.0);
		else if ((f > 0.0) && (cal_min > 0.0))
			FragColor.a *= pow(f / cal_min, 2.0); //issue435:  A = (V/X)**2
		//FragColor.g = 0.0;
	} else if (isColorbarFromZero) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = 0.0;
		else if ((f > 0.0) && (cal_min > 0.0) && (f < cal_min))
			FragColor.a *= 0.0;

	}
	if (modulation == 1) {
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	} else if (modulation == 2) {
		FragColor.a = texture(modulationVol, vx.xyz).r;
	}
	FragColor.a *= opacity;
	if (layer < 1.0) return;
	vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
	// https://en.wikipedia.org/wiki/Alpha_compositing
	float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
	if (aout <= 0.0) return;
	if (isAdditiveBlend)
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a)) / aout;
	else
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
	FragColor.a = aout;
}`,jY=`#line 773
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform mat4 mtx;
uniform bool hasAlpha;
uniform int modulation;
uniform highp sampler3D modulationVol;
float textureWidth;
float nlayer;
float layerY;

vec4 scalar2color(uint idx) {
	float fx = (float(idx) + 0.5) / textureWidth;
	vec4 clr = texture(colormap, vec2(fx, layerY)).rgba;
	if (clr.a > 0.0)
		clr.a = 1.0;
	clr.a *= opacity;
	return clr;
}

vec4 paqd2color(uvec4 rgba) {
  // paqd r: max prob index, g: 2nd index, b: max prob a: 2nd prob
  float prob1 = float(rgba.b)/255.0;
  float prob2 = float(rgba.a)/255.0;
  vec4 clr1 = scalar2color(rgba.r);
  vec4 clr2 = scalar2color(rgba.g);
  float total = prob1 + prob2;
  vec4 clr = vec4(clr1.rgb, total);
  // vec4 clr = vec4(clr1.rgb, prob1);
  if (total > 0.0) {
    clr.rgb = mix(clr2.rgb, clr1.rgb, prob1 / total);
  }
  return clr;
}
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	ivec3 voxelCoord = ivec3(vx.xyz * vec3(textureSize(intensityVol, 0)));
	uvec4 rgba = texelFetch(intensityVol, voxelCoord, 0);
	FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	if (rgba.r > uint(0)) {
		textureWidth = float(textureSize(colormap, 0).x);
		nlayer = float(textureSize(colormap, 0).y);
		layerY = ((2.0 * layer) + 1.5) / nlayer;
		FragColor = paqd2color(rgba);
		return;
	}
	// if (layer > 2.0) return;
	// FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
}`,HY=`#line 773
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform mat4 mtx;
uniform bool hasAlpha;
uniform int modulation;
uniform highp sampler3D modulationVol;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	uvec4 aColor = texture(intensityVol, vx.xyz);
	FragColor = vec4(float(aColor.r) / 255.0, float(aColor.g) / 255.0, float(aColor.b) / 255.0, float(aColor.a) / 255.0);
	if (modulation == 1)
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (!hasAlpha) {
		FragColor.a = (FragColor.r * 0.21 + FragColor.g * 0.72 + FragColor.b * 0.07);
		//next line: we could binarize alpha, but see rendering of visible human
		//FragColor.a = step(0.01, FragColor.a);
	}
	if (modulation == 2)
		FragColor.a = texture(modulationVol, vx.xyz).r;
	FragColor.a *= opacity;
	if (layer < 1.0) return;
	vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
	// https://en.wikipedia.org/wiki/Alpha_compositing
	float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
	if (aout <= 0.0) return;
	FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
	FragColor.a = aout;
}`,KY=`#version 300 es
#line 808
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4((vPos.x - 0.5) * 2.0, (vPos.y - 0.5) * 2.0, 0.0, 1.0);
}`,XY=`#version 300 es
#line 829
	precision highp float;
	precision highp int;
	precision highp isampler3D;
	layout(location = 0) out int label;
	layout(location = 1) out int strength;
	in vec2 TexCoord;
	uniform int finalPass;
	uniform float coordZ;
	uniform lowp sampler3D in3D;
	uniform highp isampler3D backTex; // background
	uniform highp isampler3D labelTex; // label
	uniform highp isampler3D strengthTex; // strength
void main(void) {
	vec3 interpolatedTextureCoordinate = vec3(TexCoord.xy, coordZ);
	ivec3 size = textureSize(backTex, 0);
	ivec3 texelIndex = ivec3(floor(interpolatedTextureCoordinate * vec3(size)));
	int background = texelFetch(backTex, texelIndex, 0).r;
	label = texelFetch(labelTex, texelIndex, 0).r;
	strength = texelFetch(strengthTex, texelIndex, 0).r;
	for (int k = -1; k <= 1; k++) {
		for (int j = -1; j <= 1; j++) {
			for (int i = -1; i <= 1; i++) {
				if (i != 0 && j != 0 && k != 0) {
					ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
					int neighborBackground = texelFetch(backTex, neighborIndex, 0).r;
					int neighborStrength = texelFetch(strengthTex, neighborIndex, 0).r;
					int strengthCost = abs(neighborBackground - background);
					int takeoverStrength = neighborStrength - strengthCost;
					if (takeoverStrength > strength) {
						strength = takeoverStrength;
						label = texelFetch(labelTex, neighborIndex, 0).r;
					}
				}
			}
		}
	}
	if (finalPass < 1)
		return;
	int ok = 1;
	ivec4 labelCount = ivec4(0,0,0,0);
	for (int k = -1; k <= 1; k++)
		for (int j = -1; j <= 1; j++)
			for (int i = -1; i <= 1; i++) {
				ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
				int ilabel = texelFetch(labelTex, neighborIndex, 0).r;
				if ((ilabel < 0) || (ilabel > 3))
					ok = 0;
				else
					labelCount[ilabel]++;
			}
	if (ok != 1) {
		return;
	}
	int maxIdx = 0;
	for (int i = 1; i < 4; i++) {
		if (labelCount[i] > labelCount[maxIdx])
			maxIdx = i;
	}
	label = maxIdx;
}`,QY=`#version 300 es
layout(location=0) in vec3 pos;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
}`,ZY=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 surfaceColor;
out vec4 color;
void main() {
	color = surfaceColor;
}`,WY=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 clr;
out vec4 vClr;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vClr = clr;
}`,JY=`#version 300 es
precision highp int;
precision highp float;
in vec4 vClr;
out vec4 color;
uniform float opacity;
void main() {
	color = vec4(vClr.rgb, opacity);
}`,dp=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
out vec3 vN;
out vec4 vP;
out vec4 vPc;
void main(void) {
	vec3 lightPosition = vec3(0.0, 0.0, -10.0);
	vP = vec4(pos, 1.0);
	vPc = mvpMtx * vec4(pos, 1.0);
	gl_Position = vPc;
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,$Y=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
out vec4 color;
vec4 packFloatToVec4i(const float value) {
	const vec4 bitSh = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
	const vec4 bitMsk = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
	vec4 res = fract(value * bitSh);
	res -= res.xxyz * bitMsk;
	return res;
}
void main() {
	color = packFloatToVec4i(gl_FragCoord.z);
}`,ej=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
float stepmix(float edge0, float edge1, float E, float x){
	float T = clamp(0.5 * (x - edge0 + E) / E, 0.0, 1.0);
	return mix(edge0, edge1, T);
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0);
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.5;
	float shininess = 50.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float df = max(0.0, dot(n, l));
	float sf = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	const float A = 0.1;
	const float B = 0.3;
	const float C = 0.6;
	const float D = 1.0;
	float E = fwidth(df);
	if (df > A - E && df < A + E) df = stepmix(A, B, E, df);
	else if (df > B - E && df < B + E) df = stepmix(B, C, E, df);
	else if (df > C - E && df < C + E) df = stepmix(C, D, E, df);
	else if (df < A) df = 0.0;
	else if (df < B) df = B;
	else if (df < C) df = C;
	else df = D;
	E = fwidth(sf);
	if (sf > 0.5 - E && sf < 0.5 + E)
		sf = smoothstep(0.5 - E, 0.5 + E, sf);
	else
		sf = step(0.5, sf);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(df, 0.0) * vClr.rgb * diffuse;
	color.rgb = a + d + (specular * sf);
	color.a = opacity;
}`,tj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.25;
	float shininess = 10.0;
	float PenWidth = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	float view = abs(dot(n,r)); //with respect to viewer
	if (PenWidth < view) discard;
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color.rgb = a + d + s;
	color.a = opacity;
}`,rj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	const float thresh = 0.4;
	const vec3 viewDir = vec3(0.0, 0.0, -1.0);
	vec3 n = normalize(vN);
	// use abs() for two-sided lighting, max() for one sided
	float cosTheta = abs(dot(n, viewDir));
	// float cosTheta = max(dot(n, viewDir), 0.0);
	// optional fresnel equation - adjust exponent
	// cosTheta = 1.0 - pow(1.0 - cosTheta, 2.0);
	// use step for binary edges, smoothstep for feathered edges
	// vec3 d = step(thresh, cosTheta) * vClr.rgb;
	vec3 d = smoothstep(thresh - 0.05, thresh + 0.05, cosTheta) * vClr.rgb;
	color = vec4(d, opacity);
}`,nj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
  const float edge0 = 0.1;
  const float edge1 = 0.25;
  const vec3 viewDir = vec3(0.0, 0.0, -1.0);
  vec3 n = normalize(vN);
  float cosTheta = abs(dot(n, viewDir));
  float alpha = 1.0 - smoothstep(edge0, edge1, cosTheta);
  if (alpha <= 0.0) {
    discard;
  }
  color = vec4(0.0, 0.0, 0.0, opacity * alpha);
}`,ij=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float diffuse = 1.0;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 0.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d = lightNormDot * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(d + s, opacity);
}`,aj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float diffuse = 1.4;
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(normalize(vN), l), 0.0);
	color = vec4(lightNormDot * vClr.rgb * diffuse, opacity);
}`,sj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float specularRGB = 0.7;
	float specularWhite = 0.3;
	float shininess = 10.0;
	float diffuse = 1.0;
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	vec3 n = normalize(vN);
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d3 = lightNormDot * vClr.rgb * diffuse;
	float s = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 s3 = specularRGB * s * vClr.rgb;
	s *= specularWhite;
	color = vec4(d3 + s3 + s, opacity);
}`,oj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
in vec4 vPc;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	// Compute curvature
	vec3 dx = dFdx(n);
	vec3 dy = dFdy(n);
	vec3 xneg = n - dx;
	vec3 xpos = n + dx;
	vec3 yneg = n - dy;
	vec3 ypos = n + dy;
	float depth = length(vPc.xyz);
	float curv = (cross(xneg, xpos).y - cross(yneg, ypos).x) / depth;
	//at this stage 0.5 for flat, with valleys dark and ridges bright
	curv = 1.0 - (curv + 0.5);
	//clamp
	curv =  min(max(curv, 0.0), 1.0);
	// easing function
	curv = pow(curv, 0.5);
	//modulate ambient and diffuse with curvature
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.6;
	float diffuse = 0.6;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 lightPosition = vec3(0.0, 10.0, -2.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient * curv;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,lj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,uj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
uniform sampler2D matCap;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	vec2 uv = n.xy * 0.5 + 0.5;
	uv.y = 1.0 - uv.y;
	vec3 clr = texture(matCap,uv.xy).rgb * vClr.rgb;
	color = vec4(clr, opacity);
}`,cj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float ambient = 0.35;
	float diffuse = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	color = vec4(a + d, opacity);
}`,fj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 up = vec3(0.0, 1.0, 0.0);
	float ax = dot(n, up) * 0.5 + 0.5;  //Shreiner et al. (2013) OpenGL Programming Guide, 8th Ed., p 388. ISBN-10: 0321773039
	vec3 upClr = vec3(1.0, 1.0, 0.95);
	vec3 downClr = vec3(0.4, 0.4, 0.6);
	vec3 a = vClr.rgb * ambient;
	a *= mix(downClr, upClr, ax);
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,hj=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
//Spherical harmonics constants
const float C1 = 0.429043;
const float C2 = 0.511664;
const float C3 = 0.743125;
const float C4 = 0.886227;
const float C5 = 0.247708;
//Spherical harmonics coefficients
// Ramamoorthi, R., and P. Hanrahan. 2001b. "An Efficient Representation for Irradiance Environment Maps." In Proceedings of SIGGRAPH 2001, pp. 497–500.
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// Constants for Eucalyptus Grove lighting
const vec3 L00  = vec3( 0.3783264,  0.4260425,  0.4504587);
const vec3 L1m1 = vec3( 0.2887813,  0.3586803,  0.4147053);
const vec3 L10  = vec3( 0.0379030,  0.0295216,  0.0098567);
const vec3 L11  = vec3(-0.1033028, -0.1031690, -0.0884924);
const vec3 L2m2 = vec3(-0.0621750, -0.0554432, -0.0396779);
const vec3 L2m1 = vec3( 0.0077820, -0.0148312, -0.0471301);
const vec3 L20  = vec3(-0.0935561, -0.1254260, -0.1525629);
const vec3 L21  = vec3(-0.0572703, -0.0502192, -0.0363410);
const vec3 L22  = vec3( 0.0203348, -0.0044201, -0.0452180);
vec3 SH(vec3 vNormal) {
	vNormal = vec3(vNormal.x,vNormal.z,vNormal.y);
	vec3 diffuseColor = C1 * L22 * (vNormal.x * vNormal.x - vNormal.y * vNormal.y) +
	C3 * L20 * vNormal.z * vNormal.z +
	C4 * L00 -
	C5 * L20 +
	2.0 * C1 * L2m2 * vNormal.x * vNormal.y +
	2.0 * C1 * L21  * vNormal.x * vNormal.z +
	2.0 * C1 * L2m1 * vNormal.y * vNormal.z +
	2.0 * C2 * L11  * vNormal.x +
	2.0 * C2 * L1m1 * vNormal.y +
	2.0 * C2 * L10  * vNormal.z;
	return diffuseColor;
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.1;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 a = vClr.rgb * ambient;
	vec3 d = vClr.rgb * diffuse * SH(-reflect(n, vec3(l.x, l.y, -l.z)) );
	color = vec4(a + d + s, opacity);
}`,dj=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
flat out vec3 vN;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,YC=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
flat in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,gj=`#version 300 es
#line 1260
//precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 volScale;
uniform vec3 texVox;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform mat4 matRAS;
uniform mat4 mvpMtx;
uniform float drawOpacity, renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform int backgroundMasksOverlays;
in vec3 vColor;
out vec4 fColor;
`+wf+`
void main() {
	int id = 254;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	fColor = vec4(0.0, 0.0, 0.0, 0.0); //assume no hit: ID = 0
	float fid = float(id & 255)/ 255.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) return;//discard; //length limit for parallel rays
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	dir = normalize(dir);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	if (isClip) fColor = vec4(samplePos.xyz, 253.0 / 255.0); //assume no hit: ID = 0
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			break;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//end: fast pass
	if ((overlays < 1.0) || (backgroundMasksOverlays > 0)) {
		return; //background hit, no overlays
	}
	//overlay pass
	len = min(lenNoClip, samplePos.a); //only find overlay closer than background
	samplePos = vec4(start.xyz, 0.0); //ray position
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			return;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//if (fColor.a == 0.0) discard; //no hit in either background or overlays
	//you only get here if there is a hit with the background that is closer than any overlay
}`,vj=`#version 300 es
// an attribute is an input (in) to a vertex shader.
// It will receive data from a buffer
layout(location=0)  in vec3 a_position;
layout(location=1)  in vec3 a_color;
// A matrix to transform the positions by
uniform mat4 u_matrix;
out vec3 vColor;
// all shaders have a main function
void main() {
	// Multiply the position by the matrix.
	vec4 pos = vec4(a_position, 1.0);
	gl_Position = u_matrix * vec4(pos);
	vColor = a_color;
}
`,mj=`#version 300 es
precision highp float;
uniform vec4 u_color;
in vec3 vColor;
out vec4 outColor;
void main() {
	outColor = vec4(vColor, 1.0);
}`,pj=`#version 300 es
#line 1359
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	vec2 viewCoord = (vPos.xy - 0.5) * 2.0;
	gl_Position = vec4((vPos.xy - 0.5) * 2.0, 0.0, 1.0);
}`,yj=`#version 300 es
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform lowp sampler3D in3D;
void main(void) {
 FragColor = texture(in3D, vec3(TexCoord.xy, coordZ));
}`,Ad=`#version 300 es
#line 286
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
    TexCoord = vPos.xy;
    gl_Position = vec4( (vPos.xy-vec2(0.5,0.5))* 2.0, 0.0, 1.0);
}`,Aj=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 samp = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
 FragColor = samp*0.125;
}`,xj=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 XYZ = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 vec4 OYZ = texture(intensityVol,vx+vec3(0.0,+dY,+dZ));
 vec4 xYZ = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 vec4 XOZ = texture(intensityVol,vx+vec3(+dX,0.0,+dZ));
 vec4 OOZ = texture(intensityVol,vx+vec3(0.0,0.0,+dZ));
 vec4 xOZ = texture(intensityVol,vx+vec3(-dX,0.0,+dZ));
 vec4 XyZ = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 vec4 OyZ = texture(intensityVol,vx+vec3(0.0,-dY,+dZ));
 vec4 xyZ = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));

 vec4 XYO = texture(intensityVol,vx+vec3(+dX,+dY,0.0));
 vec4 OYO = texture(intensityVol,vx+vec3(0.0,+dY,0.0));
 vec4 xYO = texture(intensityVol,vx+vec3(-dX,+dY,0.0));
 vec4 XOO = texture(intensityVol,vx+vec3(+dX,0.0,0.0));
 vec4 OOO = texture(intensityVol,vx+vec3(0.0,0.0,0.0));
 vec4 xOO = texture(intensityVol,vx+vec3(-dX,0.0,0.0));
 vec4 XyO = texture(intensityVol,vx+vec3(+dX,-dY,0.0));
 vec4 OyO = texture(intensityVol,vx+vec3(0.0,-dY,0.0));
 vec4 xyO = texture(intensityVol,vx+vec3(-dX,-dY,0.0));

 vec4 XYz = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 vec4 OYz = texture(intensityVol,vx+vec3(0.0,+dY,-dZ));
 vec4 xYz = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 vec4 XOz = texture(intensityVol,vx+vec3(+dX,0.0,-dZ));
 vec4 OOz = texture(intensityVol,vx+vec3(0.0,0.0,-dZ));
 vec4 xOz = texture(intensityVol,vx+vec3(-dX,0.0,-dZ));
 vec4 Xyz = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 vec4 Oyz = texture(intensityVol,vx+vec3(0.0,-dY,-dZ));
 vec4 xyz = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));

 vec4 blurred = vec4 (0.0, 0.0, 0.0, 0.0);
 blurred.r = 2.0*(xOz.r +xOZ.r +xyO.r +xYO.r +xOO.r +XOz.r +XOZ.r +XyO.r +XYO.r +XOO.r) +xyz.r +xyZ.r +xYz.r +xYZ.r +Xyz.r +XyZ.r +XYz.r +XYZ.r;
 blurred.g = 2.0*(Oyz.r +OyZ.r +xyO.r +XyO.r +OyO.r +OYz.r +OYZ.r +xYO.r +XYO.r +OYO.r) +xyz.r +Xyz.r +xyZ.r +XyZ.r +xYz.r +XYz.r +xYZ.r +XYZ.r;
 blurred.b = 2.0*(Oyz.r +OYz.r +xOz.r +XOz.r +OOz.r +OyZ.r +OYZ.r +xOZ.r +XOZ.r +OOZ.r) +xyz.r +Xyz.r +xYz.r +XYz.r +xyZ.r +XyZ.r +XyZ.r +XYZ.r;
 blurred.a = 0.32*(abs(blurred.r)+abs(blurred.g)+abs(blurred.b));
 // 0.0357 = 1/28 to account for weights, rescale to 2**16,
 FragColor = 0.0357*blurred;
}`,KT=`
  gradientSample.a = log2(gradientSample.r*gradientSample.r + gradientSample.g*gradientSample.g + gradientSample.b*gradientSample.b + 1.922337562475971e-06) + 18.988706873717717;
`,bj=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  float TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ)).r;
  float TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ)).r;
  float TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ)).r;
  float TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ)).r;
  float BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ)).r;
  float BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ)).r;
  float BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ)).r;
  float BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ)).r;
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = BAR+BAL+BPR+BPL -TAR-TAL-TPR-TPL;
  gradientSample.g = TPR+TPL+BPR+BPL -TAR-TAL-BAR-BAL;
  gradientSample.b = TAL+TPL+BAL+BPL -TAR-TPR-BAR-BPR;
${KT}
	// 0.04242020977371934 = 1/(log2(3*8) - log2(1/(255**2*8))) // 3*8 -> max for 1st order gradient
	gradientSample.a *= 0.04242020977371934;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb = (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,wj=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform float dX2;
uniform float dY2;
uniform float dZ2;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  vec4 TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
  vec4 TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
  vec4 TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
  vec4 TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
  vec4 BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
  vec4 BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
  vec4 BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
  vec4 BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
  vec4 T = texture(intensityVol,vx+vec3(+dX2,0.0,0.0));
  vec4 A = texture(intensityVol,vx+vec3(0.0,+dY2,0.0));
  vec4 R = texture(intensityVol,vx+vec3(0.0,0.0,+dZ2));
  vec4 B = texture(intensityVol,vx+vec3(-dX2,0.0,0.0));
  vec4 P = texture(intensityVol,vx+vec3(0.0,-dY2,0.0));
  vec4 L = texture(intensityVol,vx+vec3(0.0,0.0,-dZ2));
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = -4.0*B.r +8.0*(BAR.r+BAL.r+BPR.r+BPL.r) -8.0*(TAR.r+TAL.r+TPR.r+TPL.r) +4.0*T.r;
  gradientSample.g = -4.0*P.g +8.0*(TPR.g+TPL.g+BPR.g+BPL.g) -8.0*(TAR.g+TAL.g+BAR.g+BAL.g) +4.0*A.g;
  gradientSample.b = -4.0*L.b +8.0*(TAL.b+TPL.b+BAL.b+BPL.b) -8.0*(TAR.b+TPR.b+BAR.b+BPR.b) +4.0*R.b;
${KT}
	gradientSample.a *= 0.0325;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb =  (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,Cj=function(r,e,n){const i=r.createShader(r.VERTEX_SHADER);r.shaderSource(i,e),r.compileShader(i);const a=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(a,n),r.compileShader(a);const s=r.createProgram();if(r.attachShader(s,i),r.attachShader(s,a),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))throw console.log(r.getProgramInfoLog(s)),r.getShaderParameter(i,r.COMPILE_STATUS)||console.log("Vertex shader compilation error:",r.getShaderInfoLog(i)),r.getShaderParameter(a,r.COMPILE_STATUS)||console.log("Fragment shader compilation error:",r.getShaderInfoLog(a)),Z.error(r.getProgramInfoLog(s)),new Error("Shader failed to link, see console for log");return s},xt=class{constructor(r,e,n){j(this,"program"),j(this,"uniforms",{}),j(this,"isMatcap"),this.program=Cj(r,e,n);const i=/uniform[^;]+[ ](\w+);/g,a=/uniform[^;]+[ ](\w+);/,s=e.match(i),o=n.match(i);s&&s.forEach(l=>{const c=l.match(a);this.uniforms[c[1]]=-1}),o&&o.forEach(l=>{const c=l.match(a);this.uniforms[c[1]]=-1});for(const l in this.uniforms)this.uniforms[l]=r.getUniformLocation(this.program,l)}use(r){r.useProgram(this.program)}},jC=(r,e)=>{const n=Math.floor(Math.log(r)/Math.log(10)),i=r/Math.pow(10,n);let a;return e?i<1.5?a=1:i<3?a=2:i<7?a=5:a=10:i<=1?a=1:i<=2?a=2:i<=5?a=5:a=10,a*Math.pow(10,n)};function Ej(r){return new Promise((e,n)=>{let i;r instanceof File?i=Promise.resolve(r):i=new Promise((a,s)=>{r.file(a,s)}),i.then(a=>{const s=new FileReader;s.onload=()=>{typeof s.result=="string"?e(s.result):n(new Error("Expected a string from FileReader.result"))},s.onerror=()=>{n(s.error??new Error("Unknown FileReader error"))},s.readAsDataURL(a)}).catch(a=>n(a))})}function Sj(r){const e=r.hdr.dims,n=r.permRAS,i=e[1]*e[2]*e[3],a=new Int16Array(i),s=[0,0,0];for(let m=0;m<3;m++)for(let y=0;y<3;y++)Math.abs(n[m])-1===y&&(s[y]=m*Math.sign(n[m]));let o=1;const l=[1,1,1],c=[!1,!1,!1];for(let m=0;m<s.length;m++)for(let y=0;y<s.length;y++)Math.abs(s[y])===m&&(l[y]=o,(s[y]<0||Object.is(s[y],-0))&&(c[y]=!0),o*=e[y+1]);let u=qe.range(0,e[1]-1,1);c[0]&&(u=qe.range(e[1]-1,0,-1));for(let m=0;m<e[1];m++)u[m]*=l[0];let h=qe.range(0,e[2]-1,1);c[1]&&(h=qe.range(e[2]-1,0,-1));for(let m=0;m<e[2];m++)h[m]*=l[1];let g=qe.range(0,e[3]-1,1);c[2]&&(g=qe.range(e[3]-1,0,-1));for(let m=0;m<e[3];m++)g[m]*=l[2];let v=0;for(let m=0;m<e[3];m++)for(let y=0;y<e[2];y++)for(let b=0;b<e[1];b++)a[u[b]+h[y]+g[m]]=r.img[v],v++;return a}function Tj(r){const e=[5960464477539063e-23,152587890625e-16,.00390625,1];return(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3])/255}function HC(r,e){return r.scl_slope===0&&(r.scl_slope=1),e*r.scl_slope+r.scl_inter}function hc(r,e,n=4){const i=jC(e-r,!1),a=jC(i/(n-1),!0),s=Math.floor(r/a)*a,o=Math.ceil(e/a)*a;return[a,s,o,s===r&&o===e]}function KC(r,e){let n=hc(r,e,3);return n[3]||(n=hc(r,e,5)),n[3]||(n=hc(r,e,4)),n[3]||(n=hc(r,e,3)),n[3]||(n=hc(r,e,5)),[n[0],n[1],n[2]]}function ds(r){return r*(Math.PI/180)}function gp(r,e,n,i){let a=-r,s=-e;return isFinite(n)&&isFinite(i)&&(a=n,s=i),a>s&&([a,s]=[s,a]),[a,s]}function vp(r,e,n){return Math.min(Math.max(r,e),n)}function yr(r,e=[0,1,2]){const n=Kt();return n[0]=r[e[0]],n[1]=r[e[1]],n[2]=r[e[2]],n}function XC(r){const e=Jt(1,0,0,0),n=Qi();return Kr(n,e,r),n[0]}function Mj(r,e,n,i){const a=Jt(r,e,n,1),s=Er(i);kn(s,s),a[0]=a[0]*2-1,a[1]=a[1]*2-1,a[2]=a[2]*2-1;const o=Qi();return Kr(o,a,s),o[3]===0||(o[0]/=o[3],o[1]/=o[3],o[2]/=o[3]),o}var{version:QC}=OG,ao=["ASC","BYU","DFS","FSM","PIAL","ORIG","INFLATED","SMOOTHWM","SPHERE","WHITE","G","GEO","GII","ICO","MZ3","NV","OBJ","OFF","PLY","SRF","STL","TCK","TRACT","TRI","TRK","TT","TRX","VTK","WRL","X3D","JCON","JSON"],dc=0,mp=1,pp=2,Ml=33984,xd=33985,yp=33986,Dj=33987,Rj=33988,ZC=33989,Ap=33990,gs=33991,gc=33992,WC=33992,JC=33993,$C=33994,Bj=33995,Ij=33996,Nj=33997,Fj=33998,kj=33999,eE={filename:"",isSaveDrawing:!1,volumeByIndex:0},Uj=class{constructor(r=Di){j(this,"loaders",{}),j(this,"dicomLoader",null),j(this,"canvas",null),j(this,"_gl",null),j(this,"isBusy",!1),j(this,"needsRefresh",!1),j(this,"colormapTexture",null),j(this,"colormapLists",[]),j(this,"volumeTexture",null),j(this,"gradientTexture",null),j(this,"gradientTextureAmount",0),j(this,"useCustomGradientTexture",!1),j(this,"renderGradientValues",!1),j(this,"drawTexture",null),j(this,"paqdTexture",null),j(this,"drawUndoBitmaps",[]),j(this,"drawLut",Vt.makeDrawLut("$itksnap")),j(this,"drawOpacity",.8),j(this,"drawRimOpacity",-1),j(this,"clickToSegmentIsGrowing",!1),j(this,"clickToSegmentGrowingBitmap",null),j(this,"clickToSegmentXY",[0,0]),j(this,"renderDrawAmbientOcclusion",.4),j(this,"colorbarHeight",0),j(this,"drawPenLocation",[NaN,NaN,NaN]),j(this,"drawPenAxCorSag",-1),j(this,"drawFillOverwrites",!0),j(this,"drawPenFillPts",[]),j(this,"drawShapeStartLocation",[NaN,NaN,NaN]),j(this,"drawShapePreviewBitmap",null),j(this,"overlayTexture",null),j(this,"overlayTextureID",null),j(this,"sliceMMShader"),j(this,"slice2DShader"),j(this,"sliceV1Shader"),j(this,"orientCubeShader"),j(this,"orientCubeShaderVAO",null),j(this,"rectShader"),j(this,"rectOutlineShader"),j(this,"renderShader"),j(this,"lineShader"),j(this,"line3DShader"),j(this,"passThroughShader"),j(this,"renderGradientShader"),j(this,"renderGradientValuesShader"),j(this,"renderSliceShader"),j(this,"renderVolumeShader"),j(this,"pickingMeshShader"),j(this,"pickingImageShader"),j(this,"colorbarShader"),j(this,"customSliceShader",null),j(this,"fontShader",null),j(this,"fiberShader"),j(this,"fontTexture",null),j(this,"circleShader"),j(this,"matCapTexture",null),j(this,"bmpShader",null),j(this,"bmpTexture",null),j(this,"thumbnailVisible",!1),j(this,"bmpTextureWH",1),j(this,"growCutShader"),j(this,"orientShaderAtlasU",null),j(this,"orientShaderAtlasI",null),j(this,"orientShaderU",null),j(this,"orientShaderI",null),j(this,"orientShaderF",null),j(this,"orientShaderRGBU",null),j(this,"orientShaderPAQD",null),j(this,"surfaceShader",null),j(this,"blurShader",null),j(this,"sobelBlurShader",null),j(this,"sobelFirstOrderShader",null),j(this,"sobelSecondOrderShader",null),j(this,"genericVAO",null),j(this,"unusedVAO",null),j(this,"crosshairs3D",null),j(this,"DEFAULT_FONT_GLYPH_SHEET",PC),j(this,"DEFAULT_FONT_METRICS",LC),j(this,"fontMetrics"),j(this,"fontMets",null),j(this,"fontPx",12),j(this,"legendFontScaling",1),j(this,"backgroundMasksOverlays",0),j(this,"overlayOutlineWidth",0),j(this,"overlayAlphaShader",1),j(this,"position"),j(this,"extentsMin"),j(this,"extentsMax"),j(this,"resizeObserver",null),j(this,"resizeEventListener",null),j(this,"canvasObserver",null),j(this,"syncOpts",{"3d":!1,"2d":!1,zoomPan:!1,cal_min:!1,cal_max:!1,clipPlane:!1,gamma:!1,sliceType:!1,crosshair:!1}),j(this,"readyForSync",!1),j(this,"uiData",{mousedown:!1,touchdown:!1,mouseButtonLeftDown:!1,mouseButtonCenterDown:!1,mouseButtonRightDown:!1,mouseDepthPicker:!1,clickedTile:-1,pan2DxyzmmAtMouseDown:[0,0,0,1],prevX:0,prevY:0,currX:0,currY:0,currentTouchTime:0,lastTouchTime:0,touchTimer:null,doubleTouch:!1,isDragging:!1,dragStart:[0,0],dragEnd:[0,0],dragClipPlaneStartDepthAziElev:[0,0,0],lastTwoTouchDistance:0,multiTouchGesture:!1,windowX:0,windowY:0,activeDragMode:null,activeDragButton:null,angleFirstLine:[0,0,0,0],angleState:"none"}),j(this,"back",null),j(this,"overlays",[]),j(this,"deferredVolumes",[]),j(this,"deferredMeshes",[]),j(this,"furthestVertexFromOrigin",100),j(this,"volScale",[]),j(this,"vox",[]),j(this,"mousePos",[0,0]),j(this,"screenSlices",[]),j(this,"cuboidVertexBuffer"),j(this,"otherNV",null),j(this,"volumeObject3D",null),j(this,"pivot3D",[0,0,0]),j(this,"furthestFromPivot",10),j(this,"currentClipPlaneIndex",0),j(this,"lastCalled",new Date().getTime()),j(this,"selectedObjectId",-1),j(this,"CLIP_PLANE_ID",1),j(this,"VOLUME_ID",254),j(this,"DISTANCE_FROM_CAMERA",-.54),j(this,"graph",{LTWH:[0,0,640,480],opacity:0,vols:[0],autoSizeMultiplanar:!1,normalizeValues:!1,isRangeCalMinMax:!1}),j(this,"customLayout",[]),j(this,"meshShaders",[{Name:"Phong",Frag:lj},{Name:"Matte",Frag:cj},{Name:"Harmonic",Frag:hj},{Name:"Hemispheric",Frag:fj},{Name:"Crevice",Frag:oj},{Name:"Edge",Frag:ij},{Name:"Diffuse",Frag:aj},{Name:"Outline",Frag:tj},{Name:"Specular",Frag:sj},{Name:"Toon",Frag:ej},{Name:"Flat",Frag:YC},{Name:"Matcap",Frag:uj},{Name:"Rim",Frag:rj},{Name:"Silhouette",Frag:nj}]),j(this,"dragModes",{contrast:1,measurement:2,angle:7,none:0,pan:3,slicer3D:4,callbackOnly:5}),j(this,"sliceTypeAxial",0),j(this,"sliceTypeCoronal",1),j(this,"sliceTypeSagittal",2),j(this,"sliceTypeMultiplanar",3),j(this,"sliceTypeRender",4),j(this,"onDragRelease",()=>{}),j(this,"onMouseUp",()=>{}),j(this,"onLocationChange",()=>{}),j(this,"onIntensityChange",()=>{}),j(this,"onClickToSegment",()=>{}),j(this,"onImageLoaded",()=>{}),j(this,"onMeshLoaded",()=>{}),j(this,"onFrameChange",()=>{}),j(this,"onError",()=>{}),j(this,"onColormapChange",()=>{}),j(this,"onInfo",()=>{}),j(this,"onWarn",()=>{}),j(this,"onDebug",()=>{}),j(this,"onVolumeAddedFromUrl",()=>{}),j(this,"onVolumeWithUrlRemoved",()=>{}),j(this,"onVolumeUpdated",()=>{}),j(this,"onMeshAddedFromUrl",()=>{}),j(this,"onMeshAdded",()=>{}),j(this,"onMeshWithUrlRemoved",()=>{}),j(this,"onZoom3DChange",()=>{}),j(this,"onAzimuthElevationChange",()=>{}),j(this,"onClipPlaneChange",()=>{}),j(this,"onCustomMeshShaderAdded",()=>{}),j(this,"onMeshShaderChanged",()=>{}),j(this,"onMeshPropertyChanged",()=>{}),j(this,"onDicomLoaderFinishedWithImages",()=>{}),j(this,"onDocumentLoaded",()=>{}),j(this,"onOptsChange",()=>{}),j(this,"document",new lp),j(this,"mediaUrlMap",new Map),j(this,"initialized",!1),j(this,"currentDrawUndoBitmap");for(const e in r)typeof r[e]=="function"?this[e]=r[e]:this.opts[e]=Di[e]===void 0?Di[e]:r[e];this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,this.opts.drawingEnabled&&this.createEmptyDrawing(),this.opts.thumbnail.length>0&&(this.thumbnailVisible=!0),Z.setLogLevel(this.opts.logLevel),this.document.setOptsChangeCallback((e,n,i)=>{this.onOptsChange(e,n,i)})}get scene(){return this.document.scene}get opts(){return this.document.opts}get sliceMosaicString(){return this.document.opts.sliceMosaicString||""}set sliceMosaicString(r){this.document.opts.sliceMosaicString=r}get isAlphaClipDark(){return this.document.opts.isAlphaClipDark}set isAlphaClipDark(r){this.document.opts.isAlphaClipDark=r}cleanup(){this.resizeEventListener&&(window.removeEventListener("resize",this.resizeEventListener),this.resizeEventListener=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.canvasObserver&&(this.canvasObserver.disconnect(),this.canvasObserver=null),this.canvas&&this.opts.interactive&&(this.canvas.removeEventListener("mousedown",this.mouseDownListener.bind(this)),this.canvas.removeEventListener("mouseup",this.mouseUpListener.bind(this)),this.canvas.removeEventListener("mousemove",this.mouseMoveListener.bind(this)),this.canvas.removeEventListener("touchstart",this.touchStartListener.bind(this)),this.canvas.removeEventListener("touchend",this.touchEndListener.bind(this)),this.canvas.removeEventListener("touchmove",this.touchMoveListener.bind(this)),this.canvas.removeEventListener("wheel",this.wheelListener.bind(this)),this.canvas.removeEventListener("contextmenu",this.mouseContextMenuListener.bind(this)),this.canvas.removeEventListener("dblclick",this.resetBriCon.bind(this)),this.canvas.removeEventListener("dragenter",this.dragEnterListener.bind(this)),this.canvas.removeEventListener("dragover",this.dragOverListener.bind(this)),this.canvas.removeEventListener("drop",this.dropListener.bind(this)),this.canvas.removeEventListener("keyup",this.keyUpListener.bind(this)),this.canvas.removeEventListener("keydown",this.keyDownListener.bind(this))),this.document.removeOptsChangeCallback()}get volumes(){return this.document.volumes}set volumes(r){this.document.volumes=r}get meshes(){return this.document.meshes}set meshes(r){this.document.meshes=r}get drawBitmap(){return this.document.drawBitmap}set drawBitmap(r){this.document.drawBitmap=r}get volScaleMultiplier(){return this.scene.volScaleMultiplier}set volScaleMultiplier(r){this.setScale(r)}async saveScene(r="niivue.png"){function e(i,a){const s=document.createElement("a");document.body.appendChild(s),s.style.display="none";const o=window.URL.createObjectURL(i);s.href=o,s.download=a,s.click(),s.remove()}const n=this.canvas;if(!n)throw new Error("canvas not defined");this.drawScene(),n.toBlob(i=>{i&&(r===""&&(r=`niivue-screenshot-${new Date().toString()}.png`,r=r.replace(/\s/g,"_")),e(i,r))})}async attachTo(r,e=null){return await this.attachToCanvas(document.getElementById(r),e),Z.debug("attached to element with id: ",r),this}async attachToCanvas(r,e=null){return this.canvas=r,e===null&&(e=navigator.hardwareConcurrency>6,Z.debug("AntiAlias ",e," Threads ",navigator.hardwareConcurrency)),this.gl=this.canvas.getContext("webgl2",{alpha:!0,antialias:e}),this.uiData.max2D=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),this.uiData.max3D=this.gl.getParameter(this.gl.MAX_3D_TEXTURE_SIZE),Z.info("NIIVUE VERSION ",QC),Z.debug(`Max texture size 2D: ${this.uiData.max2D} 3D: ${this.uiData.max3D}`),this.canvas.parentElement.style.backgroundColor="black",this.opts.isResizeCanvas&&(this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight,this.resizeEventListener=()=>{requestAnimationFrame(()=>{this.resizeListener()})},window.addEventListener("resize",this.resizeEventListener),this.resizeObserver=new ResizeObserver(()=>{requestAnimationFrame(()=>{this.resizeListener()})}),this.resizeObserver.observe(this.canvas.parentElement),this.canvasObserver=new MutationObserver(n=>{for(const i of n)if(i.type==="childList"&&i.removedNodes.length>0&&Array.from(i.removedNodes).includes(this.canvas)){this.cleanup();break}}),this.canvasObserver.observe(this.canvas.parentElement,{childList:!0})),this.opts.interactive&&this.registerInteractions(),await this.init(),this.drawScene(),this}syncWith(r,e={"2d":!0,"3d":!0}){r instanceof Array||(r=[r]),this.otherNV=r,this.syncOpts={...e}}broadcastTo(r,e={"2d":!0,"3d":!0}){r instanceof Array||(r=[r]),this.otherNV=r,this.syncOpts=e}doSync3d(r){r.scene.renderAzimuth=this.scene.renderAzimuth,r.scene.renderElevation=this.scene.renderElevation,r.scene.volScaleMultiplier=this.scene.volScaleMultiplier}doSync2d(r){const e=this.frac2mm(this.scene.crosshairPos);r.scene.crosshairPos=r.mm2frac(e),r.scene.pan2Dxyzmm=ws(this.scene.pan2Dxyzmm)}doSyncGamma(r){const e=this.scene.gamma,n=r.scene.gamma;e!==n&&r.setGamma(e)}doSyncZoomPan(r){r.scene.pan2Dxyzmm=ws(this.scene.pan2Dxyzmm)}doSyncCrosshair(r){const e=this.frac2mm(this.scene.crosshairPos);r.scene.crosshairPos=r.mm2frac(e)}doSyncCalMin(r){this.volumes[0].cal_min!==r.volumes[0].cal_min&&(r.volumes[0].cal_min=this.volumes[0].cal_min,r.updateGLVolume())}doSyncCalMax(r){this.volumes[0].cal_max!==r.volumes[0].cal_max&&(r.volumes[0].cal_max=this.volumes[0].cal_max,r.updateGLVolume())}doSyncSliceType(r){r.setSliceType(this.opts.sliceType)}doSyncClipPlane(r){r.setClipPlane(this.scene.clipPlaneDepthAziElev)}sync(){if(!(!this.gl||!this.otherNV||typeof this.otherNV>"u")&&this.gl.canvas.matches(":focus"))for(let r=0;r<this.otherNV.length;r++)this.otherNV[r]!==this&&(this.syncOpts.gamma&&this.doSyncGamma(this.otherNV[r]),this.syncOpts.crosshair&&this.doSyncCrosshair(this.otherNV[r]),this.syncOpts.zoomPan&&this.doSyncZoomPan(this.otherNV[r]),this.syncOpts.sliceType&&this.doSyncSliceType(this.otherNV[r]),this.syncOpts.cal_min&&this.doSyncCalMin(this.otherNV[r]),this.syncOpts.cal_max&&this.doSyncCalMax(this.otherNV[r]),this.syncOpts.clipPlane&&this.doSyncClipPlane(this.otherNV[r]),this.syncOpts["2d"]&&this.doSync2d(this.otherNV[r]),this.syncOpts["3d"]&&this.doSync3d(this.otherNV[r]),this.otherNV[r].drawScene(),this.otherNV[r].createOnLocationChange())}arrayEquals(r,e){return Array.isArray(r)&&Array.isArray(e)&&r.length===e.length&&r.every((n,i)=>n===e[i])}textSizePoints(){this.opts.textHeight>=0&&(Z.warn("textHeight is deprecated (use fontMinPx and fontSizeScaling)"),this.opts.fontMinPx=this.opts.textHeight*217,this.opts.fontSizeScaling=.4,this.opts.textHeight=-1);const r=this.uiData.dpr||1,e=this.opts.fontMinPx,n=this.gl.canvas.width/r,i=this.gl.canvas.height/r,a=n*i,s=800*600,o=Math.max(a/s,1),l=Math.pow(o,this.opts.fontSizeScaling),c=e*l*r;this.fontPx=c,Z.debug(`${n.toFixed(0)}x${i.toFixed(0)} pts (dpi=${r}) => areaScale=${o.toFixed(2)}, scale=${l.toFixed(2)}, minPx=${this.opts.fontMinPx} fontScale=${this.opts.fontSizeScaling} fontPx=${c.toFixed(2)}`)}resizeListener(){if(!(!this.canvas||!this.gl)){if(!this.opts.isResizeCanvas){this.opts.forceDevicePixelRatio>=0&&Z.warn("this.opts.forceDevicePixelRatio requires isResizeCanvas"),this.drawScene();return}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,Z.debug("devicePixelRatio: "+this.uiData.dpr),"width"in this.canvas.parentElement?(this.canvas.width=this.canvas.parentElement.width*this.uiData.dpr,this.canvas.height=this.canvas.parentElement.height*this.uiData.dpr):(this.canvas.width=this.canvas.offsetWidth*this.uiData.dpr,this.canvas.height=this.canvas.offsetHeight*this.uiData.dpr),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.textSizePoints(),this.drawScene()}}getRelativeMousePosition(r,e){if(e=e||r.target,!e)return;const n=e.getBoundingClientRect();return{x:r.clientX-n.left,y:r.clientY-n.top}}getNoPaddingNoBorderCanvasRelativeMousePosition(r,e){return e=e||r.target,this.getRelativeMousePosition(r,e)}mouseContextMenuListener(r){r.preventDefault()}mouseDownListener(r){r.preventDefault(),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawShapeStartLocation=[NaN,NaN,NaN],this.uiData.mousedown=!0,this.opts.dragMode===7&&this.uiData.angleState==="drawing_second_line"||(this.setDragStart(0,0),this.setDragEnd(0,0)),Z.debug("mouse down"),Z.debug(r);const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(r,this.gl.canvas);if(!e)return;const[n,i]=[e.x*this.uiData.dpr,e.y*this.uiData.dpr];this.opts.clickToSegment&&(this.clickToSegmentXY=[n,i]);const a=this.getLabelAtPoint([n,i]);if(a){if(a.onClick){a.onClick(a,r);return}for(const s of this.meshes){if(s.type!=="connectome"){if(Array.isArray(a.points)&&a.points.length===3&&a.points.every(Number.isFinite)){const[o,l,c]=a.points;this.scene.crosshairPos=this.mm2frac([o,l,c]),this.updateGLVolume(),this.drawScene()}continue}for(const o of s.nodes)o.label===a&&(this.scene.crosshairPos=this.mm2frac([o.x,o.y,o.z]),this.updateGLVolume(),this.drawScene())}}this.uiData.clickedTile=this.tileIndex(n,i),r.button===dc&&r.shiftKey?(this.uiData.mouseButtonCenterDown=!0,this.setActiveDragMode(dc,!0,r.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,r,e)):r.button===dc?(this.uiData.mouseButtonLeftDown=!0,this.setActiveDragMode(dc,!1,r.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,r,e)):r.button===pp?(this.uiData.mouseButtonRightDown=!0,this.setActiveDragMode(pp,r.shiftKey,r.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,r,e)):r.button===mp&&(this.uiData.mouseButtonCenterDown=!0,this.setActiveDragMode(mp,r.shiftKey,r.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,r,e))}getMouseButtonDragMode(r,e,n){const i=this.opts.mouseEventConfig;return r===dc?i?.leftButton?e&&i.leftButton.withShift!==void 0?i.leftButton.withShift:n&&i.leftButton.withCtrl!==void 0?i.leftButton.withCtrl:i.leftButton.primary:n?8:this.opts.dragModePrimary:r===pp?i?.rightButton!==void 0?i.rightButton:this.opts.dragMode:r===mp?i?.centerButton!==void 0?i.centerButton:this.opts.dragMode:this.opts.dragMode}getTouchDragMode(r){const e=this.opts.touchEventConfig;return r?e?.doubleTouch??this.opts.dragMode:e?.singleTouch??this.opts.dragModePrimary}setActiveDragMode(r,e,n){this.uiData.activeDragMode=this.getMouseButtonDragMode(r,e,n),this.uiData.activeDragButton=r}getCurrentDragMode(){return this.uiData.activeDragMode!==null?this.uiData.activeDragMode:this.opts.dragMode}clearActiveDragMode(){this.uiData.activeDragMode=null,this.uiData.activeDragButton=null}handleMouseAction(r,e,n){if(r===8)this.mouseDown(n.x,n.y),this.mouseClick(n.x,n.y);else if(r===9)this.uiData.windowX=e.x,this.uiData.windowY=e.y;else{if(this.mousePos=[n.x*this.uiData.dpr,n.y*this.uiData.dpr],r===0)return;if(r===7)if(this.uiData.angleState==="none")this.uiData.angleState="drawing_first_line";else if(this.uiData.angleState==="drawing_second_line"){const i=[n.x*this.uiData.dpr,n.y*this.uiData.dpr],a=this.tileIndex(i[0],i[1]);let s={sliceIndex:-1,sliceType:0,slicePosition:0};if(a>=0&&a<this.screenSlices.length){const g=this.screenSlices[a].axCorSag;let v=0;g===0?v=this.scene.crosshairPos[2]:g===1?v=this.scene.crosshairPos[1]:g===2&&(v=this.scene.crosshairPos[0]),s={sliceIndex:a,sliceType:g,slicePosition:v}}const o=[this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3],i[0],i[1]],l=this.canvasPos2frac([this.uiData.angleFirstLine[0],this.uiData.angleFirstLine[1]]),c=this.canvasPos2frac([this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3]]),u=this.canvasPos2frac([o[0],o[1]]),h=this.canvasPos2frac([o[2],o[3]]);if(l[0]>=0&&c[0]>=0&&u[0]>=0&&h[0]>=0){const g=this.frac2mm(l),v=this.frac2mm(c),m=this.frac2mm(u),y=this.frac2mm(h),b={firstLineMM:{start:Me(g[0],g[1],g[2]),end:Me(v[0],v[1],v[2])},secondLineMM:{start:Me(m[0],m[1],m[2]),end:Me(y[0],y[1],y[2])},sliceIndex:s.sliceIndex,sliceType:s.sliceType,slicePosition:s.slicePosition,angle:this.calculateAngleBetweenLines(this.uiData.angleFirstLine,o)};this.document.completedAngles.push(b)}this.resetAngleMeasurement(),this.uiData.angleState="complete",this.drawScene();return}else this.uiData.angleState==="complete"&&(this.resetAngleMeasurement(),this.uiData.angleState="drawing_first_line");this.setDragStart(n.x,n.y),this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=ws(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.dragClipPlaneStartDepthAziElev=this.scene.clipPlaneDepthAziElev}}calculateMinMaxVoxIdx(r){if(r.length>2)throw new Error("array must not contain more than two values");return[Math.floor(Math.min(r[0],r[1])),Math.floor(Math.max(r[0],r[1]))]}calculateNewRange({volIdx:r=0}={}){if(this.opts.sliceType===4&&this.sliceMosaicString.length<1||this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1])return;let e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]);if(e[0]<0)return;const n=this.frac2vox(e,r);if(e=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]),e[0]<0)return;const i=this.frac2vox(e,r);let a=-Number.MAX_VALUE,s=Number.MAX_VALUE;const o=this.calculateMinMaxVoxIdx([n[0],i[0]]),l=this.calculateMinMaxVoxIdx([n[1],i[1]]),c=this.calculateMinMaxVoxIdx([n[2],i[2]]);n[0]-i[0]===0?o[1]=n[0]+1:n[1]-i[1]===0?l[1]=n[1]+1:n[2]-i[2]===0&&(c[1]=n[2]+1);const u=this.volumes[r].hdr,h=this.volumes[r].img;if(!u||!h)return;const g=u.dims[1],v=u.dims[2];for(let b=c[0];b<c[1];b++){const x=b*g*v;for(let A=l[0];A<l[1];A++){const C=A*g;for(let E=o[0];E<o[1];E++){const S=x+C+E;s>h[S]&&(s=h[S]),a<h[S]&&(a=h[S])}}}if(s>=a)return;const m=HC(u,s),y=HC(u,a);this.volumes[r].cal_min=m,this.volumes[r].cal_max=y,this.onIntensityChange(this.volumes[r])}generateMouseUpCallback(r,e){const n=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]),i=this.tileIndex(this.uiData.dragEnd[0],this.uiData.dragEnd[1]);let a=-1;n===i&&(a=i);let s=-1;a>=0&&(s=this.screenSlices[a].axCorSag);const o=this.frac2mm(r),l=this.frac2mm(e),c=Kt();gC(c,Me(o[0],o[1],o[2]),Me(l[0],l[1],l[2]));const u=$c(c),h=this.frac2vox(r),g=this.frac2vox(e);this.onDragRelease({fracStart:r,fracEnd:e,voxStart:h,voxEnd:g,mmStart:o,mmEnd:l,mmLength:u,tileIdx:a,axCorSag:s})}mouseUpListener(){function r(a){return Object.prototype.toString.call(a).indexOf("Function")>-1}const e={mouseButtonRightDown:this.uiData.mouseButtonRightDown,mouseButtonCenterDown:this.uiData.mouseButtonCenterDown,isDragging:this.uiData.isDragging,mousePos:this.mousePos,fracPos:this.canvasPos2frac(this.mousePos)};this.uiData.mousedown=!1,this.uiData.mouseButtonRightDown=!1;const n=this.uiData.mouseButtonCenterDown;this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonLeftDown=!1;const i=this.getCurrentDragMode();if(this.drawPenFillPts.length>0?this.drawPenFilled():this.opts.drawingEnabled&&!isNaN(this.drawPenLocation[0])?this.drawAddUndoBitmap():this.opts.drawingEnabled&&!isNaN(this.drawShapeStartLocation[0])&&(this.opts.penType===1||this.opts.penType===2)&&(this.opts.penValue===0?this.drawAddUndoBitmap():this.drawAddUndoBitmap(this.drawFillOverwrites),this.drawShapePreviewBitmap=null),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawShapeStartLocation=[NaN,NaN,NaN],this.drawShapePreviewBitmap&&(this.drawBitmap=this.drawShapePreviewBitmap,this.drawShapePreviewBitmap=null,this.refreshDrawing(!0,!1)),r(this.onMouseUp)&&this.onMouseUp(e),this.uiData.isDragging){if(this.uiData.isDragging=!1,i===7){if(this.uiData.angleState==="drawing_first_line"){this.uiData.angleFirstLine=[this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],this.uiData.angleState="drawing_second_line",this.uiData.isDragging=!0,this.drawScene();return}else if(this.uiData.angleState==="drawing_second_line"){this.uiData.angleState="complete",this.clearActiveDragMode(),this.drawScene();return}}i===5&&this.drawScene();const a=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),s=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);if(this.generateMouseUpCallback(a,s),i===6){this.clearActiveDragMode();return}if(i===1){if(n){this.clearActiveDragMode();return}if(this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1]){this.clearActiveDragMode();return}this.calculateNewRange({volIdx:0}),this.refreshLayers(this.volumes[0],0)}if(i===2){const o=this.getCurrentSliceInfo(),l=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),c=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);if(l[0]>=0&&c[0]>=0){const u=this.frac2mm(l),h=this.frac2mm(c);this.document.completedMeasurements.push({startMM:Me(u[0],u[1],u[2]),endMM:Me(h[0],h[1],h[2]),sliceIndex:o.sliceIndex,sliceType:o.sliceType,slicePosition:o.slicePosition,distance:$_(Me(u[0],u[1],u[2]),Me(h[0],h[1],h[2]))})}this.clearActiveDragMode(),this.drawScene();return}}this.clearActiveDragMode(),this.drawScene()}checkMultitouch(r){if(this.uiData.touchdown&&!this.uiData.multiTouchGesture){const e=this.canvas.getBoundingClientRect();this.mouseDown(r.touches[0].clientX-e.left,r.touches[0].clientY-e.top),this.mouseClick(r.touches[0].clientX-e.left,r.touches[0].clientY-e.top)}}touchStartListener(r){r.preventDefault(),this.uiData.touchTimer||(this.uiData.touchTimer=setTimeout(()=>{this.resetBriCon(r)},this.opts.longTouchTimeout)),this.uiData.touchdown=!0,this.uiData.currentTouchTime=new Date().getTime();const e=this.uiData.currentTouchTime-this.uiData.lastTouchTime;if(e<this.opts.doubleTouchTimeout&&e>0){this.uiData.doubleTouch=!0,this.setDragStart(r.targetTouches[0].clientX-r.target.getBoundingClientRect().left,r.targetTouches[0].clientY-r.target.getBoundingClientRect().top),this.resetBriCon(r),this.uiData.lastTouchTime=this.uiData.currentTouchTime;return}else this.uiData.doubleTouch=!1,this.setDragStart(0,0),this.setDragEnd(0,0),this.uiData.lastTouchTime=this.uiData.currentTouchTime;this.uiData.touchdown&&r.touches.length<2?this.uiData.multiTouchGesture=!1:this.uiData.multiTouchGesture=!0,setTimeout(this.checkMultitouch.bind(this),1,r)}touchEndListener(r){if(r.preventDefault(),this.uiData.touchdown=!1,this.uiData.lastTwoTouchDistance=0,this.uiData.multiTouchGesture=!1,this.uiData.touchTimer&&(clearTimeout(this.uiData.touchTimer),this.uiData.touchTimer=null),this.uiData.isDragging){this.uiData.isDragging=!1,this.getCurrentDragMode()===1&&(this.calculateNewRange(),this.refreshLayers(this.volumes[0],0));const e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),n=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);this.generateMouseUpCallback(e,n)}this.mouseUpListener()}windowingHandler(r,e,n=0){const i=this.uiData.windowX,a=this.uiData.windowY;let s=this.volumes[0].cal_min,o=this.volumes[0].cal_max;const l=this.volumes[0].global_min,c=this.volumes[0].global_max;e<a?(s+=1,o+=1):e>a&&(s-=1,o-=1),r>i?(s-=1,o+=1):r<i&&(s+=1,o-=1),o-s<1&&(o=s+1),s<l&&(s=l),o>c&&(o=c),s>o&&(s=o-1),this.volumes[n].cal_min=s,this.volumes[n].cal_max=o,this.refreshLayers(this.volumes[n],0),this.uiData.windowX=r,this.uiData.windowY=e}mouseLeaveListener(){this.clickToSegmentIsGrowing&&(Z.debug("Mouse left canvas, stopping clickToSegment preview."),this.clickToSegmentIsGrowing=!1,this.refreshDrawing(!0,!1)),this.opts.drawingEnabled&&!isNaN(this.drawPenLocation[0])&&(Z.debug("Mouse left canvas during drawing, resetting pen state."),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawPenFillPts=[]),this.opts.drawingEnabled&&!isNaN(this.drawShapeStartLocation[0])&&(Z.debug("Mouse left canvas during shape drawing, resetting shape state."),this.drawShapeStartLocation=[NaN,NaN,NaN],this.drawShapePreviewBitmap&&(this.drawBitmap=this.drawShapePreviewBitmap,this.drawShapePreviewBitmap=null,this.refreshDrawing(!0,!1))),this.uiData.isDragging&&(Z.debug("Mouse left canvas during drag, resetting drag state."),this.uiData.isDragging=!1,this.uiData.mouseButtonLeftDown=!1,this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonRightDown=!1,this.uiData.mousedown=!1,this.drawScene())}mouseMoveListener(r){if(this.uiData.mousedown){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(r,this.gl.canvas);if(!e)return;const n=e.x*this.uiData.dpr,i=e.y*this.uiData.dpr;if(this.tileIndex(n,i)!==this.uiData.clickedTile)return;const s=this.getCurrentDragMode();if(s===8){this.mouseMove(e.x,e.y),this.mouseClick(e.x,e.y),this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY;return}else if(s===9){this.windowingHandler(e.x,e.y),this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY;return}else this.setDragEnd(e.x,e.y);this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY}else if(this.getCurrentDragMode()===7&&this.uiData.angleState==="drawing_second_line"){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(r,this.gl.canvas);if(!e)return;this.setDragEnd(e.x,e.y),this.drawScene()}else if(!this.uiData.mousedown&&this.opts.clickToSegment){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(r,this.gl.canvas);if(!e)return;const n=e.x*this.uiData.dpr,i=e.y*this.uiData.dpr;this.mousePos=[n,i];const a=this.tileIndex(n,i);a>=0&&this.opts.drawingEnabled&&this.screenSlices[a].axCorSag<=2&&(this.clickToSegmentXY=[n,i],this.clickToSegmentIsGrowing=!0,this.doClickToSegment({x:n,y:i,tileIndex:a}))}}resetBriCon(r=null){if(this.uiData.isDragging)return;let e=!1;this.opts.sliceType===4&&(e=!0);let n=0,i=0;if(r!==null&&("targetTouches"in r?(n=r.targetTouches[0].clientX-r.target.getBoundingClientRect().left,i=r.targetTouches[0].clientY-r.target.getBoundingClientRect().top):(n=r.offsetX,i=r.offsetY),n*=this.uiData.dpr,i*=this.uiData.dpr,this.inRenderTile(n,i)>=0&&(e=!0)),e){this.uiData.mouseDepthPicker=!0,this.drawScene(),this.drawScene();return}this.getCurrentDragMode()!==4&&(this.volumes.length<1||this.uiData.doubleTouch||(this.volumes[0].cal_min=this.volumes[0].robust_min,this.volumes[0].cal_max=this.volumes[0].robust_max,this.onIntensityChange(this.volumes[0]),this.refreshLayers(this.volumes[0],0),this.drawScene()))}setDragStart(r,e){r*=this.uiData.dpr,e*=this.uiData.dpr,this.uiData.dragStart[0]=r,this.uiData.dragStart[1]=e}setDragEnd(r,e){r*=this.uiData.dpr,e*=this.uiData.dpr,this.uiData.dragEnd[0]=r,this.uiData.dragEnd[1]=e}touchMoveListener(r){if(this.uiData.touchdown&&r.touches.length<2){const e=this.canvas.getBoundingClientRect();if(this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=ws(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.doubleTouch&&this.uiData.isDragging){this.setDragEnd(r.targetTouches[0].clientX-r.target.getBoundingClientRect().left,r.targetTouches[0].clientY-r.target.getBoundingClientRect().top),this.drawScene();return}const n=this.getTouchDragMode(!1);n===8?(this.mouseClick(r.touches[0].clientX-e.left,r.touches[0].clientY-e.top),this.mouseMove(r.touches[0].clientX-e.left,r.touches[0].clientY-e.top)):n===9&&(this.windowingHandler(r.touches[0].pageX,r.touches[0].pageY),this.drawScene())}else this.handlePinchZoom(r)}handlePinchZoom(r){if(r.targetTouches.length===2&&r.changedTouches.length===2){const e=Math.hypot(r.touches[0].pageX-r.touches[1].pageX,r.touches[0].pageY-r.touches[1].pageY),n=this.canvas.getBoundingClientRect();this.mousePos=[r.touches[0].clientX-n.left,r.touches[0].clientY-n.top],e<this.uiData.lastTwoTouchDistance?this.sliceScroll2D(-.01,r.touches[0].clientX-n.left,r.touches[0].clientY-n.top):this.sliceScroll2D(.01,r.touches[0].clientX-n.left,r.touches[0].clientY-n.top),this.uiData.lastTwoTouchDistance=e}}keyUpListener(r){if(r.code===this.opts.clipPlaneHotKey){const e=new Date().getTime();if(e-this.lastCalled>this.opts.keyDebounceTime){switch(this.currentClipPlaneIndex=(this.currentClipPlaneIndex+1)%7,this.currentClipPlaneIndex){case 0:this.scene.clipPlaneDepthAziElev=[2,0,0];break;case 1:this.scene.clipPlaneDepthAziElev=[0,270,0];break;case 2:this.scene.clipPlaneDepthAziElev=[0,90,0];break;case 3:this.scene.clipPlaneDepthAziElev=[0,0,0];break;case 4:this.scene.clipPlaneDepthAziElev=[0,180,0];break;case 5:this.scene.clipPlaneDepthAziElev=[0,0,-90];break;case 6:this.scene.clipPlaneDepthAziElev=[0,0,90];break}this.setClipPlane(this.scene.clipPlaneDepthAziElev)}this.lastCalled=e}else if(r.code===this.opts.viewModeHotKey){const e=new Date().getTime();e-this.lastCalled>this.opts.keyDebounceTime&&(this.setSliceType((this.opts.sliceType+1)%5),this.lastCalled=e)}}keyDownListener(r){r.code==="KeyH"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth-1,this.scene.renderElevation):r.code==="KeyL"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth+1,this.scene.renderElevation):r.code==="KeyJ"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation+1):r.code==="KeyK"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation-1):r.code==="KeyH"&&this.opts.sliceType!==4?this.moveCrosshairInVox(-1,0,0):r.code==="KeyL"&&this.opts.sliceType!==4?this.moveCrosshairInVox(1,0,0):r.code==="KeyU"&&this.opts.sliceType!==4&&r.ctrlKey?this.moveCrosshairInVox(0,0,1):r.code==="KeyD"&&this.opts.sliceType!==4&&r.ctrlKey?this.moveCrosshairInVox(0,0,-1):r.code==="KeyJ"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,-1,0):r.code==="KeyK"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,1,0):r.code==="KeyM"&&this.opts.sliceType!==4?(this.opts.dragMode++,this.opts.dragMode>=4&&(this.opts.dragMode=0),Z.info("drag mode changed to ",GT[this.opts.dragMode])):r.code==="ArrowLeft"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D-1):r.code==="ArrowRight"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D+1):r.code==="Slash"&&r.shiftKey&&alert(`NIIVUE VERSION: ${QC}`)}wheelListener(r){if(this.thumbnailVisible||this.opts.sliceMosaicString.length>0)return;r.preventDefault(),r.stopPropagation();const e=this.uiData.dragStart.reduce((c,u)=>c+u,0),n=this.uiData.dragEnd.reduce((c,u)=>c+u,0),i=e>0&&n>0;if(this.getCurrentDragMode()===6&&i){const c=r.deltaY>0?1:-1;this.uiData.dragStart[0]<this.uiData.dragEnd[0]?(this.uiData.dragStart[0]-=c,this.uiData.dragEnd[0]+=c):(this.uiData.dragStart[0]+=c,this.uiData.dragEnd[0]-=c),this.uiData.dragStart[1]<this.uiData.dragEnd[1]?(this.uiData.dragStart[1]-=c,this.uiData.dragEnd[1]+=c):(this.uiData.dragStart[1]+=c,this.uiData.dragEnd[1]-=c),this.uiData.isDragging=!0,this.drawScene(),this.uiData.isDragging=!1;const u=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]);u>=0?this.generateMouseUpCallback(this.screenXY2TextureFrac(this.uiData.dragStart[0],this.uiData.dragStart[1],u),this.screenXY2TextureFrac(this.uiData.dragEnd[0],this.uiData.dragEnd[1],u)):Z.warn("Could not generate drag release callback for ROI selection: Invalid tile index.");return}let a=r.deltaY<0?-.01:.01;if(this.opts.invertScrollDirection&&(a=-a),this.opts.clickToSegment){a<0?(this.opts.clickToSegmentPercent-=.01,this.opts.clickToSegmentPercent=Math.max(this.opts.clickToSegmentPercent,0)):(this.opts.clickToSegmentPercent+=.01,this.opts.clickToSegmentPercent=Math.min(this.opts.clickToSegmentPercent,1));const c=this.clickToSegmentXY[0],u=this.clickToSegmentXY[1],h=this.tileIndex(c,u);h>=0&&this.screenSlices[h].axCorSag<=2&&(Z.debug(`Adjusting clickToSegment threshold: ${this.opts.clickToSegmentPercent.toFixed(3)}`),this.clickToSegmentIsGrowing=!0,this.doClickToSegment({x:c,y:u,tileIndex:h}));return}const s=this.canvas.getBoundingClientRect(),o=r.clientX-s.left,l=r.clientY-s.top;if(this.getCurrentDragMode()===3&&this.inRenderTile(this.uiData.dpr*o,this.uiData.dpr*l)===-1){const c=a<0?1:-1;let u=this.scene.pan2Dxyzmm[3]*(1+10*(.01*c));u=Math.round(u*10)/10;const h=this.scene.pan2Dxyzmm[3]-u;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=u),this.scene.pan2Dxyzmm[3]=u;const g=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=h*g[0],this.scene.pan2Dxyzmm[1]+=h*g[1],this.scene.pan2Dxyzmm[2]+=h*g[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.sliceScroll2D(a,o,l)}registerInteractions(){if(!this.canvas)throw new Error("canvas undefined");this.canvas.addEventListener("mousedown",this.mouseDownListener.bind(this)),this.canvas.addEventListener("mouseup",this.mouseUpListener.bind(this)),this.canvas.addEventListener("mousemove",this.mouseMoveListener.bind(this)),this.canvas.addEventListener("mouseleave",this.mouseLeaveListener.bind(this)),this.canvas.addEventListener("touchstart",this.touchStartListener.bind(this)),this.canvas.addEventListener("touchend",this.touchEndListener.bind(this)),this.canvas.addEventListener("touchmove",this.touchMoveListener.bind(this)),this.canvas.addEventListener("wheel",this.wheelListener.bind(this)),this.canvas.addEventListener("contextmenu",this.mouseContextMenuListener.bind(this)),this.canvas.addEventListener("dblclick",this.resetBriCon.bind(this)),this.canvas.addEventListener("dragenter",this.dragEnterListener.bind(this),!1),this.canvas.addEventListener("dragover",this.dragOverListener.bind(this),!1),this.canvas.addEventListener("drop",r=>{this.dropListener(r).catch(console.error)},!1),this.canvas.setAttribute("tabindex","0"),this.canvas.addEventListener("keyup",this.keyUpListener.bind(this),!1),this.canvas.addEventListener("keydown",this.keyDownListener.bind(this),!1)}dragEnterListener(r){r.stopPropagation(),r.preventDefault()}dragOverListener(r){r.stopPropagation(),r.preventDefault()}getFileExt(r,e=!0){Z.debug("fullname: ",r);const n=/(?:\.([^.]+))?$/;let i=n.exec(r)[1];if(i=i.toUpperCase(),i==="GZ")i=n.exec(r.slice(0,-3))[1],i=i.toUpperCase();else if(i==="CBOR"){const a=i;i=n.exec(r.slice(0,-5))[1],i=i.toUpperCase(),i=`${i}.${a}`}return e?i:i.toLowerCase()}async addVolumeFromUrl(r){const e=await yn.loadFromUrl(r);return this.document.addImageOptions(e,r),e.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(e,r.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(r,e),this.addVolume(e),e}async addVolumesFromUrl(r){const e=r.map(async i=>{const a=this.getFileExt(i.name||i.url);if(a==="DCM")throw new Error("DICOM files must be loaded using useDicomLoader");if(this.loaders[a]){let l=i.url;const c=this.loaders[a].toExt;let u=i.name||i.url;if(u=u.split("/").pop(),typeof i.url=="string"){const g=i.url;try{const v=await fetch(g);if(!v.ok)throw new Error(`Failed to load file: ${v.statusText}`);l=await v.arrayBuffer()}catch(v){throw new Error(`Failed to load url ${g}: ${v}`)}}const h=await this.loaders[a].loader(l);i.url=h,i.name=`${u}.${c}`}const s={url:i.url,headers:i.headers,name:i.name,colormap:i.colormap?i.colormap:i.colorMap,colormapNegative:i.colormapNegative?i.colormapNegative:i.colorMapNegative,opacity:i.opacity,urlImgData:i.urlImgData,cal_min:i.cal_min,cal_max:i.cal_max,trustCalMinMax:this.opts.trustCalMinMax,isManifest:i.isManifest,frame4D:i.frame4D,limitFrames4D:i.limitFrames4D||this.opts.limitFrames4D,colorbarVisible:i.colorbarVisible},o=await yn.loadFromUrl(s);return this.document.addImageOptions(o,s),o.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(o,s.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(s,o),o}),n=await Promise.all(e);for(let i=0;i<n.length;i++)this.addVolume(n[i]);return n}getMediaByUrl(r){return[...this.mediaUrlMap.entries()].filter(e=>e[1]===r).map(e=>e[0]).pop()}removeVolumeByUrl(r){const e=this.getMediaByUrl(r);if(e)this.removeVolume(e);else throw new Error("No volume with URL present")}async traverseFileTree(r,e="",n){return new Promise(i=>{if(r.isFile)r.file(a=>{a.fullPath=e+a.name,a._webkitRelativePath=e+a.name,n.push(a),i(n)});else if(r.isDirectory){const a=r.createReader(),s=()=>{a.readEntries(o=>{if(o.length>0){const l=[];for(const c of o)l.push(this.traverseFileTree(c,e+r.name+"/",n));Promise.all(l).then(s).catch(c=>{throw c})}else i(n)})};s()}})}readDirectory(r){const e=r.createReader();let n=[];const i=async s=>{const o=[],l=async c=>new Promise((u,h)=>c.file(u,h));for(let c=0;c<s.length;c++)o.push(await l(s[c]));return o},a=()=>{e.readEntries(s=>{s.length?(n=n.concat(s),a()):i(n).then(async()=>{}).catch(o=>{throw o})})};return a(),n}isMeshExt(r){const e=this.getFileExt(r);return Z.debug("dropped ext"),Z.debug(e),ao.includes(e)}async loadFromArrayBuffer(r,e){const n=this.getFileExt(e);if(ao.includes(n)){await this.addMeshFromUrl({url:e,buffer:r});return}const i=Yd(e);i.buffer=r,i.name=e,await this.addVolumeFromUrl(i)}async loadFromFile(r){const e=this.getFileExt(r.name);if(ao.includes(e)){await Il.loadFromFile({file:r,gl:this.gl,name:r.name}).then(n=>{this.addMesh(n)});return}await yn.loadFromFile({file:r,name:r.name}).then(n=>{this.addVolume(n)})}useLoader(r,e,n){this.loaders={...this.loaders,[e.toUpperCase()]:{loader:r,toExt:n}}}useDicomLoader(r){this.dicomLoader=r}getDicomLoader(){return this.dicomLoader}async dropListener(r){if(r.stopPropagation(),r.preventDefault(),!this.opts.dragAndDropEnabled)return;const e=[],n=r.dataTransfer;if(!n)return;const i=n.getData("text/uri-list");if(i){const a=Yd(i),s=this.getFileExt(i);Z.debug("dropped ext"),Z.debug(s),ao.includes(s)?this.addMeshFromUrl({url:i}).catch(o=>{throw o}):s==="NVD"?this.loadDocumentFromUrl(i).catch(o=>{throw o}):this.addVolumeFromUrl(a).catch(o=>{throw o})}else{const a=n.items;if(a.length>0){!r.shiftKey&&!r.altKey&&(this.volumes=[],this.overlays=[],this.meshes=[]),this.closeDrawing(),this.closePAQD();for(const s of Array.from(a)){const o=s.webkitGetAsEntry();if(Z.debug(o),!o)throw new Error("could not get entry from file");if(o.isFile){const l=this.getFileExt(o.name);let c;if(o.name.lastIndexOf("HEAD")!==-1)for(const u of Array.from(a)){const h=u.webkitGetAsEntry();if(!h)throw new Error("could not get paired entry");const g=o.name.substring(0,o.name.lastIndexOf("HEAD")),v=h.name.substring(0,h.name.lastIndexOf("BRIK"));g===v&&(c=h)}if(o.name.lastIndexOf("BRIK")!==-1)continue;if(this.loaders[l]){const u=await Ej(o);await this.loadImages([{url:u,name:`${o.name}`}]);continue}if(ao.includes(l)){o.file(u=>{(async()=>{try{const h=await Il.loadFromFile({file:u,gl:this.gl,name:u.name});this.addMesh(h)}catch(h){console.error("Error loading mesh:",h)}})().catch(h=>console.error(h))});continue}else if(l==="NVD"){o.file(u=>{(async()=>{try{const h=await lp.loadFromFile(u);await this.loadDocument(h),Z.debug("loaded document")}catch(h){console.error(h)}})().catch(h=>console.error(h))});break}o.file(u=>{(async()=>{try{if(c)c.file(h=>{(async()=>{try{const g=await yn.loadFromFile({file:u,urlImgData:h,limitFrames4D:this.opts.limitFrames4D});this.addVolume(g)}catch(g){console.error(g)}})().catch(console.error)});else{const h=await yn.loadFromFile({file:u,urlImgData:c,limitFrames4D:this.opts.limitFrames4D});r.altKey?(Z.debug("alt key detected: assuming this is a drawing overlay"),this.drawClearAllUndoBitmaps(),this.loadDrawing(h)):this.addVolume(h)}}catch(h){console.error(h)}})().catch(console.error)})}else o.isDirectory&&this.traverseFileTree(o,"",e).then(l=>{const c=this.getDicomLoader().loader;if(!c)throw new Error("No loader for DICOM files");c(l).then(async u=>{const h=u.map(g=>yn.loadFromUrl({url:g.data,name:g.name,limitFrames4D:this.opts.limitFrames4D}));Promise.all(h).then(async g=>{await this.onDicomLoaderFinishedWithImages(g)}).catch(g=>{throw g})}).catch(u=>{console.error("Error loading DICOM files:",u)})}).catch(l=>{throw l})}}}this.drawScene()}setMultiplanarPadPixels(r){this.opts.multiplanarPadPixels=r,this.drawScene()}setMultiplanarLayout(r){typeof r=="string"&&(r=parseInt(r)),this.opts.multiplanarLayout=r,this.drawScene()}setCornerOrientationText(r){this.opts.isCornerOrientationText=r,this.updateGLVolume()}setIsOrientationTextVisible(r){this.opts.isOrientationTextVisible=r,this.drawScene()}setShowAllOrientationMarkers(r){this.opts.showAllOrientationMarkers=r,this.drawScene()}setHeroImage(r){this.opts.heroImageFraction=r,this.drawScene()}setCustomLayout(r){for(let e=0;e<r.length;e++){const[n,i,a,s]=r[e].position,o=n+a,l=i+s;for(let c=e+1;c<r.length;c++){const[u,h,g,v]=r[c].position,m=u+g,y=h+v,b=n<m&&o>u,x=i<y&&l>h;if(b&&x)throw new Error(`Custom layout is invalid. Tile ${e} overlaps with tile ${c}.`)}}this.customLayout=r,this.drawScene()}clearCustomLayout(){this.customLayout=null,this.drawScene()}getCustomLayout(){return this.customLayout}setRadiologicalConvention(r){this.opts.isRadiologicalConvention=r,this.updateGLVolume()}setDefaults(r={},e=!1){this.document.opts={...Di},this.scene.sceneData={...Sc};for(const n in r)typeof r[n]=="function"?this[n]=r[n]:this.opts[n]=Di[n]===void 0?Di[n]:r[n];if(this.scene.pan2Dxyzmm=[0,0,0,1],e&&this.volumes&&this.volumes.length>0)for(let n=0;n<this.volumes.length;n++)this.volumes[n].cal_min=this.volumes[n].robust_min,this.volumes[n].cal_max=this.volumes[n].robust_max;this.updateGLVolume()}setMeshThicknessOn2D(r){this.opts.meshThicknessOn2D=r,this.updateGLVolume()}setSliceMosaicString(r){this.sliceMosaicString=r,this.updateGLVolume()}setSliceMM(r){this.opts.isSliceMM=r,this.updateGLVolume()}setAdditiveBlend(r){this.opts.isAdditiveBlend=r,this.updateGLVolume()}getRadiologicalConvention(){return this.opts.isRadiologicalConvention}setHighResolutionCapable(r){typeof r=="boolean"&&(r=r?0:-1),this.opts.forceDevicePixelRatio=r,this.resizeListener(),this.drawScene()}watchOptsChanges(r){this.onOptsChange=r}unwatchOptsChanges(){this.onOptsChange=()=>{}}addVolume(r){this.volumes.push(r);const e=this.volumes.length===1?0:this.volumes.length-1;this.setVolume(r,e),this.onImageLoaded(r),Z.debug("loaded volume",r.name),Z.debug(r)}addMesh(r){this.meshes.push(r);const e=this.meshes.length===1?0:this.meshes.length-1;this.setMesh(r,e),this.onMeshLoaded(r)}getVolumeIndexByID(r){const e=this.volumes.length;for(let n=0;n<e;n++)if(this.volumes[n].id===r)return n;return-1}drawAddUndoBitmap(r=!0){if(!this.drawBitmap||this.drawBitmap.length<1){Z.debug("drawAddUndoBitmap error: No drawing open");return}if(!r&&this.drawUndoBitmaps.length>0){const e=this.drawBitmap.length,n=g2(this.drawUndoBitmaps[this.currentDrawUndoBitmap],e);for(let i=0;i<e;i++)n[i]>0&&(this.drawBitmap[i]=n[i]);this.refreshDrawing(!1)}this.currentDrawUndoBitmap++,this.currentDrawUndoBitmap>=this.opts.maxDrawUndoBitmaps&&(this.currentDrawUndoBitmap=0),this.drawUndoBitmaps[this.currentDrawUndoBitmap]=yY(this.drawBitmap)}drawClearAllUndoBitmaps(){if(this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,!(!this.drawUndoBitmaps||this.drawUndoBitmaps.length<1))for(let r=this.drawUndoBitmaps.length-1;r>=0;r--)this.drawUndoBitmaps[r]=new Uint8Array}drawUndo(){const{drawBitmap:r,currentDrawUndoBitmap:e}=AY({drawUndoBitmaps:this.drawUndoBitmaps,currentDrawUndoBitmap:this.currentDrawUndoBitmap,drawBitmap:this.drawBitmap});this.drawBitmap=r,this.currentDrawUndoBitmap=e,this.refreshDrawing(!0)}loadDrawing(r){if(this.drawBitmap&&Z.debug("Overwriting open drawing!"),!this.back)throw new Error("back undefined");this.drawClearAllUndoBitmaps();const e=r.hdr.dims;if(e[1]!==this.back.hdr.dims[1]||e[2]!==this.back.hdr.dims[2]||e[3]!==this.back.hdr.dims[3])return Z.debug("drawing dimensions do not match background image"),!1;r.img.constructor!==Uint8Array&&Z.debug("Drawings should be UINT8");const n=r.permRAS,i=e[1]*e[2]*e[3];this.drawBitmap=new Uint8Array(i),this.opts.is2DSliceShader?this.drawTexture=this.r8Tex2D(this.drawTexture,gs,this.back.dims,!0):this.drawTexture=this.r8Tex(this.drawTexture,gs,this.back.dims,!0);const a=[0,0,0];for(let y=0;y<3;y++)for(let b=0;b<3;b++)Math.abs(n[y])-1===b&&(a[b]=y*Math.sign(n[y]));let s=1;const o=[1,1,1],l=[!1,!1,!1];for(let y=0;y<a.length;y++)for(let b=0;b<a.length;b++)Math.abs(a[b])===y&&(o[b]=s,(a[b]<0||Object.is(a[b],-0))&&(l[b]=!0),s*=e[b+1]);let c=qe.range(0,e[1]-1,1);l[0]&&(c=qe.range(e[1]-1,0,-1));for(let y=0;y<e[1];y++)c[y]*=o[0];let u=qe.range(0,e[2]-1,1);l[1]&&(u=qe.range(e[2]-1,0,-1));for(let y=0;y<e[2];y++)u[y]*=o[1];let h=qe.range(0,e[3]-1,1);l[2]&&(h=qe.range(e[3]-1,0,-1));for(let y=0;y<e[3];y++)h[y]*=o[2];const g=r.img,v=this.drawBitmap;let m=0;for(let y=0;y<e[3];y++)for(let b=0;b<e[2];b++)for(let x=0;x<e[1];x++)v[c[x]+u[b]+h[y]]=g[m],m++;return this.drawAddUndoBitmap(),this.refreshDrawing(!1),this.drawScene(),!0}binarize(r){const e=r.hdr.dims,n=e[1]*e[2]*e[3],i=new Uint8Array(n);for(let a=0;a<n;a++)r.img[a]!==0&&(i[a]=1);r.img=i,r.hdr.datatypeCode=2,r.hdr.cal_min=0,r.hdr.cal_max=1}async loadDrawingFromUrl(r,e=!1){this.drawBitmap&&Z.debug("Overwriting open drawing!"),this.drawClearAllUndoBitmaps();let n=!1;try{const i=await yn.loadFromUrl(Yd(r));e&&await this.binarize(i),n=this.loadDrawing(i)}catch{Z.error("loadDrawingFromUrl() failed to load "+r),this.drawClearAllUndoBitmaps()}return n}findOtsu(r=2){if(this.volumes.length<1)return[];const e=this.volumes[0].img,n=e.length;if(n<1)return[];const i=256,a=i-1,s=new Array(i).fill(0),o=this.volumes[0].cal_min,l=this.volumes[0].cal_max;if(l<=o)return[];const c=(l-o)/i;function u(A){return A*c+o}const h=(i-1)/Math.abs(l-o),g=this.volumes[0].hdr.scl_inter,v=this.volumes[0].hdr.scl_slope;for(let A=0;A<n;A++){let C=e[A]*v+g;C=Math.min(Math.max(C,o),l),C=Math.round((C-o)*h),s[C]++}const m=Array(i).fill(0).map(()=>Array(i).fill(0)),y=Array(i).fill(0).map(()=>Array(i).fill(0));for(let A=1;A<i;++A)m[A][A]=s[A],y[A][A]=A*s[A];for(let A=1;A<i-1;++A)m[1][A+1]=m[1][A]+s[A+1],y[1][A+1]=y[1][A]+(A+1)*s[A+1];for(let A=2;A<i;A++)for(let C=A+1;C<i;C++)m[A][C]=m[1][C]-m[1][A-1],y[A][C]=y[1][C]-y[1][A-1];for(let A=1;A<i;++A)for(let C=A+1;C<i;C++)m[A][C]!==0&&(m[A][C]=y[A][C]*y[A][C]/m[A][C]);let b=0;const x=[1/0,1/0,1/0];if(r>3)for(let A=0;A<i-3;A++)for(let C=A+1;C<i-2;C++)for(let E=C+1;E<i-1;E++){const S=m[0][A]+m[A+1][C]+m[C+1][E]+m[E+1][a];S>b&&(x[0]=A,x[1]=C,x[2]=E,b=S)}else if(r===3)for(let A=0;A<i-2;A++)for(let C=A+1;C<i-1;C++){const E=m[0][A]+m[A+1][C]+m[C+1][a];E>b&&(x[0]=A,x[1]=C,b=E)}else for(let A=0;A<i-1;A++){const C=m[0][A]+m[A+1][a];C>b&&(x[0]=A,b=C)}return[u(x[0]),u(x[1]),u(x[2])]}drawOtsu(r=2){if(this.volumes.length===0)return;const e=this.volumes[0].img.length,n=this.findOtsu(r);if(n.length<3)return;this.drawBitmap||this.createEmptyDrawing();const i=this.drawBitmap,a=this.volumes[0].img;for(let s=0;s<e;s++){if(i[s]!==0)continue;const o=a[s];o>n[0]&&(i[s]=1),o>n[1]&&(i[s]=2),o>n[2]&&(i[s]=3)}this.drawAddUndoBitmap(),this.refreshDrawing(!0)}removeHaze(r=5,e=0){const n=this.volumes[e].img,i=this.volumes[e].hdr,a=n.length;let s=2;(r===5||r===1)&&(s=4),(r===4||r===2)&&(s=3);const o=this.findOtsu(s);if(o.length<3)return;let l=o[0];r===1&&(l=o[2]),r===2&&(l=o[1]);const c=i.scl_inter,u=i.scl_slope,h=this.volumes[e].global_min;for(let g=0;g<a;g++)n[g]*u+c<l&&(n[g]=h);this.refreshLayers(this.volumes[e],0),this.drawScene()}async saveImage(r=eE){const e={...eE,...r},{filename:n,isSaveDrawing:i,volumeByIndex:a}=e;if(Z.debug("saveImage",n,i,a),this.back?.dims===void 0)return Z.debug("No voxelwise image open"),!1;if(i){if(!this.drawBitmap)return Z.debug("No drawing open"),!1;const o=this.volumes[0].permRAS;if(o[0]===1&&o[1]===2&&o[2]===3)return Z.debug("saving drawing"),await this.volumes[0].saveToDisk(n,this.drawBitmap);{Z.debug("saving drawing");const l=this.volumes[0].hdr.dims,c=[0,0,0];for(let E=0;E<3;E++)for(let S=0;S<3;S++)Math.abs(o[E])-1===S&&(c[S]=E*Math.sign(o[E]));let u=1;const h=[1,1,1],g=[!1,!1,!1];for(let E=0;E<c.length;E++)for(let S=0;S<c.length;S++)Math.abs(c[S])===E&&(h[S]=u,(c[S]<0||Object.is(c[S],-0))&&(g[S]=!0),u*=l[S+1]);let v=qe.range(0,l[1]-1,1);g[0]&&(v=qe.range(l[1]-1,0,-1));for(let E=0;E<l[1];E++)v[E]*=h[0];let m=qe.range(0,l[2]-1,1);g[1]&&(m=qe.range(l[2]-1,0,-1));for(let E=0;E<l[2];E++)m[E]*=h[1];let y=qe.range(0,l[3]-1,1);g[2]&&(y=qe.range(l[3]-1,0,-1));for(let E=0;E<l[3];E++)y[E]*=h[2];const b=new Uint8Array(this.drawBitmap),x=new Uint8Array(l[1]*l[2]*l[3]);let A=0;for(let E=0;E<l[3];E++)for(let S=0;S<l[2];S++)for(let M=0;M<l[1];M++)x[A]=b[v[M]+m[S]+y[E]],A++;return Z.debug("saving drawing"),this.volumes[0].saveToDisk(n,x)}}return Z.debug("saving image"),this.volumes[a].saveToDisk(n)}getMeshIndexByID(r){if(typeof r=="number")return r>=this.meshes.length?-1:r;const e=this.meshes.length;for(let n=0;n<e;n++)if(this.meshes[n].id===r)return n;return-1}setMeshProperty(r,e,n){const i=this.getMeshIndexByID(r);if(i<0){Z.warn("setMeshProperty() id not loaded",r);return}this.meshes[i].setProperty(e,n,this.gl),this.updateGLVolume(),this.onMeshPropertyChanged(i,e,n)}indexNearestXYZmm(r,e,n,i){const a=this.getMeshIndexByID(r);return a<0?(Z.warn("indexNearestXYZmm() id not loaded",r),[NaN,NaN]):this.meshes[a].indexNearestXYZmm(e,n,i)}decimateHierarchicalMesh(r,e=3){const n=this.getMeshIndexByID(r);if(n<0){Z.warn("reverseFaces() id not loaded",r);return}const i=this.meshes[n].decimateHierarchicalMesh(this.gl,e);return this.updateGLVolume(),i}reverseFaces(r){const e=this.getMeshIndexByID(r);if(e<0){Z.warn("reverseFaces() id not loaded",r);return}this.meshes[e].reverseFaces(this.gl),this.updateGLVolume()}async setMeshLayerProperty(r,e,n,i){const a=this.getMeshIndexByID(r);if(a<0){Z.warn("setMeshLayerProperty() id not loaded",r);return}await this.meshes[a].setLayerProperty(e,n,i,this.gl),this.updateGLVolume()}setPan2Dxyzmm(r){this.scene.pan2Dxyzmm=r,this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=r[3]),this.drawScene()}setRenderAzimuthElevation(r,e){this.scene.renderAzimuth=r,this.scene.renderElevation=e,this.onAzimuthElevationChange(r,e),this.drawScene()}getOverlayIndexByID(r){const e=this.overlays.length;for(let n=0;n<e;n++)if(this.overlays[n].id===r)return n;return-1}setVolume(r,e=0){const n=this.volumes.length;if(e>n)return;const i=this.getVolumeIndexByID(r.id);e===0?(this.volumes.splice(i,1),this.volumes.unshift(r),this.back=this.volumes[0],this.overlays=this.volumes.slice(1)):e<0?(this.volumes.splice(this.getVolumeIndexByID(r.id),1),this.back=this.volumes[0],this.volumes.length>1?this.overlays=this.volumes.slice(1):this.overlays=[]):(this.volumes.splice(i,1),this.volumes.splice(e,0,r),this.overlays=this.volumes.slice(1),this.back=this.volumes[0]),this.updateGLVolume()}setMesh(r,e=0){this.meshes.forEach(a=>{Z.debug("MESH: ",a.name)});const n=this.meshes.length;if(e>n)return;const i=this.getMeshIndexByID(r.id);e===0?(this.meshes.splice(i,1),this.meshes.unshift(r)):e<0?this.meshes.splice(this.getMeshIndexByID(r.id),1):(this.meshes.splice(i,1),this.meshes.splice(e,0,r)),this.updateGLVolume(),this.meshes.forEach(a=>{Z.debug(a.name)})}removeVolume(r){if(this.setVolume(r,-1),this.mediaUrlMap.has(r)){const e=this.mediaUrlMap.get(r);this.onVolumeWithUrlRemoved(e),this.mediaUrlMap.delete(r)}this.drawScene()}removeVolumeByIndex(r){if(r>=this.volumes.length)throw new Error("Index of volume out of bounds");this.removeVolume(this.volumes[r])}removeMesh(r){if(r.unloadMesh(this.gl),this.setMesh(r,-1),this.mediaUrlMap.has(r)){const e=this.mediaUrlMap.get(r);this.onMeshWithUrlRemoved(e),this.mediaUrlMap.delete(r)}}removeMeshByUrl(r){const e=this.getMediaByUrl(r);e&&(this.removeMesh(e),this.mediaUrlMap.delete(e),this.onMeshWithUrlRemoved(r))}moveVolumeToBottom(r){this.setVolume(r,0)}moveVolumeUp(r){const e=this.getVolumeIndexByID(r.id);this.setVolume(r,e+1)}moveVolumeDown(r){const e=this.getVolumeIndexByID(r.id);this.setVolume(r,e-1)}moveVolumeToTop(r){this.setVolume(r,this.volumes.length-1)}mouseDown(r,e){r*=this.uiData.dpr,e*=this.uiData.dpr,this.mousePos=[r,e]}mouseMove(r,e){r*=this.uiData.dpr,e*=this.uiData.dpr;const n=(r-this.mousePos[0])/this.uiData.dpr,i=(e-this.mousePos[1])/this.uiData.dpr;this.mousePos=[r,e],!(this.inRenderTile(r,e)<0)&&(Math.abs(n)<1&&Math.abs(i)<1||(this.scene.renderAzimuth+=n,this.scene.renderElevation+=i,this.drawScene()))}sph2cartDeg(r,e){const n=-e*(Math.PI/180),i=(r-90)%360*(Math.PI/180),a=[Math.cos(n)*Math.cos(i),Math.cos(n)*Math.sin(i),Math.sin(n)],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return s<=0||(a[0]/=s,a[1]/=s,a[2]/=s),a}setClipPlane(r){const e=this.sph2cartDeg(r[1]+180,r[2]);this.scene.clipPlane=[e[0],e[1],e[2],r[0]],this.scene.clipPlaneDepthAziElev=r,this.onClipPlaneChange(this.scene.clipPlane),this.drawScene()}setCrosshairColor(r){this.opts.crosshairColor=r,this.drawScene()}setCrosshairWidth(r){this.opts.crosshairWidth=r,this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN),this.drawScene()}setDrawColormap(r){this.drawLut=Vt.makeDrawLut(r),this.updateGLVolume()}setDrawingEnabled(r){this.opts.drawingEnabled=r,this.opts.drawingEnabled?this.drawBitmap||this.createEmptyDrawing():(this.clickToSegmentIsGrowing&&(this.clickToSegmentIsGrowing=!1,this.refreshDrawing(!0,!1)),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawPenFillPts=[],this.drawShapeStartLocation=[NaN,NaN,NaN],this.drawShapePreviewBitmap&&(this.drawBitmap=this.drawShapePreviewBitmap,this.drawShapePreviewBitmap=null)),this.drawScene()}setPenValue(r,e=!1){this.opts.penValue=r,this.opts.isFilledPen=e,this.drawScene()}setDrawOpacity(r){this.drawOpacity=r,this.drawScene()}setSelectionBoxColor(r){this.opts.selectionBoxColor=r}sliceScroll2D(r,e,n,i=!0){if(this.opts.scrollRequiresFocus&&this.canvas!==document.activeElement){Z.warn("Canvas element does not have focus. Scroll events will not be processed.");return}if(this.inGraphTile(e,n)){let a=this.volumes[0].frame4D;r>0&&a++,r<0&&a--,this.setFrame4D(this.volumes[0].id,a);return}if(r!==0&&this.opts.dragMode===3&&this.inRenderTile(this.uiData.dpr*e,this.uiData.dpr*n)===-1){let a=this.scene.pan2Dxyzmm[3]*(1+10*r);a=Math.round(a*10)/10;const s=this.scene.pan2Dxyzmm[3]-a;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=a),this.scene.pan2Dxyzmm[3]=a;const o=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=s*o[0],this.scene.pan2Dxyzmm[1]+=s*o[1],this.scene.pan2Dxyzmm[2]+=s*o[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.mouseClick(e,n,r,i)}setSliceType(r){return this.opts.sliceType=r,this.drawScene(),this}setOpacity(r,e){this.volumes[r].opacity=e,this.updateGLVolume()}setScale(r){this.scene.volScaleMultiplier=r,this.drawScene()}setClipPlaneColor(r){this.opts.clipPlaneColor=r,this.renderShader.use(this.gl),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.drawScene()}setClipPlaneThick(r){this.opts.clipThick=r,this.renderShader.use(this.gl),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.drawScene()}setClipVolume(r,e){this.opts.clipVolumeLow=[Math.min(r[0],e[0]),Math.min(r[1],e[1]),Math.min(r[2],e[2])],this.opts.clipVolumeHigh=[Math.max(r[0],e[0]),Math.max(r[1],e[1]),Math.max(r[2],e[2])],this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.pickingImageShader.use(this.gl),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.drawScene()}async setVolumeRenderIllumination(r=0){this.renderGradientValues=Number.isNaN(r),this.renderShader=this.renderVolumeShader,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:(this.opts.gradientAmount=r,r>0||this.opts.gradientOpacity>0?this.renderShader=this.renderGradientShader:r<0&&(this.renderShader=this.renderSliceShader)),await this.refreshLayers(this.volumes[0],0),this.initRenderShader(this.renderShader,r),this.renderShader.use(this.gl),this.setClipPlaneColor(this.opts.clipPlaneColor),Number.isNaN(r)?this.gradientTextureAmount=1:this.gradientTextureAmount=r,!(this.volumes.length<1)&&this.drawScene()}async setGradientOpacity(r=0,e=0){this.opts.gradientOpacity=r,this.opts.renderSilhouette=e,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:this.gradientTextureAmount>0||r>0?this.renderShader=this.renderGradientShader:this.gradientTextureAmount<0&&(this.renderShader=this.renderSliceShader),this.initRenderShader(this.renderShader,this.gradientTextureAmount),this.renderShader.use(this.gl),this.gradientTextureAmount>0&&this.refreshLayers(this.volumes[0],0),this.drawScene()}overlayRGBA(r){const e=r.hdr,n=e.dims[1]*e.dims[2]*e.dims[3],i=new Uint8ClampedArray(n*4),a=.2*Math.min(Math.min(e.dims[1],e.dims[2]),e.dims[3]),s=.5*e.dims[1],o=.5*e.dims[2],l=.5*e.dims[3];let c=0;for(let u=0;u<e.dims[3];u++)for(let h=0;h<e.dims[2];h++)for(let g=0;g<e.dims[1];g++){const v=Math.abs(g-s),m=Math.abs(h-o),y=Math.abs(u-l),b=Math.sqrt(v*v+m*m+y*y);let x=0;b<a&&(x=255),i[c++]=0,i[c++]=x,i[c++]=0,i[c++]=x*.5}return i}vox2mm(r,e){return qe.vox2mm(r,e)}cloneVolume(r){return this.volumes[r].clone()}async loadDocumentFromUrl(r){const e=await lp.loadFromUrl(r);await this.loadDocument(e)}async loadDocument(r){this.volumes=[],this.meshes=[],this.document=r,this.document.labels=this.document.labels?this.document.labels:[];const e={...Di,...r.opts};this.scene.pan2Dxyzmm=r.scene.pan2Dxyzmm?r.scene.pan2Dxyzmm:[0,0,0,1],this.document.opts=e,this.setClipPlane(this.scene.clipPlaneDepthAziElev),Z.debug("load document",r),this.mediaUrlMap.clear(),this.createEmptyDrawing();const n=r.encodedImageBlobs;for(let a=0;a<r.imageOptionsArray.length;a++){const s=r.imageOptionsArray[a],o=n[a];if(o){"colorMap"in s&&(s.colormap=s.colorMap);const l=await yn.loadFromBase64({base64:o,...s});if(l){if(l.colormapLabel){const c=Object.keys(l.colormapLabel.lut).length,u=new Uint8ClampedArray(c);for(const h in l.colormapLabel.lut)u[h]=l.colormapLabel.lut[h];l.colormapLabel.lut=u}this.addVolume(l)}}}this.volumes.length>0&&(this.back=this.volumes[0]);for(const a of r.meshDataObjects??[]){const s={gl:this.gl,...a};a.offsetPt0&&(s.rgba255[3]=0,s.tris=new Uint32Array(a.offsetPt0)),Z.debug(s);const o=new Il(s.pts,s.tris,s.name,s.rgba255,s.opacity,s.visible,this.gl,s.connectome,s.dpg,s.dps,s.dpv);a.offsetPt0&&(o.fiberGroupColormap=a.fiberGroupColormap,o.fiberColor=a.fiberColor,o.fiberDither=a.fiberDither,o.fiberRadius=a.fiberRadius,o.colormap=a.colormap),o.meshShaderIndex=s.meshShaderIndex,o.layers=s.layers,o.updateMesh(this.gl),Z.debug(o),this.addMesh(o)}if(r.data.connectomes)for(const a of r.data.connectomes){const s=JSON.parse(a),o=this.loadConnectomeAsMesh(s);o.updateMesh(this.gl),this.addMesh(o)}this.createEmptyDrawing();const i=r.encodedDrawingBlob;if(i){const a=await qe.b64toUint8(i);if(a){const s=this.back.dims;let o=s[1]*s[2]*s[3];if(a.length-352===o&&(o+=352),a.length!==o)throw new Error(`drawBitmap size does not match the texture dimensions (${s[1]}×${s[2]}×${s[3]}) ${o} != ${s[1]*s[2]*s[3]}.`);this.drawBitmap=a,this.refreshDrawing()}}return await this.setGradientOpacity(this.opts.gradientOpacity),await this.setVolumeRenderIllumination(this.opts.gradientAmount),this.updateGLVolume(),this.drawScene(),this.onDocumentLoaded(r),this}async generateLoadDocumentJavaScript(r,e){const n=this.json(),i=await qe.compressToBase64String(JSON.stringify(n));return`
        ${e}

        async function saveNiivueAsHtml(pageName) {
          //get new docstring
          const docString = nv1.json();
          const html =
          document.getElementsByTagName("html")[0]
              .innerHTML.replace(base64, await NVUtilities.compressToBase64String(JSON.stringify(docString)));
          NVUtilities.download(html, pageName, "application/html");
        }

        var nv1 = new Niivue();
        await nv1.attachTo("${r}");
        var base64 = "${i}";
        NVUtilities.decompressBase64String(base64).then((jsonText) => {
          var json = JSON.parse(jsonText); // string -> JSON
          var doc = NVDocument.loadFromJSON(json);
          nv1.loadDocument(doc);
          nv1.updateGLVolume();
        });

      `}async generateHTML(r="gl1",e){return`<!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="utf-8" />
            <meta http-equiv="X-UA-Compatible" content="IE=edge" />
            <meta name="viewport" content="width=device-width,initial-scale=1.0" />
            <title>Save as HTML</title>
            <style>
            html {
              height: auto;
              min-height: 100%;
              margin: 0;
            }
            body {
              display: flex;
              flex-direction: column;
              margin: 0;
              min-height: 100%;
              width: 100%;
              position: absolute;
              font-family: system-ui, Arial, Helvetica, sans-serif;
              background: #ffffff;
              color: black;
              user-select: none; /* Standard syntax */
            }
            header {
              margin: 10px;
            }
            main {
              flex: 1;
              background: #000000;
              position: relative;
            }
            footer {
              margin: 10px;
            }
            canvas {
              position: absolute;
              cursor: crosshair;
            }
            canvas:focus {
              outline: 0px;
            }
            div {
              display: table-row;
              background-color: blue;
            }
            </style>
          </head>
          <body>
            <noscript>niivue requires JavaScript.</noscript>
            <header>
            Save the current scene as HTML
            <button id="save">Save as HTML</button>
            </header>
            <main>
              <canvas id="gl1"></canvas>
            </main>
            <script type="module" async>
              ${await this.generateLoadDocumentJavaScript(r,e)}
              function saveAsHtml() {
                saveNiivueAsHtml("page.html");
              }
              // assign our event handler
              var button = document.getElementById("save");
              button.onclick = saveAsHtml;
            <\/script>
          </body>
        </html>`}async saveHTML(r="untitled.html",e="gl1",n){const i=await this.generateHTML(e,n);return qe.download(i,r,"application/html")}json(){return this.document.opts=this.opts,this.document.scene=this.scene,this.document.volumes=this.volumes,this.document.meshes=this.meshes,this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL(),this.document.json()}async saveDocument(r="untitled.nvd",e=!0,n={}){const{embedImages:i=!0,embedPreview:a=!0}=n;this.document.title=r,this.document.volumes=this.volumes,this.document.meshes=this.meshes,a?(this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL()):this.document.previewImageDataURL="",await this.document.download(r,e,{embedImages:i})}async loadImages(r){const e=[],n=[];for(const i of r)if("url"in i){const a=this.getFileExt(i.name?i.name:i.url);if(this.loaders[a]){const s=this.loaders[a].toExt.toUpperCase();ao.includes(s)?n.push(i):e.push(i);continue}ao.includes(a.toUpperCase())?n.push(i):e.push(i)}return e.length>0&&await this.loadVolumes(e),n.length>0&&await this.loadMeshes(n),this}async loadDicoms(r){if(!this.getDicomLoader())throw new Error("No dicom loader set. Please set a dicom loader before loading dicoms");this.drawScene(),this.volumes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);const e=r.map(async i=>{let a=null;if(i.isManifest)a=await yn.fetchDicomData(i.url);else{const h=await fetch(i.url);if(!h.ok)throw new Error(`Failed to load file: ${h.statusText}`);const g=await h.arrayBuffer();a=[{name:i.url.split("/").pop(),data:g}]}const s=this.getDicomLoader().loader,o=await s(a),l=o[0].name,c=o[0].data;return await yn.loadFromUrl({url:c,name:l})}),n=await Promise.all(e);return n.length===1?this.addVolume(n[0]):this.onDicomLoaderFinishedWithImages(n),this}async loadVolumes(r){return this.drawScene(),this.thumbnailVisible?(this.deferredVolumes=r,this):(this.volumes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.closePAQD(),await this.addVolumesFromUrl(r),this)}async addMeshFromUrl(r){const e=this.getFileExt(r.url);if(e==="JCON"||e==="JSON"){const a=await(await fetch(r.url,{})).json(),s=this.loadConnectomeAsMesh(a);return this.mediaUrlMap.set(s,r.url),this.onMeshAddedFromUrl(r,s),this.addMesh(s),s}const n=await Il.loadFromUrl({...r,gl:this.gl});return this.mediaUrlMap.set(n,r.url),this.onMeshAddedFromUrl(r,n),this.addMesh(n),n}async addMeshesFromUrl(r){const e=r.map(async i=>{const a=this.getFileExt(i.name||i.url);if(this.loaders[a]){let o=i.url;const l=this.loaders[a].toExt;let c=i.name||i.url;if(c=c.split("/").pop(),typeof i.url=="string"){const m=i.url;try{const y=await fetch(m);if(!y.ok)throw new Error(`Failed to load file: ${y.statusText}`);o=await y.arrayBuffer()}catch(y){throw new Error(`Failed to load url ${m}: ${y}`)}}const{positions:u,indices:h,colors:g=null}=await this.loaders[a].loader(o);i.name=`${c}.${l}`;const v=await ho.createMZ3Async(u,h,!1,g);i.buffer=v}if(a==="JCON"||a==="JSON"){const l=await(await fetch(i.url,{})).json(),c=this.loadConnectomeAsMesh(l);return this.mediaUrlMap.set(c,i.url),this.onMeshAddedFromUrl(i,c),c}const s=await Il.loadFromUrl({...i,gl:this.gl});return this.mediaUrlMap.set(s,i.url),this.onMeshAddedFromUrl(i,s),s}),n=await Promise.all(e);for(let i=0;i<n.length;i++)this.addMesh(n[i]);return n}async loadMeshes(r){return this.drawScene(),this.thumbnailVisible?(this.deferredMeshes=r,this):(this.initialized,this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),await this.addMeshesFromUrl(r),this.updateGLVolume(),this.drawScene(),this)}async loadConnectomeFromUrl(r,e={}){const i=await(await fetch(r,{headers:e})).json();return this.loadConnectome(i)}async loadFreeSurferConnectomeFromUrl(r,e={}){const i=await(await fetch(r,{headers:e})).json();return this.loadFreeSurferConnectome(i)}async loadFreeSurferConnectome(r){const e=md.convertFreeSurferConnectome(r);return this.loadConnectome(e)}handleNodeAdded(r){const e=r.detail.node,n=[1,1,1,1];this.addLabel(e.name,{textColor:n,bulletScale:1,bulletColor:n,lineWidth:0,lineColor:n,lineTerminator:"none",textScale:1},[e.x,e.y,e.z]),this.drawScene()}loadConnectomeAsMesh(r){let e=r;if("data_type"in r&&r.data_type==="fs_pointset")e=md.convertFreeSurferConnectome(r),Z.warn("converted FreeSurfer connectome",e);else if("nodes"in r){const n=r.nodes;"names"in n&&"X"in n&&"Y"in n&&"Z"in n&&"Color"in n&&"Size"in n&&(e=md.convertLegacyConnectome(r))}else throw new Error("not a known connectome format");return new md(this.gl,e)}loadConnectome(r){this.drawScene(),this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);const e=this.loadConnectomeAsMesh(r);return this.addMesh(e),this.drawScene(),this}createEmptyDrawing(){if(this.back===null||!this.back.dims||Math.min(Math.min(this.back.dims[1],this.back.dims[2]),this.back.dims[3])<1)return;const e=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];this.drawBitmap=new Uint8Array(e),this.clickToSegmentGrowingBitmap=new Uint8Array(e),this.drawClearAllUndoBitmaps(),this.drawAddUndoBitmap(),this.opts.is2DSliceShader?this.drawTexture=this.r8Tex2D(this.drawTexture,gs,this.back.dims):this.drawTexture=this.r8Tex(this.drawTexture,gs,this.back.dims,!0),this.refreshDrawing(!1)}r16Tex(r,e,n,i){r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,r),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,n[1],n[2],n[3]);const a=n[1]*n[2]*n[3];return i.length!==a&&(i=new Int16Array(a)),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n[1],n[2],n[3],this.gl.RED_INTEGER,this.gl.SHORT,i),r}drawGrowCut(){if(!this.back||!this.back.dims)throw new Error("back not defined");const r=this.back.hdr,e=this.gl,n=r.dims[1]*r.dims[2]*r.dims[3];if(!this.drawBitmap||this.drawBitmap.length!==n){Z.debug("bitmap dims are wrong");return}const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.disable(e.CULL_FACE),e.viewport(0,0,this.back.dims[1],this.back.dims[2]),e.disable(e.BLEND);let a=Sj(this.back);const s=this.r16Tex(null,Bj,this.back.dims,a);for(let S=1;S<n;S++)a[S]=this.drawBitmap[S];const o=this.r16Tex(null,Fj,this.back.dims,a),l=this.r16Tex(null,kj,this.back.dims,a),c=1e4;for(let S=1;S<n;S++)a[S]>0&&(a[S]=c);const u=this.r16Tex(null,Ij,this.back.dims,a),h=this.r16Tex(null,Nj,this.back.dims,a);e.bindVertexArray(this.genericVAO);const g=this.growCutShader;g.use(e);const v=128;e.uniform1i(g.uniforms.finalPass,0),e.uniform1i(g.uniforms.backTex,11);for(let S=0;S<v;S++){e.uniform1i(g.uniforms.labelTex,14),e.uniform1i(g.uniforms.strengthTex,12);for(let M=0;M<this.back.dims[3];M++){const R=1/this.back.dims[3]*(M+.5);e.uniform1f(g.uniforms.coordZ,R),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,l,0,M),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT1,h,0,M),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1]),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&Z.error("Incomplete framebuffer"),e.drawArrays(e.TRIANGLE_STRIP,0,4)}S===v-1&&e.uniform1i(g.uniforms.finalPass,1),e.uniform1i(g.uniforms.labelTex,15),e.uniform1i(g.uniforms.strengthTex,13);for(let M=0;M<this.back.dims[3];M++){const R=1/this.back.dims[3]*(M+.5);e.uniform1f(g.uniforms.coordZ,R),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,o,0,M),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT1,u,0,M),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1]),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&Z.error("Incomplete framebuffer"),e.drawArrays(e.TRIANGLE_STRIP,0,4)}}e.drawBuffers([e.COLOR_ATTACHMENT0]);const m=e.COLOR_ATTACHMENT1,y=o;e.readBuffer(m);const b=e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT),x=e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE);(b!==e.RED_INTEGER||x!==e.SHORT)&&Z.debug("readPixels will fail."),a=new Int16Array;const A=this.back.dims[1]*this.back.dims[2],C=new Int16Array(A);for(let S=0;S<this.back.dims[3];S++)e.framebufferTextureLayer(e.FRAMEBUFFER,m,y,0,S),e.readPixels(0,0,this.back.dims[1],this.back.dims[2],b,x,C),a=Int16Array.from([...a,...C]);let E=a[0];for(let S=0;S<a.length;S++)E=Math.max(E,a[S]);for(let S=1;S<n;S++)this.drawBitmap[S]=a[S];e.deleteTexture(s),e.deleteTexture(u),e.deleteTexture(h),e.deleteTexture(o),e.deleteTexture(l),e.bindVertexArray(this.unusedVAO),e.viewport(0,0,e.canvas.width,e.canvas.height),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(i),this.drawAddUndoBitmap(),this.refreshDrawing(!0)}drawPt(r,e,n,i,a=null){if(a===null&&(a=this.drawBitmap),!this.back?.dims)throw new Error("back.dims not set");const s=this.back.dims[1],o=this.back.dims[2],l=this.back.dims[3];r=Math.min(Math.max(r,0),s-1),e=Math.min(Math.max(e,0),o-1),n=Math.min(Math.max(n,0),l-1),a[r+e*s+n*s*o]=i;const c=this.drawPenAxCorSag===0,u=this.drawPenAxCorSag===1,h=this.drawPenAxCorSag===2;if(this.opts.penSize>1){const g=Math.floor(this.opts.penSize/2);for(let v=-g;v<=g;v++)for(let m=-g;m<=g;m++)c?a[r+v+(e+m)*s+n*s*o]=i:u?a[r+v+e*s+(n+m)*s*o]=i:h&&(a[r+(e+m)*s+(n+v)*s*o]=i)}}drawPenLine(r,e,n){const i=Math.abs(r[0]-e[0]),a=Math.abs(r[1]-e[1]),s=Math.abs(r[2]-e[2]);let o=-1,l=-1,c=-1;e[0]>r[0]&&(o=1),e[1]>r[1]&&(l=1),e[2]>r[2]&&(c=1);let u=r[0],h=r[1],g=r[2];const v=e[0],m=e[1],y=e[2];if(i>=a&&i>=s){let b=2*a-i,x=2*s-i;for(;u!==v;)u+=o,b>=0&&(h+=l,b-=2*i),x>=0&&(g+=c,x-=2*i),b+=2*a,x+=2*s,this.drawPt(u,h,g,n)}else if(a>=i&&a>=s){let b=2*i-a,x=2*s-a;for(;h!==m;)h+=l,b>=0&&(u+=o,b-=2*a),x>=0&&(g+=c,x-=2*a),b+=2*i,x+=2*s,this.drawPt(u,h,g,n)}else{let b=2*a-s,x=2*i-s;for(;g!==y;)g+=c,b>=0&&(h+=l,b-=2*s),x>=0&&(u+=o,x-=2*s),b+=2*a,x+=2*i,this.drawPt(u,h,g,n)}}drawRectangleMask(r,e,n){if(!this.back?.dims)throw new Error("back.dims not set");const i=this.back.dims[1],a=this.back.dims[2],s=this.back.dims[3],o=Math.min(Math.max(Math.min(r[0],e[0]),0),i-1),l=Math.min(Math.max(Math.min(r[1],e[1]),0),a-1),c=Math.min(Math.max(Math.min(r[2],e[2]),0),s-1),u=Math.min(Math.max(Math.max(r[0],e[0]),0),i-1),h=Math.min(Math.max(Math.max(r[1],e[1]),0),a-1),g=Math.min(Math.max(Math.max(r[2],e[2]),0),s-1);for(let v=c;v<=g;v++)for(let m=l;m<=h;m++)for(let y=o;y<=u;y++)this.drawPt(y,m,v,n)}drawEllipseMask(r,e,n){if(!this.back?.dims)throw new Error("back.dims not set");const i=this.back.dims[1],a=this.back.dims[2],s=this.back.dims[3],o=Math.min(Math.max(Math.min(r[0],e[0]),0),i-1),l=Math.min(Math.max(Math.min(r[1],e[1]),0),a-1),c=Math.min(Math.max(Math.min(r[2],e[2]),0),s-1),u=Math.min(Math.max(Math.max(r[0],e[0]),0),i-1),h=Math.min(Math.max(Math.max(r[1],e[1]),0),a-1),g=Math.min(Math.max(Math.max(r[2],e[2]),0),s-1),v=(o+u)/2,m=(l+h)/2,y=(c+g)/2,b=Math.abs(u-o)/2,x=Math.abs(h-l)/2,A=Math.abs(g-c)/2;for(let C=c;C<=g;C++)for(let E=l;E<=h;E++)for(let S=o;S<=u;S++){const M=(S-v)/(b+.5),R=(E-m)/(x+.5),T=(C-y)/(A+.5);M*M+R*R+T*T<=1&&this.drawPt(S,E,C,n)}}drawingBinaryDilationWithSeed(r,e=6){try{let n=function(x){return x[0]+x[1]*l+x[2]*c};const i=this.drawBitmap,a=this.back.dims[1],s=this.back.dims[2],o=this.back.dims[3],l=a,c=a*s,u=c*o,h=n(r);if(h<0||h>=u)throw new Error("Seed index is out of bounds.");const g=i[h];if(g===0)throw new Error("Seed voxel is not part of a filled cluster.");const v=i.slice();for(let x=0;x<u;x++)v[x]=v[x]===g?1:0;this.drawFloodFillCore(v,h,e);const m=i.slice(),y=[],b=[-c,c,-a,a,-1,1];y.push(...b),e>6&&y.push(-a-1,-a+1,a-1,a+1,-c-a,-c+a,-c-1,-c+1,c-a,c+a,c-1,c+1),e>18&&y.push(-c-a-1,-c-a+1,-c+a-1,-c+a+1,c-a-1,c-a+1,c+a-1,c+a+1);for(let x=0;x<u;x++)if(v[x]===2){const A=x%a,C=Math.floor(x%c/a),E=Math.floor(x/c);for(const S of y){const M=x+S;if(M<0||M>=u)continue;const R=M%a,T=Math.floor(M%c/a),B=Math.floor(M/c);Math.abs(R-A)>1||Math.abs(T-C)>1||Math.abs(B-E)>1||i[M]===0&&(m[M]=g)}}this.drawBitmap=m,this.drawAddUndoBitmap(),this.refreshDrawing(!0)}catch(n){Z.error("Error in drawingBinaryDilationWithSeed:",n)}}drawFloodFillCore(r,e,n=6){if(!this.back?.dims)throw new Error("back.dims undefined");const i=[this.back.dims[1],this.back.dims[2],this.back.dims[3]],a=i[0],s=a*i[1];function o(u){return u[0]+u[1]*a+u[2]*s}function l(u){const h=Math.floor(u/s),g=Math.floor((u-h*s)/a);return[Math.floor(u%a),g,h]}const c=[];for(c.push(e),r[e]=2;c.length>0;){let u=function(v){const m=g.slice();if(m[0]+=v[0],m[1]+=v[1],m[2]+=v[2],m[0]<0||m[1]<0||m[2]<0||m[0]>=i[0]||m[1]>=i[1]||m[2]>=i[2])return;const y=o(m);r[y]===1&&(r[y]=2,c.push(y))};const h=c[0];c.shift();const g=l(h);u([0,0,-1]),u([0,0,1]),u([0,-1,0]),u([0,1,0]),u([-1,0,0]),u([1,0,0]),!(n<=6)&&(u([-1,-1,0]),u([1,1,0]),u([-1,1,0]),u([1,1,0]),u([0,-1,-1]),u([0,1,-1]),u([-1,0,-1]),u([1,0,-1]),u([0,-1,1]),u([0,1,1]),u([-1,0,1]),u([1,0,1]),!(n<=18)&&(u([-1,-1,-1]),u([1,-1,-1]),u([-1,1,-1]),u([1,1,-1]),u([-1,-1,1]),u([1,-1,1]),u([-1,1,1]),u([1,1,1])))}}drawFloodFill(r,e=0,n=0,i=NaN,a=NaN,s=6,o=Number.POSITIVE_INFINITY,l=!1,c=null,u=!1){if(!this.drawBitmap&&(Z.warn("drawFloodFill called without an initialized drawBitmap."),this.createEmptyDrawing(),!this.drawBitmap)){Z.error("Failed to create drawing bitmap.");return}if(this.clickToSegmentIsGrowing&&!this.clickToSegmentGrowingBitmap){if(Z.warn("drawFloodFill called in preview mode without initialized clickToSegmentGrowingBitmap."),this.drawBitmap)this.clickToSegmentGrowingBitmap=this.drawBitmap.slice();else{Z.error("Cannot initialize growing bitmap as drawBitmap is null.");return}if(!this.clickToSegmentGrowingBitmap){Z.error("Failed to create growing bitmap.");return}}if(c===null&&(c=this.drawBitmap),!c){Z.error("drawFloodFill targetBitmap is null.");return}if(!this.back?.dims)throw new Error("back.dims undefined");e=Math.abs(e);const h=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];if(r[0]<0||r[1]<0||r[2]<0||r[0]>=h[0]||r[1]>=h[1]||r[2]>=h[2])return;const g=h[0],v=g*h[1],m=v*h[2],y=this.clickToSegmentIsGrowing?this.drawBitmap:c;if(!y){Z.error("Could not determine original bitmap state.");return}const b=new Uint8Array(m).fill(0);let x=-1;l&&this.drawPenAxCorSag===0?x=2:l&&this.drawPenAxCorSag===1?x=1:l&&this.drawPenAxCorSag===2&&(x=0);function A(I){const U=Math.floor(I/v),k=Math.floor((I-U*v)/g);return[Math.floor(I%g),k,U]}function C(I){return I[0]+I[1]*g+I[2]*v}const E=I=>this.vox2mm(I,this.back.matRAS),S=E(r),M=o**2;function R(I){const U=A(I);if(x>=0&&U[x]!==r[x])return!1;const k=E(U);return(k[0]-S[0])**2+(k[1]-S[1])**2+(k[2]-S[2])**2<=M}const T=C(r),B=y[T];if(u&&B===0){Z.debug("Grow/Erase Cluster tool requires starting on a masked voxel."),this.clickToSegmentIsGrowing&&this.clickToSegmentGrowingBitmap&&this.drawBitmap&&(this.clickToSegmentGrowingBitmap.set(this.drawBitmap),this.refreshDrawing(!0,!0));return}if(n===0&&B===e&&!u&&e!==0&&(Z.debug("drawFloodFill selected voxel is already desired color"),!this.clickToSegmentIsGrowing))return;let F=NaN;if(u&&(n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)){const I=y.slice();for(let P=0;P<m;P++)I[P]=I[P]===B&&R(P)?1:0;if(I[T]!==1){Z.error("Seed voxel could not be marked for cluster ID.");return}this.drawFloodFillCore(I,T,s);const U=this.volumes[0].img2RAS();let k=0,O=0;for(let P=0;P<m;P++)I[P]===2&&(k+=U[P],O++);F=O>0?k/O:U[T],Z.debug(`Grow Cluster using mean intensity: ${F.toFixed(2)} from ${O} voxels.`);let V=-1/0,L=1/0;n===Number.POSITIVE_INFINITY&&(V=F),n===Number.NEGATIVE_INFINITY&&(L=F);for(let P=0;P<m;P++)if(I[P]===2)b[P]=1;else if(y[P]===0){const _=U[P];_>=V&&_<=L&&R(P)&&(b[P]=1)}e=B}else if(n===0)if(u&&e===0){Z.debug(`Erase Cluster: Identifying cluster with color ${B}`);for(let I=0;I<m;I++)b[I]=y[I]===B&&R(I)?1:0}else for(let I=0;I<m;I++)y[I]===B&&R(I)&&B!==0&&(b[I]=1);else{const I=this.volumes[0].img2RAS();F=I[T];let U=-1/0,k=1/0;isFinite(i)&&isFinite(a)?(U=i,k=a):n===Number.POSITIVE_INFINITY?U=F:n===Number.NEGATIVE_INFINITY&&(k=F);for(let O=0;O<m;O++){const V=I[O];V>=U&&V<=k&&R(O)&&(b[O]=1)}e=y[T],e===0&&(e=this.opts.penValue,(e<1||!isFinite(e))&&(e=1))}if(b[T]!==1){let I=!1;if(u&&n!==0?B!==0&&(I=!0):(B!==0||e===0)&&(I=!0),I&&R(T))b[T]=1,Z.debug("Forcing seed voxel to 1 in working buffer.");else{Z.debug("Seed voxel not marked as candidate '1' and not valid originally."),this.clickToSegmentIsGrowing&&this.clickToSegmentGrowingBitmap&&this.drawBitmap&&this.clickToSegmentGrowingBitmap.set(this.drawBitmap);return}}this.drawFloodFillCore(b,T,s);for(let I=0;I<m;I++)b[I]===2?c[I]=e:this.clickToSegmentIsGrowing&&c===this.clickToSegmentGrowingBitmap&&(c[I]=y[I]);this.clickToSegmentIsGrowing?this.refreshDrawing(!0,!0):(this.drawAddUndoBitmap(),this.refreshDrawing(!0,!1))}floodFillSectionFIFO(r,e,n,i){const a=e[0],[s,o]=n,[l,c]=i,u=4*(l-s+c-o+2),h=new Int32Array(u*2);let g=0,v=0;function m(x,A){if(x<s||x>l||A<o||A>c)return;const C=x+A*a;r[C]===0&&(r[C]=2,h[v]=x,h[v+1]=A,v=(v+2)%h.length)}function y(){if(g===v)return null;const x=h[g],A=h[g+1];return g=(g+2)%h.length,[x,A]}for(let x=s;x<=l;x++)m(x,o),m(x,c);for(let x=o+1;x<=c-1;x++)m(s,x),m(l,x);let b;for(;(b=y())!==null;){const[x,A]=b;m(x-1,A),m(x+1,A),m(x,A-1),m(x,A+1)}}drawPenFilled(){const r=this.drawPenFillPts.length;if(r<2){this.drawPenFillPts=[];return}const e=this.drawPenAxCorSag;let n=0,i=1;if(e===1&&(i=2),e===2&&(n=1,i=2),!this.back?.dims)throw new Error("back.dims undefined");const a=[this.back.dims[n+1],this.back.dims[i+1]],s=new Uint8Array(a[0]*a[1]);let o=1;function l(x,A){const C=Math.abs(x[0]-A[0]),E=Math.abs(x[1]-A[1]);s[x[0]+x[1]*a[0]]=o,s[A[0]+A[1]*a[0]]=o;let S=-1,M=-1;A[0]>x[0]&&(S=1),A[1]>x[1]&&(M=1);let R=x[0],T=x[1];const B=A[0],F=A[1];if(C>=E){let I=2*E-C;for(;R!==B;)R+=S,I>=0&&(T+=M,I-=2*C),I+=2*E,s[R+T*a[0]]=o}else{let I=2*C-E;for(;T!==F;)T+=M,I>=0&&(R+=S,I-=2*E),I+=2*C,s[R+T*a[0]]=o}}function c(x){const A=Math.min(Math.max(x[0],0),a[0]-1),C=Math.min(Math.max(x[1],0),a[1]-1);return[A,C]}const u=c([this.drawPenFillPts[0][n],this.drawPenFillPts[0][i]]);let h=[...u],g=[...u],v=u;for(let x=1;x<r;x++){let A=[this.drawPenFillPts[x][n],this.drawPenFillPts[x][i]];A=c(A),h=[Math.min(A[0],h[0]),Math.min(A[1],h[1])],g=[Math.max(A[0],g[0]),Math.max(A[1],g[1])],l(v,A),v=A}l(u,v);const m=1;h[0]=Math.max(0,h[0]-m),h[1]=Math.max(0,h[1]-m),g[0]=Math.min(a[0]-1,g[0]+m),g[1]=Math.min(a[1]-1,g[1]+m);for(let x=0;x<a[1];x++)for(let A=0;A<a[0];A++){if(A>=h[0]&&A<g[0]&&x>=h[1]&&x<=g[1])continue;const C=A+x*a[0];s[C]===0&&(s[C]=2)}const y=Date.now();this.floodFillSectionFIFO(s,a,h,g),Z.debug(`FloodFill ${Date.now()-y}`),o=this.opts.penValue;const b=this.drawPenFillPts[0][3-(n+i)];if(!this.drawBitmap)throw new Error("drawBitmap undefined");if(e===0){const x=b*a[0]*a[1];for(let A=0;A<a[0]*a[1];A++)s[A]!==2&&(this.drawBitmap[A+x]=o)}else{let x=1;const A=this.back.dims[1]*this.back.dims[2];let C=b*this.back.dims[1];e===2&&(x=this.back.dims[1],C=b);let E=0;for(let S=0;S<a[1];S++)for(let M=0;M<a[0];M++)s[E]!==2&&(this.drawBitmap[M*x+S*A+C]=o),E++}if(!this.drawFillOverwrites&&this.drawUndoBitmaps[this.currentDrawUndoBitmap].length>0){const x=this.drawBitmap.length,A=g2(this.drawUndoBitmaps[this.currentDrawUndoBitmap],x);for(let C=0;C<x;C++)A[C]!==0&&(this.drawBitmap[C]=A[C])}this.drawPenFillPts=[],this.drawAddUndoBitmap(),this.refreshDrawing(!1)}closeDrawing(){this.drawClearAllUndoBitmaps(),this.drawTexture=this.rgbaTex(this.drawTexture,gs,[2,2,2,2],!0),this.drawBitmap=null,this.clickToSegmentGrowingBitmap=null,this.drawScene()}refreshDrawing(r=!0,e=!1){e&&(!this.opts.drawingEnabled||!this.opts.clickToSegment)&&(Z.debug("refreshDrawing: Conditions not met for clickToSegment bitmap, using drawBitmap."),e=!1);const n=e?this.clickToSegmentGrowingBitmap:this.drawBitmap;!n&&!e&&this.clickToSegmentGrowingBitmap?Z.warn("refreshDrawing: drawBitmap is null, but clickToSegmentGrowingBitmap exists. Check state."):!n&&e&&this.drawBitmap?(Z.warn("refreshDrawing: clickToSegmentGrowingBitmap is null, falling back to drawBitmap."),e=!1):n||Z.warn("refreshDrawing: Both bitmaps are null. Uploading empty data.");const i=e?this.clickToSegmentGrowingBitmap:this.drawBitmap;if(!this.back?.dims){Z.warn("refreshDrawing: back.dims undefined, cannot refresh drawing texture yet.");return}const a=this.back.dims.slice(),s=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];if(!i){Z.warn(`refreshDrawing: Bitmap data source (${e?"growing":"main"}) is null. Cannot update texture.`),r&&this.drawScene();return}if(i.length===8?(a[1]=2,a[2]=2,a[3]=2):s!==i.length&&Z.warn(`Drawing bitmap length (${i.length}) must match the background image (${s})`),this.gl.activeTexture(gs),this.opts.is2DSliceShader){const o=this.frac2vox(this.scene.crosshairPos),l=Math.min(Math.max(o[2],0),a[3]-1),c=a[1]*a[2],u=l*c;Z.debug(`refresh huge 2D drawing x×y×z ${a[1]}×${a[2]}×${a[3]} slice ${u}`);const h=i.subarray(u,u+c);this.gl.bindTexture(this.gl.TEXTURE_2D,this.drawTexture),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,a[1],a[2],this.gl.RED,this.gl.UNSIGNED_BYTE,h)}else this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,a[1],a[2],a[3],this.gl.RED,this.gl.UNSIGNED_BYTE,i);if(!this.drawTexture){Z.error("refreshDrawing: drawTexture (GPU texture) is null.");return}r&&this.drawScene()}closePAQD(){!this._gl||!this.paqdTexture||(this.paqdTexture=this.rgbaTex(this.paqdTexture,gc,[2,2,2,2],!0))}r8Tex2D(r,e,n,i=!1){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.R8,n[1],n[2]),i){const a=new Uint8Array(n[1]*n[2]);this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,n[1],n[2],this.gl.RED,this.gl.UNSIGNED_BYTE,a)}return r}r8Tex(r,e,n,i=!1){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,r),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8,n[1],n[2],n[3]),i){const a=new Uint8Array(n[1]*n[2]*n[3]);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n[1],n[2],n[3],this.gl.RED,this.gl.UNSIGNED_BYTE,a)}return r}rgbaTex2D(r,e,n,i=null,a=!0){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,n[1],n[2]),i){let s=i;const o=n[1],l=n[2];if(a){s=new Uint8Array(i.length);const c=o*4;for(let u=0;u<l;u++){const h=u*c,g=(l-1-u)*c;s.set(i.subarray(h,h+c),g)}}this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,o,l,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s)}return r}rgbaTex(r,e,n,i=!1){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,r),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8,n[1],n[2],n[3]),i){const a=new Uint8Array(n[1]*n[2]*n[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n[1],n[2],n[3],this.gl.RGBA,this.gl.UNSIGNED_BYTE,a)}return r}rgba16Tex(r,e,n,i=!1){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,r),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,2),this.gl.pixelStorei(this.gl.PACK_ALIGNMENT,2),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA16UI,n[1],n[2],n[3]),i){const a=new Uint16Array(n[1]*n[2]*n[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n[1],n[2],n[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_SHORT,a)}return r}requestCORSIfNotSameOrigin(r,e){new URL(e,window.location.href).origin!==window.location.origin&&(r.crossOrigin="")}async loadPngAsTexture(r,e){return new Promise((n,i)=>{const a=new Image;a.onload=()=>{if(!this.bmpShader)return;let s;e===4?(this.bmpTexture!==null&&this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=this.gl.createTexture(),s=this.bmpTexture,this.bmpTextureWH=a.width/a.height,this.gl.activeTexture(Rj),this.bmpShader.use(this.gl),this.gl.uniform1i(this.bmpShader.uniforms.bmpTexture,4)):e===5?(this.gl.activeTexture(ZC),this.matCapTexture!==null&&this.gl.deleteTexture(this.matCapTexture),this.matCapTexture=this.gl.createTexture(),s=this.matCapTexture):(this.fontShader.use(this.gl),this.gl.activeTexture(Dj),this.gl.uniform1i(this.fontShader.uniforms.fontTexture,3),this.fontTexture!==null&&this.gl.deleteTexture(this.fontTexture),this.fontTexture=this.gl.createTexture(),s=this.fontTexture),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a),n(s),e!==4&&this.drawScene()},a.onerror=i,this.requestCORSIfNotSameOrigin(a,r),a.src=r})}async loadFontTexture(r){return this.loadPngAsTexture(r,3)}async loadBmpTexture(r){return this.loadPngAsTexture(r,4)}async loadMatCapTexture(r){return this.loadPngAsTexture(r,5)}initFontMets(){if(!this.fontMetrics)throw new Error("fontMetrics undefined");this.fontMets={distanceRange:this.fontMetrics.atlas.distanceRange,size:this.fontMetrics.atlas.size,mets:{}};for(let n=0;n<256;n++)this.fontMets.mets[n]={xadv:0,uv_lbwh:[0,0,0,0],lbwh:[0,0,0,0]};const r=this.fontMetrics.atlas.width,e=this.fontMetrics.atlas.height;for(let n=0;n<this.fontMetrics.glyphs.length;n++){const i=this.fontMetrics.glyphs[n],a=i.unicode;if(this.fontMets.mets[a].xadv=i.advance,i.planeBounds===void 0)continue;let s=i.atlasBounds.left/r,o=(e-i.atlasBounds.top)/e,l=(i.atlasBounds.right-i.atlasBounds.left)/r,c=(i.atlasBounds.top-i.atlasBounds.bottom)/e;this.fontMets.mets[a].uv_lbwh=[s,o,l,c],s=i.planeBounds.left,o=i.planeBounds.bottom,l=i.planeBounds.right-i.planeBounds.left,c=i.planeBounds.top-i.planeBounds.bottom,this.fontMets.mets[a].lbwh=[s,o,l,c]}}async loadFont(r=PC,e=LC){await this.loadFontTexture(r);const n=await fetch(e);if(!n.ok)throw Error(n.statusText);const i=await n.text();this.fontMetrics=JSON.parse(i),this.initFontMets(),this.fontShader.use(this.gl),this.drawScene()}async loadDefaultMatCap(){return this.loadMatCapTexture(mY)}async loadDefaultFont(){await this.loadFontTexture(this.DEFAULT_FONT_GLYPH_SHEET),this.fontMetrics=this.DEFAULT_FONT_METRICS,this.initFontMets()}async initText(){this.fontShader=new xt(this.gl,_Y,zY),this.fontShader.use(this.gl),await this.loadDefaultFont(),await this.loadDefaultMatCap(),this.drawLoadingText(this.opts.loadingText)}meshShaderNameToNumber(r="Phong"){const e=r.toLowerCase();for(let n=0;n<this.meshShaders.length;n++)if(this.meshShaders[n].Name.toLowerCase()===e)return n}setMeshShader(r,e=2){let n=0;if(typeof e=="number"?n=e:n=this.meshShaderNameToNumber(e),n===void 0)throw new Error("shaderIndex undefined");n=Math.min(n,this.meshShaders.length-1),n=Math.max(n,0);const i=this.getMeshIndexByID(r);if(i>=this.meshes.length){Z.debug("Unable to change shader until mesh is loaded (maybe you need async)");return}this.meshes[i].meshShaderIndex=n,this.updateGLVolume(),this.onMeshShaderChanged(i,n)}createCustomMeshShader(r,e="Custom"){if(!r)throw new Error("Need fragment shader");const n=this.meshShaderNameToNumber(e);n>=0&&(this.gl.deleteProgram(this.meshShaders[n].shader.program),this.meshShaders.splice(n,1));const i=new xt(this.gl,dp,r);return i.use(this.gl),{Name:e,Frag:r,shader:i}}setCustomSliceShader(r=""){const e=this.gl;if(this.customSliceShader&&(e.deleteProgram(this.customSliceShader.program),this.customSliceShader=null),!r){this.updateGLVolume();return}const n=new xt(e,pd,r);n.use(e),e.uniform1i(n.uniforms.volume,0),e.uniform1i(n.uniforms.colormap,1),e.uniform1i(n.uniforms.overlay,2),e.uniform1i(n.uniforms.drawing,7),e.uniform1i(n.uniforms.paqd,8),e.uniform1f(n.uniforms.drawOpacity,this.drawOpacity),this.customSliceShader=n,this.updateGLVolume()}setCustomMeshShader(r="",e="Custom"){const n=this.createCustomMeshShader(r,e);return this.meshShaders.push(n),this.onCustomMeshShaderAdded(r,e),this.meshShaders.length-1}meshShaderNames(r=!0){const e=[];for(let n=0;n<this.meshShaders.length;n++)e.push(this.meshShaders[n].Name);return r===!0?e.sort():e}initRenderShader(r,e=0){r.use(this.gl),this.gl.uniform1i(r.uniforms.volume,0),this.gl.uniform1i(r.uniforms.colormap,1),this.gl.uniform1i(r.uniforms.overlay,2),this.gl.uniform1i(r.uniforms.drawing,7),this.gl.uniform1i(r.uniforms.paqd,8),this.gl.uniform1fv(r.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.gl.uniform1f(r.uniforms.gradientAmount,e),this.gl.uniform1f(r.uniforms.silhouettePower,this.opts.renderSilhouette);const n=new Float32Array(Uc);for(let i=0;i<Uc;i++)this.opts.gradientOpacity===0?n[i]=1:n[i]=Math.pow(i/(Uc-1),this.opts.gradientOpacity*8);this.gl.uniform1fv(this.gl.getUniformLocation(r.program,"gradientOpacity"),n)}async init(){const r=this.gl.getExtension("WEBGL_debug_renderer_info");if(r){const s=this.gl.getParameter(r.UNMASKED_VENDOR_WEBGL),o=this.gl.getParameter(r.UNMASKED_RENDERER_WEBGL);Z.info("renderer vendor: ",s),Z.info("renderer: ",o)}else Z.info("debug_renderer_info unavailable");const e=this.gl.getParameter(this.gl.RENDERER);Z.info("firefox renderer: ",e),this.gl.clearDepth(0),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.FRONT),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.volumeTexture=this.rgbaTex(this.volumeTexture,Ml,[2,2,2,2],!0),this.overlayTexture=this.rgbaTex(this.overlayTexture,yp,[2,2,2,2],!0),this.drawTexture=this.r8Tex(this.drawTexture,gs,[2,2,2,2],!0),this.paqdTexture=this.rgbaTex(this.paqdTexture,gc,[2,2,2,2],!0);const n=[1,1,0,1,0,0,0,1,0,0,0,0],i=this.gl;this.cuboidVertexBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.cuboidVertexBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(n),i.STATIC_DRAW),this.genericVAO=i.createVertexArray(),i.bindVertexArray(this.genericVAO),i.bindBuffer(i.ARRAY_BUFFER,this.cuboidVertexBuffer),i.enableVertexAttribArray(0),i.vertexAttribPointer(0,3,i.FLOAT,!1,0,0),i.bindVertexArray(this.unusedVAO),this.pickingMeshShader=new xt(i,dp,$Y),this.pickingMeshShader.use(i),this.pickingImageShader=new xt(i,fc,gj),this.pickingImageShader.use(i),i.uniform1i(this.pickingImageShader.uniforms.volume,0),i.uniform1i(this.pickingImageShader.uniforms.colormap,1),i.uniform1i(this.pickingImageShader.uniforms.overlay,2),i.uniform1i(this.pickingImageShader.uniforms.drawing,7),this.slice2DShader=new xt(i,pd,BY),this.slice2DShader.use(i),i.uniform1i(this.slice2DShader.uniforms.volume,0),i.uniform1i(this.slice2DShader.uniforms.colormap,1),i.uniform1i(this.slice2DShader.uniforms.overlay,2),i.uniform1i(this.slice2DShader.uniforms.drawing,7),i.uniform1f(this.slice2DShader.uniforms.drawOpacity,this.drawOpacity),this.sliceMMShader=new xt(i,pd,IY),this.sliceMMShader.use(i),i.uniform1i(this.sliceMMShader.uniforms.volume,0),i.uniform1i(this.sliceMMShader.uniforms.colormap,1),i.uniform1i(this.sliceMMShader.uniforms.overlay,2),i.uniform1i(this.sliceMMShader.uniforms.drawing,7),i.uniform1f(this.sliceMMShader.uniforms.drawOpacity,this.drawOpacity),this.sliceV1Shader=new xt(i,pd,NY),this.sliceV1Shader.use(i),i.uniform1i(this.sliceV1Shader.uniforms.volume,0),i.uniform1i(this.sliceV1Shader.uniforms.colormap,1),i.uniform1i(this.sliceV1Shader.uniforms.overlay,2),i.uniform1i(this.sliceV1Shader.uniforms.drawing,7),i.uniform1f(this.sliceV1Shader.uniforms.drawOpacity,this.drawOpacity),this.orientCubeShader=new xt(i,vj,mj),this.orientCubeShaderVAO=i.createVertexArray(),i.bindVertexArray(this.orientCubeShaderVAO);const a=i.createBuffer();i.enableVertexAttribArray(0),i.enableVertexAttribArray(1),i.bindBuffer(i.ARRAY_BUFFER,a),i.bufferData(i.ARRAY_BUFFER,PG,i.STATIC_DRAW),i.vertexAttribPointer(0,3,i.FLOAT,!1,24,0),i.enableVertexAttribArray(1),i.vertexAttribPointer(1,3,i.FLOAT,!1,24,12),i.bindVertexArray(this.unusedVAO),this.rectShader=new xt(i,zC,fp),this.rectShader.use(i),this.rectOutlineShader=new xt(i,zC,FY),this.rectOutlineShader.use(i),this.lineShader=new xt(i,VY,fp),this.lineShader.use(i),this.line3DShader=new xt(i,OY,fp),this.line3DShader.use(i),this.circleShader=new xt(i,GY,qY),this.circleShader.use(i),this.renderVolumeShader=new xt(i,fc,MY),this.initRenderShader(this.renderVolumeShader),this.renderSliceShader=new xt(i,fc,TY),this.initRenderShader(this.renderSliceShader),this.renderGradientShader=new xt(i,fc,DY),this.initRenderShader(this.renderGradientShader,.3),i.uniform1i(this.renderGradientShader.uniforms.matCap,5),i.uniform1i(this.renderGradientShader.uniforms.gradient,6),this.renderGradientValuesShader=new xt(i,fc,RY),this.initRenderShader(this.renderGradientValuesShader),i.uniform1i(this.renderGradientValuesShader.uniforms.matCap,5),i.uniform1i(this.renderGradientValuesShader.uniforms.gradient,6),this.renderShader=this.renderVolumeShader,this.colorbarShader=new xt(i,kY,UY),this.colorbarShader.use(i),i.uniform1i(this.colorbarShader.uniforms.colormap,1),this.blurShader=new xt(i,Ad,Aj),this.sobelBlurShader=new xt(i,Ad,xj),this.sobelFirstOrderShader=new xt(i,Ad,bj),this.sobelSecondOrderShader=new xt(i,Ad,wj),this.growCutShader=new xt(i,KY,XY),this.passThroughShader=new xt(i,pj,yj),this.orientShaderAtlasU=new xt(i,io,yd.concat(qC)),this.orientShaderAtlasI=new xt(i,io,GC.concat(qC)),this.orientShaderU=new xt(i,io,yd.concat(hp)),this.orientShaderI=new xt(i,io,GC.concat(hp)),this.orientShaderF=new xt(i,io,YY.concat(hp)),this.orientShaderRGBU=new xt(i,io,yd.concat(HY)),this.orientShaderPAQD=new xt(i,io,yd.concat(jY)),this.surfaceShader=new xt(i,QY,ZY),this.surfaceShader.use(i),this.fiberShader=new xt(i,WY,JY),this.pickingImageShader.use(i);for(let s=0;s<this.meshShaders.length;s++){const o=this.meshShaders[s];o.Name==="Flat"?o.shader=new xt(i,dj,YC):o.shader=new xt(i,dp,o.Frag),o.shader.use(i),o.shader.isMatcap=o.Name==="Matcap",o.shader.isMatcap&&i.uniform1i(o.shader.uniforms.matCap,5)}return this.bmpShader=new xt(i,PY,LY),await this.initText(),this.opts.thumbnail.length>0&&(await this.loadBmpTexture(this.opts.thumbnail),this.thumbnailVisible=!0),this.updateGLVolume(),this.initialized=!0,this.resizeListener(),this.drawScene(),this}gradientGL(r){const e=this.gl;e.bindVertexArray(this.genericVAO);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.viewport(0,0,r.dims[1],r.dims[2]),e.disable(e.BLEND);const i=this.rgbaTex(null,WC,r.dims,!0),a=this.opts.gradientOrder===2?this.sobelBlurShader:this.blurShader;a.use(e),e.activeTexture(Ml),e.bindTexture(e.TEXTURE_3D,this.volumeTexture),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MAG_FILTER,e.LINEAR);const s=.7;e.uniform1i(a.uniforms.intensityVol,0),e.uniform1f(a.uniforms.dX,s/r.dims[1]),e.uniform1f(a.uniforms.dY,s/r.dims[2]),e.uniform1f(a.uniforms.dZ,s/r.dims[3]);for(let c=0;c<r.dims[3]-1;c++){const u=1/r.dims[3]*(c+.5);e.uniform1f(a.uniforms.coordZ,u),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,i,0,c);const h=e.checkFramebufferStatus(e.FRAMEBUFFER);h!==e.FRAMEBUFFER_COMPLETE&&Z.error("blur shader: ",h),e.clear(e.DEPTH_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4)}const o=this.opts.gradientOrder===2?this.sobelSecondOrderShader:this.sobelFirstOrderShader;o.use(e),e.activeTexture(WC),e.bindTexture(e.TEXTURE_3D,i),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.uniform1i(o.uniforms.intensityVol,8);const l=.7;e.uniform1f(o.uniforms.dX,l/r.dims[1]),e.uniform1f(o.uniforms.dY,l/r.dims[2]),e.uniform1f(o.uniforms.dZ,l/r.dims[3]),this.opts.gradientOrder===2&&(e.uniform1f(o.uniforms.dX2,2*l/r.dims[1]),e.uniform1f(o.uniforms.dY2,2*l/r.dims[2]),e.uniform1f(o.uniforms.dZ2,2*l/r.dims[3])),e.uniform1f(o.uniforms.coordZ,.5),this.gradientTexture!==null&&e.deleteTexture(this.gradientTexture),this.gradientTexture=this.rgbaTex(this.gradientTexture,Ap,r.dims);for(let c=0;c<r.dims[3]-1;c++){const u=1/r.dims[3]*(c+.5);e.uniform1f(o.uniforms.coordZ,u),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,this.gradientTexture,0,c);const h=e.checkFramebufferStatus(e.FRAMEBUFFER);h!==e.FRAMEBUFFER_COMPLETE&&Z.error("sobel shader: ",h),e.clear(e.DEPTH_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4)}e.deleteFramebuffer(n),e.deleteTexture(i),e.bindFramebuffer(e.FRAMEBUFFER,null),e.activeTexture(gc),e.bindTexture(e.TEXTURE_3D,this.paqdTexture),this.gl.bindVertexArray(this.unusedVAO)}getGradientTextureData(){if(!this.gradientTexture||!this.back)return null;const r=this.gl,e=this.back.dims,n=e[1],i=e[2],a=e[3],s=n*i*a,o=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,o);const l=new Float32Array(s*4);try{for(let c=0;c<a;c++){r.framebufferTextureLayer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,this.gradientTexture,0,c);const u=r.checkFramebufferStatus(r.FRAMEBUFFER);if(u!==r.FRAMEBUFFER_COMPLETE){console.warn("Framebuffer not complete for gradient texture reading, slice",c,"status:",u.toString(16));continue}try{const h=new Uint8Array(n*i*4);r.readPixels(0,0,n,i,r.RGBA,r.UNSIGNED_BYTE,h);const g=new Float32Array(n*i*4);for(let m=0;m<h.length;m++)g[m]=h[m]/127.5-1;const v=c*n*i*4;l.set(g,v)}catch(h){console.warn("Failed to read pixels for slice",c,":",h);const g=c*n*i*4,v=new Float32Array(n*i*4);l.set(v,g)}}}catch(c){return console.error("Error reading gradient texture:",c),null}finally{r.deleteFramebuffer(o),r.bindFramebuffer(r.FRAMEBUFFER,null)}return l}setCustomGradientTexture(r,e){const n=this.gl;if(r===null){this.useCustomGradientTexture=!1,this.back&&this.gradientTextureAmount>0&&this.gradientGL(this.back.hdr);return}if(!e&&!this.back){console.warn("No dimensions provided and no background volume loaded");return}const i=e||this.back.dims,a=i[1],s=i[2],o=i[3],l=a*s*o*4;if(r.length!==l){console.warn(`Custom gradient data size mismatch. Expected ${l}, got ${r.length}`);return}this.useCustomGradientTexture=!0,this.gradientTexture!==null&&n.deleteTexture(this.gradientTexture),this.gradientTexture=n.createTexture(),n.activeTexture(Ap),n.bindTexture(n.TEXTURE_3D,this.gradientTexture),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.pixelStorei(n.UNPACK_ALIGNMENT,1);let c;if(r instanceof Float32Array){c=new Uint8Array(r.length);for(let u=0;u<r.length;u++){const h=Math.max(-1,Math.min(1,r[u]));c[u]=Math.round((h+1)*127.5)}}else c=r;n.texStorage3D(n.TEXTURE_3D,1,n.RGBA8,a,s,o),n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,a,s,o,n.RGBA,n.UNSIGNED_BYTE,c),this.drawScene()}updateGLVolume(){let r=0;const e=this.volumes.length;this.refreshColormaps(),this.closePAQD();for(let n=0;n<e;n++)this.volumes[n].toRAS&&(this.refreshLayers(this.volumes[n],r),r++);if(this.furthestVertexFromOrigin=0,e>0&&(this.furthestVertexFromOrigin=this.volumeObject3D?.furthestVertexFromOrigin??0),this.meshes)for(let n=0;n<this.meshes.length;n++)this.furthestVertexFromOrigin=Math.max(this.furthestVertexFromOrigin,this.meshes[n].furthestVertexFromOrigin);this.onVolumeUpdated&&this.onVolumeUpdated(),this.drawScene()}getDescriptives(r){const{layer:e=0,masks:n=[],drawingIsMask:i=!1,roiIsMask:a=!1,startVox:s=[0,0,0],endVox:o=[0,0,0]}=r;let l=null;const c=this.volumes[e].hdr,u=this.volumes[e].pixDimsRAS;let h=c.scl_slope;isNaN(h)&&(h=1);let g=c.scl_inter;isNaN(g)&&(g=1);const v=this.volumes[e].img,m=v.length,y=new Float32Array(m);for(let k=0;k<m;k++)y[k]=v[k]*h+g;const b=new Uint8Array(m);for(let k=0;k<m;k++)b[k]=1;if(n.length>0)for(let k=0;k<n.length;k++){const O=this.volumes[n[k]].img;if(O.length!==m){Z.debug("Mask resolution does not match image. Skipping masking layer "+n[k]);continue}for(let V=0;V<m;V++)(O[V]===0||isNaN(O[V]))&&(b[V]=0)}else if(n.length<1&&i)for(let k=0;k<m;k++)(this.drawBitmap[k]===0||isNaN(this.drawBitmap[k]))&&(b[k]=0);else if(n.length<1&&a){b.fill(0);let k=-1;if(s[0]===o[0])k=0;else if(s[1]===o[1])k=1;else if(s[2]===o[2])k=2;else{console.error("Error: No constant dimension found.");return}const V=[0,1,2].filter(ve=>ve!==k),L=[];L[k]=s[k],L[V[0]]=(s[V[0]]+o[V[0]])/2,L[V[1]]=(s[V[1]]+o[V[1]])/2;const P=Math.abs(o[V[0]]-s[V[0]])/2,_=Math.abs(o[V[1]]-s[V[1]])/2,q=c.dims[1],H=c.dims[2],W=Math.max(0,Math.floor(L[V[0]]-P)),G=Math.min(c.dims[V[0]+1]-1,Math.ceil(L[V[0]]+P)),K=Math.max(0,Math.floor(L[V[1]]-_)),$=Math.min(c.dims[V[1]+1]-1,Math.ceil(L[V[1]]+_)),te=L[k];if(te<0||te>=c.dims[k+1]){console.error("Error: Constant dimension value is out of bounds.");return}for(let ve=W;ve<=G;ve++)for(let le=K;le<=$;le++){const ie=[];ie[k]=te,ie[V[0]]=ve,ie[V[1]]=le;const se=(ie[V[0]]-L[V[0]])/P,fe=(ie[V[1]]-L[V[1]])/_;if(se*se+fe*fe<=1){const De=ie[0],ze=ie[1],it=ie[2]*q*H+ze*q+De;b[it]=1}}const ae=P*u[V[0]+1],ue=_*u[V[1]+1];l=Math.PI*ae*ue}let x=0,A=0,C=0,E=Number.NEGATIVE_INFINITY,S=Number.POSITIVE_INFINITY,M=0,R=0,T=0;for(let k=0;k<m;k++){if(b[k]<1)continue;const O=y[k];x++;let V=A+(O-A)/x;C=C+(O-A)*(O-V),A=V,O!==0&&(M++,V=R+(O-R)/M,T=T+(O-R)*(O-V),R=V,S=Math.min(O,S),E=Math.max(O,E))}const B=Math.sqrt(C/(x-1)),F=Math.sqrt(T/(M-1)),I=S,U=E;return x!==M&&(S=Math.min(0,S),E=Math.max(0,E)),{mean:A,stdev:B,nvox:x,volumeMM3:x*c.pixDims[1]*c.pixDims[2]*c.pixDims[3],volumeML:x*c.pixDims[1]*c.pixDims[2]*c.pixDims[3]*.001,min:S,max:E,meanNot0:R,stdevNot0:F,nvoxNot0:M,minNot0:I,maxNot0:U,cal_min:this.volumes[e].cal_min,cal_max:this.volumes[e].cal_max,robust_min:this.volumes[e].robust_min,robust_max:this.volumes[e].robust_max,area:l}}refreshLayers(r,e){if(this.volumes.length<1)return;this.refreshColormaps();const n=r.hdr;let i=r.img;r.frame4D>0&&r.frame4D<r.nFrame4D&&(i=r.img.slice(r.frame4D*r.nVox3D,(r.frame4D+1)*r.nVox3D));const a=r.opacity;if(e>1&&a===0)return;let s=null;if(!this.back)throw new Error("back undefined");this.gl.bindVertexArray(this.unusedVAO),this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN);let o=Er(r.toRAS);if(e===0){this.volumeObject3D=pY(r,this.VOLUME_ID,this.gl),kn(o,o),this.back.matRAS=r.matRAS,this.back.dims=r.dimsRAS,this.back.pixDims=r.pixDimsRAS;const{volScale:R,vox:T}=this.sliceScale(!0);this.volScale=R,this.vox=T,this.volumeObject3D.scale=R,(n.dims[1]>this.uiData.max2D||n.dims[2]>this.uiData.max2D)&&Z.error("Image dimensions exceed maximum texture size of hardware.");const F=n.dims[1]>this.uiData.max3D||n.dims[2]>this.uiData.max3D||n.dims[3]>this.uiData.max3D;if(F&&n.datatypeCode===2304&&n.dims[3]<2){Z.info(`Large RGBA image (>${this.uiData.max3D}) requires Texture2D`),this.opts.is2DSliceShader=!0,s=this.rgbaTex2D(this.volumeTexture,Ml,r.dimsRAS,i);return}if(F){Z.info(`Large scalar image (>${this.uiData.max3D}) requires Texture2D (${n.dims[1]}×${n.dims[2]}×${n.dims[3]})`);const U=n.dims[1]*n.dims[2],k=this.frac2vox(this.scene.crosshairPos),V=Math.min(Math.max(k[2],0),n.dims[3]-1)*U,L=new Uint8Array(U*4),P=new Uint32Array(L.buffer),_=Math.floor(r.opacity*255),q=255*n.scl_slope/(r.cal_max-r.cal_min),H=255*(n.scl_inter-r.cal_min)/(r.cal_max-r.cal_min),W=new Uint8Array(this.colormap(r.colormap)),G=new Uint32Array(W.buffer);let K=-1;for(let $=0;$<U;$++){const te=i[$+V]*q+H,ae=Math.round(Math.min(255,Math.max(0,te)));P[$]=G[ae],L[K+=4]=_}this.opts.is2DSliceShader=!0,s=this.rgbaTex2D(this.volumeTexture,Ml,r.dimsRAS,L,!1);return}if(F&&Z.warn(`dimensions exceed 3D limits ${n.dims}`),this.opts.is2DSliceShader=!1,s=this.rgbaTex(this.volumeTexture,Ml,r.dimsRAS),!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.texVox,T),this.gl.uniform3fv(this.renderShader.uniforms.volScale,R);const I=this.pickingImageShader;I.use(this.gl),this.gl.uniform1i(I.uniforms.volume,0),this.gl.uniform1i(I.uniforms.colormap,1),this.gl.uniform1i(I.uniforms.overlay,2),this.gl.uniform3fv(I.uniforms.volScale,R),Z.debug(this.volumeObject3D)}else{this.back?.dims===void 0&&Z.error("Fatal error: Unable to render overlay: background dimensions not defined!");const R=this.mm2frac(r.mm000,0,!0);let T=this.mm2frac(r.mm100,0,!0),B=this.mm2frac(r.mm010,0,!0),F=this.mm2frac(r.mm001,0,!0);T=Wt(T,T,R),B=Wt(B,B,R),F=Wt(F,F,R),o=Wn(T[0],B[0],F[0],R[0],T[1],B[1],F[1],R[1],T[2],B[2],F[2],R[2],0,0,0,1),kn(o,o),e===1?(s=this.rgbaTex(this.overlayTexture,yp,this.back.dims),this.overlayTexture=s,this.overlayTextureID=s):s=this.overlayTextureID}const l=this.gl.createFramebuffer();this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,l),this.gl.disable(this.gl.CULL_FACE),this.gl.viewport(0,0,this.back.dims[1],this.back.dims[2]),this.gl.disable(this.gl.BLEND);const c=this.gl.createTexture();this.gl.activeTexture(JC),this.gl.bindTexture(this.gl.TEXTURE_3D,c),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1);let u=this.orientShaderU;if(!n)throw new Error("hdr undefined");if(!i)throw new Error("img undefined");if(n.datatypeCode===2)n.intent_code===1002&&(u=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8UI,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_BYTE,i);else if(n.datatypeCode===4)u=this.orientShaderI,n.intent_code===1002&&(u=this.orientShaderAtlasI),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED_INTEGER,this.gl.SHORT,i);else if(n.datatypeCode===16)this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED,this.gl.FLOAT,i),u=this.orientShaderF;else if(n.datatypeCode===64){let R=new Float32Array;R=Float32Array.from(i),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED,this.gl.FLOAT,R),u=this.orientShaderF}else if(n.datatypeCode===128)u=this.orientShaderRGBU,u.use(this.gl),this.gl.uniform1i(u.uniforms.hasAlpha,0),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGB8UI,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RGB_INTEGER,this.gl.UNSIGNED_BYTE,i);else if(n.datatypeCode===512)n.intent_code===1002&&(u=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16UI,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_SHORT,i);else if(n.datatypeCode===2304){if(u=this.orientShaderRGBU,r.colormapLabel){u=this.orientShaderPAQD;let R=!0;for(let T=0;T<e;T++){const B=this.volumes[T].hdr.datatypeCode===2304,F=!!this.volumes[T].colormapLabel;B&&F&&(R=!1)}R?this.paqdTexture=this.rgbaTex(this.paqdTexture,gc,this.back.dims):Z.warn("Current version only one probabilistic atlas (PAQD) at a time"),s=this.paqdTexture,this.gl.activeTexture(JC)}u.use(this.gl),this.gl.uniform1i(u.uniforms.hasAlpha,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8UI,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_BYTE,i)}r.global_min===void 0&&r.calMinMax();let h=null;if(this.gl.bindVertexArray(this.genericVAO),e>1){if(!this.back.dims)throw new Error("back.dims undefined");h=this.rgbaTex(h,$C,this.back.dims),this.gl.bindTexture(this.gl.TEXTURE_3D,h);const R=this.passThroughShader;R.use(this.gl),this.gl.uniform1i(R.uniforms.in3D,2);for(let T=0;T<this.back.dims[3];T++){const B=1/this.back.dims[3]*(T+.5);this.gl.uniform1f(R.uniforms.coordZ,B),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,h,0,T),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}else h=this.rgbaTex(h,$C,[2,2,2,2]);u.use(this.gl),this.gl.activeTexture(xd);let g=null;if(r.colormapLabel!==null&&r.colormapLabel.lut.length>7){const R=r.colormapLabel.max-r.colormapLabel.min+1;g=this.createColormapTexture(g,1,R),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,R,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r.colormapLabel.lut),this.gl.uniform1f(u.uniforms.cal_min,r.colormapLabel.min-.5),this.gl.uniform1f(u.uniforms.cal_max,r.colormapLabel.max+.5),this.gl.bindTexture(this.gl.TEXTURE_2D,g)}else this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.uniform1f(u.uniforms.cal_min,r.cal_min),this.gl.uniform1f(u.uniforms.cal_max,r.cal_max);"alphaThreshold"in r&&(Z.warn("alphaThreshold is deprecated: use colormapType"),r.alphaThreshold===!0&&(r.colormapType=2),r.alphaThreshold===!1&&(r.colormapType=1),delete r.alphaThreshold);const v=r.colormapType!==0?1:0,m=r.colormapType===2?1:0;this.gl.uniform1i(u.uniforms.isAlphaThreshold,m),this.gl.uniform1i(u.uniforms.isColorbarFromZero,v),this.gl.uniform1i(u.uniforms.isAdditiveBlend,this.opts.isAdditiveBlend?1:0);let y=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;if(r.colormapNegative.length>0&&(y=Math.min(-r.cal_min,-r.cal_max),b=Math.max(-r.cal_min,-r.cal_max),isFinite(r.cal_minNeg)&&isFinite(r.cal_maxNeg)&&(y=Math.min(r.cal_minNeg,r.cal_maxNeg),b=Math.max(r.cal_minNeg,r.cal_maxNeg))),e>0&&this.overlayOutlineWidth>0){const R=r.cal_min,T=r.cal_max;let B=Math.min(R,T)<=0&&Math.max(R,T)>=0;!B&&y<b&&(B=y<=0&&b>=0),B&&Z.error("issue1139: do not use overlayOutlineWidth when thresholds cross or touch zero")}if(!u)throw new Error("orientShader undefined");this.gl.uniform1f(u.uniforms.layer??null,e),this.gl.uniform1f(u.uniforms.cal_minNeg??null,y),this.gl.uniform1f(u.uniforms.cal_maxNeg??null,b),this.gl.bindTexture(this.gl.TEXTURE_3D,c),this.gl.uniform1i(u.uniforms.intensityVol??null,9),this.gl.uniform1i(u.uniforms.blend3D??null,10),this.gl.uniform1i(u.uniforms.colormap??null,1),this.gl.uniform1f(u.uniforms.scl_inter??null,n.scl_inter),this.gl.uniform1f(u.uniforms.scl_slope??null,n.scl_slope),this.gl.uniform1f(u.uniforms.opacity??null,a),this.gl.uniform1i(u.uniforms.modulationVol??null,7);let x=null;if(r.modulationImage!==null&&r.modulationImage>=0&&r.modulationImage<this.volumes.length){Z.debug("modulating",this.volumes);const R=this.volumes[r.modulationImage].hdr;if(R.dims[1]===n.dims[1]&&R.dims[2]===n.dims[2]&&R.dims[3]===n.dims[3]){r.modulateAlpha?(this.gl.uniform1i(u.uniforms.modulation,2),this.gl.uniform1f(u.uniforms.opacity,1)):this.gl.uniform1i(u.uniforms.modulation,1),x=this.r8Tex(x,this.gl.TEXTURE7,n.dims,!0),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_3D,x);const T=n.dims[1]*n.dims[2]*n.dims[3],B=new Uint8Array(T),F=this.volumes[r.modulationImage].cal_min,I=1/(this.volumes[r.modulationImage].cal_max-F),U=this.volumes[r.modulationImage].img.buffer;let k=new Uint8Array(U);switch(R.datatypeCode){case 4:k=new Int16Array(U);break;case 16:k=new Float32Array(U);break;case 64:k=new Float64Array(U);break;case 128:k=new Uint8Array(U);break;case 512:k=new Uint16Array(U);break}Z.debug(this.volumes[r.modulationImage]);const O=this.volumes[r.modulationImage].colormapNegative.length>0;let V=this.volumes[r.modulationImage].cal_min,L=this.volumes[r.modulationImage].cal_max;isFinite(this.volumes[r.modulationImage].cal_minNeg)&&isFinite(this.volumes[r.modulationImage].cal_maxNeg)&&(V=this.volumes[r.modulationImage].cal_minNeg,L=this.volumes[r.modulationImage].cal_minNeg),V=Math.abs(V),L=Math.abs(L),V>L&&([V,L]=[L,V]);const P=1/(L-V);let _=Math.abs(r.modulateAlpha);_=Math.max(_,1);const q=this.volumes[r.modulationImage].frame4D*T;for(let H=0;H<T;H++){const W=k[H+q]*R.scl_slope+R.scl_inter;let G=(W-F)*I;O&&W<0&&(G=(Math.abs(W)-V)*P),G=Math.min(Math.max(G,0),1),G=Math.pow(G,_)*255,B[H]=G}this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED,this.gl.UNSIGNED_BYTE,B)}else Z.debug("Modulation image dimensions do not match target")}else this.gl.uniform1i(u.uniforms.modulation,0);if(this.gl.uniformMatrix4fv(u.uniforms.mtx,!1,o),!this.back.dims)throw new Error("back.dims undefined");let A=0;n.intent_code===1002&&(A=this.opts.atlasOutline,this.gl.uniform1ui(u.uniforms.activeIndex,this.opts.atlasActiveIndex|0)),this.gl.uniform4fv(u.uniforms.xyzaFrac,[1/this.back.dims[1],1/this.back.dims[2],1/this.back.dims[3],A]),Z.debug("back dims: ",this.back.dims);for(let R=0;R<this.back.dims[3];R++){const T=1/this.back.dims[3]*(R+.5);this.gl.uniform1f(u.uniforms.coordZ,T),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,s,0,R),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}if(this.gl.bindVertexArray(this.unusedVAO),this.gl.deleteTexture(c),this.gl.deleteTexture(x),this.gl.deleteTexture(h),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.deleteFramebuffer(l),e===0&&(this.volumeTexture=s,this.gradientTextureAmount>0&&!this.useCustomGradientTexture?(this.gradientGL(n),this.gl.bindVertexArray(this.genericVAO)):this.gradientTextureAmount<=0&&(this.gradientTexture!==null&&this.gl.deleteTexture(this.gradientTexture),this.gradientTexture=null)),!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl);const C=this.sliceScale(!0),E=C.vox,S=C.volScale;if(this.gl.uniform1f(this.renderShader.uniforms.overlays,this.overlays.length),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.gl.uniform1f(this.renderShader.uniforms.backOpacity,this.volumes[0].opacity),this.gl.uniform1f(this.renderShader.uniforms.renderOverlayBlend,this.opts.renderOverlayBlend),this.gl.uniform4fv(this.renderShader.uniforms.clipPlane,this.scene.clipPlane),this.gl.uniform3fv(this.renderShader.uniforms.texVox,E),this.gl.uniform3fv(this.renderShader.uniforms.volScale,S),!this.pickingImageShader)throw new Error("pickingImageShader undefined");this.pickingImageShader.use(this.gl),this.gl.uniform1f(this.pickingImageShader.uniforms.overlays,this.overlays.length),this.gl.uniform3fv(this.pickingImageShader.uniforms.texVox,E),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh);let M=this.sliceMMShader;if(this.opts.is2DSliceShader&&(M=this.slice2DShader),this.opts.isV1SliceShader&&(M=this.sliceV1Shader),this.customSliceShader&&(M=this.customSliceShader),!M)throw new Error("slice shader undefined");M.use(this.gl),this.gl.uniform1f(M.uniforms.overlays,this.overlays.length),this.gl.uniform1f(M.uniforms.drawOpacity,this.drawOpacity),g!==null&&(this.gl.deleteTexture(g),this.gl.activeTexture(xd),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture)),this.gl.uniform1i(M.uniforms.drawing,7),this.gl.activeTexture(gs),this.opts.is2DSliceShader?this.gl.bindTexture(this.gl.TEXTURE_2D,this.drawTexture):this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.gl.uniform4fv(M.uniforms.paqdUniforms,this.opts.paqdUniforms),this.gl.uniform1i(M.uniforms.paqd,8),this.gl.activeTexture(gc),this.gl.bindTexture(this.gl.TEXTURE_3D,this.paqdTexture),this.updateInterpolation(e)}colormaps(){return Vt.colormaps()}addColormap(r,e){Vt.addColormap(r,e)}setColormap(r,e){const n=this.getVolumeIndexByID(r);this.volumes[n].colormap=e,this.updateGLVolume()}idx(r,e,n,i){return n*i[0]*i[1]+e*i[0]+r}check_previous_slice(r,e,n,i,a,s,o,l){const c=new Uint32Array(27);let u=0;if(!a)return 0;const h=r[this.idx(n,i,a,s)];if(o>=6){const g=this.idx(n,i,a-1,s);h===r[g]&&(c[u++]=e[g])}if(o>=18){if(n){const g=this.idx(n-1,i,a-1,s);h===r[g]&&(c[u++]=e[g])}if(i){const g=this.idx(n,i-1,a-1,s);h===r[g]&&(c[u++]=e[g])}if(n<s[0]-1){const g=this.idx(n+1,i,a-1,s);h===r[g]&&(c[u++]=e[g])}if(i<s[1]-1){const g=this.idx(n,i+1,a-1,s);h===r[g]&&(c[u++]=e[g])}}if(o===26){if(n&&i){const g=this.idx(n-1,i-1,a-1,s);h===r[g]&&(c[u++]=e[g])}if(n<s[0]-1&&i){const g=this.idx(n+1,i-1,a-1,s);h===r[g]&&(c[u++]=e[g])}if(n&&i<s[1]-1){const g=this.idx(n-1,i+1,a-1,s);h===r[g]&&(c[u++]=e[g])}if(n<s[0]-1&&i<s[1]-1){const g=this.idx(n+1,i+1,a-1,s);h===r[g]&&(c[u++]=e[g])}}return u?(this.fill_tratab(l,c,u),c[0]):0}do_initial_labelling(r,e,n){let i=1;const a=8192;let s=a,o=new Uint32Array(s).fill(0);const l=new Uint32Array(e[0]*e[1]*e[2]).fill(0),c=new Uint32Array(27);for(let u=0;u<e[2];u++)for(let h=0;h<e[1];h++)for(let g=0;g<e[0];g++){let v=0;const m=r[this.idx(g,h,u,e)];if(m!==0){if(c[0]=this.check_previous_slice(r,l,g,h,u,e,n,o),c[0]&&(v+=1),n>=6){if(g){const y=this.idx(g-1,h,u,e);m===r[y]&&(c[v++]=l[y])}if(h){const y=this.idx(g,h-1,u,e);m===r[y]&&(c[v++]=l[y])}}if(n>=18){if(h&&g){const y=this.idx(g-1,h-1,u,e);m===r[y]&&(c[v++]=l[y])}if(h&&g<e[0]-1){const y=this.idx(g+1,h-1,u,e);m===r[y]&&(c[v++]=l[y])}}if(v)l[this.idx(g,h,u,e)]=c[0],this.fill_tratab(o,c,v);else{if(l[this.idx(g,h,u,e)]=i,i>=s){s+=a;const y=new Uint32Array(s);y.set(o),o=y}o[i-1]=i,i++}}}for(let u=0;u<i-1;u++){let h=u;for(;o[h]!==h+1;)h=o[h]-1;o[u]=h+1}return[i-1,o,l]}fill_tratab(r,e,n){let i=0;const a=new Uint32Array(n+5).fill(0);let o=2147483647;for(let l=0;l<n;l++){let c=e[l];for(i=0;r[c-1]!==c;)if(c=r[c-1],i++,i>100){Z.info(`
Ooh no!!`);break}a[l]=c,o=Math.min(o,c)}for(let l=0;l<n;l++)r[a[l]-1]=o}translate_labels(r,e,n,i){const a=e[0]*e[1]*e[2];let s=0;const o=new Uint32Array(a).fill(0);for(let u=0;u<i;u++)s=Math.max(s,n[u]);const l=new Uint32Array(s).fill(0);let c=0;for(let u=0;u<a;u++)r[u]&&(l[n[r[u]-1]-1]||(c+=1,l[n[r[u]-1]-1]=c),o[u]=l[n[r[u]-1]-1]);return[c,o]}largest_original_cluster_labels(r,e,n){const i=r.length,a=new Uint32Array(e+1).fill(0),s=new Uint32Array(e+1).fill(0);for(let c=0;c<i;c++){const u=r[c],h=n[c];a[h]=u,s[h]++}let o=0;for(let c=0;c<e+1;c++){const u=a[c];o=Math.max(o,u);for(let h=0;h<e+1;h++)h!==c&&u===a[h]&&(s[c]<s[h]||s[c]===s[h]&&c<h)&&(a[c]=0)}const l=new Uint32Array(i).fill(0);for(let c=0;c<i;c++)l[c]=a[n[c]];return[o,l]}bwlabel(r,e,n=26,i=!1,a=!1){const s=Date.now(),o=e[0]*e[1]*e[2],l=new Uint32Array(o).fill(0);if(![6,18,26].includes(n))return Z.info("bwlabel: conn must be 6, 18 or 26."),[0,l];if(e[0]<2||e[1]<2||e[2]<1)return Z.info("bwlabel: img must be 2 or 3-dimensional"),[0,l];if(i)for(let m=0;m<o;m++)r[m]!==0&&(l[m]=1);else l.set(r);let[c,u,h]=this.do_initial_labelling(l,e,n);u===void 0&&(u=new Uint32Array);const[g,v]=this.translate_labels(h,e,u,c);if(Z.info(n+" neighbor clustering into "+g+" regions in "+(Date.now()-s)+"ms"),a){const[m,y]=this.largest_original_cluster_labels(l,g,v);return[m,y]}return[g,v]}async createConnectedLabelImage(r,e=26,n=!1,i=!1){const a=this.getVolumeIndexByID(r),s=Uint32Array.from(this.volumes[a].dims?.slice(1,4)??[]),o=Uint32Array.from(this.volumes[a].img?.slice()??[]),[l,c]=this.bwlabel(o,s,e,n,i),u=this.volumes[a].clone();u.opacity=.5,u.colormap="random";for(let h=0;h<u.img.length;h++)u.img[h]=c[h];return u.cal_min=0,u.cal_max=l,u}async scalecropUint8(r,e=0,n=255,i,a){const s=r.length,o=new Uint8Array(s);for(let l=0;l<s;l++){let c=r[l];c=e+a*(c-i),c=Math.max(c,e),c=Math.min(c,n),o[l]=c}return o}async scalecropFloat32(r,e=0,n=1,i,a){const s=r.length,o=new Float32Array(s);for(let l=0;l<s;l++){let c=r[l];c=e+a*(c-i),c=Math.max(c,e),c=Math.min(c,n),o[l]=c}return o}getScale(r,e=0,n=255,i=0,a=.999){let s=r.global_min,o=r.global_max;if(r.hdr.datatypeCode===2)return[s,1];if((!isFinite(i)||!isFinite(a))&&isFinite(r.cal_min)&&isFinite(r.cal_max)&&r.cal_max>r.cal_min){s=r.cal_min,o=r.cal_max;const C=(n-e)/(o-s);return Z.info(" Robust Rescale:  min: "+s+"  max: "+o+" scale: "+C),[s,C]}let l=r.img;const c=r.hdr.dims[1]*r.hdr.dims[2]*r.hdr.dims[3];if(r.hdr.scl_slope!==1||r.hdr.scl_inter!==0){const C=r.img;l=new Float32Array(r.img.length);for(let E=0;E<c;E++)l[E]=C[E]*r.hdr.scl_slope+r.hdr.scl_inter}if(s<0&&Z.warn("WARNING: Input image has value(s) below 0.0 !"),Z.info(" Input:    min: "+s+"  max: "+o),i===0&&a===1)return[s,1];let u=0;for(let C=0;C<c;C++)Math.abs(l[C])>=1e-15&&u++;const h=1e3,g=(o-s)/h,v=new Array(h).fill(0);for(let C=0;C<c;C++){const E=l[C];let S=Math.floor((E-s)/g);S=Math.min(S,h-1),v[S]++}const m=new Array(h).fill(0);m[0]=v[0];for(let C=1;C<h;C++)m[C]=m[C-1]+v[C];let y=Math.floor(i*c),b=0;for(;b<h&&!(m[b]>=y);)b++;const x=s;for(s=b*g+x,y=c-Math.floor((1-a)*u),b=0;b<h-1&&!(m[b+1]>=y);)b++;o=b*g+x;let A=1;return s!==o&&(A=(n-e)/(o-s)),Z.info(" Rescale:  min: "+s+"  max: "+o+" scale: "+A),[s,A]}conformVox2Vox(r,e,n=256,i=1,a=!1){const s=e.flat(),o=Wn(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9],s[10],s[11],s[12],s[13],s[14],s[15]),l=Jt(r[1]/2,r[2]/2,r[3]/2,1),c=Qi(),u=bt();Zn(u,o),Kr(c,l,u);const h=Me(c[0],c[1],c[2]),g=Me(i,i,i);let v=Wn(-1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1);a&&(v=Wn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),Zn(v,v);const m=Jt(n,n,n,1),y=bt();hC(y,v,g);const b=Jt(m[0],m[1],m[2],1);Kr(b,b,y),iz(b,b,.5);const x=Kt();Wt(x,h,Me(b[0],b[1],b[2]));const A=bt();Zn(A,y),A[3]=x[0],A[7]=x[1],A[11]=x[2];const C=bt();kn(C,A);const E=bt();oT(E,o,C);const S=bt();return kn(S,E),[A,E,S]}async createNiftiArray(r=[256,256,256],e=[1,1,1],n=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],i=2,a=new Uint8Array){return await yn.createNiftiArray(r,e,n,i,a)}async niftiArray2NVImage(r=new Uint8Array){return await yn.loadFromUrl({url:r})}async loadFromUrl(r){return await yn.loadFromUrl({url:r})}async conform(r,e=!1,n=!0,i=!1,a=!1){const l=this.conformVox2Vox(r.hdr.dims,r.hdr.affine.flat(),256,1,e),c=l[0],u=l[2],h=256*256*256,g=new Float32Array(h),v=new Float32Array(r.img),m=r.hdr.dims[1]*r.hdr.dims[2]*r.hdr.dims[3];if(r.hdr.scl_slope!==1||r.hdr.scl_inter!==0)for(let I=0;I<m;I++)v[I]=v[I]*r.hdr.scl_slope+r.hdr.scl_inter;const y=r.hdr.dims[1],b=r.hdr.dims[2],x=r.hdr.dims[3],A=y*b;let C=-1;function E(I,U,k){return I+U*y+k*A}const S=u[0],M=u[4],R=u[8];if(n)for(let I=0;I<256;I++)for(let U=0;U<256;U++){const k=U*u[1]+I*u[2]+u[3],O=U*u[5]+I*u[6]+u[7],V=U*u[9]+I*u[10]+u[11];for(let L=0;L<256;L++){const P=L*S+k,_=L*M+O,q=L*R+V,H=Math.floor(P),W=Math.floor(_),G=Math.floor(q);if(C++,H<0||W<0||G<0)continue;const K=Math.ceil(P),$=Math.ceil(_),te=Math.ceil(q);if(K>=y||$>=b||te>=x)continue;const ae=P-H,ue=_-W,re=q-G,ve=1-ae,le=1-ue,ie=1-re,se=E(H,W,G);let fe=0;fe+=v[se]*ve*le*ie,fe+=v[se+A]*ve*le*re,fe+=v[se+y]*ve*ue*ie,fe+=v[se+y+A]*ve*ue*re,fe+=v[se+1]*ae*le*ie,fe+=v[se+1+A]*ae*le*re,fe+=v[se+1+y]*ae*ue*ie,fe+=v[se+1+y+A]*ae*ue*re,g[C]=fe}}else for(let I=0;I<256;I++)for(let U=0;U<256;U++){const k=U*u[1]+I*u[2]+u[3],O=U*u[5]+I*u[6]+u[7],V=U*u[9]+I*u[10]+u[11];for(let L=0;L<256;L++){const P=Math.round(L*S+k),_=Math.round(L*M+O),q=Math.round(L*R+V);C++,!(P<0||_<0||q<0)&&(P>=y||_>=b||q>=x||(g[C]=v[E(P,_,q)]))}}let T=0;a&&(T=NaN);let B=new Uint8Array;if(i){const I=await this.getScale(r,0,1,T),U=await this.scalecropFloat32(g,0,1,I[0],I[1]);B=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(c),16,new Uint8Array(U.buffer))}else{const I=await this.getScale(r,0,255,T),U=await this.scalecropUint8(g,0,255,I[0],I[1]);B=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(c),2,U)}return await this.niftiArray2NVImage(B)}setRenderDrawAmbientOcclusion(r){if(!this.renderShader)throw new Error("renderShader undefined");this.renderDrawAmbientOcclusion=r,this.renderShader.use(this.gl),this.gl.uniform1fv(this.renderShader.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.drawScene()}setColorMap(r,e){this.setColormap(r,e)}setColormapNegative(r,e){const n=this.getVolumeIndexByID(r);this.volumes[n].colormapNegative=e,this.updateGLVolume()}setModulationImage(r,e,n=0){const i=this.getVolumeIndexByID(r);let a=null;e.length>0&&(a=this.getVolumeIndexByID(e)),this.volumes[i].modulationImage=a,this.volumes[i].modulateAlpha=n,this.updateGLVolume()}setGamma(r=1){this.scene.gamma=r,Vt.gamma=r,this.updateGLVolume()}async loadDeferred4DVolumes(r){const e=this.getVolumeIndexByID(r),n=this.volumes[e];if(n.nTotalFrame4D<=n.nFrame4D)return;n.nTotalFrame4D=n.nFrame4D;let i;n.fileObject?i=await yn.loadFromFile({file:n.fileObject}):i=await yn.loadFromUrl({url:n.url}),i&&(n.img=i.img.slice(),n.nTotalFrame4D=i.nTotalFrame4D,n.nFrame4D=i.nFrame4D,this.updateGLVolume())}setFrame4D(r,e){const n=this.getVolumeIndexByID(r),i=this.volumes[n];e>i.nFrame4D-1&&(e=i.nFrame4D-1),e<0&&(e=0),e!==i.frame4D&&(i.frame4D=e,this.updateGLVolume(),this.onFrameChange(i,e),this.createOnLocationChange())}getFrame4D(r){const e=this.getVolumeIndexByID(r);return this.volumes[e].frame4D}colormapFromKey(r){return Vt.colormapFromKey(r)}colormap(r="",e=!1){return Vt.colormap(r,e)}createColormapTexture(r=null,e=0,n=256){return r!==null&&this.gl.deleteTexture(r),e<1||n<1?null:(r=this.gl.createTexture(),this.gl.activeTexture(xd),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,n,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),r)}addColormapList(r="",e=NaN,n=NaN,i=!1,a=!1,s=!0,o=!1){r.length<1&&(s=!1),this.colormapLists.push({name:r,min:e,max:n,isColorbarFromZero:i,negative:a,visible:s,invert:o})}refreshColormaps(){if(this.colormapLists=[],this.volumes.length<1&&this.meshes.length<1)return;const r=this.volumes.length;if(r>0)for(let s=0;s<r;s++){const o=this.volumes[s],l=gp(o.cal_min,o.cal_max,o.cal_minNeg,o.cal_maxNeg),c=o.colormapType!==0;this.addColormapList(o.colormapNegative,l[0],l[1],c,!0,o.colorbarVisible,o.colormapInvert),this.addColormapList(o.colormap,o.cal_min,o.cal_max,c,!1,o.colorbarVisible,o.colormapInvert)}const e=this.meshes.length;if(e>0)for(let s=0;s<e;s++){const o=this.meshes[s];if(!o.colorbarVisible)continue;const l=o.layers.length;if("edgeColormap"in o&&"edges"in o&&o.edges!==void 0){const c=gp(o.edgeMin,o.edgeMax,NaN,NaN);this.addColormapList(o.edgeColormapNegative,c[0],c[1],!1,!0,!0,o.colormapInvert),this.addColormapList(o.edgeColormap,o.edgeMin,o.edgeMax,!1,!1,!0,o.colormapInvert)}if(!(l<1))for(let c=0;c<l;c++){const u=this.meshes[s].layers[c];if(!u.colorbarVisible||u.colormap.length<1)continue;const h=u.colormapType!==0;if(u.useNegativeCmap){const g=gp(u.cal_min,u.cal_max,u.cal_minNeg,u.cal_maxNeg);this.addColormapList(u.colormapNegative,g[0],g[1],h,!0,!0,u.colormapInvert)}this.addColormapList(u.colormap,u.cal_min,u.cal_max,h,!1,!0,u.colormapInvert)}}const n=this.colormapLists.length;if(n<1)return;this.colormapTexture=this.createColormapTexture(this.colormapTexture,n+1);let i=new Uint8ClampedArray;function a(s){const o=new Uint8ClampedArray(i.length+s.length);o.set(i),o.set(s,i.length),i=o}for(let s=0;s<n;s++)a(Array.from(this.colormap(this.colormapLists[s].name,this.colormapLists[s].invert)));return a(Array.from(this.drawLut.lut)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,256,n+1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),this}sliceScale(r=!1){let e=this.screenFieldOfViewMM(0);r&&(e=this.screenFieldOfViewVox(0));const n=Math.max(e[0],Math.max(e[1],e[2])),i=[e[0]/n,e[1]/n,e[2]/n];if(!this.back?.dims)throw new Error("back.dims undefined");const a=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];return{volScale:i,vox:a,longestAxis:n,dimsMM:e}}tileIndex(r,e){for(let n=0;n<this.screenSlices.length;n++){const i=this.screenSlices[n].leftTopWidthHeight;if(r>i[0]&&e>i[1]&&r<i[0]+i[2]&&e<i[1]+i[3])return n}return-1}inRenderTile(r,e){const n=this.tileIndex(r,e);return n>=0&&this.screenSlices[n].axCorSag===4?n:-1}sliceScroll3D(r=0){if(r!==0){if(this.volumes.length>0&&this.scene.clipPlaneDepthAziElev[0]<1.8){const e=this.scene.clipPlaneDepthAziElev.slice();return r>0&&(e[0]=Math.min(1.5,e[0]+.025)),r<0&&(e[0]=Math.max(-1.5,e[0]-.025)),e[0]!==this.scene.clipPlaneDepthAziElev[0]?(this.scene.clipPlaneDepthAziElev=e,this.setClipPlane(this.scene.clipPlaneDepthAziElev)):void 0}r>0&&(this.scene.volScaleMultiplier=Math.min(2,this.scene.volScaleMultiplier*1.1)),r<0&&(this.scene.volScaleMultiplier=Math.max(.5,this.scene.volScaleMultiplier*.9)),this.drawScene()}}deleteThumbnail(){this.bmpTexture&&(this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=null,this.thumbnailVisible=!1)}inGraphTile(r,e){if(this.graph.opacity<=0||this.volumes.length<1||this.volumes[0].nFrame4D<1||!this.graph.plotLTWH||this.graph.plotLTWH[2]<1||this.graph.plotLTWH[3]<1)return!1;const n=[(r-this.graph.LTWH[0])/this.graph.LTWH[2],(e-this.graph.LTWH[1])/this.graph.LTWH[3]];return n[0]>0&&n[1]>0&&n[0]<=1&&n[1]<=1}updateBitmapFromClickToSegment(){if(this.clickToSegmentGrowingBitmap===null||this.drawBitmap===null||this.clickToSegmentGrowingBitmap.length!==this.drawBitmap.length)return;const r=this.drawBitmap.length;for(let e=0;e<r;e++)this.drawBitmap[e]=this.clickToSegmentGrowingBitmap[e]}sumBitmap(r){let e=0;for(let n=0;n<r.length;n++)e+=r[n];return e}doClickToSegment(r){const{tileIndex:e}=r;if(e<0||e>=this.screenSlices.length){Z.warn(`Invalid tileIndex ${e} received in doClickToSegment.`);return}const n=this.screenSlices[e].axCorSag;if(n>2){Z.warn("ClickToSegment attempted on non-2D slice tile.");return}const i=this.screenXY2TextureFrac(this.clickToSegmentXY[0],this.clickToSegmentXY[1],e,!1);if(i[0]<0){Z.debug("Click location outside valid texture fraction for the tile.");return}const a=this.frac2vox(i),s=this.opts.clickToSegmentPercent;let o=this.back.getValue(a[0],a[1],a[2]);this.opts.clickToSegmentAutoIntensity&&(s!==0&&(o===0&&(o=.01),this.opts.clickToSegmentIntensityMax=o*(1+s),this.opts.clickToSegmentIntensityMin=o*(1-s)),o>(this.back.cal_min+this.back.cal_max)*.5?this.opts.clickToSegmentBright=!0:this.opts.clickToSegmentBright=!1);const l=this.opts.clickToSegmentBright?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;this.drawPenAxCorSag=n;const c=this.clickToSegmentIsGrowing?this.clickToSegmentGrowingBitmap:this.drawBitmap;if(!c){if(Z.error("Target bitmap for flood fill is null."),this.clickToSegmentIsGrowing){if(this.drawBitmap||this.createEmptyDrawing(),!this.drawBitmap)return;this.clickToSegmentGrowingBitmap=this.drawBitmap.slice()}else if(this.createEmptyDrawing(),!this.drawBitmap)return;Z.warn("Initialized missing bitmap in doClickToSegment.")}if(this.drawFloodFill([a[0],a[1],a[2]],this.opts.penValue,l,this.opts.clickToSegmentIntensityMin,this.opts.clickToSegmentIntensityMax,this.opts.floodFillNeighbors,this.opts.clickToSegmentMaxDistanceMM,this.opts.clickToSegmentIs2D,c),!this.clickToSegmentIsGrowing&&(Z.debug("Applying clickToSegment mask to drawBitmap."),this.drawBitmap?(this.refreshDrawing(!1,!1),this.drawScene()):Z.error("Cannot refresh drawing after click-to-segment apply, drawBitmap is null."),this.drawBitmap)){const u=this.getDescriptives({layer:0,masks:[],drawingIsMask:!0});this.onClickToSegment({mL:u.volumeML,mm3:u.volumeMM3})}this.createOnLocationChange(n)}mouseClick(r,e,n=0,i=!0){if(r*=this.uiData.dpr,e*=this.uiData.dpr,this.canvas.focus(),this.thumbnailVisible){this.thumbnailVisible=!1,Promise.all([this.loadVolumes(this.deferredVolumes),this.loadMeshes(this.deferredMeshes)]).catch(a=>{throw a});return}if(this.inGraphTile(r,e)){if(!this.graph.plotLTWH)throw new Error("plotLTWH undefined");const a=[(r-this.graph.plotLTWH[0])/this.graph.plotLTWH[2],(e-this.graph.plotLTWH[1])/this.graph.plotLTWH[3]];if(a[0]>0&&a[1]>0&&a[0]<=1&&a[1]<=1){const s=Math.round(a[0]*(this.volumes[0].nFrame4D-1));this.setFrame4D(this.volumes[0].id,s);return}a[0]>.5&&a[1]>1&&this.loadDeferred4DVolumes(this.volumes[0].id).catch(s=>{throw s});return}if(this.inRenderTile(r,e)>=0){this.sliceScroll3D(n),this.drawScene();return}if(!(this.screenSlices.length<1||this.gl.canvas.height<1||this.gl.canvas.width<1))for(let a=0;a<this.screenSlices.length;a++){const s=this.screenSlices[a].axCorSag;if(this.drawPenAxCorSag>=0&&this.drawPenAxCorSag!==s||s>2&&!this.opts.clickToSegment&&n===0)continue;const o=this.screenXY2TextureFrac(r,e,a,!0);if(!(o[0]<0)){if(n!==0||!i){if(!i){s<=2&&(this.scene.crosshairPos[2-s]=n,this.drawScene(),this.createOnLocationChange(s));return}const l=n<0?-1:1,c=[0,0,0];s<=2&&(c[2-s]=l,this.moveCrosshairInVox(c[0],c[1],c[2]));return}if(this.opts.isForceMouseClickToVoxelCenters?this.scene.crosshairPos=Ri(this.vox2frac(this.frac2vox(o))):this.scene.crosshairPos=Ri(o),this.opts.drawingEnabled){const l=this.frac2vox(this.scene.crosshairPos);if(!isFinite(this.opts.penValue)||this.opts.penValue<0||Object.is(this.opts.penValue,-0)){let c=0,u=Math.abs(this.opts.penValue);const h=!0;Object.is(this.opts.penValue,-0)?(c=0,u=0,Z.debug("Erase Cluster selected")):(c=this.opts.penValue,Z.debug("Intensity Grow selected",c)),this.drawFloodFill(l,u,c,NaN,NaN,this.opts.floodFillNeighbors,Number.POSITIVE_INFINITY,!1,this.drawBitmap,h),this.drawScene(),this.createOnLocationChange(s);return}else if(this.opts.clickToSegment){s<=2&&(this.clickToSegmentIsGrowing=!1,this.doClickToSegment({x:this.clickToSegmentXY[0],y:this.clickToSegmentXY[1],tileIndex:a})),this.createOnLocationChange(s);return}else if(this.opts.penType===0){if(isNaN(this.drawPenLocation[0]))this.drawPenAxCorSag=s,this.drawPenFillPts=[],this.drawPt(...l,this.opts.penValue);else{if(l[0]===this.drawPenLocation[0]&&l[1]===this.drawPenLocation[1]&&l[2]===this.drawPenLocation[2]){this.drawScene(),this.createOnLocationChange(s);return}this.drawPenLine(l,this.drawPenLocation,this.opts.penValue)}this.drawPenLocation=l,this.opts.isFilledPen&&this.drawPenFillPts.push(l),this.refreshDrawing(!1,!1)}else(this.opts.penType===1||this.opts.penType===2)&&(isNaN(this.drawShapeStartLocation[0])?(this.drawPenAxCorSag=s,this.drawShapeStartLocation=[...l],this.drawBitmap&&(this.drawShapePreviewBitmap=this.drawBitmap.slice())):this.drawShapePreviewBitmap&&this.drawBitmap&&(this.drawBitmap.set(this.drawShapePreviewBitmap),this.opts.penType===1?this.drawRectangleMask(this.drawShapeStartLocation,l,this.opts.penValue):this.opts.penType===2&&this.drawEllipseMask(this.drawShapeStartLocation,l,this.opts.penValue),this.refreshDrawing(!1,!1)))}this.drawScene(),this.createOnLocationChange(s);return}}}drawRuler(){let r=[],e=[];for(let h=0;h<this.screenSlices.length;h++)if(this.screenSlices[h].axCorSag!==4&&this.screenSlices[h].fovMM.length>1){e=this.screenSlices[h].leftTopWidthHeight,r=this.screenSlices[h].fovMM;break}if(e.length<4)return;const i=100/r[0]*e[2],a=Math.max(Math.round(i*.1),2),s=Math.floor(e[0]+.5*e[2]-.5*i),o=Number(this.opts.rulerWidth),l=Math.floor(e[1]+e[3]-a)+.5*o,c=[s,l,s+i,l];let u=[0,0,0,1];this.opts.rulerColor[0]+this.opts.rulerColor[1]+this.opts.rulerColor[2]<.8&&(u=[1,1,1,1]),this.drawRuler10cm(c,u,o+1),this.drawRuler10cm(c,this.opts.rulerColor,o)}drawRuler10cm(r,e,n=1){if(!this.lineShader)throw new Error("lineShader undefined");this.gl.bindVertexArray(this.genericVAO),this.lineShader.use(this.gl),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,e),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,n),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,r),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);const i=-.1*(r[0]-r[2]),a=r[1]-Math.floor(.5*this.opts.rulerWidth),s=Math.floor(a-.35*i),o=Math.floor(a-.7*i);for(let l=0;l<11;l++){let c=r[0]+l*i;c=Math.max(c,r[0]+.5*n),c=Math.min(c,r[2]-.5*n);const u=[c,a,c,s];l%5===0&&(u[3]=o),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,u),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}this.gl.bindVertexArray(this.unusedVAO)}screenXY2mm(r,e,n=-1){let i;for(let a=0;a<this.screenSlices.length;a++){let s=a;if(n>=0&&(s=n),this.screenSlices[s].axCorSag>2)continue;const l=this.screenSlices[s].leftTopWidthHeight;if(r<l[0]||e<l[1]||r>l[0]+l[2]||e>l[1]+l[3]||(i=this.screenXY2TextureFrac(r,e,s,!1),i[0]<0))continue;const c=this.frac2mm(i);return Jt(c[0],c[1],c[2],s)}return Jt(NaN,NaN,NaN,NaN)}dragForPanZoom(r){const e=this.screenXY2mm(r[2],r[3]);if(isNaN(e[0]))return;const n=this.screenXY2mm(r[0],r[1],e[3]);if(isNaN(n[0])||isNaN(e[0])||isNaN(e[3]))return;const i=Qi(),a=this.uiData.pan2DxyzmmAtMouseDown[3];az(i,e,n),this.scene.pan2Dxyzmm[0]=this.uiData.pan2DxyzmmAtMouseDown[0]+a*i[0],this.scene.pan2Dxyzmm[1]=this.uiData.pan2DxyzmmAtMouseDown[1]+a*i[1],this.scene.pan2Dxyzmm[2]=this.uiData.pan2DxyzmmAtMouseDown[2]+a*i[2],this.canvas.focus()}dragForCenterButton(r){this.dragForPanZoom(r)}dragForSlicer3D(r){let e=this.uiData.pan2DxyzmmAtMouseDown[3];const n=r[3]-r[1];e+=n*.01,e=Math.max(e,.1),e=Math.min(e,10);const a=this.scene.pan2Dxyzmm[3]-e;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=e),this.scene.pan2Dxyzmm[3]=e;const s=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=a*s[0],this.scene.pan2Dxyzmm[1]+=a*s[1],this.scene.pan2Dxyzmm[2]+=a*s[2]}drawMeasurementTool(r,e=!0){function n(u,h,g,v,m){const y=u-g,b=h-v;if(y===0&&b===0)return{origin:[g+m,v],terminus:[g+m,v]};const x=Math.sqrt(y*y+b*b),A=m*y/x,C=m*b/x;return{origin:[u+A,h+C],terminus:[g-A,v-C]}}const i=this.gl;if(i.bindVertexArray(this.genericVAO),i.depthFunc(i.ALWAYS),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),i.uniform4fv(this.lineShader.uniforms.lineColor,this.opts.rulerColor),i.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[i.canvas.width,i.canvas.height]),i.uniform1f(this.lineShader.uniforms.thickness,this.opts.rulerWidth),i.uniform4fv(this.lineShader.uniforms.startXYendXY,r),i.drawArrays(i.TRIANGLE_STRIP,0,4);const a=this.opts.measureLineColor;a[3]=1,i.uniform4fv(this.lineShader.uniforms.lineColor,a);const s=this.opts.rulerWidth;i.uniform1f(this.lineShader.uniforms.thickness,s*2);let o=[r[0],r[1]-s,r[0],r[1]+s];i.uniform4fv(this.lineShader.uniforms.startXYendXY,o),i.drawArrays(i.TRIANGLE_STRIP,0,4),o=[r[2],r[3]-s,r[2],r[3]+s],i.uniform4fv(this.lineShader.uniforms.startXYendXY,o),i.drawArrays(i.TRIANGLE_STRIP,0,4);let l=this.canvasPos2frac([r[0],r[1]]),c=this.canvasPos2frac([r[2],r[3]]);if(l[0]>=0&&c[0]>=0){const u=this.frac2mm(l);l=Me(u[0],u[1],u[2]);const h=this.frac2mm(c);c=Me(h[0],h[1],h[2]);const g=Kt();gC(g,l,c);const v=$c(g);let m=2;v>9&&(m=1),v>99&&(m=0);let y=v.toFixed(m);this.opts.showMeasureUnits&&(y=`${y} mm`);let b=r;const[x,A,C,E]=r,{origin:S,terminus:M}=n(x,A,C,E,30);switch(this.opts.measureTextJustify){case"start":b=[...S,...S.map(R=>R+1)];break;case"end":b=b=[...M,...M.map(R=>R+1)];break;default:b=r;break}e&&this.drawTextBetween(b,y,this.opts.measureTextHeight/.06,this.opts.measureTextColor)}i.bindVertexArray(this.unusedVAO)}drawAngleMeasurementTool(){this.uiData.angleState==="drawing_first_line"?this.drawMeasurementTool([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],!1):this.uiData.angleState==="drawing_second_line"&&(this.drawMeasurementTool(this.uiData.angleFirstLine,!1),this.drawMeasurementTool([this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],!1),this.drawAngleText())}drawAngleText(){const r=this.uiData.angleFirstLine,e=[this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],n=this.calculateAngleBetweenLines(r,e),i=this.uiData.angleFirstLine[2],a=this.uiData.angleFirstLine[3],s=`${n.toFixed(1)}°`;this.drawTextBetween([i,a,i+1,a+1],s,this.opts.measureTextHeight/.06,this.opts.measureTextColor)}drawAngleTextForAngle(r){const e=this.calculateAngleBetweenLines(r.firstLine,r.secondLine),n=r.firstLine[2],i=r.firstLine[3],a=`${e.toFixed(1)}°`;this.drawTextBetween([n,i,n+1,i+1],a,this.opts.measureTextHeight/.06,this.opts.measureTextColor)}calculateAngleBetweenLines(r,e){const n=r[2],i=r[3],a=r[0]-n,s=r[1]-i,o=e[2]-n,l=e[3]-i,c=a*o+s*l,u=Math.sqrt(a*a+s*s),h=Math.sqrt(o*o+l*l);if(u===0||h===0)return 0;const g=Math.max(-1,Math.min(1,c/(u*h)));return Math.acos(g)*(180/Math.PI)}resetAngleMeasurement(){this.uiData.angleState="none",this.uiData.angleFirstLine=[0,0,0,0]}getCurrentSliceInfo(){const r=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]);if(r>=0&&r<this.screenSlices.length){const i=this.screenSlices[r].axCorSag;let a=0;return i===0?a=this.scene.crosshairPos[2]:i===1?a=this.scene.crosshairPos[1]:i===2&&(a=this.scene.crosshairPos[0]),{sliceIndex:r,sliceType:i,slicePosition:a}}const e=this.opts.sliceType;let n=0;return e===0?n=this.scene.crosshairPos[2]:e===1?n=this.scene.crosshairPos[1]:e===2?n=this.scene.crosshairPos[0]:e===3&&this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]])[0]>=0&&(n=this.scene.crosshairPos[2]),{sliceIndex:-1,sliceType:e,slicePosition:n}}getCurrentSlicePosition(r){return r===0?this.scene.crosshairPos[2]:r===1?this.scene.crosshairPos[1]:r===2?this.scene.crosshairPos[0]:0}shouldDrawOnCurrentSlice(r,e,n){if(this.opts.sliceType===3){if(e>2)return!1;for(let l=0;l<this.screenSlices.length;l++)if(this.screenSlices[l].axCorSag===e){const c=this.getCurrentSlicePosition(e);if(Math.abs(c-n)<.001)return!0}return!1}else if(this.opts.sliceType!==e)return!1;const i=this.getCurrentSlicePosition(e);return Math.abs(i-n)<.001}clearMeasurements(){this.document.completedMeasurements=[],this.drawScene()}clearAngles(){this.document.completedAngles=[],this.drawScene()}clearAllMeasurements(){this.document.completedMeasurements=[],this.document.completedAngles=[],this.drawScene()}setDragMode(r){if(typeof r=="string")switch(r){case"none":this.opts.dragMode=0;break;case"contrast":this.opts.dragMode=1;break;case"measurement":this.opts.dragMode=2;break;case"angle":this.opts.dragMode=7;break;case"pan":this.opts.dragMode=3;break;case"slicer3D":this.opts.dragMode=4;break;case"callbackOnly":this.opts.dragMode=5;break;case"roiSelection":this.opts.dragMode=6;break;default:console.warn(`Unknown drag mode: ${r}`);return}else this.opts.dragMode=r;this.opts.dragMode!==7&&this.resetAngleMeasurement(),this.clearActiveDragMode()}setMouseEventConfig(r){this.opts.mouseEventConfig=r,this.clearActiveDragMode()}setTouchEventConfig(r){this.opts.touchEventConfig=r,this.clearActiveDragMode()}getMouseEventConfig(){return this.opts.mouseEventConfig}getTouchEventConfig(){return this.opts.touchEventConfig}drawRect(r,e=[1,0,0,-1]){if(e[3]<0&&(e=this.opts.crosshairColor),!this.rectShader)throw new Error("rectShader undefined");this.opts.selectionBoxIsOutline?(this.drawCircle(r,e,.1),this.rectOutlineShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform1f(this.rectOutlineShader.uniforms.thickness,this.opts.selectionBoxLineThickness),this.gl.uniform4fv(this.rectOutlineShader.uniforms.lineColor,e),this.gl.uniform2fv(this.rectOutlineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectOutlineShader.uniforms.leftTopWidthHeight,r[0],r[1],r[2],r[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)):(this.rectShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.rectShader.uniforms.lineColor,e),this.gl.uniform2fv(this.rectShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectShader.uniforms.leftTopWidthHeight,r[0],r[1],r[2],r[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO))}drawCircle(r,e=this.opts.fontColor,n=1){if(!this.circleShader)throw new Error("circleShader undefined");this.circleShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,e),this.gl.uniform2fv(this.circleShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.circleShader.uniforms.leftTopWidthHeight,r[0],r[1],r[2],r[3]),this.gl.uniform1f(this.circleShader.uniforms.fillPercent,n),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,e),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawSelectionBox(r){if(this.getCurrentDragMode()===6){this.drawCircle(r,this.opts.selectionBoxColor,.1);return}this.drawRect(r,this.opts.selectionBoxColor)}effectiveCanvasHeight(){return this.gl.canvas.height-this.colorbarHeight}effectiveCanvasWidth(){return this.gl.canvas.width-this.getLegendPanelWidth()}getAllLabels(){const i=this.meshes.filter(s=>s.type==="connectome").flatMap(s=>s.nodes).map(s=>s.label).filter(s=>s!==void 0);return[...this.document.labels,...i]}getConnectomeLabels(){const i=this.meshes.filter(l=>l.type==="connectome"&&l.showLegend!==!1).flatMap(l=>l.nodes).map(l=>l.label).filter(l=>l!==void 0&&l.text!==""),a=this.document.labels.filter(l=>l.anchor==null||l.anchor===0),s=new Set(i);for(const l of a)s.add(l);const o=this.meshes.filter(l=>l.type==="mesh");for(let l=0;l<o.length;l++)for(let c=0;c<o[l].layers.length;c++)if(o[l].layers[c].labels)for(let u=0;u<o[l].layers[c].labels.length;u++)s.add(o[l].layers[c].labels[u]);return Array.from(s)}getBulletMarginWidth(){let r=0;const e=this.getConnectomeLabels();if(e.length===0)return 0;const n=e.length===1?e[0].style.bulletScale:e.reduce((s,o)=>s.style.bulletScale>o.style.bulletScale?s:o).style.bulletScale,i=e.length===1?e[0]:e.reduce((s,o)=>{const l=this.fontPx*s.style.textScale,c=this.fontPx*o.style.textScale;return this.textHeight(l,s.text)>this.textHeight(c,o.text)?s:o}),a=this.fontPx*i.style.textScale;return r=this.textHeight(a,i.text)*n,r+=a,r}getLegendPanelWidth(){const r=this.getConnectomeLabels();if(!this.opts.showLegend||r.length===0)return 0;const n=this.fontPx*1;let i=0;const a=r.reduce((c,u)=>{const h=this.fontPx*c.style.textScale,g=this.fontPx*u.style.textScale;return this.textWidth(h,c.text)>this.textWidth(g,u.text)?c:u}),s=this.fontPx*a.style.textScale,o=this.textWidth(s,a.text),l=this.getBulletMarginWidth();return o&&(i=l+o,i+=n*2),i>=this.gl.canvas.width?0:i}getLegendPanelHeight(r=1){const e=this.getConnectomeLabels();let n=0;const i=this.fontPx;for(const a of e){const s=this.fontPx*a.style.textScale*r,o=this.textHeight(s,a.text);n+=o}return n&&(n+=i/2*(e.length+1)*r),n}reserveColorbarPanel(){const r=3*this.fontPx;if(r<0)return[0,0,0,0];const n=(this.opts.colorbarWidth>0&&this.opts.colorbarWidth<=1?this.opts.colorbarWidth:1)*this.gl.canvas.width,i=[(this.gl.canvas.width-n)/2,this.gl.canvas.height-r,n,r];return this.colorbarHeight=i[3]+1,i}drawColorbarCore(r=0,e=[0,0,0,0],n=!1,i=0,a=1,s){if(e[2]<=0||e[3]<=0)return;const o=this.fontPx;if(o<=0)return;let l=o;const c=3*o;let u=o;if(e[3]<c){if(e[3]<3)return;l=1,u=e[3]-2}this.gl.disable(this.gl.DEPTH_TEST),this.colorbarHeight=e[3]+1;const h=[e[0]+l,e[1],e[2]-2*l,u],g=[h[0]-1,h[1]-1,h[2]+2,h[3]+2];if(this.opts.showColorbarBorder&&this.drawRect(g,this.opts.crosshairColor),!this.colorbarShader)throw new Error("colorbarShader undefined");this.colorbarShader.use(this.gl),this.gl.activeTexture(xd),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);const v=r;if(this.gl.uniform1f(this.colorbarShader.uniforms.layer,v),this.gl.uniform2fv(this.colorbarShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.disable(this.gl.CULL_FACE),n){const R=[h[0]+h[2],h[1],-h[2],h[3]];this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,R)}else this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,h);this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);let m=0;if(s&&a<0&&n?(m=a,a=0):s&&i>0&&(m=i,i=0),i===a||o<1)return;const y=Math.abs(a-i);let[b,x]=KC(i,a);x<i&&(x+=b);function A(R){return R.toFixed(6).replace(/\.?0*$/,"")}let C=x;const E=[0,h[1]+h[3]-o*.5,2,o*.75],S=E[1]+E[3],M=1;for(;C<=a;){E[0]=h[0]+(C-i)/y*h[2],this.drawRect(E);const R=A(M*C);this.drawTextBelow([E[0],S],R),C+=b}if(m!==0){const R=[h[0]+(m-i)/y*h[2],h[1]-h[3]*.25,2,h[3]*1.5];this.drawRect(R)}}drawColorbar(){const r=this.colormapLists,e=r.length;if(e<1)return;let n=0;for(let o=0;o<e;o++)r[o].visible&&n++;if(n<1)return;let i=this.reserveColorbarPanel();const a=3*this.fontPx;if(a<0)return;let s=i[2]/n;(i[2]<=0||i[3]<=0)&&(s=this.gl.canvas.width/n,i=[0,this.gl.canvas.height-a,s,a]),i[2]=s;for(let o=0;o<e;o++)r[o].visible&&(this.drawColorbarCore(o,i,r[o].negative,r[o].min,r[o].max,r[o].isColorbarFromZero),i[0]+=s)}textWidth(r,e){if(!e)return 0;let n=0;const i=new TextEncoder().encode(e);for(let a=0;a<e.length;a++)n+=r*this.fontMets.mets[i[a]].xadv;return n}textHeight(r,e){if(!e)return 0;const n=new Set(Array.from(e)),i=new TextEncoder().encode(Array.from(n).join("")),s=Object.values(this.fontMets.mets).filter((o,l)=>i.includes(l)).reduce((o,l)=>o.lbwh[3]>l.lbwh[3]?o:l).lbwh[3];return r*s}drawChar(r,e,n){if(!this.fontShader)throw new Error("fontShader undefined");const i=this.fontMets.mets[n],a=r[0]+e*i.lbwh[0],s=-(e*i.lbwh[1]),o=e*i.lbwh[2],l=e*i.lbwh[3],c=r[1]+(s-l)+e;return this.gl.uniform4f(this.fontShader.uniforms.leftTopWidthHeight,a,c,o,l),this.gl.uniform4fv(this.fontShader.uniforms.uvLeftTopWidthHeight,i.uv_lbwh),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),e*i.xadv}drawLoadingText(r){if(r){if(!this.canvas)throw new Error("canvas undefined");this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.drawTextBelow([this.canvas.width/2,this.canvas.height/2],r,3)}}drawText(r,e,n=1,i=null){if(this.fontPx<=0)return;if(!this.fontShader)throw new Error("fontShader undefined");this.fontShader.use(this.gl);const a=this.fontPx*n;this.gl.enable(this.gl.BLEND),this.gl.uniform2f(this.fontShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height),i===null&&(i=this.opts.fontColor),this.gl.uniform4fv(this.fontShader.uniforms.fontColor,i);let s=a/this.fontMets.size*this.fontMets.distanceRange;s=Math.max(s,1),this.gl.uniform1f(this.fontShader.uniforms.screenPxRange,s);const o=new TextEncoder().encode(e);this.gl.bindVertexArray(this.genericVAO);for(let l=0;l<e.length;l++)r[0]+=this.drawChar(r,a,o[l]);this.gl.bindVertexArray(this.unusedVAO)}drawTextRight(r,e,n=1,i=null){this.fontPx<=0||(r[1]-=.5*this.fontPx,this.drawText(r,e,n,i))}drawTextLeft(r,e,n=1,i=null){if(this.fontPx<=0)return;const a=this.fontPx*n;r[0]-=this.textWidth(a,e),r[1]-=.5*a,this.drawText(r,e,n,i)}drawTextRightBelow(r,e,n=1,i=null){this.fontPx<=0||this.drawText(r,e,n,i)}drawTextBetween(r,e,n=1,i=null){if(this.fontPx<=0)return;const a=[(r[0]+r[2])*.5,(r[1]+r[3])*.5],s=this.fontPx*n,o=this.textWidth(s,e);a[0]-=.5*o,a[1]-=.5*s;const l=[a[0]-1,a[1]-1,o+2,s+2];let c=i;c===null&&(c=this.opts.crosshairColor),c&&c[0]+c[1]+c[2]>.8?c=[0,0,0,.5]:c=[1,1,1,.5],this.drawRect(l,c),this.drawText(a,e,n,i)}drawTextBelow(r,e,n=1,i=null){if(this.fontPx<=0)return;if(!this.canvas)throw new Error("canvas undefined");let a=this.fontPx*n,s=this.textWidth(a,e);s>this.canvas.width&&(n*=(this.canvas.width-2)/s,a=this.fontPx*n,s=this.textWidth(a,e)),r[0]-=.5*this.textWidth(a,e),r[0]=Math.max(r[0],1),r[0]=Math.min(r[0],this.canvas.width-s-1),this.drawText(r,e,n,i)}drawTextAbove(r,e,n=1,i=null){if(this.fontPx<=0)return;if(!this.canvas)throw new Error("canvas undefined");let a=this.fontPx*n,s=this.textWidth(a,e);s>this.canvas.width&&(n*=(this.canvas.width-2)/s,a=this.fontPx*n,s=this.textWidth(a,e)),r[0]-=.5*this.textWidth(a,e),r[0]=Math.max(r[0],1),r[0]=Math.min(r[0],this.canvas.width-s-1),r[1]-=a,this.drawText(r,e,n,i)}updateInterpolation(r,e=!1){let n=this.gl.LINEAR;!e&&this.opts.isNearestInterpolation&&(n=this.gl.NEAREST),r===0?this.gl.activeTexture(Ml):this.gl.activeTexture(yp),this.opts.is2DSliceShader?(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,n),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,n)):(this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,n),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,n))}setAtlasOutline(r){this.opts.atlasOutline=r,this.updateGLVolume(),this.drawScene()}setInterpolation(r){this.opts.isNearestInterpolation=r;const e=this.volumes.length;if(!(e<1)){for(let n=0;n<e;n++)this.updateInterpolation(n);this.drawScene()}}calculateMvpMatrix2D(r,e,n,i=1/0,a=0,s=0,o=0,l){this.gl.viewport(r[0],this.gl.canvas.height-(r[1]+r[3]),r[2],r[3]);let u=e[0],h=n[0],g=[u,e[1]],v=[h-u,n[1]-e[1]];l&&(g=[n[0],e[1]],v=[e[0]-n[0],n[1]-e[1]],u=-n[0],h=-e[0]);const m=2*Math.max(Math.abs(e[2]),Math.abs(n[2])),y=bt();let b=.01,x=m*8;if(i!==1/0){let R=l;o===0&&(s===0||s===180)&&(R=!R);let T=m*1.8-a;R||(T=m*1.8+a),b=T-i,x=T+i}hd(y,u,h,e[1],n[1],b,x);const A=bt();A[0]=-1;const C=Me(0,0,-m*1.8);Rl(A,A,C),cd(A,A,ds(270-o)),fd(A,A,ds(s-180));const E=bt();kn(E,A);const S=bt();Zn(S,E);const M=bt();return ys(M,y,A),{modelViewProjectionMatrix:M,modelMatrix:A,normalMatrix:S,leftTopMM:g,fovMM:v}}swizzleVec3MM(r,e){return e===1?r=yr(r,[0,2,1]):e===2&&(r=yr(r,[1,2,0])),r}screenFieldOfViewVox(r=0){const e=Ri(this.volumeObject3D.fieldOfViewDeObliqueMM);return this.swizzleVec3MM(e,r)}screenFieldOfViewMM(r=0,e=!1){if(this.volumes.length<1){let l=Me(this.extentsMin[0],this.extentsMin[1],this.extentsMin[2]),c=Me(this.extentsMax[0],this.extentsMax[1],this.extentsMax[2]);l=this.swizzleVec3MM(l,r),c=this.swizzleVec3MM(c,r);const u=Kt();return Wt(u,c,l),u}if(!e&&!this.opts.isSliceMM)return this.screenFieldOfViewVox(r);const n=this.volumeObject3D.extentsMin,i=this.volumeObject3D.extentsMax;let a=Me(n[0],n[1],n[2]),s=Me(i[0],i[1],i[2]);a=this.swizzleVec3MM(a,r),s=this.swizzleVec3MM(s,r);const o=Kt();return Wt(o,s,a),o}screenFieldOfViewExtendedVox(r=0){const e=this.volumes[0].extentsMinOrtho,n=this.volumes[0].extentsMaxOrtho;let i=Me(e[0],e[1],e[2]),a=Me(n[0],n[1],n[2]);const s=bt();i=this.swizzleVec3MM(i,r),a=this.swizzleVec3MM(a,r);const o=Kt();return Wt(o,a,i),{mnMM:i,mxMM:a,rotation:s,fovMM:o}}screenFieldOfViewExtendedMM(r=0){if(this.volumes.length<1){let l=Me(this.extentsMin[0],this.extentsMin[1],this.extentsMin[2]),c=Me(this.extentsMax[0],this.extentsMax[1],this.extentsMax[2]);const u=bt();l=this.swizzleVec3MM(l,r),c=this.swizzleVec3MM(c,r);const h=Kt();return Wt(h,c,l),{mnMM:l,mxMM:c,rotation:u,fovMM:h}}if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");const e=this.volumeObject3D.extentsMin,n=this.volumeObject3D.extentsMax;let i=Me(e[0],e[1],e[2]),a=Me(n[0],n[1],n[2]);const s=bt();i=this.swizzleVec3MM(i,r),a=this.swizzleVec3MM(a,r);const o=Kt();return Wt(o,a,i),{mnMM:i,mxMM:a,rotation:s,fovMM:o}}drawSliceOrientationText(r,e,n=[NaN,NaN]){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let i="S";e===0&&(i="A");let a=this.opts.isRadiologicalConvention?"R":"L";e===2&&(a=this.opts.sagittalNoseLeft?"A":"P");let s="I";e===0&&(s="P");let o=this.opts.isRadiologicalConvention?"L":"R";if(e===2&&(o=this.opts.sagittalNoseLeft?"P":"A"),this.opts.isCornerOrientationText){this.drawTextRightBelow([r[0],r[1]],a+i);return}let l=!0,c=!0;const u=this.opts.showAllOrientationMarkers,h=this.opts.showAllOrientationMarkers;if(!isNaN(n[0])){const g=this.fontPx+2;n[1]>g&&(this.drawTextBelow([r[0]+r[2]*.5,r[1]+n[1]-g],i),l=!1);const v=this.textWidth(g,a)+2;n[0]>v&&(this.drawTextRight([r[0]+n[0]-v,r[1]+r[3]*.5],a),c=!1)}l&&this.drawTextBelow([r[0]+r[2]*.5,r[1]],i),c&&this.drawTextRight([r[0],r[1]+r[3]*.5],a),u&&this.drawTextAbove([r[0]+r[2]*.5,r[1]+r[3]],s),h&&this.drawTextLeft([r[0]+r[2],r[1]+r[3]*.5],o)}xyMM2xyzMM(r,e){let n=2;r===1&&(n=1),r===2&&(n=0);let i=[0,0,0],a=[1,1,0],s=[1,0,1];i[n]=e,a[n]=e,s[n]=e,i=this.frac2mm(i),a=this.frac2mm(a),s=this.frac2mm(s),i=this.swizzleVec3MM(Me(i[0],i[1],i[2]),r),a=this.swizzleVec3MM(Me(a[0],a[1],a[2]),r),s=this.swizzleVec3MM(Me(s[0],s[1],s[2]),r);const o=(a[0]-i[0])*(s[1]-i[1])-(s[0]-i[0])*(a[1]-i[1]);let l=(a[0]-i[0])*(s[2]-i[2])-(s[0]-i[0])*(a[2]-i[2]);l/=o;let c=(a[1]-i[1])*(s[2]-i[2])-(s[1]-i[1])*(a[2]-i[2]);c/=o;const u=[0,0,0,0,0];return u[0]=i[0],u[1]=i[1],u[2]=i[2],u[3]=c,u[4]=l,u}draw2DMain(r,e,n=NaN){let i=new Float32Array([0,0,0]);this.volumes.length>0&&(i=new Float32Array(this.volumes[0].frac2mm.slice()));let a=this.screenFieldOfViewExtendedMM(e),s=bt();!this.opts.isSliceMM&&this.volumes.length>0&&(i=new Float32Array(this.volumes[0].frac2mmOrtho.slice()),s=Er(this.volumes[0].mm2ortho),a=this.screenFieldOfViewExtendedVox(e));let o=this.opts.isRadiologicalConvention&&e<2;n===1/0||n===-1/0?(o=n!==1/0,e===1&&(o=!o)):this.opts.sagittalNoseLeft&&e===2&&(o=!o);let l=0,c=0;e===2?c=o?90:-90:e===1?c=o?180:0:(c=o?180:0,l=o?-90:90);const u=this.gl;let h=!1;if(r[2]===0||r[3]===0){h=!0;const x=u.canvas.width/a.fovMM[0],A=u.canvas.height/a.fovMM[1],C=Math.min(x,A),E=x/C,S=A/C;a.fovMM[0]*=E,a.fovMM[1]*=S;let M=(a.mnMM[0]+a.mxMM[0])*.5;a.mnMM[0]=M-a.fovMM[0]*.5,a.mxMM[0]=M+a.fovMM[0]*.5,M=(a.mnMM[1]+a.mxMM[1])*.5,a.mnMM[1]=M-a.fovMM[1]*.5,a.mxMM[1]=M+a.fovMM[1]*.5,r=[0,0,u.canvas.width,u.canvas.height]}if(isNaN(n)){const x=this.scene.pan2Dxyzmm,A=this.swizzleVec3MM(Me(x[0],x[1],x[2]),e),C=this.scene.pan2Dxyzmm[3];a.mnMM[0]-=A[0],a.mxMM[0]-=A[0],a.mnMM[1]-=A[1],a.mxMM[1]-=A[1],a.mnMM[0]/=C,a.mxMM[0]/=C,a.mnMM[1]/=C,a.mxMM[1]/=C}let g=2;e===1&&(g=1),e===2&&(g=0);let v=this.scene.crosshairPos[g],m=this.frac2mm(this.scene.crosshairPos);!isNaN(n)&&n!==1/0&&n!==-1/0&&(m=this.frac2mm([.5,.5,.5]),m[g]=n,v=this.mm2frac(m)[g]);const y=m[g];u.clear(u.DEPTH_BUFFER_BIT);let b=this.calculateMvpMatrix2D(r,a.mnMM,a.mxMM,1/0,0,c,l,o);if(n===1/0||n===-1/0){const x=r.slice();this.draw3D(r,b.modelViewProjectionMatrix,b.modelMatrix,b.normalMatrix,c,l);const A=this.screenSlices[this.screenSlices.length-1];A.leftTopWidthHeight=x,A.axCorSag=e,A.sliceFrac=1/0,A.AxyzMxy=this.xyMM2xyzMM(e,v),A.leftTopMM=b.leftTopMM,A.fovMM=b.fovMM;return}if(u.enable(u.DEPTH_TEST),u.blendFunc(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA),u.disable(u.BLEND),u.depthFunc(u.GREATER),u.disable(u.CULL_FACE),this.volumes.length>0){let x=this.sliceMMShader;if(this.opts.is2DSliceShader&&(x=this.slice2DShader),this.opts.isV1SliceShader&&(x=this.sliceV1Shader),this.customSliceShader&&(x=this.customSliceShader),!x)throw new Error("slice Shader undefined");x.use(this.gl),u.uniform1f(x.uniforms.overlayOutlineWidth,this.overlayOutlineWidth),u.uniform1f(x.uniforms.overlayAlphaShader,this.overlayAlphaShader),u.uniform1i(x.uniforms.isAlphaClipDark,this.isAlphaClipDark?1:0),u.uniform1i(x.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),u.uniform1f(x.uniforms.drawOpacity,this.drawOpacity),u.uniform1f(x.uniforms.drawRimOpacity,this.drawRimOpacity),u.enable(u.BLEND),u.blendFunc(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA),u.uniform1f(x.uniforms.opacity,this.volumes[0].opacity),u.uniform1i(x.uniforms.axCorSag,e),u.uniform1f(x.uniforms.slice,v),u.uniformMatrix4fv(x.uniforms.frac2mm,!1,i),u.uniformMatrix4fv(x.uniforms.mvpMtx,!1,b.modelViewProjectionMatrix.slice()),u.bindVertexArray(this.genericVAO),u.drawArrays(u.TRIANGLE_STRIP,0,4),u.bindVertexArray(this.unusedVAO),this.screenSlices.push({leftTopWidthHeight:r,axCorSag:e,sliceFrac:v,AxyzMxy:this.xyMM2xyzMM(e,v),leftTopMM:b.leftTopMM,screen2frac:[],fovMM:b.fovMM})}if(isNaN(n)&&this.drawCrosshairs3D(!0,1,b.modelViewProjectionMatrix,!0,this.opts.isSliceMM),this.opts.meshThicknessOn2D>0){this.opts.meshThicknessOn2D!==1/0&&(b=this.calculateMvpMatrix2D(r,a.mnMM,a.mxMM,this.opts.meshThicknessOn2D,y,c,l,o));const x=Er(b.modelViewProjectionMatrix);ys(x,x,s),this.drawMesh3D(!0,1,x,b.modelMatrix,b.normalMatrix)}isNaN(n)&&this.drawCrosshairs3D(!1,.15,b.modelViewProjectionMatrix,!0,this.opts.isSliceMM),h&&this.opts.isOrientationTextVisible&&this.drawSliceOrientationText(r,e),this.readyForSync=!0}draw2D(r,e,n=NaN,i=[NaN,NaN]){const a=[NaN,NaN];if(i[0]===1/0){const s=this.sliceScale().volScale;let o=this.scaleSlice(s[0],s[1],[0,0],[r[2],r[3]]);e===1&&(o=this.scaleSlice(s[0],s[2],[0,0],[r[2],r[3]])),e===2&&(o=this.scaleSlice(s[1],s[2],[0,0],[r[2],r[3]])),i[0]=o[2],i[1]=o[3]}if(isNaN(i[0]))this.draw2DMain(r,e,n);else{const s=r.slice();a[0]=Math.floor(.5*(s[2]-i[0])),a[1]=Math.floor(.5*(s[3]-i[1])),s[0]+=a[0],s[1]+=a[1],s[2]=i[0],s[3]=i[1],this.draw2DMain(s,e,n)}n===1/0||n===-1/0||e===4||r[2]!==0&&r[3]!==0&&this.opts.isOrientationTextVisible&&this.drawSliceOrientationText(r,e,a)}calculateMvpMatrix(r,e=[0,0,0,0],n,i){(e[2]===0||e[3]===0)&&(e=[0,0,this.gl.canvas.width,this.gl.canvas.height]);const a=e[2]/e[3];let s=this.furthestFromPivot;const o=this.pivot3D,l=bt();s=.8*s/this.scene.volScaleMultiplier,a<1?hd(l,-s,s,-s/a,s/a,s*.01,s*8):hd(l,-s*a,s*a,-s,s,s*.01,s*8);const c=bt();c[0]=-1;const u=Me(0,0,-s*1.8);Rl(c,c,u),this.position&&Rl(c,c,this.position),cd(c,c,ds(270-i)),fd(c,c,ds(n-180)),Rl(c,c,[-o[0],-o[1],-o[2]]);const h=bt();kn(h,c);const g=bt();Zn(g,h);const v=bt();return ys(v,l,c),[v,c,g]}calculateModelMatrix(r,e){if(!this.back)throw new Error("back undefined");const n=bt();if(n[0]=-1,cd(n,n,ds(270-e)),fd(n,n,ds(r-180)),this.back.obliqueRAS){const i=Er(this.back.obliqueRAS);ys(n,n,i)}return n}calculateRayDirection(r,e){const n=this.calculateModelMatrix(r,e),i=Wn(1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1),a=bt();ys(a,i,n);const s=bt();kn(s,a);const o=Jt(0,0,-1,1);Kr(o,o,s);const l=Me(o[0],o[1],o[2]);yi(l,l);const c=5e-5;return Math.abs(l[0])<c&&(l[0]=c),Math.abs(l[1])<c&&(l[1]=c),Math.abs(l[2])<c&&(l[2]=c),l}sceneExtentsMinMax(r=!0){let e=Me(0,0,0),n=Me(0,0,0);if(this.volumes.length>0){if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");e=Me(this.volumeObject3D.extentsMin[0],this.volumeObject3D.extentsMin[1],this.volumeObject3D.extentsMin[2]),n=Me(this.volumeObject3D.extentsMax[0],this.volumeObject3D.extentsMax[1],this.volumeObject3D.extentsMax[2]),r||(e=Me(this.volumes[0].extentsMinOrtho[0],this.volumes[0].extentsMinOrtho[1],this.volumes[0].extentsMinOrtho[2]),n=Me(this.volumes[0].extentsMaxOrtho[0],this.volumes[0].extentsMaxOrtho[1],this.volumes[0].extentsMaxOrtho[2]))}if(this.meshes.length>0){if(this.volumes.length<1){const a=this.meshes[0].extentsMin,s=this.meshes[0].extentsMax;e=Me(a[0],a[1],a[2]),n=Me(s[0],s[1],s[2])}for(let a=0;a<this.meshes.length;a++){const s=this.meshes[a].extentsMin,o=this.meshes[a].extentsMax,l=Me(s[0],s[1],s[2]);uy(e,e,l);const c=Me(o[0],o[1],o[2]);cy(n,n,c)}}const i=Kt();return Wt(i,n,e),[e,n,i]}setPivot3D(){const[r,e]=this.sceneExtentsMinMax(),n=Kt();xo(n,r,e),J_(n,n,.5),this.pivot3D=[n[0],n[1],n[2]],Wt(n,e,r),this.extentsMin=r,this.extentsMax=e,this.furthestFromPivot=Ts(n)*.5}getMaxVols(){if(this.volumes.length<1)return 0;let r=0;for(let e=0;e<this.volumes.length;e++)r=Math.max(r,this.volumes[e].nFrame4D);return r}detectPartialllyLoaded4D(){if(this.volumes.length<1)return!1;for(let r=0;r<this.volumes.length;r++)if(this.volumes[r].nFrame4D<this.volumes[r].hdr.dims[4])return!0;return!1}drawGraph(){if(this.getMaxVols()<2)return;const r=this.graph;let e=0;if(this.graph.autoSizeMultiplanar&&this.opts.sliceType===3)for(let q=0;q<this.screenSlices.length;q++){const H=this.screenSlices[q].axCorSag;if(H===0&&(e=this.screenSlices[q].leftTopWidthHeight[1]),H!==2)continue;const W=this.screenSlices[q].leftTopWidthHeight.slice();W[1]===e?(r.LTWH[0]=W[0]+W[2],r.LTWH[1]=W[1]):(r.LTWH[0]=W[0],r.LTWH[1]=W[1]+W[3]),r.LTWH[2]=W[2],r.LTWH[3]=W[2]}if(r.opacity<=0||r.LTWH[2]<=5||r.LTWH[3]<=5||Math.floor(r.LTWH[0]+r.LTWH[2])>this.gl.canvas.width||Math.floor(r.LTWH[1]+r.LTWH[3])>this.gl.canvas.height)return;r.backColor=[.15,.15,.15,r.opacity],r.lineColor=[1,1,1,1],this.opts.backColor[0]+this.opts.backColor[1]+this.opts.backColor[2]>1.5&&(r.backColor=[.95,.95,.95,r.opacity],r.lineColor=[0,0,0,1]);const n=.2,i=.3;r.lineColor[3]=n,r.textColor=r.lineColor.slice(),r.textColor[3]=1,r.lineThickness=3,r.gridLineThickness=1,r.lineAlpha=1,r.lines=[];const a=[];if(r.vols.length<1)this.volumes[0]!=null&&a.push(0);else for(let q=0;q<r.vols.length;q++){const H=r.vols[q];this.volumes[H]==null||this.volumes[H].nFrame4D<2||a.push(H)}if(a.length<1)return;const s=this.volumes[a[0]].nFrame4D;if(this.graph.selectedColumn=this.volumes[a[0]].frame4D,s<2){Z.debug("Unable to generate a graph: Selected volume is 3D not 4D");return}for(let q=0;q<a.length;q++){r.lines[q]=[];const H=this.frac2vox(this.scene.crosshairPos),W=this.volumes[a[q]];let G=W.nFrame4D;G=Math.min(G,s);for(let K=0;K<G;K++){const $=W.getValue(H[0],H[1],H[2],K);r.lines[q].push($)}}r.lineRGB=[[.8,0,0],[0,.7,0],[0,0,.9],[.7,.7,0],[.8,0,.8],[0,.7,.7],[.6,.6,.6],[0,0,0]];let o=r.lines[0][0],l=r.lines[0][0];for(let q=0;q<r.lines.length;q++)for(let H=0;H<r.lines[q].length;H++){const W=r.lines[q][H];o=Math.min(W,o),l=Math.max(W,l)}const c=this.volumes[a[0]].cal_min,u=this.volumes[a[0]].cal_max;if(r.isRangeCalMinMax&&c<u&&isFinite(c)&&isFinite(u)&&(o=c,l=u),r.normalizeValues&&l>o){const q=l-o;for(let H=0;H<r.lines.length;H++)for(let W=0;W<r.lines[H].length;W++){const G=r.lines[H][W];r.lines[H][W]=(G-o)/q}o=0,l=1}o>=l&&(l=o+1),this.drawRect(r.LTWH,r.backColor);const[h,g,v]=KC(o,l),m=Math.max(0,-1*Math.floor(Math.log(h)/Math.log(10)));o=Math.min(g,o),l=Math.max(v,l);function y(q){return q.toFixed(6).replace(/\.?0*$/,"")}let b=this.fontPx*.7;const x=this.gl.canvas.width/this.uiData.dpr,A=this.gl.canvas.height/this.uiData.dpr,C=x*A,E=800*600;C<E?b=0:b=Math.max(b,this.opts.fontMinPx);const S=b/this.fontPx;let M=0,R=g;if(b>0)for(;R<=l;){const q=R.toFixed(m),H=this.textWidth(b,q);M=Math.max(H,M),R+=h}const T=.05,B=Math.abs(r.LTWH[2]),F=Math.abs(r.LTWH[3]),I=[r.LTWH[0]+T*B+M,r.LTWH[1]+T*F,r.LTWH[2]-M-2*T*B,r.LTWH[3]-b-2.5*T*F];this.graph.LTWH=r.LTWH,this.graph.plotLTWH=I,this.drawRect(I,this.opts.backColor);const U=l-o,k=I[3]/U,O=I[2]/(r.lines[0].length-1),V=I[1]+I[3];R=g+.5*h;const L=r.lineColor.slice();for(L[3]=.5*r.lineColor[3];R<=l;){const q=V-(R-o)*k;this.drawLine([I[0],q,I[0]+I[2],q],r.gridLineThickness,L),R+=h}R=g;const P=.5*r.gridLineThickness;for(;R<=l;){const q=V-(R-o)*k;this.drawLine([I[0]-P,q,I[0]+I[2]+r.gridLineThickness,q],r.gridLineThickness,r.lineColor);const H=R.toFixed(m);b>0&&this.drawTextLeft([I[0]-6,q],H,S,r.textColor),R+=h}let _=1;for(;r.lines[0].length/_>20;)_*=5;for(let q=0;q<r.lines[0].length;q+=_){const H=q*O+I[0];let W=r.gridLineThickness;if(q%2===1)W*=.5,this.drawLine([H,I[1],H,I[1]+I[3]],W,L);else{const G=y(q);b>0&&this.drawTextBelow([H,2+I[1]+I[3]],G,S,r.textColor),this.drawLine([H,I[1],H,I[1]+I[3]],W,r.lineColor)}}for(let q=0;q<r.lines.length;q++){let H=[1,0,0,r.lineAlpha];q<r.lineRGB.length&&(H=[r.lineRGB[q][0],r.lineRGB[q][1],r.lineRGB[q][2],r.lineAlpha]);for(let W=1;W<r.lines[q].length;W++){const G=(W-1)*O,K=W*O,$=(r.lines[q][W-1]-o)*k,te=(r.lines[q][W]-o)*k,ae=[I[0]+G,I[1]+I[3]-$,I[0]+K,I[1]+I[3]-te];this.drawLine(ae,r.lineThickness,H)}}if(r.selectedColumn>=0&&r.selectedColumn<r.lines[0].length){const q=r.selectedColumn*O+I[0];this.drawLine([q,I[1],q,I[1]+I[3]],r.lineThickness,[r.lineRGB[0][0],r.lineRGB[0][1],r.lineRGB[0][2],i])}b>0&&r.LTWH[1]+r.LTWH[3]>I[1]+I[3]+b*2.4&&this.drawTextBelow([I[0]+.5*I[2],I[1]+I[3]+b*1.2],"Volume",S,r.textColor),this.detectPartialllyLoaded4D()&&this.drawTextBelow([I[0]+I[2],I[1]+I[3]+b*.5],"...",S,r.textColor)}depthPicker(r,e){if(!this.uiData.mouseDepthPicker)return;this.uiData.mouseDepthPicker=!1;const n=this.gl,i=this.mousePos[0]*r[2]/r[2],a=n.canvas.height-this.mousePos[1]*r[3]/r[3]-1,s=new Uint8Array(4);if(n.readPixels(i,a,1,1,n.RGBA,n.UNSIGNED_BYTE,s),this.selectedObjectId=s[3],this.selectedObjectId===this.VOLUME_ID){this.scene.crosshairPos=new Float32Array(s.slice(0,3)).map(g=>g/255);return}const o=Tj(s);if(o>1)return;const l=(this.mousePos[0]-r[0])/r[2],c=(n.canvas.height-this.mousePos[1]-r[1])/r[3],u=Mj(l,c,o,e),h=this.mm2frac(u,0,!0);h[0]<0||h[0]>1||h[1]<0||h[1]>1||h[2]<0||h[2]>1||(this.scene.crosshairPos=this.mm2frac(u,0,!0))}drawImage3D(r,e,n){if(this.volumes.length===0)return;const i=this.gl,a=this.calculateRayDirection(e,n),s=this.volumeObject3D;if(s){i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.CULL_FACE),i.cullFace(i.FRONT);let o=this.renderShader;if(this.uiData.mouseDepthPicker&&(o=this.pickingImageShader),o.use(this.gl),i.uniform1i(o.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),this.gradientTextureAmount>0&&o.uniforms.normMtx&&this.gradientTexture){i.activeTexture(Ap),i.bindTexture(i.TEXTURE_3D,this.gradientTexture);const l=this.calculateModelMatrix(e,n),c=bt();kn(c,l);const u=bt();Zn(u,c),i.uniformMatrix4fv(o.uniforms.normMtx,!1,u)}this.drawBitmap&&this.drawBitmap.length>8?i.uniform2f(o.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,this.drawOpacity):i.uniform2f(o.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,0),this.gl.uniform4fv(o.uniforms.paqdUniforms,this.opts.paqdUniforms),i.uniformMatrix4fv(o.uniforms.mvpMtx,!1,r),i.uniformMatrix4fv(o.uniforms.matRAS,!1,this.back.matRAS),i.uniform3fv(o.uniforms.rayDir,a),this.gradientTextureAmount<0?i.uniform4fv(o.uniforms.clipPlane,[this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2],30]):i.uniform4fv(o.uniforms.clipPlane,this.scene.clipPlane),i.uniform1f(o.uniforms.drawOpacity,1),i.bindVertexArray(s.vao),i.drawElements(s.mode,s.indexCount,i.UNSIGNED_SHORT,0),i.bindVertexArray(this.unusedVAO)}}drawOrientationCube(r,e=0,n=0){if(!this.opts.isOrientCube)return;const i=.05*Math.min(r[2],r[3]);if(i<5)return;const a=this.gl;a.enable(a.CULL_FACE),a.cullFace(a.BACK),this.orientCubeShader.use(this.gl),a.bindVertexArray(this.orientCubeShaderVAO);const s=bt(),o=bt();hd(o,0,a.canvas.width,0,a.canvas.height,-10*i,10*i);let l=0;r[1]===0&&(l=a.canvas.height-this.effectiveCanvasHeight()),Rl(s,s,[1.8*i+r[0],l+1.8*i+r[1],0]),hC(s,s,[i,i,i]),cd(s,s,ds(270-n)),fd(s,s,ds(-e));const c=bt();ys(c,o,s),a.uniformMatrix4fv(this.orientCubeShader.uniforms.u_matrix,!1,c),a.drawArrays(a.TRIANGLE_STRIP,0,168),a.bindVertexArray(this.unusedVAO),this.gl.disable(this.gl.CULL_FACE)}createOnLocationChange(r=NaN){const[e,n,i]=this.sceneExtentsMinMax(!0),a=Math.max(Math.max(i[0],i[1]),i[2]);function s(g){return Math.max(0,-Math.ceil(Math.log10(Math.abs(g))))}let o=s(a*.001);const l=this.frac2mm(this.scene.crosshairPos,0,!0);function c(g,v=0){return parseFloat(g.toFixed(v))}let u=c(l[0],o)+"×"+c(l[1],o)+"×"+c(l[2],o);if(this.volumes.length>0&&this.volumes[0].nFrame4D>0&&(u+="×"+c(this.volumes[0].frame4D)),this.volumes.length>0){let g=" = ";for(let y=0;y<this.volumes.length;y++){const b=this.volumes[y].mm2vox(l);let x=this.volumes[y].getValue(b[0],b[1],b[2],this.volumes[y].frame4D);if(o=3,this.volumes[y].colormapLabel!==null){const A=Math.round(x);if(this.volumes[y].hdr.intent_code===1002&&this.volumes[y].hdr.datatypeCode===2304){const C=this.volumes[y].getValues(b[0],b[1],b[2],this.volumes[y].frame4D);if(C[2]>2){const E=Math.round(100*C[2]/255);if(g+=this.volumes[y].colormapLabel.labels[C[0]]+` (${E}%)`,C[3]>2){const S=Math.round(100*C[3]/255);g+=" "+this.volumes[y].colormapLabel.labels[C[1]]+` (${S}%)`}}}else A>=0&&this.volumes[y].colormapLabel.labels&&A<this.volumes[y].colormapLabel.labels.length?g+=this.volumes[y].colormapLabel.labels[A]:g+="undefined("+c(x,o)+")"}else g+=c(x,o);this.volumes[y].imaginary&&(x=this.volumes[y].getValue(b[0],b[1],b[2],this.volumes[y].frame4D,!0),x>=0&&(g+="+"),g+=c(x,o)),g+="   "}u+=g;const v=this.back.dimsRAS,m=v[1]*v[2]*v[3];if(this.drawBitmap&&this.drawBitmap.length===m){const y=this.frac2vox(this.scene.crosshairPos),b=y[0]+y[1]*v[1]+y[2]*v[1]*v[2];u+=" "+this.drawLut.labels[this.drawBitmap[b]]}}const h={mm:this.frac2mm(this.scene.crosshairPos,0,!0),axCorSag:r,vox:this.frac2vox(this.scene.crosshairPos),frac:this.scene.crosshairPos,xy:[this.mousePos[0],this.mousePos[1]],values:this.volumes.map(g=>{const v=this.frac2mm(this.scene.crosshairPos,0,!0),m=g.mm2vox(v),y=g.getValue(m[0],m[1],m[2],g.frame4D);return{name:g.name,value:y,id:g.id,mm:v,vox:m}}),string:u};this.onLocationChange(h)}addLabel(r,e,n,i,a){const s={textColor:this.opts.legendTextColor,textScale:1,textAlignment:"left",lineWidth:0,lineColor:this.opts.legendTextColor,lineTerminator:"none",bulletScale:0,bulletColor:this.opts.legendTextColor},o=e?{...s,...e}:{...s},l=new Dy(r,{...o},n,i,a);return this.document.labels.push(l),l}calculateScreenPoint(r,e,n){const i=Qi();return Kr(i,[...r,1],e),i[3]!==0&&(i[0]=(i[0]/i[3]+1)*.5*n[2],i[1]=(1-i[1]/i[3])*.5*n[3],i[2]/=i[3],i[0]+=n[0],i[1]+=n[1]),i}getLabelAtPoint(r){const e=this.legendFontScaling,n=this.fontPx*e,i=this.fontPx*e;for(const u of this.document.labels){if(u.anchor==null||u.anchor===0)continue;const h=this.fontPx*u.style.textScale*e,g=this.textHeight(h,u.text),v=this.textWidth(h,u.text);if(!(u.anchor&1&&r[0]>v)&&!(u.anchor&2&&(r[0]<(this.gl.canvas.width-v)/2||r[0]>(this.gl.canvas.width+v)/2))&&!(u.anchor&4&&r[0]<this.gl.canvas.width-v)&&!(u.anchor&8&&(r[1]<i/2||r[1]>g+i/2))&&!(u.anchor&16&&(r[1]<(this.gl.canvas.height-g-i)/2||r[1]>(this.gl.canvas.height+g-i/2)/2))&&!(u.anchor&32&&(r[1]<this.gl.canvas.height-g-i||r[1]>this.gl.canvas.height-i/2)))return u}Z.debug("screenPoint",r);const a=this.getLegendPanelHeight(e),s=this.getLegendPanelWidth(),o=this.gl.canvas.width-s;let l=(this.canvas.height-a)/2;if(Z.debug("panelrect",o,l,o+s,l+a),r[0]<o||r[1]<l||r[0]>o+s||r[1]>l+a)return null;const c=this.getConnectomeLabels();for(const u of c){const h=this.fontPx*u.style.textScale*e,g=this.textHeight(h,u.text);if(r[1]>=l&&r[1]<=l+g+n/2)return Z.debug(`label clicked ${u.text}`),u;l+=g,l+=n/2}return null}drawLabelLine(r,e,n,i,a=!1){const s=Array.isArray(r.points)&&Array.isArray(r.points[0])?r.points:[r.points];for(const o of s){const l=this.calculateScreenPoint(o,n,i);a?this.drawDottedLine([...e,l[0],l[1]],r.style.lineWidth,r.style.lineColor):this.draw3DLine(e,[l[0],l[1],l[2]],r.style.lineWidth,r.style.lineColor)}}draw3DLabel(r,e,n,i,a,s,o,l=1){const c=r.text,u=e[0],h=e[1],g=this.fontPx*l,v=this.textHeight(r.style.textScale,c)*g;if(r.style.lineWidth>0&&Array.isArray(r.points)&&this.drawLabelLine(r,[u,h+v],n,i,o),r.style.bulletScale){const b=r.style.bulletScale*v,x=v-b,A=h+x/2+b/2,C=u+(a-b)/2;this.drawCircle([C,A,b,b],r.style.bulletColor)}let m=u;if(s)if(r.style.textAlignment!=="left"){const b=this.textWidth(r.style.textScale,r.text)*g;if(r.style.textAlignment==="right")m=u+s-g*1.5-b;else{const x=s-(a||g);m+=(x-b)/2}}else m+=a;const y=r.style.textScale;this.drawText([m,h],c,y,r.style.textColor)}draw3DLabels(r,e,n=!1){const i=this.getConnectomeLabels();if(!this.opts.showLegend||i.length===0)return;let a=this.getLegendPanelHeight(1);if(!this.canvas||a<1)return;const s=this.gl;if(s.disable(s.CULL_FACE),s.viewport(0,0,this.canvas.width,this.canvas.height),this.legendFontScaling=1,a>this.canvas.height){const m=10*this.uiData.dpr;this.legendFontScaling=Math.max(this.canvas.height-m,1)/a,Z.debug(`Legend too large for screen, font reduction factor x${this.legendFontScaling}`),a=this.getLegendPanelHeight(this.legendFontScaling)}const o=this.fontPx*this.legendFontScaling,l=this.getBulletMarginWidth(),c=this.getLegendPanelWidth(),u=s.canvas.width-c;let h=(this.canvas.height-a)/2;this.drawRect([s.canvas.width-c,h,c-o,a],this.opts.legendBackgroundColor);const g=s.getParameter(s.BLEND),v=s.getParameter(s.DEPTH_FUNC);n||(s.disable(s.BLEND),s.depthFunc(s.GREATER));for(const m of i){this.draw3DLabel(m,[u,h],r,e,l,c,n,this.legendFontScaling);const y=this.fontPx*m.style.textScale,b=this.textHeight(y,m.text)*this.legendFontScaling;h+=b,h+=o/2}n||(s.depthFunc(v),g&&s.enable(s.BLEND))}drawAnchoredLabels(){const r=this.fontPx,e=this.document.labels.filter(n=>n.anchor!=null&&n.anchor!==0);for(const n of e){const i=n.text,a=this.textHeight(n.style.textScale,i)*r,s=this.textWidth(n.style.textScale,i)*r;let o,l;const u=this.fontPx*1,h=u;let g=u/4,v=0,m=0;n.anchor&1&&(o=0),n.anchor&4&&(o=this.canvas.width-s,v-=u/4),n.anchor&2&&(o=(this.canvas.width-s)/2,v-=u/4,g+=u/4),n.anchor&8&&(l=0),n.anchor&16&&(l=(this.canvas.height-a-u)/2,m-=u/4),n.anchor&32&&(l=this.canvas.height-a-u,m-=u/4),this.drawRect([o+v,l+m,s+g,a+h],n.style.backgroundColor),this.draw3DLabel(n,[o,l])}}draw3D(r=[0,0,0,0],e=null,n=null,i=null,a=null,s=0){const o=a!==null;this.setPivot3D(),o||(a=this.scene.renderAzimuth,s=this.scene.renderElevation);const l=this.gl;e===null&&([e,n,i]=this.calculateMvpMatrix(null,r,a,s));let c=[...r];if(r[2]===0||r[3]===0?(r=[0,0,l.canvas.width,l.canvas.height],c=[...r],this.screenSlices.push({leftTopWidthHeight:r,axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[XC(n),0]})):(this.screenSlices.push({leftTopWidthHeight:r.slice(),axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[XC(n),0]}),r[1]=l.canvas.height-r[3]-r[1]),l.enable(l.DEPTH_TEST),l.depthFunc(l.ALWAYS),l.depthMask(!0),l.clearDepth(0),this.draw3DLabels(e,c,!1),l.viewport(r[0],r[1],r[2],r[3]),this.volumes.length>0&&(this.updateInterpolation(0,!0),this.updateInterpolation(1,!0),this.drawImage3D(e,a,s)),this.updateInterpolation(0),this.updateInterpolation(1),o||this.drawCrosshairs3D(!0,1,e),this.drawMesh3D(!0,1,e,n,i),this.uiData.mouseDepthPicker){this.depthPicker(r,e),this.createOnLocationChange(),this.draw3D(r,e,n,i,a,s);return}this.opts.meshXRay>0&&this.drawMesh3D(!1,this.opts.meshXRay,e,n,i),this.draw3DLabels(e,c,!1),l.viewport(r[0],r[1],r[2],r[3]),o||this.drawCrosshairs3D(!1,.15,e),l.viewport(0,0,l.canvas.width,l.canvas.height),this.drawOrientationCube(r,a,s);const u="azimuth: "+this.scene.renderAzimuth.toFixed(0)+" elevation: "+this.scene.renderElevation.toFixed(0);return this.readyForSync=!0,this.sync(),this.draw3DLabels(e,c,!0),u}drawMesh3D(r=!0,e=1,n,i,a){if(this.meshes.length<1)return;const s=this.gl;n||([n,i,a]=this.calculateMvpMatrix(this.volumeObject3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),s.enable(s.DEPTH_TEST),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),s.disable(s.BLEND),s.depthFunc(s.GREATER),s.disable(s.CULL_FACE),r?s.depthFunc(s.GREATER):(s.enable(s.BLEND),s.depthFunc(s.ALWAYS),s.enable(s.CULL_FACE)),s.cullFace(s.BACK);let o=this.meshShaders[0].shader,l=!1;for(let c=0;c<this.meshes.length;c++){if(this.meshes[c].visible===!1||this.meshes[c].opacity<=0)continue;let u=e;if(r&&(u=this.meshes[c].opacity,s.depthFunc(s.GREATER),s.depthMask(!0),u<1?(s.depthMask(!1),s.enable(s.DEPTH_TEST),s.enable(s.BLEND),s.cullFace(s.BACK),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA)):(s.enable(s.DEPTH_TEST),s.disable(s.BLEND))),o=this.meshShaders[this.meshes[c].meshShaderIndex].shader,this.uiData.mouseDepthPicker&&(o=this.pickingMeshShader),o.use(this.gl),s.uniformMatrix4fv(o.uniforms.mvpMtx,!1,n),s.uniformMatrix4fv(o.uniforms.normMtx,!1,a),s.uniform1f(o.uniforms.opacity,u),!(this.meshes[c].indexCount<3)){if(this.meshes[c].offsetPt0&&(this.meshes[c].fiberSides<3||this.meshes[c].fiberRadius<=0)){l=!0;continue}o.isMatcap&&(s.activeTexture(ZC),s.bindTexture(s.TEXTURE_2D,this.matCapTexture)),s.bindVertexArray(this.meshes[c].vao),s.drawElements(s.TRIANGLES,this.meshes[c].indexCount,s.UNSIGNED_INT,0),s.bindVertexArray(this.unusedVAO)}}if(s.depthMask(!0),!l){s.enable(s.BLEND),s.depthFunc(s.ALWAYS);return}o=this.fiberShader,o.use(this.gl),s.uniformMatrix4fv(o.uniforms.mvpMtx,!1,n),s.uniform1f(o.uniforms.opacity,e);for(let c=0;c<this.meshes.length;c++)this.meshes[c].indexCount<3||this.meshes[c].offsetPt0&&(this.meshes[c].fiberSides>=3&&this.meshes[c].fiberRadius>0||(s.bindVertexArray(this.meshes[c].vaoFiber),s.drawElements(s.LINE_STRIP,this.meshes[c].indexCount,s.UNSIGNED_INT,0),s.bindVertexArray(this.unusedVAO)));s.enable(s.BLEND),s.depthFunc(s.ALWAYS),this.readyForSync=!0}drawCrosshairs3D(r=!0,e=1,n=null,i=!1,a=!0){if(!this.opts.show3Dcrosshair&&!i||this.opts.crosshairWidth<=0&&i)return;const s=this.gl,o=this.frac2mm(this.scene.crosshairPos,0,a);let l=1;const[c,u,h]=this.sceneExtentsMinMax(a);if(this.volumes.length>0){if(!this.back)throw new Error("back undefined");l=.5*Math.min(Math.min(this.back.pixDims[1],this.back.pixDims[2]),this.back.pixDims[3])}else(h[0]<50||h[0]>1e3)&&(l=h[0]*.02);if(l*=this.opts.crosshairWidth,this.opts?.crosshairWidthUnit==="percent"&&(l=h[0]*this.opts.crosshairWidth*.5*.01),this.opts?.crosshairWidthUnit==="mm"&&(l=this.opts.crosshairWidth*.5),(this.crosshairs3D===null||this.crosshairs3D.mm[0]!==o[0]||this.crosshairs3D.mm[1]!==o[1]||this.crosshairs3D.mm[2]!==o[2])&&(this.crosshairs3D!==null&&(s.deleteBuffer(this.crosshairs3D.indexBuffer),s.deleteBuffer(this.crosshairs3D.vertexBuffer)),this.crosshairs3D=Ro.generateCrosshairs(this.gl,1,o,c,u,l,20,this.opts.crosshairGap),this.crosshairs3D.mm=o),!this.surfaceShader)throw new Error("surfaceShader undefined");const g=this.surfaceShader;g.use(this.gl),n==null&&([n]=this.calculateMvpMatrix(this.crosshairs3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),s.uniformMatrix4fv(g.uniforms.mvpMtx,!1,n),s.disable(s.CULL_FACE),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.crosshairs3D.indexBuffer),s.enable(s.DEPTH_TEST);const v=[...this.opts.crosshairColor];r?(s.disable(s.BLEND),s.depthFunc(s.GREATER)):(s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),s.depthFunc(s.ALWAYS)),v[3]=e,s.uniform4fv(g.uniforms.surfaceColor,v),s.bindVertexArray(this.crosshairs3D.vao),s.drawElements(s.TRIANGLES,this.crosshairs3D.indexCount,s.UNSIGNED_INT,0),s.bindVertexArray(this.unusedVAO)}mm2frac(r,e=0,n=!1){if(this.volumes.length<1){const i=Me(.1,.5,.5),[a,s,o]=this.sceneExtentsMinMax();return i[0]=(r[0]-a[0])/o[0],i[1]=(r[1]-a[1])/o[1],i[2]=(r[2]-a[2])/o[2],isFinite(i)||(isFinite(i[0])||(i[0]=.5),isFinite(i[1])||(i[1]=.5),isFinite(i[2])||(i[2]=.5),this.meshes.length<1&&Z.error("mm2frac() not finite: objects not (yet) loaded.")),i}return this.volumes[e].convertMM2Frac(r,n||this.opts.isSliceMM)}vox2frac(r,e=0){return this.volumes[e].convertVox2Frac(r)}frac2vox(r,e=0){return this.volumes.length<=e?[0,0,0]:this.volumes[e].convertFrac2Vox(r)}moveCrosshairInVox(r,e,n){const i=this.frac2vox(this.scene.crosshairPos),a=i[2];i[0]+=r,i[1]+=e,i[2]+=n,i[0]=vp(i[0],0,this.volumes[0].dimsRAS[1]-1),i[1]=vp(i[1],0,this.volumes[0].dimsRAS[2]-1),i[2]=vp(i[2],0,this.volumes[0].dimsRAS[3]-1),this.scene.crosshairPos=this.vox2frac(i),this.createOnLocationChange(),this.opts.is2DSliceShader&&a!==i[2]&&(this.updateGLVolume(),this.refreshDrawing(!1)),this.drawScene()}frac2mm(r,e=0,n=!1){const i=Jt(r[0],r[1],r[2],1);if(this.volumes.length>0)return this.volumes[e].convertFrac2MM(r,n||this.opts.isSliceMM);{const[a,s]=this.sceneExtentsMinMax(),o=(l,c,u)=>l*(1-u)+c*u;i[0]=o(a[0],s[0],r[0]),i[1]=o(a[1],s[1],r[1]),i[2]=o(a[2],s[2],r[2])}return i}screenXY2TextureFrac(r,e,n,i=!0){const a=Me(-1,-1,-1),s=this.screenSlices[n].axCorSag;if(s>2)return a;const o=this.screenSlices[n].leftTopWidthHeight.slice();let l=!1;o[2]<0&&(l=!0,o[0]+=o[2],o[2]=-o[2]);let c=(r-o[0])/o[2];l&&(c=1-c);const u=1-(e-o[1])/o[3];if(c<0||c>1||u<0||u>1||this.screenSlices[n].AxyzMxy.length<4)return a;let h=Me(0,0,0);h[0]=this.screenSlices[n].leftTopMM[0]+c*this.screenSlices[n].fovMM[0],h[1]=this.screenSlices[n].leftTopMM[1]+u*this.screenSlices[n].fovMM[1];const g=this.screenSlices[n].AxyzMxy;h[2]=g[2]+g[4]*(h[1]-g[1])-g[3]*(h[0]-g[0]),s===1&&(h=yr(h,[0,2,1])),s===2&&(h=yr(h,[2,0,1]));const v=this.mm2frac(h);return i&&(v[0]<0||v[0]>1||v[1]<0||v[1]>1||v[2]<0||v[2]>1)?a:v}canvasPos2frac(r){for(let e=0;e<this.screenSlices.length;e++){const n=this.screenXY2TextureFrac(r[0],r[1],e);if(n[0]>=0)return n}return[-1,-1,-1]}frac2canvasPosWithTile(r,e){const n=this.frac2mm(r);let i={distance:1/0};for(let a=0;a<this.screenSlices.length;a++){const s=this.screenSlices[a].axCorSag;if(s>2||this.screenSlices[a].AxyzMxy.length<4||e!==void 0&&s!==e)continue;let o=Me(n[0],n[1],n[2]);s===1&&(o=yr(o,[0,2,1])),s===2&&(o=yr(o,[1,2,0]));const l=this.screenSlices[a].AxyzMxy,c=l[2]+l[4]*(o[1]-l[1])-l[3]*(o[0]-l[0]),u=Math.abs(o[2]-c),h=this.opts.sliceType===3?1:.1;if(u<i.distance&&(i={index:a,distance:u}),u<=h){const g=(o[0]-this.screenSlices[a].leftTopMM[0])/this.screenSlices[a].fovMM[0],v=(o[1]-this.screenSlices[a].leftTopMM[1])/this.screenSlices[a].fovMM[1];if(g>=0&&g<=1&&v>=0&&v<=1){const m=this.screenSlices[a].leftTopWidthHeight.slice();let y=!1;m[2]<0&&(y=!0,m[0]+=m[2],m[2]=-m[2]);let b=g;y&&(b=1-g);const x=1-v,A=m[0]+b*m[2],C=m[1]+x*m[3];return{pos:[A,C],tileIndex:a}}}}return null}frac2canvasPos(r){const e=this.frac2mm(r);let n={index:-1,distance:1/0};for(let i=0;i<this.screenSlices.length;i++){const a=this.screenSlices[i].axCorSag;if(a>2||this.screenSlices[i].AxyzMxy.length<4)continue;let s=Me(e[0],e[1],e[2]);a===1&&(s=yr(s,[0,2,1])),a===2&&(s=yr(s,[1,2,0]));const o=this.screenSlices[i].AxyzMxy,l=o[2]+o[4]*(s[1]-o[1])-o[3]*(s[0]-o[0]),c=Math.abs(s[2]-l),u=this.opts.sliceType===3?1:.1;if(c<n.distance&&(n={index:i,distance:c}),c<=u){const h=(s[0]-this.screenSlices[i].leftTopMM[0])/this.screenSlices[i].fovMM[0],g=(s[1]-this.screenSlices[i].leftTopMM[1])/this.screenSlices[i].fovMM[1];if(h>=0&&h<=1&&g>=0&&g<=1){const v=this.screenSlices[i].leftTopWidthHeight.slice();let m=!1;v[2]<0&&(m=!0,v[0]+=v[2],v[2]=-v[2]);let y=h;m&&(y=1-h);const b=1-g,x=v[0]+y*v[2],A=v[1]+b*v[3];return[x,A]}}}if(n.index>=0&&n.distance<2){const i=n.index,a=this.screenSlices[i].axCorSag;let s=Me(e[0],e[1],e[2]);a===1&&(s=yr(s,[0,2,1])),a===2&&(s=yr(s,[1,2,0]));const o=this.screenSlices[i].AxyzMxy;s[2]=o[2]+o[4]*(s[1]-o[1])-o[3]*(s[0]-o[0]);const l=(s[0]-this.screenSlices[i].leftTopMM[0])/this.screenSlices[i].fovMM[0],c=(s[1]-this.screenSlices[i].leftTopMM[1])/this.screenSlices[i].fovMM[1];if(l>=-.1&&l<=1.1&&c>=-.1&&c<=1.1){const u=Math.max(0,Math.min(1,l)),h=Math.max(0,Math.min(1,c)),g=this.screenSlices[i].leftTopWidthHeight.slice();let v=!1;g[2]<0&&(v=!0,g[0]+=g[2],g[2]=-g[2]);let m=u;v&&(m=1-u);const y=1-h,b=g[0]+m*g[2],x=g[1]+y*g[3];return[b,x]}}return null}scaleSlice(r,e,n=[0,0],i=[0,0]){const a=i[0]===0?this.effectiveCanvasWidth()-n[0]:i[0]-n[0],s=i[1]===0?this.effectiveCanvasHeight()-n[1]:i[1]-n[1];let o=a/r;e*o>s&&(o=s/e);const l=r*o,c=e*o;return[(a-l)*.5,(s-c)*.5,l,c,o]}drawThumbnail(){if(!this.bmpShader)throw new Error("bmpShader undefined");this.bmpShader.use(this.gl),this.gl.uniform2f(this.bmpShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height);let r=this.gl.canvas.height,e=this.gl.canvas.height*this.bmpTextureWH;e>this.gl.canvas.width&&(r=this.gl.canvas.width/this.bmpTextureWH,e=this.gl.canvas.width);const n=(this.gl.canvas.width-e)/2,i=(this.gl.canvas.height-r)/2;this.gl.uniform4f(this.bmpShader.uniforms.leftTopWidthHeight,n,i,e,r),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawLine(r,e=1,n=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),n[3]<0&&(n=this.opts.crosshairColor),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,n),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,e),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,r),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}draw3DLine(r,e,n=1,i=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.line3DShader)throw new Error("line3DShader undefined");this.line3DShader.use(this.gl),i[3]<0&&(i=this.opts.crosshairColor),this.gl.uniform4fv(this.line3DShader.uniforms.lineColor,i),this.gl.uniform2fv(this.line3DShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.line3DShader.uniforms.thickness,n),this.gl.uniform2fv(this.line3DShader.uniforms.startXY,r),this.gl.uniform3fv(this.line3DShader.uniforms.endXYZ,e),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawDottedLine(r,e=1,n=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl);const i=n[3]<0?[...this.opts.crosshairColor]:[...n];i[3]=.3;const a=mC(r[2]-r[0],r[3]-r[1]),s=pC(a);lz(a,a);const l=this.fontPx*1;oz(a,a,l/2);const c=pC(a);let u=Math.floor(s/c);s%c&&u++;const h=[r[0],r[1]];this.gl.uniform4fv(this.lineShader.uniforms.lineColor,i),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,e);for(let g=0;g<u-1;g++){if(g%2){h[0]+=a[0],h[1]+=a[1];continue}const v=[h[0],h[1],h[0]+a[0],h[1]+a[1]];this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,v),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),h[0]+=a[0],h[1]+=a[1]}this.gl.bindVertexArray(this.unusedVAO)}drawGraphLine(r,e=[1,0,0,.5],n=2){this.drawLine(r,n,e)}drawCrossLinesMM(r,e,n,i,a){if(r<0||this.screenSlices.length<=r)return;const s=this.screenSlices[r];let o=s.sliceFrac;o===1/0&&Z.debug("Rendering approximate cross lines in world view mode"),o===1/0&&(o=.5);let c=i.slice(),u=a.slice();const h=Math.max(1,this.opts.crosshairWidth);e===1&&(c=n.slice()),e===2&&(c=n.slice(),u=i.slice());function g(v){const m=mC(0,0);return m[0]=s.leftTopWidthHeight[0]+(v[0]-s.leftTopMM[0])/s.fovMM[0]*s.leftTopWidthHeight[2],m[1]=s.leftTopWidthHeight[1]+s.leftTopWidthHeight[3]-(v[1]-s.leftTopMM[1])/s.fovMM[1]*s.leftTopWidthHeight[3],m}if(c.length>0&&e===0){const v=o,m=1;for(let y=0;y<c.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=c[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([0,x,v]);A=yr(A,[0,1,2]);let C=this.frac2mm([1,x,v]);C=yr(C,[0,1,2]),A=g(A),C=g(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(c.length>0&&e===1){const v=o,m=2;for(let y=0;y<c.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=c[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([0,v,x]);A=yr(A,[0,2,1]);let C=this.frac2mm([1,v,x]);C=yr(C,[0,2,1]),A=g(A),C=g(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(c.length>0&&e===2){const v=o,m=2;for(let y=0;y<c.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=c[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([v,0,x]);A=yr(A,[1,2,0]);let C=this.frac2mm([v,1,x]);C=yr(C,[1,2,0]),A=g(A),C=g(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(u.length>0&&e===0){const v=o,m=0;for(let y=0;y<u.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=u[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([x,0,v]);A=yr(A,[0,1,2]);let C=this.frac2mm([x,1,v]);C=yr(C,[0,1,2]),A=g(A),C=g(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(u.length>0&&e===1){const v=o,m=0;for(let y=0;y<u.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=u[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([x,v,0]);A=yr(A,[0,2,1]);let C=this.frac2mm([x,v,1]);C=yr(C,[0,2,1]),A=g(A),C=g(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(u.length>0&&e===2){const v=o,m=1;for(let y=0;y<u.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=u[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([v,x,0]);A=yr(A,[1,2,0]);let C=this.frac2mm([v,x,1]);C=yr(C,[1,2,0]),A=g(A),C=g(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}}drawCrossLines(r,e,n,i,a){if(r<0||this.screenSlices.length<=r)return;if(this.opts.isSliceMM)return this.drawCrossLinesMM(r,e,n,i,a);if(this.screenSlices[r].sliceFrac===1/0)return this.drawCrossLinesMM(r,e,n,i,a);const s=this.screenSlices[r];let o=i.slice(),l=a.slice();if(e===1&&(o=n.slice()),e===2&&(o=n.slice(),l=i.slice()),o.length>0){const c=s.leftTopWidthHeight.slice();let u=2;e===0&&(u=1);const h=this.frac2mm([.5,.5,.5]);for(let g=0;g<o.length;g++){h[u]=o[g];const v=this.mm2frac(h);this.drawRect([c[0],c[1]+c[3]-v[u]*c[3],c[2],1])}}if(l.length>0){const c=s.leftTopWidthHeight.slice(),u=s.fovMM[0]<0;let h=0;e===2&&(h=1);const g=this.frac2mm([.5,.5,.5]);for(let v=0;v<l.length;v++){g[h]=l[v];const m=this.mm2frac(g);u?this.drawRect([c[0]+(c[2]-m[h]*c[2]),c[1],1,c[3]]):this.drawRect([c[0]+m[h]*c[2],c[1],1,c[3]])}}}drawMosaic(r){this.screenSlices=[];const e=this.screenFieldOfViewMM(0,!0),n=this.screenFieldOfViewMM(0);r=r.replaceAll(";"," ;").trim();const i=[],a=[],s=[],o=r.split(/\s+/);let l=1;const c=this.fontPx;let u=0,h=0,g=0;this.volumes[0]?.dims||(g=Math.ceil(this.opts.tileMargin*.3));for(let v=0;v<2;v++){let m=!1,y=!1;m=!1;let b=0,x=0,A=0,C=0,E=!1,S=0,M=0,R=0,T=0;for(let I=0;I<o.length;I++){const U=o[I];if(U.includes("X")){y=!0;continue}if(U.includes("L")){E=!U.includes("-");continue}if(U.includes("H")){I++,M=Math.max(0,Math.min(1,parseFloat(o[I]))),M=Math.abs(M);continue}if(U.includes("V")){I++;continue}if(U.includes("A")){S=0;continue}if(U.includes("C")){S=1;continue}if(U.includes("S")){S=2;continue}if(U.includes("R")){m=!0;continue}if(U.includes(";")){A+=b,C=Math.max(C,x+R),b=0,x=0,R=0;continue}T=R,M>0&&!m&&(T=Math.round(T*(1-M))),Z.debug(`item ${I} width with overlap ${T} pixels`),x+=T,T=0;const k=parseFloat(U);if(isNaN(k))continue;let O=0,V=n;if(m&&(V=e),S===2?T=V[1]:T=V[0],S===0?O=V[1]:O=V[2],v===0)m||(S===0&&i.push(k),S===1&&a.push(k),S===2&&s.push(k));else{const L=[u+l*x,h+l*A,l*T,l*O];if(this.fontPx=E?c:0,m){let P=k<0?-1/0:1/0;Object.is(k,-0)&&(P=-1/0),this.draw2D(L,S,P)}else this.draw2D(L,S,k);y&&this.drawCrossLines(this.screenSlices.length-1,S,i,a,s),m=!1,y=!1}R=T,x+=g,b=Math.max(b,O)}if(A+=b,C=Math.max(C,x+R),C<=0||A<=0)break;const B=(this.gl.canvas.width-2*this.opts.tileMargin-g)/C,F=(this.effectiveCanvasHeight()-2*this.opts.tileMargin)/A;l=Math.min(B,F),this.opts.centerMosaic?(u=Math.floor(.5*(this.gl.canvas.width-C*l)),h=Math.floor(.5*(this.effectiveCanvasHeight()-A*l))):(u=this.opts.tileMargin,h=this.opts.tileMargin)}this.fontPx=c}calculateWidthHeight(r,e,n,i){let a,s;switch(r){case 0:a=e[0],s=e[1];break;case 1:a=e[0],s=e[2];break;case 2:a=e[1],s=e[2];break;default:return[n,i]}const o=a/s,l=n/i;let c,u;return o>l?(c=n,u=n/o):(u=i,c=i*o),[c,u]}drawSceneCore(){if(!this.initialized)return;if(this.colorbarHeight=0,this.gl.clearColor(this.opts.backColor[0],this.opts.backColor[1],this.opts.backColor[2],this.opts.backColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.bmpTexture&&this.thumbnailVisible){this.drawThumbnail();return}let r="";if(this.volumes.length===0||typeof this.volumes[0].dims>"u"){if(this.meshes.length>0){if(this.sliceMosaicString.length>0){this.opts.isColorbar&&this.reserveColorbarPanel(),this.drawMosaic(this.sliceMosaicString),this.opts.isColorbar&&this.drawColorbar();return}this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.drawLoadingText(this.opts.loadingText);return}if(this.uiData.isDragging&&this.scene.clipPlaneDepthAziElev[0]<1.8&&this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0){const a=this.uiData.dragStart[0]-this.uiData.dragEnd[0],s=this.uiData.dragStart[1]-this.uiData.dragEnd[1],o=this.uiData.dragClipPlaneStartDepthAziElev.slice();if(o[1]-=a,o[1]=o[1]%360,o[2]+=s,o[1]!==this.scene.clipPlaneDepthAziElev[1]||o[2]!==this.scene.clipPlaneDepthAziElev[2])return this.scene.clipPlaneDepthAziElev=o,this.setClipPlane(this.scene.clipPlaneDepthAziElev)}if(this.sliceMosaicString.length<1&&this.opts.sliceType===4){this.opts.isColorbar&&this.reserveColorbarPanel(),this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.opts.isColorbar&&this.reserveColorbarPanel();const e=this.getMaxVols(),n=this.opts.sliceType===3&&e>1&&this.graph.autoSizeMultiplanar&&this.graph.opacity>0;if(this.sliceMosaicString.length>0)this.drawMosaic(this.sliceMosaicString);else{const a=[0,0];let s=!1;if(this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.screenSlices=[],this.customLayout&&this.customLayout.length>0){this.screenSlices=[],this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);const{volScale:o}=this.sliceScale(),l=[this.effectiveCanvasWidth(),this.effectiveCanvasHeight()];for(const c of this.customLayout){const{sliceType:u,position:h,sliceMM:g}=c,v=h.slice();if(h[0]>=0&&h[0]<=1&&h[2]<=1&&(v[0]=h[0]*l[0],v[2]=h[2]*l[0]),h[1]>=0&&h[1]<=1&&h[3]<=1&&(v[1]=h[1]*l[1],v[3]=h[3]*l[1]),v[0]+v[2]>l[0]&&(Z.warn("adjusting slice width because it would have been clipped"),v[2]=l[0]-v[0]),v[1]+v[3]>l[1]&&(Z.warn("adjusting slice height because it would have been clipped"),v[3]=l[1]-v[1]),u===4)this.draw3D(v);else if(u===0||u===1||u===2){const m=this.calculateWidthHeight(u,o,v[2],v[3]);this.draw2D(v,u,g??NaN,m)}}}else if(this.opts.sliceType===0)this.draw2D([0,0,0,0],0);else if(this.opts.sliceType===1)this.draw2D([0,0,0,0],1);else if(this.opts.sliceType===2)this.draw2D([0,0,0,0],2);else{let o=function(L,P){return[(L-1)*g+L*v,(P-1)*g+P*v]},l=!1;this.opts.multiplanarForceRender?(l=!0,this.opts.multiplanarForceRender?this.opts.multiplanarShowRender=1:this.opts.multiplanarShowRender=2,delete this.opts.multiplanarForceRender):this.opts.multiplanarShowRender===1&&(l=!0);const c=isFinite(this.drawPenLocation[0])&&this.opts.drawingEnabled,{volScale:u}=this.sliceScale(),h=u.slice();this.opts.multiplanarEqualSize&&(u[0]=1,u[1]=1,u[2]=1),typeof this.opts.multiplanarPadPixels!="number"&&Z.debug("multiplanarPadPixels must be numeric");const g=parseFloat(`${this.opts.multiplanarPadPixels}`)*this.uiData.dpr;let v=this.opts.tileMargin*this.uiData.dpr;v<0&&(v=2*(2+Math.ceil(this.fontPx)));let m=[this.effectiveCanvasWidth(),this.effectiveCanvasHeight()];this.opts.heroImageFraction>0&&this.opts.heroImageFraction<1&&(l=!1,s=!0,m[0]>m[1]&&this.opts.multiplanarLayout!==3?a[0]=m[0]*this.opts.heroImageFraction:a[1]=m[1]*this.opts.heroImageFraction,m=[m[0]-a[0],m[1]-a[1]]);const y=this.scaleSlice(u[0]+u[1],u[1]+u[2],o(2,2),m),b=Math.max(Math.max(u[1],u[2]),u[0]),x=this.scaleSlice(u[0]+u[0]+u[1],Math.max(u[1],u[2]),o(3,1),m),A=this.scaleSlice(u[0]+u[0]+u[1]+b,Math.max(u[1],u[2]),o(4,1),m),C=this.scaleSlice(b,u[1]+u[2]+u[2],o(1,3),m),E=this.scaleSlice(b,u[1]+u[2]+u[2]+b,o(1,4),m);let S=!c&&(e<2||!n),M=!1,R=!1,T=!1;this.opts.multiplanarLayout===1?M=!0:this.opts.multiplanarLayout===2?R=!0:this.opts.multiplanarLayout===3?T=!0:C[4]>x[4]&&C[4]>y[4]?M=!0:x[4]>y[4]?T=!0:R=!0;let B=y;if(M?(B=C,!s&&(l||this.opts.multiplanarShowRender===2&&E[4]>=C[4])?B=E:S=!1):T&&(B=x,!s&&(l||this.opts.multiplanarShowRender===2&&A[4]>=x[4])?B=A:S=!1),s){const L=a[0]===0?this.effectiveCanvasWidth():a[0],P=a[1]===0?this.effectiveCanvasHeight():a[1];if(this.opts?.heroSliceType===0||this.opts?.heroSliceType===1||this.opts?.heroSliceType===2)this.draw2D([0,0,L,P],this.opts.heroSliceType,NaN,[1/0,1/0]);else{const _=B.slice(),q=this.effectiveCanvasWidth();L===q&&(_[0]=0),this.draw3D([_[0],0,L,P])}B[0]+=a[0],B[1]+=a[1],S=!1}const F=u[0]*B[4]+v,I=u[1]*B[4]+v,U=u[2]*B[4]+v,k=h[0]*B[4],O=h[1]*B[4],V=h[2]*B[4];if(M){if(this.draw2D([B[0],B[1],F,I],0,NaN,[k,O]),this.draw2D([B[0],B[1]+I+g,F,U],1,NaN,[k,V]),this.draw2D([B[0],B[1]+I+g+U+g,I,U],2,NaN,[O,V]),S){const L=b*B[4];this.draw3D([B[0],B[1]+I+U+U+g*3,L,L])}}else if(T){if(this.draw2D([B[0],B[1],F,I],0,NaN,[k,O]),this.draw2D([B[0]+F+g,B[1],F,U],1,NaN,[k,V]),this.draw2D([B[0]+F+F+g*2,B[1],I,U],2,NaN,[O,V]),S){const L=b*B[4];this.draw3D([B[0]+F+F+I+g*3,B[1],L,L])}}else R&&(l||(S=!1),this.opts.multiplanarShowRender===2&&(S=!0),s&&(S=!1),this.draw2D([B[0],B[1]+U+g,F,I],0,NaN,[k,O]),this.draw2D([B[0],B[1],F,U],1,NaN,[k,V]),this.draw2D([B[0]+F+g,B[1],I,U],2,NaN,[O,V]),S&&this.draw3D([B[0]+F+g,B[1]+U+g,I,I]))}}if(this.opts.isRuler&&this.drawRuler(),this.opts.isColorbar&&this.drawColorbar(),n&&this.drawGraph(),this.uiData.isDragging){if(this.uiData.mouseButtonCenterDown){this.dragForCenterButton([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.getCurrentDragMode()===4){this.dragForSlicer3D([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.getCurrentDragMode()===3){this.dragForPanZoom([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0)return;this.getCurrentDragMode()===2&&this.drawMeasurementTool([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]),this.getCurrentDragMode()===7&&this.drawAngleMeasurementTool();const a=this.getCurrentDragMode();if(a===1||a===6){const s=Math.abs(this.uiData.dragStart[0]-this.uiData.dragEnd[0]),o=Math.abs(this.uiData.dragStart[1]-this.uiData.dragEnd[1]);this.drawSelectionBox([Math.min(this.uiData.dragStart[0],this.uiData.dragEnd[0]),Math.min(this.uiData.dragStart[1],this.uiData.dragEnd[1]),s,o])}}for(const a of this.document.completedMeasurements)if(this.shouldDrawOnCurrentSlice(a.sliceIndex,a.sliceType,a.slicePosition)){const s=this.mm2frac(a.startMM),o=this.mm2frac(a.endMM),l=this.frac2canvasPosWithTile(s,a.sliceType),c=this.frac2canvasPosWithTile(o,a.sliceType);l&&c&&l.tileIndex===c.tileIndex&&this.drawMeasurementTool([l.pos[0],l.pos[1],c.pos[0],c.pos[1]])}for(let a=0;a<this.document.completedAngles.length;a++){const s=this.document.completedAngles[a];if(this.shouldDrawOnCurrentSlice(s.sliceIndex,s.sliceType,s.slicePosition)){const l=this.mm2frac(s.firstLineMM.start),c=this.mm2frac(s.firstLineMM.end),u=this.mm2frac(s.secondLineMM.start),h=this.mm2frac(s.secondLineMM.end),g=this.frac2canvasPosWithTile(l,s.sliceType),v=this.frac2canvasPosWithTile(c,s.sliceType),m=this.frac2canvasPosWithTile(u,s.sliceType),y=this.frac2canvasPosWithTile(h,s.sliceType);if(g&&v&&m&&y&&g.tileIndex===v.tileIndex&&g.tileIndex===m.tileIndex&&g.tileIndex===y.tileIndex){this.drawMeasurementTool([g.pos[0],g.pos[1],v.pos[0],v.pos[1]],!1),this.drawMeasurementTool([m.pos[0],m.pos[1],y.pos[0],y.pos[1]],!1);const b={firstLine:[g.pos[0],g.pos[1],v.pos[0],v.pos[1]],secondLine:[m.pos[0],m.pos[1],y.pos[0],y.pos[1]],sliceIndex:s.sliceIndex,sliceType:s.sliceType,slicePosition:s.slicePosition};this.drawAngleTextForAngle(b)}}}const i=this.frac2mm([this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2]]);return r=i[0].toFixed(2)+"×"+i[1].toFixed(2)+"×"+i[2].toFixed(2),this.readyForSync=!0,this.sync(),this.drawAnchoredLabels(),r}drawScene(){if(this.isBusy){this.needsRefresh=!0;return}this.isBusy=!1,this.needsRefresh=!1;let r=this.drawSceneCore();return this._gl!==null&&this.gl.finish(),this.needsRefresh&&(r=this.drawScene()),r}get gl(){if(!this._gl)throw new Error("unable to get WebGL context. Maybe the browser doesn't support WebGL2.");return this._gl}set gl(r){this._gl=r}findDrawingBoundarySlices(r){if(!this.back||!this.back.dims||!this.drawBitmap)return null;const e={dimX:this.back.dims[1],dimY:this.back.dims[2],dimZ:this.back.dims[3]};return xY(r,this.drawBitmap,e)}interpolateMaskSlices(r,e,n={}){if(!this.back||!this.back.dims||!this.drawBitmap)throw new Error("Background image and drawing bitmap must be loaded");const i={dimX:this.back.dims[1],dimY:this.back.dims[2],dimZ:this.back.dims[3]},a=this.back.img,s=this.back.global_max;SY(this.drawBitmap,i,a,s,r,e,n,()=>this.refreshDrawing(!0))}};function Vj(r){if(!r)return{x:0,y:0,z:0};let e=0;for(let i=0;i<r.length;i+=1)e=e*31+r.charCodeAt(i)>>>0;const n=i=>i%180-90;return{x:n(e),y:n(e>>3),z:n(e>>5)}}function xp(r,e,n){return Math.min(Math.max(r,e),n)}const Oj={url:"https://niivue.github.io/niivue/images/mni152.nii.gz",name:"MNI152"};function Pj(r){if(!r)return null;const{url:e,name:n,format:i}=r;if(!e)return null;const a={url:e,name:n||"Overlay",colormap:"red",opacity:.5};return i&&i.toLowerCase()==="gltf"&&(a.isMesh=!0),a}function Lj(r,e){const n=e?.coordinates?.[0];if(n)return{x:n.x_mm??0,y:n.y_mm??0,z:n.z_mm??0,source:"overlay"};const i=r?.attributes?.centers;if(Array.isArray(i)&&i.length){const a=i[0],s=o=>typeof o!="number"?0:o/1e3;return{x:s(a.x),y:s(a.y),z:s(a.z),source:"node"}}return null}function Iy({focusNode:r,overlay:e}){const n=Ne.useRef(null),i=Ne.useRef(null);return Ne.useEffect(()=>{const a=n.current;if(!a)return()=>{};let s;try{s=new Uj({loadingText:"Loading atlas…",show3Dcrosshair:!0,show3Dcursor:!0})}catch(h){return console.error("Failed to initialise NiiVue",h),()=>{}}i.current=s,s.attachToCanvas(a),s.setSliceType(s.sliceTypeAxial),s.opts.isColorbar=!0;const o=Array.isArray(e?.volumes)?e.volumes.map(Pj).filter(Boolean):[],l=o.filter(h=>h?.isMesh),c=o.filter(h=>!h?.isMesh),u=[Oj,...c];return Promise.resolve(s.loadVolumes(u)).catch(h=>{console.error("Failed to load NIfTI volumes",h)}),l.length&&typeof s.addMesh=="function"&&l.forEach(h=>{s.addMesh({url:h.url,name:h.name||"Mesh",opacity:.6}).catch(g=>{console.error("Failed to load mesh overlay",g)})}),()=>{if(i.current=null,s&&typeof s.destroy=="function")s.destroy();else if(s?.gl?.canvas)try{s.gl.canvas.width=0,s.gl.canvas.height=0}catch(h){console.error("Failed to tear down NiiVue canvas",h)}}},[e]),Ne.useEffect(()=>{const a=i.current;if(!a)return;const s=Lj(r,e);let o,l,c;if(s)o=s.x??0,l=s.y??0,c=s.z??0;else if(r?.id){const m=Vj(r.id);o=m.x,l=m.y,c=m.z}else return;const u=a.voxDims?.[0]??{x:1,y:1,z:1},h=xp(o,-u.x*90,u.x*90),g=xp(l,-u.y*90,u.y*90),v=xp(c,-u.z*90,u.z*90);typeof a.setCrosshairLocation=="function"&&a.setCrosshairLocation(h,g,v)},[r,e]),J.jsx("canvas",{ref:n,className:"niivue-canvas","data-testid":"niivue-canvas"})}Iy.propTypes={focusNode:Q.shape({id:Q.string,attributes:Q.object}),overlay:Q.shape({coordinates:Q.arrayOf(Q.shape({x_mm:Q.number,y_mm:Q.number,z_mm:Q.number})),volumes:Q.arrayOf(Q.shape({url:Q.string,format:Q.string}))})};Iy.defaultProps={focusNode:null,overlay:null};function _j(r){return r==null||Number.isNaN(r)?"unknown":r<.2?"low":r<.5?"moderate":r<.75?"elevated":"high"}function zj(r){return r==null||Number.isNaN(r)?"n/a":`${Math.round(r*100)}%`}function ef({value:r,label:e="Uncertainty"}){const n=_j(r);return J.jsxs("span",{className:`uncertainty-badge uncertainty-${n}`,"data-testid":"uncertainty-badge",children:[J.jsx("span",{className:"uncertainty-label",children:e}),J.jsx("span",{className:"uncertainty-value",children:zj(r)})]})}ef.propTypes={value:Q.number,label:Q.string};function Gj(r){return r.trim()?r.split(/\n|,/).map(e=>e.trim()).filter(Boolean).map(e=>({name:e})):[]}function Ny({onPredict:r,prediction:e,onExplain:n,explanation:i,defaultReceptors:a,onReceptorFocus:s}){const[o,l]=Ne.useState(a.join(", ")),[c,u]=Ne.useState(a[0]??""),[h,g]=Ne.useState("both"),[v,m]=Ne.useState(12);Ne.useEffect(()=>{a.length&&(l(a.join(", ")),u(A=>A||a[0]))},[a]);const y=Ne.useMemo(()=>Gj(o),[o]),b=A=>{A.preventDefault(),y.length&&(r({receptors:y}),s&&y[0]&&s(y[0].name))},x=A=>{A.preventDefault(),c&&(n({receptor:c,direction:h,limit:Number(v)}),s&&s(c))};return J.jsxs("section",{className:"panel","data-testid":"effect-workbench",children:[J.jsxs("header",{children:[J.jsx("h2",{children:"Receptor evidence & explanations"}),J.jsx("p",{className:"panel-subtitle",children:"Generate provenance cards and inspect upstream/downstream edges for receptors of interest."})]}),J.jsxs("form",{className:"form-grid",onSubmit:b,children:[J.jsx("label",{htmlFor:"receptor-list",children:"Receptors"}),J.jsx("textarea",{id:"receptor-list",rows:"2",value:o,onChange:A=>l(A.target.value),"data-testid":"receptor-input",placeholder:"DRD2, HTR1A, SLC6A4"}),J.jsx("button",{type:"submit",className:"primary",disabled:e.status==="loading","data-testid":"predict-button",children:e.status==="loading"?"Scoring…":"Score receptor evidence"})]}),e.error&&J.jsx("p",{className:"form-error",role:"alert",children:e.error.message}),e.data?.items?.length>0&&J.jsx("div",{className:"provenance-grid","data-testid":"provenance-cards",children:e.data.items.map(A=>J.jsxs("article",{className:"provenance-card",children:[J.jsxs("header",{children:[J.jsx("h3",{children:A.receptor}),J.jsx(ef,{value:A.uncertainty})]}),J.jsxs("dl",{children:[J.jsxs("div",{children:[J.jsx("dt",{children:"Knowledge graph weight"}),J.jsx("dd",{children:A.kg_weight.toFixed(2)})]}),J.jsxs("div",{children:[J.jsx("dt",{children:"Evidence score"}),J.jsx("dd",{children:A.evidence.toFixed(2)})]}),J.jsxs("div",{children:[J.jsx("dt",{children:"Affinity"}),J.jsx("dd",{children:A.affinity!=null?A.affinity.toFixed(2):"n/a"})]}),J.jsxs("div",{children:[J.jsx("dt",{children:"Expression"}),J.jsx("dd",{children:A.expression!=null?A.expression.toFixed(2):"n/a"})]}),J.jsxs("div",{children:[J.jsx("dt",{children:"Sources"}),J.jsx("dd",{children:A.evidence_sources.join(", ")||"—"})]})]})]},A.receptor))}),J.jsxs("form",{className:"form-grid secondary",onSubmit:x,children:[J.jsx("label",{htmlFor:"explain-target",children:"Explain receptor"}),J.jsx("input",{id:"explain-target",value:c,onChange:A=>u(A.target.value),placeholder:"DRD2","data-testid":"explain-input"}),J.jsx("label",{htmlFor:"direction",children:"Direction"}),J.jsxs("select",{id:"direction",value:h,onChange:A=>g(A.target.value),"data-testid":"explain-direction",children:[J.jsx("option",{value:"both",children:"Both"}),J.jsx("option",{value:"upstream",children:"Upstream"}),J.jsx("option",{value:"downstream",children:"Downstream"})]}),J.jsx("label",{htmlFor:"edge-limit",children:"Edge limit"}),J.jsx("input",{id:"edge-limit",type:"number",min:"1",max:"50",value:v,onChange:A=>m(A.target.value),"data-testid":"explain-limit"}),J.jsx("button",{type:"submit",className:"primary",disabled:i.status==="loading","data-testid":"explain-button",children:i.status==="loading"?"Fetching…":"Explain receptor"})]}),i.error&&J.jsx("p",{className:"form-error",role:"alert",children:i.error.message}),i.data?.edges?.length>0&&J.jsx("div",{className:"explanation-list","data-testid":"explanation-list",children:i.data.edges.map(A=>J.jsxs("article",{className:"explanation-card",children:[A.direction&&J.jsx("p",{className:"edge-direction",children:A.direction}),J.jsxs("header",{children:[J.jsxs("h4",{children:[A.direction==="upstream"?"⬆️":"⬇️"," ",A.edge.subject," → ",A.edge.object]}),J.jsx(ef,{value:A.edge.uncertainty,label:"Edge uncertainty"})]}),J.jsx("p",{className:"edge-meta",children:A.edge.predicate}),J.jsxs("p",{className:"edge-context",children:[A.provenance.length," provenance items"]})]},`${A.edge.subject}-${A.edge.object}-${A.direction}`))})]})}Ny.propTypes={onPredict:Q.func.isRequired,prediction:Q.shape({status:Q.string,error:Q.instanceOf(Error),data:Q.shape({items:Q.arrayOf(Q.shape({receptor:Q.string.isRequired,kg_weight:Q.number.isRequired,evidence:Q.number.isRequired,affinity:Q.number,expression:Q.number,evidence_sources:Q.arrayOf(Q.string),uncertainty:Q.number}))})}).isRequired,onExplain:Q.func.isRequired,explanation:Q.shape({status:Q.string,error:Q.instanceOf(Error),data:Q.shape({edges:Q.arrayOf(Q.shape({direction:Q.string,edge:Q.shape({subject:Q.string,object:Q.string,predicate:Q.string,uncertainty:Q.number})}))})}).isRequired,defaultReceptors:Q.arrayOf(Q.string),onReceptorFocus:Q.func};Ny.defaultProps={defaultReceptors:[],onReceptorFocus:void 0};function qj(r){return r.split(/\n|,/).map(e=>e.trim()).filter(Boolean)}function so(r){return r==null||Number.isNaN(r)?"—":r.toFixed(2)}function Yj(r){const e=[],n=new Set;for(const i of r)n.has(i.subject)||(e.push(i.subject),n.add(i.subject)),n.has(i.object)||(e.push(i.object),n.add(i.object));return e.slice(0,12)}function jj(r){const e=Yj(r),n=e.map(i=>e.map(a=>r.find(s=>s.subject===i&&s.object===a)||null));return{nodes:e,matrix:n}}function Hj(r){if(!r)return{};const e=Math.min(1,Math.max(0,r.impact_score||r.impact||0)),n=200-e*120,i=80-e*35;return{background:`hsl(${n}, 75%, ${i}%)`}}function Fy({onAnalyse:r,status:e,error:n,items:i,suggestions:a}){const[s,o]=Ne.useState(a.join(", ")),[l,c]=Ne.useState(null);Ne.useEffect(()=>{i.length>0?c(i[0]):c(null)},[i]);const u=g=>{g.preventDefault();const v=qj(s);v.length&&r({focus_nodes:v})},h=Ne.useMemo(()=>jj(i),[i]);return J.jsxs("section",{className:"panel","data-testid":"gap-dashboard",children:[J.jsxs("header",{children:[J.jsx("h2",{children:"Gap surfacing"}),J.jsx("p",{className:"panel-subtitle",children:"Identify missing links amongst focus nodes to steer curation."})]}),J.jsxs("form",{className:"form-grid",onSubmit:u,children:[J.jsx("label",{htmlFor:"gap-focus",children:"Focus nodes"}),J.jsx("textarea",{id:"gap-focus",rows:"2",value:s,onChange:g=>o(g.target.value),placeholder:"Node A, Node B","data-testid":"gap-input"}),J.jsx("button",{type:"submit",className:"primary",disabled:e==="loading","data-testid":"gap-button",children:e==="loading"?"Analysing…":"Find gaps"})]}),n&&J.jsx("p",{className:"form-error",role:"alert",children:n.message}),i.length>0&&J.jsxs("div",{className:"gap-layout",children:[J.jsxs("div",{className:"gap-list-wrapper",children:[J.jsx("h3",{children:"Ranked candidates"}),J.jsx("ul",{className:"gap-list","data-testid":"gap-results",children:i.map(g=>J.jsxs("li",{className:l&&l.subject===g.subject&&l.object===g.object?"active":"",onClick:()=>c(g),onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&c(g)},tabIndex:0,role:"button",children:[J.jsxs("span",{className:"gap-pair",children:[g.subject," → ",g.object]}),J.jsx("span",{className:"gap-reason",children:g.reason}),J.jsxs("div",{className:"gap-metrics",children:[J.jsxs("span",{children:["Impact ",so(g.impact_score||g.impact)]}),J.jsxs("span",{children:["Embedding ",so(g.embedding_score)]})]})]},`${g.subject}-${g.object}`))})]}),J.jsxs("div",{className:"gap-heatmap-wrapper",children:[J.jsx("h3",{children:"Coverage heatmap"}),J.jsx("div",{className:"heatmap-scroll",children:J.jsxs("table",{className:"gap-heatmap",children:[J.jsx("thead",{children:J.jsxs("tr",{children:[J.jsx("th",{"aria-label":"Empty"}),h.nodes.map(g=>J.jsx("th",{children:g},`col-${g}`))]})}),J.jsx("tbody",{children:h.matrix.map((g,v)=>J.jsxs("tr",{children:[J.jsx("th",{scope:"row",children:h.nodes[v]}),g.map((m,y)=>J.jsx("td",{style:Hj(m),className:m&&l&&m.subject===l.subject&&m.object===l.object?"active":"",onClick:()=>m&&c(m),children:m?so(m.impact_score||m.impact):""},`${v}-${y}`))]},h.nodes[v]))})]})})]}),l&&J.jsxs("aside",{className:"gap-detail","data-testid":"gap-detail",children:[J.jsx("h3",{children:"Gap triage"}),J.jsxs("p",{className:"gap-detail__title",children:[J.jsx("strong",{children:l.subject})," → ",J.jsx("strong",{children:l.object})]}),J.jsxs("dl",{className:"gap-detail__metrics",children:[J.jsxs("div",{children:[J.jsx("dt",{children:"Impact score"}),J.jsx("dd",{children:so(l.impact_score||l.impact)})]}),J.jsxs("div",{children:[J.jsx("dt",{children:"Embedding score"}),J.jsx("dd",{children:so(l.embedding_score)})]}),J.jsxs("div",{children:[J.jsx("dt",{children:"Context weight"}),J.jsx("dd",{children:so(l.metadata?.context_weight)})]}),J.jsxs("div",{children:[J.jsx("dt",{children:"Uncertainty"}),J.jsx("dd",{children:so(l.metadata?.context_uncertainty)})]})]}),l.reason&&J.jsx("p",{className:"gap-detail__reason",children:l.reason}),l.literature&&l.literature.length>0&&J.jsxs("div",{className:"gap-detail__literature",children:[J.jsx("h4",{children:"Suggested literature"}),J.jsx("ul",{children:l.literature.map(g=>J.jsx("li",{children:g},g))})]}),l.causal&&J.jsxs("div",{className:"gap-detail__causal",children:[J.jsx("h4",{children:"Causal summary"}),J.jsx("p",{children:l.causal.description})]})]})]})]})}Fy.propTypes={onAnalyse:Q.func.isRequired,status:Q.string,error:Q.instanceOf(Error),items:Q.arrayOf(Q.shape({subject:Q.string.isRequired,object:Q.string.isRequired,reason:Q.string,impact_score:Q.number,impact:Q.number,embedding_score:Q.number,metadata:Q.object,literature:Q.arrayOf(Q.string),causal:Q.shape({description:Q.string})})),suggestions:Q.arrayOf(Q.string)};Fy.defaultProps={status:"idle",error:null,items:[],suggestions:[]};const Kj=["agonist","antagonist","partial","inverse"];function tE(r){return`${Math.round(r*100)}%`}function ky({effects:r,simulation:e,onSimulate:n,timeIndex:i,onTimeIndexChange:a}){const[s,o]=Ne.useState({}),[l,c]=Ne.useState("chronic"),[u,h]=Ne.useState(!1),[g,v]=Ne.useState(!1),[m,y]=Ne.useState(!1),[b,x]=Ne.useState(.5),[A,C]=Ne.useState(!0),[E,S]=Ne.useState(!1),[M,R]=Ne.useState(!1),[T,B]=Ne.useState(!1),[F,I]=Ne.useState(!1),[U,k]=Ne.useState(!1),[O,V]=Ne.useState(!1),[L,P]=Ne.useState(!1);Ne.useEffect(()=>{r?.length&&o(re=>{const ve={...re};return r.forEach(le=>{ve[le.receptor]||(ve[le.receptor]={enabled:!0,occ:.5,mech:"agonist"})}),ve})},[r]);const _=e.data?.details?.timepoints??[];e.data?.details?.trajectories;const q=e.data?.details?.receptor_context??{},H=e.data?.details?.modules??{},W=e.data?.behavioral_tags??{},G=_[i]??_[_.length-1]??0,K=Ne.useMemo(()=>!H||!G?[]:Object.entries(H).map(([re,ve])=>{const le=ve.timeline?.[i]??ve.score??0;return{key:re,description:ve.description??re,score:Number(le)||0}}),[H,i,G]),$=re=>{o(ve=>({...ve,[re]:{...ve[re],enabled:!ve[re].enabled}}))},te=(re,ve,le)=>{const ie=ve==="occ"?Number(le):le;o(se=>({...se,[re]:{...se[re],[ve]:ie}}))},ae=re=>{re.preventDefault();const ve={};Object.entries(s).forEach(([le,ie])=>{ie.enabled&&(ve[le]={occ:Number(ie.occ),mech:ie.mech})}),Object.keys(ve).length&&n({receptors:ve,dosing:l,acute_1a:u,adhd:g,gut_bias:m,pvt_weight:Number(b),assumptions:{trkB_facilitation:!!A,alpha2a_hcn_closure:!!E,mu_opioid_bonding:!!M,a2a_d2_heteromer:!!T,alpha2c_gate:!!F,bla_cholinergic_salience:!!U,oxytocin_prosocial:!!O,vasopressin_gating:!!L}})},ue=Object.values(s).filter(re=>re.enabled).length;return J.jsxs("section",{className:"panel","data-testid":"simulation-panel",children:[J.jsxs("header",{children:[J.jsx("h2",{children:"Simulation cockpit"}),J.jsx("p",{className:"panel-subtitle",children:"Configure receptor engagements and run the simulation engine with time slider playback."})]}),J.jsxs("form",{className:"simulation-grid",onSubmit:ae,children:[J.jsxs("div",{className:"receptor-table","data-testid":"simulation-receptors",children:[J.jsxs("header",{children:[J.jsx("h3",{children:"Receptors"}),J.jsxs("span",{className:"receptor-count",children:[ue," selected"]})]}),J.jsx("div",{className:"receptor-rows",children:r?.length?r.map(re=>{const ve=s[re.receptor];return ve?J.jsxs("div",{className:"receptor-row",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:ve.enabled,onChange:()=>$(re.receptor)}),J.jsx("span",{children:re.receptor})]}),J.jsxs("div",{className:"receptor-controls",children:[J.jsxs("label",{children:["Occupancy",J.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:ve.occ,onChange:le=>te(re.receptor,"occ",le.target.value),"data-testid":`occupancy-${re.receptor}`}),J.jsx("span",{className:"slider-value",children:tE(ve.occ)})]}),J.jsxs("label",{children:["Mechanism",J.jsx("select",{value:ve.mech,onChange:le=>te(re.receptor,"mech",le.target.value),"data-testid":`mechanism-${re.receptor}`,children:Kj.map(le=>J.jsx("option",{value:le,children:le},le))})]}),J.jsx(ef,{value:q[re.receptor]?.uncertainty})]})]},re.receptor):null}):J.jsx("p",{className:"empty",children:"Run receptor scoring to populate simulation inputs."})})]}),J.jsxs("div",{className:"simulation-controls",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:u,onChange:re=>h(re.target.checked)}),J.jsx("span",{children:"Acute 5-HT1A clamp"})]}),J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:g,onChange:re=>v(re.target.checked)}),J.jsx("span",{children:"ADHD cohort"})]}),J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:m,onChange:re=>y(re.target.checked)}),J.jsx("span",{children:"Gut-brain bias"})]}),J.jsxs("div",{className:"assumption-section",children:[J.jsx("h4",{children:"Advanced circuit assumptions"}),J.jsx("p",{className:"assumption-note",children:"Toggle heuristic pathways to explore alternative microcircuit hypotheses and bonding motifs."}),J.jsxs("div",{className:"assumption-control",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:A,onChange:re=>C(re.target.checked)}),J.jsx("span",{children:"Enable TrkB plasticity"})]}),J.jsx("p",{className:"toggle-description",children:"Boosts BDNF/TrkB nodes to capture chronic facilitation of synaptic plasticity."})]}),J.jsxs("div",{className:"assumption-control",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:E,onChange:re=>S(re.target.checked)}),J.jsx("span",{children:"α2A HCN closure"})]}),J.jsx("p",{className:"toggle-description",children:"Models α2A-driven HCN channel closure for prefrontal working-memory stabilization."})]}),J.jsxs("div",{className:"assumption-control",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:M,onChange:re=>R(re.target.checked)}),J.jsx("span",{children:"μ-opioid bonding module"})]}),J.jsx("p",{className:"toggle-description",children:"Amplifies social affiliation via hedonic hotspots, oxytocin spillover and enkephalinergic drive."})]}),J.jsxs("div",{className:"assumption-control",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:T,onChange:re=>B(re.target.checked)}),J.jsx("span",{children:"A2A–D2 heteromer priming"})]}),J.jsx("p",{className:"toggle-description",children:"Engages A2A/D2 heteromer weights to bias ventral striatal exploration and salience gating."})]}),J.jsxs("div",{className:"assumption-control",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:F,onChange:re=>I(re.target.checked)}),J.jsx("span",{children:"α2C cortical gate"})]}),J.jsx("p",{className:"toggle-description",children:"Introduces α2C-mediated dampening of stress arousal while tightening thalamo-cortical gain."})]}),J.jsxs("div",{className:"assumption-control",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:U,onChange:re=>k(re.target.checked)}),J.jsx("span",{children:"BLA cholinergic salience"})]}),J.jsx("p",{className:"toggle-description",children:"Engages basolateral amygdala cholinergic bursts to sharpen cue salience and socio-emotional tagging."})]}),J.jsxs("div",{className:"assumption-control",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:O,onChange:re=>V(re.target.checked)}),J.jsx("span",{children:"Oxytocin prosocial boost"})]}),J.jsx("p",{className:"toggle-description",children:"Augments oxytocinergic loops for attachment security and affiliative motivation."})]}),J.jsxs("div",{className:"assumption-control",children:[J.jsxs("label",{className:"toggle",children:[J.jsx("input",{type:"checkbox",checked:L,onChange:re=>P(re.target.checked)}),J.jsx("span",{children:"Vasopressin threat gating"})]}),J.jsx("p",{className:"toggle-description",children:"Activates vasopressin-mediated vigilance to explore territorial and dominance stressors."})]})]}),J.jsxs("label",{children:["Dosing regime",J.jsxs("select",{value:l,onChange:re=>c(re.target.value),"data-testid":"dosing-select",children:[J.jsx("option",{value:"chronic",children:"Chronic"}),J.jsx("option",{value:"acute",children:"Acute"})]})]}),J.jsxs("label",{children:["PVT weight",J.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:b,onChange:re=>x(Number(re.target.value)),"data-testid":"pvt-weight"}),J.jsx("span",{className:"slider-value",children:tE(b)})]}),J.jsx("button",{type:"submit",className:"primary",disabled:e.status==="loading","data-testid":"simulate-button",children:e.status==="loading"?"Simulating…":"Run simulation"}),e.error&&J.jsx("p",{className:"form-error",role:"alert",children:e.error.message})]})]}),_.length>0&&J.jsxs("div",{className:"timeline","data-testid":"simulation-timeline",children:[J.jsx("label",{htmlFor:"time-slider",children:"Time"}),J.jsx("input",{id:"time-slider",type:"range",min:"0",max:_.length-1,value:i,onChange:re=>a(Number(re.target.value))}),J.jsxs("span",{className:"timeline-value",children:[G.toFixed(2)," h"]})]}),e.data&&J.jsxs("div",{className:"simulation-summary","data-testid":"simulation-summary",children:[J.jsx("div",{className:"scoreboard",children:Object.entries(e.data.scores??{}).map(([re,ve])=>J.jsxs("div",{className:"score-item",children:[(()=>{const le=W[re],ie=le?.label??re,se=le?.domain??le?.rdoc?.label,fe=le?.rdoc?.id??le?.cogatlas?.id;return J.jsxs(J.Fragment,{children:[J.jsx("span",{className:"metric",children:ie}),se&&J.jsx("span",{className:"metric-subtitle",children:se}),fe&&J.jsx("span",{className:"metric-code",children:fe})]})})(),J.jsx("span",{className:"value",children:ve.toFixed(2)}),J.jsx(ef,{value:e.data.uncertainty?.[re]})]},re))}),J.jsxs("div",{className:"module-table",children:[J.jsx("h3",{children:"Module trajectories"}),J.jsxs("table",{children:[J.jsx("thead",{children:J.jsxs("tr",{children:[J.jsx("th",{children:"Module"}),J.jsx("th",{children:"Score"})]})}),J.jsx("tbody",{children:K.map(re=>J.jsxs("tr",{children:[J.jsx("td",{children:re.description}),J.jsx("td",{children:re.score.toFixed(2)})]},re.key))})]})]})]})]})}ky.propTypes={effects:Q.arrayOf(Q.shape({receptor:Q.string.isRequired})),simulation:Q.shape({status:Q.string,error:Q.instanceOf(Error),data:Q.shape({scores:Q.object,details:Q.object,uncertainty:Q.object,behavioral_tags:Q.object})}).isRequired,onSimulate:Q.func.isRequired,timeIndex:Q.number,onTimeIndexChange:Q.func.isRequired};ky.defaultProps={effects:[],timeIndex:0};const Xj=15e3;function Qj(){return""}const Zj=Qj();async function Wj(r,e=Xj){if(!e)return r;let n;const i=new Promise((a,s)=>{n=setTimeout(()=>{s(new Error("Request timed out"))},e)});try{return await Promise.race([r,i])}finally{clearTimeout(n)}}async function XT(r,{method:e="POST",payload:n,headers:i={},timeout:a}={}){const s=r.startsWith("http")?r:`${Zj}${r}`,o=await Wj(fetch(s,{method:e,headers:{"Content-Type":"application/json",...i},body:e==="GET"?void 0:JSON.stringify(n??{}),credentials:"include"}),a),l=o.headers.get("content-type"),c=l&&l.includes("application/json"),u=c?await o.json():await o.text();if(!o.ok){const h=c&&u?.message?u.message:o.statusText||"Request failed",g=c&&u?.context?u.context:void 0,v=new Error(h||"Request failed");throw v.status=o.status,v.code=u?.code,g&&(v.context=g),v}return u}function Jj(r,e,n={}){return XT(r,{...n,method:"POST",payload:e})}function $j(r,e={}){return XT(r,{...e,method:"GET"})}const Cf={expand:"/graph/expand",predict:"/predict/effects",explain:"/explain",gaps:"/gaps",simulate:"/simulate"};function QT(r){return r?r instanceof Error?r:new Error(typeof r=="string"?r:"Request failed"):null}function Ef(r){const[e,n]=Ne.useState(null),[i,a]=Ne.useState(null),[s,o]=Ne.useState("idle"),l=Ne.useCallback(async u=>{o("loading"),a(null);try{const h=await Jj(r,u);return n(h),o("success"),h}catch(h){const g=QT(h);throw a(g),o("error"),g}},[r]),c=Ne.useCallback(()=>{o("idle"),a(null),n(null)},[]);return{data:e,error:i,status:s,execute:l,reset:c}}function eH(){return Ef(Cf.expand)}function tH(){return Ef(Cf.predict)}function rH(){return Ef(Cf.explain)}function nH(){return Ef(Cf.gaps)}function iH(){return Ef(Cf.simulate)}function aH(){const[r,e]=Ne.useState(null),[n,i]=Ne.useState("idle"),[a,s]=Ne.useState(null),o=Ne.useCallback(async c=>{if(!c)return e(null),null;i("loading"),s(null);try{const u=await $j(`/atlas/overlays/${encodeURIComponent(c)}`);return e(u),i("success"),u}catch(u){const h=QT(u);throw s(h),i("error"),h}},[]),l=Ne.useCallback(()=>{e(null),i("idle"),s(null)},[]);return{data:r,status:n,error:a,fetch:o,reset:l}}function sH(r){if(!r)return{nodes:[],links:[]};const e=r.nodes?.map(i=>({id:i.id,name:i.name||i.id,category:i.category,value:(i.attributes?.degree??1)+1}))??[],n=r.edges?.map((i,a)=>({id:`${i.subject}-${i.object}-${a}`,source:i.subject,target:i.object,label:i.predicate,confidence:i.confidence??.5,uncertainty:i.uncertainty??(i.confidence!=null?1-i.confidence:.5)}))??[];return{nodes:e,links:n}}function oH(r){if(!r)return[];const e=r.nodes?.map(i=>({data:{id:i.id,label:i.name||i.id,category:i.category}}))??[],n=r.edges?.map((i,a)=>({data:{id:`${i.subject}-${i.object}-${a}`,source:i.subject,target:i.object,label:i.predicate,confidence:i.confidence,uncertainty:i.uncertainty}}))??[];return[...e,...n]}function lH(r){return Ne.useMemo(()=>({nodes:r?.nodes??[],edges:r?.edges??[]}),[r])}function uH(){const r=eH(),e=tH(),n=rH(),i=nH(),a=iH(),s=aH(),[o,l]=Ne.useState(""),[c,u]=Ne.useState(""),[h,g]=Ne.useState(0),v=lH(r.data),m=Ne.useMemo(()=>oH(r.data),[r.data]),y=Ne.useMemo(()=>sH(r.data),[r.data]),b=Ne.useMemo(()=>v.nodes.find(T=>T.id===c)??null,[v.nodes,c]);Ne.useEffect(()=>{r.data?.centre&&(l(r.data.centre),u(r.data.centre))},[r.data]),Ne.useEffect(()=>{!o&&v.nodes.length&&l(v.nodes[0].id)},[v.nodes,o]),Ne.useEffect(()=>{a.data?.details?.timepoints?.length&&g(a.data.details.timepoints.length-1)},[a.data]),Ne.useEffect(()=>{c?s.fetch(c).catch(()=>{}):s.reset()},[c]);const x=Ne.useMemo(()=>v.nodes.slice(0,5).map(T=>T.id),[v.nodes]),A=Ne.useMemo(()=>e.data?.items?.length?e.data.items.map(T=>T.receptor):c?[c]:[],[e.data,c]),C=T=>{r.execute(T).catch(()=>{})},E=T=>{e.execute(T).catch(()=>{})},S=T=>{n.execute(T).catch(()=>{})},M=T=>{i.execute(T).catch(()=>{})},R=T=>{a.execute(T).catch(()=>{})};return J.jsxs("div",{className:"app-shell",children:[J.jsxs("header",{className:"app-header",children:[J.jsx("h1",{children:"Neuropharm Simulation Lab"}),J.jsx("p",{className:"tagline",children:"Top-down atlas overlays meet bottom-up receptor simulations."})]}),J.jsxs("main",{className:"app-main",children:[J.jsxs("section",{className:"left-column",children:[J.jsx(p2,{onExpand:C,status:r.status,error:r.error,nodes:v.nodes,onSelectNode:T=>{l(T),u(T)}}),J.jsx(Ny,{onPredict:E,prediction:e,onExplain:S,explanation:n,defaultReceptors:A,onReceptorFocus:T=>u(T)}),J.jsx(Fy,{onAnalyse:M,status:i.status,error:i.error,items:i.data?.items??[],suggestions:x}),J.jsx(ky,{effects:e.data?.items??[],simulation:a,onSimulate:R,timeIndex:h,onTimeIndexChange:g})]}),J.jsx("section",{className:"right-column",children:J.jsxs("div",{className:"atlas-stack",children:[J.jsxs("div",{className:"atlas-panel",children:[J.jsx("h2",{children:"Top-down atlas view"}),J.jsx(Iy,{focusNode:b,overlay:s.data})]}),J.jsxs("div",{className:"atlas-panel",children:[J.jsx("h2",{children:"Knowledge graph (Cytoscape)"}),J.jsx(q2,{elements:m,selectedId:o,onSelect:T=>{l(T),u(T)}})]}),J.jsxs("div",{className:"atlas-panel",children:[J.jsx("h2",{children:"Bottom-up force graph"}),J.jsx(ly,{graph:y,onNodeSelect:T=>{l(T),u(T)}})]})]})})]})]})}f8.createRoot(document.getElementById("root")).render(J.jsx(Ne.StrictMode,{children:J.jsx(uH,{})}));
