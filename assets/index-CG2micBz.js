const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/blosc-CrUiACa7.js","assets/chunk-INHXZS53-D3tQiqtZ.js","assets/lz4-B_Exjfmr.js","assets/zstd-u5eweWyS.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();function a2(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Wv={exports:{}},zu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ew;function kD(){if(ew)return zu;ew=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,s){var o=null;if(s!==void 0&&(o=""+s),a.key!==void 0&&(o=""+a.key),"key"in a){s={};for(var l in a)l!=="key"&&(s[l]=a[l])}else s=a;return a=s.ref,{$$typeof:r,type:i,key:o,ref:a!==void 0?a:null,props:s}}return zu.Fragment=e,zu.jsx=n,zu.jsxs=n,zu}var tw;function PD(){return tw||(tw=1,Wv.exports=kD()),Wv.exports}var ie=PD(),Zv={exports:{}},gt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rw;function UD(){if(rw)return gt;rw=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),d=Symbol.iterator;function v(z){return z===null||typeof z!="object"?null:(z=d&&z[d]||z["@@iterator"],typeof z=="function"?z:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function x(z,Y,Z){this.props=z,this.context=Y,this.refs=b,this.updater=Z||m}x.prototype.isReactComponent={},x.prototype.setState=function(z,Y){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,Y,"setState")},x.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function A(){}A.prototype=x.prototype;function C(z,Y,Z){this.props=z,this.context=Y,this.refs=b,this.updater=Z||m}var E=C.prototype=new A;E.constructor=C,y(E,x.prototype),E.isPureReactComponent=!0;var S=Array.isArray,T={H:null,A:null,T:null,S:null,V:null},R=Object.prototype.hasOwnProperty;function D(z,Y,Z,J,ee,ne){return Z=ne.ref,{$$typeof:r,type:z,key:Y,ref:Z!==void 0?Z:null,props:ne}}function B(z,Y){return D(z.type,Y,void 0,void 0,void 0,z.props)}function N(z){return typeof z=="object"&&z!==null&&z.$$typeof===r}function I(z){var Y={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(Z){return Y[Z]})}var P=/\/+/g;function F(z,Y){return typeof z=="object"&&z!==null&&z.key!=null?I(""+z.key):Y.toString(36)}function O(){}function U(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(O,O):(z.status="pending",z.then(function(Y){z.status==="pending"&&(z.status="fulfilled",z.value=Y)},function(Y){z.status==="pending"&&(z.status="rejected",z.reason=Y)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function L(z,Y,Z,J,ee){var ne=typeof z;(ne==="undefined"||ne==="boolean")&&(z=null);var oe=!1;if(z===null)oe=!0;else switch(ne){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(z.$$typeof){case r:case e:oe=!0;break;case h:return oe=z._init,L(oe(z._payload),Y,Z,J,ee)}}if(oe)return ee=ee(z),oe=J===""?"."+F(z,0):J,S(ee)?(Z="",oe!=null&&(Z=oe.replace(P,"$&/")+"/"),L(ee,Y,Z,"",function(ve){return ve})):ee!=null&&(N(ee)&&(ee=B(ee,Z+(ee.key==null||z&&z.key===ee.key?"":(""+ee.key).replace(P,"$&/")+"/")+oe)),Y.push(ee)),1;oe=0;var me=J===""?".":J+":";if(S(z))for(var ye=0;ye<z.length;ye++)J=z[ye],ne=me+F(J,ye),oe+=L(J,Y,Z,ne,ee);else if(ye=v(z),typeof ye=="function")for(z=ye.call(z),ye=0;!(J=z.next()).done;)J=J.value,ne=me+F(J,ye++),oe+=L(J,Y,Z,ne,ee);else if(ne==="object"){if(typeof z.then=="function")return L(U(z),Y,Z,J,ee);throw Y=String(z),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return oe}function V(z,Y,Z){if(z==null)return z;var J=[],ee=0;return L(z,J,"","",function(ne){return Y.call(Z,ne,ee++)}),J}function _(z){if(z._status===-1){var Y=z._result;Y=Y(),Y.then(function(Z){(z._status===0||z._status===-1)&&(z._status=1,z._result=Z)},function(Z){(z._status===0||z._status===-1)&&(z._status=2,z._result=Z)}),z._status===-1&&(z._status=0,z._result=Y)}if(z._status===1)return z._result.default;throw z._result}var G=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function K(){}return gt.Children={map:V,forEach:function(z,Y,Z){V(z,function(){Y.apply(this,arguments)},Z)},count:function(z){var Y=0;return V(z,function(){Y++}),Y},toArray:function(z){return V(z,function(Y){return Y})||[]},only:function(z){if(!N(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},gt.Component=x,gt.Fragment=n,gt.Profiler=a,gt.PureComponent=C,gt.StrictMode=i,gt.Suspense=u,gt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,gt.__COMPILER_RUNTIME={__proto__:null,c:function(z){return T.H.useMemoCache(z)}},gt.cache=function(z){return function(){return z.apply(null,arguments)}},gt.cloneElement=function(z,Y,Z){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var J=y({},z.props),ee=z.key,ne=void 0;if(Y!=null)for(oe in Y.ref!==void 0&&(ne=void 0),Y.key!==void 0&&(ee=""+Y.key),Y)!R.call(Y,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&Y.ref===void 0||(J[oe]=Y[oe]);var oe=arguments.length-2;if(oe===1)J.children=Z;else if(1<oe){for(var me=Array(oe),ye=0;ye<oe;ye++)me[ye]=arguments[ye+2];J.children=me}return D(z.type,ee,void 0,void 0,ne,J)},gt.createContext=function(z){return z={$$typeof:o,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:s,_context:z},z},gt.createElement=function(z,Y,Z){var J,ee={},ne=null;if(Y!=null)for(J in Y.key!==void 0&&(ne=""+Y.key),Y)R.call(Y,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(ee[J]=Y[J]);var oe=arguments.length-2;if(oe===1)ee.children=Z;else if(1<oe){for(var me=Array(oe),ye=0;ye<oe;ye++)me[ye]=arguments[ye+2];ee.children=me}if(z&&z.defaultProps)for(J in oe=z.defaultProps,oe)ee[J]===void 0&&(ee[J]=oe[J]);return D(z,ne,void 0,void 0,null,ee)},gt.createRef=function(){return{current:null}},gt.forwardRef=function(z){return{$$typeof:l,render:z}},gt.isValidElement=N,gt.lazy=function(z){return{$$typeof:h,_payload:{_status:-1,_result:z},_init:_}},gt.memo=function(z,Y){return{$$typeof:c,type:z,compare:Y===void 0?null:Y}},gt.startTransition=function(z){var Y=T.T,Z={};T.T=Z;try{var J=z(),ee=T.S;ee!==null&&ee(Z,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(K,G)}catch(ne){G(ne)}finally{T.T=Y}},gt.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},gt.use=function(z){return T.H.use(z)},gt.useActionState=function(z,Y,Z){return T.H.useActionState(z,Y,Z)},gt.useCallback=function(z,Y){return T.H.useCallback(z,Y)},gt.useContext=function(z){return T.H.useContext(z)},gt.useDebugValue=function(){},gt.useDeferredValue=function(z,Y){return T.H.useDeferredValue(z,Y)},gt.useEffect=function(z,Y,Z){var J=T.H;if(typeof Z=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return J.useEffect(z,Y)},gt.useId=function(){return T.H.useId()},gt.useImperativeHandle=function(z,Y,Z){return T.H.useImperativeHandle(z,Y,Z)},gt.useInsertionEffect=function(z,Y){return T.H.useInsertionEffect(z,Y)},gt.useLayoutEffect=function(z,Y){return T.H.useLayoutEffect(z,Y)},gt.useMemo=function(z,Y){return T.H.useMemo(z,Y)},gt.useOptimistic=function(z,Y){return T.H.useOptimistic(z,Y)},gt.useReducer=function(z,Y,Z){return T.H.useReducer(z,Y,Z)},gt.useRef=function(z){return T.H.useRef(z)},gt.useState=function(z){return T.H.useState(z)},gt.useSyncExternalStore=function(z,Y,Z){return T.H.useSyncExternalStore(z,Y,Z)},gt.useTransition=function(){return T.H.useTransition()},gt.version="19.1.1",gt}var nw;function s2(){return nw||(nw=1,Zv.exports=UD()),Zv.exports}var Ye=s2();const dd=a2(Ye);var Jv={exports:{}},qu={},$v={exports:{}},e1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iw;function VD(){return iw||(iw=1,(function(r){function e(V,_){var G=V.length;V.push(_);e:for(;0<G;){var K=G-1>>>1,z=V[K];if(0<a(z,_))V[K]=_,V[G]=z,G=K;else break e}}function n(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var _=V[0],G=V.pop();if(G!==_){V[0]=G;e:for(var K=0,z=V.length,Y=z>>>1;K<Y;){var Z=2*(K+1)-1,J=V[Z],ee=Z+1,ne=V[ee];if(0>a(J,G))ee<z&&0>a(ne,J)?(V[K]=ne,V[ee]=G,K=ee):(V[K]=J,V[Z]=G,K=Z);else if(ee<z&&0>a(ne,G))V[K]=ne,V[ee]=G,K=ee;else break e}}return _}function a(V,_){var G=V.sortIndex-_.sortIndex;return G!==0?G:V.id-_.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();r.unstable_now=function(){return o.now()-l}}var u=[],c=[],h=1,d=null,v=3,m=!1,y=!1,b=!1,x=!1,A=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function S(V){for(var _=n(c);_!==null;){if(_.callback===null)i(c);else if(_.startTime<=V)i(c),_.sortIndex=_.expirationTime,e(u,_);else break;_=n(c)}}function T(V){if(b=!1,S(V),!y)if(n(u)!==null)y=!0,R||(R=!0,F());else{var _=n(c);_!==null&&L(T,_.startTime-V)}}var R=!1,D=-1,B=5,N=-1;function I(){return x?!0:!(r.unstable_now()-N<B)}function P(){if(x=!1,R){var V=r.unstable_now();N=V;var _=!0;try{e:{y=!1,b&&(b=!1,C(D),D=-1),m=!0;var G=v;try{t:{for(S(V),d=n(u);d!==null&&!(d.expirationTime>V&&I());){var K=d.callback;if(typeof K=="function"){d.callback=null,v=d.priorityLevel;var z=K(d.expirationTime<=V);if(V=r.unstable_now(),typeof z=="function"){d.callback=z,S(V),_=!0;break t}d===n(u)&&i(u),S(V)}else i(u);d=n(u)}if(d!==null)_=!0;else{var Y=n(c);Y!==null&&L(T,Y.startTime-V),_=!1}}break e}finally{d=null,v=G,m=!1}_=void 0}}finally{_?F():R=!1}}}var F;if(typeof E=="function")F=function(){E(P)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,U=O.port2;O.port1.onmessage=P,F=function(){U.postMessage(null)}}else F=function(){A(P,0)};function L(V,_){D=A(function(){V(r.unstable_now())},_)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_next=function(V){switch(v){case 1:case 2:case 3:var _=3;break;default:_=v}var G=v;v=_;try{return V()}finally{v=G}},r.unstable_requestPaint=function(){x=!0},r.unstable_runWithPriority=function(V,_){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var G=v;v=V;try{return _()}finally{v=G}},r.unstable_scheduleCallback=function(V,_,G){var K=r.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?K+G:K):G=K,V){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=G+z,V={id:h++,callback:_,priorityLevel:V,startTime:G,expirationTime:z,sortIndex:-1},G>K?(V.sortIndex=G,e(c,V),n(u)===null&&V===n(c)&&(b?(C(D),D=-1):b=!0,L(T,G-K))):(V.sortIndex=z,e(u,V),y||m||(y=!0,R||(R=!0,F()))),V},r.unstable_shouldYield=I,r.unstable_wrapCallback=function(V){var _=v;return function(){var G=v;v=_;try{return V.apply(this,arguments)}finally{v=G}}}})(e1)),e1}var aw;function OD(){return aw||(aw=1,$v.exports=VD()),$v.exports}var t1={exports:{}},nn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sw;function LD(){if(sw)return nn;sw=1;var r=s2();function e(u){var c="https://react.dev/errors/"+u;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+u+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(u,c,h){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:d==null?null:""+d,children:u,containerInfo:c,implementation:h}}var o=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,c){if(u==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return nn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,nn.createPortal=function(u,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return s(u,c,null,h)},nn.flushSync=function(u){var c=o.T,h=i.p;try{if(o.T=null,i.p=2,u)return u()}finally{o.T=c,i.p=h,i.d.f()}},nn.preconnect=function(u,c){typeof u=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,i.d.C(u,c))},nn.prefetchDNS=function(u){typeof u=="string"&&i.d.D(u)},nn.preinit=function(u,c){if(typeof u=="string"&&c&&typeof c.as=="string"){var h=c.as,d=l(h,c.crossOrigin),v=typeof c.integrity=="string"?c.integrity:void 0,m=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;h==="style"?i.d.S(u,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:v,fetchPriority:m}):h==="script"&&i.d.X(u,{crossOrigin:d,integrity:v,fetchPriority:m,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},nn.preinitModule=function(u,c){if(typeof u=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var h=l(c.as,c.crossOrigin);i.d.M(u,{crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&i.d.M(u)},nn.preload=function(u,c){if(typeof u=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var h=c.as,d=l(h,c.crossOrigin);i.d.L(u,h,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},nn.preloadModule=function(u,c){if(typeof u=="string")if(c){var h=l(c.as,c.crossOrigin);i.d.m(u,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else i.d.m(u)},nn.requestFormReset=function(u){i.d.r(u)},nn.unstable_batchedUpdates=function(u,c){return u(c)},nn.useFormState=function(u,c,h){return o.H.useFormState(u,c,h)},nn.useFormStatus=function(){return o.H.useHostTransitionStatus()},nn.version="19.1.1",nn}var ow;function _D(){if(ow)return t1.exports;ow=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),t1.exports=LD(),t1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lw;function zD(){if(lw)return qu;lw=1;var r=OD(),e=s2(),n=_D();function i(f){var g="https://react.dev/errors/"+f;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)g+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function s(f){var g=f,p=f;if(f.alternate)for(;g.return;)g=g.return;else{f=g;do g=f,(g.flags&4098)!==0&&(p=g.return),f=g.return;while(f)}return g.tag===3?p:null}function o(f){if(f.tag===13){var g=f.memoizedState;if(g===null&&(f=f.alternate,f!==null&&(g=f.memoizedState)),g!==null)return g.dehydrated}return null}function l(f){if(s(f)!==f)throw Error(i(188))}function u(f){var g=f.alternate;if(!g){if(g=s(f),g===null)throw Error(i(188));return g!==f?null:f}for(var p=f,w=g;;){var M=p.return;if(M===null)break;var k=M.alternate;if(k===null){if(w=M.return,w!==null){p=w;continue}break}if(M.child===k.child){for(k=M.child;k;){if(k===p)return l(M),f;if(k===w)return l(M),g;k=k.sibling}throw Error(i(188))}if(p.return!==w.return)p=M,w=k;else{for(var q=!1,H=M.child;H;){if(H===p){q=!0,p=M,w=k;break}if(H===w){q=!0,w=M,p=k;break}H=H.sibling}if(!q){for(H=k.child;H;){if(H===p){q=!0,p=k,w=M;break}if(H===w){q=!0,w=k,p=M;break}H=H.sibling}if(!q)throw Error(i(189))}}if(p.alternate!==w)throw Error(i(190))}if(p.tag!==3)throw Error(i(188));return p.stateNode.current===p?f:g}function c(f){var g=f.tag;if(g===5||g===26||g===27||g===6)return f;for(f=f.child;f!==null;){if(g=c(f),g!==null)return g;f=f.sibling}return null}var h=Object.assign,d=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),E=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function F(f){return f===null||typeof f!="object"?null:(f=P&&f[P]||f["@@iterator"],typeof f=="function"?f:null)}var O=Symbol.for("react.client.reference");function U(f){if(f==null)return null;if(typeof f=="function")return f.$$typeof===O?null:f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case y:return"Fragment";case x:return"Profiler";case b:return"StrictMode";case T:return"Suspense";case R:return"SuspenseList";case N:return"Activity"}if(typeof f=="object")switch(f.$$typeof){case m:return"Portal";case E:return(f.displayName||"Context")+".Provider";case C:return(f._context.displayName||"Context")+".Consumer";case S:var g=f.render;return f=f.displayName,f||(f=g.displayName||g.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case D:return g=f.displayName||null,g!==null?g:U(f.type)||"Memo";case B:g=f._payload,f=f._init;try{return U(f(g))}catch{}}return null}var L=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G={pending:!1,data:null,method:null,action:null},K=[],z=-1;function Y(f){return{current:f}}function Z(f){0>z||(f.current=K[z],K[z]=null,z--)}function J(f,g){z++,K[z]=f.current,f.current=g}var ee=Y(null),ne=Y(null),oe=Y(null),me=Y(null);function ye(f,g){switch(J(oe,g),J(ne,f),J(ee,null),g.nodeType){case 9:case 11:f=(f=g.documentElement)&&(f=f.namespaceURI)?Db(f):0;break;default:if(f=g.tagName,g=g.namespaceURI)g=Db(g),f=Rb(g,f);else switch(f){case"svg":f=1;break;case"math":f=2;break;default:f=0}}Z(ee),J(ee,f)}function ve(){Z(ee),Z(ne),Z(oe)}function re(f){f.memoizedState!==null&&J(me,f);var g=ee.current,p=Rb(g,f.type);g!==p&&(J(ne,f),J(ee,p))}function ae(f){ne.current===f&&(Z(ee),Z(ne)),me.current===f&&(Z(me),Uu._currentValue=G)}var le=Object.prototype.hasOwnProperty,Ae=r.unstable_scheduleCallback,Re=r.unstable_cancelCallback,Le=r.unstable_shouldYield,bt=r.unstable_requestPaint,He=r.unstable_now,$e=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,Ie=r.unstable_UserBlockingPriority,_e=r.unstable_NormalPriority,je=r.unstable_LowPriority,it=r.unstable_IdlePriority,Xe=r.log,ht=r.unstable_setDisableYieldValue,vt=null,ot=null;function pt(f){if(typeof Xe=="function"&&ht(f),ot&&typeof ot.setStrictMode=="function")try{ot.setStrictMode(vt,f)}catch{}}var lt=Math.clz32?Math.clz32:be,at=Math.log,Pe=Math.LN2;function be(f){return f>>>=0,f===0?32:31-(at(f)/Pe|0)|0}var X=256,ce=4194304;function ge(f){var g=f&42;if(g!==0)return g;switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return f&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return f}}function pe(f,g,p){var w=f.pendingLanes;if(w===0)return 0;var M=0,k=f.suspendedLanes,q=f.pingedLanes;f=f.warmLanes;var H=w&134217727;return H!==0?(w=H&~k,w!==0?M=ge(w):(q&=H,q!==0?M=ge(q):p||(p=H&~f,p!==0&&(M=ge(p))))):(H=w&~k,H!==0?M=ge(H):q!==0?M=ge(q):p||(p=w&~f,p!==0&&(M=ge(p)))),M===0?0:g!==0&&g!==M&&(g&k)===0&&(k=M&-M,p=g&-g,k>=p||k===32&&(p&4194048)!==0)?g:M}function xe(f,g){return(f.pendingLanes&~(f.suspendedLanes&~f.pingedLanes)&g)===0}function Fe(f,g){switch(f){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Se(){var f=X;return X<<=1,(X&4194048)===0&&(X=256),f}function ze(){var f=ce;return ce<<=1,(ce&62914560)===0&&(ce=4194304),f}function ke(f){for(var g=[],p=0;31>p;p++)g.push(f);return g}function Ke(f,g){f.pendingLanes|=g,g!==268435456&&(f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0)}function mt(f,g,p,w,M,k){var q=f.pendingLanes;f.pendingLanes=p,f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0,f.expiredLanes&=p,f.entangledLanes&=p,f.errorRecoveryDisabledLanes&=p,f.shellSuspendCounter=0;var H=f.entanglements,$=f.expirationTimes,fe=f.hiddenUpdates;for(p=q&~p;0<p;){var we=31-lt(p),Ee=1<<we;H[we]=0,$[we]=-1;var he=fe[we];if(he!==null)for(fe[we]=null,we=0;we<he.length;we++){var de=he[we];de!==null&&(de.lane&=-536870913)}p&=~Ee}w!==0&&ct(f,w,0),k!==0&&M===0&&f.tag!==0&&(f.suspendedLanes|=k&~(q&~g))}function ct(f,g,p){f.pendingLanes|=g,f.suspendedLanes&=~g;var w=31-lt(g);f.entangledLanes|=g,f.entanglements[w]=f.entanglements[w]|1073741824|p&4194090}function qe(f,g){var p=f.entangledLanes|=g;for(f=f.entanglements;p;){var w=31-lt(p),M=1<<w;M&g|f[w]&g&&(f[w]|=g),p&=~M}}function dt(f){switch(f){case 2:f=1;break;case 8:f=4;break;case 32:f=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:f=128;break;case 268435456:f=134217728;break;default:f=0}return f}function ft(f){return f&=-f,2<f?8<f?(f&134217727)!==0?32:268435456:8:2}function vr(){var f=_.p;return f!==0?f:(f=window.event,f===void 0?32:Xb(f.type))}function ar(f,g){var p=_.p;try{return _.p=f,g()}finally{_.p=p}}var sr=Math.random().toString(36).slice(2),wt="__reactFiber$"+sr,Dt="__reactProps$"+sr,Wt="__reactContainer$"+sr,br="__reactEvents$"+sr,Mi="__reactListeners$"+sr,mr="__reactHandles$"+sr,Xn="__reactResources$"+sr,un="__reactMarker$"+sr;function Di(f){delete f[wt],delete f[Dt],delete f[br],delete f[Mi],delete f[mr]}function fi(f){var g=f[wt];if(g)return g;for(var p=f.parentNode;p;){if(g=p[Wt]||p[wt]){if(p=g.alternate,g.child!==null||p!==null&&p.child!==null)for(f=Fb(f);f!==null;){if(p=f[wt])return p;f=Fb(f)}return g}f=p,p=f.parentNode}return null}function bn(f){if(f=f[wt]||f[Wt]){var g=f.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return f}return null}function Sr(f){var g=f.tag;if(g===5||g===26||g===27||g===6)return f.stateNode;throw Error(i(33))}function hr(f){var g=f[Xn];return g||(g=f[Xn]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function Rt(f){f[un]=!0}var Ma=new Set,cn={};function Ri(f,g){Da(f,g),Da(f+"Capture",g)}function Da(f,g){for(cn[f]=g,f=0;f<g.length;f++)Ma.add(g[f])}var Y0=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Cf={},Ef={};function H0(f){return le.call(Ef,f)?!0:le.call(Cf,f)?!1:Y0.test(f)?Ef[f]=!0:(Cf[f]=!0,!1)}function Co(f,g,p){if(H0(g))if(p===null)f.removeAttribute(g);else{switch(typeof p){case"undefined":case"function":case"symbol":f.removeAttribute(g);return;case"boolean":var w=g.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){f.removeAttribute(g);return}}f.setAttribute(g,""+p)}}function Eo(f,g,p){if(p===null)f.removeAttribute(g);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(g);return}f.setAttribute(g,""+p)}}function fn(f,g,p,w){if(w===null)f.removeAttribute(p);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(p);return}f.setAttributeNS(g,p,""+w)}}var Ds,Rs;function Wi(f){if(Ds===void 0)try{throw Error()}catch(p){var g=p.stack.trim().match(/\n( *(at )?)/);Ds=g&&g[1]||"",Rs=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ds+f+Rs}var So=!1;function Xl(f,g){if(!f||So)return"";So=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(g){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(de){var he=de}Reflect.construct(f,[],Ee)}else{try{Ee.call()}catch(de){he=de}f.call(Ee.prototype)}}else{try{throw Error()}catch(de){he=de}(Ee=f())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(de){if(de&&he&&typeof de.stack=="string")return[de.stack,he.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=w.DetermineComponentFrameRoot(),q=k[0],H=k[1];if(q&&H){var $=q.split(`
`),fe=H.split(`
`);for(M=w=0;w<$.length&&!$[w].includes("DetermineComponentFrameRoot");)w++;for(;M<fe.length&&!fe[M].includes("DetermineComponentFrameRoot");)M++;if(w===$.length||M===fe.length)for(w=$.length-1,M=fe.length-1;1<=w&&0<=M&&$[w]!==fe[M];)M--;for(;1<=w&&0<=M;w--,M--)if($[w]!==fe[M]){if(w!==1||M!==1)do if(w--,M--,0>M||$[w]!==fe[M]){var we=`
`+$[w].replace(" at new "," at ");return f.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",f.displayName)),we}while(1<=w&&0<=M);break}}}finally{So=!1,Error.prepareStackTrace=p}return(p=f?f.displayName||f.name:"")?Wi(p):""}function Fn(f){switch(f.tag){case 26:case 27:case 5:return Wi(f.type);case 16:return Wi("Lazy");case 13:return Wi("Suspense");case 19:return Wi("SuspenseList");case 0:case 15:return Xl(f.type,!1);case 11:return Xl(f.type.render,!1);case 1:return Xl(f.type,!0);case 31:return Wi("Activity");default:return""}}function To(f){try{var g="";do g+=Fn(f),f=f.return;while(f);return g}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function hn(f){switch(typeof f){case"bigint":case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function Ra(f){var g=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function kn(f){var g=Ra(f)?"checked":"value",p=Object.getOwnPropertyDescriptor(f.constructor.prototype,g),w=""+f[g];if(!f.hasOwnProperty(g)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var M=p.get,k=p.set;return Object.defineProperty(f,g,{configurable:!0,get:function(){return M.call(this)},set:function(q){w=""+q,k.call(this,q)}}),Object.defineProperty(f,g,{enumerable:p.enumerable}),{getValue:function(){return w},setValue:function(q){w=""+q},stopTracking:function(){f._valueTracker=null,delete f[g]}}}}function Mo(f){f._valueTracker||(f._valueTracker=kn(f))}function j0(f){if(!f)return!1;var g=f._valueTracker;if(!g)return!0;var p=g.getValue(),w="";return f&&(w=Ra(f)?f.checked?"true":"false":f.value),f=w,f!==p?(g.setValue(f),!0):!1}function Do(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}var BT=/[\n"\\]/g;function Qn(f){return f.replace(BT,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function K0(f,g,p,w,M,k,q,H){f.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?f.type=q:f.removeAttribute("type"),g!=null?q==="number"?(g===0&&f.value===""||f.value!=g)&&(f.value=""+hn(g)):f.value!==""+hn(g)&&(f.value=""+hn(g)):q!=="submit"&&q!=="reset"||f.removeAttribute("value"),g!=null?X0(f,q,hn(g)):p!=null?X0(f,q,hn(p)):w!=null&&f.removeAttribute("value"),M==null&&k!=null&&(f.defaultChecked=!!k),M!=null&&(f.checked=M&&typeof M!="function"&&typeof M!="symbol"),H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?f.name=""+hn(H):f.removeAttribute("name")}function Sy(f,g,p,w,M,k,q,H){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(f.type=k),g!=null||p!=null){if(!(k!=="submit"&&k!=="reset"||g!=null))return;p=p!=null?""+hn(p):"",g=g!=null?""+hn(g):p,H||g===f.value||(f.value=g),f.defaultValue=g}w=w??M,w=typeof w!="function"&&typeof w!="symbol"&&!!w,f.checked=H?f.checked:!!w,f.defaultChecked=!!w,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(f.name=q)}function X0(f,g,p){g==="number"&&Do(f.ownerDocument)===f||f.defaultValue===""+p||(f.defaultValue=""+p)}function Ro(f,g,p,w){if(f=f.options,g){g={};for(var M=0;M<p.length;M++)g["$"+p[M]]=!0;for(p=0;p<f.length;p++)M=g.hasOwnProperty("$"+f[p].value),f[p].selected!==M&&(f[p].selected=M),M&&w&&(f[p].defaultSelected=!0)}else{for(p=""+hn(p),g=null,M=0;M<f.length;M++){if(f[M].value===p){f[M].selected=!0,w&&(f[M].defaultSelected=!0);return}g!==null||f[M].disabled||(g=f[M])}g!==null&&(g.selected=!0)}}function Ty(f,g,p){if(g!=null&&(g=""+hn(g),g!==f.value&&(f.value=g),p==null)){f.defaultValue!==g&&(f.defaultValue=g);return}f.defaultValue=p!=null?""+hn(p):""}function My(f,g,p,w){if(g==null){if(w!=null){if(p!=null)throw Error(i(92));if(L(w)){if(1<w.length)throw Error(i(93));w=w[0]}p=w}p==null&&(p=""),g=p}p=hn(g),f.defaultValue=p,w=f.textContent,w===p&&w!==""&&w!==null&&(f.value=w)}function Bo(f,g){if(g){var p=f.firstChild;if(p&&p===f.lastChild&&p.nodeType===3){p.nodeValue=g;return}}f.textContent=g}var IT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Dy(f,g,p){var w=g.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?w?f.setProperty(g,""):g==="float"?f.cssFloat="":f[g]="":w?f.setProperty(g,p):typeof p!="number"||p===0||IT.has(g)?g==="float"?f.cssFloat=p:f[g]=(""+p).trim():f[g]=p+"px"}function Ry(f,g,p){if(g!=null&&typeof g!="object")throw Error(i(62));if(f=f.style,p!=null){for(var w in p)!p.hasOwnProperty(w)||g!=null&&g.hasOwnProperty(w)||(w.indexOf("--")===0?f.setProperty(w,""):w==="float"?f.cssFloat="":f[w]="");for(var M in g)w=g[M],g.hasOwnProperty(M)&&p[M]!==w&&Dy(f,M,w)}else for(var k in g)g.hasOwnProperty(k)&&Dy(f,k,g[k])}function Q0(f){if(f.indexOf("-")===-1)return!1;switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var NT=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),FT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Sf(f){return FT.test(""+f)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":f}var W0=null;function Z0(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Io=null,No=null;function By(f){var g=bn(f);if(g&&(f=g.stateNode)){var p=f[Dt]||null;e:switch(f=g.stateNode,g.type){case"input":if(K0(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),g=p.name,p.type==="radio"&&g!=null){for(p=f;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Qn(""+g)+'"][type="radio"]'),g=0;g<p.length;g++){var w=p[g];if(w!==f&&w.form===f.form){var M=w[Dt]||null;if(!M)throw Error(i(90));K0(w,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(g=0;g<p.length;g++)w=p[g],w.form===f.form&&j0(w)}break e;case"textarea":Ty(f,p.value,p.defaultValue);break e;case"select":g=p.value,g!=null&&Ro(f,!!p.multiple,g,!1)}}}var J0=!1;function Iy(f,g,p){if(J0)return f(g,p);J0=!0;try{var w=f(g);return w}finally{if(J0=!1,(Io!==null||No!==null)&&(ch(),Io&&(g=Io,f=No,No=Io=null,By(g),f)))for(g=0;g<f.length;g++)By(f[g])}}function Ql(f,g){var p=f.stateNode;if(p===null)return null;var w=p[Dt]||null;if(w===null)return null;p=w[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(f=f.type,w=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!w;break e;default:f=!1}if(f)return null;if(p&&typeof p!="function")throw Error(i(231,g,typeof p));return p}var Zi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$0=!1;if(Zi)try{var Wl={};Object.defineProperty(Wl,"passive",{get:function(){$0=!0}}),window.addEventListener("test",Wl,Wl),window.removeEventListener("test",Wl,Wl)}catch{$0=!1}var Ba=null,eg=null,Tf=null;function Ny(){if(Tf)return Tf;var f,g=eg,p=g.length,w,M="value"in Ba?Ba.value:Ba.textContent,k=M.length;for(f=0;f<p&&g[f]===M[f];f++);var q=p-f;for(w=1;w<=q&&g[p-w]===M[k-w];w++);return Tf=M.slice(f,1<w?1-w:void 0)}function Mf(f){var g=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&g===13&&(f=13)):f=g,f===10&&(f=13),32<=f||f===13?f:0}function Df(){return!0}function Fy(){return!1}function wn(f){function g(p,w,M,k,q){this._reactName=p,this._targetInst=M,this.type=w,this.nativeEvent=k,this.target=q,this.currentTarget=null;for(var H in f)f.hasOwnProperty(H)&&(p=f[H],this[H]=p?p(k):k[H]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Df:Fy,this.isPropagationStopped=Fy,this}return h(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Df)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Df)},persist:function(){},isPersistent:Df}),g}var Bs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rf=wn(Bs),Zl=h({},Bs,{view:0,detail:0}),kT=wn(Zl),tg,rg,Jl,Bf=h({},Zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ig,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==Jl&&(Jl&&f.type==="mousemove"?(tg=f.screenX-Jl.screenX,rg=f.screenY-Jl.screenY):rg=tg=0,Jl=f),tg)},movementY:function(f){return"movementY"in f?f.movementY:rg}}),ky=wn(Bf),PT=h({},Bf,{dataTransfer:0}),UT=wn(PT),VT=h({},Zl,{relatedTarget:0}),ng=wn(VT),OT=h({},Bs,{animationName:0,elapsedTime:0,pseudoElement:0}),LT=wn(OT),_T=h({},Bs,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),zT=wn(_T),qT=h({},Bs,{data:0}),Py=wn(qT),GT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},YT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jT(f){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(f):(f=HT[f])?!!g[f]:!1}function ig(){return jT}var KT=h({},Zl,{key:function(f){if(f.key){var g=GT[f.key]||f.key;if(g!=="Unidentified")return g}return f.type==="keypress"?(f=Mf(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?YT[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ig,charCode:function(f){return f.type==="keypress"?Mf(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?Mf(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),XT=wn(KT),QT=h({},Bf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uy=wn(QT),WT=h({},Zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ig}),ZT=wn(WT),JT=h({},Bs,{propertyName:0,elapsedTime:0,pseudoElement:0}),$T=wn(JT),eM=h({},Bf,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),tM=wn(eM),rM=h({},Bs,{newState:0,oldState:0}),nM=wn(rM),iM=[9,13,27,32],ag=Zi&&"CompositionEvent"in window,$l=null;Zi&&"documentMode"in document&&($l=document.documentMode);var aM=Zi&&"TextEvent"in window&&!$l,Vy=Zi&&(!ag||$l&&8<$l&&11>=$l),Oy=" ",Ly=!1;function _y(f,g){switch(f){case"keyup":return iM.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zy(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Fo=!1;function sM(f,g){switch(f){case"compositionend":return zy(g);case"keypress":return g.which!==32?null:(Ly=!0,Oy);case"textInput":return f=g.data,f===Oy&&Ly?null:f;default:return null}}function oM(f,g){if(Fo)return f==="compositionend"||!ag&&_y(f,g)?(f=Ny(),Tf=eg=Ba=null,Fo=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Vy&&g.locale!=="ko"?null:g.data;default:return null}}var lM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qy(f){var g=f&&f.nodeName&&f.nodeName.toLowerCase();return g==="input"?!!lM[f.type]:g==="textarea"}function Gy(f,g,p,w){Io?No?No.push(w):No=[w]:Io=w,g=mh(g,"onChange"),0<g.length&&(p=new Rf("onChange","change",null,p,w),f.push({event:p,listeners:g}))}var eu=null,tu=null;function uM(f){Cb(f,0)}function If(f){var g=Sr(f);if(j0(g))return f}function Yy(f,g){if(f==="change")return g}var Hy=!1;if(Zi){var sg;if(Zi){var og="oninput"in document;if(!og){var jy=document.createElement("div");jy.setAttribute("oninput","return;"),og=typeof jy.oninput=="function"}sg=og}else sg=!1;Hy=sg&&(!document.documentMode||9<document.documentMode)}function Ky(){eu&&(eu.detachEvent("onpropertychange",Xy),tu=eu=null)}function Xy(f){if(f.propertyName==="value"&&If(tu)){var g=[];Gy(g,tu,f,Z0(f)),Iy(uM,g)}}function cM(f,g,p){f==="focusin"?(Ky(),eu=g,tu=p,eu.attachEvent("onpropertychange",Xy)):f==="focusout"&&Ky()}function fM(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return If(tu)}function hM(f,g){if(f==="click")return If(g)}function dM(f,g){if(f==="input"||f==="change")return If(g)}function gM(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var Pn=typeof Object.is=="function"?Object.is:gM;function ru(f,g){if(Pn(f,g))return!0;if(typeof f!="object"||f===null||typeof g!="object"||g===null)return!1;var p=Object.keys(f),w=Object.keys(g);if(p.length!==w.length)return!1;for(w=0;w<p.length;w++){var M=p[w];if(!le.call(g,M)||!Pn(f[M],g[M]))return!1}return!0}function Qy(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function Wy(f,g){var p=Qy(f);f=0;for(var w;p;){if(p.nodeType===3){if(w=f+p.textContent.length,f<=g&&w>=g)return{node:p,offset:g-f};f=w}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Qy(p)}}function Zy(f,g){return f&&g?f===g?!0:f&&f.nodeType===3?!1:g&&g.nodeType===3?Zy(f,g.parentNode):"contains"in f?f.contains(g):f.compareDocumentPosition?!!(f.compareDocumentPosition(g)&16):!1:!1}function Jy(f){f=f!=null&&f.ownerDocument!=null&&f.ownerDocument.defaultView!=null?f.ownerDocument.defaultView:window;for(var g=Do(f.document);g instanceof f.HTMLIFrameElement;){try{var p=typeof g.contentWindow.location.href=="string"}catch{p=!1}if(p)f=g.contentWindow;else break;g=Do(f.document)}return g}function lg(f){var g=f&&f.nodeName&&f.nodeName.toLowerCase();return g&&(g==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||g==="textarea"||f.contentEditable==="true")}var vM=Zi&&"documentMode"in document&&11>=document.documentMode,ko=null,ug=null,nu=null,cg=!1;function $y(f,g,p){var w=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;cg||ko==null||ko!==Do(w)||(w=ko,"selectionStart"in w&&lg(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),nu&&ru(nu,w)||(nu=w,w=mh(ug,"onSelect"),0<w.length&&(g=new Rf("onSelect","select",null,g,p),f.push({event:g,listeners:w}),g.target=ko)))}function Is(f,g){var p={};return p[f.toLowerCase()]=g.toLowerCase(),p["Webkit"+f]="webkit"+g,p["Moz"+f]="moz"+g,p}var Po={animationend:Is("Animation","AnimationEnd"),animationiteration:Is("Animation","AnimationIteration"),animationstart:Is("Animation","AnimationStart"),transitionrun:Is("Transition","TransitionRun"),transitionstart:Is("Transition","TransitionStart"),transitioncancel:Is("Transition","TransitionCancel"),transitionend:Is("Transition","TransitionEnd")},fg={},eA={};Zi&&(eA=document.createElement("div").style,"AnimationEvent"in window||(delete Po.animationend.animation,delete Po.animationiteration.animation,delete Po.animationstart.animation),"TransitionEvent"in window||delete Po.transitionend.transition);function Ns(f){if(fg[f])return fg[f];if(!Po[f])return f;var g=Po[f],p;for(p in g)if(g.hasOwnProperty(p)&&p in eA)return fg[f]=g[p];return f}var tA=Ns("animationend"),rA=Ns("animationiteration"),nA=Ns("animationstart"),mM=Ns("transitionrun"),pM=Ns("transitionstart"),yM=Ns("transitioncancel"),iA=Ns("transitionend"),aA=new Map,hg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hg.push("scrollEnd");function hi(f,g){aA.set(f,g),Ri(g,[f])}var sA=new WeakMap;function Wn(f,g){if(typeof f=="object"&&f!==null){var p=sA.get(f);return p!==void 0?p:(g={value:f,source:g,stack:To(g)},sA.set(f,g),g)}return{value:f,source:g,stack:To(g)}}var Zn=[],Uo=0,dg=0;function Nf(){for(var f=Uo,g=dg=Uo=0;g<f;){var p=Zn[g];Zn[g++]=null;var w=Zn[g];Zn[g++]=null;var M=Zn[g];Zn[g++]=null;var k=Zn[g];if(Zn[g++]=null,w!==null&&M!==null){var q=w.pending;q===null?M.next=M:(M.next=q.next,q.next=M),w.pending=M}k!==0&&oA(p,M,k)}}function Ff(f,g,p,w){Zn[Uo++]=f,Zn[Uo++]=g,Zn[Uo++]=p,Zn[Uo++]=w,dg|=w,f.lanes|=w,f=f.alternate,f!==null&&(f.lanes|=w)}function gg(f,g,p,w){return Ff(f,g,p,w),kf(f)}function Vo(f,g){return Ff(f,null,null,g),kf(f)}function oA(f,g,p){f.lanes|=p;var w=f.alternate;w!==null&&(w.lanes|=p);for(var M=!1,k=f.return;k!==null;)k.childLanes|=p,w=k.alternate,w!==null&&(w.childLanes|=p),k.tag===22&&(f=k.stateNode,f===null||f._visibility&1||(M=!0)),f=k,k=k.return;return f.tag===3?(k=f.stateNode,M&&g!==null&&(M=31-lt(p),f=k.hiddenUpdates,w=f[M],w===null?f[M]=[g]:w.push(g),g.lane=p|536870912),k):null}function kf(f){if(50<Du)throw Du=0,xv=null,Error(i(185));for(var g=f.return;g!==null;)f=g,g=f.return;return f.tag===3?f.stateNode:null}var Oo={};function AM(f,g,p,w){this.tag=f,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(f,g,p,w){return new AM(f,g,p,w)}function vg(f){return f=f.prototype,!(!f||!f.isReactComponent)}function Ji(f,g){var p=f.alternate;return p===null?(p=Un(f.tag,g,f.key,f.mode),p.elementType=f.elementType,p.type=f.type,p.stateNode=f.stateNode,p.alternate=f,f.alternate=p):(p.pendingProps=g,p.type=f.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=f.flags&65011712,p.childLanes=f.childLanes,p.lanes=f.lanes,p.child=f.child,p.memoizedProps=f.memoizedProps,p.memoizedState=f.memoizedState,p.updateQueue=f.updateQueue,g=f.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},p.sibling=f.sibling,p.index=f.index,p.ref=f.ref,p.refCleanup=f.refCleanup,p}function lA(f,g){f.flags&=65011714;var p=f.alternate;return p===null?(f.childLanes=0,f.lanes=g,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=p.childLanes,f.lanes=p.lanes,f.child=p.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=p.memoizedProps,f.memoizedState=p.memoizedState,f.updateQueue=p.updateQueue,f.type=p.type,g=p.dependencies,f.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),f}function Pf(f,g,p,w,M,k){var q=0;if(w=f,typeof f=="function")vg(f)&&(q=1);else if(typeof f=="string")q=bD(f,p,ee.current)?26:f==="html"||f==="head"||f==="body"?27:5;else e:switch(f){case N:return f=Un(31,p,g,M),f.elementType=N,f.lanes=k,f;case y:return Fs(p.children,M,k,g);case b:q=8,M|=24;break;case x:return f=Un(12,p,g,M|2),f.elementType=x,f.lanes=k,f;case T:return f=Un(13,p,g,M),f.elementType=T,f.lanes=k,f;case R:return f=Un(19,p,g,M),f.elementType=R,f.lanes=k,f;default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case A:case E:q=10;break e;case C:q=9;break e;case S:q=11;break e;case D:q=14;break e;case B:q=16,w=null;break e}q=29,p=Error(i(130,f===null?"null":typeof f,"")),w=null}return g=Un(q,p,g,M),g.elementType=f,g.type=w,g.lanes=k,g}function Fs(f,g,p,w){return f=Un(7,f,w,g),f.lanes=p,f}function mg(f,g,p){return f=Un(6,f,null,g),f.lanes=p,f}function pg(f,g,p){return g=Un(4,f.children!==null?f.children:[],f.key,g),g.lanes=p,g.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},g}var Lo=[],_o=0,Uf=null,Vf=0,Jn=[],$n=0,ks=null,$i=1,ea="";function Ps(f,g){Lo[_o++]=Vf,Lo[_o++]=Uf,Uf=f,Vf=g}function uA(f,g,p){Jn[$n++]=$i,Jn[$n++]=ea,Jn[$n++]=ks,ks=f;var w=$i;f=ea;var M=32-lt(w)-1;w&=~(1<<M),p+=1;var k=32-lt(g)+M;if(30<k){var q=M-M%5;k=(w&(1<<q)-1).toString(32),w>>=q,M-=q,$i=1<<32-lt(g)+M|p<<M|w,ea=k+f}else $i=1<<k|p<<M|w,ea=f}function yg(f){f.return!==null&&(Ps(f,1),uA(f,1,0))}function Ag(f){for(;f===Uf;)Uf=Lo[--_o],Lo[_o]=null,Vf=Lo[--_o],Lo[_o]=null;for(;f===ks;)ks=Jn[--$n],Jn[$n]=null,ea=Jn[--$n],Jn[$n]=null,$i=Jn[--$n],Jn[$n]=null}var dn=null,pr=null,Pt=!1,Us=null,Bi=!1,xg=Error(i(519));function Vs(f){var g=Error(i(418,""));throw su(Wn(g,f)),xg}function cA(f){var g=f.stateNode,p=f.type,w=f.memoizedProps;switch(g[wt]=f,g[Dt]=w,p){case"dialog":Et("cancel",g),Et("close",g);break;case"iframe":case"object":case"embed":Et("load",g);break;case"video":case"audio":for(p=0;p<Bu.length;p++)Et(Bu[p],g);break;case"source":Et("error",g);break;case"img":case"image":case"link":Et("error",g),Et("load",g);break;case"details":Et("toggle",g);break;case"input":Et("invalid",g),Sy(g,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0),Mo(g);break;case"select":Et("invalid",g);break;case"textarea":Et("invalid",g),My(g,w.value,w.defaultValue,w.children),Mo(g)}p=w.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||g.textContent===""+p||w.suppressHydrationWarning===!0||Mb(g.textContent,p)?(w.popover!=null&&(Et("beforetoggle",g),Et("toggle",g)),w.onScroll!=null&&Et("scroll",g),w.onScrollEnd!=null&&Et("scrollend",g),w.onClick!=null&&(g.onclick=ph),g=!0):g=!1,g||Vs(f)}function fA(f){for(dn=f.return;dn;)switch(dn.tag){case 5:case 13:Bi=!1;return;case 27:case 3:Bi=!0;return;default:dn=dn.return}}function iu(f){if(f!==dn)return!1;if(!Pt)return fA(f),Pt=!0,!1;var g=f.tag,p;if((p=g!==3&&g!==27)&&((p=g===5)&&(p=f.type,p=!(p!=="form"&&p!=="button")||Uv(f.type,f.memoizedProps)),p=!p),p&&pr&&Vs(f),fA(f),g===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));e:{for(f=f.nextSibling,g=0;f;){if(f.nodeType===8)if(p=f.data,p==="/$"){if(g===0){pr=gi(f.nextSibling);break e}g--}else p!=="$"&&p!=="$!"&&p!=="$?"||g++;f=f.nextSibling}pr=null}}else g===27?(g=pr,ja(f.type)?(f=_v,_v=null,pr=f):pr=g):pr=dn?gi(f.stateNode.nextSibling):null;return!0}function au(){pr=dn=null,Pt=!1}function hA(){var f=Us;return f!==null&&(Sn===null?Sn=f:Sn.push.apply(Sn,f),Us=null),f}function su(f){Us===null?Us=[f]:Us.push(f)}var bg=Y(null),Os=null,ta=null;function Ia(f,g,p){J(bg,g._currentValue),g._currentValue=p}function ra(f){f._currentValue=bg.current,Z(bg)}function wg(f,g,p){for(;f!==null;){var w=f.alternate;if((f.childLanes&g)!==g?(f.childLanes|=g,w!==null&&(w.childLanes|=g)):w!==null&&(w.childLanes&g)!==g&&(w.childLanes|=g),f===p)break;f=f.return}}function Cg(f,g,p,w){var M=f.child;for(M!==null&&(M.return=f);M!==null;){var k=M.dependencies;if(k!==null){var q=M.child;k=k.firstContext;e:for(;k!==null;){var H=k;k=M;for(var $=0;$<g.length;$++)if(H.context===g[$]){k.lanes|=p,H=k.alternate,H!==null&&(H.lanes|=p),wg(k.return,p,f),w||(q=null);break e}k=H.next}}else if(M.tag===18){if(q=M.return,q===null)throw Error(i(341));q.lanes|=p,k=q.alternate,k!==null&&(k.lanes|=p),wg(q,p,f),q=null}else q=M.child;if(q!==null)q.return=M;else for(q=M;q!==null;){if(q===f){q=null;break}if(M=q.sibling,M!==null){M.return=q.return,q=M;break}q=q.return}M=q}}function ou(f,g,p,w){f=null;for(var M=g,k=!1;M!==null;){if(!k){if((M.flags&524288)!==0)k=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var q=M.alternate;if(q===null)throw Error(i(387));if(q=q.memoizedProps,q!==null){var H=M.type;Pn(M.pendingProps.value,q.value)||(f!==null?f.push(H):f=[H])}}else if(M===me.current){if(q=M.alternate,q===null)throw Error(i(387));q.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(f!==null?f.push(Uu):f=[Uu])}M=M.return}f!==null&&Cg(g,f,p,w),g.flags|=262144}function Of(f){for(f=f.firstContext;f!==null;){if(!Pn(f.context._currentValue,f.memoizedValue))return!0;f=f.next}return!1}function Ls(f){Os=f,ta=null,f=f.dependencies,f!==null&&(f.firstContext=null)}function rn(f){return dA(Os,f)}function Lf(f,g){return Os===null&&Ls(f),dA(f,g)}function dA(f,g){var p=g._currentValue;if(g={context:g,memoizedValue:p,next:null},ta===null){if(f===null)throw Error(i(308));ta=g,f.dependencies={lanes:0,firstContext:g},f.flags|=524288}else ta=ta.next=g;return p}var xM=typeof AbortController<"u"?AbortController:function(){var f=[],g=this.signal={aborted:!1,addEventListener:function(p,w){f.push(w)}};this.abort=function(){g.aborted=!0,f.forEach(function(p){return p()})}},bM=r.unstable_scheduleCallback,wM=r.unstable_NormalPriority,Br={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Eg(){return{controller:new xM,data:new Map,refCount:0}}function lu(f){f.refCount--,f.refCount===0&&bM(wM,function(){f.controller.abort()})}var uu=null,Sg=0,zo=0,qo=null;function CM(f,g){if(uu===null){var p=uu=[];Sg=0,zo=Mv(),qo={status:"pending",value:void 0,then:function(w){p.push(w)}}}return Sg++,g.then(gA,gA),g}function gA(){if(--Sg===0&&uu!==null){qo!==null&&(qo.status="fulfilled");var f=uu;uu=null,zo=0,qo=null;for(var g=0;g<f.length;g++)(0,f[g])()}}function EM(f,g){var p=[],w={status:"pending",value:null,reason:null,then:function(M){p.push(M)}};return f.then(function(){w.status="fulfilled",w.value=g;for(var M=0;M<p.length;M++)(0,p[M])(g)},function(M){for(w.status="rejected",w.reason=M,M=0;M<p.length;M++)(0,p[M])(void 0)}),w}var vA=V.S;V.S=function(f,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&CM(f,g),vA!==null&&vA(f,g)};var _s=Y(null);function Tg(){var f=_s.current;return f!==null?f:Zt.pooledCache}function _f(f,g){g===null?J(_s,_s.current):J(_s,g.pool)}function mA(){var f=Tg();return f===null?null:{parent:Br._currentValue,pool:f}}var cu=Error(i(460)),pA=Error(i(474)),zf=Error(i(542)),Mg={then:function(){}};function yA(f){return f=f.status,f==="fulfilled"||f==="rejected"}function qf(){}function AA(f,g,p){switch(p=f[p],p===void 0?f.push(g):p!==g&&(g.then(qf,qf),g=p),g.status){case"fulfilled":return g.value;case"rejected":throw f=g.reason,bA(f),f;default:if(typeof g.status=="string")g.then(qf,qf);else{if(f=Zt,f!==null&&100<f.shellSuspendCounter)throw Error(i(482));f=g,f.status="pending",f.then(function(w){if(g.status==="pending"){var M=g;M.status="fulfilled",M.value=w}},function(w){if(g.status==="pending"){var M=g;M.status="rejected",M.reason=w}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw f=g.reason,bA(f),f}throw fu=g,cu}}var fu=null;function xA(){if(fu===null)throw Error(i(459));var f=fu;return fu=null,f}function bA(f){if(f===cu||f===zf)throw Error(i(483))}var Na=!1;function Dg(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Rg(f,g){f=f.updateQueue,g.updateQueue===f&&(g.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,callbacks:null})}function Fa(f){return{lane:f,tag:0,payload:null,callback:null,next:null}}function ka(f,g,p){var w=f.updateQueue;if(w===null)return null;if(w=w.shared,(_t&2)!==0){var M=w.pending;return M===null?g.next=g:(g.next=M.next,M.next=g),w.pending=g,g=kf(f),oA(f,null,p),g}return Ff(f,w,g,p),kf(f)}function hu(f,g,p){if(g=g.updateQueue,g!==null&&(g=g.shared,(p&4194048)!==0)){var w=g.lanes;w&=f.pendingLanes,p|=w,g.lanes=p,qe(f,p)}}function Bg(f,g){var p=f.updateQueue,w=f.alternate;if(w!==null&&(w=w.updateQueue,p===w)){var M=null,k=null;if(p=p.firstBaseUpdate,p!==null){do{var q={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};k===null?M=k=q:k=k.next=q,p=p.next}while(p!==null);k===null?M=k=g:k=k.next=g}else M=k=g;p={baseState:w.baseState,firstBaseUpdate:M,lastBaseUpdate:k,shared:w.shared,callbacks:w.callbacks},f.updateQueue=p;return}f=p.lastBaseUpdate,f===null?p.firstBaseUpdate=g:f.next=g,p.lastBaseUpdate=g}var Ig=!1;function du(){if(Ig){var f=qo;if(f!==null)throw f}}function gu(f,g,p,w){Ig=!1;var M=f.updateQueue;Na=!1;var k=M.firstBaseUpdate,q=M.lastBaseUpdate,H=M.shared.pending;if(H!==null){M.shared.pending=null;var $=H,fe=$.next;$.next=null,q===null?k=fe:q.next=fe,q=$;var we=f.alternate;we!==null&&(we=we.updateQueue,H=we.lastBaseUpdate,H!==q&&(H===null?we.firstBaseUpdate=fe:H.next=fe,we.lastBaseUpdate=$))}if(k!==null){var Ee=M.baseState;q=0,we=fe=$=null,H=k;do{var he=H.lane&-536870913,de=he!==H.lane;if(de?(Mt&he)===he:(w&he)===he){he!==0&&he===zo&&(Ig=!0),we!==null&&(we=we.next={lane:0,tag:H.tag,payload:H.payload,callback:null,next:null});e:{var st=f,tt=H;he=g;var Yt=p;switch(tt.tag){case 1:if(st=tt.payload,typeof st=="function"){Ee=st.call(Yt,Ee,he);break e}Ee=st;break e;case 3:st.flags=st.flags&-65537|128;case 0:if(st=tt.payload,he=typeof st=="function"?st.call(Yt,Ee,he):st,he==null)break e;Ee=h({},Ee,he);break e;case 2:Na=!0}}he=H.callback,he!==null&&(f.flags|=64,de&&(f.flags|=8192),de=M.callbacks,de===null?M.callbacks=[he]:de.push(he))}else de={lane:he,tag:H.tag,payload:H.payload,callback:H.callback,next:null},we===null?(fe=we=de,$=Ee):we=we.next=de,q|=he;if(H=H.next,H===null){if(H=M.shared.pending,H===null)break;de=H,H=de.next,de.next=null,M.lastBaseUpdate=de,M.shared.pending=null}}while(!0);we===null&&($=Ee),M.baseState=$,M.firstBaseUpdate=fe,M.lastBaseUpdate=we,k===null&&(M.shared.lanes=0),qa|=q,f.lanes=q,f.memoizedState=Ee}}function wA(f,g){if(typeof f!="function")throw Error(i(191,f));f.call(g)}function CA(f,g){var p=f.callbacks;if(p!==null)for(f.callbacks=null,f=0;f<p.length;f++)wA(p[f],g)}var Go=Y(null),Gf=Y(0);function EA(f,g){f=ua,J(Gf,f),J(Go,g),ua=f|g.baseLanes}function Ng(){J(Gf,ua),J(Go,Go.current)}function Fg(){ua=Gf.current,Z(Go),Z(Gf)}var Pa=0,yt=null,qt=null,Tr=null,Yf=!1,Yo=!1,zs=!1,Hf=0,vu=0,Ho=null,SM=0;function wr(){throw Error(i(321))}function kg(f,g){if(g===null)return!1;for(var p=0;p<g.length&&p<f.length;p++)if(!Pn(f[p],g[p]))return!1;return!0}function Pg(f,g,p,w,M,k){return Pa=k,yt=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,V.H=f===null||f.memoizedState===null?ox:lx,zs=!1,k=p(w,M),zs=!1,Yo&&(k=TA(g,p,w,M)),SA(f),k}function SA(f){V.H=Zf;var g=qt!==null&&qt.next!==null;if(Pa=0,Tr=qt=yt=null,Yf=!1,vu=0,Ho=null,g)throw Error(i(300));f===null||Vr||(f=f.dependencies,f!==null&&Of(f)&&(Vr=!0))}function TA(f,g,p,w){yt=f;var M=0;do{if(Yo&&(Ho=null),vu=0,Yo=!1,25<=M)throw Error(i(301));if(M+=1,Tr=qt=null,f.updateQueue!=null){var k=f.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}V.H=NM,k=g(p,w)}while(Yo);return k}function TM(){var f=V.H,g=f.useState()[0];return g=typeof g.then=="function"?mu(g):g,f=f.useState()[0],(qt!==null?qt.memoizedState:null)!==f&&(yt.flags|=1024),g}function Ug(){var f=Hf!==0;return Hf=0,f}function Vg(f,g,p){g.updateQueue=f.updateQueue,g.flags&=-2053,f.lanes&=~p}function Og(f){if(Yf){for(f=f.memoizedState;f!==null;){var g=f.queue;g!==null&&(g.pending=null),f=f.next}Yf=!1}Pa=0,Tr=qt=yt=null,Yo=!1,vu=Hf=0,Ho=null}function Cn(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tr===null?yt.memoizedState=Tr=f:Tr=Tr.next=f,Tr}function Mr(){if(qt===null){var f=yt.alternate;f=f!==null?f.memoizedState:null}else f=qt.next;var g=Tr===null?yt.memoizedState:Tr.next;if(g!==null)Tr=g,qt=f;else{if(f===null)throw yt.alternate===null?Error(i(467)):Error(i(310));qt=f,f={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},Tr===null?yt.memoizedState=Tr=f:Tr=Tr.next=f}return Tr}function Lg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mu(f){var g=vu;return vu+=1,Ho===null&&(Ho=[]),f=AA(Ho,f,g),g=yt,(Tr===null?g.memoizedState:Tr.next)===null&&(g=g.alternate,V.H=g===null||g.memoizedState===null?ox:lx),f}function jf(f){if(f!==null&&typeof f=="object"){if(typeof f.then=="function")return mu(f);if(f.$$typeof===E)return rn(f)}throw Error(i(438,String(f)))}function _g(f){var g=null,p=yt.updateQueue;if(p!==null&&(g=p.memoCache),g==null){var w=yt.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(g={data:w.data.map(function(M){return M.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),p===null&&(p=Lg(),yt.updateQueue=p),p.memoCache=g,p=g.data[g.index],p===void 0)for(p=g.data[g.index]=Array(f),w=0;w<f;w++)p[w]=I;return g.index++,p}function na(f,g){return typeof g=="function"?g(f):g}function Kf(f){var g=Mr();return zg(g,qt,f)}function zg(f,g,p){var w=f.queue;if(w===null)throw Error(i(311));w.lastRenderedReducer=p;var M=f.baseQueue,k=w.pending;if(k!==null){if(M!==null){var q=M.next;M.next=k.next,k.next=q}g.baseQueue=M=k,w.pending=null}if(k=f.baseState,M===null)f.memoizedState=k;else{g=M.next;var H=q=null,$=null,fe=g,we=!1;do{var Ee=fe.lane&-536870913;if(Ee!==fe.lane?(Mt&Ee)===Ee:(Pa&Ee)===Ee){var he=fe.revertLane;if(he===0)$!==null&&($=$.next={lane:0,revertLane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),Ee===zo&&(we=!0);else if((Pa&he)===he){fe=fe.next,he===zo&&(we=!0);continue}else Ee={lane:0,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},$===null?(H=$=Ee,q=k):$=$.next=Ee,yt.lanes|=he,qa|=he;Ee=fe.action,zs&&p(k,Ee),k=fe.hasEagerState?fe.eagerState:p(k,Ee)}else he={lane:Ee,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},$===null?(H=$=he,q=k):$=$.next=he,yt.lanes|=Ee,qa|=Ee;fe=fe.next}while(fe!==null&&fe!==g);if($===null?q=k:$.next=H,!Pn(k,f.memoizedState)&&(Vr=!0,we&&(p=qo,p!==null)))throw p;f.memoizedState=k,f.baseState=q,f.baseQueue=$,w.lastRenderedState=k}return M===null&&(w.lanes=0),[f.memoizedState,w.dispatch]}function qg(f){var g=Mr(),p=g.queue;if(p===null)throw Error(i(311));p.lastRenderedReducer=f;var w=p.dispatch,M=p.pending,k=g.memoizedState;if(M!==null){p.pending=null;var q=M=M.next;do k=f(k,q.action),q=q.next;while(q!==M);Pn(k,g.memoizedState)||(Vr=!0),g.memoizedState=k,g.baseQueue===null&&(g.baseState=k),p.lastRenderedState=k}return[k,w]}function MA(f,g,p){var w=yt,M=Mr(),k=Pt;if(k){if(p===void 0)throw Error(i(407));p=p()}else p=g();var q=!Pn((qt||M).memoizedState,p);q&&(M.memoizedState=p,Vr=!0),M=M.queue;var H=BA.bind(null,w,M,f);if(pu(2048,8,H,[f]),M.getSnapshot!==g||q||Tr!==null&&Tr.memoizedState.tag&1){if(w.flags|=2048,jo(9,Xf(),RA.bind(null,w,M,p,g),null),Zt===null)throw Error(i(349));k||(Pa&124)!==0||DA(w,g,p)}return p}function DA(f,g,p){f.flags|=16384,f={getSnapshot:g,value:p},g=yt.updateQueue,g===null?(g=Lg(),yt.updateQueue=g,g.stores=[f]):(p=g.stores,p===null?g.stores=[f]:p.push(f))}function RA(f,g,p,w){g.value=p,g.getSnapshot=w,IA(g)&&NA(f)}function BA(f,g,p){return p(function(){IA(g)&&NA(f)})}function IA(f){var g=f.getSnapshot;f=f.value;try{var p=g();return!Pn(f,p)}catch{return!0}}function NA(f){var g=Vo(f,2);g!==null&&zn(g,f,2)}function Gg(f){var g=Cn();if(typeof f=="function"){var p=f;if(f=p(),zs){pt(!0);try{p()}finally{pt(!1)}}}return g.memoizedState=g.baseState=f,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:na,lastRenderedState:f},g}function FA(f,g,p,w){return f.baseState=p,zg(f,qt,typeof w=="function"?w:na)}function MM(f,g,p,w,M){if(Wf(f))throw Error(i(485));if(f=g.action,f!==null){var k={payload:M,action:f,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){k.listeners.push(q)}};V.T!==null?p(!0):k.isTransition=!1,w(k),p=g.pending,p===null?(k.next=g.pending=k,kA(g,k)):(k.next=p.next,g.pending=p.next=k)}}function kA(f,g){var p=g.action,w=g.payload,M=f.state;if(g.isTransition){var k=V.T,q={};V.T=q;try{var H=p(M,w),$=V.S;$!==null&&$(q,H),PA(f,g,H)}catch(fe){Yg(f,g,fe)}finally{V.T=k}}else try{k=p(M,w),PA(f,g,k)}catch(fe){Yg(f,g,fe)}}function PA(f,g,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(w){UA(f,g,w)},function(w){return Yg(f,g,w)}):UA(f,g,p)}function UA(f,g,p){g.status="fulfilled",g.value=p,VA(g),f.state=p,g=f.pending,g!==null&&(p=g.next,p===g?f.pending=null:(p=p.next,g.next=p,kA(f,p)))}function Yg(f,g,p){var w=f.pending;if(f.pending=null,w!==null){w=w.next;do g.status="rejected",g.reason=p,VA(g),g=g.next;while(g!==w)}f.action=null}function VA(f){f=f.listeners;for(var g=0;g<f.length;g++)(0,f[g])()}function OA(f,g){return g}function LA(f,g){if(Pt){var p=Zt.formState;if(p!==null){e:{var w=yt;if(Pt){if(pr){t:{for(var M=pr,k=Bi;M.nodeType!==8;){if(!k){M=null;break t}if(M=gi(M.nextSibling),M===null){M=null;break t}}k=M.data,M=k==="F!"||k==="F"?M:null}if(M){pr=gi(M.nextSibling),w=M.data==="F!";break e}}Vs(w)}w=!1}w&&(g=p[0])}}return p=Cn(),p.memoizedState=p.baseState=g,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:OA,lastRenderedState:g},p.queue=w,p=ix.bind(null,yt,w),w.dispatch=p,w=Gg(!1),k=Qg.bind(null,yt,!1,w.queue),w=Cn(),M={state:g,dispatch:null,action:f,pending:null},w.queue=M,p=MM.bind(null,yt,M,k,p),M.dispatch=p,w.memoizedState=f,[g,p,!1]}function _A(f){var g=Mr();return zA(g,qt,f)}function zA(f,g,p){if(g=zg(f,g,OA)[0],f=Kf(na)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var w=mu(g)}catch(q){throw q===cu?zf:q}else w=g;g=Mr();var M=g.queue,k=M.dispatch;return p!==g.memoizedState&&(yt.flags|=2048,jo(9,Xf(),DM.bind(null,M,p),null)),[w,k,f]}function DM(f,g){f.action=g}function qA(f){var g=Mr(),p=qt;if(p!==null)return zA(g,p,f);Mr(),g=g.memoizedState,p=Mr();var w=p.queue.dispatch;return p.memoizedState=f,[g,w,!1]}function jo(f,g,p,w){return f={tag:f,create:p,deps:w,inst:g,next:null},g=yt.updateQueue,g===null&&(g=Lg(),yt.updateQueue=g),p=g.lastEffect,p===null?g.lastEffect=f.next=f:(w=p.next,p.next=f,f.next=w,g.lastEffect=f),f}function Xf(){return{destroy:void 0,resource:void 0}}function GA(){return Mr().memoizedState}function Qf(f,g,p,w){var M=Cn();w=w===void 0?null:w,yt.flags|=f,M.memoizedState=jo(1|g,Xf(),p,w)}function pu(f,g,p,w){var M=Mr();w=w===void 0?null:w;var k=M.memoizedState.inst;qt!==null&&w!==null&&kg(w,qt.memoizedState.deps)?M.memoizedState=jo(g,k,p,w):(yt.flags|=f,M.memoizedState=jo(1|g,k,p,w))}function YA(f,g){Qf(8390656,8,f,g)}function HA(f,g){pu(2048,8,f,g)}function jA(f,g){return pu(4,2,f,g)}function KA(f,g){return pu(4,4,f,g)}function XA(f,g){if(typeof g=="function"){f=f();var p=g(f);return function(){typeof p=="function"?p():g(null)}}if(g!=null)return f=f(),g.current=f,function(){g.current=null}}function QA(f,g,p){p=p!=null?p.concat([f]):null,pu(4,4,XA.bind(null,g,f),p)}function Hg(){}function WA(f,g){var p=Mr();g=g===void 0?null:g;var w=p.memoizedState;return g!==null&&kg(g,w[1])?w[0]:(p.memoizedState=[f,g],f)}function ZA(f,g){var p=Mr();g=g===void 0?null:g;var w=p.memoizedState;if(g!==null&&kg(g,w[1]))return w[0];if(w=f(),zs){pt(!0);try{f()}finally{pt(!1)}}return p.memoizedState=[w,g],w}function jg(f,g,p){return p===void 0||(Pa&1073741824)!==0?f.memoizedState=g:(f.memoizedState=p,f=eb(),yt.lanes|=f,qa|=f,p)}function JA(f,g,p,w){return Pn(p,g)?p:Go.current!==null?(f=jg(f,p,w),Pn(f,g)||(Vr=!0),f):(Pa&42)===0?(Vr=!0,f.memoizedState=p):(f=eb(),yt.lanes|=f,qa|=f,g)}function $A(f,g,p,w,M){var k=_.p;_.p=k!==0&&8>k?k:8;var q=V.T,H={};V.T=H,Qg(f,!1,g,p);try{var $=M(),fe=V.S;if(fe!==null&&fe(H,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var we=EM($,w);yu(f,g,we,_n(f))}else yu(f,g,w,_n(f))}catch(Ee){yu(f,g,{then:function(){},status:"rejected",reason:Ee},_n())}finally{_.p=k,V.T=q}}function RM(){}function Kg(f,g,p,w){if(f.tag!==5)throw Error(i(476));var M=ex(f).queue;$A(f,M,g,G,p===null?RM:function(){return tx(f),p(w)})}function ex(f){var g=f.memoizedState;if(g!==null)return g;g={memoizedState:G,baseState:G,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:na,lastRenderedState:G},next:null};var p={};return g.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:na,lastRenderedState:p},next:null},f.memoizedState=g,f=f.alternate,f!==null&&(f.memoizedState=g),g}function tx(f){var g=ex(f).next.queue;yu(f,g,{},_n())}function Xg(){return rn(Uu)}function rx(){return Mr().memoizedState}function nx(){return Mr().memoizedState}function BM(f){for(var g=f.return;g!==null;){switch(g.tag){case 24:case 3:var p=_n();f=Fa(p);var w=ka(g,f,p);w!==null&&(zn(w,g,p),hu(w,g,p)),g={cache:Eg()},f.payload=g;return}g=g.return}}function IM(f,g,p){var w=_n();p={lane:w,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Wf(f)?ax(g,p):(p=gg(f,g,p,w),p!==null&&(zn(p,f,w),sx(p,g,w)))}function ix(f,g,p){var w=_n();yu(f,g,p,w)}function yu(f,g,p,w){var M={lane:w,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Wf(f))ax(g,M);else{var k=f.alternate;if(f.lanes===0&&(k===null||k.lanes===0)&&(k=g.lastRenderedReducer,k!==null))try{var q=g.lastRenderedState,H=k(q,p);if(M.hasEagerState=!0,M.eagerState=H,Pn(H,q))return Ff(f,g,M,0),Zt===null&&Nf(),!1}catch{}finally{}if(p=gg(f,g,M,w),p!==null)return zn(p,f,w),sx(p,g,w),!0}return!1}function Qg(f,g,p,w){if(w={lane:2,revertLane:Mv(),action:w,hasEagerState:!1,eagerState:null,next:null},Wf(f)){if(g)throw Error(i(479))}else g=gg(f,p,w,2),g!==null&&zn(g,f,2)}function Wf(f){var g=f.alternate;return f===yt||g!==null&&g===yt}function ax(f,g){Yo=Yf=!0;var p=f.pending;p===null?g.next=g:(g.next=p.next,p.next=g),f.pending=g}function sx(f,g,p){if((p&4194048)!==0){var w=g.lanes;w&=f.pendingLanes,p|=w,g.lanes=p,qe(f,p)}}var Zf={readContext:rn,use:jf,useCallback:wr,useContext:wr,useEffect:wr,useImperativeHandle:wr,useLayoutEffect:wr,useInsertionEffect:wr,useMemo:wr,useReducer:wr,useRef:wr,useState:wr,useDebugValue:wr,useDeferredValue:wr,useTransition:wr,useSyncExternalStore:wr,useId:wr,useHostTransitionStatus:wr,useFormState:wr,useActionState:wr,useOptimistic:wr,useMemoCache:wr,useCacheRefresh:wr},ox={readContext:rn,use:jf,useCallback:function(f,g){return Cn().memoizedState=[f,g===void 0?null:g],f},useContext:rn,useEffect:YA,useImperativeHandle:function(f,g,p){p=p!=null?p.concat([f]):null,Qf(4194308,4,XA.bind(null,g,f),p)},useLayoutEffect:function(f,g){return Qf(4194308,4,f,g)},useInsertionEffect:function(f,g){Qf(4,2,f,g)},useMemo:function(f,g){var p=Cn();g=g===void 0?null:g;var w=f();if(zs){pt(!0);try{f()}finally{pt(!1)}}return p.memoizedState=[w,g],w},useReducer:function(f,g,p){var w=Cn();if(p!==void 0){var M=p(g);if(zs){pt(!0);try{p(g)}finally{pt(!1)}}}else M=g;return w.memoizedState=w.baseState=M,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:M},w.queue=f,f=f.dispatch=IM.bind(null,yt,f),[w.memoizedState,f]},useRef:function(f){var g=Cn();return f={current:f},g.memoizedState=f},useState:function(f){f=Gg(f);var g=f.queue,p=ix.bind(null,yt,g);return g.dispatch=p,[f.memoizedState,p]},useDebugValue:Hg,useDeferredValue:function(f,g){var p=Cn();return jg(p,f,g)},useTransition:function(){var f=Gg(!1);return f=$A.bind(null,yt,f.queue,!0,!1),Cn().memoizedState=f,[!1,f]},useSyncExternalStore:function(f,g,p){var w=yt,M=Cn();if(Pt){if(p===void 0)throw Error(i(407));p=p()}else{if(p=g(),Zt===null)throw Error(i(349));(Mt&124)!==0||DA(w,g,p)}M.memoizedState=p;var k={value:p,getSnapshot:g};return M.queue=k,YA(BA.bind(null,w,k,f),[f]),w.flags|=2048,jo(9,Xf(),RA.bind(null,w,k,p,g),null),p},useId:function(){var f=Cn(),g=Zt.identifierPrefix;if(Pt){var p=ea,w=$i;p=(w&~(1<<32-lt(w)-1)).toString(32)+p,g="«"+g+"R"+p,p=Hf++,0<p&&(g+="H"+p.toString(32)),g+="»"}else p=SM++,g="«"+g+"r"+p.toString(32)+"»";return f.memoizedState=g},useHostTransitionStatus:Xg,useFormState:LA,useActionState:LA,useOptimistic:function(f){var g=Cn();g.memoizedState=g.baseState=f;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=p,g=Qg.bind(null,yt,!0,p),p.dispatch=g,[f,g]},useMemoCache:_g,useCacheRefresh:function(){return Cn().memoizedState=BM.bind(null,yt)}},lx={readContext:rn,use:jf,useCallback:WA,useContext:rn,useEffect:HA,useImperativeHandle:QA,useInsertionEffect:jA,useLayoutEffect:KA,useMemo:ZA,useReducer:Kf,useRef:GA,useState:function(){return Kf(na)},useDebugValue:Hg,useDeferredValue:function(f,g){var p=Mr();return JA(p,qt.memoizedState,f,g)},useTransition:function(){var f=Kf(na)[0],g=Mr().memoizedState;return[typeof f=="boolean"?f:mu(f),g]},useSyncExternalStore:MA,useId:rx,useHostTransitionStatus:Xg,useFormState:_A,useActionState:_A,useOptimistic:function(f,g){var p=Mr();return FA(p,qt,f,g)},useMemoCache:_g,useCacheRefresh:nx},NM={readContext:rn,use:jf,useCallback:WA,useContext:rn,useEffect:HA,useImperativeHandle:QA,useInsertionEffect:jA,useLayoutEffect:KA,useMemo:ZA,useReducer:qg,useRef:GA,useState:function(){return qg(na)},useDebugValue:Hg,useDeferredValue:function(f,g){var p=Mr();return qt===null?jg(p,f,g):JA(p,qt.memoizedState,f,g)},useTransition:function(){var f=qg(na)[0],g=Mr().memoizedState;return[typeof f=="boolean"?f:mu(f),g]},useSyncExternalStore:MA,useId:rx,useHostTransitionStatus:Xg,useFormState:qA,useActionState:qA,useOptimistic:function(f,g){var p=Mr();return qt!==null?FA(p,qt,f,g):(p.baseState=f,[f,p.queue.dispatch])},useMemoCache:_g,useCacheRefresh:nx},Ko=null,Au=0;function Jf(f){var g=Au;return Au+=1,Ko===null&&(Ko=[]),AA(Ko,f,g)}function xu(f,g){g=g.props.ref,f.ref=g!==void 0?g:null}function $f(f,g){throw g.$$typeof===d?Error(i(525)):(f=Object.prototype.toString.call(g),Error(i(31,f==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":f)))}function ux(f){var g=f._init;return g(f._payload)}function cx(f){function g(se,te){if(f){var ue=se.deletions;ue===null?(se.deletions=[te],se.flags|=16):ue.push(te)}}function p(se,te){if(!f)return null;for(;te!==null;)g(se,te),te=te.sibling;return null}function w(se){for(var te=new Map;se!==null;)se.key!==null?te.set(se.key,se):te.set(se.index,se),se=se.sibling;return te}function M(se,te){return se=Ji(se,te),se.index=0,se.sibling=null,se}function k(se,te,ue){return se.index=ue,f?(ue=se.alternate,ue!==null?(ue=ue.index,ue<te?(se.flags|=67108866,te):ue):(se.flags|=67108866,te)):(se.flags|=1048576,te)}function q(se){return f&&se.alternate===null&&(se.flags|=67108866),se}function H(se,te,ue,Ce){return te===null||te.tag!==6?(te=mg(ue,se.mode,Ce),te.return=se,te):(te=M(te,ue),te.return=se,te)}function $(se,te,ue,Ce){var Ve=ue.type;return Ve===y?we(se,te,ue.props.children,Ce,ue.key):te!==null&&(te.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===B&&ux(Ve)===te.type)?(te=M(te,ue.props),xu(te,ue),te.return=se,te):(te=Pf(ue.type,ue.key,ue.props,null,se.mode,Ce),xu(te,ue),te.return=se,te)}function fe(se,te,ue,Ce){return te===null||te.tag!==4||te.stateNode.containerInfo!==ue.containerInfo||te.stateNode.implementation!==ue.implementation?(te=pg(ue,se.mode,Ce),te.return=se,te):(te=M(te,ue.children||[]),te.return=se,te)}function we(se,te,ue,Ce,Ve){return te===null||te.tag!==7?(te=Fs(ue,se.mode,Ce,Ve),te.return=se,te):(te=M(te,ue),te.return=se,te)}function Ee(se,te,ue){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=mg(""+te,se.mode,ue),te.return=se,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case v:return ue=Pf(te.type,te.key,te.props,null,se.mode,ue),xu(ue,te),ue.return=se,ue;case m:return te=pg(te,se.mode,ue),te.return=se,te;case B:var Ce=te._init;return te=Ce(te._payload),Ee(se,te,ue)}if(L(te)||F(te))return te=Fs(te,se.mode,ue,null),te.return=se,te;if(typeof te.then=="function")return Ee(se,Jf(te),ue);if(te.$$typeof===E)return Ee(se,Lf(se,te),ue);$f(se,te)}return null}function he(se,te,ue,Ce){var Ve=te!==null?te.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return Ve!==null?null:H(se,te,""+ue,Ce);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case v:return ue.key===Ve?$(se,te,ue,Ce):null;case m:return ue.key===Ve?fe(se,te,ue,Ce):null;case B:return Ve=ue._init,ue=Ve(ue._payload),he(se,te,ue,Ce)}if(L(ue)||F(ue))return Ve!==null?null:we(se,te,ue,Ce,null);if(typeof ue.then=="function")return he(se,te,Jf(ue),Ce);if(ue.$$typeof===E)return he(se,te,Lf(se,ue),Ce);$f(se,ue)}return null}function de(se,te,ue,Ce,Ve){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return se=se.get(ue)||null,H(te,se,""+Ce,Ve);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case v:return se=se.get(Ce.key===null?ue:Ce.key)||null,$(te,se,Ce,Ve);case m:return se=se.get(Ce.key===null?ue:Ce.key)||null,fe(te,se,Ce,Ve);case B:var xt=Ce._init;return Ce=xt(Ce._payload),de(se,te,ue,Ce,Ve)}if(L(Ce)||F(Ce))return se=se.get(ue)||null,we(te,se,Ce,Ve,null);if(typeof Ce.then=="function")return de(se,te,ue,Jf(Ce),Ve);if(Ce.$$typeof===E)return de(se,te,ue,Lf(te,Ce),Ve);$f(te,Ce)}return null}function st(se,te,ue,Ce){for(var Ve=null,xt=null,Qe=te,nt=te=0,Lr=null;Qe!==null&&nt<ue.length;nt++){Qe.index>nt?(Lr=Qe,Qe=null):Lr=Qe.sibling;var Nt=he(se,Qe,ue[nt],Ce);if(Nt===null){Qe===null&&(Qe=Lr);break}f&&Qe&&Nt.alternate===null&&g(se,Qe),te=k(Nt,te,nt),xt===null?Ve=Nt:xt.sibling=Nt,xt=Nt,Qe=Lr}if(nt===ue.length)return p(se,Qe),Pt&&Ps(se,nt),Ve;if(Qe===null){for(;nt<ue.length;nt++)Qe=Ee(se,ue[nt],Ce),Qe!==null&&(te=k(Qe,te,nt),xt===null?Ve=Qe:xt.sibling=Qe,xt=Qe);return Pt&&Ps(se,nt),Ve}for(Qe=w(Qe);nt<ue.length;nt++)Lr=de(Qe,se,nt,ue[nt],Ce),Lr!==null&&(f&&Lr.alternate!==null&&Qe.delete(Lr.key===null?nt:Lr.key),te=k(Lr,te,nt),xt===null?Ve=Lr:xt.sibling=Lr,xt=Lr);return f&&Qe.forEach(function(Za){return g(se,Za)}),Pt&&Ps(se,nt),Ve}function tt(se,te,ue,Ce){if(ue==null)throw Error(i(151));for(var Ve=null,xt=null,Qe=te,nt=te=0,Lr=null,Nt=ue.next();Qe!==null&&!Nt.done;nt++,Nt=ue.next()){Qe.index>nt?(Lr=Qe,Qe=null):Lr=Qe.sibling;var Za=he(se,Qe,Nt.value,Ce);if(Za===null){Qe===null&&(Qe=Lr);break}f&&Qe&&Za.alternate===null&&g(se,Qe),te=k(Za,te,nt),xt===null?Ve=Za:xt.sibling=Za,xt=Za,Qe=Lr}if(Nt.done)return p(se,Qe),Pt&&Ps(se,nt),Ve;if(Qe===null){for(;!Nt.done;nt++,Nt=ue.next())Nt=Ee(se,Nt.value,Ce),Nt!==null&&(te=k(Nt,te,nt),xt===null?Ve=Nt:xt.sibling=Nt,xt=Nt);return Pt&&Ps(se,nt),Ve}for(Qe=w(Qe);!Nt.done;nt++,Nt=ue.next())Nt=de(Qe,se,nt,Nt.value,Ce),Nt!==null&&(f&&Nt.alternate!==null&&Qe.delete(Nt.key===null?nt:Nt.key),te=k(Nt,te,nt),xt===null?Ve=Nt:xt.sibling=Nt,xt=Nt);return f&&Qe.forEach(function(FD){return g(se,FD)}),Pt&&Ps(se,nt),Ve}function Yt(se,te,ue,Ce){if(typeof ue=="object"&&ue!==null&&ue.type===y&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case v:e:{for(var Ve=ue.key;te!==null;){if(te.key===Ve){if(Ve=ue.type,Ve===y){if(te.tag===7){p(se,te.sibling),Ce=M(te,ue.props.children),Ce.return=se,se=Ce;break e}}else if(te.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===B&&ux(Ve)===te.type){p(se,te.sibling),Ce=M(te,ue.props),xu(Ce,ue),Ce.return=se,se=Ce;break e}p(se,te);break}else g(se,te);te=te.sibling}ue.type===y?(Ce=Fs(ue.props.children,se.mode,Ce,ue.key),Ce.return=se,se=Ce):(Ce=Pf(ue.type,ue.key,ue.props,null,se.mode,Ce),xu(Ce,ue),Ce.return=se,se=Ce)}return q(se);case m:e:{for(Ve=ue.key;te!==null;){if(te.key===Ve)if(te.tag===4&&te.stateNode.containerInfo===ue.containerInfo&&te.stateNode.implementation===ue.implementation){p(se,te.sibling),Ce=M(te,ue.children||[]),Ce.return=se,se=Ce;break e}else{p(se,te);break}else g(se,te);te=te.sibling}Ce=pg(ue,se.mode,Ce),Ce.return=se,se=Ce}return q(se);case B:return Ve=ue._init,ue=Ve(ue._payload),Yt(se,te,ue,Ce)}if(L(ue))return st(se,te,ue,Ce);if(F(ue)){if(Ve=F(ue),typeof Ve!="function")throw Error(i(150));return ue=Ve.call(ue),tt(se,te,ue,Ce)}if(typeof ue.then=="function")return Yt(se,te,Jf(ue),Ce);if(ue.$$typeof===E)return Yt(se,te,Lf(se,ue),Ce);$f(se,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,te!==null&&te.tag===6?(p(se,te.sibling),Ce=M(te,ue),Ce.return=se,se=Ce):(p(se,te),Ce=mg(ue,se.mode,Ce),Ce.return=se,se=Ce),q(se)):p(se,te)}return function(se,te,ue,Ce){try{Au=0;var Ve=Yt(se,te,ue,Ce);return Ko=null,Ve}catch(Qe){if(Qe===cu||Qe===zf)throw Qe;var xt=Un(29,Qe,null,se.mode);return xt.lanes=Ce,xt.return=se,xt}finally{}}}var Xo=cx(!0),fx=cx(!1),ei=Y(null),Ii=null;function Ua(f){var g=f.alternate;J(Ir,Ir.current&1),J(ei,f),Ii===null&&(g===null||Go.current!==null||g.memoizedState!==null)&&(Ii=f)}function hx(f){if(f.tag===22){if(J(Ir,Ir.current),J(ei,f),Ii===null){var g=f.alternate;g!==null&&g.memoizedState!==null&&(Ii=f)}}else Va()}function Va(){J(Ir,Ir.current),J(ei,ei.current)}function ia(f){Z(ei),Ii===f&&(Ii=null),Z(Ir)}var Ir=Y(0);function eh(f){for(var g=f;g!==null;){if(g.tag===13){var p=g.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||Lv(p)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function Wg(f,g,p,w){g=f.memoizedState,p=p(w,g),p=p==null?g:h({},g,p),f.memoizedState=p,f.lanes===0&&(f.updateQueue.baseState=p)}var Zg={enqueueSetState:function(f,g,p){f=f._reactInternals;var w=_n(),M=Fa(w);M.payload=g,p!=null&&(M.callback=p),g=ka(f,M,w),g!==null&&(zn(g,f,w),hu(g,f,w))},enqueueReplaceState:function(f,g,p){f=f._reactInternals;var w=_n(),M=Fa(w);M.tag=1,M.payload=g,p!=null&&(M.callback=p),g=ka(f,M,w),g!==null&&(zn(g,f,w),hu(g,f,w))},enqueueForceUpdate:function(f,g){f=f._reactInternals;var p=_n(),w=Fa(p);w.tag=2,g!=null&&(w.callback=g),g=ka(f,w,p),g!==null&&(zn(g,f,p),hu(g,f,p))}};function dx(f,g,p,w,M,k,q){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(w,k,q):g.prototype&&g.prototype.isPureReactComponent?!ru(p,w)||!ru(M,k):!0}function gx(f,g,p,w){f=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(p,w),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(p,w),g.state!==f&&Zg.enqueueReplaceState(g,g.state,null)}function qs(f,g){var p=g;if("ref"in g){p={};for(var w in g)w!=="ref"&&(p[w]=g[w])}if(f=f.defaultProps){p===g&&(p=h({},p));for(var M in f)p[M]===void 0&&(p[M]=f[M])}return p}var th=typeof reportError=="function"?reportError:function(f){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof f=="object"&&f!==null&&typeof f.message=="string"?String(f.message):String(f),error:f});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",f);return}console.error(f)};function vx(f){th(f)}function mx(f){console.error(f)}function px(f){th(f)}function rh(f,g){try{var p=f.onUncaughtError;p(g.value,{componentStack:g.stack})}catch(w){setTimeout(function(){throw w})}}function yx(f,g,p){try{var w=f.onCaughtError;w(p.value,{componentStack:p.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function Jg(f,g,p){return p=Fa(p),p.tag=3,p.payload={element:null},p.callback=function(){rh(f,g)},p}function Ax(f){return f=Fa(f),f.tag=3,f}function xx(f,g,p,w){var M=p.type.getDerivedStateFromError;if(typeof M=="function"){var k=w.value;f.payload=function(){return M(k)},f.callback=function(){yx(g,p,w)}}var q=p.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(f.callback=function(){yx(g,p,w),typeof M!="function"&&(Ga===null?Ga=new Set([this]):Ga.add(this));var H=w.stack;this.componentDidCatch(w.value,{componentStack:H!==null?H:""})})}function FM(f,g,p,w,M){if(p.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(g=p.alternate,g!==null&&ou(g,p,M,!0),p=ei.current,p!==null){switch(p.tag){case 13:return Ii===null?wv():p.alternate===null&&yr===0&&(yr=3),p.flags&=-257,p.flags|=65536,p.lanes=M,w===Mg?p.flags|=16384:(g=p.updateQueue,g===null?p.updateQueue=new Set([w]):g.add(w),Ev(f,w,M)),!1;case 22:return p.flags|=65536,w===Mg?p.flags|=16384:(g=p.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([w])},p.updateQueue=g):(p=g.retryQueue,p===null?g.retryQueue=new Set([w]):p.add(w)),Ev(f,w,M)),!1}throw Error(i(435,p.tag))}return Ev(f,w,M),wv(),!1}if(Pt)return g=ei.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=M,w!==xg&&(f=Error(i(422),{cause:w}),su(Wn(f,p)))):(w!==xg&&(g=Error(i(423),{cause:w}),su(Wn(g,p))),f=f.current.alternate,f.flags|=65536,M&=-M,f.lanes|=M,w=Wn(w,p),M=Jg(f.stateNode,w,M),Bg(f,M),yr!==4&&(yr=2)),!1;var k=Error(i(520),{cause:w});if(k=Wn(k,p),Mu===null?Mu=[k]:Mu.push(k),yr!==4&&(yr=2),g===null)return!0;w=Wn(w,p),p=g;do{switch(p.tag){case 3:return p.flags|=65536,f=M&-M,p.lanes|=f,f=Jg(p.stateNode,w,f),Bg(p,f),!1;case 1:if(g=p.type,k=p.stateNode,(p.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Ga===null||!Ga.has(k))))return p.flags|=65536,M&=-M,p.lanes|=M,M=Ax(M),xx(M,f,p,w),Bg(p,M),!1}p=p.return}while(p!==null);return!1}var bx=Error(i(461)),Vr=!1;function Kr(f,g,p,w){g.child=f===null?fx(g,null,p,w):Xo(g,f.child,p,w)}function wx(f,g,p,w,M){p=p.render;var k=g.ref;if("ref"in w){var q={};for(var H in w)H!=="ref"&&(q[H]=w[H])}else q=w;return Ls(g),w=Pg(f,g,p,q,k,M),H=Ug(),f!==null&&!Vr?(Vg(f,g,M),aa(f,g,M)):(Pt&&H&&yg(g),g.flags|=1,Kr(f,g,w,M),g.child)}function Cx(f,g,p,w,M){if(f===null){var k=p.type;return typeof k=="function"&&!vg(k)&&k.defaultProps===void 0&&p.compare===null?(g.tag=15,g.type=k,Ex(f,g,k,w,M)):(f=Pf(p.type,null,w,g,g.mode,M),f.ref=g.ref,f.return=g,g.child=f)}if(k=f.child,!sv(f,M)){var q=k.memoizedProps;if(p=p.compare,p=p!==null?p:ru,p(q,w)&&f.ref===g.ref)return aa(f,g,M)}return g.flags|=1,f=Ji(k,w),f.ref=g.ref,f.return=g,g.child=f}function Ex(f,g,p,w,M){if(f!==null){var k=f.memoizedProps;if(ru(k,w)&&f.ref===g.ref)if(Vr=!1,g.pendingProps=w=k,sv(f,M))(f.flags&131072)!==0&&(Vr=!0);else return g.lanes=f.lanes,aa(f,g,M)}return $g(f,g,p,w,M)}function Sx(f,g,p){var w=g.pendingProps,M=w.children,k=f!==null?f.memoizedState:null;if(w.mode==="hidden"){if((g.flags&128)!==0){if(w=k!==null?k.baseLanes|p:p,f!==null){for(M=g.child=f.child,k=0;M!==null;)k=k|M.lanes|M.childLanes,M=M.sibling;g.childLanes=k&~w}else g.childLanes=0,g.child=null;return Tx(f,g,w,p)}if((p&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},f!==null&&_f(g,k!==null?k.cachePool:null),k!==null?EA(g,k):Ng(),hx(g);else return g.lanes=g.childLanes=536870912,Tx(f,g,k!==null?k.baseLanes|p:p,p)}else k!==null?(_f(g,k.cachePool),EA(g,k),Va(),g.memoizedState=null):(f!==null&&_f(g,null),Ng(),Va());return Kr(f,g,M,p),g.child}function Tx(f,g,p,w){var M=Tg();return M=M===null?null:{parent:Br._currentValue,pool:M},g.memoizedState={baseLanes:p,cachePool:M},f!==null&&_f(g,null),Ng(),hx(g),f!==null&&ou(f,g,w,!0),null}function nh(f,g){var p=g.ref;if(p===null)f!==null&&f.ref!==null&&(g.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(i(284));(f===null||f.ref!==p)&&(g.flags|=4194816)}}function $g(f,g,p,w,M){return Ls(g),p=Pg(f,g,p,w,void 0,M),w=Ug(),f!==null&&!Vr?(Vg(f,g,M),aa(f,g,M)):(Pt&&w&&yg(g),g.flags|=1,Kr(f,g,p,M),g.child)}function Mx(f,g,p,w,M,k){return Ls(g),g.updateQueue=null,p=TA(g,w,p,M),SA(f),w=Ug(),f!==null&&!Vr?(Vg(f,g,k),aa(f,g,k)):(Pt&&w&&yg(g),g.flags|=1,Kr(f,g,p,k),g.child)}function Dx(f,g,p,w,M){if(Ls(g),g.stateNode===null){var k=Oo,q=p.contextType;typeof q=="object"&&q!==null&&(k=rn(q)),k=new p(w,k),g.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=Zg,g.stateNode=k,k._reactInternals=g,k=g.stateNode,k.props=w,k.state=g.memoizedState,k.refs={},Dg(g),q=p.contextType,k.context=typeof q=="object"&&q!==null?rn(q):Oo,k.state=g.memoizedState,q=p.getDerivedStateFromProps,typeof q=="function"&&(Wg(g,p,q,w),k.state=g.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(q=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),q!==k.state&&Zg.enqueueReplaceState(k,k.state,null),gu(g,w,k,M),du(),k.state=g.memoizedState),typeof k.componentDidMount=="function"&&(g.flags|=4194308),w=!0}else if(f===null){k=g.stateNode;var H=g.memoizedProps,$=qs(p,H);k.props=$;var fe=k.context,we=p.contextType;q=Oo,typeof we=="object"&&we!==null&&(q=rn(we));var Ee=p.getDerivedStateFromProps;we=typeof Ee=="function"||typeof k.getSnapshotBeforeUpdate=="function",H=g.pendingProps!==H,we||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(H||fe!==q)&&gx(g,k,w,q),Na=!1;var he=g.memoizedState;k.state=he,gu(g,w,k,M),du(),fe=g.memoizedState,H||he!==fe||Na?(typeof Ee=="function"&&(Wg(g,p,Ee,w),fe=g.memoizedState),($=Na||dx(g,p,$,w,he,fe,q))?(we||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(g.flags|=4194308)):(typeof k.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=w,g.memoizedState=fe),k.props=w,k.state=fe,k.context=q,w=$):(typeof k.componentDidMount=="function"&&(g.flags|=4194308),w=!1)}else{k=g.stateNode,Rg(f,g),q=g.memoizedProps,we=qs(p,q),k.props=we,Ee=g.pendingProps,he=k.context,fe=p.contextType,$=Oo,typeof fe=="object"&&fe!==null&&($=rn(fe)),H=p.getDerivedStateFromProps,(fe=typeof H=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(q!==Ee||he!==$)&&gx(g,k,w,$),Na=!1,he=g.memoizedState,k.state=he,gu(g,w,k,M),du();var de=g.memoizedState;q!==Ee||he!==de||Na||f!==null&&f.dependencies!==null&&Of(f.dependencies)?(typeof H=="function"&&(Wg(g,p,H,w),de=g.memoizedState),(we=Na||dx(g,p,we,w,he,de,$)||f!==null&&f.dependencies!==null&&Of(f.dependencies))?(fe||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(w,de,$),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(w,de,$)),typeof k.componentDidUpdate=="function"&&(g.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof k.componentDidUpdate!="function"||q===f.memoizedProps&&he===f.memoizedState||(g.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||q===f.memoizedProps&&he===f.memoizedState||(g.flags|=1024),g.memoizedProps=w,g.memoizedState=de),k.props=w,k.state=de,k.context=$,w=we):(typeof k.componentDidUpdate!="function"||q===f.memoizedProps&&he===f.memoizedState||(g.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||q===f.memoizedProps&&he===f.memoizedState||(g.flags|=1024),w=!1)}return k=w,nh(f,g),w=(g.flags&128)!==0,k||w?(k=g.stateNode,p=w&&typeof p.getDerivedStateFromError!="function"?null:k.render(),g.flags|=1,f!==null&&w?(g.child=Xo(g,f.child,null,M),g.child=Xo(g,null,p,M)):Kr(f,g,p,M),g.memoizedState=k.state,f=g.child):f=aa(f,g,M),f}function Rx(f,g,p,w){return au(),g.flags|=256,Kr(f,g,p,w),g.child}var ev={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function tv(f){return{baseLanes:f,cachePool:mA()}}function rv(f,g,p){return f=f!==null?f.childLanes&~p:0,g&&(f|=ti),f}function Bx(f,g,p){var w=g.pendingProps,M=!1,k=(g.flags&128)!==0,q;if((q=k)||(q=f!==null&&f.memoizedState===null?!1:(Ir.current&2)!==0),q&&(M=!0,g.flags&=-129),q=(g.flags&32)!==0,g.flags&=-33,f===null){if(Pt){if(M?Ua(g):Va(),Pt){var H=pr,$;if($=H){e:{for($=H,H=Bi;$.nodeType!==8;){if(!H){H=null;break e}if($=gi($.nextSibling),$===null){H=null;break e}}H=$}H!==null?(g.memoizedState={dehydrated:H,treeContext:ks!==null?{id:$i,overflow:ea}:null,retryLane:536870912,hydrationErrors:null},$=Un(18,null,null,0),$.stateNode=H,$.return=g,g.child=$,dn=g,pr=null,$=!0):$=!1}$||Vs(g)}if(H=g.memoizedState,H!==null&&(H=H.dehydrated,H!==null))return Lv(H)?g.lanes=32:g.lanes=536870912,null;ia(g)}return H=w.children,w=w.fallback,M?(Va(),M=g.mode,H=ih({mode:"hidden",children:H},M),w=Fs(w,M,p,null),H.return=g,w.return=g,H.sibling=w,g.child=H,M=g.child,M.memoizedState=tv(p),M.childLanes=rv(f,q,p),g.memoizedState=ev,w):(Ua(g),nv(g,H))}if($=f.memoizedState,$!==null&&(H=$.dehydrated,H!==null)){if(k)g.flags&256?(Ua(g),g.flags&=-257,g=iv(f,g,p)):g.memoizedState!==null?(Va(),g.child=f.child,g.flags|=128,g=null):(Va(),M=w.fallback,H=g.mode,w=ih({mode:"visible",children:w.children},H),M=Fs(M,H,p,null),M.flags|=2,w.return=g,M.return=g,w.sibling=M,g.child=w,Xo(g,f.child,null,p),w=g.child,w.memoizedState=tv(p),w.childLanes=rv(f,q,p),g.memoizedState=ev,g=M);else if(Ua(g),Lv(H)){if(q=H.nextSibling&&H.nextSibling.dataset,q)var fe=q.dgst;q=fe,w=Error(i(419)),w.stack="",w.digest=q,su({value:w,source:null,stack:null}),g=iv(f,g,p)}else if(Vr||ou(f,g,p,!1),q=(p&f.childLanes)!==0,Vr||q){if(q=Zt,q!==null&&(w=p&-p,w=(w&42)!==0?1:dt(w),w=(w&(q.suspendedLanes|p))!==0?0:w,w!==0&&w!==$.retryLane))throw $.retryLane=w,Vo(f,w),zn(q,f,w),bx;H.data==="$?"||wv(),g=iv(f,g,p)}else H.data==="$?"?(g.flags|=192,g.child=f.child,g=null):(f=$.treeContext,pr=gi(H.nextSibling),dn=g,Pt=!0,Us=null,Bi=!1,f!==null&&(Jn[$n++]=$i,Jn[$n++]=ea,Jn[$n++]=ks,$i=f.id,ea=f.overflow,ks=g),g=nv(g,w.children),g.flags|=4096);return g}return M?(Va(),M=w.fallback,H=g.mode,$=f.child,fe=$.sibling,w=Ji($,{mode:"hidden",children:w.children}),w.subtreeFlags=$.subtreeFlags&65011712,fe!==null?M=Ji(fe,M):(M=Fs(M,H,p,null),M.flags|=2),M.return=g,w.return=g,w.sibling=M,g.child=w,w=M,M=g.child,H=f.child.memoizedState,H===null?H=tv(p):($=H.cachePool,$!==null?(fe=Br._currentValue,$=$.parent!==fe?{parent:fe,pool:fe}:$):$=mA(),H={baseLanes:H.baseLanes|p,cachePool:$}),M.memoizedState=H,M.childLanes=rv(f,q,p),g.memoizedState=ev,w):(Ua(g),p=f.child,f=p.sibling,p=Ji(p,{mode:"visible",children:w.children}),p.return=g,p.sibling=null,f!==null&&(q=g.deletions,q===null?(g.deletions=[f],g.flags|=16):q.push(f)),g.child=p,g.memoizedState=null,p)}function nv(f,g){return g=ih({mode:"visible",children:g},f.mode),g.return=f,f.child=g}function ih(f,g){return f=Un(22,f,null,g),f.lanes=0,f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},f}function iv(f,g,p){return Xo(g,f.child,null,p),f=nv(g,g.pendingProps.children),f.flags|=2,g.memoizedState=null,f}function Ix(f,g,p){f.lanes|=g;var w=f.alternate;w!==null&&(w.lanes|=g),wg(f.return,g,p)}function av(f,g,p,w,M){var k=f.memoizedState;k===null?f.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:w,tail:p,tailMode:M}:(k.isBackwards=g,k.rendering=null,k.renderingStartTime=0,k.last=w,k.tail=p,k.tailMode=M)}function Nx(f,g,p){var w=g.pendingProps,M=w.revealOrder,k=w.tail;if(Kr(f,g,w.children,p),w=Ir.current,(w&2)!==0)w=w&1|2,g.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=g.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&Ix(f,p,g);else if(f.tag===19)Ix(f,p,g);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===g)break e;for(;f.sibling===null;){if(f.return===null||f.return===g)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}w&=1}switch(J(Ir,w),M){case"forwards":for(p=g.child,M=null;p!==null;)f=p.alternate,f!==null&&eh(f)===null&&(M=p),p=p.sibling;p=M,p===null?(M=g.child,g.child=null):(M=p.sibling,p.sibling=null),av(g,!1,M,p,k);break;case"backwards":for(p=null,M=g.child,g.child=null;M!==null;){if(f=M.alternate,f!==null&&eh(f)===null){g.child=M;break}f=M.sibling,M.sibling=p,p=M,M=f}av(g,!0,p,null,k);break;case"together":av(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function aa(f,g,p){if(f!==null&&(g.dependencies=f.dependencies),qa|=g.lanes,(p&g.childLanes)===0)if(f!==null){if(ou(f,g,p,!1),(p&g.childLanes)===0)return null}else return null;if(f!==null&&g.child!==f.child)throw Error(i(153));if(g.child!==null){for(f=g.child,p=Ji(f,f.pendingProps),g.child=p,p.return=g;f.sibling!==null;)f=f.sibling,p=p.sibling=Ji(f,f.pendingProps),p.return=g;p.sibling=null}return g.child}function sv(f,g){return(f.lanes&g)!==0?!0:(f=f.dependencies,!!(f!==null&&Of(f)))}function kM(f,g,p){switch(g.tag){case 3:ye(g,g.stateNode.containerInfo),Ia(g,Br,f.memoizedState.cache),au();break;case 27:case 5:re(g);break;case 4:ye(g,g.stateNode.containerInfo);break;case 10:Ia(g,g.type,g.memoizedProps.value);break;case 13:var w=g.memoizedState;if(w!==null)return w.dehydrated!==null?(Ua(g),g.flags|=128,null):(p&g.child.childLanes)!==0?Bx(f,g,p):(Ua(g),f=aa(f,g,p),f!==null?f.sibling:null);Ua(g);break;case 19:var M=(f.flags&128)!==0;if(w=(p&g.childLanes)!==0,w||(ou(f,g,p,!1),w=(p&g.childLanes)!==0),M){if(w)return Nx(f,g,p);g.flags|=128}if(M=g.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),J(Ir,Ir.current),w)break;return null;case 22:case 23:return g.lanes=0,Sx(f,g,p);case 24:Ia(g,Br,f.memoizedState.cache)}return aa(f,g,p)}function Fx(f,g,p){if(f!==null)if(f.memoizedProps!==g.pendingProps)Vr=!0;else{if(!sv(f,p)&&(g.flags&128)===0)return Vr=!1,kM(f,g,p);Vr=(f.flags&131072)!==0}else Vr=!1,Pt&&(g.flags&1048576)!==0&&uA(g,Vf,g.index);switch(g.lanes=0,g.tag){case 16:e:{f=g.pendingProps;var w=g.elementType,M=w._init;if(w=M(w._payload),g.type=w,typeof w=="function")vg(w)?(f=qs(w,f),g.tag=1,g=Dx(null,g,w,f,p)):(g.tag=0,g=$g(null,g,w,f,p));else{if(w!=null){if(M=w.$$typeof,M===S){g.tag=11,g=wx(null,g,w,f,p);break e}else if(M===D){g.tag=14,g=Cx(null,g,w,f,p);break e}}throw g=U(w)||w,Error(i(306,g,""))}}return g;case 0:return $g(f,g,g.type,g.pendingProps,p);case 1:return w=g.type,M=qs(w,g.pendingProps),Dx(f,g,w,M,p);case 3:e:{if(ye(g,g.stateNode.containerInfo),f===null)throw Error(i(387));w=g.pendingProps;var k=g.memoizedState;M=k.element,Rg(f,g),gu(g,w,null,p);var q=g.memoizedState;if(w=q.cache,Ia(g,Br,w),w!==k.cache&&Cg(g,[Br],p,!0),du(),w=q.element,k.isDehydrated)if(k={element:w,isDehydrated:!1,cache:q.cache},g.updateQueue.baseState=k,g.memoizedState=k,g.flags&256){g=Rx(f,g,w,p);break e}else if(w!==M){M=Wn(Error(i(424)),g),su(M),g=Rx(f,g,w,p);break e}else{switch(f=g.stateNode.containerInfo,f.nodeType){case 9:f=f.body;break;default:f=f.nodeName==="HTML"?f.ownerDocument.body:f}for(pr=gi(f.firstChild),dn=g,Pt=!0,Us=null,Bi=!0,p=fx(g,null,w,p),g.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(au(),w===M){g=aa(f,g,p);break e}Kr(f,g,w,p)}g=g.child}return g;case 26:return nh(f,g),f===null?(p=Vb(g.type,null,g.pendingProps,null))?g.memoizedState=p:Pt||(p=g.type,f=g.pendingProps,w=yh(oe.current).createElement(p),w[wt]=g,w[Dt]=f,Qr(w,p,f),Rt(w),g.stateNode=w):g.memoizedState=Vb(g.type,f.memoizedProps,g.pendingProps,f.memoizedState),null;case 27:return re(g),f===null&&Pt&&(w=g.stateNode=kb(g.type,g.pendingProps,oe.current),dn=g,Bi=!0,M=pr,ja(g.type)?(_v=M,pr=gi(w.firstChild)):pr=M),Kr(f,g,g.pendingProps.children,p),nh(f,g),f===null&&(g.flags|=4194304),g.child;case 5:return f===null&&Pt&&((M=w=pr)&&(w=lD(w,g.type,g.pendingProps,Bi),w!==null?(g.stateNode=w,dn=g,pr=gi(w.firstChild),Bi=!1,M=!0):M=!1),M||Vs(g)),re(g),M=g.type,k=g.pendingProps,q=f!==null?f.memoizedProps:null,w=k.children,Uv(M,k)?w=null:q!==null&&Uv(M,q)&&(g.flags|=32),g.memoizedState!==null&&(M=Pg(f,g,TM,null,null,p),Uu._currentValue=M),nh(f,g),Kr(f,g,w,p),g.child;case 6:return f===null&&Pt&&((f=p=pr)&&(p=uD(p,g.pendingProps,Bi),p!==null?(g.stateNode=p,dn=g,pr=null,f=!0):f=!1),f||Vs(g)),null;case 13:return Bx(f,g,p);case 4:return ye(g,g.stateNode.containerInfo),w=g.pendingProps,f===null?g.child=Xo(g,null,w,p):Kr(f,g,w,p),g.child;case 11:return wx(f,g,g.type,g.pendingProps,p);case 7:return Kr(f,g,g.pendingProps,p),g.child;case 8:return Kr(f,g,g.pendingProps.children,p),g.child;case 12:return Kr(f,g,g.pendingProps.children,p),g.child;case 10:return w=g.pendingProps,Ia(g,g.type,w.value),Kr(f,g,w.children,p),g.child;case 9:return M=g.type._context,w=g.pendingProps.children,Ls(g),M=rn(M),w=w(M),g.flags|=1,Kr(f,g,w,p),g.child;case 14:return Cx(f,g,g.type,g.pendingProps,p);case 15:return Ex(f,g,g.type,g.pendingProps,p);case 19:return Nx(f,g,p);case 31:return w=g.pendingProps,p=g.mode,w={mode:w.mode,children:w.children},f===null?(p=ih(w,p),p.ref=g.ref,g.child=p,p.return=g,g=p):(p=Ji(f.child,w),p.ref=g.ref,g.child=p,p.return=g,g=p),g;case 22:return Sx(f,g,p);case 24:return Ls(g),w=rn(Br),f===null?(M=Tg(),M===null&&(M=Zt,k=Eg(),M.pooledCache=k,k.refCount++,k!==null&&(M.pooledCacheLanes|=p),M=k),g.memoizedState={parent:w,cache:M},Dg(g),Ia(g,Br,M)):((f.lanes&p)!==0&&(Rg(f,g),gu(g,null,null,p),du()),M=f.memoizedState,k=g.memoizedState,M.parent!==w?(M={parent:w,cache:w},g.memoizedState=M,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=M),Ia(g,Br,w)):(w=k.cache,Ia(g,Br,w),w!==M.cache&&Cg(g,[Br],p,!0))),Kr(f,g,g.pendingProps.children,p),g.child;case 29:throw g.pendingProps}throw Error(i(156,g.tag))}function sa(f){f.flags|=4}function kx(f,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)f.flags&=-16777217;else if(f.flags|=16777216,!qb(g)){if(g=ei.current,g!==null&&((Mt&4194048)===Mt?Ii!==null:(Mt&62914560)!==Mt&&(Mt&536870912)===0||g!==Ii))throw fu=Mg,pA;f.flags|=8192}}function ah(f,g){g!==null&&(f.flags|=4),f.flags&16384&&(g=f.tag!==22?ze():536870912,f.lanes|=g,Jo|=g)}function bu(f,g){if(!Pt)switch(f.tailMode){case"hidden":g=f.tail;for(var p=null;g!==null;)g.alternate!==null&&(p=g),g=g.sibling;p===null?f.tail=null:p.sibling=null;break;case"collapsed":p=f.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?g||f.tail===null?f.tail=null:f.tail.sibling=null:w.sibling=null}}function dr(f){var g=f.alternate!==null&&f.alternate.child===f.child,p=0,w=0;if(g)for(var M=f.child;M!==null;)p|=M.lanes|M.childLanes,w|=M.subtreeFlags&65011712,w|=M.flags&65011712,M.return=f,M=M.sibling;else for(M=f.child;M!==null;)p|=M.lanes|M.childLanes,w|=M.subtreeFlags,w|=M.flags,M.return=f,M=M.sibling;return f.subtreeFlags|=w,f.childLanes=p,g}function PM(f,g,p){var w=g.pendingProps;switch(Ag(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(g),null;case 1:return dr(g),null;case 3:return p=g.stateNode,w=null,f!==null&&(w=f.memoizedState.cache),g.memoizedState.cache!==w&&(g.flags|=2048),ra(Br),ve(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(f===null||f.child===null)&&(iu(g)?sa(g):f===null||f.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,hA())),dr(g),null;case 26:return p=g.memoizedState,f===null?(sa(g),p!==null?(dr(g),kx(g,p)):(dr(g),g.flags&=-16777217)):p?p!==f.memoizedState?(sa(g),dr(g),kx(g,p)):(dr(g),g.flags&=-16777217):(f.memoizedProps!==w&&sa(g),dr(g),g.flags&=-16777217),null;case 27:ae(g),p=oe.current;var M=g.type;if(f!==null&&g.stateNode!=null)f.memoizedProps!==w&&sa(g);else{if(!w){if(g.stateNode===null)throw Error(i(166));return dr(g),null}f=ee.current,iu(g)?cA(g):(f=kb(M,w,p),g.stateNode=f,sa(g))}return dr(g),null;case 5:if(ae(g),p=g.type,f!==null&&g.stateNode!=null)f.memoizedProps!==w&&sa(g);else{if(!w){if(g.stateNode===null)throw Error(i(166));return dr(g),null}if(f=ee.current,iu(g))cA(g);else{switch(M=yh(oe.current),f){case 1:f=M.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:f=M.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":f=M.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":f=M.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":f=M.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof w.is=="string"?M.createElement("select",{is:w.is}):M.createElement("select"),w.multiple?f.multiple=!0:w.size&&(f.size=w.size);break;default:f=typeof w.is=="string"?M.createElement(p,{is:w.is}):M.createElement(p)}}f[wt]=g,f[Dt]=w;e:for(M=g.child;M!==null;){if(M.tag===5||M.tag===6)f.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===g)break e;for(;M.sibling===null;){if(M.return===null||M.return===g)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}g.stateNode=f;e:switch(Qr(f,p,w),p){case"button":case"input":case"select":case"textarea":f=!!w.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&sa(g)}}return dr(g),g.flags&=-16777217,null;case 6:if(f&&g.stateNode!=null)f.memoizedProps!==w&&sa(g);else{if(typeof w!="string"&&g.stateNode===null)throw Error(i(166));if(f=oe.current,iu(g)){if(f=g.stateNode,p=g.memoizedProps,w=null,M=dn,M!==null)switch(M.tag){case 27:case 5:w=M.memoizedProps}f[wt]=g,f=!!(f.nodeValue===p||w!==null&&w.suppressHydrationWarning===!0||Mb(f.nodeValue,p)),f||Vs(g)}else f=yh(f).createTextNode(w),f[wt]=g,g.stateNode=f}return dr(g),null;case 13:if(w=g.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(M=iu(g),w!==null&&w.dehydrated!==null){if(f===null){if(!M)throw Error(i(318));if(M=g.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(i(317));M[wt]=g}else au(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;dr(g),M=!1}else M=hA(),f!==null&&f.memoizedState!==null&&(f.memoizedState.hydrationErrors=M),M=!0;if(!M)return g.flags&256?(ia(g),g):(ia(g),null)}if(ia(g),(g.flags&128)!==0)return g.lanes=p,g;if(p=w!==null,f=f!==null&&f.memoizedState!==null,p){w=g.child,M=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(M=w.alternate.memoizedState.cachePool.pool);var k=null;w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(k=w.memoizedState.cachePool.pool),k!==M&&(w.flags|=2048)}return p!==f&&p&&(g.child.flags|=8192),ah(g,g.updateQueue),dr(g),null;case 4:return ve(),f===null&&Iv(g.stateNode.containerInfo),dr(g),null;case 10:return ra(g.type),dr(g),null;case 19:if(Z(Ir),M=g.memoizedState,M===null)return dr(g),null;if(w=(g.flags&128)!==0,k=M.rendering,k===null)if(w)bu(M,!1);else{if(yr!==0||f!==null&&(f.flags&128)!==0)for(f=g.child;f!==null;){if(k=eh(f),k!==null){for(g.flags|=128,bu(M,!1),f=k.updateQueue,g.updateQueue=f,ah(g,f),g.subtreeFlags=0,f=p,p=g.child;p!==null;)lA(p,f),p=p.sibling;return J(Ir,Ir.current&1|2),g.child}f=f.sibling}M.tail!==null&&He()>lh&&(g.flags|=128,w=!0,bu(M,!1),g.lanes=4194304)}else{if(!w)if(f=eh(k),f!==null){if(g.flags|=128,w=!0,f=f.updateQueue,g.updateQueue=f,ah(g,f),bu(M,!0),M.tail===null&&M.tailMode==="hidden"&&!k.alternate&&!Pt)return dr(g),null}else 2*He()-M.renderingStartTime>lh&&p!==536870912&&(g.flags|=128,w=!0,bu(M,!1),g.lanes=4194304);M.isBackwards?(k.sibling=g.child,g.child=k):(f=M.last,f!==null?f.sibling=k:g.child=k,M.last=k)}return M.tail!==null?(g=M.tail,M.rendering=g,M.tail=g.sibling,M.renderingStartTime=He(),g.sibling=null,f=Ir.current,J(Ir,w?f&1|2:f&1),g):(dr(g),null);case 22:case 23:return ia(g),Fg(),w=g.memoizedState!==null,f!==null?f.memoizedState!==null!==w&&(g.flags|=8192):w&&(g.flags|=8192),w?(p&536870912)!==0&&(g.flags&128)===0&&(dr(g),g.subtreeFlags&6&&(g.flags|=8192)):dr(g),p=g.updateQueue,p!==null&&ah(g,p.retryQueue),p=null,f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(p=f.memoizedState.cachePool.pool),w=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(w=g.memoizedState.cachePool.pool),w!==p&&(g.flags|=2048),f!==null&&Z(_s),null;case 24:return p=null,f!==null&&(p=f.memoizedState.cache),g.memoizedState.cache!==p&&(g.flags|=2048),ra(Br),dr(g),null;case 25:return null;case 30:return null}throw Error(i(156,g.tag))}function UM(f,g){switch(Ag(g),g.tag){case 1:return f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 3:return ra(Br),ve(),f=g.flags,(f&65536)!==0&&(f&128)===0?(g.flags=f&-65537|128,g):null;case 26:case 27:case 5:return ae(g),null;case 13:if(ia(g),f=g.memoizedState,f!==null&&f.dehydrated!==null){if(g.alternate===null)throw Error(i(340));au()}return f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 19:return Z(Ir),null;case 4:return ve(),null;case 10:return ra(g.type),null;case 22:case 23:return ia(g),Fg(),f!==null&&Z(_s),f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 24:return ra(Br),null;case 25:return null;default:return null}}function Px(f,g){switch(Ag(g),g.tag){case 3:ra(Br),ve();break;case 26:case 27:case 5:ae(g);break;case 4:ve();break;case 13:ia(g);break;case 19:Z(Ir);break;case 10:ra(g.type);break;case 22:case 23:ia(g),Fg(),f!==null&&Z(_s);break;case 24:ra(Br)}}function wu(f,g){try{var p=g.updateQueue,w=p!==null?p.lastEffect:null;if(w!==null){var M=w.next;p=M;do{if((p.tag&f)===f){w=void 0;var k=p.create,q=p.inst;w=k(),q.destroy=w}p=p.next}while(p!==M)}}catch(H){jt(g,g.return,H)}}function Oa(f,g,p){try{var w=g.updateQueue,M=w!==null?w.lastEffect:null;if(M!==null){var k=M.next;w=k;do{if((w.tag&f)===f){var q=w.inst,H=q.destroy;if(H!==void 0){q.destroy=void 0,M=g;var $=p,fe=H;try{fe()}catch(we){jt(M,$,we)}}}w=w.next}while(w!==k)}}catch(we){jt(g,g.return,we)}}function Ux(f){var g=f.updateQueue;if(g!==null){var p=f.stateNode;try{CA(g,p)}catch(w){jt(f,f.return,w)}}}function Vx(f,g,p){p.props=qs(f.type,f.memoizedProps),p.state=f.memoizedState;try{p.componentWillUnmount()}catch(w){jt(f,g,w)}}function Cu(f,g){try{var p=f.ref;if(p!==null){switch(f.tag){case 26:case 27:case 5:var w=f.stateNode;break;case 30:w=f.stateNode;break;default:w=f.stateNode}typeof p=="function"?f.refCleanup=p(w):p.current=w}}catch(M){jt(f,g,M)}}function Ni(f,g){var p=f.ref,w=f.refCleanup;if(p!==null)if(typeof w=="function")try{w()}catch(M){jt(f,g,M)}finally{f.refCleanup=null,f=f.alternate,f!=null&&(f.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(M){jt(f,g,M)}else p.current=null}function Ox(f){var g=f.type,p=f.memoizedProps,w=f.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":p.autoFocus&&w.focus();break e;case"img":p.src?w.src=p.src:p.srcSet&&(w.srcset=p.srcSet)}}catch(M){jt(f,f.return,M)}}function ov(f,g,p){try{var w=f.stateNode;nD(w,f.type,p,g),w[Dt]=g}catch(M){jt(f,f.return,M)}}function Lx(f){return f.tag===5||f.tag===3||f.tag===26||f.tag===27&&ja(f.type)||f.tag===4}function lv(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||Lx(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.tag===27&&ja(f.type)||f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function uv(f,g,p){var w=f.tag;if(w===5||w===6)f=f.stateNode,g?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(f,g):(g=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,g.appendChild(f),p=p._reactRootContainer,p!=null||g.onclick!==null||(g.onclick=ph));else if(w!==4&&(w===27&&ja(f.type)&&(p=f.stateNode,g=null),f=f.child,f!==null))for(uv(f,g,p),f=f.sibling;f!==null;)uv(f,g,p),f=f.sibling}function sh(f,g,p){var w=f.tag;if(w===5||w===6)f=f.stateNode,g?p.insertBefore(f,g):p.appendChild(f);else if(w!==4&&(w===27&&ja(f.type)&&(p=f.stateNode),f=f.child,f!==null))for(sh(f,g,p),f=f.sibling;f!==null;)sh(f,g,p),f=f.sibling}function _x(f){var g=f.stateNode,p=f.memoizedProps;try{for(var w=f.type,M=g.attributes;M.length;)g.removeAttributeNode(M[0]);Qr(g,w,p),g[wt]=f,g[Dt]=p}catch(k){jt(f,f.return,k)}}var oa=!1,Cr=!1,cv=!1,zx=typeof WeakSet=="function"?WeakSet:Set,Or=null;function VM(f,g){if(f=f.containerInfo,kv=Eh,f=Jy(f),lg(f)){if("selectionStart"in f)var p={start:f.selectionStart,end:f.selectionEnd};else e:{p=(p=f.ownerDocument)&&p.defaultView||window;var w=p.getSelection&&p.getSelection();if(w&&w.rangeCount!==0){p=w.anchorNode;var M=w.anchorOffset,k=w.focusNode;w=w.focusOffset;try{p.nodeType,k.nodeType}catch{p=null;break e}var q=0,H=-1,$=-1,fe=0,we=0,Ee=f,he=null;t:for(;;){for(var de;Ee!==p||M!==0&&Ee.nodeType!==3||(H=q+M),Ee!==k||w!==0&&Ee.nodeType!==3||($=q+w),Ee.nodeType===3&&(q+=Ee.nodeValue.length),(de=Ee.firstChild)!==null;)he=Ee,Ee=de;for(;;){if(Ee===f)break t;if(he===p&&++fe===M&&(H=q),he===k&&++we===w&&($=q),(de=Ee.nextSibling)!==null)break;Ee=he,he=Ee.parentNode}Ee=de}p=H===-1||$===-1?null:{start:H,end:$}}else p=null}p=p||{start:0,end:0}}else p=null;for(Pv={focusedElem:f,selectionRange:p},Eh=!1,Or=g;Or!==null;)if(g=Or,f=g.child,(g.subtreeFlags&1024)!==0&&f!==null)f.return=g,Or=f;else for(;Or!==null;){switch(g=Or,k=g.alternate,f=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((f&1024)!==0&&k!==null){f=void 0,p=g,M=k.memoizedProps,k=k.memoizedState,w=p.stateNode;try{var st=qs(p.type,M,p.elementType===p.type);f=w.getSnapshotBeforeUpdate(st,k),w.__reactInternalSnapshotBeforeUpdate=f}catch(tt){jt(p,p.return,tt)}}break;case 3:if((f&1024)!==0){if(f=g.stateNode.containerInfo,p=f.nodeType,p===9)Ov(f);else if(p===1)switch(f.nodeName){case"HEAD":case"HTML":case"BODY":Ov(f);break;default:f.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(i(163))}if(f=g.sibling,f!==null){f.return=g.return,Or=f;break}Or=g.return}}function qx(f,g,p){var w=p.flags;switch(p.tag){case 0:case 11:case 15:La(f,p),w&4&&wu(5,p);break;case 1:if(La(f,p),w&4)if(f=p.stateNode,g===null)try{f.componentDidMount()}catch(q){jt(p,p.return,q)}else{var M=qs(p.type,g.memoizedProps);g=g.memoizedState;try{f.componentDidUpdate(M,g,f.__reactInternalSnapshotBeforeUpdate)}catch(q){jt(p,p.return,q)}}w&64&&Ux(p),w&512&&Cu(p,p.return);break;case 3:if(La(f,p),w&64&&(f=p.updateQueue,f!==null)){if(g=null,p.child!==null)switch(p.child.tag){case 27:case 5:g=p.child.stateNode;break;case 1:g=p.child.stateNode}try{CA(f,g)}catch(q){jt(p,p.return,q)}}break;case 27:g===null&&w&4&&_x(p);case 26:case 5:La(f,p),g===null&&w&4&&Ox(p),w&512&&Cu(p,p.return);break;case 12:La(f,p);break;case 13:La(f,p),w&4&&Hx(f,p),w&64&&(f=p.memoizedState,f!==null&&(f=f.dehydrated,f!==null&&(p=jM.bind(null,p),cD(f,p))));break;case 22:if(w=p.memoizedState!==null||oa,!w){g=g!==null&&g.memoizedState!==null||Cr,M=oa;var k=Cr;oa=w,(Cr=g)&&!k?_a(f,p,(p.subtreeFlags&8772)!==0):La(f,p),oa=M,Cr=k}break;case 30:break;default:La(f,p)}}function Gx(f){var g=f.alternate;g!==null&&(f.alternate=null,Gx(g)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(g=f.stateNode,g!==null&&Di(g)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}var or=null,En=!1;function la(f,g,p){for(p=p.child;p!==null;)Yx(f,g,p),p=p.sibling}function Yx(f,g,p){if(ot&&typeof ot.onCommitFiberUnmount=="function")try{ot.onCommitFiberUnmount(vt,p)}catch{}switch(p.tag){case 26:Cr||Ni(p,g),la(f,g,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Cr||Ni(p,g);var w=or,M=En;ja(p.type)&&(or=p.stateNode,En=!1),la(f,g,p),Nu(p.stateNode),or=w,En=M;break;case 5:Cr||Ni(p,g);case 6:if(w=or,M=En,or=null,la(f,g,p),or=w,En=M,or!==null)if(En)try{(or.nodeType===9?or.body:or.nodeName==="HTML"?or.ownerDocument.body:or).removeChild(p.stateNode)}catch(k){jt(p,g,k)}else try{or.removeChild(p.stateNode)}catch(k){jt(p,g,k)}break;case 18:or!==null&&(En?(f=or,Nb(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,p.stateNode),_u(f)):Nb(or,p.stateNode));break;case 4:w=or,M=En,or=p.stateNode.containerInfo,En=!0,la(f,g,p),or=w,En=M;break;case 0:case 11:case 14:case 15:Cr||Oa(2,p,g),Cr||Oa(4,p,g),la(f,g,p);break;case 1:Cr||(Ni(p,g),w=p.stateNode,typeof w.componentWillUnmount=="function"&&Vx(p,g,w)),la(f,g,p);break;case 21:la(f,g,p);break;case 22:Cr=(w=Cr)||p.memoizedState!==null,la(f,g,p),Cr=w;break;default:la(f,g,p)}}function Hx(f,g){if(g.memoizedState===null&&(f=g.alternate,f!==null&&(f=f.memoizedState,f!==null&&(f=f.dehydrated,f!==null))))try{_u(f)}catch(p){jt(g,g.return,p)}}function OM(f){switch(f.tag){case 13:case 19:var g=f.stateNode;return g===null&&(g=f.stateNode=new zx),g;case 22:return f=f.stateNode,g=f._retryCache,g===null&&(g=f._retryCache=new zx),g;default:throw Error(i(435,f.tag))}}function fv(f,g){var p=OM(f);g.forEach(function(w){var M=KM.bind(null,f,w);p.has(w)||(p.add(w),w.then(M,M))})}function Vn(f,g){var p=g.deletions;if(p!==null)for(var w=0;w<p.length;w++){var M=p[w],k=f,q=g,H=q;e:for(;H!==null;){switch(H.tag){case 27:if(ja(H.type)){or=H.stateNode,En=!1;break e}break;case 5:or=H.stateNode,En=!1;break e;case 3:case 4:or=H.stateNode.containerInfo,En=!0;break e}H=H.return}if(or===null)throw Error(i(160));Yx(k,q,M),or=null,En=!1,k=M.alternate,k!==null&&(k.return=null),M.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)jx(g,f),g=g.sibling}var di=null;function jx(f,g){var p=f.alternate,w=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:Vn(g,f),On(f),w&4&&(Oa(3,f,f.return),wu(3,f),Oa(5,f,f.return));break;case 1:Vn(g,f),On(f),w&512&&(Cr||p===null||Ni(p,p.return)),w&64&&oa&&(f=f.updateQueue,f!==null&&(w=f.callbacks,w!==null&&(p=f.shared.hiddenCallbacks,f.shared.hiddenCallbacks=p===null?w:p.concat(w))));break;case 26:var M=di;if(Vn(g,f),On(f),w&512&&(Cr||p===null||Ni(p,p.return)),w&4){var k=p!==null?p.memoizedState:null;if(w=f.memoizedState,p===null)if(w===null)if(f.stateNode===null){e:{w=f.type,p=f.memoizedProps,M=M.ownerDocument||M;t:switch(w){case"title":k=M.getElementsByTagName("title")[0],(!k||k[un]||k[wt]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=M.createElement(w),M.head.insertBefore(k,M.querySelector("head > title"))),Qr(k,w,p),k[wt]=f,Rt(k),w=k;break e;case"link":var q=_b("link","href",M).get(w+(p.href||""));if(q){for(var H=0;H<q.length;H++)if(k=q[H],k.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&k.getAttribute("rel")===(p.rel==null?null:p.rel)&&k.getAttribute("title")===(p.title==null?null:p.title)&&k.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){q.splice(H,1);break t}}k=M.createElement(w),Qr(k,w,p),M.head.appendChild(k);break;case"meta":if(q=_b("meta","content",M).get(w+(p.content||""))){for(H=0;H<q.length;H++)if(k=q[H],k.getAttribute("content")===(p.content==null?null:""+p.content)&&k.getAttribute("name")===(p.name==null?null:p.name)&&k.getAttribute("property")===(p.property==null?null:p.property)&&k.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&k.getAttribute("charset")===(p.charSet==null?null:p.charSet)){q.splice(H,1);break t}}k=M.createElement(w),Qr(k,w,p),M.head.appendChild(k);break;default:throw Error(i(468,w))}k[wt]=f,Rt(k),w=k}f.stateNode=w}else zb(M,f.type,f.stateNode);else f.stateNode=Lb(M,w,f.memoizedProps);else k!==w?(k===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):k.count--,w===null?zb(M,f.type,f.stateNode):Lb(M,w,f.memoizedProps)):w===null&&f.stateNode!==null&&ov(f,f.memoizedProps,p.memoizedProps)}break;case 27:Vn(g,f),On(f),w&512&&(Cr||p===null||Ni(p,p.return)),p!==null&&w&4&&ov(f,f.memoizedProps,p.memoizedProps);break;case 5:if(Vn(g,f),On(f),w&512&&(Cr||p===null||Ni(p,p.return)),f.flags&32){M=f.stateNode;try{Bo(M,"")}catch(de){jt(f,f.return,de)}}w&4&&f.stateNode!=null&&(M=f.memoizedProps,ov(f,M,p!==null?p.memoizedProps:M)),w&1024&&(cv=!0);break;case 6:if(Vn(g,f),On(f),w&4){if(f.stateNode===null)throw Error(i(162));w=f.memoizedProps,p=f.stateNode;try{p.nodeValue=w}catch(de){jt(f,f.return,de)}}break;case 3:if(bh=null,M=di,di=Ah(g.containerInfo),Vn(g,f),di=M,On(f),w&4&&p!==null&&p.memoizedState.isDehydrated)try{_u(g.containerInfo)}catch(de){jt(f,f.return,de)}cv&&(cv=!1,Kx(f));break;case 4:w=di,di=Ah(f.stateNode.containerInfo),Vn(g,f),On(f),di=w;break;case 12:Vn(g,f),On(f);break;case 13:Vn(g,f),On(f),f.child.flags&8192&&f.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(pv=He()),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,fv(f,w)));break;case 22:M=f.memoizedState!==null;var $=p!==null&&p.memoizedState!==null,fe=oa,we=Cr;if(oa=fe||M,Cr=we||$,Vn(g,f),Cr=we,oa=fe,On(f),w&8192)e:for(g=f.stateNode,g._visibility=M?g._visibility&-2:g._visibility|1,M&&(p===null||$||oa||Cr||Gs(f)),p=null,g=f;;){if(g.tag===5||g.tag===26){if(p===null){$=p=g;try{if(k=$.stateNode,M)q=k.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{H=$.stateNode;var Ee=$.memoizedProps.style,he=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;H.style.display=he==null||typeof he=="boolean"?"":(""+he).trim()}}catch(de){jt($,$.return,de)}}}else if(g.tag===6){if(p===null){$=g;try{$.stateNode.nodeValue=M?"":$.memoizedProps}catch(de){jt($,$.return,de)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===f)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break e;for(;g.sibling===null;){if(g.return===null||g.return===f)break e;p===g&&(p=null),g=g.return}p===g&&(p=null),g.sibling.return=g.return,g=g.sibling}w&4&&(w=f.updateQueue,w!==null&&(p=w.retryQueue,p!==null&&(w.retryQueue=null,fv(f,p))));break;case 19:Vn(g,f),On(f),w&4&&(w=f.updateQueue,w!==null&&(f.updateQueue=null,fv(f,w)));break;case 30:break;case 21:break;default:Vn(g,f),On(f)}}function On(f){var g=f.flags;if(g&2){try{for(var p,w=f.return;w!==null;){if(Lx(w)){p=w;break}w=w.return}if(p==null)throw Error(i(160));switch(p.tag){case 27:var M=p.stateNode,k=lv(f);sh(f,k,M);break;case 5:var q=p.stateNode;p.flags&32&&(Bo(q,""),p.flags&=-33);var H=lv(f);sh(f,H,q);break;case 3:case 4:var $=p.stateNode.containerInfo,fe=lv(f);uv(f,fe,$);break;default:throw Error(i(161))}}catch(we){jt(f,f.return,we)}f.flags&=-3}g&4096&&(f.flags&=-4097)}function Kx(f){if(f.subtreeFlags&1024)for(f=f.child;f!==null;){var g=f;Kx(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),f=f.sibling}}function La(f,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)qx(f,g.alternate,g),g=g.sibling}function Gs(f){for(f=f.child;f!==null;){var g=f;switch(g.tag){case 0:case 11:case 14:case 15:Oa(4,g,g.return),Gs(g);break;case 1:Ni(g,g.return);var p=g.stateNode;typeof p.componentWillUnmount=="function"&&Vx(g,g.return,p),Gs(g);break;case 27:Nu(g.stateNode);case 26:case 5:Ni(g,g.return),Gs(g);break;case 22:g.memoizedState===null&&Gs(g);break;case 30:Gs(g);break;default:Gs(g)}f=f.sibling}}function _a(f,g,p){for(p=p&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var w=g.alternate,M=f,k=g,q=k.flags;switch(k.tag){case 0:case 11:case 15:_a(M,k,p),wu(4,k);break;case 1:if(_a(M,k,p),w=k,M=w.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(fe){jt(w,w.return,fe)}if(w=k,M=w.updateQueue,M!==null){var H=w.stateNode;try{var $=M.shared.hiddenCallbacks;if($!==null)for(M.shared.hiddenCallbacks=null,M=0;M<$.length;M++)wA($[M],H)}catch(fe){jt(w,w.return,fe)}}p&&q&64&&Ux(k),Cu(k,k.return);break;case 27:_x(k);case 26:case 5:_a(M,k,p),p&&w===null&&q&4&&Ox(k),Cu(k,k.return);break;case 12:_a(M,k,p);break;case 13:_a(M,k,p),p&&q&4&&Hx(M,k);break;case 22:k.memoizedState===null&&_a(M,k,p),Cu(k,k.return);break;case 30:break;default:_a(M,k,p)}g=g.sibling}}function hv(f,g){var p=null;f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(p=f.memoizedState.cachePool.pool),f=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(f=g.memoizedState.cachePool.pool),f!==p&&(f!=null&&f.refCount++,p!=null&&lu(p))}function dv(f,g){f=null,g.alternate!==null&&(f=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==f&&(g.refCount++,f!=null&&lu(f))}function Fi(f,g,p,w){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)Xx(f,g,p,w),g=g.sibling}function Xx(f,g,p,w){var M=g.flags;switch(g.tag){case 0:case 11:case 15:Fi(f,g,p,w),M&2048&&wu(9,g);break;case 1:Fi(f,g,p,w);break;case 3:Fi(f,g,p,w),M&2048&&(f=null,g.alternate!==null&&(f=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==f&&(g.refCount++,f!=null&&lu(f)));break;case 12:if(M&2048){Fi(f,g,p,w),f=g.stateNode;try{var k=g.memoizedProps,q=k.id,H=k.onPostCommit;typeof H=="function"&&H(q,g.alternate===null?"mount":"update",f.passiveEffectDuration,-0)}catch($){jt(g,g.return,$)}}else Fi(f,g,p,w);break;case 13:Fi(f,g,p,w);break;case 23:break;case 22:k=g.stateNode,q=g.alternate,g.memoizedState!==null?k._visibility&2?Fi(f,g,p,w):Eu(f,g):k._visibility&2?Fi(f,g,p,w):(k._visibility|=2,Qo(f,g,p,w,(g.subtreeFlags&10256)!==0)),M&2048&&hv(q,g);break;case 24:Fi(f,g,p,w),M&2048&&dv(g.alternate,g);break;default:Fi(f,g,p,w)}}function Qo(f,g,p,w,M){for(M=M&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var k=f,q=g,H=p,$=w,fe=q.flags;switch(q.tag){case 0:case 11:case 15:Qo(k,q,H,$,M),wu(8,q);break;case 23:break;case 22:var we=q.stateNode;q.memoizedState!==null?we._visibility&2?Qo(k,q,H,$,M):Eu(k,q):(we._visibility|=2,Qo(k,q,H,$,M)),M&&fe&2048&&hv(q.alternate,q);break;case 24:Qo(k,q,H,$,M),M&&fe&2048&&dv(q.alternate,q);break;default:Qo(k,q,H,$,M)}g=g.sibling}}function Eu(f,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var p=f,w=g,M=w.flags;switch(w.tag){case 22:Eu(p,w),M&2048&&hv(w.alternate,w);break;case 24:Eu(p,w),M&2048&&dv(w.alternate,w);break;default:Eu(p,w)}g=g.sibling}}var Su=8192;function Wo(f){if(f.subtreeFlags&Su)for(f=f.child;f!==null;)Qx(f),f=f.sibling}function Qx(f){switch(f.tag){case 26:Wo(f),f.flags&Su&&f.memoizedState!==null&&CD(di,f.memoizedState,f.memoizedProps);break;case 5:Wo(f);break;case 3:case 4:var g=di;di=Ah(f.stateNode.containerInfo),Wo(f),di=g;break;case 22:f.memoizedState===null&&(g=f.alternate,g!==null&&g.memoizedState!==null?(g=Su,Su=16777216,Wo(f),Su=g):Wo(f));break;default:Wo(f)}}function Wx(f){var g=f.alternate;if(g!==null&&(f=g.child,f!==null)){g.child=null;do g=f.sibling,f.sibling=null,f=g;while(f!==null)}}function Tu(f){var g=f.deletions;if((f.flags&16)!==0){if(g!==null)for(var p=0;p<g.length;p++){var w=g[p];Or=w,Jx(w,f)}Wx(f)}if(f.subtreeFlags&10256)for(f=f.child;f!==null;)Zx(f),f=f.sibling}function Zx(f){switch(f.tag){case 0:case 11:case 15:Tu(f),f.flags&2048&&Oa(9,f,f.return);break;case 3:Tu(f);break;case 12:Tu(f);break;case 22:var g=f.stateNode;f.memoizedState!==null&&g._visibility&2&&(f.return===null||f.return.tag!==13)?(g._visibility&=-3,oh(f)):Tu(f);break;default:Tu(f)}}function oh(f){var g=f.deletions;if((f.flags&16)!==0){if(g!==null)for(var p=0;p<g.length;p++){var w=g[p];Or=w,Jx(w,f)}Wx(f)}for(f=f.child;f!==null;){switch(g=f,g.tag){case 0:case 11:case 15:Oa(8,g,g.return),oh(g);break;case 22:p=g.stateNode,p._visibility&2&&(p._visibility&=-3,oh(g));break;default:oh(g)}f=f.sibling}}function Jx(f,g){for(;Or!==null;){var p=Or;switch(p.tag){case 0:case 11:case 15:Oa(8,p,g);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var w=p.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:lu(p.memoizedState.cache)}if(w=p.child,w!==null)w.return=p,Or=w;else e:for(p=f;Or!==null;){w=Or;var M=w.sibling,k=w.return;if(Gx(w),w===p){Or=null;break e}if(M!==null){M.return=k,Or=M;break e}Or=k}}}var LM={getCacheForType:function(f){var g=rn(Br),p=g.data.get(f);return p===void 0&&(p=f(),g.data.set(f,p)),p}},_M=typeof WeakMap=="function"?WeakMap:Map,_t=0,Zt=null,Ct=null,Mt=0,zt=0,Ln=null,za=!1,Zo=!1,gv=!1,ua=0,yr=0,qa=0,Ys=0,vv=0,ti=0,Jo=0,Mu=null,Sn=null,mv=!1,pv=0,lh=1/0,uh=null,Ga=null,Xr=0,Ya=null,$o=null,el=0,yv=0,Av=null,$x=null,Du=0,xv=null;function _n(){if((_t&2)!==0&&Mt!==0)return Mt&-Mt;if(V.T!==null){var f=zo;return f!==0?f:Mv()}return vr()}function eb(){ti===0&&(ti=(Mt&536870912)===0||Pt?Se():536870912);var f=ei.current;return f!==null&&(f.flags|=32),ti}function zn(f,g,p){(f===Zt&&(zt===2||zt===9)||f.cancelPendingCommit!==null)&&(tl(f,0),Ha(f,Mt,ti,!1)),Ke(f,p),((_t&2)===0||f!==Zt)&&(f===Zt&&((_t&2)===0&&(Ys|=p),yr===4&&Ha(f,Mt,ti,!1)),ki(f))}function tb(f,g,p){if((_t&6)!==0)throw Error(i(327));var w=!p&&(g&124)===0&&(g&f.expiredLanes)===0||xe(f,g),M=w?GM(f,g):Cv(f,g,!0),k=w;do{if(M===0){Zo&&!w&&Ha(f,g,0,!1);break}else{if(p=f.current.alternate,k&&!zM(p)){M=Cv(f,g,!1),k=!1;continue}if(M===2){if(k=g,f.errorRecoveryDisabledLanes&k)var q=0;else q=f.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){g=q;e:{var H=f;M=Mu;var $=H.current.memoizedState.isDehydrated;if($&&(tl(H,q).flags|=256),q=Cv(H,q,!1),q!==2){if(gv&&!$){H.errorRecoveryDisabledLanes|=k,Ys|=k,M=4;break e}k=Sn,Sn=M,k!==null&&(Sn===null?Sn=k:Sn.push.apply(Sn,k))}M=q}if(k=!1,M!==2)continue}}if(M===1){tl(f,0),Ha(f,g,0,!0);break}e:{switch(w=f,k=M,k){case 0:case 1:throw Error(i(345));case 4:if((g&4194048)!==g)break;case 6:Ha(w,g,ti,!za);break e;case 2:Sn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((g&62914560)===g&&(M=pv+300-He(),10<M)){if(Ha(w,g,ti,!za),pe(w,0,!0)!==0)break e;w.timeoutHandle=Bb(rb.bind(null,w,p,Sn,uh,mv,g,ti,Ys,Jo,za,k,2,-0,0),M);break e}rb(w,p,Sn,uh,mv,g,ti,Ys,Jo,za,k,0,-0,0)}}break}while(!0);ki(f)}function rb(f,g,p,w,M,k,q,H,$,fe,we,Ee,he,de){if(f.timeoutHandle=-1,Ee=g.subtreeFlags,(Ee&8192||(Ee&16785408)===16785408)&&(Pu={stylesheets:null,count:0,unsuspend:wD},Qx(g),Ee=ED(),Ee!==null)){f.cancelPendingCommit=Ee(ub.bind(null,f,g,k,p,w,M,q,H,$,we,1,he,de)),Ha(f,k,q,!fe);return}ub(f,g,k,p,w,M,q,H,$)}function zM(f){for(var g=f;;){var p=g.tag;if((p===0||p===11||p===15)&&g.flags&16384&&(p=g.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var w=0;w<p.length;w++){var M=p[w],k=M.getSnapshot;M=M.value;try{if(!Pn(k(),M))return!1}catch{return!1}}if(p=g.child,g.subtreeFlags&16384&&p!==null)p.return=g,g=p;else{if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Ha(f,g,p,w){g&=~vv,g&=~Ys,f.suspendedLanes|=g,f.pingedLanes&=~g,w&&(f.warmLanes|=g),w=f.expirationTimes;for(var M=g;0<M;){var k=31-lt(M),q=1<<k;w[k]=-1,M&=~q}p!==0&&ct(f,p,g)}function ch(){return(_t&6)===0?(Ru(0),!1):!0}function bv(){if(Ct!==null){if(zt===0)var f=Ct.return;else f=Ct,ta=Os=null,Og(f),Ko=null,Au=0,f=Ct;for(;f!==null;)Px(f.alternate,f),f=f.return;Ct=null}}function tl(f,g){var p=f.timeoutHandle;p!==-1&&(f.timeoutHandle=-1,aD(p)),p=f.cancelPendingCommit,p!==null&&(f.cancelPendingCommit=null,p()),bv(),Zt=f,Ct=p=Ji(f.current,null),Mt=g,zt=0,Ln=null,za=!1,Zo=xe(f,g),gv=!1,Jo=ti=vv=Ys=qa=yr=0,Sn=Mu=null,mv=!1,(g&8)!==0&&(g|=g&32);var w=f.entangledLanes;if(w!==0)for(f=f.entanglements,w&=g;0<w;){var M=31-lt(w),k=1<<M;g|=f[M],w&=~k}return ua=g,Nf(),p}function nb(f,g){yt=null,V.H=Zf,g===cu||g===zf?(g=xA(),zt=3):g===pA?(g=xA(),zt=4):zt=g===bx?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Ln=g,Ct===null&&(yr=1,rh(f,Wn(g,f.current)))}function ib(){var f=V.H;return V.H=Zf,f===null?Zf:f}function ab(){var f=V.A;return V.A=LM,f}function wv(){yr=4,za||(Mt&4194048)!==Mt&&ei.current!==null||(Zo=!0),(qa&134217727)===0&&(Ys&134217727)===0||Zt===null||Ha(Zt,Mt,ti,!1)}function Cv(f,g,p){var w=_t;_t|=2;var M=ib(),k=ab();(Zt!==f||Mt!==g)&&(uh=null,tl(f,g)),g=!1;var q=yr;e:do try{if(zt!==0&&Ct!==null){var H=Ct,$=Ln;switch(zt){case 8:bv(),q=6;break e;case 3:case 2:case 9:case 6:ei.current===null&&(g=!0);var fe=zt;if(zt=0,Ln=null,rl(f,H,$,fe),p&&Zo){q=0;break e}break;default:fe=zt,zt=0,Ln=null,rl(f,H,$,fe)}}qM(),q=yr;break}catch(we){nb(f,we)}while(!0);return g&&f.shellSuspendCounter++,ta=Os=null,_t=w,V.H=M,V.A=k,Ct===null&&(Zt=null,Mt=0,Nf()),q}function qM(){for(;Ct!==null;)sb(Ct)}function GM(f,g){var p=_t;_t|=2;var w=ib(),M=ab();Zt!==f||Mt!==g?(uh=null,lh=He()+500,tl(f,g)):Zo=xe(f,g);e:do try{if(zt!==0&&Ct!==null){g=Ct;var k=Ln;t:switch(zt){case 1:zt=0,Ln=null,rl(f,g,k,1);break;case 2:case 9:if(yA(k)){zt=0,Ln=null,ob(g);break}g=function(){zt!==2&&zt!==9||Zt!==f||(zt=7),ki(f)},k.then(g,g);break e;case 3:zt=7;break e;case 4:zt=5;break e;case 7:yA(k)?(zt=0,Ln=null,ob(g)):(zt=0,Ln=null,rl(f,g,k,7));break;case 5:var q=null;switch(Ct.tag){case 26:q=Ct.memoizedState;case 5:case 27:var H=Ct;if(!q||qb(q)){zt=0,Ln=null;var $=H.sibling;if($!==null)Ct=$;else{var fe=H.return;fe!==null?(Ct=fe,fh(fe)):Ct=null}break t}}zt=0,Ln=null,rl(f,g,k,5);break;case 6:zt=0,Ln=null,rl(f,g,k,6);break;case 8:bv(),yr=6;break e;default:throw Error(i(462))}}YM();break}catch(we){nb(f,we)}while(!0);return ta=Os=null,V.H=w,V.A=M,_t=p,Ct!==null?0:(Zt=null,Mt=0,Nf(),yr)}function YM(){for(;Ct!==null&&!Le();)sb(Ct)}function sb(f){var g=Fx(f.alternate,f,ua);f.memoizedProps=f.pendingProps,g===null?fh(f):Ct=g}function ob(f){var g=f,p=g.alternate;switch(g.tag){case 15:case 0:g=Mx(p,g,g.pendingProps,g.type,void 0,Mt);break;case 11:g=Mx(p,g,g.pendingProps,g.type.render,g.ref,Mt);break;case 5:Og(g);default:Px(p,g),g=Ct=lA(g,ua),g=Fx(p,g,ua)}f.memoizedProps=f.pendingProps,g===null?fh(f):Ct=g}function rl(f,g,p,w){ta=Os=null,Og(g),Ko=null,Au=0;var M=g.return;try{if(FM(f,M,g,p,Mt)){yr=1,rh(f,Wn(p,f.current)),Ct=null;return}}catch(k){if(M!==null)throw Ct=M,k;yr=1,rh(f,Wn(p,f.current)),Ct=null;return}g.flags&32768?(Pt||w===1?f=!0:Zo||(Mt&536870912)!==0?f=!1:(za=f=!0,(w===2||w===9||w===3||w===6)&&(w=ei.current,w!==null&&w.tag===13&&(w.flags|=16384))),lb(g,f)):fh(g)}function fh(f){var g=f;do{if((g.flags&32768)!==0){lb(g,za);return}f=g.return;var p=PM(g.alternate,g,ua);if(p!==null){Ct=p;return}if(g=g.sibling,g!==null){Ct=g;return}Ct=g=f}while(g!==null);yr===0&&(yr=5)}function lb(f,g){do{var p=UM(f.alternate,f);if(p!==null){p.flags&=32767,Ct=p;return}if(p=f.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!g&&(f=f.sibling,f!==null)){Ct=f;return}Ct=f=p}while(f!==null);yr=6,Ct=null}function ub(f,g,p,w,M,k,q,H,$){f.cancelPendingCommit=null;do hh();while(Xr!==0);if((_t&6)!==0)throw Error(i(327));if(g!==null){if(g===f.current)throw Error(i(177));if(k=g.lanes|g.childLanes,k|=dg,mt(f,p,k,q,H,$),f===Zt&&(Ct=Zt=null,Mt=0),$o=g,Ya=f,el=p,yv=k,Av=M,$x=w,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(f.callbackNode=null,f.callbackPriority=0,XM(_e,function(){return gb(),null})):(f.callbackNode=null,f.callbackPriority=0),w=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||w){w=V.T,V.T=null,M=_.p,_.p=2,q=_t,_t|=4;try{VM(f,g,p)}finally{_t=q,_.p=M,V.T=w}}Xr=1,cb(),fb(),hb()}}function cb(){if(Xr===1){Xr=0;var f=Ya,g=$o,p=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||p){p=V.T,V.T=null;var w=_.p;_.p=2;var M=_t;_t|=4;try{jx(g,f);var k=Pv,q=Jy(f.containerInfo),H=k.focusedElem,$=k.selectionRange;if(q!==H&&H&&H.ownerDocument&&Zy(H.ownerDocument.documentElement,H)){if($!==null&&lg(H)){var fe=$.start,we=$.end;if(we===void 0&&(we=fe),"selectionStart"in H)H.selectionStart=fe,H.selectionEnd=Math.min(we,H.value.length);else{var Ee=H.ownerDocument||document,he=Ee&&Ee.defaultView||window;if(he.getSelection){var de=he.getSelection(),st=H.textContent.length,tt=Math.min($.start,st),Yt=$.end===void 0?tt:Math.min($.end,st);!de.extend&&tt>Yt&&(q=Yt,Yt=tt,tt=q);var se=Wy(H,tt),te=Wy(H,Yt);if(se&&te&&(de.rangeCount!==1||de.anchorNode!==se.node||de.anchorOffset!==se.offset||de.focusNode!==te.node||de.focusOffset!==te.offset)){var ue=Ee.createRange();ue.setStart(se.node,se.offset),de.removeAllRanges(),tt>Yt?(de.addRange(ue),de.extend(te.node,te.offset)):(ue.setEnd(te.node,te.offset),de.addRange(ue))}}}}for(Ee=[],de=H;de=de.parentNode;)de.nodeType===1&&Ee.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof H.focus=="function"&&H.focus(),H=0;H<Ee.length;H++){var Ce=Ee[H];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}Eh=!!kv,Pv=kv=null}finally{_t=M,_.p=w,V.T=p}}f.current=g,Xr=2}}function fb(){if(Xr===2){Xr=0;var f=Ya,g=$o,p=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||p){p=V.T,V.T=null;var w=_.p;_.p=2;var M=_t;_t|=4;try{qx(f,g.alternate,g)}finally{_t=M,_.p=w,V.T=p}}Xr=3}}function hb(){if(Xr===4||Xr===3){Xr=0,bt();var f=Ya,g=$o,p=el,w=$x;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?Xr=5:(Xr=0,$o=Ya=null,db(f,f.pendingLanes));var M=f.pendingLanes;if(M===0&&(Ga=null),ft(p),g=g.stateNode,ot&&typeof ot.onCommitFiberRoot=="function")try{ot.onCommitFiberRoot(vt,g,void 0,(g.current.flags&128)===128)}catch{}if(w!==null){g=V.T,M=_.p,_.p=2,V.T=null;try{for(var k=f.onRecoverableError,q=0;q<w.length;q++){var H=w[q];k(H.value,{componentStack:H.stack})}}finally{V.T=g,_.p=M}}(el&3)!==0&&hh(),ki(f),M=f.pendingLanes,(p&4194090)!==0&&(M&42)!==0?f===xv?Du++:(Du=0,xv=f):Du=0,Ru(0)}}function db(f,g){(f.pooledCacheLanes&=g)===0&&(g=f.pooledCache,g!=null&&(f.pooledCache=null,lu(g)))}function hh(f){return cb(),fb(),hb(),gb()}function gb(){if(Xr!==5)return!1;var f=Ya,g=yv;yv=0;var p=ft(el),w=V.T,M=_.p;try{_.p=32>p?32:p,V.T=null,p=Av,Av=null;var k=Ya,q=el;if(Xr=0,$o=Ya=null,el=0,(_t&6)!==0)throw Error(i(331));var H=_t;if(_t|=4,Zx(k.current),Xx(k,k.current,q,p),_t=H,Ru(0,!1),ot&&typeof ot.onPostCommitFiberRoot=="function")try{ot.onPostCommitFiberRoot(vt,k)}catch{}return!0}finally{_.p=M,V.T=w,db(f,g)}}function vb(f,g,p){g=Wn(p,g),g=Jg(f.stateNode,g,2),f=ka(f,g,2),f!==null&&(Ke(f,2),ki(f))}function jt(f,g,p){if(f.tag===3)vb(f,f,p);else for(;g!==null;){if(g.tag===3){vb(g,f,p);break}else if(g.tag===1){var w=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Ga===null||!Ga.has(w))){f=Wn(p,f),p=Ax(2),w=ka(g,p,2),w!==null&&(xx(p,w,g,f),Ke(w,2),ki(w));break}}g=g.return}}function Ev(f,g,p){var w=f.pingCache;if(w===null){w=f.pingCache=new _M;var M=new Set;w.set(g,M)}else M=w.get(g),M===void 0&&(M=new Set,w.set(g,M));M.has(p)||(gv=!0,M.add(p),f=HM.bind(null,f,g,p),g.then(f,f))}function HM(f,g,p){var w=f.pingCache;w!==null&&w.delete(g),f.pingedLanes|=f.suspendedLanes&p,f.warmLanes&=~p,Zt===f&&(Mt&p)===p&&(yr===4||yr===3&&(Mt&62914560)===Mt&&300>He()-pv?(_t&2)===0&&tl(f,0):vv|=p,Jo===Mt&&(Jo=0)),ki(f)}function mb(f,g){g===0&&(g=ze()),f=Vo(f,g),f!==null&&(Ke(f,g),ki(f))}function jM(f){var g=f.memoizedState,p=0;g!==null&&(p=g.retryLane),mb(f,p)}function KM(f,g){var p=0;switch(f.tag){case 13:var w=f.stateNode,M=f.memoizedState;M!==null&&(p=M.retryLane);break;case 19:w=f.stateNode;break;case 22:w=f.stateNode._retryCache;break;default:throw Error(i(314))}w!==null&&w.delete(g),mb(f,p)}function XM(f,g){return Ae(f,g)}var dh=null,nl=null,Sv=!1,gh=!1,Tv=!1,Hs=0;function ki(f){f!==nl&&f.next===null&&(nl===null?dh=nl=f:nl=nl.next=f),gh=!0,Sv||(Sv=!0,WM())}function Ru(f,g){if(!Tv&&gh){Tv=!0;do for(var p=!1,w=dh;w!==null;){if(f!==0){var M=w.pendingLanes;if(M===0)var k=0;else{var q=w.suspendedLanes,H=w.pingedLanes;k=(1<<31-lt(42|f)+1)-1,k&=M&~(q&~H),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(p=!0,xb(w,k))}else k=Mt,k=pe(w,w===Zt?k:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(k&3)===0||xe(w,k)||(p=!0,xb(w,k));w=w.next}while(p);Tv=!1}}function QM(){pb()}function pb(){gh=Sv=!1;var f=0;Hs!==0&&(iD()&&(f=Hs),Hs=0);for(var g=He(),p=null,w=dh;w!==null;){var M=w.next,k=yb(w,g);k===0?(w.next=null,p===null?dh=M:p.next=M,M===null&&(nl=p)):(p=w,(f!==0||(k&3)!==0)&&(gh=!0)),w=M}Ru(f)}function yb(f,g){for(var p=f.suspendedLanes,w=f.pingedLanes,M=f.expirationTimes,k=f.pendingLanes&-62914561;0<k;){var q=31-lt(k),H=1<<q,$=M[q];$===-1?((H&p)===0||(H&w)!==0)&&(M[q]=Fe(H,g)):$<=g&&(f.expiredLanes|=H),k&=~H}if(g=Zt,p=Mt,p=pe(f,f===g?p:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),w=f.callbackNode,p===0||f===g&&(zt===2||zt===9)||f.cancelPendingCommit!==null)return w!==null&&w!==null&&Re(w),f.callbackNode=null,f.callbackPriority=0;if((p&3)===0||xe(f,p)){if(g=p&-p,g===f.callbackPriority)return g;switch(w!==null&&Re(w),ft(p)){case 2:case 8:p=Ie;break;case 32:p=_e;break;case 268435456:p=it;break;default:p=_e}return w=Ab.bind(null,f),p=Ae(p,w),f.callbackPriority=g,f.callbackNode=p,g}return w!==null&&w!==null&&Re(w),f.callbackPriority=2,f.callbackNode=null,2}function Ab(f,g){if(Xr!==0&&Xr!==5)return f.callbackNode=null,f.callbackPriority=0,null;var p=f.callbackNode;if(hh()&&f.callbackNode!==p)return null;var w=Mt;return w=pe(f,f===Zt?w:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),w===0?null:(tb(f,w,g),yb(f,He()),f.callbackNode!=null&&f.callbackNode===p?Ab.bind(null,f):null)}function xb(f,g){if(hh())return null;tb(f,g,!0)}function WM(){sD(function(){(_t&6)!==0?Ae(Ze,QM):pb()})}function Mv(){return Hs===0&&(Hs=Se()),Hs}function bb(f){return f==null||typeof f=="symbol"||typeof f=="boolean"?null:typeof f=="function"?f:Sf(""+f)}function wb(f,g){var p=g.ownerDocument.createElement("input");return p.name=g.name,p.value=g.value,f.id&&p.setAttribute("form",f.id),g.parentNode.insertBefore(p,g),f=new FormData(f),p.parentNode.removeChild(p),f}function ZM(f,g,p,w,M){if(g==="submit"&&p&&p.stateNode===M){var k=bb((M[Dt]||null).action),q=w.submitter;q&&(g=(g=q[Dt]||null)?bb(g.formAction):q.getAttribute("formAction"),g!==null&&(k=g,q=null));var H=new Rf("action","action",null,w,M);f.push({event:H,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(Hs!==0){var $=q?wb(M,q):new FormData(M);Kg(p,{pending:!0,data:$,method:M.method,action:k},null,$)}}else typeof k=="function"&&(H.preventDefault(),$=q?wb(M,q):new FormData(M),Kg(p,{pending:!0,data:$,method:M.method,action:k},k,$))},currentTarget:M}]})}}for(var Dv=0;Dv<hg.length;Dv++){var Rv=hg[Dv],JM=Rv.toLowerCase(),$M=Rv[0].toUpperCase()+Rv.slice(1);hi(JM,"on"+$M)}hi(tA,"onAnimationEnd"),hi(rA,"onAnimationIteration"),hi(nA,"onAnimationStart"),hi("dblclick","onDoubleClick"),hi("focusin","onFocus"),hi("focusout","onBlur"),hi(mM,"onTransitionRun"),hi(pM,"onTransitionStart"),hi(yM,"onTransitionCancel"),hi(iA,"onTransitionEnd"),Da("onMouseEnter",["mouseout","mouseover"]),Da("onMouseLeave",["mouseout","mouseover"]),Da("onPointerEnter",["pointerout","pointerover"]),Da("onPointerLeave",["pointerout","pointerover"]),Ri("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ri("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ri("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ri("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ri("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ri("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bu));function Cb(f,g){g=(g&4)!==0;for(var p=0;p<f.length;p++){var w=f[p],M=w.event;w=w.listeners;e:{var k=void 0;if(g)for(var q=w.length-1;0<=q;q--){var H=w[q],$=H.instance,fe=H.currentTarget;if(H=H.listener,$!==k&&M.isPropagationStopped())break e;k=H,M.currentTarget=fe;try{k(M)}catch(we){th(we)}M.currentTarget=null,k=$}else for(q=0;q<w.length;q++){if(H=w[q],$=H.instance,fe=H.currentTarget,H=H.listener,$!==k&&M.isPropagationStopped())break e;k=H,M.currentTarget=fe;try{k(M)}catch(we){th(we)}M.currentTarget=null,k=$}}}}function Et(f,g){var p=g[br];p===void 0&&(p=g[br]=new Set);var w=f+"__bubble";p.has(w)||(Eb(g,f,2,!1),p.add(w))}function Bv(f,g,p){var w=0;g&&(w|=4),Eb(p,f,w,g)}var vh="_reactListening"+Math.random().toString(36).slice(2);function Iv(f){if(!f[vh]){f[vh]=!0,Ma.forEach(function(p){p!=="selectionchange"&&(eD.has(p)||Bv(p,!1,f),Bv(p,!0,f))});var g=f.nodeType===9?f:f.ownerDocument;g===null||g[vh]||(g[vh]=!0,Bv("selectionchange",!1,g))}}function Eb(f,g,p,w){switch(Xb(g)){case 2:var M=MD;break;case 8:M=DD;break;default:M=Hv}p=M.bind(null,g,p,f),M=void 0,!$0||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(M=!0),w?M!==void 0?f.addEventListener(g,p,{capture:!0,passive:M}):f.addEventListener(g,p,!0):M!==void 0?f.addEventListener(g,p,{passive:M}):f.addEventListener(g,p,!1)}function Nv(f,g,p,w,M){var k=w;if((g&1)===0&&(g&2)===0&&w!==null)e:for(;;){if(w===null)return;var q=w.tag;if(q===3||q===4){var H=w.stateNode.containerInfo;if(H===M)break;if(q===4)for(q=w.return;q!==null;){var $=q.tag;if(($===3||$===4)&&q.stateNode.containerInfo===M)return;q=q.return}for(;H!==null;){if(q=fi(H),q===null)return;if($=q.tag,$===5||$===6||$===26||$===27){w=k=q;continue e}H=H.parentNode}}w=w.return}Iy(function(){var fe=k,we=Z0(p),Ee=[];e:{var he=aA.get(f);if(he!==void 0){var de=Rf,st=f;switch(f){case"keypress":if(Mf(p)===0)break e;case"keydown":case"keyup":de=XT;break;case"focusin":st="focus",de=ng;break;case"focusout":st="blur",de=ng;break;case"beforeblur":case"afterblur":de=ng;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=ky;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=UT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=ZT;break;case tA:case rA:case nA:de=LT;break;case iA:de=$T;break;case"scroll":case"scrollend":de=kT;break;case"wheel":de=tM;break;case"copy":case"cut":case"paste":de=zT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=Uy;break;case"toggle":case"beforetoggle":de=nM}var tt=(g&4)!==0,Yt=!tt&&(f==="scroll"||f==="scrollend"),se=tt?he!==null?he+"Capture":null:he;tt=[];for(var te=fe,ue;te!==null;){var Ce=te;if(ue=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||ue===null||se===null||(Ce=Ql(te,se),Ce!=null&&tt.push(Iu(te,Ce,ue))),Yt)break;te=te.return}0<tt.length&&(he=new de(he,st,null,p,we),Ee.push({event:he,listeners:tt}))}}if((g&7)===0){e:{if(he=f==="mouseover"||f==="pointerover",de=f==="mouseout"||f==="pointerout",he&&p!==W0&&(st=p.relatedTarget||p.fromElement)&&(fi(st)||st[Wt]))break e;if((de||he)&&(he=we.window===we?we:(he=we.ownerDocument)?he.defaultView||he.parentWindow:window,de?(st=p.relatedTarget||p.toElement,de=fe,st=st?fi(st):null,st!==null&&(Yt=s(st),tt=st.tag,st!==Yt||tt!==5&&tt!==27&&tt!==6)&&(st=null)):(de=null,st=fe),de!==st)){if(tt=ky,Ce="onMouseLeave",se="onMouseEnter",te="mouse",(f==="pointerout"||f==="pointerover")&&(tt=Uy,Ce="onPointerLeave",se="onPointerEnter",te="pointer"),Yt=de==null?he:Sr(de),ue=st==null?he:Sr(st),he=new tt(Ce,te+"leave",de,p,we),he.target=Yt,he.relatedTarget=ue,Ce=null,fi(we)===fe&&(tt=new tt(se,te+"enter",st,p,we),tt.target=ue,tt.relatedTarget=Yt,Ce=tt),Yt=Ce,de&&st)t:{for(tt=de,se=st,te=0,ue=tt;ue;ue=il(ue))te++;for(ue=0,Ce=se;Ce;Ce=il(Ce))ue++;for(;0<te-ue;)tt=il(tt),te--;for(;0<ue-te;)se=il(se),ue--;for(;te--;){if(tt===se||se!==null&&tt===se.alternate)break t;tt=il(tt),se=il(se)}tt=null}else tt=null;de!==null&&Sb(Ee,he,de,tt,!1),st!==null&&Yt!==null&&Sb(Ee,Yt,st,tt,!0)}}e:{if(he=fe?Sr(fe):window,de=he.nodeName&&he.nodeName.toLowerCase(),de==="select"||de==="input"&&he.type==="file")var Ve=Yy;else if(qy(he))if(Hy)Ve=dM;else{Ve=fM;var xt=cM}else de=he.nodeName,!de||de.toLowerCase()!=="input"||he.type!=="checkbox"&&he.type!=="radio"?fe&&Q0(fe.elementType)&&(Ve=Yy):Ve=hM;if(Ve&&(Ve=Ve(f,fe))){Gy(Ee,Ve,p,we);break e}xt&&xt(f,he,fe),f==="focusout"&&fe&&he.type==="number"&&fe.memoizedProps.value!=null&&X0(he,"number",he.value)}switch(xt=fe?Sr(fe):window,f){case"focusin":(qy(xt)||xt.contentEditable==="true")&&(ko=xt,ug=fe,nu=null);break;case"focusout":nu=ug=ko=null;break;case"mousedown":cg=!0;break;case"contextmenu":case"mouseup":case"dragend":cg=!1,$y(Ee,p,we);break;case"selectionchange":if(vM)break;case"keydown":case"keyup":$y(Ee,p,we)}var Qe;if(ag)e:{switch(f){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else Fo?_y(f,p)&&(nt="onCompositionEnd"):f==="keydown"&&p.keyCode===229&&(nt="onCompositionStart");nt&&(Vy&&p.locale!=="ko"&&(Fo||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&Fo&&(Qe=Ny()):(Ba=we,eg="value"in Ba?Ba.value:Ba.textContent,Fo=!0)),xt=mh(fe,nt),0<xt.length&&(nt=new Py(nt,f,null,p,we),Ee.push({event:nt,listeners:xt}),Qe?nt.data=Qe:(Qe=zy(p),Qe!==null&&(nt.data=Qe)))),(Qe=aM?sM(f,p):oM(f,p))&&(nt=mh(fe,"onBeforeInput"),0<nt.length&&(xt=new Py("onBeforeInput","beforeinput",null,p,we),Ee.push({event:xt,listeners:nt}),xt.data=Qe)),ZM(Ee,f,fe,p,we)}Cb(Ee,g)})}function Iu(f,g,p){return{instance:f,listener:g,currentTarget:p}}function mh(f,g){for(var p=g+"Capture",w=[];f!==null;){var M=f,k=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||k===null||(M=Ql(f,p),M!=null&&w.unshift(Iu(f,M,k)),M=Ql(f,g),M!=null&&w.push(Iu(f,M,k))),f.tag===3)return w;f=f.return}return[]}function il(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5&&f.tag!==27);return f||null}function Sb(f,g,p,w,M){for(var k=g._reactName,q=[];p!==null&&p!==w;){var H=p,$=H.alternate,fe=H.stateNode;if(H=H.tag,$!==null&&$===w)break;H!==5&&H!==26&&H!==27||fe===null||($=fe,M?(fe=Ql(p,k),fe!=null&&q.unshift(Iu(p,fe,$))):M||(fe=Ql(p,k),fe!=null&&q.push(Iu(p,fe,$)))),p=p.return}q.length!==0&&f.push({event:g,listeners:q})}var tD=/\r\n?/g,rD=/\u0000|\uFFFD/g;function Tb(f){return(typeof f=="string"?f:""+f).replace(tD,`
`).replace(rD,"")}function Mb(f,g){return g=Tb(g),Tb(f)===g}function ph(){}function Gt(f,g,p,w,M,k){switch(p){case"children":typeof w=="string"?g==="body"||g==="textarea"&&w===""||Bo(f,w):(typeof w=="number"||typeof w=="bigint")&&g!=="body"&&Bo(f,""+w);break;case"className":Eo(f,"class",w);break;case"tabIndex":Eo(f,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":Eo(f,p,w);break;case"style":Ry(f,w,k);break;case"data":if(g!=="object"){Eo(f,"data",w);break}case"src":case"href":if(w===""&&(g!=="a"||p!=="href")){f.removeAttribute(p);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){f.removeAttribute(p);break}w=Sf(""+w),f.setAttribute(p,w);break;case"action":case"formAction":if(typeof w=="function"){f.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(p==="formAction"?(g!=="input"&&Gt(f,g,"name",M.name,M,null),Gt(f,g,"formEncType",M.formEncType,M,null),Gt(f,g,"formMethod",M.formMethod,M,null),Gt(f,g,"formTarget",M.formTarget,M,null)):(Gt(f,g,"encType",M.encType,M,null),Gt(f,g,"method",M.method,M,null),Gt(f,g,"target",M.target,M,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){f.removeAttribute(p);break}w=Sf(""+w),f.setAttribute(p,w);break;case"onClick":w!=null&&(f.onclick=ph);break;case"onScroll":w!=null&&Et("scroll",f);break;case"onScrollEnd":w!=null&&Et("scrollend",f);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(i(61));if(p=w.__html,p!=null){if(M.children!=null)throw Error(i(60));f.innerHTML=p}}break;case"multiple":f.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":f.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){f.removeAttribute("xlink:href");break}p=Sf(""+w),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?f.setAttribute(p,""+w):f.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?f.setAttribute(p,""):f.removeAttribute(p);break;case"capture":case"download":w===!0?f.setAttribute(p,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?f.setAttribute(p,w):f.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?f.setAttribute(p,w):f.removeAttribute(p);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?f.removeAttribute(p):f.setAttribute(p,w);break;case"popover":Et("beforetoggle",f),Et("toggle",f),Co(f,"popover",w);break;case"xlinkActuate":fn(f,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":fn(f,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":fn(f,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":fn(f,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":fn(f,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":fn(f,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":fn(f,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":fn(f,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":fn(f,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":Co(f,"is",w);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=NT.get(p)||p,Co(f,p,w))}}function Fv(f,g,p,w,M,k){switch(p){case"style":Ry(f,w,k);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(i(61));if(p=w.__html,p!=null){if(M.children!=null)throw Error(i(60));f.innerHTML=p}}break;case"children":typeof w=="string"?Bo(f,w):(typeof w=="number"||typeof w=="bigint")&&Bo(f,""+w);break;case"onScroll":w!=null&&Et("scroll",f);break;case"onScrollEnd":w!=null&&Et("scrollend",f);break;case"onClick":w!=null&&(f.onclick=ph);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!cn.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(M=p.endsWith("Capture"),g=p.slice(2,M?p.length-7:void 0),k=f[Dt]||null,k=k!=null?k[p]:null,typeof k=="function"&&f.removeEventListener(g,k,M),typeof w=="function")){typeof k!="function"&&k!==null&&(p in f?f[p]=null:f.hasAttribute(p)&&f.removeAttribute(p)),f.addEventListener(g,w,M);break e}p in f?f[p]=w:w===!0?f.setAttribute(p,""):Co(f,p,w)}}}function Qr(f,g,p){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",f),Et("load",f);var w=!1,M=!1,k;for(k in p)if(p.hasOwnProperty(k)){var q=p[k];if(q!=null)switch(k){case"src":w=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:Gt(f,g,k,q,p,null)}}M&&Gt(f,g,"srcSet",p.srcSet,p,null),w&&Gt(f,g,"src",p.src,p,null);return;case"input":Et("invalid",f);var H=k=q=M=null,$=null,fe=null;for(w in p)if(p.hasOwnProperty(w)){var we=p[w];if(we!=null)switch(w){case"name":M=we;break;case"type":q=we;break;case"checked":$=we;break;case"defaultChecked":fe=we;break;case"value":k=we;break;case"defaultValue":H=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,g));break;default:Gt(f,g,w,we,p,null)}}Sy(f,k,H,$,fe,q,M,!1),Mo(f);return;case"select":Et("invalid",f),w=q=k=null;for(M in p)if(p.hasOwnProperty(M)&&(H=p[M],H!=null))switch(M){case"value":k=H;break;case"defaultValue":q=H;break;case"multiple":w=H;default:Gt(f,g,M,H,p,null)}g=k,p=q,f.multiple=!!w,g!=null?Ro(f,!!w,g,!1):p!=null&&Ro(f,!!w,p,!0);return;case"textarea":Et("invalid",f),k=M=w=null;for(q in p)if(p.hasOwnProperty(q)&&(H=p[q],H!=null))switch(q){case"value":w=H;break;case"defaultValue":M=H;break;case"children":k=H;break;case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(91));break;default:Gt(f,g,q,H,p,null)}My(f,w,M,k),Mo(f);return;case"option":for($ in p)if(p.hasOwnProperty($)&&(w=p[$],w!=null))switch($){case"selected":f.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:Gt(f,g,$,w,p,null)}return;case"dialog":Et("beforetoggle",f),Et("toggle",f),Et("cancel",f),Et("close",f);break;case"iframe":case"object":Et("load",f);break;case"video":case"audio":for(w=0;w<Bu.length;w++)Et(Bu[w],f);break;case"image":Et("error",f),Et("load",f);break;case"details":Et("toggle",f);break;case"embed":case"source":case"link":Et("error",f),Et("load",f);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in p)if(p.hasOwnProperty(fe)&&(w=p[fe],w!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:Gt(f,g,fe,w,p,null)}return;default:if(Q0(g)){for(we in p)p.hasOwnProperty(we)&&(w=p[we],w!==void 0&&Fv(f,g,we,w,p,void 0));return}}for(H in p)p.hasOwnProperty(H)&&(w=p[H],w!=null&&Gt(f,g,H,w,p,null))}function nD(f,g,p,w){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,k=null,q=null,H=null,$=null,fe=null,we=null;for(de in p){var Ee=p[de];if(p.hasOwnProperty(de)&&Ee!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":$=Ee;default:w.hasOwnProperty(de)||Gt(f,g,de,null,w,Ee)}}for(var he in w){var de=w[he];if(Ee=p[he],w.hasOwnProperty(he)&&(de!=null||Ee!=null))switch(he){case"type":k=de;break;case"name":M=de;break;case"checked":fe=de;break;case"defaultChecked":we=de;break;case"value":q=de;break;case"defaultValue":H=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,g));break;default:de!==Ee&&Gt(f,g,he,de,w,Ee)}}K0(f,q,H,$,fe,we,k,M);return;case"select":de=q=H=he=null;for(k in p)if($=p[k],p.hasOwnProperty(k)&&$!=null)switch(k){case"value":break;case"multiple":de=$;default:w.hasOwnProperty(k)||Gt(f,g,k,null,w,$)}for(M in w)if(k=w[M],$=p[M],w.hasOwnProperty(M)&&(k!=null||$!=null))switch(M){case"value":he=k;break;case"defaultValue":H=k;break;case"multiple":q=k;default:k!==$&&Gt(f,g,M,k,w,$)}g=H,p=q,w=de,he!=null?Ro(f,!!p,he,!1):!!w!=!!p&&(g!=null?Ro(f,!!p,g,!0):Ro(f,!!p,p?[]:"",!1));return;case"textarea":de=he=null;for(H in p)if(M=p[H],p.hasOwnProperty(H)&&M!=null&&!w.hasOwnProperty(H))switch(H){case"value":break;case"children":break;default:Gt(f,g,H,null,w,M)}for(q in w)if(M=w[q],k=p[q],w.hasOwnProperty(q)&&(M!=null||k!=null))switch(q){case"value":he=M;break;case"defaultValue":de=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(i(91));break;default:M!==k&&Gt(f,g,q,M,w,k)}Ty(f,he,de);return;case"option":for(var st in p)if(he=p[st],p.hasOwnProperty(st)&&he!=null&&!w.hasOwnProperty(st))switch(st){case"selected":f.selected=!1;break;default:Gt(f,g,st,null,w,he)}for($ in w)if(he=w[$],de=p[$],w.hasOwnProperty($)&&he!==de&&(he!=null||de!=null))switch($){case"selected":f.selected=he&&typeof he!="function"&&typeof he!="symbol";break;default:Gt(f,g,$,he,w,de)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tt in p)he=p[tt],p.hasOwnProperty(tt)&&he!=null&&!w.hasOwnProperty(tt)&&Gt(f,g,tt,null,w,he);for(fe in w)if(he=w[fe],de=p[fe],w.hasOwnProperty(fe)&&he!==de&&(he!=null||de!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,g));break;default:Gt(f,g,fe,he,w,de)}return;default:if(Q0(g)){for(var Yt in p)he=p[Yt],p.hasOwnProperty(Yt)&&he!==void 0&&!w.hasOwnProperty(Yt)&&Fv(f,g,Yt,void 0,w,he);for(we in w)he=w[we],de=p[we],!w.hasOwnProperty(we)||he===de||he===void 0&&de===void 0||Fv(f,g,we,he,w,de);return}}for(var se in p)he=p[se],p.hasOwnProperty(se)&&he!=null&&!w.hasOwnProperty(se)&&Gt(f,g,se,null,w,he);for(Ee in w)he=w[Ee],de=p[Ee],!w.hasOwnProperty(Ee)||he===de||he==null&&de==null||Gt(f,g,Ee,he,w,de)}var kv=null,Pv=null;function yh(f){return f.nodeType===9?f:f.ownerDocument}function Db(f){switch(f){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Rb(f,g){if(f===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return f===1&&g==="foreignObject"?0:f}function Uv(f,g){return f==="textarea"||f==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var Vv=null;function iD(){var f=window.event;return f&&f.type==="popstate"?f===Vv?!1:(Vv=f,!0):(Vv=null,!1)}var Bb=typeof setTimeout=="function"?setTimeout:void 0,aD=typeof clearTimeout=="function"?clearTimeout:void 0,Ib=typeof Promise=="function"?Promise:void 0,sD=typeof queueMicrotask=="function"?queueMicrotask:typeof Ib<"u"?function(f){return Ib.resolve(null).then(f).catch(oD)}:Bb;function oD(f){setTimeout(function(){throw f})}function ja(f){return f==="head"}function Nb(f,g){var p=g,w=0,M=0;do{var k=p.nextSibling;if(f.removeChild(p),k&&k.nodeType===8)if(p=k.data,p==="/$"){if(0<w&&8>w){p=w;var q=f.ownerDocument;if(p&1&&Nu(q.documentElement),p&2&&Nu(q.body),p&4)for(p=q.head,Nu(p),q=p.firstChild;q;){var H=q.nextSibling,$=q.nodeName;q[un]||$==="SCRIPT"||$==="STYLE"||$==="LINK"&&q.rel.toLowerCase()==="stylesheet"||p.removeChild(q),q=H}}if(M===0){f.removeChild(k),_u(g);return}M--}else p==="$"||p==="$?"||p==="$!"?M++:w=p.charCodeAt(0)-48;else w=0;p=k}while(p);_u(g)}function Ov(f){var g=f.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var p=g;switch(g=g.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Ov(p),Di(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}f.removeChild(p)}}function lD(f,g,p,w){for(;f.nodeType===1;){var M=p;if(f.nodeName.toLowerCase()!==g.toLowerCase()){if(!w&&(f.nodeName!=="INPUT"||f.type!=="hidden"))break}else if(w){if(!f[un])switch(g){case"meta":if(!f.hasAttribute("itemprop"))break;return f;case"link":if(k=f.getAttribute("rel"),k==="stylesheet"&&f.hasAttribute("data-precedence"))break;if(k!==M.rel||f.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||f.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||f.getAttribute("title")!==(M.title==null?null:M.title))break;return f;case"style":if(f.hasAttribute("data-precedence"))break;return f;case"script":if(k=f.getAttribute("src"),(k!==(M.src==null?null:M.src)||f.getAttribute("type")!==(M.type==null?null:M.type)||f.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&k&&f.hasAttribute("async")&&!f.hasAttribute("itemprop"))break;return f;default:return f}}else if(g==="input"&&f.type==="hidden"){var k=M.name==null?null:""+M.name;if(M.type==="hidden"&&f.getAttribute("name")===k)return f}else return f;if(f=gi(f.nextSibling),f===null)break}return null}function uD(f,g,p){if(g==="")return null;for(;f.nodeType!==3;)if((f.nodeType!==1||f.nodeName!=="INPUT"||f.type!=="hidden")&&!p||(f=gi(f.nextSibling),f===null))return null;return f}function Lv(f){return f.data==="$!"||f.data==="$?"&&f.ownerDocument.readyState==="complete"}function cD(f,g){var p=f.ownerDocument;if(f.data!=="$?"||p.readyState==="complete")g();else{var w=function(){g(),p.removeEventListener("DOMContentLoaded",w)};p.addEventListener("DOMContentLoaded",w),f._reactRetry=w}}function gi(f){for(;f!=null;f=f.nextSibling){var g=f.nodeType;if(g===1||g===3)break;if(g===8){if(g=f.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return f}var _v=null;function Fb(f){f=f.previousSibling;for(var g=0;f;){if(f.nodeType===8){var p=f.data;if(p==="$"||p==="$!"||p==="$?"){if(g===0)return f;g--}else p==="/$"&&g++}f=f.previousSibling}return null}function kb(f,g,p){switch(g=yh(p),f){case"html":if(f=g.documentElement,!f)throw Error(i(452));return f;case"head":if(f=g.head,!f)throw Error(i(453));return f;case"body":if(f=g.body,!f)throw Error(i(454));return f;default:throw Error(i(451))}}function Nu(f){for(var g=f.attributes;g.length;)f.removeAttributeNode(g[0]);Di(f)}var ri=new Map,Pb=new Set;function Ah(f){return typeof f.getRootNode=="function"?f.getRootNode():f.nodeType===9?f:f.ownerDocument}var ca=_.d;_.d={f:fD,r:hD,D:dD,C:gD,L:vD,m:mD,X:yD,S:pD,M:AD};function fD(){var f=ca.f(),g=ch();return f||g}function hD(f){var g=bn(f);g!==null&&g.tag===5&&g.type==="form"?tx(g):ca.r(f)}var al=typeof document>"u"?null:document;function Ub(f,g,p){var w=al;if(w&&typeof g=="string"&&g){var M=Qn(g);M='link[rel="'+f+'"][href="'+M+'"]',typeof p=="string"&&(M+='[crossorigin="'+p+'"]'),Pb.has(M)||(Pb.add(M),f={rel:f,crossOrigin:p,href:g},w.querySelector(M)===null&&(g=w.createElement("link"),Qr(g,"link",f),Rt(g),w.head.appendChild(g)))}}function dD(f){ca.D(f),Ub("dns-prefetch",f,null)}function gD(f,g){ca.C(f,g),Ub("preconnect",f,g)}function vD(f,g,p){ca.L(f,g,p);var w=al;if(w&&f&&g){var M='link[rel="preload"][as="'+Qn(g)+'"]';g==="image"&&p&&p.imageSrcSet?(M+='[imagesrcset="'+Qn(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(M+='[imagesizes="'+Qn(p.imageSizes)+'"]')):M+='[href="'+Qn(f)+'"]';var k=M;switch(g){case"style":k=sl(f);break;case"script":k=ol(f)}ri.has(k)||(f=h({rel:"preload",href:g==="image"&&p&&p.imageSrcSet?void 0:f,as:g},p),ri.set(k,f),w.querySelector(M)!==null||g==="style"&&w.querySelector(Fu(k))||g==="script"&&w.querySelector(ku(k))||(g=w.createElement("link"),Qr(g,"link",f),Rt(g),w.head.appendChild(g)))}}function mD(f,g){ca.m(f,g);var p=al;if(p&&f){var w=g&&typeof g.as=="string"?g.as:"script",M='link[rel="modulepreload"][as="'+Qn(w)+'"][href="'+Qn(f)+'"]',k=M;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=ol(f)}if(!ri.has(k)&&(f=h({rel:"modulepreload",href:f},g),ri.set(k,f),p.querySelector(M)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(ku(k)))return}w=p.createElement("link"),Qr(w,"link",f),Rt(w),p.head.appendChild(w)}}}function pD(f,g,p){ca.S(f,g,p);var w=al;if(w&&f){var M=hr(w).hoistableStyles,k=sl(f);g=g||"default";var q=M.get(k);if(!q){var H={loading:0,preload:null};if(q=w.querySelector(Fu(k)))H.loading=5;else{f=h({rel:"stylesheet",href:f,"data-precedence":g},p),(p=ri.get(k))&&zv(f,p);var $=q=w.createElement("link");Rt($),Qr($,"link",f),$._p=new Promise(function(fe,we){$.onload=fe,$.onerror=we}),$.addEventListener("load",function(){H.loading|=1}),$.addEventListener("error",function(){H.loading|=2}),H.loading|=4,xh(q,g,w)}q={type:"stylesheet",instance:q,count:1,state:H},M.set(k,q)}}}function yD(f,g){ca.X(f,g);var p=al;if(p&&f){var w=hr(p).hoistableScripts,M=ol(f),k=w.get(M);k||(k=p.querySelector(ku(M)),k||(f=h({src:f,async:!0},g),(g=ri.get(M))&&qv(f,g),k=p.createElement("script"),Rt(k),Qr(k,"link",f),p.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},w.set(M,k))}}function AD(f,g){ca.M(f,g);var p=al;if(p&&f){var w=hr(p).hoistableScripts,M=ol(f),k=w.get(M);k||(k=p.querySelector(ku(M)),k||(f=h({src:f,async:!0,type:"module"},g),(g=ri.get(M))&&qv(f,g),k=p.createElement("script"),Rt(k),Qr(k,"link",f),p.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},w.set(M,k))}}function Vb(f,g,p,w){var M=(M=oe.current)?Ah(M):null;if(!M)throw Error(i(446));switch(f){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(g=sl(p.href),p=hr(M).hoistableStyles,w=p.get(g),w||(w={type:"style",instance:null,count:0,state:null},p.set(g,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){f=sl(p.href);var k=hr(M).hoistableStyles,q=k.get(f);if(q||(M=M.ownerDocument||M,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(f,q),(k=M.querySelector(Fu(f)))&&!k._p&&(q.instance=k,q.state.loading=5),ri.has(f)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},ri.set(f,p),k||xD(M,f,p,q.state))),g&&w===null)throw Error(i(528,""));return q}if(g&&w!==null)throw Error(i(529,""));return null;case"script":return g=p.async,p=p.src,typeof p=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=ol(p),p=hr(M).hoistableScripts,w=p.get(g),w||(w={type:"script",instance:null,count:0,state:null},p.set(g,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,f))}}function sl(f){return'href="'+Qn(f)+'"'}function Fu(f){return'link[rel="stylesheet"]['+f+"]"}function Ob(f){return h({},f,{"data-precedence":f.precedence,precedence:null})}function xD(f,g,p,w){f.querySelector('link[rel="preload"][as="style"]['+g+"]")?w.loading=1:(g=f.createElement("link"),w.preload=g,g.addEventListener("load",function(){return w.loading|=1}),g.addEventListener("error",function(){return w.loading|=2}),Qr(g,"link",p),Rt(g),f.head.appendChild(g))}function ol(f){return'[src="'+Qn(f)+'"]'}function ku(f){return"script[async]"+f}function Lb(f,g,p){if(g.count++,g.instance===null)switch(g.type){case"style":var w=f.querySelector('style[data-href~="'+Qn(p.href)+'"]');if(w)return g.instance=w,Rt(w),w;var M=h({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return w=(f.ownerDocument||f).createElement("style"),Rt(w),Qr(w,"style",M),xh(w,p.precedence,f),g.instance=w;case"stylesheet":M=sl(p.href);var k=f.querySelector(Fu(M));if(k)return g.state.loading|=4,g.instance=k,Rt(k),k;w=Ob(p),(M=ri.get(M))&&zv(w,M),k=(f.ownerDocument||f).createElement("link"),Rt(k);var q=k;return q._p=new Promise(function(H,$){q.onload=H,q.onerror=$}),Qr(k,"link",w),g.state.loading|=4,xh(k,p.precedence,f),g.instance=k;case"script":return k=ol(p.src),(M=f.querySelector(ku(k)))?(g.instance=M,Rt(M),M):(w=p,(M=ri.get(k))&&(w=h({},p),qv(w,M)),f=f.ownerDocument||f,M=f.createElement("script"),Rt(M),Qr(M,"link",w),f.head.appendChild(M),g.instance=M);case"void":return null;default:throw Error(i(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(w=g.instance,g.state.loading|=4,xh(w,p.precedence,f));return g.instance}function xh(f,g,p){for(var w=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=w.length?w[w.length-1]:null,k=M,q=0;q<w.length;q++){var H=w[q];if(H.dataset.precedence===g)k=H;else if(k!==M)break}k?k.parentNode.insertBefore(f,k.nextSibling):(g=p.nodeType===9?p.head:p,g.insertBefore(f,g.firstChild))}function zv(f,g){f.crossOrigin==null&&(f.crossOrigin=g.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=g.referrerPolicy),f.title==null&&(f.title=g.title)}function qv(f,g){f.crossOrigin==null&&(f.crossOrigin=g.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=g.referrerPolicy),f.integrity==null&&(f.integrity=g.integrity)}var bh=null;function _b(f,g,p){if(bh===null){var w=new Map,M=bh=new Map;M.set(p,w)}else M=bh,w=M.get(p),w||(w=new Map,M.set(p,w));if(w.has(f))return w;for(w.set(f,null),p=p.getElementsByTagName(f),M=0;M<p.length;M++){var k=p[M];if(!(k[un]||k[wt]||f==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var q=k.getAttribute(g)||"";q=f+q;var H=w.get(q);H?H.push(k):w.set(q,[k])}}return w}function zb(f,g,p){f=f.ownerDocument||f,f.head.insertBefore(p,g==="title"?f.querySelector("head > title"):null)}function bD(f,g,p){if(p===1||g.itemProp!=null)return!1;switch(f){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return f=g.disabled,typeof g.precedence=="string"&&f==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function qb(f){return!(f.type==="stylesheet"&&(f.state.loading&3)===0)}var Pu=null;function wD(){}function CD(f,g,p){if(Pu===null)throw Error(i(475));var w=Pu;if(g.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var M=sl(p.href),k=f.querySelector(Fu(M));if(k){f=k._p,f!==null&&typeof f=="object"&&typeof f.then=="function"&&(w.count++,w=wh.bind(w),f.then(w,w)),g.state.loading|=4,g.instance=k,Rt(k);return}k=f.ownerDocument||f,p=Ob(p),(M=ri.get(M))&&zv(p,M),k=k.createElement("link"),Rt(k);var q=k;q._p=new Promise(function(H,$){q.onload=H,q.onerror=$}),Qr(k,"link",p),g.instance=k}w.stylesheets===null&&(w.stylesheets=new Map),w.stylesheets.set(g,f),(f=g.state.preload)&&(g.state.loading&3)===0&&(w.count++,g=wh.bind(w),f.addEventListener("load",g),f.addEventListener("error",g))}}function ED(){if(Pu===null)throw Error(i(475));var f=Pu;return f.stylesheets&&f.count===0&&Gv(f,f.stylesheets),0<f.count?function(g){var p=setTimeout(function(){if(f.stylesheets&&Gv(f,f.stylesheets),f.unsuspend){var w=f.unsuspend;f.unsuspend=null,w()}},6e4);return f.unsuspend=g,function(){f.unsuspend=null,clearTimeout(p)}}:null}function wh(){if(this.count--,this.count===0){if(this.stylesheets)Gv(this,this.stylesheets);else if(this.unsuspend){var f=this.unsuspend;this.unsuspend=null,f()}}}var Ch=null;function Gv(f,g){f.stylesheets=null,f.unsuspend!==null&&(f.count++,Ch=new Map,g.forEach(SD,f),Ch=null,wh.call(f))}function SD(f,g){if(!(g.state.loading&4)){var p=Ch.get(f);if(p)var w=p.get(null);else{p=new Map,Ch.set(f,p);for(var M=f.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<M.length;k++){var q=M[k];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(p.set(q.dataset.precedence,q),w=q)}w&&p.set(null,w)}M=g.instance,q=M.getAttribute("data-precedence"),k=p.get(q)||w,k===w&&p.set(null,M),p.set(q,M),this.count++,w=wh.bind(this),M.addEventListener("load",w),M.addEventListener("error",w),k?k.parentNode.insertBefore(M,k.nextSibling):(f=f.nodeType===9?f.head:f,f.insertBefore(M,f.firstChild)),g.state.loading|=4}}var Uu={$$typeof:E,Provider:null,Consumer:null,_currentValue:G,_currentValue2:G,_threadCount:0};function TD(f,g,p,w,M,k,q,H){this.tag=1,this.containerInfo=f,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ke(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ke(0),this.hiddenUpdates=ke(null),this.identifierPrefix=w,this.onUncaughtError=M,this.onCaughtError=k,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function Gb(f,g,p,w,M,k,q,H,$,fe,we,Ee){return f=new TD(f,g,p,q,H,$,fe,Ee),g=1,k===!0&&(g|=24),k=Un(3,null,null,g),f.current=k,k.stateNode=f,g=Eg(),g.refCount++,f.pooledCache=g,g.refCount++,k.memoizedState={element:w,isDehydrated:p,cache:g},Dg(k),f}function Yb(f){return f?(f=Oo,f):Oo}function Hb(f,g,p,w,M,k){M=Yb(M),w.context===null?w.context=M:w.pendingContext=M,w=Fa(g),w.payload={element:p},k=k===void 0?null:k,k!==null&&(w.callback=k),p=ka(f,w,g),p!==null&&(zn(p,f,g),hu(p,f,g))}function jb(f,g){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var p=f.retryLane;f.retryLane=p!==0&&p<g?p:g}}function Yv(f,g){jb(f,g),(f=f.alternate)&&jb(f,g)}function Kb(f){if(f.tag===13){var g=Vo(f,67108864);g!==null&&zn(g,f,67108864),Yv(f,67108864)}}var Eh=!0;function MD(f,g,p,w){var M=V.T;V.T=null;var k=_.p;try{_.p=2,Hv(f,g,p,w)}finally{_.p=k,V.T=M}}function DD(f,g,p,w){var M=V.T;V.T=null;var k=_.p;try{_.p=8,Hv(f,g,p,w)}finally{_.p=k,V.T=M}}function Hv(f,g,p,w){if(Eh){var M=jv(w);if(M===null)Nv(f,g,w,Sh,p),Qb(f,w);else if(BD(M,f,g,p,w))w.stopPropagation();else if(Qb(f,w),g&4&&-1<RD.indexOf(f)){for(;M!==null;){var k=bn(M);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var q=ge(k.pendingLanes);if(q!==0){var H=k;for(H.pendingLanes|=2,H.entangledLanes|=2;q;){var $=1<<31-lt(q);H.entanglements[1]|=$,q&=~$}ki(k),(_t&6)===0&&(lh=He()+500,Ru(0))}}break;case 13:H=Vo(k,2),H!==null&&zn(H,k,2),ch(),Yv(k,2)}if(k=jv(w),k===null&&Nv(f,g,w,Sh,p),k===M)break;M=k}M!==null&&w.stopPropagation()}else Nv(f,g,w,null,p)}}function jv(f){return f=Z0(f),Kv(f)}var Sh=null;function Kv(f){if(Sh=null,f=fi(f),f!==null){var g=s(f);if(g===null)f=null;else{var p=g.tag;if(p===13){if(f=o(g),f!==null)return f;f=null}else if(p===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;f=null}else g!==f&&(f=null)}}return Sh=f,null}function Xb(f){switch(f){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch($e()){case Ze:return 2;case Ie:return 8;case _e:case je:return 32;case it:return 268435456;default:return 32}default:return 32}}var Xv=!1,Ka=null,Xa=null,Qa=null,Vu=new Map,Ou=new Map,Wa=[],RD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Qb(f,g){switch(f){case"focusin":case"focusout":Ka=null;break;case"dragenter":case"dragleave":Xa=null;break;case"mouseover":case"mouseout":Qa=null;break;case"pointerover":case"pointerout":Vu.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ou.delete(g.pointerId)}}function Lu(f,g,p,w,M,k){return f===null||f.nativeEvent!==k?(f={blockedOn:g,domEventName:p,eventSystemFlags:w,nativeEvent:k,targetContainers:[M]},g!==null&&(g=bn(g),g!==null&&Kb(g)),f):(f.eventSystemFlags|=w,g=f.targetContainers,M!==null&&g.indexOf(M)===-1&&g.push(M),f)}function BD(f,g,p,w,M){switch(g){case"focusin":return Ka=Lu(Ka,f,g,p,w,M),!0;case"dragenter":return Xa=Lu(Xa,f,g,p,w,M),!0;case"mouseover":return Qa=Lu(Qa,f,g,p,w,M),!0;case"pointerover":var k=M.pointerId;return Vu.set(k,Lu(Vu.get(k)||null,f,g,p,w,M)),!0;case"gotpointercapture":return k=M.pointerId,Ou.set(k,Lu(Ou.get(k)||null,f,g,p,w,M)),!0}return!1}function Wb(f){var g=fi(f.target);if(g!==null){var p=s(g);if(p!==null){if(g=p.tag,g===13){if(g=o(p),g!==null){f.blockedOn=g,ar(f.priority,function(){if(p.tag===13){var w=_n();w=dt(w);var M=Vo(p,w);M!==null&&zn(M,p,w),Yv(p,w)}});return}}else if(g===3&&p.stateNode.current.memoizedState.isDehydrated){f.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}f.blockedOn=null}function Th(f){if(f.blockedOn!==null)return!1;for(var g=f.targetContainers;0<g.length;){var p=jv(f.nativeEvent);if(p===null){p=f.nativeEvent;var w=new p.constructor(p.type,p);W0=w,p.target.dispatchEvent(w),W0=null}else return g=bn(p),g!==null&&Kb(g),f.blockedOn=p,!1;g.shift()}return!0}function Zb(f,g,p){Th(f)&&p.delete(g)}function ID(){Xv=!1,Ka!==null&&Th(Ka)&&(Ka=null),Xa!==null&&Th(Xa)&&(Xa=null),Qa!==null&&Th(Qa)&&(Qa=null),Vu.forEach(Zb),Ou.forEach(Zb)}function Mh(f,g){f.blockedOn===g&&(f.blockedOn=null,Xv||(Xv=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,ID)))}var Dh=null;function Jb(f){Dh!==f&&(Dh=f,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Dh===f&&(Dh=null);for(var g=0;g<f.length;g+=3){var p=f[g],w=f[g+1],M=f[g+2];if(typeof w!="function"){if(Kv(w||p)===null)continue;break}var k=bn(p);k!==null&&(f.splice(g,3),g-=3,Kg(k,{pending:!0,data:M,method:p.method,action:w},w,M))}}))}function _u(f){function g($){return Mh($,f)}Ka!==null&&Mh(Ka,f),Xa!==null&&Mh(Xa,f),Qa!==null&&Mh(Qa,f),Vu.forEach(g),Ou.forEach(g);for(var p=0;p<Wa.length;p++){var w=Wa[p];w.blockedOn===f&&(w.blockedOn=null)}for(;0<Wa.length&&(p=Wa[0],p.blockedOn===null);)Wb(p),p.blockedOn===null&&Wa.shift();if(p=(f.ownerDocument||f).$$reactFormReplay,p!=null)for(w=0;w<p.length;w+=3){var M=p[w],k=p[w+1],q=M[Dt]||null;if(typeof k=="function")q||Jb(p);else if(q){var H=null;if(k&&k.hasAttribute("formAction")){if(M=k,q=k[Dt]||null)H=q.formAction;else if(Kv(M)!==null)continue}else H=q.action;typeof H=="function"?p[w+1]=H:(p.splice(w,3),w-=3),Jb(p)}}}function Qv(f){this._internalRoot=f}Rh.prototype.render=Qv.prototype.render=function(f){var g=this._internalRoot;if(g===null)throw Error(i(409));var p=g.current,w=_n();Hb(p,w,f,g,null,null)},Rh.prototype.unmount=Qv.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var g=f.containerInfo;Hb(f.current,2,null,f,null,null),ch(),g[Wt]=null}};function Rh(f){this._internalRoot=f}Rh.prototype.unstable_scheduleHydration=function(f){if(f){var g=vr();f={blockedOn:null,target:f,priority:g};for(var p=0;p<Wa.length&&g!==0&&g<Wa[p].priority;p++);Wa.splice(p,0,f),p===0&&Wb(f)}};var $b=e.version;if($b!=="19.1.1")throw Error(i(527,$b,"19.1.1"));_.findDOMNode=function(f){var g=f._reactInternals;if(g===void 0)throw typeof f.render=="function"?Error(i(188)):(f=Object.keys(f).join(","),Error(i(268,f)));return f=u(g),f=f!==null?c(f):null,f=f===null?null:f.stateNode,f};var ND={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bh.isDisabled&&Bh.supportsFiber)try{vt=Bh.inject(ND),ot=Bh}catch{}}return qu.createRoot=function(f,g){if(!a(f))throw Error(i(299));var p=!1,w="",M=vx,k=mx,q=px,H=null;return g!=null&&(g.unstable_strictMode===!0&&(p=!0),g.identifierPrefix!==void 0&&(w=g.identifierPrefix),g.onUncaughtError!==void 0&&(M=g.onUncaughtError),g.onCaughtError!==void 0&&(k=g.onCaughtError),g.onRecoverableError!==void 0&&(q=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(H=g.unstable_transitionCallbacks)),g=Gb(f,1,!1,null,null,p,w,M,k,q,H,null),f[Wt]=g.current,Iv(f),new Qv(g)},qu.hydrateRoot=function(f,g,p){if(!a(f))throw Error(i(299));var w=!1,M="",k=vx,q=mx,H=px,$=null,fe=null;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(M=p.identifierPrefix),p.onUncaughtError!==void 0&&(k=p.onUncaughtError),p.onCaughtError!==void 0&&(q=p.onCaughtError),p.onRecoverableError!==void 0&&(H=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&($=p.unstable_transitionCallbacks),p.formState!==void 0&&(fe=p.formState)),g=Gb(f,1,!0,g,p??null,w,M,k,q,H,$,fe),g.context=Yb(null),p=g.current,w=_n(),w=dt(w),M=Fa(w),M.callback=null,ka(p,M,w),p=w,g.current.lanes=p,Ke(g,p),ki(g),f[Wt]=g.current,Iv(f),new Rh(g)},qu.version="19.1.1",qu}var uw;function qD(){if(uw)return Jv.exports;uw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Jv.exports=zD(),Jv.exports}var GD=qD(),r1={exports:{}},n1,cw;function YD(){if(cw)return n1;cw=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return n1=r,n1}var i1,fw;function HD(){if(fw)return i1;fw=1;var r=YD();function e(){}function n(){}return n.resetWarningCache=e,i1=function(){function i(o,l,u,c,h,d){if(d!==r){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}i.isRequired=i;function a(){return i}var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:a,element:i,elementType:i,instanceOf:a,node:i,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},i1}var hw;function jD(){return hw||(hw=1,r1.exports=HD()()),r1.exports}var KD=jD();const W=a2(KD);function o2({onExpand:r,status:e,error:n,nodes:i,onSelectNode:a}){const[s,o]=Ye.useState("DRD2"),[l,u]=Ye.useState(1),[c,h]=Ye.useState(25);Ye.useEffect(()=>{i.length&&!i.some(v=>v.id===s)&&o(i[0].id)},[i,s]);const d=v=>{v.preventDefault(),s&&r({node_id:s,depth:Number(l),limit:Number(c)})};return ie.jsxs("section",{className:"panel","data-testid":"graph-explorer",children:[ie.jsxs("header",{children:[ie.jsx("h2",{children:"Knowledge graph explorer"}),ie.jsx("p",{className:"panel-subtitle",children:"Expand the neighbourhood around a node to drive atlas overlays."})]}),ie.jsxs("form",{className:"form-grid",onSubmit:d,children:[ie.jsx("label",{htmlFor:"node-id",children:"Node identifier"}),ie.jsx("input",{id:"node-id",name:"node",value:s,onChange:v=>o(v.target.value),placeholder:"e.g. DRD2","data-testid":"graph-node-input"}),ie.jsx("label",{htmlFor:"depth",children:"Depth"}),ie.jsx("input",{id:"depth",type:"number",min:"1",max:"4",value:l,onChange:v=>u(v.target.value),"data-testid":"graph-depth-input"}),ie.jsx("label",{htmlFor:"limit",children:"Max nodes"}),ie.jsx("input",{id:"limit",type:"number",min:"1",max:"200",value:c,onChange:v=>h(v.target.value),"data-testid":"graph-limit-input"}),ie.jsx("button",{type:"submit",className:"primary",disabled:e==="loading","data-testid":"graph-expand-button",children:e==="loading"?"Expanding…":"Expand neighbourhood"})]}),n&&ie.jsx("p",{className:"form-error",role:"alert",children:n.message}),i.length>0&&ie.jsx("div",{className:"node-palette","data-testid":"graph-node-palette",children:i.slice(0,12).map(v=>ie.jsxs("button",{type:"button",className:"node-chip",onClick:()=>{o(v.id),a&&a(v.id)},children:[ie.jsx("span",{className:"node-name",children:v.name||v.id}),ie.jsx("span",{className:"node-category",children:v.category})]},v.id))})]})}o2.propTypes={onExpand:W.func.isRequired,status:W.string,error:W.instanceOf(Error),nodes:W.arrayOf(W.shape({id:W.string.isRequired,name:W.string,category:W.string})),onSelectNode:W.func};o2.defaultProps={status:"idle",error:null,nodes:[],onSelectNode:void 0};function fp(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function XD(r){if(Array.isArray(r))return r}function QD(r){if(Array.isArray(r))return fp(r)}function Cs(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function WD(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,LC(i.key),i)}}function Es(r,e,n){return e&&WD(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function Bn(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=l2(r))||e){n&&(r=n);var i=0,a=function(){};return{s:a,n:function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}},e:function(u){throw u},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,l=!1;return{s:function(){n=n.call(r)},n:function(){var u=n.next();return o=u.done,u},e:function(u){l=!0,s=u},f:function(){try{o||n.return==null||n.return()}finally{if(l)throw s}}}}function OC(r,e,n){return(e=LC(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function ZD(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function JD(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],u=!0,c=!1;try{if(s=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);u=!0);}catch(h){c=!0,a=h}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function $D(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rr(r,e){return XD(r)||JD(r,e)||l2(r,e)||$D()}function Od(r){return QD(r)||ZD(r)||l2(r)||e8()}function t8(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function LC(r){var e=t8(r,"string");return typeof e=="symbol"?e:e+""}function Pr(r){"@babel/helpers - typeof";return Pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pr(r)}function l2(r,e){if(r){if(typeof r=="string")return fp(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fp(r,e):void 0}}var Nr=typeof window>"u"?null:window,dw=Nr?Nr.navigator:null;Nr&&Nr.document;var r8=Pr(""),_C=Pr({}),n8=Pr(function(){}),i8=typeof HTMLElement>"u"?"undefined":Pr(HTMLElement),$c=function(e){return e&&e.instanceString&&gr(e.instanceString)?e.instanceString():null},Je=function(e){return e!=null&&Pr(e)==r8},gr=function(e){return e!=null&&Pr(e)===n8},Qt=function(e){return!jn(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},It=function(e){return e!=null&&Pr(e)===_C&&!Qt(e)&&e.constructor===Object},a8=function(e){return e!=null&&Pr(e)===_C},Be=function(e){return e!=null&&Pr(e)===Pr(1)&&!isNaN(e)},s8=function(e){return Be(e)&&Math.floor(e)===e},Ld=function(e){if(i8!=="undefined")return e!=null&&e instanceof HTMLElement},jn=function(e){return ef(e)||zC(e)},ef=function(e){return $c(e)==="collection"&&e._private.single},zC=function(e){return $c(e)==="collection"&&!e._private.single},u2=function(e){return $c(e)==="core"},qC=function(e){return $c(e)==="stylesheet"},o8=function(e){return $c(e)==="event"},ps=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},l8=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},u8=function(e){return It(e)&&Be(e.x1)&&Be(e.x2)&&Be(e.y1)&&Be(e.y2)},c8=function(e){return a8(e)&&gr(e.then)},f8=function(){return dw&&dw.userAgent.match(/msie|trident|edge/i)},Ul=function(e,n){n||(n=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var s=[],o=0;o<arguments.length;o++)s.push(arguments[o]);return s.join("$")});var i=function(){var s=this,o=arguments,l,u=n.apply(s,o),c=i.cache;return(l=c[u])||(l=c[u]=e.apply(s,o)),l};return i.cache={},i},c2=Ul(function(r){return r.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),d0=Ul(function(r){return r.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),GC=Ul(function(r,e){return r+e[0].toUpperCase()+e.substring(1)},function(r,e){return r+"$"+e}),gw=function(e){return ps(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},us=function(e,n){return e.slice(-1*n.length)===n},Fr="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",h8="rgb[a]?\\(("+Fr+"[%]?)\\s*,\\s*("+Fr+"[%]?)\\s*,\\s*("+Fr+"[%]?)(?:\\s*,\\s*("+Fr+"))?\\)",d8="rgb[a]?\\((?:"+Fr+"[%]?)\\s*,\\s*(?:"+Fr+"[%]?)\\s*,\\s*(?:"+Fr+"[%]?)(?:\\s*,\\s*(?:"+Fr+"))?\\)",g8="hsl[a]?\\(("+Fr+")\\s*,\\s*("+Fr+"[%])\\s*,\\s*("+Fr+"[%])(?:\\s*,\\s*("+Fr+"))?\\)",v8="hsl[a]?\\((?:"+Fr+")\\s*,\\s*(?:"+Fr+"[%])\\s*,\\s*(?:"+Fr+"[%])(?:\\s*,\\s*(?:"+Fr+"))?\\)",m8="\\#[0-9a-fA-F]{3}",p8="\\#[0-9a-fA-F]{6}",YC=function(e,n){return e<n?-1:e>n?1:0},y8=function(e,n){return-1*YC(e,n)},et=Object.assign!=null?Object.assign.bind(Object):function(r){for(var e=arguments,n=1;n<e.length;n++){var i=e[n];if(i!=null)for(var a=Object.keys(i),s=0;s<a.length;s++){var o=a[s];r[o]=i[o]}}return r},A8=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var n=e.length===4,i,a,s,o=16;return n?(i=parseInt(e[1]+e[1],o),a=parseInt(e[2]+e[2],o),s=parseInt(e[3]+e[3],o)):(i=parseInt(e[1]+e[2],o),a=parseInt(e[3]+e[4],o),s=parseInt(e[5]+e[6],o)),[i,a,s]}},x8=function(e){var n,i,a,s,o,l,u,c;function h(y,b,x){return x<0&&(x+=1),x>1&&(x-=1),x<1/6?y+(b-y)*6*x:x<1/2?b:x<2/3?y+(b-y)*(2/3-x)*6:y}var d=new RegExp("^"+g8+"$").exec(e);if(d){if(i=parseInt(d[1]),i<0?i=(360- -1*i%360)%360:i>360&&(i=i%360),i/=360,a=parseFloat(d[2]),a<0||a>100||(a=a/100,s=parseFloat(d[3]),s<0||s>100)||(s=s/100,o=d[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(a===0)l=u=c=Math.round(s*255);else{var v=s<.5?s*(1+a):s+a-s*a,m=2*s-v;l=Math.round(255*h(m,v,i+1/3)),u=Math.round(255*h(m,v,i)),c=Math.round(255*h(m,v,i-1/3))}n=[l,u,c,o]}return n},b8=function(e){var n,i=new RegExp("^"+h8+"$").exec(e);if(i){n=[];for(var a=[],s=1;s<=3;s++){var o=i[s];if(o[o.length-1]==="%"&&(a[s]=!0),o=parseFloat(o),a[s]&&(o=o/100*255),o<0||o>255)return;n.push(Math.floor(o))}var l=a[1]||a[2]||a[3],u=a[1]&&a[2]&&a[3];if(l&&!u)return;var c=i[4];if(c!==void 0){if(c=parseFloat(c),c<0||c>1)return;n.push(c)}}return n},w8=function(e){return C8[e.toLowerCase()]},HC=function(e){return(Qt(e)?e:null)||w8(e)||A8(e)||b8(e)||x8(e)},C8={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},jC=function(e){for(var n=e.map,i=e.keys,a=i.length,s=0;s<a;s++){var o=i[s];if(It(o))throw Error("Tried to set map with object key");s<i.length-1?(n[o]==null&&(n[o]={}),n=n[o]):n[o]=e.value}},KC=function(e){for(var n=e.map,i=e.keys,a=i.length,s=0;s<a;s++){var o=i[s];if(It(o))throw Error("Tried to get map with object key");if(n=n[o],n==null)return n}return n},Ih=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tf(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var a1,vw;function rf(){if(vw)return a1;vw=1;function r(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}return a1=r,a1}var s1,mw;function E8(){if(mw)return s1;mw=1;var r=typeof Ih=="object"&&Ih&&Ih.Object===Object&&Ih;return s1=r,s1}var o1,pw;function g0(){if(pw)return o1;pw=1;var r=E8(),e=typeof self=="object"&&self&&self.Object===Object&&self,n=r||e||Function("return this")();return o1=n,o1}var l1,yw;function S8(){if(yw)return l1;yw=1;var r=g0(),e=function(){return r.Date.now()};return l1=e,l1}var u1,Aw;function T8(){if(Aw)return u1;Aw=1;var r=/\s/;function e(n){for(var i=n.length;i--&&r.test(n.charAt(i)););return i}return u1=e,u1}var c1,xw;function M8(){if(xw)return c1;xw=1;var r=T8(),e=/^\s+/;function n(i){return i&&i.slice(0,r(i)+1).replace(e,"")}return c1=n,c1}var f1,bw;function f2(){if(bw)return f1;bw=1;var r=g0(),e=r.Symbol;return f1=e,f1}var h1,ww;function D8(){if(ww)return h1;ww=1;var r=f2(),e=Object.prototype,n=e.hasOwnProperty,i=e.toString,a=r?r.toStringTag:void 0;function s(o){var l=n.call(o,a),u=o[a];try{o[a]=void 0;var c=!0}catch{}var h=i.call(o);return c&&(l?o[a]=u:delete o[a]),h}return h1=s,h1}var d1,Cw;function R8(){if(Cw)return d1;Cw=1;var r=Object.prototype,e=r.toString;function n(i){return e.call(i)}return d1=n,d1}var g1,Ew;function XC(){if(Ew)return g1;Ew=1;var r=f2(),e=D8(),n=R8(),i="[object Null]",a="[object Undefined]",s=r?r.toStringTag:void 0;function o(l){return l==null?l===void 0?a:i:s&&s in Object(l)?e(l):n(l)}return g1=o,g1}var v1,Sw;function B8(){if(Sw)return v1;Sw=1;function r(e){return e!=null&&typeof e=="object"}return v1=r,v1}var m1,Tw;function nf(){if(Tw)return m1;Tw=1;var r=XC(),e=B8(),n="[object Symbol]";function i(a){return typeof a=="symbol"||e(a)&&r(a)==n}return m1=i,m1}var p1,Mw;function I8(){if(Mw)return p1;Mw=1;var r=M8(),e=rf(),n=nf(),i=NaN,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function u(c){if(typeof c=="number")return c;if(n(c))return i;if(e(c)){var h=typeof c.valueOf=="function"?c.valueOf():c;c=e(h)?h+"":h}if(typeof c!="string")return c===0?c:+c;c=r(c);var d=s.test(c);return d||o.test(c)?l(c.slice(2),d?2:8):a.test(c)?i:+c}return p1=u,p1}var y1,Dw;function N8(){if(Dw)return y1;Dw=1;var r=rf(),e=S8(),n=I8(),i="Expected a function",a=Math.max,s=Math.min;function o(l,u,c){var h,d,v,m,y,b,x=0,A=!1,C=!1,E=!0;if(typeof l!="function")throw new TypeError(i);u=n(u)||0,r(c)&&(A=!!c.leading,C="maxWait"in c,v=C?a(n(c.maxWait)||0,u):v,E="trailing"in c?!!c.trailing:E);function S(O){var U=h,L=d;return h=d=void 0,x=O,m=l.apply(L,U),m}function T(O){return x=O,y=setTimeout(B,u),A?S(O):m}function R(O){var U=O-b,L=O-x,V=u-U;return C?s(V,v-L):V}function D(O){var U=O-b,L=O-x;return b===void 0||U>=u||U<0||C&&L>=v}function B(){var O=e();if(D(O))return N(O);y=setTimeout(B,R(O))}function N(O){return y=void 0,E&&h?S(O):(h=d=void 0,m)}function I(){y!==void 0&&clearTimeout(y),x=0,h=b=d=y=void 0}function P(){return y===void 0?m:N(e())}function F(){var O=e(),U=D(O);if(h=arguments,d=this,b=O,U){if(y===void 0)return T(b);if(C)return clearTimeout(y),y=setTimeout(B,u),S(b)}return y===void 0&&(y=setTimeout(B,u)),m}return F.cancel=I,F.flush=P,F}return y1=o,y1}var F8=N8(),af=tf(F8),A1=Nr?Nr.performance:null,QC=A1&&A1.now?function(){return A1.now()}:function(){return Date.now()},k8=(function(){if(Nr){if(Nr.requestAnimationFrame)return function(r){Nr.requestAnimationFrame(r)};if(Nr.mozRequestAnimationFrame)return function(r){Nr.mozRequestAnimationFrame(r)};if(Nr.webkitRequestAnimationFrame)return function(r){Nr.webkitRequestAnimationFrame(r)};if(Nr.msRequestAnimationFrame)return function(r){Nr.msRequestAnimationFrame(r)}}return function(r){r&&setTimeout(function(){r(QC())},1e3/60)}})(),_d=function(e){return k8(e)},wa=QC,$s=9261,WC=65599,wl=5381,ZC=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$s,i=n,a;a=e.next(),!a.done;)i=i*WC+a.value|0;return i},kc=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$s;return n*WC+e|0},Pc=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wl;return(n<<5)+n+e|0},P8=function(e,n){return e*2097152+n},Ja=function(e){return e[0]*2097152+e[1]},Nh=function(e,n){return[kc(e[0],n[0]),Pc(e[1],n[1])]},Rw=function(e,n){var i={value:0,done:!1},a=0,s=e.length,o={next:function(){return a<s?i.value=e[a++]:i.done=!0,i}};return ZC(o,n)},co=function(e,n){var i={value:0,done:!1},a=0,s=e.length,o={next:function(){return a<s?i.value=e.charCodeAt(a++):i.done=!0,i}};return ZC(o,n)},JC=function(){return U8(arguments)},U8=function(e){for(var n,i=0;i<e.length;i++){var a=e[i];i===0?n=co(a):n=co(a,n)}return n};function V8(r,e,n,i,a){var s=a*Math.PI/180,o=Math.cos(s)*(r-n)-Math.sin(s)*(e-i)+n,l=Math.sin(s)*(r-n)+Math.cos(s)*(e-i)+i;return{x:o,y:l}}var O8=function(e,n,i,a,s,o){return{x:(e-i)*s+i,y:(n-a)*o+a}};function L8(r,e,n){if(n===0)return r;var i=(e.x1+e.x2)/2,a=(e.y1+e.y2)/2,s=e.w/e.h,o=1/s,l=V8(r.x,r.y,i,a,n),u=O8(l.x,l.y,i,a,s,o);return{x:u.x,y:u.y}}var Bw=!0,_8=console.warn!=null,z8=console.trace!=null,h2=Number.MAX_SAFE_INTEGER||9007199254740991,$C=function(){return!0},zd=function(){return!1},Iw=function(){return 0},d2=function(){},cr=function(e){throw new Error(e)},eE=function(e){if(e!==void 0)Bw=!!e;else return Bw},Lt=function(e){eE()&&(_8?console.warn(e):(console.log(e),z8&&console.trace()))},q8=function(e){return et({},e)},zi=function(e){return e==null?e:Qt(e)?e.slice():It(e)?q8(e):e},G8=function(e){return e.slice()},tE=function(e,n){for(n=e="";e++<36;n+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return n},Y8={},rE=function(){return Y8},$r=function(e){var n=Object.keys(e);return function(i){for(var a={},s=0;s<n.length;s++){var o=n[s],l=i?.[o];a[o]=l===void 0?e[o]:l}return a}},ys=function(e,n,i){for(var a=e.length-1;a>=0;a--)e[a]===n&&e.splice(a,1)},g2=function(e){e.splice(0,e.length)},H8=function(e,n){for(var i=0;i<n.length;i++){var a=n[i];e.push(a)}},Dn=function(e,n,i){return i&&(n=GC(i,n)),e[n]},ma=function(e,n,i,a){i&&(n=GC(i,n)),e[n]=a},j8=(function(){function r(){Cs(this,r),this._obj={}}return Es(r,[{key:"set",value:function(n,i){return this._obj[n]=i,this}},{key:"delete",value:function(n){return this._obj[n]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(n){return this._obj[n]!==void 0}},{key:"get",value:function(n){return this._obj[n]}}])})(),ya=typeof Map<"u"?Map:j8,K8="undefined",X8=(function(){function r(e){if(Cs(this,r),this._obj=Object.create(null),this.size=0,e!=null){var n;e.instanceString!=null&&e.instanceString()===this.instanceString()?n=e.toArray():n=e;for(var i=0;i<n.length;i++)this.add(n[i])}}return Es(r,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(n){var i=this._obj;i[n]!==1&&(i[n]=1,this.size++)}},{key:"delete",value:function(n){var i=this._obj;i[n]===1&&(i[n]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(n){return this._obj[n]===1}},{key:"toArray",value:function(){var n=this;return Object.keys(this._obj).filter(function(i){return n.has(i)})}},{key:"forEach",value:function(n,i){return this.toArray().forEach(n,i)}}])})(),ql=(typeof Set>"u"?"undefined":Pr(Set))!==K8?Set:X8,v0=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||n===void 0||!u2(e)){cr("An element must have a core reference and parameters set");return}var a=n.group;if(a==null&&(n.data&&n.data.source!=null&&n.data.target!=null?a="edges":a="nodes"),a!=="nodes"&&a!=="edges"){cr("An element must be of type `nodes` or `edges`; you specified `"+a+"`");return}this.length=1,this[0]=this;var s=this._private={cy:e,single:!0,data:n.data||{},position:n.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:a,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!n.selected,selectable:n.selectable===void 0?!0:!!n.selectable,locked:!!n.locked,grabbed:!1,grabbable:n.grabbable===void 0?!0:!!n.grabbable,pannable:n.pannable===void 0?a==="edges":!!n.pannable,active:!1,classes:new ql,animation:{current:[],queue:[]},rscratch:{},scratch:n.scratch||{},edges:[],children:[],parent:n.parent&&n.parent.isNode()?n.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(s.position.x==null&&(s.position.x=0),s.position.y==null&&(s.position.y=0),n.renderedPosition){var o=n.renderedPosition,l=e.pan(),u=e.zoom();s.position={x:(o.x-l.x)/u,y:(o.y-l.y)/u}}var c=[];Qt(n.classes)?c=n.classes:Je(n.classes)&&(c=n.classes.split(/\s+/));for(var h=0,d=c.length;h<d;h++){var v=c[h];!v||v===""||s.classes.add(v)}this.createEmitter(),(i===void 0||i)&&this.restore();var m=n.style||n.css;m&&(Lt("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(m))},Nw=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(i,a,s){var o;It(i)&&!jn(i)&&(o=i,i=o.roots||o.root,a=o.visit,s=o.directed),s=arguments.length===2&&!gr(a)?a:s,a=gr(a)?a:function(){};for(var l=this._private.cy,u=i=Je(i)?this.filter(i):i,c=[],h=[],d={},v={},m={},y=0,b,x=this.byGroup(),A=x.nodes,C=x.edges,E=0;E<u.length;E++){var S=u[E],T=S.id();S.isNode()&&(c.unshift(S),e.bfs&&(m[T]=!0,h.push(S)),v[T]=0)}for(var R=function(){var O=e.bfs?c.shift():c.pop(),U=O.id();if(e.dfs){if(m[U])return 0;m[U]=!0,h.push(O)}var L=v[U],V=d[U],_=V!=null?V.source():null,G=V!=null?V.target():null,K=V==null?void 0:O.same(_)?G[0]:_[0],z;if(z=a(O,V,K,y++,L),z===!0)return b=O,1;if(z===!1)return 1;for(var Y=O.connectedEdges().filter(function(oe){return(!s||oe.source().same(O))&&C.has(oe)}),Z=0;Z<Y.length;Z++){var J=Y[Z],ee=J.connectedNodes().filter(function(oe){return!oe.same(O)&&A.has(oe)}),ne=ee.id();ee.length!==0&&!m[ne]&&(ee=ee[0],c.push(ee),e.bfs&&(m[ne]=!0,h.push(ee)),d[ne]=J,v[ne]=v[U]+1)}},D;c.length!==0&&(D=R(),!(D!==0&&D===1)););for(var B=l.collection(),N=0;N<h.length;N++){var I=h[N],P=d[I.id()];P!=null&&B.push(P),B.push(I)}return{path:l.collection(B),found:l.collection(b)}}},Uc={breadthFirstSearch:Nw({bfs:!0}),depthFirstSearch:Nw({dfs:!0})};Uc.bfs=Uc.breadthFirstSearch;Uc.dfs=Uc.depthFirstSearch;var gd={exports:{}},Q8=gd.exports,Fw;function W8(){return Fw||(Fw=1,(function(r,e){(function(){var n,i,a,s,o,l,u,c,h,d,v,m,y,b,x;a=Math.floor,d=Math.min,i=function(A,C){return A<C?-1:A>C?1:0},h=function(A,C,E,S,T){var R;if(E==null&&(E=0),T==null&&(T=i),E<0)throw new Error("lo must be non-negative");for(S==null&&(S=A.length);E<S;)R=a((E+S)/2),T(C,A[R])<0?S=R:E=R+1;return[].splice.apply(A,[E,E-E].concat(C)),C},l=function(A,C,E){return E==null&&(E=i),A.push(C),b(A,0,A.length-1,E)},o=function(A,C){var E,S;return C==null&&(C=i),E=A.pop(),A.length?(S=A[0],A[0]=E,x(A,0,C)):S=E,S},c=function(A,C,E){var S;return E==null&&(E=i),S=A[0],A[0]=C,x(A,0,E),S},u=function(A,C,E){var S;return E==null&&(E=i),A.length&&E(A[0],C)<0&&(S=[A[0],C],C=S[0],A[0]=S[1],x(A,0,E)),C},s=function(A,C){var E,S,T,R,D,B;for(C==null&&(C=i),R=(function(){B=[];for(var N=0,I=a(A.length/2);0<=I?N<I:N>I;0<=I?N++:N--)B.push(N);return B}).apply(this).reverse(),D=[],S=0,T=R.length;S<T;S++)E=R[S],D.push(x(A,E,C));return D},y=function(A,C,E){var S;if(E==null&&(E=i),S=A.indexOf(C),S!==-1)return b(A,0,S,E),x(A,S,E)},v=function(A,C,E){var S,T,R,D,B;if(E==null&&(E=i),T=A.slice(0,C),!T.length)return T;for(s(T,E),B=A.slice(C),R=0,D=B.length;R<D;R++)S=B[R],u(T,S,E);return T.sort(E).reverse()},m=function(A,C,E){var S,T,R,D,B,N,I,P,F;if(E==null&&(E=i),C*10<=A.length){if(R=A.slice(0,C).sort(E),!R.length)return R;for(T=R[R.length-1],I=A.slice(C),D=0,N=I.length;D<N;D++)S=I[D],E(S,T)<0&&(h(R,S,0,null,E),R.pop(),T=R[R.length-1]);return R}for(s(A,E),F=[],B=0,P=d(C,A.length);0<=P?B<P:B>P;0<=P?++B:--B)F.push(o(A,E));return F},b=function(A,C,E,S){var T,R,D;for(S==null&&(S=i),T=A[E];E>C;){if(D=E-1>>1,R=A[D],S(T,R)<0){A[E]=R,E=D;continue}break}return A[E]=T},x=function(A,C,E){var S,T,R,D,B;for(E==null&&(E=i),T=A.length,B=C,R=A[C],S=2*C+1;S<T;)D=S+1,D<T&&!(E(A[S],A[D])<0)&&(S=D),A[C]=A[S],C=S,S=2*C+1;return A[C]=R,b(A,B,C,E)},n=(function(){A.push=l,A.pop=o,A.replace=c,A.pushpop=u,A.heapify=s,A.updateItem=y,A.nlargest=v,A.nsmallest=m;function A(C){this.cmp=C??i,this.nodes=[]}return A.prototype.push=function(C){return l(this.nodes,C,this.cmp)},A.prototype.pop=function(){return o(this.nodes,this.cmp)},A.prototype.peek=function(){return this.nodes[0]},A.prototype.contains=function(C){return this.nodes.indexOf(C)!==-1},A.prototype.replace=function(C){return c(this.nodes,C,this.cmp)},A.prototype.pushpop=function(C){return u(this.nodes,C,this.cmp)},A.prototype.heapify=function(){return s(this.nodes,this.cmp)},A.prototype.updateItem=function(C){return y(this.nodes,C,this.cmp)},A.prototype.clear=function(){return this.nodes=[]},A.prototype.empty=function(){return this.nodes.length===0},A.prototype.size=function(){return this.nodes.length},A.prototype.clone=function(){var C;return C=new A,C.nodes=this.nodes.slice(0),C},A.prototype.toArray=function(){return this.nodes.slice(0)},A.prototype.insert=A.prototype.push,A.prototype.top=A.prototype.peek,A.prototype.front=A.prototype.peek,A.prototype.has=A.prototype.contains,A.prototype.copy=A.prototype.clone,A})(),(function(A,C){return r.exports=C()})(this,function(){return n})}).call(Q8)})(gd)),gd.exports}var x1,kw;function Z8(){return kw||(kw=1,x1=W8()),x1}var J8=Z8(),sf=tf(J8),$8=$r({root:null,weight:function(e){return 1},directed:!1}),eR={dijkstra:function(e){if(!It(e)){var n=arguments;e={root:n[0],weight:n[1],directed:n[2]}}var i=$8(e),a=i.root,s=i.weight,o=i.directed,l=this,u=s,c=Je(a)?this.filter(a)[0]:a[0],h={},d={},v={},m=this.byGroup(),y=m.nodes,b=m.edges;b.unmergeBy(function(L){return L.isLoop()});for(var x=function(V){return h[V.id()]},A=function(V,_){h[V.id()]=_,C.updateItem(V)},C=new sf(function(L,V){return x(L)-x(V)}),E=0;E<y.length;E++){var S=y[E];h[S.id()]=S.same(c)?0:1/0,C.push(S)}for(var T=function(V,_){for(var G=(o?V.edgesTo(_):V.edgesWith(_)).intersect(b),K=1/0,z,Y=0;Y<G.length;Y++){var Z=G[Y],J=u(Z);(J<K||!z)&&(K=J,z=Z)}return{edge:z,dist:K}};C.size()>0;){var R=C.pop(),D=x(R),B=R.id();if(v[B]=D,D!==1/0)for(var N=R.neighborhood().intersect(y),I=0;I<N.length;I++){var P=N[I],F=P.id(),O=T(R,P),U=D+O.dist;U<x(P)&&(A(P,U),d[F]={node:R,edge:O.edge})}}return{distanceTo:function(V){var _=Je(V)?y.filter(V)[0]:V[0];return v[_.id()]},pathTo:function(V){var _=Je(V)?y.filter(V)[0]:V[0],G=[],K=_,z=K.id();if(_.length>0)for(G.unshift(_);d[z];){var Y=d[z];G.unshift(Y.edge),G.unshift(Y.node),K=Y.node,z=K.id()}return l.spawn(G)}}}},tR={kruskal:function(e){e=e||function(E){return 1};for(var n=this.byGroup(),i=n.nodes,a=n.edges,s=i.length,o=new Array(s),l=i,u=function(S){for(var T=0;T<o.length;T++){var R=o[T];if(R.has(S))return T}},c=0;c<s;c++)o[c]=this.spawn(i[c]);for(var h=a.sort(function(E,S){return e(E)-e(S)}),d=0;d<h.length;d++){var v=h[d],m=v.source()[0],y=v.target()[0],b=u(m),x=u(y),A=o[b],C=o[x];b!==x&&(l.merge(v),A.merge(C),o.splice(x,1))}return l}},rR=$r({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),nR={aStar:function(e){var n=this.cy(),i=rR(e),a=i.root,s=i.goal,o=i.heuristic,l=i.directed,u=i.weight;a=n.collection(a)[0],s=n.collection(s)[0];var c=a.id(),h=s.id(),d={},v={},m={},y=new sf(function(z,Y){return v[z.id()]-v[Y.id()]}),b=new ql,x={},A={},C=function(Y,Z){y.push(Y),b.add(Z)},E,S,T=function(){E=y.pop(),S=E.id(),b.delete(S)},R=function(Y){return b.has(Y)};C(a,c),d[c]=0,v[c]=o(a);for(var D=0;y.size()>0;){if(T(),D++,S===h){for(var B=[],N=s,I=h,P=A[I];B.unshift(N),P!=null&&B.unshift(P),N=x[I],N!=null;)I=N.id(),P=A[I];return{found:!0,distance:d[S],path:this.spawn(B),steps:D}}m[S]=!0;for(var F=E._private.edges,O=0;O<F.length;O++){var U=F[O];if(this.hasElementWithId(U.id())&&!(l&&U.data("source")!==S)){var L=U.source(),V=U.target(),_=L.id()!==S?L:V,G=_.id();if(this.hasElementWithId(G)&&!m[G]){var K=d[S]+u(U);if(!R(G)){d[G]=K,v[G]=K+o(_),C(_,G),x[G]=E,A[G]=U;continue}K<d[G]&&(d[G]=K,v[G]=K+o(_),x[G]=E,A[G]=U)}}}}return{found:!1,distance:void 0,path:void 0,steps:D}}},iR=$r({weight:function(e){return 1},directed:!1}),aR={floydWarshall:function(e){for(var n=this.cy(),i=iR(e),a=i.weight,s=i.directed,o=a,l=this.byGroup(),u=l.nodes,c=l.edges,h=u.length,d=h*h,v=function(J){return u.indexOf(J)},m=function(J){return u[J]},y=new Array(d),b=0;b<d;b++){var x=b%h,A=(b-x)/h;A===x?y[b]=0:y[b]=1/0}for(var C=new Array(d),E=new Array(d),S=0;S<c.length;S++){var T=c[S],R=T.source()[0],D=T.target()[0];if(R!==D){var B=v(R),N=v(D),I=B*h+N,P=o(T);if(y[I]>P&&(y[I]=P,C[I]=N,E[I]=T),!s){var F=N*h+B;!s&&y[F]>P&&(y[F]=P,C[F]=B,E[F]=T)}}}for(var O=0;O<h;O++)for(var U=0;U<h;U++)for(var L=U*h+O,V=0;V<h;V++){var _=U*h+V,G=O*h+V;y[L]+y[G]<y[_]&&(y[_]=y[L]+y[G],C[_]=C[L])}var K=function(J){return(Je(J)?n.filter(J):J)[0]},z=function(J){return v(K(J))},Y={distance:function(J,ee){var ne=z(J),oe=z(ee);return y[ne*h+oe]},path:function(J,ee){var ne=z(J),oe=z(ee),me=m(ne);if(ne===oe)return me.collection();if(C[ne*h+oe]==null)return n.collection();var ye=n.collection(),ve=ne,re;for(ye.merge(me);ne!==oe;)ve=ne,ne=C[ne*h+oe],re=E[ve*h+ne],ye.merge(re),ye.merge(m(ne));return ye}};return Y}},sR=$r({weight:function(e){return 1},directed:!1,root:null}),oR={bellmanFord:function(e){var n=this,i=sR(e),a=i.weight,s=i.directed,o=i.root,l=a,u=this,c=this.cy(),h=this.byGroup(),d=h.edges,v=h.nodes,m=v.length,y=new ya,b=!1,x=[];o=c.collection(o)[0],d.unmergeBy(function(He){return He.isLoop()});for(var A=d.length,C=function($e){var Ze=y.get($e.id());return Ze||(Ze={},y.set($e.id(),Ze)),Ze},E=function($e){return(Je($e)?c.$($e):$e)[0]},S=function($e){return C(E($e)).dist},T=function($e){for(var Ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,Ie=E($e),_e=[],je=Ie;;){if(je==null)return n.spawn();var it=C(je),Xe=it.edge,ht=it.pred;if(_e.unshift(je[0]),je.same(Ze)&&_e.length>0)break;Xe!=null&&_e.unshift(Xe),je=ht}return u.spawn(_e)},R=0;R<m;R++){var D=v[R],B=C(D);D.same(o)?B.dist=0:B.dist=1/0,B.pred=null,B.edge=null}for(var N=!1,I=function($e,Ze,Ie,_e,je,it){var Xe=_e.dist+it;Xe<je.dist&&!Ie.same(_e.edge)&&(je.dist=Xe,je.pred=$e,je.edge=Ie,N=!0)},P=1;P<m;P++){N=!1;for(var F=0;F<A;F++){var O=d[F],U=O.source(),L=O.target(),V=l(O),_=C(U),G=C(L);I(U,L,O,_,G,V),s||I(L,U,O,G,_,V)}if(!N)break}if(N)for(var K=[],z=0;z<A;z++){var Y=d[z],Z=Y.source(),J=Y.target(),ee=l(Y),ne=C(Z).dist,oe=C(J).dist;if(ne+ee<oe||!s&&oe+ee<ne)if(b||(Lt("Graph contains a negative weight cycle for Bellman-Ford"),b=!0),e.findNegativeWeightCycles!==!1){var me=[];ne+ee<oe&&me.push(Z),!s&&oe+ee<ne&&me.push(J);for(var ye=me.length,ve=0;ve<ye;ve++){var re=me[ve],ae=[re];ae.push(C(re).edge);for(var le=C(re).pred;ae.indexOf(le)===-1;)ae.push(le),ae.push(C(le).edge),le=C(le).pred;ae=ae.slice(ae.indexOf(le));for(var Ae=ae[0].id(),Re=0,Le=2;Le<ae.length;Le+=2)ae[Le].id()<Ae&&(Ae=ae[Le].id(),Re=Le);ae=ae.slice(Re).concat(ae.slice(0,Re)),ae.push(ae[0]);var bt=ae.map(function(He){return He.id()}).join(",");K.indexOf(bt)===-1&&(x.push(u.spawn(ae)),K.push(bt))}}else break}return{distanceTo:S,pathTo:T,hasNegativeWeightCycle:b,negativeWeightCycles:x}}},lR=Math.sqrt(2),uR=function(e,n,i){i.length===0&&cr("Karger-Stein must be run on a connected (sub)graph");for(var a=i[e],s=a[1],o=a[2],l=n[s],u=n[o],c=i,h=c.length-1;h>=0;h--){var d=c[h],v=d[1],m=d[2];(n[v]===l&&n[m]===u||n[v]===u&&n[m]===l)&&c.splice(h,1)}for(var y=0;y<c.length;y++){var b=c[y];b[1]===u?(c[y]=b.slice(),c[y][1]=l):b[2]===u&&(c[y]=b.slice(),c[y][2]=l)}for(var x=0;x<n.length;x++)n[x]===u&&(n[x]=l);return c},b1=function(e,n,i,a){for(;i>a;){var s=Math.floor(Math.random()*n.length);n=uR(s,e,n),i--}return n},cR={kargerStein:function(){var e=this,n=this.byGroup(),i=n.nodes,a=n.edges;a.unmergeBy(function(G){return G.isLoop()});var s=i.length,o=a.length,l=Math.ceil(Math.pow(Math.log(s)/Math.LN2,2)),u=Math.floor(s/lR);if(s<2){cr("At least 2 nodes are required for Karger-Stein algorithm");return}for(var c=[],h=0;h<o;h++){var d=a[h];c.push([h,i.indexOf(d.source()),i.indexOf(d.target())])}for(var v=1/0,m=[],y=new Array(s),b=new Array(s),x=new Array(s),A=function(K,z){for(var Y=0;Y<s;Y++)z[Y]=K[Y]},C=0;C<=l;C++){for(var E=0;E<s;E++)b[E]=E;var S=b1(b,c.slice(),s,u),T=S.slice();A(b,x);var R=b1(b,S,u,2),D=b1(x,T,u,2);R.length<=D.length&&R.length<v?(v=R.length,m=R,A(b,y)):D.length<=R.length&&D.length<v&&(v=D.length,m=D,A(x,y))}for(var B=this.spawn(m.map(function(G){return a[G[0]]})),N=this.spawn(),I=this.spawn(),P=y[0],F=0;F<y.length;F++){var O=y[F],U=i[F];O===P?N.merge(U):I.merge(U)}var L=function(K){var z=e.spawn();return K.forEach(function(Y){z.merge(Y),Y.connectedEdges().forEach(function(Z){e.contains(Z)&&!B.contains(Z)&&z.merge(Z)})}),z},V=[L(N),L(I)],_={cut:B,components:V,partition1:N,partition2:I};return _}},w1,fR=function(e){return{x:e.x,y:e.y}},m0=function(e,n,i){return{x:e.x*n+i.x,y:e.y*n+i.y}},nE=function(e,n,i){return{x:(e.x-i.x)/n,y:(e.y-i.y)/n}},Tl=function(e){return{x:e[0],y:e[1]}},hR=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=1/0,s=n;s<i;s++){var o=e[s];isFinite(o)&&(a=Math.min(o,a))}return a},dR=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=-1/0,s=n;s<i;s++){var o=e[s];isFinite(o)&&(a=Math.max(o,a))}return a},gR=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=0,s=0,o=n;o<i;o++){var l=e[o];isFinite(l)&&(a+=l,s++)}return a/s},vR=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;a?e=e.slice(n,i):(i<e.length&&e.splice(i,e.length-i),n>0&&e.splice(0,n));for(var l=0,u=e.length-1;u>=0;u--){var c=e[u];o?isFinite(c)||(e[u]=-1/0,l++):e.splice(u,1)}s&&e.sort(function(v,m){return v-m});var h=e.length,d=Math.floor(h/2);return h%2!==0?e[d+1+l]:(e[d-1+l]+e[d+l])/2},mR=function(e){return Math.PI*e/180},Fh=function(e,n){return Math.atan2(n,e)-Math.PI/2},v2=Math.log2||function(r){return Math.log(r)/Math.log(2)},m2=function(e){return e>0?1:e<0?-1:0},fo=function(e,n){return Math.sqrt(Zs(e,n))},Zs=function(e,n){var i=n.x-e.x,a=n.y-e.y;return i*i+a*a},pR=function(e){for(var n=e.length,i=0,a=0;a<n;a++)i+=e[a];for(var s=0;s<n;s++)e[s]=e[s]/i;return e},zr=function(e,n,i,a){return(1-a)*(1-a)*e+2*(1-a)*a*n+a*a*i},Bl=function(e,n,i,a){return{x:zr(e.x,n.x,i.x,a),y:zr(e.y,n.y,i.y,a)}},yR=function(e,n,i,a){var s={x:n.x-e.x,y:n.y-e.y},o=fo(e,n),l={x:s.x/o,y:s.y/o};return i=i??0,a=a??i*o,{x:e.x+l.x*a,y:e.y+l.y*a}},Vc=function(e,n,i){return Math.max(e,Math.min(i,n))},yn=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},AR=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},xR=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},bR=function(e,n){e.x1=Math.min(e.x1,n.x1),e.x2=Math.max(e.x2,n.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n.y1),e.y2=Math.max(e.y2,n.y2),e.h=e.y2-e.y1},iE=function(e,n,i){e.x1=Math.min(e.x1,n),e.x2=Math.max(e.x2,n),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,i),e.y2=Math.max(e.y2,i),e.h=e.y2-e.y1},vd=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=n,e.x2+=n,e.y1-=n,e.y2+=n,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},md=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],i,a,s,o;if(n.length===1)i=a=s=o=n[0];else if(n.length===2)i=s=n[0],o=a=n[1];else if(n.length===4){var l=Rr(n,4);i=l[0],a=l[1],s=l[2],o=l[3]}return e.x1-=o,e.x2+=a,e.y1-=i,e.y2+=s,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Pw=function(e,n){e.x1=n.x1,e.y1=n.y1,e.x2=n.x2,e.y2=n.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},p2=function(e,n){return!(e.x1>n.x2||n.x1>e.x2||e.x2<n.x1||n.x2<e.x1||e.y2<n.y1||n.y2<e.y1||e.y1>n.y2||n.y1>e.y2)},cs=function(e,n,i){return e.x1<=n&&n<=e.x2&&e.y1<=i&&i<=e.y2},Uw=function(e,n){return cs(e,n.x,n.y)},aE=function(e,n){return cs(e,n.x1,n.y1)&&cs(e,n.x2,n.y2)},wR=(w1=Math.hypot)!==null&&w1!==void 0?w1:function(r,e){return Math.sqrt(r*r+e*e)};function CR(r,e){if(r.length<3)throw new Error("Need at least 3 vertices");var n=function(B,N){return{x:B.x+N.x,y:B.y+N.y}},i=function(B,N){return{x:B.x-N.x,y:B.y-N.y}},a=function(B,N){return{x:B.x*N,y:B.y*N}},s=function(B,N){return B.x*N.y-B.y*N.x},o=function(B){var N=wR(B.x,B.y);return N===0?{x:0,y:0}:{x:B.x/N,y:B.y/N}},l=function(B){for(var N=0,I=0;I<B.length;I++){var P=B[I],F=B[(I+1)%B.length];N+=P.x*F.y-F.x*P.y}return N/2},u=function(B,N,I,P){var F=i(N,B),O=i(P,I),U=s(F,O);if(Math.abs(U)<1e-9)return n(B,a(F,.5));var L=s(i(I,B),O)/U;return n(B,a(F,L))},c=r.map(function(D){return{x:D.x,y:D.y}});l(c)<0&&c.reverse();for(var h=c.length,d=[],v=0;v<h;v++){var m=c[v],y=c[(v+1)%h],b=i(y,m),x=o({x:b.y,y:-b.x});d.push(x)}for(var A=d.map(function(D,B){var N=n(c[B],a(D,e)),I=n(c[(B+1)%h],a(D,e));return{p1:N,p2:I}}),C=[],E=0;E<h;E++){var S=A[(E-1+h)%h],T=A[E],R=u(S.p1,S.p2,T.p1,T.p2);C.push(R)}return C}function ER(r,e,n,i,a,s){var o=FR(r,e,n,i,a),l=CR(o,s),u=yn();return l.forEach(function(c){return iE(u,c.x,c.y)}),u}var sE=function(e,n,i,a,s,o,l){var u=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",c=u==="auto"?As(s,o):u,h=s/2,d=o/2;c=Math.min(c,h,d);var v=c!==h,m=c!==d,y;if(v){var b=i-h+c-l,x=a-d-l,A=i+h-c+l,C=x;if(y=fs(e,n,i,a,b,x,A,C,!1),y.length>0)return y}if(m){var E=i+h+l,S=a-d+c-l,T=E,R=a+d-c+l;if(y=fs(e,n,i,a,E,S,T,R,!1),y.length>0)return y}if(v){var D=i-h+c-l,B=a+d+l,N=i+h-c+l,I=B;if(y=fs(e,n,i,a,D,B,N,I,!1),y.length>0)return y}if(m){var P=i-h-l,F=a-d+c-l,O=P,U=a+d-c+l;if(y=fs(e,n,i,a,P,F,O,U,!1),y.length>0)return y}var L;{var V=i-h+c,_=a-d+c;if(L=dc(e,n,i,a,V,_,c+l),L.length>0&&L[0]<=V&&L[1]<=_)return[L[0],L[1]]}{var G=i+h-c,K=a-d+c;if(L=dc(e,n,i,a,G,K,c+l),L.length>0&&L[0]>=G&&L[1]<=K)return[L[0],L[1]]}{var z=i+h-c,Y=a+d-c;if(L=dc(e,n,i,a,z,Y,c+l),L.length>0&&L[0]>=z&&L[1]>=Y)return[L[0],L[1]]}{var Z=i-h+c,J=a+d-c;if(L=dc(e,n,i,a,Z,J,c+l),L.length>0&&L[0]<=Z&&L[1]>=J)return[L[0],L[1]]}return[]},SR=function(e,n,i,a,s,o,l){var u=l,c=Math.min(i,s),h=Math.max(i,s),d=Math.min(a,o),v=Math.max(a,o);return c-u<=e&&e<=h+u&&d-u<=n&&n<=v+u},TR=function(e,n,i,a,s,o,l,u,c){var h={x1:Math.min(i,l,s)-c,x2:Math.max(i,l,s)+c,y1:Math.min(a,u,o)-c,y2:Math.max(a,u,o)+c};return!(e<h.x1||e>h.x2||n<h.y1||n>h.y2)},MR=function(e,n,i,a){i-=a;var s=n*n-4*e*i;if(s<0)return[];var o=Math.sqrt(s),l=2*e,u=(-n+o)/l,c=(-n-o)/l;return[u,c]},DR=function(e,n,i,a,s){var o=1e-5;e===0&&(e=o),n/=e,i/=e,a/=e;var l,u,c,h,d,v,m,y;if(u=(3*i-n*n)/9,c=-(27*a)+n*(9*i-2*(n*n)),c/=54,l=u*u*u+c*c,s[1]=0,m=n/3,l>0){d=c+Math.sqrt(l),d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),v=c-Math.sqrt(l),v=v<0?-Math.pow(-v,1/3):Math.pow(v,1/3),s[0]=-m+d+v,m+=(d+v)/2,s[4]=s[2]=-m,m=Math.sqrt(3)*(-v+d)/2,s[3]=m,s[5]=-m;return}if(s[5]=s[3]=0,l===0){y=c<0?-Math.pow(-c,1/3):Math.pow(c,1/3),s[0]=-m+2*y,s[4]=s[2]=-(y+m);return}u=-u,h=u*u*u,h=Math.acos(c/Math.sqrt(h)),y=2*Math.sqrt(u),s[0]=-m+y*Math.cos(h/3),s[2]=-m+y*Math.cos((h+2*Math.PI)/3),s[4]=-m+y*Math.cos((h+4*Math.PI)/3)},RR=function(e,n,i,a,s,o,l,u){var c=1*i*i-4*i*s+2*i*l+4*s*s-4*s*l+l*l+a*a-4*a*o+2*a*u+4*o*o-4*o*u+u*u,h=9*i*s-3*i*i-3*i*l-6*s*s+3*s*l+9*a*o-3*a*a-3*a*u-6*o*o+3*o*u,d=3*i*i-6*i*s+i*l-i*e+2*s*s+2*s*e-l*e+3*a*a-6*a*o+a*u-a*n+2*o*o+2*o*n-u*n,v=1*i*s-i*i+i*e-s*e+a*o-a*a+a*n-o*n,m=[];DR(c,h,d,v,m);for(var y=1e-7,b=[],x=0;x<6;x+=2)Math.abs(m[x+1])<y&&m[x]>=0&&m[x]<=1&&b.push(m[x]);b.push(1),b.push(0);for(var A=-1,C,E,S,T=0;T<b.length;T++)C=Math.pow(1-b[T],2)*i+2*(1-b[T])*b[T]*s+b[T]*b[T]*l,E=Math.pow(1-b[T],2)*a+2*(1-b[T])*b[T]*o+b[T]*b[T]*u,S=Math.pow(C-e,2)+Math.pow(E-n,2),A>=0?S<A&&(A=S):A=S;return A},BR=function(e,n,i,a,s,o){var l=[e-i,n-a],u=[s-i,o-a],c=u[0]*u[0]+u[1]*u[1],h=l[0]*l[0]+l[1]*l[1],d=l[0]*u[0]+l[1]*u[1],v=d*d/c;return d<0?h:v>c?(e-s)*(e-s)+(n-o)*(n-o):h-v},Rn=function(e,n,i){for(var a,s,o,l,u,c=0,h=0;h<i.length/2;h++)if(a=i[h*2],s=i[h*2+1],h+1<i.length/2?(o=i[(h+1)*2],l=i[(h+1)*2+1]):(o=i[(h+1-i.length/2)*2],l=i[(h+1-i.length/2)*2+1]),!(a==e&&o==e))if(a>=e&&e>=o||a<=e&&e<=o)u=(e-a)/(o-a)*(l-s)+s,u>n&&c++;else continue;return c%2!==0},Ca=function(e,n,i,a,s,o,l,u,c){var h=new Array(i.length),d;u[0]!=null?(d=Math.atan(u[1]/u[0]),u[0]<0?d=d+Math.PI/2:d=-d-Math.PI/2):d=u;for(var v=Math.cos(-d),m=Math.sin(-d),y=0;y<h.length/2;y++)h[y*2]=o/2*(i[y*2]*v-i[y*2+1]*m),h[y*2+1]=l/2*(i[y*2+1]*v+i[y*2]*m),h[y*2]+=a,h[y*2+1]+=s;var b;if(c>0){var x=Gd(h,-c);b=qd(x)}else b=h;return Rn(e,n,b)},IR=function(e,n,i,a,s,o,l,u){for(var c=new Array(i.length*2),h=0;h<u.length;h++){var d=u[h];c[h*4+0]=d.startX,c[h*4+1]=d.startY,c[h*4+2]=d.stopX,c[h*4+3]=d.stopY;var v=Math.pow(d.cx-e,2)+Math.pow(d.cy-n,2);if(v<=Math.pow(d.radius,2))return!0}return Rn(e,n,c)},qd=function(e){for(var n=new Array(e.length/2),i,a,s,o,l,u,c,h,d=0;d<e.length/4;d++){i=e[d*4],a=e[d*4+1],s=e[d*4+2],o=e[d*4+3],d<e.length/4-1?(l=e[(d+1)*4],u=e[(d+1)*4+1],c=e[(d+1)*4+2],h=e[(d+1)*4+3]):(l=e[0],u=e[1],c=e[2],h=e[3]);var v=fs(i,a,s,o,l,u,c,h,!0);n[d*2]=v[0],n[d*2+1]=v[1]}return n},Gd=function(e,n){for(var i=new Array(e.length*2),a,s,o,l,u=0;u<e.length/2;u++){a=e[u*2],s=e[u*2+1],u<e.length/2-1?(o=e[(u+1)*2],l=e[(u+1)*2+1]):(o=e[0],l=e[1]);var c=l-s,h=-(o-a),d=Math.sqrt(c*c+h*h),v=c/d,m=h/d;i[u*4]=a+v*n,i[u*4+1]=s+m*n,i[u*4+2]=o+v*n,i[u*4+3]=l+m*n}return i},NR=function(e,n,i,a,s,o){var l=i-e,u=a-n;l/=s,u/=o;var c=Math.sqrt(l*l+u*u),h=c-1;if(h<0)return[];var d=h/c;return[(i-e)*d+e,(a-n)*d+n]},no=function(e,n,i,a,s,o,l){return e-=s,n-=o,e/=i/2+l,n/=a/2+l,e*e+n*n<=1},dc=function(e,n,i,a,s,o,l){var u=[i-e,a-n],c=[e-s,n-o],h=u[0]*u[0]+u[1]*u[1],d=2*(c[0]*u[0]+c[1]*u[1]),v=c[0]*c[0]+c[1]*c[1]-l*l,m=d*d-4*h*v;if(m<0)return[];var y=(-d+Math.sqrt(m))/(2*h),b=(-d-Math.sqrt(m))/(2*h),x=Math.min(y,b),A=Math.max(y,b),C=[];if(x>=0&&x<=1&&C.push(x),A>=0&&A<=1&&C.push(A),C.length===0)return[];var E=C[0]*u[0]+e,S=C[0]*u[1]+n;if(C.length>1){if(C[0]==C[1])return[E,S];var T=C[1]*u[0]+e,R=C[1]*u[1]+n;return[E,S,T,R]}else return[E,S]},C1=function(e,n,i){return n<=e&&e<=i||i<=e&&e<=n?e:e<=n&&n<=i||i<=n&&n<=e?n:i},fs=function(e,n,i,a,s,o,l,u,c){var h=e-s,d=i-e,v=l-s,m=n-o,y=a-n,b=u-o,x=v*m-b*h,A=d*m-y*h,C=b*d-v*y;if(C!==0){var E=x/C,S=A/C,T=.001,R=0-T,D=1+T;return R<=E&&E<=D&&R<=S&&S<=D?[e+E*d,n+E*y]:c?[e+E*d,n+E*y]:[]}else return x===0||A===0?C1(e,i,l)===l?[l,u]:C1(e,i,s)===s?[s,o]:C1(s,l,i)===i?[i,a]:[]:[]},FR=function(e,n,i,a,s){var o=[],l=a/2,u=s/2,c=n,h=i;o.push({x:c+l*e[0],y:h+u*e[1]});for(var d=1;d<e.length/2;d++)o.push({x:c+l*e[d*2],y:h+u*e[d*2+1]});return o},Oc=function(e,n,i,a,s,o,l,u){var c=[],h,d=new Array(i.length),v=!0;o==null&&(v=!1);var m;if(v){for(var y=0;y<d.length/2;y++)d[y*2]=i[y*2]*o+a,d[y*2+1]=i[y*2+1]*l+s;if(u>0){var b=Gd(d,-u);m=qd(b)}else m=d}else m=i;for(var x,A,C,E,S=0;S<m.length/2;S++)x=m[S*2],A=m[S*2+1],S<m.length/2-1?(C=m[(S+1)*2],E=m[(S+1)*2+1]):(C=m[0],E=m[1]),h=fs(e,n,a,s,x,A,C,E),h.length!==0&&c.push(h[0],h[1]);return c},kR=function(e,n,i,a,s,o,l,u,c){var h=[],d,v=new Array(i.length*2);c.forEach(function(C,E){E===0?(v[v.length-2]=C.startX,v[v.length-1]=C.startY):(v[E*4-2]=C.startX,v[E*4-1]=C.startY),v[E*4]=C.stopX,v[E*4+1]=C.stopY,d=dc(e,n,a,s,C.cx,C.cy,C.radius),d.length!==0&&h.push(d[0],d[1])});for(var m=0;m<v.length/4;m++)d=fs(e,n,a,s,v[m*4],v[m*4+1],v[m*4+2],v[m*4+3],!1),d.length!==0&&h.push(d[0],d[1]);if(h.length>2){for(var y=[h[0],h[1]],b=Math.pow(y[0]-e,2)+Math.pow(y[1]-n,2),x=1;x<h.length/2;x++){var A=Math.pow(h[x*2]-e,2)+Math.pow(h[x*2+1]-n,2);A<=b&&(y[0]=h[x*2],y[1]=h[x*2+1],b=A)}return y}return h},kh=function(e,n,i){var a=[e[0]-n[0],e[1]-n[1]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=(s-i)/s;return o<0&&(o=1e-5),[n[0]+o*a[0],n[1]+o*a[1]]},vn=function(e,n){var i=hp(e,n);return i=oE(i),i},oE=function(e){for(var n,i,a=e.length/2,s=1/0,o=1/0,l=-1/0,u=-1/0,c=0;c<a;c++)n=e[2*c],i=e[2*c+1],s=Math.min(s,n),l=Math.max(l,n),o=Math.min(o,i),u=Math.max(u,i);for(var h=2/(l-s),d=2/(u-o),v=0;v<a;v++)n=e[2*v]=e[2*v]*h,i=e[2*v+1]=e[2*v+1]*d,s=Math.min(s,n),l=Math.max(l,n),o=Math.min(o,i),u=Math.max(u,i);if(o<-1)for(var m=0;m<a;m++)i=e[2*m+1]=e[2*m+1]+(-1-o);return e},hp=function(e,n){var i=1/e*2*Math.PI,a=e%2===0?Math.PI/2+i/2:Math.PI/2;a+=n;for(var s=new Array(e*2),o,l=0;l<e;l++)o=l*i+a,s[2*l]=Math.cos(o),s[2*l+1]=Math.sin(-o);return s},As=function(e,n){return Math.min(e/4,n/4,8)},lE=function(e,n){return Math.min(e/10,n/10,8)},y2=function(){return 8},PR=function(e,n,i){return[e-2*n+i,2*(n-e),e]},dp=function(e,n){return{heightOffset:Math.min(15,.05*n),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function E1(r,e){function n(d){for(var v=[],m=0;m<d.length;m++){var y=d[m],b=d[(m+1)%d.length],x={x:b.x-y.x,y:b.y-y.y},A={x:-x.y,y:x.x},C=Math.sqrt(A.x*A.x+A.y*A.y);v.push({x:A.x/C,y:A.y/C})}return v}function i(d,v){var m=1/0,y=-1/0,b=Bn(d),x;try{for(b.s();!(x=b.n()).done;){var A=x.value,C=A.x*v.x+A.y*v.y;m=Math.min(m,C),y=Math.max(y,C)}}catch(E){b.e(E)}finally{b.f()}return{min:m,max:y}}function a(d,v){return!(d.max<v.min||v.max<d.min)}var s=[].concat(Od(n(r)),Od(n(e))),o=Bn(s),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,c=i(r,u),h=i(e,u);if(!a(c,h))return!1}}catch(d){o.e(d)}finally{o.f()}return!0}var UR=$r({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),VR={pageRank:function(e){for(var n=UR(e),i=n.dampingFactor,a=n.precision,s=n.iterations,o=n.weight,l=this._private.cy,u=this.byGroup(),c=u.nodes,h=u.edges,d=c.length,v=d*d,m=h.length,y=new Array(v),b=new Array(d),x=(1-i)/d,A=0;A<d;A++){for(var C=0;C<d;C++){var E=A*d+C;y[E]=0}b[A]=0}for(var S=0;S<m;S++){var T=h[S],R=T.data("source"),D=T.data("target");if(R!==D){var B=c.indexOfId(R),N=c.indexOfId(D),I=o(T),P=N*d+B;y[P]+=I,b[B]+=I}}for(var F=1/d+x,O=0;O<d;O++)if(b[O]===0)for(var U=0;U<d;U++){var L=U*d+O;y[L]=F}else for(var V=0;V<d;V++){var _=V*d+O;y[_]=y[_]/b[O]+x}for(var G=new Array(d),K=new Array(d),z,Y=0;Y<d;Y++)G[Y]=1;for(var Z=0;Z<s;Z++){for(var J=0;J<d;J++)K[J]=0;for(var ee=0;ee<d;ee++)for(var ne=0;ne<d;ne++){var oe=ee*d+ne;K[ee]+=y[oe]*G[ne]}pR(K),z=G,G=K,K=z;for(var me=0,ye=0;ye<d;ye++){var ve=z[ye]-G[ye];me+=ve*ve}if(me<a)break}var re={rank:function(le){return le=l.collection(le)[0],G[c.indexOf(le)]}};return re}},Vw=$r({root:null,weight:function(e){return 1},directed:!1,alpha:0}),Il={degreeCentralityNormalized:function(e){e=Vw(e);var n=this.cy(),i=this.nodes(),a=i.length;if(e.directed){for(var h={},d={},v=0,m=0,y=0;y<a;y++){var b=i[y],x=b.id();e.root=b;var A=this.degreeCentrality(e);v<A.indegree&&(v=A.indegree),m<A.outdegree&&(m=A.outdegree),h[x]=A.indegree,d[x]=A.outdegree}return{indegree:function(E){return v==0?0:(Je(E)&&(E=n.filter(E)),h[E.id()]/v)},outdegree:function(E){return m===0?0:(Je(E)&&(E=n.filter(E)),d[E.id()]/m)}}}else{for(var s={},o=0,l=0;l<a;l++){var u=i[l];e.root=u;var c=this.degreeCentrality(e);o<c.degree&&(o=c.degree),s[u.id()]=c.degree}return{degree:function(E){return o===0?0:(Je(E)&&(E=n.filter(E)),s[E.id()]/o)}}}},degreeCentrality:function(e){e=Vw(e);var n=this.cy(),i=this,a=e,s=a.root,o=a.weight,l=a.directed,u=a.alpha;if(s=n.collection(s)[0],l){for(var m=s.connectedEdges(),y=m.filter(function(R){return R.target().same(s)&&i.has(R)}),b=m.filter(function(R){return R.source().same(s)&&i.has(R)}),x=y.length,A=b.length,C=0,E=0,S=0;S<y.length;S++)C+=o(y[S]);for(var T=0;T<b.length;T++)E+=o(b[T]);return{indegree:Math.pow(x,1-u)*Math.pow(C,u),outdegree:Math.pow(A,1-u)*Math.pow(E,u)}}else{for(var c=s.connectedEdges().intersection(i),h=c.length,d=0,v=0;v<c.length;v++)d+=o(c[v]);return{degree:Math.pow(h,1-u)*Math.pow(d,u)}}}};Il.dc=Il.degreeCentrality;Il.dcn=Il.degreeCentralityNormalised=Il.degreeCentralityNormalized;var Ow=$r({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),Nl={closenessCentralityNormalized:function(e){for(var n=Ow(e),i=n.harmonic,a=n.weight,s=n.directed,o=this.cy(),l={},u=0,c=this.nodes(),h=this.floydWarshall({weight:a,directed:s}),d=0;d<c.length;d++){for(var v=0,m=c[d],y=0;y<c.length;y++)if(d!==y){var b=h.distance(m,c[y]);i?v+=1/b:v+=b}i||(v=1/v),u<v&&(u=v),l[m.id()]=v}return{closeness:function(A){return u==0?0:(Je(A)?A=o.filter(A)[0].id():A=A.id(),l[A]/u)}}},closenessCentrality:function(e){var n=Ow(e),i=n.root,a=n.weight,s=n.directed,o=n.harmonic;i=this.filter(i)[0];for(var l=this.dijkstra({root:i,weight:a,directed:s}),u=0,c=this.nodes(),h=0;h<c.length;h++){var d=c[h];if(!d.same(i)){var v=l.distanceTo(d);o?u+=1/v:u+=v}}return o?u:1/u}};Nl.cc=Nl.closenessCentrality;Nl.ccn=Nl.closenessCentralityNormalised=Nl.closenessCentralityNormalized;var OR=$r({weight:null,directed:!1}),gp={betweennessCentrality:function(e){for(var n=OR(e),i=n.directed,a=n.weight,s=a!=null,o=this.cy(),l=this.nodes(),u={},c={},h=0,d={set:function(E,S){c[E]=S,S>h&&(h=S)},get:function(E){return c[E]}},v=0;v<l.length;v++){var m=l[v],y=m.id();i?u[y]=m.outgoers().nodes():u[y]=m.openNeighborhood().nodes(),d.set(y,0)}for(var b=function(){for(var E=l[x].id(),S=[],T={},R={},D={},B=new sf(function(ee,ne){return D[ee]-D[ne]}),N=0;N<l.length;N++){var I=l[N].id();T[I]=[],R[I]=0,D[I]=1/0}for(R[E]=1,D[E]=0,B.push(E);!B.empty();){var P=B.pop();if(S.push(P),s)for(var F=0;F<u[P].length;F++){var O=u[P][F],U=o.getElementById(P),L=void 0;U.edgesTo(O).length>0?L=U.edgesTo(O)[0]:L=O.edgesTo(U)[0];var V=a(L);O=O.id(),D[O]>D[P]+V&&(D[O]=D[P]+V,B.nodes.indexOf(O)<0?B.push(O):B.updateItem(O),R[O]=0,T[O]=[]),D[O]==D[P]+V&&(R[O]=R[O]+R[P],T[O].push(P))}else for(var _=0;_<u[P].length;_++){var G=u[P][_].id();D[G]==1/0&&(B.push(G),D[G]=D[P]+1),D[G]==D[P]+1&&(R[G]=R[G]+R[P],T[G].push(P))}}for(var K={},z=0;z<l.length;z++)K[l[z].id()]=0;for(;S.length>0;){for(var Y=S.pop(),Z=0;Z<T[Y].length;Z++){var J=T[Y][Z];K[J]=K[J]+R[J]/R[Y]*(1+K[Y])}Y!=l[x].id()&&d.set(Y,d.get(Y)+K[Y])}},x=0;x<l.length;x++)b();var A={betweenness:function(E){var S=o.collection(E).id();return d.get(S)},betweennessNormalized:function(E){if(h==0)return 0;var S=o.collection(E).id();return d.get(S)/h}};return A.betweennessNormalised=A.betweennessNormalized,A}};gp.bc=gp.betweennessCentrality;var LR=$r({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(r){return 1}]}),_R=function(e){return LR(e)},zR=function(e,n){for(var i=0,a=0;a<n.length;a++)i+=n[a](e);return i},qR=function(e,n,i){for(var a=0;a<n;a++)e[a*n+a]=i},uE=function(e,n){for(var i,a=0;a<n;a++){i=0;for(var s=0;s<n;s++)i+=e[s*n+a];for(var o=0;o<n;o++)e[o*n+a]=e[o*n+a]/i}},GR=function(e,n,i){for(var a=new Array(i*i),s=0;s<i;s++){for(var o=0;o<i;o++)a[s*i+o]=0;for(var l=0;l<i;l++)for(var u=0;u<i;u++)a[s*i+u]+=e[s*i+l]*n[l*i+u]}return a},YR=function(e,n,i){for(var a=e.slice(0),s=1;s<i;s++)e=GR(e,a,n);return e},HR=function(e,n,i){for(var a=new Array(n*n),s=0;s<n*n;s++)a[s]=Math.pow(e[s],i);return uE(a,n),a},jR=function(e,n,i,a){for(var s=0;s<i;s++){var o=Math.round(e[s]*Math.pow(10,a))/Math.pow(10,a),l=Math.round(n[s]*Math.pow(10,a))/Math.pow(10,a);if(o!==l)return!1}return!0},KR=function(e,n,i,a){for(var s=[],o=0;o<n;o++){for(var l=[],u=0;u<n;u++)Math.round(e[o*n+u]*1e3)/1e3>0&&l.push(i[u]);l.length!==0&&s.push(a.collection(l))}return s},XR=function(e,n){for(var i=0;i<e.length;i++)if(!n[i]||e[i].id()!==n[i].id())return!1;return!0},QR=function(e){for(var n=0;n<e.length;n++)for(var i=0;i<e.length;i++)n!=i&&XR(e[n],e[i])&&e.splice(i,1);return e},Lw=function(e){for(var n=this.nodes(),i=this.edges(),a=this.cy(),s=_R(e),o={},l=0;l<n.length;l++)o[n[l].id()]=l;for(var u=n.length,c=u*u,h=new Array(c),d,v=0;v<c;v++)h[v]=0;for(var m=0;m<i.length;m++){var y=i[m],b=o[y.source().id()],x=o[y.target().id()],A=zR(y,s.attributes);h[b*u+x]+=A,h[x*u+b]+=A}qR(h,u,s.multFactor),uE(h,u);for(var C=!0,E=0;C&&E<s.maxIterations;)C=!1,d=YR(h,u,s.expandFactor),h=HR(d,u,s.inflateFactor),jR(h,d,c,4)||(C=!0),E++;var S=KR(h,u,n,a);return S=QR(S),S},WR={markovClustering:Lw,mcl:Lw},ZR=function(e){return e},cE=function(e,n){return Math.abs(n-e)},_w=function(e,n,i){return e+cE(n,i)},zw=function(e,n,i){return e+Math.pow(i-n,2)},JR=function(e){return Math.sqrt(e)},$R=function(e,n,i){return Math.max(e,cE(n,i))},Gu=function(e,n,i,a,s){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:ZR,l=a,u,c,h=0;h<e;h++)u=n(h),c=i(h),l=s(l,u,c);return o(l)},Vl={euclidean:function(e,n,i){return e>=2?Gu(e,n,i,0,zw,JR):Gu(e,n,i,0,_w)},squaredEuclidean:function(e,n,i){return Gu(e,n,i,0,zw)},manhattan:function(e,n,i){return Gu(e,n,i,0,_w)},max:function(e,n,i){return Gu(e,n,i,-1/0,$R)}};Vl["squared-euclidean"]=Vl.squaredEuclidean;Vl.squaredeuclidean=Vl.squaredEuclidean;function p0(r,e,n,i,a,s){var o;return gr(r)?o=r:o=Vl[r]||Vl.euclidean,e===0&&gr(r)?o(a,s):o(e,n,i,a,s)}var eB=$r({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),A2=function(e){return eB(e)},Yd=function(e,n,i,a,s){var o=s!=="kMedoids",l=o?function(d){return i[d]}:function(d){return a[d](i)},u=function(v){return a[v](n)},c=i,h=n;return p0(e,a.length,l,u,c,h)},S1=function(e,n,i){for(var a=i.length,s=new Array(a),o=new Array(a),l=new Array(n),u=null,c=0;c<a;c++)s[c]=e.min(i[c]).value,o[c]=e.max(i[c]).value;for(var h=0;h<n;h++){u=[];for(var d=0;d<a;d++)u[d]=Math.random()*(o[d]-s[d])+s[d];l[h]=u}return l},fE=function(e,n,i,a,s){for(var o=1/0,l=0,u=0;u<n.length;u++){var c=Yd(i,e,n[u],a,s);c<o&&(o=c,l=u)}return l},hE=function(e,n,i){for(var a=[],s=null,o=0;o<n.length;o++)s=n[o],i[s.id()]===e&&a.push(s);return a},tB=function(e,n,i){return Math.abs(n-e)<=i},rB=function(e,n,i){for(var a=0;a<e.length;a++)for(var s=0;s<e[a].length;s++){var o=Math.abs(e[a][s]-n[a][s]);if(o>i)return!1}return!0},nB=function(e,n,i){for(var a=0;a<i;a++)if(e===n[a])return!0;return!1},qw=function(e,n){var i=new Array(n);if(e.length<50)for(var a=0;a<n;a++){for(var s=e[Math.floor(Math.random()*e.length)];nB(s,i,a);)s=e[Math.floor(Math.random()*e.length)];i[a]=s}else for(var o=0;o<n;o++)i[o]=e[Math.floor(Math.random()*e.length)];return i},Gw=function(e,n,i){for(var a=0,s=0;s<n.length;s++)a+=Yd("manhattan",n[s],e,i,"kMedoids");return a},iB=function(e){var n=this.cy(),i=this.nodes(),a=null,s=A2(e),o=new Array(s.k),l={},u;s.testMode?typeof s.testCentroids=="number"?(s.testCentroids,u=S1(i,s.k,s.attributes)):Pr(s.testCentroids)==="object"?u=s.testCentroids:u=S1(i,s.k,s.attributes):u=S1(i,s.k,s.attributes);for(var c=!0,h=0;c&&h<s.maxIterations;){for(var d=0;d<i.length;d++)a=i[d],l[a.id()]=fE(a,u,s.distance,s.attributes,"kMeans");c=!1;for(var v=0;v<s.k;v++){var m=hE(v,i,l);if(m.length!==0){for(var y=s.attributes.length,b=u[v],x=new Array(y),A=new Array(y),C=0;C<y;C++){A[C]=0;for(var E=0;E<m.length;E++)a=m[E],A[C]+=s.attributes[C](a);x[C]=A[C]/m.length,tB(x[C],b[C],s.sensitivityThreshold)||(c=!0)}u[v]=x,o[v]=n.collection(m)}}h++}return o},aB=function(e){var n=this.cy(),i=this.nodes(),a=null,s=A2(e),o=new Array(s.k),l,u={},c,h=new Array(s.k);s.testMode?typeof s.testCentroids=="number"||(Pr(s.testCentroids)==="object"?l=s.testCentroids:l=qw(i,s.k)):l=qw(i,s.k);for(var d=!0,v=0;d&&v<s.maxIterations;){for(var m=0;m<i.length;m++)a=i[m],u[a.id()]=fE(a,l,s.distance,s.attributes,"kMedoids");d=!1;for(var y=0;y<l.length;y++){var b=hE(y,i,u);if(b.length!==0){h[y]=Gw(l[y],b,s.attributes);for(var x=0;x<b.length;x++)c=Gw(b[x],b,s.attributes),c<h[y]&&(h[y]=c,l[y]=b[x],d=!0);o[y]=n.collection(b)}}v++}return o},sB=function(e,n,i,a,s){for(var o,l,u=0;u<n.length;u++)for(var c=0;c<e.length;c++)a[u][c]=Math.pow(i[u][c],s.m);for(var h=0;h<e.length;h++)for(var d=0;d<s.attributes.length;d++){o=0,l=0;for(var v=0;v<n.length;v++)o+=a[v][h]*s.attributes[d](n[v]),l+=a[v][h];e[h][d]=o/l}},oB=function(e,n,i,a,s){for(var o=0;o<e.length;o++)n[o]=e[o].slice();for(var l,u,c,h=2/(s.m-1),d=0;d<i.length;d++)for(var v=0;v<a.length;v++){l=0;for(var m=0;m<i.length;m++)u=Yd(s.distance,a[v],i[d],s.attributes,"cmeans"),c=Yd(s.distance,a[v],i[m],s.attributes,"cmeans"),l+=Math.pow(u/c,h);e[v][d]=1/l}},lB=function(e,n,i,a){for(var s=new Array(i.k),o=0;o<s.length;o++)s[o]=[];for(var l,u,c=0;c<n.length;c++){l=-1/0,u=-1;for(var h=0;h<n[0].length;h++)n[c][h]>l&&(l=n[c][h],u=h);s[u].push(e[c])}for(var d=0;d<s.length;d++)s[d]=a.collection(s[d]);return s},Yw=function(e){var n=this.cy(),i=this.nodes(),a=A2(e),s,o,l,u,c;u=new Array(i.length);for(var h=0;h<i.length;h++)u[h]=new Array(a.k);l=new Array(i.length);for(var d=0;d<i.length;d++)l[d]=new Array(a.k);for(var v=0;v<i.length;v++){for(var m=0,y=0;y<a.k;y++)l[v][y]=Math.random(),m+=l[v][y];for(var b=0;b<a.k;b++)l[v][b]=l[v][b]/m}o=new Array(a.k);for(var x=0;x<a.k;x++)o[x]=new Array(a.attributes.length);c=new Array(i.length);for(var A=0;A<i.length;A++)c[A]=new Array(a.k);for(var C=!0,E=0;C&&E<a.maxIterations;)C=!1,sB(o,i,l,c,a),oB(l,u,o,i,a),rB(l,u,a.sensitivityThreshold)||(C=!0),E++;return s=lB(i,l,a,n),{clusters:s,degreeOfMembership:l}},uB={kMeans:iB,kMedoids:aB,fuzzyCMeans:Yw,fcm:Yw},cB=$r({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),fB={single:"min",complete:"max"},hB=function(e){var n=cB(e),i=fB[n.linkage];return i!=null&&(n.linkage=i),n},Hw=function(e,n,i,a,s){for(var o=0,l=1/0,u,c=s.attributes,h=function(N,I){return p0(s.distance,c.length,function(P){return c[P](N)},function(P){return c[P](I)},N,I)},d=0;d<e.length;d++){var v=e[d].key,m=i[v][a[v]];m<l&&(o=v,l=m)}if(s.mode==="threshold"&&l>=s.threshold||s.mode==="dendrogram"&&e.length===1)return!1;var y=n[o],b=n[a[o]],x;s.mode==="dendrogram"?x={left:y,right:b,key:y.key}:x={value:y.value.concat(b.value),key:y.key},e[y.index]=x,e.splice(b.index,1),n[y.key]=x;for(var A=0;A<e.length;A++){var C=e[A];y.key===C.key?u=1/0:s.linkage==="min"?(u=i[y.key][C.key],i[y.key][C.key]>i[b.key][C.key]&&(u=i[b.key][C.key])):s.linkage==="max"?(u=i[y.key][C.key],i[y.key][C.key]<i[b.key][C.key]&&(u=i[b.key][C.key])):s.linkage==="mean"?u=(i[y.key][C.key]*y.size+i[b.key][C.key]*b.size)/(y.size+b.size):s.mode==="dendrogram"?u=h(C.value,y.value):u=h(C.value[0],y.value[0]),i[y.key][C.key]=i[C.key][y.key]=u}for(var E=0;E<e.length;E++){var S=e[E].key;if(a[S]===y.key||a[S]===b.key){for(var T=S,R=0;R<e.length;R++){var D=e[R].key;i[S][D]<i[S][T]&&(T=D)}a[S]=T}e[E].index=E}return y.key=b.key=y.index=b.index=null,!0},Ml=function(e,n,i){e&&(e.value?n.push(e.value):(e.left&&Ml(e.left,n),e.right&&Ml(e.right,n)))},vp=function(e,n){if(!e)return"";if(e.left&&e.right){var i=vp(e.left,n),a=vp(e.right,n),s=n.add({group:"nodes",data:{id:i+","+a}});return n.add({group:"edges",data:{source:i,target:s.id()}}),n.add({group:"edges",data:{source:a,target:s.id()}}),s.id()}else if(e.value)return e.value.id()},mp=function(e,n,i){if(!e)return[];var a=[],s=[],o=[];return n===0?(e.left&&Ml(e.left,a),e.right&&Ml(e.right,s),o=a.concat(s),[i.collection(o)]):n===1?e.value?[i.collection(e.value)]:(e.left&&Ml(e.left,a),e.right&&Ml(e.right,s),[i.collection(a),i.collection(s)]):e.value?[i.collection(e.value)]:(e.left&&(a=mp(e.left,n-1,i)),e.right&&(s=mp(e.right,n-1,i)),a.concat(s))},jw=function(e){for(var n=this.cy(),i=this.nodes(),a=hB(e),s=a.attributes,o=function(E,S){return p0(a.distance,s.length,function(T){return s[T](E)},function(T){return s[T](S)},E,S)},l=[],u=[],c=[],h=[],d=0;d<i.length;d++){var v={value:a.mode==="dendrogram"?i[d]:[i[d]],key:d,index:d};l[d]=v,h[d]=v,u[d]=[],c[d]=0}for(var m=0;m<l.length;m++)for(var y=0;y<=m;y++){var b=void 0;a.mode==="dendrogram"?b=m===y?1/0:o(l[m].value,l[y].value):b=m===y?1/0:o(l[m].value[0],l[y].value[0]),u[m][y]=b,u[y][m]=b,b<u[m][c[m]]&&(c[m]=y)}for(var x=Hw(l,h,u,c,a);x;)x=Hw(l,h,u,c,a);var A;return a.mode==="dendrogram"?(A=mp(l[0],a.dendrogramDepth,n),a.addDendrogram&&vp(l[0],n)):(A=new Array(l.length),l.forEach(function(C,E){C.key=C.index=null,A[E]=n.collection(C.value)})),A},dB={hierarchicalClustering:jw,hca:jw},gB=$r({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),vB=function(e){var n=e.damping,i=e.preference;.5<=n&&n<1||cr("Damping must range on [0.5, 1).  Got: ".concat(n));var a=["median","mean","min","max"];return a.some(function(s){return s===i})||Be(i)||cr("Preference must be one of [".concat(a.map(function(s){return"'".concat(s,"'")}).join(", "),"] or a number.  Got: ").concat(i)),gB(e)},mB=function(e,n,i,a){var s=function(l,u){return a[u](l)};return-p0(e,a.length,function(o){return s(n,o)},function(o){return s(i,o)},n,i)},pB=function(e,n){var i=null;return n==="median"?i=vR(e):n==="mean"?i=gR(e):n==="min"?i=hR(e):n==="max"?i=dR(e):i=n,i},yB=function(e,n,i){for(var a=[],s=0;s<e;s++)n[s*e+s]+i[s*e+s]>0&&a.push(s);return a},Kw=function(e,n,i){for(var a=[],s=0;s<e;s++){for(var o=-1,l=-1/0,u=0;u<i.length;u++){var c=i[u];n[s*e+c]>l&&(o=c,l=n[s*e+c])}o>0&&a.push(o)}for(var h=0;h<i.length;h++)a[i[h]]=i[h];return a},AB=function(e,n,i){for(var a=Kw(e,n,i),s=0;s<i.length;s++){for(var o=[],l=0;l<a.length;l++)a[l]===i[s]&&o.push(l);for(var u=-1,c=-1/0,h=0;h<o.length;h++){for(var d=0,v=0;v<o.length;v++)d+=n[o[v]*e+o[h]];d>c&&(u=h,c=d)}i[s]=o[u]}return a=Kw(e,n,i),a},Xw=function(e){for(var n=this.cy(),i=this.nodes(),a=vB(e),s={},o=0;o<i.length;o++)s[i[o].id()]=o;var l,u,c,h,d,v;l=i.length,u=l*l,c=new Array(u);for(var m=0;m<u;m++)c[m]=-1/0;for(var y=0;y<l;y++)for(var b=0;b<l;b++)y!==b&&(c[y*l+b]=mB(a.distance,i[y],i[b],a.attributes));h=pB(c,a.preference);for(var x=0;x<l;x++)c[x*l+x]=h;d=new Array(u);for(var A=0;A<u;A++)d[A]=0;v=new Array(u);for(var C=0;C<u;C++)v[C]=0;for(var E=new Array(l),S=new Array(l),T=new Array(l),R=0;R<l;R++)E[R]=0,S[R]=0,T[R]=0;for(var D=new Array(l*a.minIterations),B=0;B<D.length;B++)D[B]=0;var N;for(N=0;N<a.maxIterations;N++){for(var I=0;I<l;I++){for(var P=-1/0,F=-1/0,O=-1,U=0,L=0;L<l;L++)E[L]=d[I*l+L],U=v[I*l+L]+c[I*l+L],U>=P?(F=P,P=U,O=L):U>F&&(F=U);for(var V=0;V<l;V++)d[I*l+V]=(1-a.damping)*(c[I*l+V]-P)+a.damping*E[V];d[I*l+O]=(1-a.damping)*(c[I*l+O]-F)+a.damping*E[O]}for(var _=0;_<l;_++){for(var G=0,K=0;K<l;K++)E[K]=v[K*l+_],S[K]=Math.max(0,d[K*l+_]),G+=S[K];G-=S[_],S[_]=d[_*l+_],G+=S[_];for(var z=0;z<l;z++)v[z*l+_]=(1-a.damping)*Math.min(0,G-S[z])+a.damping*E[z];v[_*l+_]=(1-a.damping)*(G-S[_])+a.damping*E[_]}for(var Y=0,Z=0;Z<l;Z++){var J=v[Z*l+Z]+d[Z*l+Z]>0?1:0;D[N%a.minIterations*l+Z]=J,Y+=J}if(Y>0&&(N>=a.minIterations-1||N==a.maxIterations-1)){for(var ee=0,ne=0;ne<l;ne++){T[ne]=0;for(var oe=0;oe<a.minIterations;oe++)T[ne]+=D[oe*l+ne];(T[ne]===0||T[ne]===a.minIterations)&&ee++}if(ee===l)break}}for(var me=yB(l,d,v),ye=AB(l,c,me),ve={},re=0;re<me.length;re++)ve[me[re]]=[];for(var ae=0;ae<i.length;ae++){var le=s[i[ae].id()],Ae=ye[le];Ae!=null&&ve[Ae].push(i[ae])}for(var Re=new Array(me.length),Le=0;Le<me.length;Le++)Re[Le]=n.collection(ve[me[Le]]);return Re},xB={affinityPropagation:Xw,ap:Xw},bB=$r({root:void 0,directed:!1}),wB={hierholzer:function(e){if(!It(e)){var n=arguments;e={root:n[0],directed:n[1]}}var i=bB(e),a=i.root,s=i.directed,o=this,l=!1,u,c,h;a&&(h=Je(a)?this.filter(a)[0].id():a[0].id());var d={},v={};s?o.forEach(function(C){var E=C.id();if(C.isNode()){var S=C.indegree(!0),T=C.outdegree(!0),R=S-T,D=T-S;R==1?u?l=!0:u=E:D==1?c?l=!0:c=E:(D>1||R>1)&&(l=!0),d[E]=[],C.outgoers().forEach(function(B){B.isEdge()&&d[E].push(B.id())})}else v[E]=[void 0,C.target().id()]}):o.forEach(function(C){var E=C.id();if(C.isNode()){var S=C.degree(!0);S%2&&(u?c?l=!0:c=E:u=E),d[E]=[],C.connectedEdges().forEach(function(T){return d[E].push(T.id())})}else v[E]=[C.source().id(),C.target().id()]});var m={found:!1,trail:void 0};if(l)return m;if(c&&u)if(s){if(h&&c!=h)return m;h=c}else{if(h&&c!=h&&u!=h)return m;h||(h=c)}else h||(h=o[0].id());var y=function(E){for(var S=E,T=[E],R,D,B;d[S].length;)R=d[S].shift(),D=v[R][0],B=v[R][1],S!=B?(d[B]=d[B].filter(function(N){return N!=R}),S=B):!s&&S!=D&&(d[D]=d[D].filter(function(N){return N!=R}),S=D),T.unshift(R),T.unshift(S);return T},b=[],x=[];for(x=y(h);x.length!=1;)d[x[0]].length==0?(b.unshift(o.getElementById(x.shift())),b.unshift(o.getElementById(x.shift()))):x=y(x.shift()).concat(x);b.unshift(o.getElementById(x.shift()));for(var A in d)if(d[A].length)return m;return m.found=!0,m.trail=this.spawn(b,!0),m}},Ph=function(){var e=this,n={},i=0,a=0,s=[],o=[],l={},u=function(v,m){for(var y=o.length-1,b=[],x=e.spawn();o[y].x!=v||o[y].y!=m;)b.push(o.pop().edge),y--;b.push(o.pop().edge),b.forEach(function(A){var C=A.connectedNodes().intersection(e);x.merge(A),C.forEach(function(E){var S=E.id(),T=E.connectedEdges().intersection(e);x.merge(E),n[S].cutVertex?x.merge(T.filter(function(R){return R.isLoop()})):x.merge(T)})}),s.push(x)},c=function(v,m,y){v===y&&(a+=1),n[m]={id:i,low:i++,cutVertex:!1};var b=e.getElementById(m).connectedEdges().intersection(e);if(b.size()===0)s.push(e.spawn(e.getElementById(m)));else{var x,A,C,E;b.forEach(function(S){x=S.source().id(),A=S.target().id(),C=x===m?A:x,C!==y&&(E=S.id(),l[E]||(l[E]=!0,o.push({x:m,y:C,edge:S})),C in n?n[m].low=Math.min(n[m].low,n[C].id):(c(v,C,m),n[m].low=Math.min(n[m].low,n[C].low),n[m].id<=n[C].low&&(n[m].cutVertex=!0,u(m,C))))})}};e.forEach(function(d){if(d.isNode()){var v=d.id();v in n||(a=0,c(v,v),n[v].cutVertex=a>1)}});var h=Object.keys(n).filter(function(d){return n[d].cutVertex}).map(function(d){return e.getElementById(d)});return{cut:e.spawn(h),components:s}},CB={hopcroftTarjanBiconnected:Ph,htbc:Ph,htb:Ph,hopcroftTarjanBiconnectedComponents:Ph},Uh=function(){var e=this,n={},i=0,a=[],s=[],o=e.spawn(e),l=function(c){s.push(c),n[c]={index:i,low:i++,explored:!1};var h=e.getElementById(c).connectedEdges().intersection(e);if(h.forEach(function(b){var x=b.target().id();x!==c&&(x in n||l(x),n[x].explored||(n[c].low=Math.min(n[c].low,n[x].low)))}),n[c].index===n[c].low){for(var d=e.spawn();;){var v=s.pop();if(d.merge(e.getElementById(v)),n[v].low=n[c].index,n[v].explored=!0,v===c)break}var m=d.edgesWith(d),y=d.merge(m);a.push(y),o=o.difference(y)}};return e.forEach(function(u){if(u.isNode()){var c=u.id();c in n||l(c)}}),{cut:o,components:a}},EB={tarjanStronglyConnected:Uh,tsc:Uh,tscc:Uh,tarjanStronglyConnectedComponents:Uh},dE={};[Uc,eR,tR,nR,aR,oR,cR,VR,Il,Nl,gp,WR,uB,dB,xB,wB,CB,EB].forEach(function(r){et(dE,r)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var gE=0,vE=1,mE=2,Si=function(e){if(!(this instanceof Si))return new Si(e);this.id="Thenable/1.0.7",this.state=gE,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};Si.prototype={fulfill:function(e){return Qw(this,vE,"fulfillValue",e)},reject:function(e){return Qw(this,mE,"rejectReason",e)},then:function(e,n){var i=this,a=new Si;return i.onFulfilled.push(Zw(e,a,"fulfill")),i.onRejected.push(Zw(n,a,"reject")),pE(i),a.proxy}};var Qw=function(e,n,i,a){return e.state===gE&&(e.state=n,e[i]=a,pE(e)),e},pE=function(e){e.state===vE?Ww(e,"onFulfilled",e.fulfillValue):e.state===mE&&Ww(e,"onRejected",e.rejectReason)},Ww=function(e,n,i){if(e[n].length!==0){var a=e[n];e[n]=[];var s=function(){for(var l=0;l<a.length;l++)a[l](i)};typeof setImmediate=="function"?setImmediate(s):setTimeout(s,0)}},Zw=function(e,n,i){return function(a){if(typeof e!="function")n[i].call(n,a);else{var s;try{s=e(a)}catch(o){n.reject(o);return}yE(n,s)}}},yE=function(e,n){if(e===n||e.proxy===n){e.reject(new TypeError("cannot resolve promise with itself"));return}var i;if(Pr(n)==="object"&&n!==null||typeof n=="function")try{i=n.then}catch(s){e.reject(s);return}if(typeof i=="function"){var a=!1;try{i.call(n,function(s){a||(a=!0,s===n?e.reject(new TypeError("circular thenable chain")):yE(e,s))},function(s){a||(a=!0,e.reject(s))})}catch(s){a||e.reject(s)}return}e.fulfill(n)};Si.all=function(r){return new Si(function(e,n){for(var i=new Array(r.length),a=0,s=function(u,c){i[u]=c,a++,a===r.length&&e(i)},o=0;o<r.length;o++)(function(l){var u=r[l],c=u!=null&&u.then!=null;if(c)u.then(function(d){s(l,d)},function(d){n(d)});else{var h=u;s(l,h)}})(o)})};Si.resolve=function(r){return new Si(function(e,n){e(r)})};Si.reject=function(r){return new Si(function(e,n){n(r)})};var Gl=typeof Promise<"u"?Promise:Si,pp=function(e,n,i){var a=u2(e),s=!a,o=this._private=et({duration:1e3},n,i);if(o.target=e,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&gr(o.complete)&&o.completes.push(o.complete),s){var l=e.position();o.startPosition=o.startPosition||{x:l.x,y:l.y},o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(a){var u=e.pan();o.startPan={x:u.x,y:u.y},o.startZoom=e.zoom()}this.length=1,this[0]=this},ho=pp.prototype;et(ho,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var n,i=e.target._private.animation;e.queue?n=i.queue:n=i.current,n.push(this),jn(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var n=this._private;return e===void 0?n.progress*n.duration:this.progress(e/n.duration)},progress:function(e){var n=this._private,i=n.playing;return e===void 0?n.progress:(i&&this.pause(),n.progress=e,n.started=!1,i&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,n=e.playing;n&&this.pause(),e.progress=1-e.progress,e.started=!1;var i=function(c,h){var d=e[c];d!=null&&(e[c]=e[h],e[h]=d)};if(i("zoom","startZoom"),i("pan","startPan"),i("position","startPosition"),e.style)for(var a=0;a<e.style.length;a++){var s=e.style[a],o=s.name,l=e.startStyle[o];e.startStyle[o]=s,e.style[a]=l}return n&&this.play(),this},promise:function(e){var n=this._private,i;switch(e){case"frame":i=n.frames;break;default:case"complete":case"completed":i=n.completes}return new Gl(function(a,s){i.push(function(){a()})})}});ho.complete=ho.completed;ho.run=ho.play;ho.running=ho.playing;var SB={animated:function(){return function(){var n=this,i=n.length!==void 0,a=i?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return!1;var o=a[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var n=this,i=n.length!==void 0,a=i?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var o=0;o<a.length;o++){var l=a[o];l._private.animation.queue=[]}return this}},delay:function(){return function(n,i){var a=this._private.cy||this;return a.styleEnabled()?this.animate({delay:n,duration:n,complete:i}):this}},delayAnimation:function(){return function(n,i){var a=this._private.cy||this;return a.styleEnabled()?this.animation({delay:n,duration:n,complete:i}):this}},animation:function(){return function(n,i){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this,u=!s,c=!u;if(!l.styleEnabled())return this;var h=l.style();n=et({},n,i);var d=Object.keys(n).length===0;if(d)return new pp(o[0],n);switch(n.duration===void 0&&(n.duration=400),n.duration){case"slow":n.duration=600;break;case"fast":n.duration=200;break}if(c&&(n.style=h.getPropsList(n.style||n.css),n.css=void 0),c&&n.renderedPosition!=null){var v=n.renderedPosition,m=l.pan(),y=l.zoom();n.position=nE(v,y,m)}if(u&&n.panBy!=null){var b=n.panBy,x=l.pan();n.pan={x:x.x+b.x,y:x.y+b.y}}var A=n.center||n.centre;if(u&&A!=null){var C=l.getCenterPan(A.eles,n.zoom);C!=null&&(n.pan=C)}if(u&&n.fit!=null){var E=n.fit,S=l.getFitViewport(E.eles||E.boundingBox,E.padding);S!=null&&(n.pan=S.pan,n.zoom=S.zoom)}if(u&&It(n.zoom)){var T=l.getZoomedViewport(n.zoom);T!=null?(T.zoomed&&(n.zoom=T.zoom),T.panned&&(n.pan=T.pan)):n.zoom=null}return new pp(o[0],n)}},animate:function(){return function(n,i){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this;if(!l.styleEnabled())return this;i&&(n=et({},n,i));for(var u=0;u<o.length;u++){var c=o[u],h=c.animated()&&(n.queue===void 0||n.queue),d=c.animation(n,h?{queue:!0}:void 0);d.play()}return this}},stop:function(){return function(n,i){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this;if(!l.styleEnabled())return this;for(var u=0;u<o.length;u++){for(var c=o[u],h=c._private,d=h.animation.current,v=0;v<d.length;v++){var m=d[v],y=m._private;i&&(y.duration=0)}n&&(h.animation.queue=[]),i||(h.animation.current=[])}return l.notify("draw"),this}}},T1,Jw;function y0(){if(Jw)return T1;Jw=1;var r=Array.isArray;return T1=r,T1}var M1,$w;function TB(){if($w)return M1;$w=1;var r=y0(),e=nf(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;function a(s,o){if(r(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||e(s)?!0:i.test(s)||!n.test(s)||o!=null&&s in Object(o)}return M1=a,M1}var D1,e5;function MB(){if(e5)return D1;e5=1;var r=XC(),e=rf(),n="[object AsyncFunction]",i="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var u=r(l);return u==i||u==a||u==n||u==s}return D1=o,D1}var R1,t5;function DB(){if(t5)return R1;t5=1;var r=g0(),e=r["__core-js_shared__"];return R1=e,R1}var B1,r5;function RB(){if(r5)return B1;r5=1;var r=DB(),e=(function(){var i=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""})();function n(i){return!!e&&e in i}return B1=n,B1}var I1,n5;function BB(){if(n5)return I1;n5=1;var r=Function.prototype,e=r.toString;function n(i){if(i!=null){try{return e.call(i)}catch{}try{return i+""}catch{}}return""}return I1=n,I1}var N1,i5;function IB(){if(i5)return N1;i5=1;var r=MB(),e=RB(),n=rf(),i=BB(),a=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,u=o.toString,c=l.hasOwnProperty,h=RegExp("^"+u.call(c).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(v){if(!n(v)||e(v))return!1;var m=r(v)?h:s;return m.test(i(v))}return N1=d,N1}var F1,a5;function NB(){if(a5)return F1;a5=1;function r(e,n){return e?.[n]}return F1=r,F1}var k1,s5;function x2(){if(s5)return k1;s5=1;var r=IB(),e=NB();function n(i,a){var s=e(i,a);return r(s)?s:void 0}return k1=n,k1}var P1,o5;function A0(){if(o5)return P1;o5=1;var r=x2(),e=r(Object,"create");return P1=e,P1}var U1,l5;function FB(){if(l5)return U1;l5=1;var r=A0();function e(){this.__data__=r?r(null):{},this.size=0}return U1=e,U1}var V1,u5;function kB(){if(u5)return V1;u5=1;function r(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}return V1=r,V1}var O1,c5;function PB(){if(c5)return O1;c5=1;var r=A0(),e="__lodash_hash_undefined__",n=Object.prototype,i=n.hasOwnProperty;function a(s){var o=this.__data__;if(r){var l=o[s];return l===e?void 0:l}return i.call(o,s)?o[s]:void 0}return O1=a,O1}var L1,f5;function UB(){if(f5)return L1;f5=1;var r=A0(),e=Object.prototype,n=e.hasOwnProperty;function i(a){var s=this.__data__;return r?s[a]!==void 0:n.call(s,a)}return L1=i,L1}var _1,h5;function VB(){if(h5)return _1;h5=1;var r=A0(),e="__lodash_hash_undefined__";function n(i,a){var s=this.__data__;return this.size+=this.has(i)?0:1,s[i]=r&&a===void 0?e:a,this}return _1=n,_1}var z1,d5;function OB(){if(d5)return z1;d5=1;var r=FB(),e=kB(),n=PB(),i=UB(),a=VB();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var c=o[l];this.set(c[0],c[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,z1=s,z1}var q1,g5;function LB(){if(g5)return q1;g5=1;function r(){this.__data__=[],this.size=0}return q1=r,q1}var G1,v5;function AE(){if(v5)return G1;v5=1;function r(e,n){return e===n||e!==e&&n!==n}return G1=r,G1}var Y1,m5;function x0(){if(m5)return Y1;m5=1;var r=AE();function e(n,i){for(var a=n.length;a--;)if(r(n[a][0],i))return a;return-1}return Y1=e,Y1}var H1,p5;function _B(){if(p5)return H1;p5=1;var r=x0(),e=Array.prototype,n=e.splice;function i(a){var s=this.__data__,o=r(s,a);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():n.call(s,o,1),--this.size,!0}return H1=i,H1}var j1,y5;function zB(){if(y5)return j1;y5=1;var r=x0();function e(n){var i=this.__data__,a=r(i,n);return a<0?void 0:i[a][1]}return j1=e,j1}var K1,A5;function qB(){if(A5)return K1;A5=1;var r=x0();function e(n){return r(this.__data__,n)>-1}return K1=e,K1}var X1,x5;function GB(){if(x5)return X1;x5=1;var r=x0();function e(n,i){var a=this.__data__,s=r(a,n);return s<0?(++this.size,a.push([n,i])):a[s][1]=i,this}return X1=e,X1}var Q1,b5;function YB(){if(b5)return Q1;b5=1;var r=LB(),e=_B(),n=zB(),i=qB(),a=GB();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var c=o[l];this.set(c[0],c[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,Q1=s,Q1}var W1,w5;function HB(){if(w5)return W1;w5=1;var r=x2(),e=g0(),n=r(e,"Map");return W1=n,W1}var Z1,C5;function jB(){if(C5)return Z1;C5=1;var r=OB(),e=YB(),n=HB();function i(){this.size=0,this.__data__={hash:new r,map:new(n||e),string:new r}}return Z1=i,Z1}var J1,E5;function KB(){if(E5)return J1;E5=1;function r(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}return J1=r,J1}var $1,S5;function b0(){if(S5)return $1;S5=1;var r=KB();function e(n,i){var a=n.__data__;return r(i)?a[typeof i=="string"?"string":"hash"]:a.map}return $1=e,$1}var em,T5;function XB(){if(T5)return em;T5=1;var r=b0();function e(n){var i=r(this,n).delete(n);return this.size-=i?1:0,i}return em=e,em}var tm,M5;function QB(){if(M5)return tm;M5=1;var r=b0();function e(n){return r(this,n).get(n)}return tm=e,tm}var rm,D5;function WB(){if(D5)return rm;D5=1;var r=b0();function e(n){return r(this,n).has(n)}return rm=e,rm}var nm,R5;function ZB(){if(R5)return nm;R5=1;var r=b0();function e(n,i){var a=r(this,n),s=a.size;return a.set(n,i),this.size+=a.size==s?0:1,this}return nm=e,nm}var im,B5;function JB(){if(B5)return im;B5=1;var r=jB(),e=XB(),n=QB(),i=WB(),a=ZB();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var c=o[l];this.set(c[0],c[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,im=s,im}var am,I5;function $B(){if(I5)return am;I5=1;var r=JB(),e="Expected a function";function n(i,a){if(typeof i!="function"||a!=null&&typeof a!="function")throw new TypeError(e);var s=function(){var o=arguments,l=a?a.apply(this,o):o[0],u=s.cache;if(u.has(l))return u.get(l);var c=i.apply(this,o);return s.cache=u.set(l,c)||u,c};return s.cache=new(n.Cache||r),s}return n.Cache=r,am=n,am}var sm,N5;function e7(){if(N5)return sm;N5=1;var r=$B(),e=500;function n(i){var a=r(i,function(o){return s.size===e&&s.clear(),o}),s=a.cache;return a}return sm=n,sm}var om,F5;function xE(){if(F5)return om;F5=1;var r=e7(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,i=r(function(a){var s=[];return a.charCodeAt(0)===46&&s.push(""),a.replace(e,function(o,l,u,c){s.push(u?c.replace(n,"$1"):l||o)}),s});return om=i,om}var lm,k5;function bE(){if(k5)return lm;k5=1;function r(e,n){for(var i=-1,a=e==null?0:e.length,s=Array(a);++i<a;)s[i]=n(e[i],i,e);return s}return lm=r,lm}var um,P5;function t7(){if(P5)return um;P5=1;var r=f2(),e=bE(),n=y0(),i=nf(),a=r?r.prototype:void 0,s=a?a.toString:void 0;function o(l){if(typeof l=="string")return l;if(n(l))return e(l,o)+"";if(i(l))return s?s.call(l):"";var u=l+"";return u=="0"&&1/l==-1/0?"-0":u}return um=o,um}var cm,U5;function wE(){if(U5)return cm;U5=1;var r=t7();function e(n){return n==null?"":r(n)}return cm=e,cm}var fm,V5;function CE(){if(V5)return fm;V5=1;var r=y0(),e=TB(),n=xE(),i=wE();function a(s,o){return r(s)?s:e(s,o)?[s]:n(i(s))}return fm=a,fm}var hm,O5;function b2(){if(O5)return hm;O5=1;var r=nf();function e(n){if(typeof n=="string"||r(n))return n;var i=n+"";return i=="0"&&1/n==-1/0?"-0":i}return hm=e,hm}var dm,L5;function r7(){if(L5)return dm;L5=1;var r=CE(),e=b2();function n(i,a){a=r(a,i);for(var s=0,o=a.length;i!=null&&s<o;)i=i[e(a[s++])];return s&&s==o?i:void 0}return dm=n,dm}var gm,_5;function n7(){if(_5)return gm;_5=1;var r=r7();function e(n,i,a){var s=n==null?void 0:r(n,i);return s===void 0?a:s}return gm=e,gm}var i7=n7(),a7=tf(i7),vm,z5;function s7(){if(z5)return vm;z5=1;var r=x2(),e=(function(){try{var n=r(Object,"defineProperty");return n({},"",{}),n}catch{}})();return vm=e,vm}var mm,q5;function o7(){if(q5)return mm;q5=1;var r=s7();function e(n,i,a){i=="__proto__"&&r?r(n,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[i]=a}return mm=e,mm}var pm,G5;function l7(){if(G5)return pm;G5=1;var r=o7(),e=AE(),n=Object.prototype,i=n.hasOwnProperty;function a(s,o,l){var u=s[o];(!(i.call(s,o)&&e(u,l))||l===void 0&&!(o in s))&&r(s,o,l)}return pm=a,pm}var ym,Y5;function u7(){if(Y5)return ym;Y5=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function n(i,a){var s=typeof i;return a=a??r,!!a&&(s=="number"||s!="symbol"&&e.test(i))&&i>-1&&i%1==0&&i<a}return ym=n,ym}var Am,H5;function c7(){if(H5)return Am;H5=1;var r=l7(),e=CE(),n=u7(),i=rf(),a=b2();function s(o,l,u,c){if(!i(o))return o;l=e(l,o);for(var h=-1,d=l.length,v=d-1,m=o;m!=null&&++h<d;){var y=a(l[h]),b=u;if(y==="__proto__"||y==="constructor"||y==="prototype")return o;if(h!=v){var x=m[y];b=c?c(x,y,m):void 0,b===void 0&&(b=i(x)?x:n(l[h+1])?[]:{})}r(m,y,b),m=m[y]}return o}return Am=s,Am}var xm,j5;function f7(){if(j5)return xm;j5=1;var r=c7();function e(n,i,a){return n==null?n:r(n,i,a)}return xm=e,xm}var h7=f7(),d7=tf(h7),bm,K5;function g7(){if(K5)return bm;K5=1;function r(e,n){var i=-1,a=e.length;for(n||(n=Array(a));++i<a;)n[i]=e[i];return n}return bm=r,bm}var wm,X5;function v7(){if(X5)return wm;X5=1;var r=bE(),e=g7(),n=y0(),i=nf(),a=xE(),s=b2(),o=wE();function l(u){return n(u)?r(u,s):i(u)?[u]:e(a(o(u)))}return wm=l,wm}var m7=v7(),p7=tf(m7),y7={data:function(e){var n={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(a){},beforeSet:function(a,s){},onSet:function(a){},canSet:function(a){return!0}};return e=et({},n,e),function(a,s){var o=e,l=this,u=l.length!==void 0,c=u?l:[l],h=u?l[0]:l;if(Je(a)){var d=a.indexOf(".")!==-1,v=d&&p7(a);if(o.allowGetting&&s===void 0){var m;return h&&(o.beforeGet(h),v&&h._private[o.field][a]===void 0?m=a7(h._private[o.field],v):m=h._private[o.field][a]),m}else if(o.allowSetting&&s!==void 0){var y=!o.immutableKeys[a];if(y){var b=OC({},a,s);o.beforeSet(l,b);for(var x=0,A=c.length;x<A;x++){var C=c[x];o.canSet(C)&&(v&&h._private[o.field][a]===void 0?d7(C._private[o.field],v,s):C._private[o.field][a]=s)}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&It(a)){var E=a,S,T,R=Object.keys(E);o.beforeSet(l,E);for(var D=0;D<R.length;D++){S=R[D],T=E[S];var B=!o.immutableKeys[S];if(B)for(var N=0;N<c.length;N++){var I=c[N];o.canSet(I)&&(I._private[o.field][S]=T)}}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&gr(a)){var P=a;l.on(o.bindingEvent,P)}else if(o.allowGetting&&a===void 0){var F;return h&&(o.beforeGet(h),F=h._private[o.field]),F}return l}},removeData:function(e){var n={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=et({},n,e),function(a){var s=e,o=this,l=o.length!==void 0,u=l?o:[o];if(Je(a)){for(var c=a.split(/\s+/),h=c.length,d=0;d<h;d++){var v=c[d];if(!ps(v)){var m=!s.immutableKeys[v];if(m)for(var y=0,b=u.length;y<b;y++)u[y]._private[s.field][v]=void 0}}s.triggerEvent&&o[s.triggerFnName](s.event)}else if(a===void 0){for(var x=0,A=u.length;x<A;x++)for(var C=u[x]._private[s.field],E=Object.keys(C),S=0;S<E.length;S++){var T=E[S],R=!s.immutableKeys[T];R&&(C[T]=void 0)}s.triggerEvent&&o[s.triggerFnName](s.event)}return o}}},A7={eventAliasesOn:function(e){var n=e;n.addListener=n.listen=n.bind=n.on,n.unlisten=n.unbind=n.off=n.removeListener,n.trigger=n.emit,n.pon=n.promiseOn=function(i,a){var s=this,o=Array.prototype.slice.call(arguments,0);return new Gl(function(l,u){var c=function(m){s.off.apply(s,d),l(m)},h=o.concat([c]),d=h.concat([]);s.on.apply(s,h)})}}},Ot={};[SB,y7,A7].forEach(function(r){et(Ot,r)});var x7={animate:Ot.animate(),animation:Ot.animation(),animated:Ot.animated(),clearQueue:Ot.clearQueue(),delay:Ot.delay(),delayAnimation:Ot.delayAnimation(),stop:Ot.stop()},pd={classes:function(e){var n=this;if(e===void 0){var i=[];return n[0]._private.classes.forEach(function(y){return i.push(y)}),i}else Qt(e)||(e=(e||"").match(/\S+/g)||[]);for(var a=[],s=new ql(e),o=0;o<n.length;o++){for(var l=n[o],u=l._private,c=u.classes,h=!1,d=0;d<e.length;d++){var v=e[d],m=c.has(v);if(!m){h=!0;break}}h||(h=c.size!==e.length),h&&(u.classes=s,a.push(l))}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var n=this[0];return n!=null&&n._private.classes.has(e)},toggleClass:function(e,n){Qt(e)||(e=e.match(/\S+/g)||[]);for(var i=this,a=n===void 0,s=[],o=0,l=i.length;o<l;o++)for(var u=i[o],c=u._private.classes,h=!1,d=0;d<e.length;d++){var v=e[d],m=c.has(v),y=!1;n||a&&!m?(c.add(v),y=!0):(!n||a&&m)&&(c.delete(v),y=!0),!h&&y&&(s.push(u),h=!0)}return s.length>0&&this.spawn(s).updateStyle().emit("class"),i},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,n){var i=this;if(n==null)n=250;else if(n===0)return i;return i.addClass(e),setTimeout(function(){i.removeClass(e)},n),i}};pd.className=pd.classNames=pd.classes;var Bt={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Fr,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};Bt.variable="(?:[\\w-.]|(?:\\\\"+Bt.metaChar+"))+";Bt.className="(?:[\\w-]|(?:\\\\"+Bt.metaChar+"))+";Bt.value=Bt.string+"|"+Bt.number;Bt.id=Bt.variable;(function(){var r,e,n;for(r=Bt.comparatorOp.split("|"),n=0;n<r.length;n++)e=r[n],Bt.comparatorOp+="|@"+e;for(r=Bt.comparatorOp.split("|"),n=0;n<r.length;n++)e=r[n],!(e.indexOf("!")>=0)&&e!=="="&&(Bt.comparatorOp+="|\\!"+e)})();var Ht=function(){return{checks:[]}},Ue={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},yp=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(r,e){return y8(r.selector,e.selector)}),b7=(function(){for(var r={},e,n=0;n<yp.length;n++)e=yp[n],r[e.selector]=e.matches;return r})(),w7=function(e,n){return b7[e](n)},C7="("+yp.map(function(r){return r.selector}).join("|")+")",ll=function(e){return e.replace(new RegExp("\\\\("+Bt.metaChar+")","g"),function(n,i){return i})},$a=function(e,n,i){e[e.length-1]=i},Ap=[{name:"group",query:!0,regex:"("+Bt.group+")",populate:function(e,n,i){var a=Rr(i,1),s=a[0];n.checks.push({type:Ue.GROUP,value:s==="*"?s:s+"s"})}},{name:"state",query:!0,regex:C7,populate:function(e,n,i){var a=Rr(i,1),s=a[0];n.checks.push({type:Ue.STATE,value:s})}},{name:"id",query:!0,regex:"\\#("+Bt.id+")",populate:function(e,n,i){var a=Rr(i,1),s=a[0];n.checks.push({type:Ue.ID,value:ll(s)})}},{name:"className",query:!0,regex:"\\.("+Bt.className+")",populate:function(e,n,i){var a=Rr(i,1),s=a[0];n.checks.push({type:Ue.CLASS,value:ll(s)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+Bt.variable+")\\s*\\]",populate:function(e,n,i){var a=Rr(i,1),s=a[0];n.checks.push({type:Ue.DATA_EXIST,field:ll(s)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+Bt.variable+")\\s*("+Bt.comparatorOp+")\\s*("+Bt.value+")\\s*\\]",populate:function(e,n,i){var a=Rr(i,3),s=a[0],o=a[1],l=a[2],u=new RegExp("^"+Bt.string+"$").exec(l)!=null;u?l=l.substring(1,l.length-1):l=parseFloat(l),n.checks.push({type:Ue.DATA_COMPARE,field:ll(s),operator:o,value:l})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+Bt.boolOp+")\\s*("+Bt.variable+")\\s*\\]",populate:function(e,n,i){var a=Rr(i,2),s=a[0],o=a[1];n.checks.push({type:Ue.DATA_BOOL,field:ll(o),operator:s})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+Bt.meta+")\\s*("+Bt.comparatorOp+")\\s*("+Bt.number+")\\s*\\]\\]",populate:function(e,n,i){var a=Rr(i,3),s=a[0],o=a[1],l=a[2];n.checks.push({type:Ue.META_COMPARE,field:ll(s),operator:o,value:parseFloat(l)})}},{name:"nextQuery",separator:!0,regex:Bt.separator,populate:function(e,n){var i=e.currentSubject,a=e.edgeCount,s=e.compoundCount,o=e[e.length-1];i!=null&&(o.subject=i,e.currentSubject=null),o.edgeCount=a,o.compoundCount=s,e.edgeCount=0,e.compoundCount=0;var l=e[e.length++]=Ht();return l}},{name:"directedEdge",separator:!0,regex:Bt.directedEdge,populate:function(e,n){if(e.currentSubject==null){var i=Ht(),a=n,s=Ht();return i.checks.push({type:Ue.DIRECTED_EDGE,source:a,target:s}),$a(e,n,i),e.edgeCount++,s}else{var o=Ht(),l=n,u=Ht();return o.checks.push({type:Ue.NODE_SOURCE,source:l,target:u}),$a(e,n,o),e.edgeCount++,u}}},{name:"undirectedEdge",separator:!0,regex:Bt.undirectedEdge,populate:function(e,n){if(e.currentSubject==null){var i=Ht(),a=n,s=Ht();return i.checks.push({type:Ue.UNDIRECTED_EDGE,nodes:[a,s]}),$a(e,n,i),e.edgeCount++,s}else{var o=Ht(),l=n,u=Ht();return o.checks.push({type:Ue.NODE_NEIGHBOR,node:l,neighbor:u}),$a(e,n,o),u}}},{name:"child",separator:!0,regex:Bt.child,populate:function(e,n){if(e.currentSubject==null){var i=Ht(),a=Ht(),s=e[e.length-1];return i.checks.push({type:Ue.CHILD,parent:s,child:a}),$a(e,n,i),e.compoundCount++,a}else if(e.currentSubject===n){var o=Ht(),l=e[e.length-1],u=Ht(),c=Ht(),h=Ht(),d=Ht();return o.checks.push({type:Ue.COMPOUND_SPLIT,left:l,right:u,subject:c}),c.checks=n.checks,n.checks=[{type:Ue.TRUE}],d.checks.push({type:Ue.TRUE}),u.checks.push({type:Ue.PARENT,parent:d,child:h}),$a(e,l,o),e.currentSubject=c,e.compoundCount++,h}else{var v=Ht(),m=Ht(),y=[{type:Ue.PARENT,parent:v,child:m}];return v.checks=n.checks,n.checks=y,e.compoundCount++,m}}},{name:"descendant",separator:!0,regex:Bt.descendant,populate:function(e,n){if(e.currentSubject==null){var i=Ht(),a=Ht(),s=e[e.length-1];return i.checks.push({type:Ue.DESCENDANT,ancestor:s,descendant:a}),$a(e,n,i),e.compoundCount++,a}else if(e.currentSubject===n){var o=Ht(),l=e[e.length-1],u=Ht(),c=Ht(),h=Ht(),d=Ht();return o.checks.push({type:Ue.COMPOUND_SPLIT,left:l,right:u,subject:c}),c.checks=n.checks,n.checks=[{type:Ue.TRUE}],d.checks.push({type:Ue.TRUE}),u.checks.push({type:Ue.ANCESTOR,ancestor:d,descendant:h}),$a(e,l,o),e.currentSubject=c,e.compoundCount++,h}else{var v=Ht(),m=Ht(),y=[{type:Ue.ANCESTOR,ancestor:v,descendant:m}];return v.checks=n.checks,n.checks=y,e.compoundCount++,m}}},{name:"subject",modifier:!0,regex:Bt.subject,populate:function(e,n){if(e.currentSubject!=null&&e.currentSubject!==n)return Lt("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=n;var i=e[e.length-1],a=i.checks[0],s=a==null?null:a.type;s===Ue.DIRECTED_EDGE?a.type=Ue.NODE_TARGET:s===Ue.UNDIRECTED_EDGE&&(a.type=Ue.NODE_NEIGHBOR,a.node=a.nodes[1],a.neighbor=a.nodes[0],a.nodes=null)}}];Ap.forEach(function(r){return r.regexObj=new RegExp("^"+r.regex)});var E7=function(e){for(var n,i,a,s=0;s<Ap.length;s++){var o=Ap[s],l=o.name,u=e.match(o.regexObj);if(u!=null){i=u,n=o,a=l;var c=u[0];e=e.substring(c.length);break}}return{expr:n,match:i,name:a,remaining:e}},S7=function(e){var n=e.match(/^\s+/);if(n){var i=n[0];e=e.substring(i.length)}return e},T7=function(e){var n=this,i=n.inputText=e,a=n[0]=Ht();for(n.length=1,i=S7(i);;){var s=E7(i);if(s.expr==null)return Lt("The selector `"+e+"`is invalid"),!1;var o=s.match.slice(1),l=s.expr.populate(n,a,o);if(l===!1)return!1;if(l!=null&&(a=l),i=s.remaining,i.match(/^\s*$/))break}var u=n[n.length-1];n.currentSubject!=null&&(u.subject=n.currentSubject),u.edgeCount=n.edgeCount,u.compoundCount=n.compoundCount;for(var c=0;c<n.length;c++){var h=n[c];if(h.compoundCount>0&&h.edgeCount>0)return Lt("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(h.edgeCount>1)return Lt("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;h.edgeCount===1&&Lt("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},M7=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(h){return h??""},n=function(h){return Je(h)?'"'+h+'"':e(h)},i=function(h){return" "+h+" "},a=function(h,d){var v=h.type,m=h.value;switch(v){case Ue.GROUP:{var y=e(m);return y.substring(0,y.length-1)}case Ue.DATA_COMPARE:{var b=h.field,x=h.operator;return"["+b+i(e(x))+n(m)+"]"}case Ue.DATA_BOOL:{var A=h.operator,C=h.field;return"["+e(A)+C+"]"}case Ue.DATA_EXIST:{var E=h.field;return"["+E+"]"}case Ue.META_COMPARE:{var S=h.operator,T=h.field;return"[["+T+i(e(S))+n(m)+"]]"}case Ue.STATE:return m;case Ue.ID:return"#"+m;case Ue.CLASS:return"."+m;case Ue.PARENT:case Ue.CHILD:return s(h.parent,d)+i(">")+s(h.child,d);case Ue.ANCESTOR:case Ue.DESCENDANT:return s(h.ancestor,d)+" "+s(h.descendant,d);case Ue.COMPOUND_SPLIT:{var R=s(h.left,d),D=s(h.subject,d),B=s(h.right,d);return R+(R.length>0?" ":"")+D+B}case Ue.TRUE:return""}},s=function(h,d){return h.checks.reduce(function(v,m,y){return v+(d===h&&y===0?"$":"")+a(m,d)},"")},o="",l=0;l<this.length;l++){var u=this[l];o+=s(u,u.subject),this.length>1&&l<this.length-1&&(o+=", ")}return this.toStringCache=o,o},D7={parse:T7,toString:M7},EE=function(e,n,i){var a,s=Je(e),o=Be(e),l=Je(i),u,c,h=!1,d=!1,v=!1;switch(n.indexOf("!")>=0&&(n=n.replace("!",""),d=!0),n.indexOf("@")>=0&&(n=n.replace("@",""),h=!0),(s||l||h)&&(u=!s&&!o?"":""+e,c=""+i),h&&(e=u=u.toLowerCase(),i=c=c.toLowerCase()),n){case"*=":a=u.indexOf(c)>=0;break;case"$=":a=u.indexOf(c,u.length-c.length)>=0;break;case"^=":a=u.indexOf(c)===0;break;case"=":a=e===i;break;case">":v=!0,a=e>i;break;case">=":v=!0,a=e>=i;break;case"<":v=!0,a=e<i;break;case"<=":v=!0,a=e<=i;break;default:a=!1;break}return d&&(e!=null||!v)&&(a=!a),a},R7=function(e,n){switch(n){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},B7=function(e){return e!==void 0},w2=function(e,n){return e.data(n)},I7=function(e,n){return e[n]()},xr=[],ir=function(e,n){return e.checks.every(function(i){return xr[i.type](i,n)})};xr[Ue.GROUP]=function(r,e){var n=r.value;return n==="*"||n===e.group()};xr[Ue.STATE]=function(r,e){var n=r.value;return w7(n,e)};xr[Ue.ID]=function(r,e){var n=r.value;return e.id()===n};xr[Ue.CLASS]=function(r,e){var n=r.value;return e.hasClass(n)};xr[Ue.META_COMPARE]=function(r,e){var n=r.field,i=r.operator,a=r.value;return EE(I7(e,n),i,a)};xr[Ue.DATA_COMPARE]=function(r,e){var n=r.field,i=r.operator,a=r.value;return EE(w2(e,n),i,a)};xr[Ue.DATA_BOOL]=function(r,e){var n=r.field,i=r.operator;return R7(w2(e,n),i)};xr[Ue.DATA_EXIST]=function(r,e){var n=r.field;return r.operator,B7(w2(e,n))};xr[Ue.UNDIRECTED_EDGE]=function(r,e){var n=r.nodes[0],i=r.nodes[1],a=e.source(),s=e.target();return ir(n,a)&&ir(i,s)||ir(i,a)&&ir(n,s)};xr[Ue.NODE_NEIGHBOR]=function(r,e){return ir(r.node,e)&&e.neighborhood().some(function(n){return n.isNode()&&ir(r.neighbor,n)})};xr[Ue.DIRECTED_EDGE]=function(r,e){return ir(r.source,e.source())&&ir(r.target,e.target())};xr[Ue.NODE_SOURCE]=function(r,e){return ir(r.source,e)&&e.outgoers().some(function(n){return n.isNode()&&ir(r.target,n)})};xr[Ue.NODE_TARGET]=function(r,e){return ir(r.target,e)&&e.incomers().some(function(n){return n.isNode()&&ir(r.source,n)})};xr[Ue.CHILD]=function(r,e){return ir(r.child,e)&&ir(r.parent,e.parent())};xr[Ue.PARENT]=function(r,e){return ir(r.parent,e)&&e.children().some(function(n){return ir(r.child,n)})};xr[Ue.DESCENDANT]=function(r,e){return ir(r.descendant,e)&&e.ancestors().some(function(n){return ir(r.ancestor,n)})};xr[Ue.ANCESTOR]=function(r,e){return ir(r.ancestor,e)&&e.descendants().some(function(n){return ir(r.descendant,n)})};xr[Ue.COMPOUND_SPLIT]=function(r,e){return ir(r.subject,e)&&ir(r.left,e)&&ir(r.right,e)};xr[Ue.TRUE]=function(){return!0};xr[Ue.COLLECTION]=function(r,e){var n=r.value;return n.has(e)};xr[Ue.FILTER]=function(r,e){var n=r.value;return n(e)};var N7=function(e){var n=this;if(n.length===1&&n[0].checks.length===1&&n[0].checks[0].type===Ue.ID)return e.getElementById(n[0].checks[0].value).collection();var i=function(s){for(var o=0;o<n.length;o++){var l=n[o];if(ir(l,s))return!0}return!1};return n.text()==null&&(i=function(){return!0}),e.filter(i)},F7=function(e){for(var n=this,i=0;i<n.length;i++){var a=n[i];if(ir(a,e))return!0}return!1},k7={matches:F7,filter:N7},xs=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||Je(e)&&e.match(/^\s*$/)||(jn(e)?this.addQuery({checks:[{type:Ue.COLLECTION,value:e.collection()}]}):gr(e)?this.addQuery({checks:[{type:Ue.FILTER,value:e}]}):Je(e)?this.parse(e)||(this.invalid=!0):cr("A selector must be created from a string; found "))},bs=xs.prototype;[D7,k7].forEach(function(r){return et(bs,r)});bs.text=function(){return this.inputText};bs.size=function(){return this.length};bs.eq=function(r){return this[r]};bs.sameText=function(r){return!this.invalid&&!r.invalid&&this.text()===r.text()};bs.addQuery=function(r){this[this.length++]=r};bs.selector=bs.toString;var gs={allAre:function(e){var n=new xs(e);return this.every(function(i){return n.matches(i)})},is:function(e){var n=new xs(e);return this.some(function(i){return n.matches(i)})},some:function(e,n){for(var i=0;i<this.length;i++){var a=n?e.apply(n,[this[i],i,this]):e(this[i],i,this);if(a)return!0}return!1},every:function(e,n){for(var i=0;i<this.length;i++){var a=n?e.apply(n,[this[i],i,this]):e(this[i],i,this);if(!a)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var n=this.length,i=e.length;return n!==i?!1:n===1?this[0]===e[0]:this.every(function(a){return e.hasElementWithId(a.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(n){return e.hasElementWithId(n.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var n=this.neighborhood();return e.every(function(i){return n.hasElementWithId(i.id())})},contains:function(e){e=this.cy().collection(e);var n=this;return e.every(function(i){return n.hasElementWithId(i.id())})}};gs.allAreNeighbours=gs.allAreNeighbors;gs.has=gs.contains;gs.equal=gs.equals=gs.same;var ci=function(e,n){return function(a,s,o,l){var u=a,c=this,h;if(u==null?h="":jn(u)&&u.length===1&&(h=u.id()),c.length===1&&h){var d=c[0]._private,v=d.traversalCache=d.traversalCache||{},m=v[n]=v[n]||[],y=co(h),b=m[y];return b||(m[y]=e.call(c,a,s,o,l))}else return e.call(c,a,s,o,l)}},Ol={parent:function(e){var n=[];if(this.length===1){var i=this[0]._private.parent;if(i)return i}for(var a=0;a<this.length;a++){var s=this[a],o=s._private.parent;o&&n.push(o)}return this.spawn(n,!0).filter(e)},parents:function(e){for(var n=[],i=this.parent();i.nonempty();){for(var a=0;a<i.length;a++){var s=i[a];n.push(s)}i=i.parent()}return this.spawn(n,!0).filter(e)},commonAncestors:function(e){for(var n,i=0;i<this.length;i++){var a=this[i],s=a.parents();n=n||s,n=n.intersect(s)}return n.filter(e)},orphans:function(e){return this.stdFilter(function(n){return n.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(n){return n.isChild()}).filter(e)},children:ci(function(r){for(var e=[],n=0;n<this.length;n++)for(var i=this[n],a=i._private.children,s=0;s<a.length;s++)e.push(a[s]);return this.spawn(e,!0).filter(r)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var n=[];function i(a){for(var s=0;s<a.length;s++){var o=a[s];n.push(o),o.children().nonempty()&&i(o.children())}}return i(this.children()),this.spawn(n,!0).filter(e)}};function C2(r,e,n,i){for(var a=[],s=new ql,o=r.cy(),l=o.hasCompoundNodes(),u=0;u<r.length;u++){var c=r[u];n?a.push(c):l&&i(a,s,c)}for(;a.length>0;){var h=a.shift();e(h),s.add(h.id()),l&&i(a,s,h)}return r}function SE(r,e,n){if(n.isParent())for(var i=n._private.children,a=0;a<i.length;a++){var s=i[a];e.has(s.id())||r.push(s)}}Ol.forEachDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return C2(this,r,e,SE)};function TE(r,e,n){if(n.isChild()){var i=n._private.parent;e.has(i.id())||r.push(i)}}Ol.forEachUp=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return C2(this,r,e,TE)};function P7(r,e,n){TE(r,e,n),SE(r,e,n)}Ol.forEachUpAndDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return C2(this,r,e,P7)};Ol.ancestors=Ol.parents;var Lc,ME;Lc=ME={data:Ot.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Ot.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Ot.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Ot.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Ot.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Ot.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};Lc.attr=Lc.data;Lc.removeAttr=Lc.removeData;var U7=ME,w0={};function Cm(r){return function(e){var n=this;if(e===void 0&&(e=!0),n.length!==0)if(n.isNode()&&!n.removed()){for(var i=0,a=n[0],s=a._private.edges,o=0;o<s.length;o++){var l=s[o];!e&&l.isLoop()||(i+=r(a,l))}return i}else return}}et(w0,{degree:Cm(function(r,e){return e.source().same(e.target())?2:1}),indegree:Cm(function(r,e){return e.target().same(r)?1:0}),outdegree:Cm(function(r,e){return e.source().same(r)?1:0})});function ul(r,e){return function(n){for(var i,a=this.nodes(),s=0;s<a.length;s++){var o=a[s],l=o[r](n);l!==void 0&&(i===void 0||e(l,i))&&(i=l)}return i}}et(w0,{minDegree:ul("degree",function(r,e){return r<e}),maxDegree:ul("degree",function(r,e){return r>e}),minIndegree:ul("indegree",function(r,e){return r<e}),maxIndegree:ul("indegree",function(r,e){return r>e}),minOutdegree:ul("outdegree",function(r,e){return r<e}),maxOutdegree:ul("outdegree",function(r,e){return r>e})});et(w0,{totalDegree:function(e){for(var n=0,i=this.nodes(),a=0;a<i.length;a++)n+=i[a].degree(e);return n}});var Ei,DE,RE=function(e,n,i){for(var a=0;a<e.length;a++){var s=e[a];if(!s.locked()){var o=s._private.position,l={x:n.x!=null?n.x-o.x:0,y:n.y!=null?n.y-o.y:0};s.isParent()&&!(l.x===0&&l.y===0)&&s.children().shift(l,i),s.dirtyBoundingBoxCache()}}},Q5={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,n){RE(e,n,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};Ei=DE={position:Ot.data(Q5),silentPosition:Ot.data(et({},Q5,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,n){RE(e,n,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,n){if(It(e))n?this.silentPosition(e):this.position(e);else if(gr(e)){var i=e,a=this.cy();a.startBatch();for(var s=0;s<this.length;s++){var o=this[s],l=void 0;(l=i(o,s))&&(n?o.silentPosition(l):o.position(l))}a.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,n,i){var a;if(It(e)?(a={x:Be(e.x)?e.x:0,y:Be(e.y)?e.y:0},i=n):Je(e)&&Be(n)&&(a={x:0,y:0},a[e]=n),a!=null){var s=this.cy();s.startBatch();for(var o=0;o<this.length;o++){var l=this[o];if(!(s.hasCompoundNodes()&&l.isChild()&&l.ancestors().anySame(this))){var u=l.position(),c={x:u.x+a.x,y:u.y+a.y};i?l.silentPosition(c):l.position(c)}}s.endBatch()}return this},silentShift:function(e,n){return It(e)?this.shift(e,!0):Je(e)&&Be(n)&&this.shift(e,n,!0),this},renderedPosition:function(e,n){var i=this[0],a=this.cy(),s=a.zoom(),o=a.pan(),l=It(e)?e:void 0,u=l!==void 0||n!==void 0&&Je(e);if(i&&i.isNode())if(u)for(var c=0;c<this.length;c++){var h=this[c];n!==void 0?h.position(e,(n-o[e])/s):l!==void 0&&h.position(nE(l,s,o))}else{var d=i.position();return l=m0(d,s,o),e===void 0?l:l[e]}else if(!u)return;return this},relativePosition:function(e,n){var i=this[0],a=this.cy(),s=It(e)?e:void 0,o=s!==void 0||n!==void 0&&Je(e),l=a.hasCompoundNodes();if(i&&i.isNode())if(o)for(var u=0;u<this.length;u++){var c=this[u],h=l?c.parent():null,d=h&&h.length>0,v=d;d&&(h=h[0]);var m=v?h.position():{x:0,y:0};n!==void 0?c.position(e,n+m[e]):s!==void 0&&c.position({x:s.x+m.x,y:s.y+m.y})}else{var y=i.position(),b=l?i.parent():null,x=b&&b.length>0,A=x;x&&(b=b[0]);var C=A?b.position():{x:0,y:0};return s={x:y.x-C.x,y:y.y-C.y},e===void 0?s:s[e]}else if(!o)return;return this}};Ei.modelPosition=Ei.point=Ei.position;Ei.modelPositions=Ei.points=Ei.positions;Ei.renderedPoint=Ei.renderedPosition;Ei.relativePoint=Ei.relativePosition;var V7=DE,Fl,Ss;Fl=Ss={};Ss.renderedBoundingBox=function(r){var e=this.boundingBox(r),n=this.cy(),i=n.zoom(),a=n.pan(),s=e.x1*i+a.x,o=e.x2*i+a.x,l=e.y1*i+a.y,u=e.y2*i+a.y;return{x1:s,x2:o,y1:l,y2:u,w:o-s,h:u-l}};Ss.dirtyCompoundBoundsCache=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(n){if(n.isParent()){var i=n._private;i.compoundBoundsClean=!1,i.bbCache=null,r||n.emitAndNotify("bounds")}}),this)};Ss.updateCompoundBounds=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!r&&e.batching())return this;function n(o){if(!o.isParent())return;var l=o._private,u=o.children(),c=o.pstyle("compound-sizing-wrt-labels").value==="include",h={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},d=u.boundingBox({includeLabels:c,includeOverlays:!1,useCache:!1}),v=l.position;(d.w===0||d.h===0)&&(d={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},d.x1=v.x-d.w/2,d.x2=v.x+d.w/2,d.y1=v.y-d.h/2,d.y2=v.y+d.h/2);function m(N,I,P){var F=0,O=0,U=I+P;return N>0&&U>0&&(F=I/U*N,O=P/U*N),{biasDiff:F,biasComplementDiff:O}}function y(N,I,P,F){if(P.units==="%")switch(F){case"width":return N>0?P.pfValue*N:0;case"height":return I>0?P.pfValue*I:0;case"average":return N>0&&I>0?P.pfValue*(N+I)/2:0;case"min":return N>0&&I>0?N>I?P.pfValue*I:P.pfValue*N:0;case"max":return N>0&&I>0?N>I?P.pfValue*N:P.pfValue*I:0;default:return 0}else return P.units==="px"?P.pfValue:0}var b=h.width.left.value;h.width.left.units==="px"&&h.width.val>0&&(b=b*100/h.width.val);var x=h.width.right.value;h.width.right.units==="px"&&h.width.val>0&&(x=x*100/h.width.val);var A=h.height.top.value;h.height.top.units==="px"&&h.height.val>0&&(A=A*100/h.height.val);var C=h.height.bottom.value;h.height.bottom.units==="px"&&h.height.val>0&&(C=C*100/h.height.val);var E=m(h.width.val-d.w,b,x),S=E.biasDiff,T=E.biasComplementDiff,R=m(h.height.val-d.h,A,C),D=R.biasDiff,B=R.biasComplementDiff;l.autoPadding=y(d.w,d.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),l.autoWidth=Math.max(d.w,h.width.val),v.x=(-S+d.x1+d.x2+T)/2,l.autoHeight=Math.max(d.h,h.height.val),v.y=(-D+d.y1+d.y2+B)/2}for(var i=0;i<this.length;i++){var a=this[i],s=a._private;(!s.compoundBoundsClean||r)&&(n(a),e.batching()||(s.compoundBoundsClean=!0))}return this};var si=function(e){return e===1/0||e===-1/0?0:e},Ai=function(e,n,i,a,s){a-n===0||s-i===0||n==null||i==null||a==null||s==null||(e.x1=n<e.x1?n:e.x1,e.x2=a>e.x2?a:e.x2,e.y1=i<e.y1?i:e.y1,e.y2=s>e.y2?s:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},ss=function(e,n){return n==null?e:Ai(e,n.x1,n.y1,n.x2,n.y2)},Yu=function(e,n,i){return Dn(e,n,i)},Vh=function(e,n,i){if(!n.cy().headless()){var a=n._private,s=a.rstyle,o=s.arrowWidth/2,l=n.pstyle(i+"-arrow-shape").value,u,c;if(l!=="none"){i==="source"?(u=s.srcX,c=s.srcY):i==="target"?(u=s.tgtX,c=s.tgtY):(u=s.midX,c=s.midY);var h=a.arrowBounds=a.arrowBounds||{},d=h[i]=h[i]||{};d.x1=u-o,d.y1=c-o,d.x2=u+o,d.y2=c+o,d.w=d.x2-d.x1,d.h=d.y2-d.y1,vd(d,1),Ai(e,d.x1,d.y1,d.x2,d.y2)}}},Em=function(e,n,i){if(!n.cy().headless()){var a;i?a=i+"-":a="";var s=n._private,o=s.rstyle,l=n.pstyle(a+"label").strValue;if(l){var u=n.pstyle("text-halign"),c=n.pstyle("text-valign"),h=Yu(o,"labelWidth",i),d=Yu(o,"labelHeight",i),v=Yu(o,"labelX",i),m=Yu(o,"labelY",i),y=n.pstyle(a+"text-margin-x").pfValue,b=n.pstyle(a+"text-margin-y").pfValue,x=n.isEdge(),A=n.pstyle(a+"text-rotation"),C=n.pstyle("text-outline-width").pfValue,E=n.pstyle("text-border-width").pfValue,S=E/2,T=n.pstyle("text-background-padding").pfValue,R=2,D=d,B=h,N=B/2,I=D/2,P,F,O,U;if(x)P=v-N,F=v+N,O=m-I,U=m+I;else{switch(u.value){case"left":P=v-B,F=v;break;case"center":P=v-N,F=v+N;break;case"right":P=v,F=v+B;break}switch(c.value){case"top":O=m-D,U=m;break;case"center":O=m-I,U=m+I;break;case"bottom":O=m,U=m+D;break}}var L=y-Math.max(C,S)-T-R,V=y+Math.max(C,S)+T+R,_=b-Math.max(C,S)-T-R,G=b+Math.max(C,S)+T+R;P+=L,F+=V,O+=_,U+=G;var K=i||"main",z=s.labelBounds,Y=z[K]=z[K]||{};Y.x1=P,Y.y1=O,Y.x2=F,Y.y2=U,Y.w=F-P,Y.h=U-O,Y.leftPad=L,Y.rightPad=V,Y.topPad=_,Y.botPad=G;var Z=x&&A.strValue==="autorotate",J=A.pfValue!=null&&A.pfValue!==0;if(Z||J){var ee=Z?Yu(s.rstyle,"labelAngle",i):A.pfValue,ne=Math.cos(ee),oe=Math.sin(ee),me=(P+F)/2,ye=(O+U)/2;if(!x){switch(u.value){case"left":me=F;break;case"right":me=P;break}switch(c.value){case"top":ye=U;break;case"bottom":ye=O;break}}var ve=function(He,$e){return He=He-me,$e=$e-ye,{x:He*ne-$e*oe+me,y:He*oe+$e*ne+ye}},re=ve(P,O),ae=ve(P,U),le=ve(F,O),Ae=ve(F,U);P=Math.min(re.x,ae.x,le.x,Ae.x),F=Math.max(re.x,ae.x,le.x,Ae.x),O=Math.min(re.y,ae.y,le.y,Ae.y),U=Math.max(re.y,ae.y,le.y,Ae.y)}var Re=K+"Rot",Le=z[Re]=z[Re]||{};Le.x1=P,Le.y1=O,Le.x2=F,Le.y2=U,Le.w=F-P,Le.h=U-O,Ai(e,P,O,F,U),Ai(s.labelBounds.all,P,O,F,U)}return e}},W5=function(e,n){if(!n.cy().headless()){var i=n.pstyle("outline-opacity").value,a=n.pstyle("outline-width").value,s=n.pstyle("outline-offset").value,o=a+s;BE(e,n,i,o,"outside",o/2)}},BE=function(e,n,i,a,s,o){if(!(i===0||a<=0||s==="inside")){var l=n.cy(),u=n.pstyle("shape").value,c=l.renderer().nodeShapes[u],h=n.position(),d=h.x,v=h.y,m=n.width(),y=n.height();if(c.hasMiterBounds){s==="center"&&(a/=2);var b=c.miterBounds(d,v,m,y,a);ss(e,b)}else o!=null&&o>0&&md(e,[o,o,o,o])}},O7=function(e,n){if(!n.cy().headless()){var i=n.pstyle("border-opacity").value,a=n.pstyle("border-width").pfValue,s=n.pstyle("border-position").value;BE(e,n,i,a,s)}},L7=function(e,n){var i=e._private.cy,a=i.styleEnabled(),s=i.headless(),o=yn(),l=e._private,u=e.isNode(),c=e.isEdge(),h,d,v,m,y,b,x=l.rstyle,A=u&&a?e.pstyle("bounds-expansion").pfValue:[0],C=function(bt){return bt.pstyle("display").value!=="none"},E=!a||C(e)&&(!c||C(e.source())&&C(e.target()));if(E){var S=0,T=0;a&&n.includeOverlays&&(S=e.pstyle("overlay-opacity").value,S!==0&&(T=e.pstyle("overlay-padding").value));var R=0,D=0;a&&n.includeUnderlays&&(R=e.pstyle("underlay-opacity").value,R!==0&&(D=e.pstyle("underlay-padding").value));var B=Math.max(T,D),N=0,I=0;if(a&&(N=e.pstyle("width").pfValue,I=N/2),u&&n.includeNodes){var P=e.position();y=P.x,b=P.y;var F=e.outerWidth(),O=F/2,U=e.outerHeight(),L=U/2;h=y-O,d=y+O,v=b-L,m=b+L,Ai(o,h,v,d,m),a&&W5(o,e),a&&n.includeOutlines&&!s&&W5(o,e),a&&O7(o,e)}else if(c&&n.includeEdges)if(a&&!s){var V=e.pstyle("curve-style").strValue;if(h=Math.min(x.srcX,x.midX,x.tgtX),d=Math.max(x.srcX,x.midX,x.tgtX),v=Math.min(x.srcY,x.midY,x.tgtY),m=Math.max(x.srcY,x.midY,x.tgtY),h-=I,d+=I,v-=I,m+=I,Ai(o,h,v,d,m),V==="haystack"){var _=x.haystackPts;if(_&&_.length===2){if(h=_[0].x,v=_[0].y,d=_[1].x,m=_[1].y,h>d){var G=h;h=d,d=G}if(v>m){var K=v;v=m,m=K}Ai(o,h-I,v-I,d+I,m+I)}}else if(V==="bezier"||V==="unbundled-bezier"||us(V,"segments")||us(V,"taxi")){var z;switch(V){case"bezier":case"unbundled-bezier":z=x.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":z=x.linePts;break}if(z!=null)for(var Y=0;Y<z.length;Y++){var Z=z[Y];h=Z.x-I,d=Z.x+I,v=Z.y-I,m=Z.y+I,Ai(o,h,v,d,m)}}}else{var J=e.source(),ee=J.position(),ne=e.target(),oe=ne.position();if(h=ee.x,d=oe.x,v=ee.y,m=oe.y,h>d){var me=h;h=d,d=me}if(v>m){var ye=v;v=m,m=ye}h-=I,d+=I,v-=I,m+=I,Ai(o,h,v,d,m)}if(a&&n.includeEdges&&c&&(Vh(o,e,"mid-source"),Vh(o,e,"mid-target"),Vh(o,e,"source"),Vh(o,e,"target")),a){var ve=e.pstyle("ghost").value==="yes";if(ve){var re=e.pstyle("ghost-offset-x").pfValue,ae=e.pstyle("ghost-offset-y").pfValue;Ai(o,o.x1+re,o.y1+ae,o.x2+re,o.y2+ae)}}var le=l.bodyBounds=l.bodyBounds||{};Pw(le,o),md(le,A),vd(le,1),a&&(h=o.x1,d=o.x2,v=o.y1,m=o.y2,Ai(o,h-B,v-B,d+B,m+B));var Ae=l.overlayBounds=l.overlayBounds||{};Pw(Ae,o),md(Ae,A),vd(Ae,1);var Re=l.labelBounds=l.labelBounds||{};Re.all!=null?xR(Re.all):Re.all=yn(),a&&n.includeLabels&&(n.includeMainLabels&&Em(o,e,null),c&&(n.includeSourceLabels&&Em(o,e,"source"),n.includeTargetLabels&&Em(o,e,"target")))}return o.x1=si(o.x1),o.y1=si(o.y1),o.x2=si(o.x2),o.y2=si(o.y2),o.w=si(o.x2-o.x1),o.h=si(o.y2-o.y1),o.w>0&&o.h>0&&E&&(md(o,A),vd(o,1)),o},IE=function(e){var n=0,i=function(o){return(o?1:0)<<n++},a=0;return a+=i(e.incudeNodes),a+=i(e.includeEdges),a+=i(e.includeLabels),a+=i(e.includeMainLabels),a+=i(e.includeSourceLabels),a+=i(e.includeTargetLabels),a+=i(e.includeOverlays),a+=i(e.includeOutlines),a},NE=function(e){var n=function(l){return Math.round(l)};if(e.isEdge()){var i=e.source().position(),a=e.target().position();return Rw([n(i.x),n(i.y),n(a.x),n(a.y)])}else{var s=e.position();return Rw([n(s.x),n(s.y)])}},Z5=function(e,n){var i=e._private,a,s=e.isEdge(),o=n==null?J5:IE(n),l=o===J5;if(i.bbCache==null?(a=L7(e,_c),i.bbCache=a,i.bbCachePosKey=NE(e)):a=i.bbCache,!l){var u=e.isNode();a=yn(),(n.includeNodes&&u||n.includeEdges&&!u)&&(n.includeOverlays?ss(a,i.overlayBounds):ss(a,i.bodyBounds)),n.includeLabels&&(n.includeMainLabels&&(!s||n.includeSourceLabels&&n.includeTargetLabels)?ss(a,i.labelBounds.all):(n.includeMainLabels&&ss(a,i.labelBounds.mainRot),n.includeSourceLabels&&ss(a,i.labelBounds.sourceRot),n.includeTargetLabels&&ss(a,i.labelBounds.targetRot))),a.w=a.x2-a.x1,a.h=a.y2-a.y1}return a},_c={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},J5=IE(_c),$5=$r(_c);Ss.boundingBox=function(r){var e,n=r===void 0||r.useCache===void 0||r.useCache===!0,i=Ul(function(h){var d=h._private;return d.bbCache==null||d.styleDirty||d.bbCachePosKey!==NE(h)},function(h){return h.id()});if(n&&this.length===1&&!i(this[0]))r===void 0?r=_c:r=$5(r),e=Z5(this[0],r);else{e=yn(),r=r||_c;var a=$5(r),s=this,o=s.cy(),l=o.styleEnabled();this.edges().forEach(i),this.nodes().forEach(i),l&&this.recalculateRenderedStyle(n),this.updateCompoundBounds(!n);for(var u=0;u<s.length;u++){var c=s[u];i(c)&&c.dirtyBoundingBoxCache(),ss(e,Z5(c,a))}}return e.x1=si(e.x1),e.y1=si(e.y1),e.x2=si(e.x2),e.y2=si(e.y2),e.w=si(e.x2-e.x1),e.h=si(e.y2-e.y1),e};Ss.dirtyBoundingBoxCache=function(){for(var r=0;r<this.length;r++){var e=this[r]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Ss.boundingBoxAt=function(r){var e=this.nodes(),n=this.cy(),i=n.hasCompoundNodes(),a=n.collection();if(i&&(a=e.filter(function(c){return c.isParent()}),e=e.not(a)),It(r)){var s=r;r=function(){return s}}var o=function(h,d){return h._private.bbAtOldPos=r(h,d)},l=function(h){return h._private.bbAtOldPos};n.startBatch(),e.forEach(o).silentPositions(r),i&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0));var u=AR(this.boundingBox({useCache:!1}));return e.silentPositions(l),i&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0)),n.endBatch(),u};Fl.boundingbox=Fl.bb=Fl.boundingBox;Fl.renderedBoundingbox=Fl.renderedBoundingBox;var _7=Ss,gc,of;gc=of={};var FE=function(e){e.uppercaseName=gw(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=gw(e.outerName),gc[e.name]=function(){var i=this[0],a=i._private,s=a.cy,o=s._private.styleEnabled;if(i)if(o){if(i.isParent())return i.updateCompoundBounds(),a[e.autoName]||0;var l=i.pstyle(e.name);switch(l.strValue){case"label":return i.recalculateRenderedStyle(),a.rstyle[e.labelName]||0;default:return l.pfValue}}else return 1},gc["outer"+e.uppercaseName]=function(){var i=this[0],a=i._private,s=a.cy,o=s._private.styleEnabled;if(i)if(o){var l=i[e.name](),u=i.pstyle("border-position").value,c;u==="center"?c=i.pstyle("border-width").pfValue:u==="outside"?c=2*i.pstyle("border-width").pfValue:c=0;var h=2*i.padding();return l+c+h}else return 1},gc["rendered"+e.uppercaseName]=function(){var i=this[0];if(i){var a=i[e.name]();return a*this.cy().zoom()}},gc["rendered"+e.uppercaseOuterName]=function(){var i=this[0];if(i){var a=i[e.outerName]();return a*this.cy().zoom()}}};FE({name:"width"});FE({name:"height"});of.padding=function(){var r=this[0],e=r._private;return r.isParent()?(r.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:r.pstyle("padding").pfValue):r.pstyle("padding").pfValue};of.paddedHeight=function(){var r=this[0];return r.height()+2*r.padding()};of.paddedWidth=function(){var r=this[0];return r.width()+2*r.padding()};var z7=of,q7=function(e,n){if(e.isEdge()&&e.takesUpSpace())return n(e)},G7=function(e,n){if(e.isEdge()&&e.takesUpSpace()){var i=e.cy();return m0(n(e),i.zoom(),i.pan())}},Y7=function(e,n){if(e.isEdge()&&e.takesUpSpace()){var i=e.cy(),a=i.pan(),s=i.zoom();return n(e).map(function(o){return m0(o,s,a)})}},H7=function(e){return e.renderer().getControlPoints(e)},j7=function(e){return e.renderer().getSegmentPoints(e)},K7=function(e){return e.renderer().getSourceEndpoint(e)},X7=function(e){return e.renderer().getTargetEndpoint(e)},Q7=function(e){return e.renderer().getEdgeMidpoint(e)},e3={controlPoints:{get:H7,mult:!0},segmentPoints:{get:j7,mult:!0},sourceEndpoint:{get:K7},targetEndpoint:{get:X7},midpoint:{get:Q7}},W7=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},Z7=Object.keys(e3).reduce(function(r,e){var n=e3[e],i=W7(e);return r[e]=function(){return q7(this,n.get)},n.mult?r[i]=function(){return Y7(this,n.get)}:r[i]=function(){return G7(this,n.get)},r},{}),J7=et({},V7,_7,z7,Z7);/*!
Event object based on jQuery events, MIT license

https://jquery.org/license/
https://tldrlegal.com/license/mit-license
https://github.com/jquery/jquery/blob/master/src/event.js
*/var kE=function(e,n){this.recycle(e,n)};function Hu(){return!1}function Oh(){return!0}kE.prototype={instanceString:function(){return"event"},recycle:function(e,n){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Hu,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Oh:Hu):e!=null&&e.type?n=e:this.type=e,n!=null&&(this.originalEvent=n.originalEvent,this.type=n.type!=null?n.type:this.type,this.cy=n.cy,this.target=n.target,this.position=n.position,this.renderedPosition=n.renderedPosition,this.namespace=n.namespace,this.layout=n.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var i=this.position,a=this.cy.zoom(),s=this.cy.pan();this.renderedPosition={x:i.x*a+s.x,y:i.y*a+s.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Oh;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Oh;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Oh,this.stopPropagation()},isDefaultPrevented:Hu,isPropagationStopped:Hu,isImmediatePropagationStopped:Hu};var PE=/^([^.]+)(\.(?:[^.]+))?$/,$7=".*",UE={qualifierCompare:function(e,n){return e===n},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},t3=Object.keys(UE),eI={};function C0(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eI,e=arguments.length>1?arguments[1]:void 0,n=0;n<t3.length;n++){var i=t3[n];this[i]=r[i]||UE[i]}this.context=e||this.context,this.listeners=[],this.emitting=0}var ws=C0.prototype,VE=function(e,n,i,a,s,o,l){gr(a)&&(s=a,a=null),l&&(o==null?o=l:o=et({},o,l));for(var u=Qt(i)?i:i.split(/\s+/),c=0;c<u.length;c++){var h=u[c];if(!ps(h)){var d=h.match(PE);if(d){var v=d[1],m=d[2]?d[2]:null,y=n(e,h,v,m,a,s,o);if(y===!1)break}}}},r3=function(e,n){return e.addEventFields(e.context,n),new kE(n.type,n)},tI=function(e,n,i){if(o8(i)){n(e,i);return}else if(It(i)){n(e,r3(e,i));return}for(var a=Qt(i)?i:i.split(/\s+/),s=0;s<a.length;s++){var o=a[s];if(!ps(o)){var l=o.match(PE);if(l){var u=l[1],c=l[2]?l[2]:null,h=r3(e,{type:u,namespace:c,target:e.context});n(e,h)}}}};ws.on=ws.addListener=function(r,e,n,i,a){return VE(this,function(s,o,l,u,c,h,d){gr(h)&&s.listeners.push({event:o,callback:h,type:l,namespace:u,qualifier:c,conf:d})},r,e,n,i,a),this};ws.one=function(r,e,n,i){return this.on(r,e,n,i,{one:!0})};ws.removeListener=ws.off=function(r,e,n,i){var a=this;this.emitting!==0&&(this.listeners=G8(this.listeners));for(var s=this.listeners,o=function(c){var h=s[c];VE(a,function(d,v,m,y,b,x){if((h.type===m||r==="*")&&(!y&&h.namespace!==".*"||h.namespace===y)&&(!b||d.qualifierCompare(h.qualifier,b))&&(!x||h.callback===x))return s.splice(c,1),!1},r,e,n,i)},l=s.length-1;l>=0;l--)o(l);return this};ws.removeAllListeners=function(){return this.removeListener("*")};ws.emit=ws.trigger=function(r,e,n){var i=this.listeners,a=i.length;return this.emitting++,Qt(e)||(e=[e]),tI(this,function(s,o){n!=null&&(i=[{event:o.event,type:o.type,namespace:o.namespace,callback:n}],a=i.length);for(var l=function(){var h=i[u];if(h.type===o.type&&(!h.namespace||h.namespace===o.namespace||h.namespace===$7)&&s.eventMatches(s.context,h,o)){var d=[o];e!=null&&H8(d,e),s.beforeEmit(s.context,h,o),h.conf&&h.conf.one&&(s.listeners=s.listeners.filter(function(y){return y!==h}));var v=s.callbackContext(s.context,h,o),m=h.callback.apply(v,d);s.afterEmit(s.context,h,o),m===!1&&(o.stopPropagation(),o.preventDefault())}},u=0;u<a;u++)l();s.bubble(s.context)&&!o.isPropagationStopped()&&s.parent(s.context).emit(o,e)},r),this.emitting--,this};var rI={qualifierCompare:function(e,n){return e==null||n==null?e==null&&n==null:e.sameText(n)},eventMatches:function(e,n,i){var a=n.qualifier;return a!=null?e!==i.target&&ef(i.target)&&a.matches(i.target):!0},addEventFields:function(e,n){n.cy=e.cy(),n.target=e},callbackContext:function(e,n,i){return n.qualifier!=null?i.target:e},beforeEmit:function(e,n){n.conf&&n.conf.once&&n.conf.onceCollection.removeListener(n.event,n.qualifier,n.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},Lh=function(e){return Je(e)?new xs(e):e},OE={createEmitter:function(){for(var e=0;e<this.length;e++){var n=this[e],i=n._private;i.emitter||(i.emitter=new C0(rI,n))}return this},emitter:function(){return this._private.emitter},on:function(e,n,i){for(var a=Lh(n),s=0;s<this.length;s++){var o=this[s];o.emitter().on(e,a,i)}return this},removeListener:function(e,n,i){for(var a=Lh(n),s=0;s<this.length;s++){var o=this[s];o.emitter().removeListener(e,a,i)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var n=this[e];n.emitter().removeAllListeners()}return this},one:function(e,n,i){for(var a=Lh(n),s=0;s<this.length;s++){var o=this[s];o.emitter().one(e,a,i)}return this},once:function(e,n,i){for(var a=Lh(n),s=0;s<this.length;s++){var o=this[s];o.emitter().on(e,a,i,{once:!0,onceCollection:this})}},emit:function(e,n){for(var i=0;i<this.length;i++){var a=this[i];a.emitter().emit(e,n)}return this},emitAndNotify:function(e,n){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,n),this}};Ot.eventAliasesOn(OE);var LE={nodes:function(e){return this.filter(function(n){return n.isNode()}).filter(e)},edges:function(e){return this.filter(function(n){return n.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),n=this.spawn(),i=0;i<this.length;i++){var a=this[i];a.isNode()?e.push(a):n.push(a)}return{nodes:e,edges:n}},filter:function(e,n){if(e===void 0)return this;if(Je(e)||jn(e))return new xs(e).filter(this);if(gr(e)){for(var i=this.spawn(),a=this,s=0;s<a.length;s++){var o=a[s],l=n?e.apply(n,[o,s,a]):e(o,s,a);l&&i.push(o)}return i}return this.spawn()},not:function(e){if(e){Je(e)&&(e=this.filter(e));for(var n=this.spawn(),i=0;i<this.length;i++){var a=this[i],s=e.has(a);s||n.push(a)}return n}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(Je(e)){var n=e;return this.filter(n)}for(var i=this.spawn(),a=this,s=e,o=this.length<e.length,l=o?a:s,u=o?s:a,c=0;c<l.length;c++){var h=l[c];u.has(h)&&i.push(h)}return i},xor:function(e){var n=this._private.cy;Je(e)&&(e=n.$(e));var i=this.spawn(),a=this,s=e,o=function(u,c){for(var h=0;h<u.length;h++){var d=u[h],v=d._private.data.id,m=c.hasElementWithId(v);m||i.push(d)}};return o(a,s),o(s,a),i},diff:function(e){var n=this._private.cy;Je(e)&&(e=n.$(e));var i=this.spawn(),a=this.spawn(),s=this.spawn(),o=this,l=e,u=function(h,d,v){for(var m=0;m<h.length;m++){var y=h[m],b=y._private.data.id,x=d.hasElementWithId(b);x?s.merge(y):v.push(y)}};return u(o,l,i),u(l,o,a),{left:i,right:a,both:s}},add:function(e){var n=this._private.cy;if(!e)return this;if(Je(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=this.spawnSelf(),s=0;s<e.length;s++){var o=e[s],l=!this.has(o);l&&a.push(o)}return a},merge:function(e){var n=this._private,i=n.cy;if(!e)return this;if(e&&Je(e)){var a=e;e=i.mutableElements().filter(a)}for(var s=n.map,o=0;o<e.length;o++){var l=e[o],u=l._private.data.id,c=!s.has(u);if(c){var h=this.length++;this[h]=l,s.set(u,{ele:l,index:h})}}return this},unmergeAt:function(e){var n=this[e],i=n.id(),a=this._private,s=a.map;this[e]=void 0,s.delete(i);var o=e===this.length-1;if(this.length>1&&!o){var l=this.length-1,u=this[l],c=u._private.data.id;this[l]=void 0,this[e]=u,s.set(c,{ele:u,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var n=this._private,i=e._private.data.id,a=n.map,s=a.get(i);if(!s)return this;var o=s.index;return this.unmergeAt(o),this},unmerge:function(e){var n=this._private.cy;if(!e)return this;if(e&&Je(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=0;a<e.length;a++)this.unmergeOne(e[a]);return this},unmergeBy:function(e){for(var n=this.length-1;n>=0;n--){var i=this[n];e(i)&&this.unmergeAt(n)}return this},map:function(e,n){for(var i=[],a=this,s=0;s<a.length;s++){var o=a[s],l=n?e.apply(n,[o,s,a]):e(o,s,a);i.push(l)}return i},reduce:function(e,n){for(var i=n,a=this,s=0;s<a.length;s++)i=e(i,a[s],s,a);return i},max:function(e,n){for(var i=-1/0,a,s=this,o=0;o<s.length;o++){var l=s[o],u=n?e.apply(n,[l,o,s]):e(l,o,s);u>i&&(i=u,a=l)}return{value:i,ele:a}},min:function(e,n){for(var i=1/0,a,s=this,o=0;o<s.length;o++){var l=s[o],u=n?e.apply(n,[l,o,s]):e(l,o,s);u<i&&(i=u,a=l)}return{value:i,ele:a}}},kt=LE;kt.u=kt["|"]=kt["+"]=kt.union=kt.or=kt.add;kt["\\"]=kt["!"]=kt["-"]=kt.difference=kt.relativeComplement=kt.subtract=kt.not;kt.n=kt["&"]=kt["."]=kt.and=kt.intersection=kt.intersect;kt["^"]=kt["(+)"]=kt["(-)"]=kt.symmetricDifference=kt.symdiff=kt.xor;kt.fnFilter=kt.filterFn=kt.stdFilter=kt.filter;kt.complement=kt.abscomp=kt.absoluteComplement;var nI={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},_E=function(e,n){var i=e.cy(),a=i.hasCompoundNodes();function s(h){var d=h.pstyle("z-compound-depth");return d.value==="auto"?a?h.zDepth():0:d.value==="bottom"?-1:d.value==="top"?h2:0}var o=s(e)-s(n);if(o!==0)return o;function l(h){var d=h.pstyle("z-index-compare");return d.value==="auto"&&h.isNode()?1:0}var u=l(e)-l(n);if(u!==0)return u;var c=e.pstyle("z-index").value-n.pstyle("z-index").value;return c!==0?c:e.poolIndex()-n.poolIndex()},Hd={forEach:function(e,n){if(gr(e))for(var i=this.length,a=0;a<i;a++){var s=this[a],o=n?e.apply(n,[s,a,this]):e(s,a,this);if(o===!1)break}return this},toArray:function(){for(var e=[],n=0;n<this.length;n++)e.push(this[n]);return e},slice:function(e,n){var i=[],a=this.length;n==null&&(n=a),e==null&&(e=0),e<0&&(e=a+e),n<0&&(n=a+n);for(var s=e;s>=0&&s<n&&s<a;s++)i.push(this[s]);return this.spawn(i)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!gr(e))return this;var n=this.toArray().sort(e);return this.spawn(n)},sortByZIndex:function(){return this.sort(_E)},zDepth:function(){var e=this[0];if(e){var n=e._private,i=n.group;if(i==="nodes"){var a=n.data.parent?e.parents().size():0;return e.isParent()?a:h2-1}else{var s=n.source,o=n.target,l=s.zDepth(),u=o.zDepth();return Math.max(l,u,0)}}}};Hd.each=Hd.forEach;var iI=function(){var e="undefined",n=(typeof Symbol>"u"?"undefined":Pr(Symbol))!=e&&Pr(Symbol.iterator)!=e;n&&(Hd[Symbol.iterator]=function(){var i=this,a={value:void 0,done:!1},s=0,o=this.length;return OC({next:function(){return s<o?a.value=i[s++]:(a.value=void 0,a.done=!0),a}},Symbol.iterator,function(){return this})})};iI();var aI=$r({nodeDimensionsIncludeLabels:!1}),yd={layoutDimensions:function(e){e=aI(e);var n;if(!this.takesUpSpace())n={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var i=this.boundingBox();n={w:i.w,h:i.h}}else n={w:this.outerWidth(),h:this.outerHeight()};return(n.w===0||n.h===0)&&(n.w=n.h=1),n},layoutPositions:function(e,n,i){var a=this.nodes().filter(function(T){return!T.isParent()}),s=this.cy(),o=n.eles,l=function(R){return R.id()},u=Ul(i,l);e.emit({type:"layoutstart",layout:e}),e.animations=[];var c=function(R,D,B){var N={x:D.x1+D.w/2,y:D.y1+D.h/2},I={x:(B.x-N.x)*R,y:(B.y-N.y)*R};return{x:N.x+I.x,y:N.y+I.y}},h=n.spacingFactor&&n.spacingFactor!==1,d=function(){if(!h)return null;for(var R=yn(),D=0;D<a.length;D++){var B=a[D],N=u(B,D);iE(R,N.x,N.y)}return R},v=d(),m=Ul(function(T,R){var D=u(T,R);if(h){var B=Math.abs(n.spacingFactor);D=c(B,v,D)}return n.transform!=null&&(D=n.transform(T,D)),D},l);if(n.animate){for(var y=0;y<a.length;y++){var b=a[y],x=m(b,y),A=n.animateFilter==null||n.animateFilter(b,y);if(A){var C=b.animation({position:x,duration:n.animationDuration,easing:n.animationEasing});e.animations.push(C)}else b.position(x)}if(n.fit){var E=s.animation({fit:{boundingBox:o.boundingBoxAt(m),padding:n.padding},duration:n.animationDuration,easing:n.animationEasing});e.animations.push(E)}else if(n.zoom!==void 0&&n.pan!==void 0){var S=s.animation({zoom:n.zoom,pan:n.pan,duration:n.animationDuration,easing:n.animationEasing});e.animations.push(S)}e.animations.forEach(function(T){return T.play()}),e.one("layoutready",n.ready),e.emit({type:"layoutready",layout:e}),Gl.all(e.animations.map(function(T){return T.promise()})).then(function(){e.one("layoutstop",n.stop),e.emit({type:"layoutstop",layout:e})})}else a.positions(m),n.fit&&s.fit(n.eles,n.padding),n.zoom!=null&&s.zoom(n.zoom),n.pan&&s.pan(n.pan),e.one("layoutready",n.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",n.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var n=this.cy();return n.makeLayout(et({},e,{eles:this}))}};yd.createLayout=yd.makeLayout=yd.layout;function zE(r,e,n){var i=n._private,a=i.styleCache=i.styleCache||[],s;return(s=a[r])!=null||(s=a[r]=e(n)),s}function E0(r,e){return r=co(r),function(i){return zE(r,e,i)}}function S0(r,e){r=co(r);var n=function(a){return e.call(a)};return function(){var a=this[0];if(a)return zE(r,n,a)}}var Zr={recalculateRenderedStyle:function(e){var n=this.cy(),i=n.renderer(),a=n.styleEnabled();return i&&a&&i.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),n=function(s){return s._private.styleCache=null};if(e.hasCompoundNodes()){var i;i=this.spawnSelf().merge(this.descendants()).merge(this.parents()),i.merge(i.connectedEdges()),i.forEach(n)}else this.forEach(function(a){n(a),a.connectedEdges().forEach(n)});return this},updateStyle:function(e){var n=this._private.cy;if(!n.styleEnabled())return this;if(n.batching()){var i=n._private.batchStyleEles;return i.merge(this),this}var a=n.hasCompoundNodes(),s=this;e=!!(e||e===void 0),a&&(s=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=s;return e?o.emitAndNotify("style"):o.emit("style"),s.forEach(function(l){return l._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var n=0;n<this.length;n++){var i=this[n];i._private.styleDirty&&(i._private.styleDirty=!1,e.style().apply(i))}},parsedStyle:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=this[0],a=i.cy();if(a.styleEnabled()&&i){i._private.styleDirty&&(i._private.styleDirty=!1,a.style().apply(i));var s=i._private.style[e];return s??(n?a.style().getDefaultProperty(e):null)}},numericStyle:function(e){var n=this[0];if(n.cy().styleEnabled()&&n){var i=n.pstyle(e);return i.pfValue!==void 0?i.pfValue:i.value}},numericStyleUnits:function(e){var n=this[0];if(n.cy().styleEnabled()&&n)return n.pstyle(e).units},renderedStyle:function(e){var n=this.cy();if(!n.styleEnabled())return this;var i=this[0];if(i)return n.style().getRenderedStyle(i,e)},style:function(e,n){var i=this.cy();if(!i.styleEnabled())return this;var a=!1,s=i.style();if(It(e)){var o=e;s.applyBypass(this,o,a),this.emitAndNotify("style")}else if(Je(e))if(n===void 0){var l=this[0];return l?s.getStylePropertyValue(l,e):void 0}else s.applyBypass(this,e,n,a),this.emitAndNotify("style");else if(e===void 0){var u=this[0];return u?s.getRawStyle(u):void 0}return this},removeStyle:function(e){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style(),s=this;if(e===void 0)for(var o=0;o<s.length;o++){var l=s[o];a.removeAllBypasses(l,i)}else{e=e.split(/\s+/);for(var u=0;u<s.length;u++){var c=s[u];a.removeBypasses(c,e,i)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var n=e.hasCompoundNodes(),i=this[0];if(i){var a=i._private,s=i.pstyle("opacity").value;if(!n)return s;var o=a.data.parent?i.parents():null;if(o)for(var l=0;l<o.length;l++){var u=o[l],c=u.pstyle("opacity").value;s=c*s}return s}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var n=this[0],i=n.cy().hasCompoundNodes();if(n)return i?n.effectiveOpacity()===0:n.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var n=this[0];return!!n._private.backgrounding}};function Sm(r,e){var n=r._private,i=n.data.parent?r.parents():null;if(i)for(var a=0;a<i.length;a++){var s=i[a];if(!e(s))return!1}return!0}function E2(r){var e=r.ok,n=r.edgeOkViaNode||r.ok,i=r.parentOk||r.ok;return function(){var a=this.cy();if(!a.styleEnabled())return!0;var s=this[0],o=a.hasCompoundNodes();if(s){var l=s._private;if(!e(s))return!1;if(s.isNode())return!o||Sm(s,i);var u=l.source,c=l.target;return n(u)&&(!o||Sm(u,n))&&(u===c||n(c)&&(!o||Sm(c,n)))}}}var Yl=E0("eleTakesUpSpace",function(r){return r.pstyle("display").value==="element"&&r.width()!==0&&(r.isNode()?r.height()!==0:!0)});Zr.takesUpSpace=S0("takesUpSpace",E2({ok:Yl}));var sI=E0("eleInteractive",function(r){return r.pstyle("events").value==="yes"&&r.pstyle("visibility").value==="visible"&&Yl(r)}),oI=E0("parentInteractive",function(r){return r.pstyle("visibility").value==="visible"&&Yl(r)});Zr.interactive=S0("interactive",E2({ok:sI,parentOk:oI,edgeOkViaNode:Yl}));Zr.noninteractive=function(){var r=this[0];if(r)return!r.interactive()};var lI=E0("eleVisible",function(r){return r.pstyle("visibility").value==="visible"&&r.pstyle("opacity").pfValue!==0&&Yl(r)}),uI=Yl;Zr.visible=S0("visible",E2({ok:lI,edgeOkViaNode:uI}));Zr.hidden=function(){var r=this[0];if(r)return!r.visible()};Zr.isBundledBezier=S0("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});Zr.bypass=Zr.css=Zr.style;Zr.renderedCss=Zr.renderedStyle;Zr.removeBypass=Zr.removeCss=Zr.removeStyle;Zr.pstyle=Zr.parsedStyle;var vs={};function n3(r){return function(){var e=arguments,n=[];if(e.length===2){var i=e[0],a=e[1];this.on(r.event,i,a)}else if(e.length===1&&gr(e[0])){var s=e[0];this.on(r.event,s)}else if(e.length===0||e.length===1&&Qt(e[0])){for(var o=e.length===1?e[0]:null,l=0;l<this.length;l++){var u=this[l],c=!r.ableField||u._private[r.ableField],h=u._private[r.field]!=r.value;if(r.overrideAble){var d=r.overrideAble(u);if(d!==void 0&&(c=d,!d))return this}c&&(u._private[r.field]=r.value,h&&n.push(u))}var v=this.spawn(n);v.updateStyle(),v.emit(r.event),o&&v.emit(o)}return this}}function Hl(r){vs[r.field]=function(){var e=this[0];if(e){if(r.overrideField){var n=r.overrideField(e);if(n!==void 0)return n}return e._private[r.field]}},vs[r.on]=n3({event:r.on,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!0}),vs[r.off]=n3({event:r.off,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!1})}Hl({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});Hl({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});Hl({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});Hl({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});vs.deselect=vs.unselect;vs.grabbed=function(){var r=this[0];if(r)return r._private.grabbed};Hl({field:"active",on:"activate",off:"unactivate"});Hl({field:"pannable",on:"panify",off:"unpanify"});vs.inactive=function(){var r=this[0];if(r)return!r._private.active};var sn={},i3=function(e){return function(i){for(var a=this,s=[],o=0;o<a.length;o++){var l=a[o];if(l.isNode()){for(var u=!1,c=l.connectedEdges(),h=0;h<c.length;h++){var d=c[h],v=d.source(),m=d.target();if(e.noIncomingEdges&&m===l&&v!==l||e.noOutgoingEdges&&v===l&&m!==l){u=!0;break}}u||s.push(l)}}return this.spawn(s,!0).filter(i)}},a3=function(e){return function(n){for(var i=this,a=[],s=0;s<i.length;s++){var o=i[s];if(o.isNode())for(var l=o.connectedEdges(),u=0;u<l.length;u++){var c=l[u],h=c.source(),d=c.target();e.outgoing&&h===o?(a.push(c),a.push(d)):e.incoming&&d===o&&(a.push(c),a.push(h))}}return this.spawn(a,!0).filter(n)}},s3=function(e){return function(n){for(var i=this,a=[],s={};;){var o=e.outgoing?i.outgoers():i.incomers();if(o.length===0)break;for(var l=!1,u=0;u<o.length;u++){var c=o[u],h=c.id();s[h]||(s[h]=!0,a.push(c),l=!0)}if(!l)break;i=o}return this.spawn(a,!0).filter(n)}};sn.clearTraversalCache=function(){for(var r=0;r<this.length;r++)this[r]._private.traversalCache=null};et(sn,{roots:i3({noIncomingEdges:!0}),leaves:i3({noOutgoingEdges:!0}),outgoers:ci(a3({outgoing:!0}),"outgoers"),successors:s3({outgoing:!0}),incomers:ci(a3({incoming:!0}),"incomers"),predecessors:s3({})});et(sn,{neighborhood:ci(function(r){for(var e=[],n=this.nodes(),i=0;i<n.length;i++)for(var a=n[i],s=a.connectedEdges(),o=0;o<s.length;o++){var l=s[o],u=l.source(),c=l.target(),h=a===u?c:u;h.length>0&&e.push(h[0]),e.push(l[0])}return this.spawn(e,!0).filter(r)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});sn.neighbourhood=sn.neighborhood;sn.closedNeighbourhood=sn.closedNeighborhood;sn.openNeighbourhood=sn.openNeighborhood;et(sn,{source:ci(function(e){var n=this[0],i;return n&&(i=n._private.source||n.cy().collection()),i&&e?i.filter(e):i},"source"),target:ci(function(e){var n=this[0],i;return n&&(i=n._private.target||n.cy().collection()),i&&e?i.filter(e):i},"target"),sources:o3({attr:"source"}),targets:o3({attr:"target"})});function o3(r){return function(n){for(var i=[],a=0;a<this.length;a++){var s=this[a],o=s._private[r.attr];o&&i.push(o)}return this.spawn(i,!0).filter(n)}}et(sn,{edgesWith:ci(l3(),"edgesWith"),edgesTo:ci(l3({thisIsSrc:!0}),"edgesTo")});function l3(r){return function(n){var i=[],a=this._private.cy,s=r||{};Je(n)&&(n=a.$(n));for(var o=0;o<n.length;o++)for(var l=n[o]._private.edges,u=0;u<l.length;u++){var c=l[u],h=c._private.data,d=this.hasElementWithId(h.source)&&n.hasElementWithId(h.target),v=n.hasElementWithId(h.source)&&this.hasElementWithId(h.target),m=d||v;m&&((s.thisIsSrc||s.thisIsTgt)&&(s.thisIsSrc&&!d||s.thisIsTgt&&!v)||i.push(c))}return this.spawn(i,!0)}}et(sn,{connectedEdges:ci(function(r){for(var e=[],n=this,i=0;i<n.length;i++){var a=n[i];if(a.isNode())for(var s=a._private.edges,o=0;o<s.length;o++){var l=s[o];e.push(l)}}return this.spawn(e,!0).filter(r)},"connectedEdges"),connectedNodes:ci(function(r){for(var e=[],n=this,i=0;i<n.length;i++){var a=n[i];a.isEdge()&&(e.push(a.source()[0]),e.push(a.target()[0]))}return this.spawn(e,!0).filter(r)},"connectedNodes"),parallelEdges:ci(u3(),"parallelEdges"),codirectedEdges:ci(u3({codirected:!0}),"codirectedEdges")});function u3(r){var e={codirected:!1};return r=et({},e,r),function(i){for(var a=[],s=this.edges(),o=r,l=0;l<s.length;l++)for(var u=s[l],c=u._private,h=c.source,d=h._private.data.id,v=c.data.target,m=h._private.edges,y=0;y<m.length;y++){var b=m[y],x=b._private.data,A=x.target,C=x.source,E=A===v&&C===d,S=d===A&&v===C;(o.codirected&&E||!o.codirected&&(E||S))&&a.push(b)}return this.spawn(a,!0).filter(i)}}et(sn,{components:function(e){var n=this,i=n.cy(),a=i.collection(),s=e==null?n.nodes():e.nodes(),o=[];e!=null&&s.empty()&&(s=e.sources());var l=function(h,d){a.merge(h),s.unmerge(h),d.merge(h)};if(s.empty())return n.spawn();var u=function(){var h=i.collection();o.push(h);var d=s[0];l(d,h),n.bfs({directed:!1,roots:d,visit:function(m){return l(m,h)}}),h.forEach(function(v){v.connectedEdges().forEach(function(m){n.has(m)&&h.has(m.source())&&h.has(m.target())&&h.merge(m)})})};do u();while(s.length>0);return o},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});sn.componentsOf=sn.components;var Jr=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){cr("A collection must have a reference to the core");return}var s=new ya,o=!1;if(!n)n=[];else if(n.length>0&&It(n[0])&&!ef(n[0])){o=!0;for(var l=[],u=new ql,c=0,h=n.length;c<h;c++){var d=n[c];d.data==null&&(d.data={});var v=d.data;if(v.id==null)v.id=tE();else if(e.hasElementWithId(v.id)||u.has(v.id))continue;var m=new v0(e,d,!1);l.push(m),u.add(v.id)}n=l}this.length=0;for(var y=0,b=n.length;y<b;y++){var x=n[y][0];if(x!=null){var A=x._private.data.id;(!i||!s.has(A))&&(i&&s.set(A,{index:this.length,ele:x}),this[this.length]=x,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(C){this.lazyMap=C},rebuildMap:function(){for(var E=this.lazyMap=new ya,S=this.eles,T=0;T<S.length;T++){var R=S[T];E.set(R.id(),{index:T,ele:R})}}},i&&(this._private.map=s),o&&!a&&this.restore()},tr=v0.prototype=Jr.prototype=Object.create(Array.prototype);tr.instanceString=function(){return"collection"};tr.spawn=function(r,e){return new Jr(this.cy(),r,e)};tr.spawnSelf=function(){return this.spawn(this)};tr.cy=function(){return this._private.cy};tr.renderer=function(){return this._private.cy.renderer()};tr.element=function(){return this[0]};tr.collection=function(){return zC(this)?this:new Jr(this._private.cy,[this])};tr.unique=function(){return new Jr(this._private.cy,this,!0)};tr.hasElementWithId=function(r){return r=""+r,this._private.map.has(r)};tr.getElementById=function(r){r=""+r;var e=this._private.cy,n=this._private.map.get(r);return n?n.ele:new Jr(e)};tr.$id=tr.getElementById;tr.poolIndex=function(){var r=this._private.cy,e=r._private.elements,n=this[0]._private.data.id;return e._private.map.get(n).index};tr.indexOf=function(r){var e=r[0]._private.data.id;return this._private.map.get(e).index};tr.indexOfId=function(r){return r=""+r,this._private.map.get(r).index};tr.json=function(r){var e=this.element(),n=this.cy();if(e==null&&r)return this;if(e!=null){var i=e._private;if(It(r)){if(n.startBatch(),r.data){e.data(r.data);var a=i.data;if(e.isEdge()){var s=!1,o={},l=r.data.source,u=r.data.target;l!=null&&l!=a.source&&(o.source=""+l,s=!0),u!=null&&u!=a.target&&(o.target=""+u,s=!0),s&&(e=e.move(o))}else{var c="parent"in r.data,h=r.data.parent;c&&(h!=null||a.parent!=null)&&h!=a.parent&&(h===void 0&&(h=null),h!=null&&(h=""+h),e=e.move({parent:h}))}}r.position&&e.position(r.position);var d=function(b,x,A){var C=r[b];C!=null&&C!==i[b]&&(C?e[x]():e[A]())};return d("removed","remove","restore"),d("selected","select","unselect"),d("selectable","selectify","unselectify"),d("locked","lock","unlock"),d("grabbable","grabify","ungrabify"),d("pannable","panify","unpanify"),r.classes!=null&&e.classes(r.classes),n.endBatch(),this}else if(r===void 0){var v={data:zi(i.data),position:zi(i.position),group:i.group,removed:i.removed,selected:i.selected,selectable:i.selectable,locked:i.locked,grabbable:i.grabbable,pannable:i.pannable,classes:null};v.classes="";var m=0;return i.classes.forEach(function(y){return v.classes+=m++===0?y:" "+y}),v}}};tr.jsons=function(){for(var r=[],e=0;e<this.length;e++){var n=this[e],i=n.json();r.push(i)}return r};tr.clone=function(){for(var r=this.cy(),e=[],n=0;n<this.length;n++){var i=this[n],a=i.json(),s=new v0(r,a,!1);e.push(s)}return new Jr(r,e)};tr.copy=tr.clone;tr.restore=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,i=n.cy(),a=i._private,s=[],o=[],l,u=0,c=n.length;u<c;u++){var h=n[u];e&&!h.removed()||(h.isNode()?s.push(h):o.push(h))}l=s.concat(o);var d,v=function(){l.splice(d,1),d--};for(d=0;d<l.length;d++){var m=l[d],y=m._private,b=y.data;if(m.clearTraversalCache(),!(!e&&!y.removed)){if(b.id===void 0)b.id=tE();else if(Be(b.id))b.id=""+b.id;else if(ps(b.id)||!Je(b.id)){cr("Can not create element with invalid string ID `"+b.id+"`"),v();continue}else if(i.hasElementWithId(b.id)){cr("Can not create second element with ID `"+b.id+"`"),v();continue}}var x=b.id;if(m.isNode()){var A=y.position;A.x==null&&(A.x=0),A.y==null&&(A.y=0)}if(m.isEdge()){for(var C=m,E=["source","target"],S=E.length,T=!1,R=0;R<S;R++){var D=E[R],B=b[D];Be(B)&&(B=b[D]=""+b[D]),B==null||B===""?(cr("Can not create edge `"+x+"` with unspecified "+D),T=!0):i.hasElementWithId(B)||(cr("Can not create edge `"+x+"` with nonexistant "+D+" `"+B+"`"),T=!0)}if(T){v();continue}var N=i.getElementById(b.source),I=i.getElementById(b.target);N.same(I)?N._private.edges.push(C):(N._private.edges.push(C),I._private.edges.push(C)),C._private.source=N,C._private.target=I}y.map=new ya,y.map.set(x,{ele:m,index:0}),y.removed=!1,e&&i.addToPool(m)}for(var P=0;P<s.length;P++){var F=s[P],O=F._private.data;Be(O.parent)&&(O.parent=""+O.parent);var U=O.parent,L=U!=null;if(L||F._private.parent){var V=F._private.parent?i.collection().merge(F._private.parent):i.getElementById(U);if(V.empty())O.parent=void 0;else if(V[0].removed())Lt("Node added with missing parent, reference to parent removed"),O.parent=void 0,F._private.parent=null;else{for(var _=!1,G=V;!G.empty();){if(F.same(G)){_=!0,O.parent=void 0;break}G=G.parent()}_||(V[0]._private.children.push(F),F._private.parent=V[0],a.hasCompoundNodes=!0)}}}if(l.length>0){for(var K=l.length===n.length?n:new Jr(i,l),z=0;z<K.length;z++){var Y=K[z];Y.isNode()||(Y.parallelEdges().clearTraversalCache(),Y.source().clearTraversalCache(),Y.target().clearTraversalCache())}var Z;a.hasCompoundNodes?Z=i.collection().merge(K).merge(K.connectedNodes()).merge(K.parent()):Z=K,Z.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(r),r?K.emitAndNotify("add"):e&&K.emit("add")}return n};tr.removed=function(){var r=this[0];return r&&r._private.removed};tr.inside=function(){var r=this[0];return r&&!r._private.removed};tr.remove=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,i=[],a={},s=n._private.cy;function o(U){for(var L=U._private.edges,V=0;V<L.length;V++)u(L[V])}function l(U){for(var L=U._private.children,V=0;V<L.length;V++)u(L[V])}function u(U){var L=a[U.id()];e&&U.removed()||L||(a[U.id()]=!0,U.isNode()?(i.push(U),o(U),l(U)):i.unshift(U))}for(var c=0,h=n.length;c<h;c++){var d=n[c];u(d)}function v(U,L){var V=U._private.edges;ys(V,L),U.clearTraversalCache()}function m(U){U.clearTraversalCache()}var y=[];y.ids={};function b(U,L){L=L[0],U=U[0];var V=U._private.children,_=U.id();ys(V,L),L._private.parent=null,y.ids[_]||(y.ids[_]=!0,y.push(U))}n.dirtyCompoundBoundsCache(),e&&s.removeFromPool(i);for(var x=0;x<i.length;x++){var A=i[x];if(A.isEdge()){var C=A.source()[0],E=A.target()[0];v(C,A),v(E,A);for(var S=A.parallelEdges(),T=0;T<S.length;T++){var R=S[T];m(R),R.isBundledBezier()&&R.dirtyBoundingBoxCache()}}else{var D=A.parent();D.length!==0&&b(D,A)}e&&(A._private.removed=!0)}var B=s._private.elements;s._private.hasCompoundNodes=!1;for(var N=0;N<B.length;N++){var I=B[N];if(I.isParent()){s._private.hasCompoundNodes=!0;break}}var P=new Jr(this.cy(),i);P.size()>0&&(r?P.emitAndNotify("remove"):e&&P.emit("remove"));for(var F=0;F<y.length;F++){var O=y[F];(!e||!O.removed())&&O.updateStyle()}return P};tr.move=function(r){var e=this._private.cy,n=this,i=!1,a=!1,s=function(y){return y==null?y:""+y};if(r.source!==void 0||r.target!==void 0){var o=s(r.source),l=s(r.target),u=o!=null&&e.hasElementWithId(o),c=l!=null&&e.hasElementWithId(l);(u||c)&&(e.batch(function(){n.remove(i,a),n.emitAndNotify("moveout");for(var m=0;m<n.length;m++){var y=n[m],b=y._private.data;y.isEdge()&&(u&&(b.source=o),c&&(b.target=l))}n.restore(i,a)}),n.emitAndNotify("move"))}else if(r.parent!==void 0){var h=s(r.parent),d=h===null||e.hasElementWithId(h);if(d){var v=h===null?void 0:h;e.batch(function(){var m=n.remove(i,a);m.emitAndNotify("moveout");for(var y=0;y<n.length;y++){var b=n[y],x=b._private.data;b.isNode()&&(x.parent=v)}m.restore(i,a)}),n.emitAndNotify("move")}}return this};[dE,x7,pd,gs,Ol,U7,w0,J7,OE,LE,nI,Hd,yd,Zr,vs,sn].forEach(function(r){et(tr,r)});var cI={add:function(e){var n,i=this;if(jn(e)){var a=e;if(a._private.cy===i)n=a.restore();else{for(var s=[],o=0;o<a.length;o++){var l=a[o];s.push(l.json())}n=new Jr(i,s)}}else if(Qt(e)){var u=e;n=new Jr(i,u)}else if(It(e)&&(Qt(e.nodes)||Qt(e.edges))){for(var c=e,h=[],d=["nodes","edges"],v=0,m=d.length;v<m;v++){var y=d[v],b=c[y];if(Qt(b))for(var x=0,A=b.length;x<A;x++){var C=et({group:y},b[x]);h.push(C)}}n=new Jr(i,h)}else{var E=e;n=new v0(i,E).collection()}return n},remove:function(e){if(!jn(e)){if(Je(e)){var n=e;e=this.$(n)}}return e.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function fI(r,e,n,i){var a=4,s=.001,o=1e-7,l=10,u=11,c=1/(u-1),h=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var d=0;d<4;++d)if(typeof arguments[d]!="number"||isNaN(arguments[d])||!isFinite(arguments[d]))return!1;r=Math.min(r,1),n=Math.min(n,1),r=Math.max(r,0),n=Math.max(n,0);var v=h?new Float32Array(u):new Array(u);function m(I,P){return 1-3*P+3*I}function y(I,P){return 3*P-6*I}function b(I){return 3*I}function x(I,P,F){return((m(P,F)*I+y(P,F))*I+b(P))*I}function A(I,P,F){return 3*m(P,F)*I*I+2*y(P,F)*I+b(P)}function C(I,P){for(var F=0;F<a;++F){var O=A(P,r,n);if(O===0)return P;var U=x(P,r,n)-I;P-=U/O}return P}function E(){for(var I=0;I<u;++I)v[I]=x(I*c,r,n)}function S(I,P,F){var O,U,L=0;do U=P+(F-P)/2,O=x(U,r,n)-I,O>0?F=U:P=U;while(Math.abs(O)>o&&++L<l);return U}function T(I){for(var P=0,F=1,O=u-1;F!==O&&v[F]<=I;++F)P+=c;--F;var U=(I-v[F])/(v[F+1]-v[F]),L=P+U*c,V=A(L,r,n);return V>=s?C(I,L):V===0?L:S(I,P,P+c)}var R=!1;function D(){R=!0,(r!==e||n!==i)&&E()}var B=function(P){return R||D(),r===e&&n===i?P:P===0?0:P===1?1:x(T(P),e,i)};B.getControlPoints=function(){return[{x:r,y:e},{x:n,y:i}]};var N="generateBezier("+[r,e,n,i]+")";return B.toString=function(){return N},B}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var hI=(function(){function r(i){return-i.tension*i.x-i.friction*i.v}function e(i,a,s){var o={x:i.x+s.dx*a,v:i.v+s.dv*a,tension:i.tension,friction:i.friction};return{dx:o.v,dv:r(o)}}function n(i,a){var s={dx:i.v,dv:r(i)},o=e(i,a*.5,s),l=e(i,a*.5,o),u=e(i,a,l),c=1/6*(s.dx+2*(o.dx+l.dx)+u.dx),h=1/6*(s.dv+2*(o.dv+l.dv)+u.dv);return i.x=i.x+c*a,i.v=i.v+h*a,i}return function i(a,s,o){var l={x:-1,v:0,tension:null,friction:null},u=[0],c=0,h=1/1e4,d=16/1e3,v,m,y;for(a=parseFloat(a)||500,s=parseFloat(s)||20,o=o||null,l.tension=a,l.friction=s,v=o!==null,v?(c=i(a,s),m=c/o*d):m=d;y=n(y||l,m),u.push(1+y.x),c+=16,Math.abs(y.x)>h&&Math.abs(y.v)>h;);return v?function(b){return u[b*(u.length-1)|0]}:c}})(),Jt=function(e,n,i,a){var s=fI(e,n,i,a);return function(o,l,u){return o+(l-o)*s(u)}},Ad={linear:function(e,n,i){return e+(n-e)*i},ease:Jt(.25,.1,.25,1),"ease-in":Jt(.42,0,1,1),"ease-out":Jt(0,0,.58,1),"ease-in-out":Jt(.42,0,.58,1),"ease-in-sine":Jt(.47,0,.745,.715),"ease-out-sine":Jt(.39,.575,.565,1),"ease-in-out-sine":Jt(.445,.05,.55,.95),"ease-in-quad":Jt(.55,.085,.68,.53),"ease-out-quad":Jt(.25,.46,.45,.94),"ease-in-out-quad":Jt(.455,.03,.515,.955),"ease-in-cubic":Jt(.55,.055,.675,.19),"ease-out-cubic":Jt(.215,.61,.355,1),"ease-in-out-cubic":Jt(.645,.045,.355,1),"ease-in-quart":Jt(.895,.03,.685,.22),"ease-out-quart":Jt(.165,.84,.44,1),"ease-in-out-quart":Jt(.77,0,.175,1),"ease-in-quint":Jt(.755,.05,.855,.06),"ease-out-quint":Jt(.23,1,.32,1),"ease-in-out-quint":Jt(.86,0,.07,1),"ease-in-expo":Jt(.95,.05,.795,.035),"ease-out-expo":Jt(.19,1,.22,1),"ease-in-out-expo":Jt(1,0,0,1),"ease-in-circ":Jt(.6,.04,.98,.335),"ease-out-circ":Jt(.075,.82,.165,1),"ease-in-out-circ":Jt(.785,.135,.15,.86),spring:function(e,n,i){if(i===0)return Ad.linear;var a=hI(e,n,i);return function(s,o,l){return s+(o-s)*a(l)}},"cubic-bezier":Jt};function c3(r,e,n,i,a){if(i===1||e===n)return n;var s=a(e,n,i);return r==null||((r.roundValue||r.color)&&(s=Math.round(s)),r.min!==void 0&&(s=Math.max(s,r.min)),r.max!==void 0&&(s=Math.min(s,r.max))),s}function f3(r,e){return r.pfValue!=null||r.value!=null?r.pfValue!=null&&(e==null||e.type.units!=="%")?r.pfValue:r.value:r}function cl(r,e,n,i,a){var s=a!=null?a.type:null;n<0?n=0:n>1&&(n=1);var o=f3(r,a),l=f3(e,a);if(Be(o)&&Be(l))return c3(s,o,l,n,i);if(Qt(o)&&Qt(l)){for(var u=[],c=0;c<l.length;c++){var h=o[c],d=l[c];if(h!=null&&d!=null){var v=c3(s,h,d,n,i);u.push(v)}else u.push(d)}return u}}function dI(r,e,n,i){var a=!i,s=r._private,o=e._private,l=o.easing,u=o.startTime,c=i?r:r.cy(),h=c.style();if(!o.easingImpl)if(l==null)o.easingImpl=Ad.linear;else{var d;if(Je(l)){var v=h.parse("transition-timing-function",l);d=v.value}else d=l;var m,y;Je(d)?(m=d,y=[]):(m=d[1],y=d.slice(2).map(function(K){return+K})),y.length>0?(m==="spring"&&y.push(o.duration),o.easingImpl=Ad[m].apply(null,y)):o.easingImpl=Ad[m]}var b=o.easingImpl,x;if(o.duration===0?x=1:x=(n-u)/o.duration,o.applying&&(x=o.progress),x<0?x=0:x>1&&(x=1),o.delay==null){var A=o.startPosition,C=o.position;if(C&&a&&!r.locked()){var E={};ju(A.x,C.x)&&(E.x=cl(A.x,C.x,x,b)),ju(A.y,C.y)&&(E.y=cl(A.y,C.y,x,b)),r.position(E)}var S=o.startPan,T=o.pan,R=s.pan,D=T!=null&&i;D&&(ju(S.x,T.x)&&(R.x=cl(S.x,T.x,x,b)),ju(S.y,T.y)&&(R.y=cl(S.y,T.y,x,b)),r.emit("pan"));var B=o.startZoom,N=o.zoom,I=N!=null&&i;I&&(ju(B,N)&&(s.zoom=Vc(s.minZoom,cl(B,N,x,b),s.maxZoom)),r.emit("zoom")),(D||I)&&r.emit("viewport");var P=o.style;if(P&&P.length>0&&a){for(var F=0;F<P.length;F++){var O=P[F],U=O.name,L=O,V=o.startStyle[U],_=h.properties[V.name],G=cl(V,L,x,b,_);h.overrideBypass(r,U,G)}r.emit("style")}}return o.progress=x,x}function ju(r,e){return r==null||e==null?!1:Be(r)&&Be(e)?!0:!!(r&&e)}function gI(r,e,n,i){var a=e._private;a.started=!0,a.startTime=n-a.progress*a.duration}function h3(r,e){var n=e._private.aniEles,i=[];function a(h,d){var v=h._private,m=v.animation.current,y=v.animation.queue,b=!1;if(m.length===0){var x=y.shift();x&&m.push(x)}for(var A=function(R){for(var D=R.length-1;D>=0;D--){var B=R[D];B()}R.splice(0,R.length)},C=m.length-1;C>=0;C--){var E=m[C],S=E._private;if(S.stopped){m.splice(C,1),S.hooked=!1,S.playing=!1,S.started=!1,A(S.frames);continue}!S.playing&&!S.applying||(S.playing&&S.applying&&(S.applying=!1),S.started||gI(h,E,r),dI(h,E,r,d),S.applying&&(S.applying=!1),A(S.frames),S.step!=null&&S.step(r),E.completed()&&(m.splice(C,1),S.hooked=!1,S.playing=!1,S.started=!1,A(S.completes)),b=!0)}return!d&&m.length===0&&y.length===0&&i.push(h),b}for(var s=!1,o=0;o<n.length;o++){var l=n[o],u=a(l);s=s||u}var c=a(e,!0);(s||c)&&(n.length>0?e.notify("draw",n):e.notify("draw")),n.unmerge(i),e.emit("step")}var vI={animate:Ot.animate(),animation:Ot.animation(),animated:Ot.animated(),clearQueue:Ot.clearQueue(),delay:Ot.delay(),delayAnimation:Ot.delayAnimation(),stop:Ot.stop(),addToAnimationPool:function(e){var n=this;n.styleEnabled()&&n._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function n(){e._private.animationsRunning&&_d(function(s){h3(s,e),n()})}var i=e.renderer();i&&i.beforeRender?i.beforeRender(function(s,o){h3(o,e)},i.beforeRenderPriorities.animations):n()}},mI={qualifierCompare:function(e,n){return e==null||n==null?e==null&&n==null:e.sameText(n)},eventMatches:function(e,n,i){var a=n.qualifier;return a!=null?e!==i.target&&ef(i.target)&&a.matches(i.target):!0},addEventFields:function(e,n){n.cy=e,n.target=e},callbackContext:function(e,n,i){return n.qualifier!=null?i.target:e}},_h=function(e){return Je(e)?new xs(e):e},qE={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new C0(mI,this)),this},emitter:function(){return this._private.emitter},on:function(e,n,i){return this.emitter().on(e,_h(n),i),this},removeListener:function(e,n,i){return this.emitter().removeListener(e,_h(n),i),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,n,i){return this.emitter().one(e,_h(n),i),this},once:function(e,n,i){return this.emitter().one(e,_h(n),i),this},emit:function(e,n){return this.emitter().emit(e,n),this},emitAndNotify:function(e,n){return this.emit(e),this.notify(e,n),this}};Ot.eventAliasesOn(qE);var xp={png:function(e){var n=this._private.renderer;return e=e||{},n.png(e)},jpg:function(e){var n=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",n.jpg(e)}};xp.jpeg=xp.jpg;var xd={layout:function(e){var n=this;if(e==null){cr("Layout options must be specified to make a layout");return}if(e.name==null){cr("A `name` must be specified to make a layout");return}var i=e.name,a=n.extension("layout",i);if(a==null){cr("No such layout `"+i+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var s;Je(e.eles)?s=n.$(e.eles):s=e.eles!=null?e.eles:n.$();var o=new a(et({},e,{cy:n,eles:s}));return o}};xd.createLayout=xd.makeLayout=xd.layout;var pI={notify:function(e,n){var i=this._private;if(this.batching()){i.batchNotifications=i.batchNotifications||{};var a=i.batchNotifications[e]=i.batchNotifications[e]||this.collection();n!=null&&a.merge(n);return}if(i.notificationsEnabled){var s=this.renderer();this.destroyed()||!s||s.notify(e,n)}},notifications:function(e){var n=this._private;return e===void 0?n.notificationsEnabled:(n.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var n=this.renderer();Object.keys(e.batchNotifications).forEach(function(i){var a=e.batchNotifications[i];a.empty()?n.notify(i):n.notify(i,a)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var n=this;return this.batch(function(){for(var i=Object.keys(e),a=0;a<i.length;a++){var s=i[a],o=e[s],l=n.getElementById(s);l.data(o)}})}},yI=$r({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),bp={renderTo:function(e,n,i,a){var s=this._private.renderer;return s.renderTo(e,n,i,a),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var n=this,i=n.extension("renderer",e.name);if(i==null){cr("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&Lt("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var a=yI(e);a.cy=n,n._private.renderer=new i(a),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var n=e.container();if(n)for(n._cyreg=null;n.childNodes.length>0;)n.removeChild(n.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(i){var a=i._private;a.rscratch={},a.rstyle={},a.animation.current=[],a.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};bp.invalidateDimensions=bp.resize;var bd={collection:function(e,n){return Je(e)?this.$(e):jn(e)?e.collection():Qt(e)?(n||(n={}),new Jr(this,e,n.unique,n.removed)):new Jr(this)},nodes:function(e){var n=this.$(function(i){return i.isNode()});return e?n.filter(e):n},edges:function(e){var n=this.$(function(i){return i.isEdge()});return e?n.filter(e):n},$:function(e){var n=this._private.elements;return e?n.filter(e):n.spawnSelf()},mutableElements:function(){return this._private.elements}};bd.elements=bd.filter=bd.$;var jr={},Ec="t",AI="f";jr.apply=function(r){for(var e=this,n=e._private,i=n.cy,a=i.collection(),s=0;s<r.length;s++){var o=r[s],l=e.getContextMeta(o);if(!l.empty){var u=e.getContextStyle(l),c=e.applyContextStyle(l,u,o);o._private.appliedInitStyle?e.updateTransitions(o,c.diffProps):o._private.appliedInitStyle=!0;var h=e.updateStyleHints(o);h&&a.push(o)}}return a};jr.getPropertiesDiff=function(r,e){var n=this,i=n._private.propDiffs=n._private.propDiffs||{},a=r+"-"+e,s=i[a];if(s)return s;for(var o=[],l={},u=0;u<n.length;u++){var c=n[u],h=r[u]===Ec,d=e[u]===Ec,v=h!==d,m=c.mappedProperties.length>0;if(v||d&&m){var y=void 0;v&&m||v?y=c.properties:m&&(y=c.mappedProperties);for(var b=0;b<y.length;b++){for(var x=y[b],A=x.name,C=!1,E=u+1;E<n.length;E++){var S=n[E],T=e[E]===Ec;if(T&&(C=S.properties[x.name]!=null,C))break}!l[A]&&!C&&(l[A]=!0,o.push(A))}}}return i[a]=o,o};jr.getContextMeta=function(r){for(var e=this,n="",i,a=r._private.styleCxtKey||"",s=0;s<e.length;s++){var o=e[s],l=o.selector&&o.selector.matches(r);l?n+=Ec:n+=AI}return i=e.getPropertiesDiff(a,n),r._private.styleCxtKey=n,{key:n,diffPropNames:i,empty:i.length===0}};jr.getContextStyle=function(r){var e=r.key,n=this,i=this._private.contextStyles=this._private.contextStyles||{};if(i[e])return i[e];for(var a={_private:{key:e}},s=0;s<n.length;s++){var o=n[s],l=e[s]===Ec;if(l)for(var u=0;u<o.properties.length;u++){var c=o.properties[u];a[c.name]=c}}return i[e]=a,a};jr.applyContextStyle=function(r,e,n){for(var i=this,a=r.diffPropNames,s={},o=i.types,l=0;l<a.length;l++){var u=a[l],c=e[u],h=n.pstyle(u);if(!c)if(h)h.bypass?c={name:u,deleteBypassed:!0}:c={name:u,delete:!0};else continue;if(h!==c){if(c.mapped===o.fn&&h!=null&&h.mapping!=null&&h.mapping.value===c.value){var d=h.mapping,v=d.fnValue=c.value(n);if(v===d.prevFnValue)continue}var m=s[u]={prev:h};i.applyParsedProperty(n,c),m.next=n.pstyle(u),m.next&&m.next.bypass&&(m.next=m.next.bypassed)}}return{diffProps:s}};jr.updateStyleHints=function(r){var e=r._private,n=this,i=n.propertyGroupNames,a=n.propertyGroupKeys,s=function(le,Ae,Re){return n.getPropertiesHash(le,Ae,Re)},o=e.styleKey;if(r.removed())return!1;var l=e.group==="nodes",u=r._private.style;i=Object.keys(u);for(var c=0;c<a.length;c++){var h=a[c];e.styleKeys[h]=[$s,wl]}for(var d=function(le,Ae){return e.styleKeys[Ae][0]=kc(le,e.styleKeys[Ae][0])},v=function(le,Ae){return e.styleKeys[Ae][1]=Pc(le,e.styleKeys[Ae][1])},m=function(le,Ae){d(le,Ae),v(le,Ae)},y=function(le,Ae){for(var Re=0;Re<le.length;Re++){var Le=le.charCodeAt(Re);d(Le,Ae),v(Le,Ae)}},b=2e9,x=function(le){return-128<le&&le<128&&Math.floor(le)!==le?b-(le*1024|0):le},A=0;A<i.length;A++){var C=i[A],E=u[C];if(E!=null){var S=this.properties[C],T=S.type,R=S.groupKey,D=void 0;S.hashOverride!=null?D=S.hashOverride(r,E):E.pfValue!=null&&(D=E.pfValue);var B=S.enums==null?E.value:null,N=D!=null,I=B!=null,P=N||I,F=E.units;if(T.number&&P&&!T.multiple){var O=N?D:B;m(x(O),R),!N&&F!=null&&y(F,R)}else y(E.strValue,R)}}for(var U=[$s,wl],L=0;L<a.length;L++){var V=a[L],_=e.styleKeys[V];U[0]=kc(_[0],U[0]),U[1]=Pc(_[1],U[1])}e.styleKey=P8(U[0],U[1]);var G=e.styleKeys;e.labelDimsKey=Ja(G.labelDimensions);var K=s(r,["label"],G.labelDimensions);if(e.labelKey=Ja(K),e.labelStyleKey=Ja(Nh(G.commonLabel,K)),!l){var z=s(r,["source-label"],G.labelDimensions);e.sourceLabelKey=Ja(z),e.sourceLabelStyleKey=Ja(Nh(G.commonLabel,z));var Y=s(r,["target-label"],G.labelDimensions);e.targetLabelKey=Ja(Y),e.targetLabelStyleKey=Ja(Nh(G.commonLabel,Y))}if(l){var Z=e.styleKeys,J=Z.nodeBody,ee=Z.nodeBorder,ne=Z.nodeOutline,oe=Z.backgroundImage,me=Z.compound,ye=Z.pie,ve=Z.stripe,re=[J,ee,ne,oe,me,ye,ve].filter(function(ae){return ae!=null}).reduce(Nh,[$s,wl]);e.nodeKey=Ja(re),e.hasPie=ye!=null&&ye[0]!==$s&&ye[1]!==wl,e.hasStripe=ve!=null&&ve[0]!==$s&&ve[1]!==wl}return o!==e.styleKey};jr.clearStyleHints=function(r){var e=r._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null,e.hasStripe=null};jr.applyParsedProperty=function(r,e){var n=this,i=e,a=r._private.style,s,o=n.types,l=n.properties[i.name].type,u=i.bypass,c=a[i.name],h=c&&c.bypass,d=r._private,v="mapping",m=function(J){return J==null?null:J.pfValue!=null?J.pfValue:J.value},y=function(){var J=m(c),ee=m(i);n.checkTriggers(r,i.name,J,ee)};if(e.name==="curve-style"&&r.isEdge()&&(e.value!=="bezier"&&r.isLoop()||e.value==="haystack"&&(r.source().isParent()||r.target().isParent()))&&(i=e=this.parse(e.name,"bezier",u)),i.delete)return a[i.name]=void 0,y(),!0;if(i.deleteBypassed)return c?c.bypass?(c.bypassed=void 0,y(),!0):!1:(y(),!0);if(i.deleteBypass)return c?c.bypass?(a[i.name]=c.bypassed,y(),!0):!1:(y(),!0);var b=function(){Lt("Do not assign mappings to elements without corresponding data (i.e. ele `"+r.id()+"` has no mapping for property `"+i.name+"` with data field `"+i.field+"`); try a `["+i.field+"]` selector to limit scope to elements with `"+i.field+"` defined")};switch(i.mapped){case o.mapData:{for(var x=i.field.split("."),A=d.data,C=0;C<x.length&&A;C++){var E=x[C];A=A[E]}if(A==null)return b(),!1;var S;if(Be(A)){var T=i.fieldMax-i.fieldMin;T===0?S=0:S=(A-i.fieldMin)/T}else return Lt("Do not use continuous mappers without specifying numeric data (i.e. `"+i.field+": "+A+"` for `"+r.id()+"` is non-numeric)"),!1;if(S<0?S=0:S>1&&(S=1),l.color){var R=i.valueMin[0],D=i.valueMax[0],B=i.valueMin[1],N=i.valueMax[1],I=i.valueMin[2],P=i.valueMax[2],F=i.valueMin[3]==null?1:i.valueMin[3],O=i.valueMax[3]==null?1:i.valueMax[3],U=[Math.round(R+(D-R)*S),Math.round(B+(N-B)*S),Math.round(I+(P-I)*S),Math.round(F+(O-F)*S)];s={bypass:i.bypass,name:i.name,value:U,strValue:"rgb("+U[0]+", "+U[1]+", "+U[2]+")"}}else if(l.number){var L=i.valueMin+(i.valueMax-i.valueMin)*S;s=this.parse(i.name,L,i.bypass,v)}else return!1;if(!s)return b(),!1;s.mapping=i,i=s;break}case o.data:{for(var V=i.field.split("."),_=d.data,G=0;G<V.length&&_;G++){var K=V[G];_=_[K]}if(_!=null&&(s=this.parse(i.name,_,i.bypass,v)),!s)return b(),!1;s.mapping=i,i=s;break}case o.fn:{var z=i.value,Y=i.fnValue!=null?i.fnValue:z(r);if(i.prevFnValue=Y,Y==null)return Lt("Custom function mappers may not return null (i.e. `"+i.name+"` for ele `"+r.id()+"` is null)"),!1;if(s=this.parse(i.name,Y,i.bypass,v),!s)return Lt("Custom function mappers may not return invalid values for the property type (i.e. `"+i.name+"` for ele `"+r.id()+"` is invalid)"),!1;s.mapping=zi(i),i=s;break}case void 0:break;default:return!1}return u?(h?i.bypassed=c.bypassed:i.bypassed=c,a[i.name]=i):h?c.bypassed=i:a[i.name]=i,y(),!0};jr.cleanElements=function(r,e){for(var n=0;n<r.length;n++){var i=r[n];if(this.clearStyleHints(i),i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),!e)i._private.style={};else for(var a=i._private.style,s=Object.keys(a),o=0;o<s.length;o++){var l=s[o],u=a[l];u!=null&&(u.bypass?u.bypassed=null:a[l]=null)}}};jr.update=function(){var r=this._private.cy,e=r.mutableElements();e.updateStyle()};jr.updateTransitions=function(r,e){var n=this,i=r._private,a=r.pstyle("transition-property").value,s=r.pstyle("transition-duration").pfValue,o=r.pstyle("transition-delay").pfValue;if(a.length>0&&s>0){for(var l={},u=!1,c=0;c<a.length;c++){var h=a[c],d=r.pstyle(h),v=e[h];if(v){var m=v.prev,y=m,b=v.next!=null?v.next:d,x=!1,A=void 0,C=1e-6;y&&(Be(y.pfValue)&&Be(b.pfValue)?(x=b.pfValue-y.pfValue,A=y.pfValue+C*x):Be(y.value)&&Be(b.value)?(x=b.value-y.value,A=y.value+C*x):Qt(y.value)&&Qt(b.value)&&(x=y.value[0]!==b.value[0]||y.value[1]!==b.value[1]||y.value[2]!==b.value[2],A=y.strValue),x&&(l[h]=b.strValue,this.applyBypass(r,h,A),u=!0))}}if(!u)return;i.transitioning=!0,new Gl(function(E){o>0?r.delayAnimation(o).play().promise().then(E):E()}).then(function(){return r.animation({style:l,duration:s,easing:r.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){n.removeBypasses(r,a),r.emitAndNotify("style"),i.transitioning=!1})}else i.transitioning&&(this.removeBypasses(r,a),r.emitAndNotify("style"),i.transitioning=!1)};jr.checkTrigger=function(r,e,n,i,a,s){var o=this.properties[e],l=a(o);r.removed()||l!=null&&l(n,i,r)&&s(o)};jr.checkZOrderTrigger=function(r,e,n,i){var a=this;this.checkTrigger(r,e,n,i,function(s){return s.triggersZOrder},function(){a._private.cy.notify("zorder",r)})};jr.checkBoundsTrigger=function(r,e,n,i){this.checkTrigger(r,e,n,i,function(a){return a.triggersBounds},function(a){r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache()})};jr.checkConnectedEdgesBoundsTrigger=function(r,e,n,i){this.checkTrigger(r,e,n,i,function(a){return a.triggersBoundsOfConnectedEdges},function(a){r.connectedEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};jr.checkParallelEdgesBoundsTrigger=function(r,e,n,i){this.checkTrigger(r,e,n,i,function(a){return a.triggersBoundsOfParallelEdges},function(a){r.parallelEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};jr.checkTriggers=function(r,e,n,i){r.dirtyStyleCache(),this.checkZOrderTrigger(r,e,n,i),this.checkBoundsTrigger(r,e,n,i),this.checkConnectedEdgesBoundsTrigger(r,e,n,i),this.checkParallelEdgesBoundsTrigger(r,e,n,i)};var lf={};lf.applyBypass=function(r,e,n,i){var a=this,s=[],o=!0;if(e==="*"||e==="**"){if(n!==void 0)for(var l=0;l<a.properties.length;l++){var u=a.properties[l],c=u.name,h=this.parse(c,n,!0);h&&s.push(h)}}else if(Je(e)){var d=this.parse(e,n,!0);d&&s.push(d)}else if(It(e)){var v=e;i=n;for(var m=Object.keys(v),y=0;y<m.length;y++){var b=m[y],x=v[b];if(x===void 0&&(x=v[d0(b)]),x!==void 0){var A=this.parse(b,x,!0);A&&s.push(A)}}}else return!1;if(s.length===0)return!1;for(var C=!1,E=0;E<r.length;E++){for(var S=r[E],T={},R=void 0,D=0;D<s.length;D++){var B=s[D];if(i){var N=S.pstyle(B.name);R=T[B.name]={prev:N}}C=this.applyParsedProperty(S,zi(B))||C,i&&(R.next=S.pstyle(B.name))}C&&this.updateStyleHints(S),i&&this.updateTransitions(S,T,o)}return C};lf.overrideBypass=function(r,e,n){e=c2(e);for(var i=0;i<r.length;i++){var a=r[i],s=a._private.style[e],o=this.properties[e].type,l=o.color,u=o.mutiple,c=s?s.pfValue!=null?s.pfValue:s.value:null;!s||!s.bypass?this.applyBypass(a,e,n):(s.value=n,s.pfValue!=null&&(s.pfValue=n),l?s.strValue="rgb("+n.join(",")+")":u?s.strValue=n.join(" "):s.strValue=""+n,this.updateStyleHints(a)),this.checkTriggers(a,e,c,n)}};lf.removeAllBypasses=function(r,e){return this.removeBypasses(r,this.propertyNames,e)};lf.removeBypasses=function(r,e,n){for(var i=!0,a=0;a<r.length;a++){for(var s=r[a],o={},l=0;l<e.length;l++){var u=e[l],c=this.properties[u],h=s.pstyle(c.name);if(!(!h||!h.bypass)){var d="",v=this.parse(u,d,!0),m=o[c.name]={prev:h};this.applyParsedProperty(s,v),m.next=s.pstyle(c.name)}}this.updateStyleHints(s),n&&this.updateTransitions(s,o,i)}};var S2={};S2.getEmSizeInPixels=function(){var r=this.containerCss("font-size");return r!=null?parseFloat(r):1};S2.containerCss=function(r){var e=this._private.cy,n=e.container(),i=e.window();if(i&&n&&i.getComputedStyle)return i.getComputedStyle(n).getPropertyValue(r)};var Hi={};Hi.getRenderedStyle=function(r,e){return e?this.getStylePropertyValue(r,e,!0):this.getRawStyle(r,!0)};Hi.getRawStyle=function(r,e){var n=this;if(r=r[0],r){for(var i={},a=0;a<n.properties.length;a++){var s=n.properties[a],o=n.getStylePropertyValue(r,s.name,e);o!=null&&(i[s.name]=o,i[d0(s.name)]=o)}return i}};Hi.getIndexedStyle=function(r,e,n,i){var a=r.pstyle(e)[n][i];return a??r.cy().style().getDefaultProperty(e)[n][0]};Hi.getStylePropertyValue=function(r,e,n){var i=this;if(r=r[0],r){var a=i.properties[e];a.alias&&(a=a.pointsTo);var s=a.type,o=r.pstyle(a.name);if(o){var l=o.value,u=o.units,c=o.strValue;if(n&&s.number&&l!=null&&Be(l)){var h=r.cy().zoom(),d=function(x){return x*h},v=function(x,A){return d(x)+A},m=Qt(l),y=m?u.every(function(b){return b!=null}):u!=null;return y?m?l.map(function(b,x){return v(b,u[x])}).join(" "):v(l,u):m?l.map(function(b){return Je(b)?b:""+d(b)}).join(" "):""+d(l)}else if(c!=null)return c}return null}};Hi.getAnimationStartStyle=function(r,e){for(var n={},i=0;i<e.length;i++){var a=e[i],s=a.name,o=r.pstyle(s);o!==void 0&&(It(o)?o=this.parse(s,o.strValue):o=this.parse(s,o)),o&&(n[s]=o)}return n};Hi.getPropsList=function(r){var e=this,n=[],i=r,a=e.properties;if(i)for(var s=Object.keys(i),o=0;o<s.length;o++){var l=s[o],u=i[l],c=a[l]||a[c2(l)],h=this.parse(c.name,u);h&&n.push(h)}return n};Hi.getNonDefaultPropertiesHash=function(r,e,n){var i=n.slice(),a,s,o,l,u,c;for(u=0;u<e.length;u++)if(a=e[u],s=r.pstyle(a,!1),s!=null)if(s.pfValue!=null)i[0]=kc(l,i[0]),i[1]=Pc(l,i[1]);else for(o=s.strValue,c=0;c<o.length;c++)l=o.charCodeAt(c),i[0]=kc(l,i[0]),i[1]=Pc(l,i[1]);return i};Hi.getPropertiesHash=Hi.getNonDefaultPropertiesHash;var T0={};T0.appendFromJson=function(r){for(var e=this,n=0;n<r.length;n++){var i=r[n],a=i.selector,s=i.style||i.css,o=Object.keys(s);e.selector(a);for(var l=0;l<o.length;l++){var u=o[l],c=s[u];e.css(u,c)}}return e};T0.fromJson=function(r){var e=this;return e.resetToDefault(),e.appendFromJson(r),e};T0.json=function(){for(var r=[],e=this.defaultLength;e<this.length;e++){for(var n=this[e],i=n.selector,a=n.properties,s={},o=0;o<a.length;o++){var l=a[o];s[l.name]=l.strValue}r.push({selector:i?i.toString():"core",style:s})}return r};var T2={};T2.appendFromString=function(r){var e=this,n=this,i=""+r,a,s,o;i=i.replace(/[/][*](\s|.)+?[*][/]/g,"");function l(){i.length>a.length?i=i.substr(a.length):i=""}function u(){s.length>o.length?s=s.substr(o.length):s=""}for(;;){var c=i.match(/^\s*$/);if(c)break;var h=i.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!h){Lt("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+i);break}a=h[0];var d=h[1];if(d!=="core"){var v=new xs(d);if(v.invalid){Lt("Skipping parsing of block: Invalid selector found in string stylesheet: "+d),l();continue}}var m=h[2],y=!1;s=m;for(var b=[];;){var x=s.match(/^\s*$/);if(x)break;var A=s.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!A){Lt("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+m),y=!0;break}o=A[0];var C=A[1],E=A[2],S=e.properties[C];if(!S){Lt("Skipping property: Invalid property name in: "+o),u();continue}var T=n.parse(C,E);if(!T){Lt("Skipping property: Invalid property definition in: "+o),u();continue}b.push({name:C,val:E}),u()}if(y){l();break}n.selector(d);for(var R=0;R<b.length;R++){var D=b[R];n.css(D.name,D.val)}l()}return n};T2.fromString=function(r){var e=this;return e.resetToDefault(),e.appendFromString(r),e};var Dr={};(function(){var r=Fr,e=d8,n=v8,i=m8,a=p8,s=function(ae){return"^"+ae+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(ae){var le=r+"|\\w+|"+e+"|"+n+"|"+i+"|"+a;return"^"+ae+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+r+")\\s*\\,\\s*("+r+")\\s*,\\s*("+le+")\\s*\\,\\s*("+le+")\\)$"},l=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Dr.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:s("data")},layoutData:{mapping:!0,regex:s("layoutData")},scratch:{mapping:!0,regex:s("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:l,singleRegexMatchValue:!0},urls:{regexes:l,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(ae,le){switch(ae.length){case 2:return le[0]!=="deg"&&le[0]!=="rad"&&le[1]!=="deg"&&le[1]!=="rad";case 1:return Je(ae[0])||le[0]==="deg"||le[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(ae){var le=ae.length;return le===1||le===2||le===4}}};var u={zeroNonZero:function(ae,le){return(ae==null||le==null)&&ae!==le||ae==0&&le!=0?!0:ae!=0&&le==0},any:function(ae,le){return ae!=le},emptyNonEmpty:function(ae,le){var Ae=ps(ae),Re=ps(le);return Ae&&!Re||!Ae&&Re}},c=Dr.types,h=[{name:"label",type:c.text,triggersBounds:u.any,triggersZOrder:u.emptyNonEmpty},{name:"text-rotation",type:c.textRotation,triggersBounds:u.any},{name:"text-margin-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"text-margin-y",type:c.bidirectionalSize,triggersBounds:u.any}],d=[{name:"source-label",type:c.text,triggersBounds:u.any},{name:"source-text-rotation",type:c.textRotation,triggersBounds:u.any},{name:"source-text-margin-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"source-text-margin-y",type:c.bidirectionalSize,triggersBounds:u.any},{name:"source-text-offset",type:c.size,triggersBounds:u.any}],v=[{name:"target-label",type:c.text,triggersBounds:u.any},{name:"target-text-rotation",type:c.textRotation,triggersBounds:u.any},{name:"target-text-margin-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"target-text-margin-y",type:c.bidirectionalSize,triggersBounds:u.any},{name:"target-text-offset",type:c.size,triggersBounds:u.any}],m=[{name:"font-family",type:c.fontFamily,triggersBounds:u.any},{name:"font-style",type:c.fontStyle,triggersBounds:u.any},{name:"font-weight",type:c.fontWeight,triggersBounds:u.any},{name:"font-size",type:c.size,triggersBounds:u.any},{name:"text-transform",type:c.textTransform,triggersBounds:u.any},{name:"text-wrap",type:c.textWrap,triggersBounds:u.any},{name:"text-overflow-wrap",type:c.textOverflowWrap,triggersBounds:u.any},{name:"text-max-width",type:c.size,triggersBounds:u.any},{name:"text-outline-width",type:c.size,triggersBounds:u.any},{name:"line-height",type:c.positiveNumber,triggersBounds:u.any}],y=[{name:"text-valign",type:c.valign,triggersBounds:u.any},{name:"text-halign",type:c.halign,triggersBounds:u.any},{name:"color",type:c.color},{name:"text-outline-color",type:c.color},{name:"text-outline-opacity",type:c.zeroOneNumber},{name:"text-background-color",type:c.color},{name:"text-background-opacity",type:c.zeroOneNumber},{name:"text-background-padding",type:c.size,triggersBounds:u.any},{name:"text-border-opacity",type:c.zeroOneNumber},{name:"text-border-color",type:c.color},{name:"text-border-width",type:c.size,triggersBounds:u.any},{name:"text-border-style",type:c.borderStyle,triggersBounds:u.any},{name:"text-background-shape",type:c.textBackgroundShape,triggersBounds:u.any},{name:"text-justification",type:c.justification},{name:"box-select-labels",type:c.bool,triggersBounds:u.any}],b=[{name:"events",type:c.bool,triggersZOrder:u.any},{name:"text-events",type:c.bool,triggersZOrder:u.any},{name:"box-selection",type:c.boxSelection,triggersZOrder:u.any}],x=[{name:"display",type:c.display,triggersZOrder:u.any,triggersBounds:u.any,triggersBoundsOfConnectedEdges:u.any,triggersBoundsOfParallelEdges:function(ae,le,Ae){return ae===le?!1:Ae.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:c.visibility,triggersZOrder:u.any},{name:"opacity",type:c.zeroOneNumber,triggersZOrder:u.zeroNonZero},{name:"text-opacity",type:c.zeroOneNumber},{name:"min-zoomed-font-size",type:c.size},{name:"z-compound-depth",type:c.zCompoundDepth,triggersZOrder:u.any},{name:"z-index-compare",type:c.zIndexCompare,triggersZOrder:u.any},{name:"z-index",type:c.number,triggersZOrder:u.any}],A=[{name:"overlay-padding",type:c.size,triggersBounds:u.any},{name:"overlay-color",type:c.color},{name:"overlay-opacity",type:c.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"overlay-shape",type:c.overlayShape,triggersBounds:u.any},{name:"overlay-corner-radius",type:c.cornerRadius}],C=[{name:"underlay-padding",type:c.size,triggersBounds:u.any},{name:"underlay-color",type:c.color},{name:"underlay-opacity",type:c.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"underlay-shape",type:c.overlayShape,triggersBounds:u.any},{name:"underlay-corner-radius",type:c.cornerRadius}],E=[{name:"transition-property",type:c.propList},{name:"transition-duration",type:c.time},{name:"transition-delay",type:c.time},{name:"transition-timing-function",type:c.easing}],S=function(ae,le){return le.value==="label"?-ae.poolIndex():le.pfValue},T=[{name:"height",type:c.nodeSize,triggersBounds:u.any,hashOverride:S},{name:"width",type:c.nodeSize,triggersBounds:u.any,hashOverride:S},{name:"shape",type:c.nodeShape,triggersBounds:u.any},{name:"shape-polygon-points",type:c.polygonPointList,triggersBounds:u.any},{name:"corner-radius",type:c.cornerRadius},{name:"background-color",type:c.color},{name:"background-fill",type:c.fill},{name:"background-opacity",type:c.zeroOneNumber},{name:"background-blacken",type:c.nOneOneNumber},{name:"background-gradient-stop-colors",type:c.colors},{name:"background-gradient-stop-positions",type:c.percentages},{name:"background-gradient-direction",type:c.gradientDirection},{name:"padding",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"padding-relative-to",type:c.paddingRelativeTo,triggersBounds:u.any},{name:"bounds-expansion",type:c.boundsExpansion,triggersBounds:u.any}],R=[{name:"border-color",type:c.color},{name:"border-opacity",type:c.zeroOneNumber},{name:"border-width",type:c.size,triggersBounds:u.any},{name:"border-style",type:c.borderStyle},{name:"border-cap",type:c.lineCap},{name:"border-join",type:c.lineJoin},{name:"border-dash-pattern",type:c.numbers},{name:"border-dash-offset",type:c.number},{name:"border-position",type:c.linePosition}],D=[{name:"outline-color",type:c.color},{name:"outline-opacity",type:c.zeroOneNumber},{name:"outline-width",type:c.size,triggersBounds:u.any},{name:"outline-style",type:c.borderStyle},{name:"outline-offset",type:c.size,triggersBounds:u.any}],B=[{name:"background-image",type:c.urls},{name:"background-image-crossorigin",type:c.bgCrossOrigin},{name:"background-image-opacity",type:c.zeroOneNumbers},{name:"background-image-containment",type:c.bgContainment},{name:"background-image-smoothing",type:c.bools},{name:"background-position-x",type:c.bgPos},{name:"background-position-y",type:c.bgPos},{name:"background-width-relative-to",type:c.bgRelativeTo},{name:"background-height-relative-to",type:c.bgRelativeTo},{name:"background-repeat",type:c.bgRepeat},{name:"background-fit",type:c.bgFit},{name:"background-clip",type:c.bgClip},{name:"background-width",type:c.bgWH},{name:"background-height",type:c.bgWH},{name:"background-offset-x",type:c.bgPos},{name:"background-offset-y",type:c.bgPos}],N=[{name:"position",type:c.position,triggersBounds:u.any},{name:"compound-sizing-wrt-labels",type:c.compoundIncludeLabels,triggersBounds:u.any},{name:"min-width",type:c.size,triggersBounds:u.any},{name:"min-width-bias-left",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"min-width-bias-right",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"min-height",type:c.size,triggersBounds:u.any},{name:"min-height-bias-top",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"min-height-bias-bottom",type:c.sizeMaybePercent,triggersBounds:u.any}],I=[{name:"line-style",type:c.lineStyle},{name:"line-color",type:c.color},{name:"line-fill",type:c.fill},{name:"line-cap",type:c.lineCap},{name:"line-opacity",type:c.zeroOneNumber},{name:"line-dash-pattern",type:c.numbers},{name:"line-dash-offset",type:c.number},{name:"line-outline-width",type:c.size},{name:"line-outline-color",type:c.color},{name:"line-gradient-stop-colors",type:c.colors},{name:"line-gradient-stop-positions",type:c.percentages},{name:"curve-style",type:c.curveStyle,triggersBounds:u.any,triggersBoundsOfParallelEdges:function(ae,le){return ae===le?!1:ae==="bezier"||le==="bezier"}},{name:"haystack-radius",type:c.zeroOneNumber,triggersBounds:u.any},{name:"source-endpoint",type:c.edgeEndpoint,triggersBounds:u.any},{name:"target-endpoint",type:c.edgeEndpoint,triggersBounds:u.any},{name:"control-point-step-size",type:c.size,triggersBounds:u.any},{name:"control-point-distances",type:c.bidirectionalSizes,triggersBounds:u.any},{name:"control-point-weights",type:c.numbers,triggersBounds:u.any},{name:"segment-distances",type:c.bidirectionalSizes,triggersBounds:u.any},{name:"segment-weights",type:c.numbers,triggersBounds:u.any},{name:"segment-radii",type:c.numbers,triggersBounds:u.any},{name:"radius-type",type:c.radiusType,triggersBounds:u.any},{name:"taxi-turn",type:c.bidirectionalSizeMaybePercent,triggersBounds:u.any},{name:"taxi-turn-min-distance",type:c.size,triggersBounds:u.any},{name:"taxi-direction",type:c.axisDirection,triggersBounds:u.any},{name:"taxi-radius",type:c.number,triggersBounds:u.any},{name:"edge-distances",type:c.edgeDistances,triggersBounds:u.any},{name:"arrow-scale",type:c.positiveNumber,triggersBounds:u.any},{name:"loop-direction",type:c.angle,triggersBounds:u.any},{name:"loop-sweep",type:c.angle,triggersBounds:u.any},{name:"source-distance-from-node",type:c.size,triggersBounds:u.any},{name:"target-distance-from-node",type:c.size,triggersBounds:u.any}],P=[{name:"ghost",type:c.bool,triggersBounds:u.any},{name:"ghost-offset-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"ghost-offset-y",type:c.bidirectionalSize,triggersBounds:u.any},{name:"ghost-opacity",type:c.zeroOneNumber}],F=[{name:"selection-box-color",type:c.color},{name:"selection-box-opacity",type:c.zeroOneNumber},{name:"selection-box-border-color",type:c.color},{name:"selection-box-border-width",type:c.size},{name:"active-bg-color",type:c.color},{name:"active-bg-opacity",type:c.zeroOneNumber},{name:"active-bg-size",type:c.size},{name:"outside-texture-bg-color",type:c.color},{name:"outside-texture-bg-opacity",type:c.zeroOneNumber}],O=[];Dr.pieBackgroundN=16,O.push({name:"pie-size",type:c.sizeMaybePercent}),O.push({name:"pie-hole",type:c.sizeMaybePercent}),O.push({name:"pie-start-angle",type:c.angle});for(var U=1;U<=Dr.pieBackgroundN;U++)O.push({name:"pie-"+U+"-background-color",type:c.color}),O.push({name:"pie-"+U+"-background-size",type:c.percent}),O.push({name:"pie-"+U+"-background-opacity",type:c.zeroOneNumber});var L=[];Dr.stripeBackgroundN=16,L.push({name:"stripe-size",type:c.sizeMaybePercent}),L.push({name:"stripe-direction",type:c.axisDirectionPrimary});for(var V=1;V<=Dr.stripeBackgroundN;V++)L.push({name:"stripe-"+V+"-background-color",type:c.color}),L.push({name:"stripe-"+V+"-background-size",type:c.percent}),L.push({name:"stripe-"+V+"-background-opacity",type:c.zeroOneNumber});var _=[],G=Dr.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:c.arrowShape,triggersBounds:u.any},{name:"arrow-color",type:c.color},{name:"arrow-fill",type:c.arrowFill},{name:"arrow-width",type:c.arrowWidth}].forEach(function(re){G.forEach(function(ae){var le=ae+"-"+re.name,Ae=re.type,Re=re.triggersBounds;_.push({name:le,type:Ae,triggersBounds:Re})})},{});var K=Dr.properties=[].concat(b,E,x,A,C,P,y,m,h,d,v,T,R,D,B,O,L,N,I,_,F),z=Dr.propertyGroups={behavior:b,transition:E,visibility:x,overlay:A,underlay:C,ghost:P,commonLabel:y,labelDimensions:m,mainLabel:h,sourceLabel:d,targetLabel:v,nodeBody:T,nodeBorder:R,nodeOutline:D,backgroundImage:B,pie:O,stripe:L,compound:N,edgeLine:I,edgeArrow:_,core:F},Y=Dr.propertyGroupNames={},Z=Dr.propertyGroupKeys=Object.keys(z);Z.forEach(function(re){Y[re]=z[re].map(function(ae){return ae.name}),z[re].forEach(function(ae){return ae.groupKey=re})});var J=Dr.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Dr.propertyNames=K.map(function(re){return re.name});for(var ee=0;ee<K.length;ee++){var ne=K[ee];K[ne.name]=ne}for(var oe=0;oe<J.length;oe++){var me=J[oe],ye=K[me.pointsTo],ve={name:me.name,alias:!0,pointsTo:ye};K.push(ve),K[me.name]=ve}})();Dr.getDefaultProperty=function(r){return this.getDefaultProperties()[r]};Dr.getDefaultProperties=function(){var r=this._private;if(r.defaultProperties!=null)return r.defaultProperties;for(var e=et({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(u,c){for(var h=1;h<=Dr.pieBackgroundN;h++){var d=c.name.replace("{{i}}",h),v=c.value;u[d]=v}return u},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(u,c){for(var h=1;h<=Dr.stripeBackgroundN;h++){var d=c.name.replace("{{i}}",h),v=c.value;u[d]=v}return u},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(u,c){return Dr.arrowPrefixes.forEach(function(h){var d=h+"-"+c.name,v=c.value;u[d]=v}),u},{})),n={},i=0;i<this.properties.length;i++){var a=this.properties[i];if(!a.pointsTo){var s=a.name,o=e[s],l=this.parse(s,o);n[s]=l}}return r.defaultProperties=n,r.defaultProperties};Dr.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var M0={};M0.parse=function(r,e,n,i){var a=this;if(gr(e))return a.parseImplWarn(r,e,n,i);var s=i==="mapping"||i===!0||i===!1||i==null?"dontcare":i,o=n?"t":"f",l=""+e,u=JC(r,l,o,s),c=a.propCache=a.propCache||[],h;return(h=c[u])||(h=c[u]=a.parseImplWarn(r,e,n,i)),(n||i==="mapping")&&(h=zi(h),h&&(h.value=zi(h.value))),h};M0.parseImplWarn=function(r,e,n,i){var a=this.parseImpl(r,e,n,i);return!a&&e!=null&&Lt("The style property `".concat(r,": ").concat(e,"` is invalid")),a&&(a.name==="width"||a.name==="height")&&e==="label"&&Lt("The style value of `label` is deprecated for `"+a.name+"`"),a};M0.parseImpl=function(r,e,n,i){var a=this;r=c2(r);var s=a.properties[r],o=e,l=a.types;if(!s||e===void 0)return null;s.alias&&(s=s.pointsTo,r=s.name);var u=Je(e);u&&(e=e.trim());var c=s.type;if(!c)return null;if(n&&(e===""||e===null))return{name:r,value:e,bypass:!0,deleteBypass:!0};if(gr(e))return{name:r,value:e,strValue:"fn",mapped:l.fn,bypass:n};var h,d;if(!(!u||i||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(h=new RegExp(l.data.regex).exec(e))){if(n)return!1;var v=l.data;return{name:r,value:h,strValue:""+e,mapped:v,field:h[1],bypass:n}}else if(e.length>=10&&e[0]==="m"&&(d=new RegExp(l.mapData.regex).exec(e))){if(n||c.multiple)return!1;var m=l.mapData;if(!(c.color||c.number))return!1;var y=this.parse(r,d[4]);if(!y||y.mapped)return!1;var b=this.parse(r,d[5]);if(!b||b.mapped)return!1;if(y.pfValue===b.pfValue||y.strValue===b.strValue)return Lt("`"+r+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+r+": "+y.strValue+"`"),this.parse(r,y.strValue);if(c.color){var x=y.value,A=b.value,C=x[0]===A[0]&&x[1]===A[1]&&x[2]===A[2]&&(x[3]===A[3]||(x[3]==null||x[3]===1)&&(A[3]==null||A[3]===1));if(C)return!1}return{name:r,value:d,strValue:""+e,mapped:m,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:y.value,valueMax:b.value,bypass:n}}}if(c.multiple&&i!=="multiple"){var E;if(u?E=e.split(/\s+/):Qt(e)?E=e:E=[e],c.evenMultiple&&E.length%2!==0)return null;for(var S=[],T=[],R=[],D="",B=!1,N=0;N<E.length;N++){var I=a.parse(r,E[N],n,"multiple");B=B||Je(I.value),S.push(I.value),R.push(I.pfValue!=null?I.pfValue:I.value),T.push(I.units),D+=(N>0?" ":"")+I.strValue}return c.validate&&!c.validate(S,T)?null:c.singleEnum&&B?S.length===1&&Je(S[0])?{name:r,value:S[0],strValue:S[0],bypass:n}:null:{name:r,value:S,pfValue:R,strValue:D,bypass:n,units:T}}var P=function(){for(var ve=0;ve<c.enums.length;ve++){var re=c.enums[ve];if(re===e)return{name:r,value:e,strValue:""+e,bypass:n}}return null};if(c.number){var F,O="px";if(c.units&&(F=c.units),c.implicitUnits&&(O=c.implicitUnits),!c.unitless)if(u){var U="px|em"+(c.allowPercent?"|\\%":"");F&&(U=F);var L=e.match("^("+Fr+")("+U+")?$");L&&(e=L[1],F=L[2]||O)}else(!F||c.implicitUnits)&&(F=O);if(e=parseFloat(e),isNaN(e)&&c.enums===void 0)return null;if(isNaN(e)&&c.enums!==void 0)return e=o,P();if(c.integer&&!s8(e)||c.min!==void 0&&(e<c.min||c.strictMin&&e===c.min)||c.max!==void 0&&(e>c.max||c.strictMax&&e===c.max))return null;var V={name:r,value:e,strValue:""+e+(F||""),units:F,bypass:n};return c.unitless||F!=="px"&&F!=="em"?V.pfValue=e:V.pfValue=F==="px"||!F?e:this.getEmSizeInPixels()*e,(F==="ms"||F==="s")&&(V.pfValue=F==="ms"?e:1e3*e),(F==="deg"||F==="rad")&&(V.pfValue=F==="rad"?e:mR(e)),F==="%"&&(V.pfValue=e/100),V}else if(c.propList){var _=[],G=""+e;if(G!=="none"){for(var K=G.split(/\s*,\s*|\s+/),z=0;z<K.length;z++){var Y=K[z].trim();a.properties[Y]?_.push(Y):Lt("`"+Y+"` is not a valid property name")}if(_.length===0)return null}return{name:r,value:_,strValue:_.length===0?"none":_.join(" "),bypass:n}}else if(c.color){var Z=HC(e);return Z?{name:r,value:Z,pfValue:Z,strValue:"rgb("+Z[0]+","+Z[1]+","+Z[2]+")",bypass:n}:null}else if(c.regex||c.regexes){if(c.enums){var J=P();if(J)return J}for(var ee=c.regexes?c.regexes:[c.regex],ne=0;ne<ee.length;ne++){var oe=new RegExp(ee[ne]),me=oe.exec(e);if(me)return{name:r,value:c.singleRegexMatchValue?me[1]:me,strValue:""+e,bypass:n}}return null}else return c.string?{name:r,value:""+e,strValue:""+e,bypass:n}:c.enums?P():null};var Yr=function(e){if(!(this instanceof Yr))return new Yr(e);if(!u2(e)){cr("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},on=Yr.prototype;on.instanceString=function(){return"style"};on.clear=function(){for(var r=this._private,e=r.cy,n=e.elements(),i=0;i<this.length;i++)this[i]=void 0;return this.length=0,r.contextStyles={},r.propDiffs={},this.cleanElements(n,!0),n.forEach(function(a){var s=a[0]._private;s.styleDirty=!0,s.appliedInitStyle=!1}),this};on.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};on.core=function(r){return this._private.coreStyle[r]||this.getDefaultProperty(r)};on.selector=function(r){var e=r==="core"?null:new xs(r),n=this.length++;return this[n]={selector:e,properties:[],mappedProperties:[],index:n},this};on.css=function(){var r=this,e=arguments;if(e.length===1)for(var n=e[0],i=0;i<r.properties.length;i++){var a=r.properties[i],s=n[a.name];s===void 0&&(s=n[d0(a.name)]),s!==void 0&&this.cssRule(a.name,s)}else e.length===2&&this.cssRule(e[0],e[1]);return this};on.style=on.css;on.cssRule=function(r,e){var n=this.parse(r,e);if(n){var i=this.length-1;this[i].properties.push(n),this[i].properties[n.name]=n,n.name.match(/pie-(\d+)-background-size/)&&n.value&&(this._private.hasPie=!0),n.name.match(/stripe-(\d+)-background-size/)&&n.value&&(this._private.hasStripe=!0),n.mapped&&this[i].mappedProperties.push(n);var a=!this[i].selector;a&&(this._private.coreStyle[n.name]=n)}return this};on.append=function(r){return qC(r)?r.appendToStyle(this):Qt(r)?this.appendFromJson(r):Je(r)&&this.appendFromString(r),this};Yr.fromJson=function(r,e){var n=new Yr(r);return n.fromJson(e),n};Yr.fromString=function(r,e){return new Yr(r).fromString(e)};[jr,lf,S2,Hi,T0,T2,Dr,M0].forEach(function(r){et(on,r)});Yr.types=on.types;Yr.properties=on.properties;Yr.propertyGroups=on.propertyGroups;Yr.propertyGroupNames=on.propertyGroupNames;Yr.propertyGroupKeys=on.propertyGroupKeys;var xI={style:function(e){if(e){var n=this.setStyle(e);n.update()}return this._private.style},setStyle:function(e){var n=this._private;return qC(e)?n.style=e.generateStyle(this):Qt(e)?n.style=Yr.fromJson(this,e):Je(e)?n.style=Yr.fromString(this,e):n.style=Yr(this),n.style},updateStyle:function(){this.mutableElements().updateStyle()}},bI="single",go={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var n=this._private;if(n.selectionType==null&&(n.selectionType=bI),e!==void 0)(e==="additive"||e==="single")&&(n.selectionType=e);else return n.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,n=this._private.pan,i,a,s,o,l;switch(e.length){case 0:return n;case 1:if(Je(e[0]))return i=e[0],n[i];if(It(e[0])){if(!this._private.panningEnabled)return this;s=e[0],o=s.x,l=s.y,Be(o)&&(n.x=o),Be(l)&&(n.y=l),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;i=e[0],a=e[1],(i==="x"||i==="y")&&Be(a)&&(n[i]=a),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,n){var i=arguments,a=this._private.pan,s,o,l,u,c;if(!this._private.panningEnabled)return this;switch(i.length){case 1:It(e)&&(l=i[0],u=l.x,c=l.y,Be(u)&&(a.x+=u),Be(c)&&(a.y+=c),this.emit("pan viewport"));break;case 2:s=e,o=n,(s==="x"||s==="y")&&Be(o)&&(a[s]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,n){var i=this.getFitViewport(e,n);if(i){var a=this._private;a.zoom=i.zoom,a.pan=i.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,n){if(Be(e)&&n===void 0&&(n=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var i;if(Je(e)){var a=e;e=this.$(a)}else if(u8(e)){var s=e;i={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2},i.w=i.x2-i.x1,i.h=i.y2-i.y1}else jn(e)||(e=this.mutableElements());if(!(jn(e)&&e.empty())){i=i||e.boundingBox();var o=this.width(),l=this.height(),u;if(n=Be(n)?n:0,!isNaN(o)&&!isNaN(l)&&o>0&&l>0&&!isNaN(i.w)&&!isNaN(i.h)&&i.w>0&&i.h>0){u=Math.min((o-2*n)/i.w,(l-2*n)/i.h),u=u>this._private.maxZoom?this._private.maxZoom:u,u=u<this._private.minZoom?this._private.minZoom:u;var c={x:(o-u*(i.x1+i.x2))/2,y:(l-u*(i.y1+i.y2))/2};return{zoom:u,pan:c}}}}},zoomRange:function(e,n){var i=this._private;if(n==null){var a=e;e=a.min,n=a.max}return Be(e)&&Be(n)&&e<=n?(i.minZoom=e,i.maxZoom=n):Be(e)&&n===void 0&&e<=i.maxZoom?i.minZoom=e:Be(n)&&e===void 0&&n>=i.minZoom&&(i.maxZoom=n),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var n=this._private,i=n.pan,a=n.zoom,s,o,l=!1;if(n.zoomingEnabled||(l=!0),Be(e)?o=e:It(e)&&(o=e.level,e.position!=null?s=m0(e.position,a,i):e.renderedPosition!=null&&(s=e.renderedPosition),s!=null&&!n.panningEnabled&&(l=!0)),o=o>n.maxZoom?n.maxZoom:o,o=o<n.minZoom?n.minZoom:o,l||!Be(o)||o===a||s!=null&&(!Be(s.x)||!Be(s.y)))return null;if(s!=null){var u=i,c=a,h=o,d={x:-h/c*(s.x-u.x)+s.x,y:-h/c*(s.y-u.y)+s.y};return{zoomed:!0,panned:!0,zoom:h,pan:d}}else return{zoomed:!0,panned:!1,zoom:o,pan:i}},zoom:function(e){if(e===void 0)return this._private.zoom;var n=this.getZoomedViewport(e),i=this._private;return n==null||!n.zoomed?this:(i.zoom=n.zoom,n.panned&&(i.pan.x=n.pan.x,i.pan.y=n.pan.y),this.emit("zoom"+(n.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var n=this._private,i=!0,a=!0,s=[],o=!1,l=!1;if(!e)return this;if(Be(e.zoom)||(i=!1),It(e.pan)||(a=!1),!i&&!a)return this;if(i){var u=e.zoom;u<n.minZoom||u>n.maxZoom||!n.zoomingEnabled?o=!0:(n.zoom=u,s.push("zoom"))}if(a&&(!o||!e.cancelOnFailedZoom)&&n.panningEnabled){var c=e.pan;Be(c.x)&&(n.pan.x=c.x,l=!1),Be(c.y)&&(n.pan.y=c.y,l=!1),l||s.push("pan")}return s.length>0&&(s.push("viewport"),this.emit(s.join(" ")),this.notify("viewport")),this},center:function(e){var n=this.getCenterPan(e);return n&&(this._private.pan=n,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,n){if(this._private.panningEnabled){if(Je(e)){var i=e;e=this.mutableElements().filter(i)}else jn(e)||(e=this.mutableElements());if(e.length!==0){var a=e.boundingBox(),s=this.width(),o=this.height();n=n===void 0?this._private.zoom:n;var l={x:(s-n*(a.x1+a.x2))/2,y:(o-n*(a.y1+a.y2))/2};return l}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,n=e.container,i=this;return e.sizeCache=e.sizeCache||(n?(function(){var a=i.window().getComputedStyle(n),s=function(l){return parseFloat(a.getPropertyValue(l))};return{width:n.clientWidth-s("padding-left")-s("padding-right"),height:n.clientHeight-s("padding-top")-s("padding-bottom")}})():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,n=this._private.zoom,i=this.renderedExtent(),a={x1:(i.x1-e.x)/n,x2:(i.x2-e.x)/n,y1:(i.y1-e.y)/n,y2:(i.y2-e.y)/n};return a.w=a.x2-a.x1,a.h=a.y2-a.y1,a},renderedExtent:function(){var e=this.width(),n=this.height();return{x1:0,y1:0,x2:e,y2:n,w:e,h:n}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};go.centre=go.center;go.autolockNodes=go.autolock;go.autoungrabifyNodes=go.autoungrabify;var zc={data:Ot.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Ot.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Ot.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Ot.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};zc.attr=zc.data;zc.removeAttr=zc.removeData;var qc=function(e){var n=this;e=et({},e);var i=e.container;i&&!Ld(i)&&Ld(i[0])&&(i=i[0]);var a=i?i._cyreg:null;a=a||{},a&&a.cy&&(a.cy.destroy(),a={});var s=a.readies=a.readies||[];i&&(i._cyreg=a),a.cy=n;var o=Nr!==void 0&&i!==void 0&&!e.headless,l=e;l.layout=et({name:o?"grid":"null"},l.layout),l.renderer=et({name:o?"canvas":"null"},l.renderer);var u=function(y,b,x){return b!==void 0?b:x!==void 0?x:y},c=this._private={container:i,ready:!1,options:l,elements:new Jr(this),listeners:[],aniEles:new Jr(this),data:l.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:u(!0,l.zoomingEnabled),userZoomingEnabled:u(!0,l.userZoomingEnabled),panningEnabled:u(!0,l.panningEnabled),userPanningEnabled:u(!0,l.userPanningEnabled),boxSelectionEnabled:u(!0,l.boxSelectionEnabled),autolock:u(!1,l.autolock,l.autolockNodes),autoungrabify:u(!1,l.autoungrabify,l.autoungrabifyNodes),autounselectify:u(!1,l.autounselectify),styleEnabled:l.styleEnabled===void 0?o:l.styleEnabled,zoom:Be(l.zoom)?l.zoom:1,pan:{x:It(l.pan)&&Be(l.pan.x)?l.pan.x:0,y:It(l.pan)&&Be(l.pan.y)?l.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:u(250,l.multiClickDebounceTime)};this.createEmitter(),this.selectionType(l.selectionType),this.zoomRange({min:l.minZoom,max:l.maxZoom});var h=function(y,b){var x=y.some(c8);if(x)return Gl.all(y).then(b);b(y)};c.styleEnabled&&n.setStyle([]);var d=et({},l,l.renderer);n.initRenderer(d);var v=function(y,b,x){n.notifications(!1);var A=n.mutableElements();A.length>0&&A.remove(),y!=null&&(It(y)||Qt(y))&&n.add(y),n.one("layoutready",function(E){n.notifications(!0),n.emit(E),n.one("load",b),n.emitAndNotify("load")}).one("layoutstop",function(){n.one("done",x),n.emit("done")});var C=et({},n._private.options.layout);C.eles=n.elements(),n.layout(C).run()};h([l.style,l.elements],function(m){var y=m[0],b=m[1];c.styleEnabled&&n.style().append(y),v(b,function(){n.startAnimationLoop(),c.ready=!0,gr(l.ready)&&n.on("ready",l.ready);for(var x=0;x<s.length;x++){var A=s[x];n.on("ready",A)}a&&(a.readies=[]),n.emit("ready")},l.done)})},jd=qc.prototype;et(jd,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return Nr;var n=this._private.container.ownerDocument;return n===void 0||n==null?Nr:n.defaultView||Nr},mount:function(e){if(e!=null){var n=this,i=n._private,a=i.options;return!Ld(e)&&Ld(e[0])&&(e=e[0]),n.stopAnimationLoop(),n.destroyRenderer(),i.container=e,i.styleEnabled=!0,n.invalidateSize(),n.initRenderer(et({},a,a.renderer,{name:a.renderer.name==="null"?"canvas":a.renderer.name})),n.startAnimationLoop(),n.style(a.style),n.emit("mount"),n}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return zi(this._private.options)},json:function(e){var n=this,i=n._private,a=n.mutableElements(),s=function(S){return n.getElementById(S.id())};if(It(e)){if(n.startBatch(),e.elements){var o={},l=function(S,T){for(var R=[],D=[],B=0;B<S.length;B++){var N=S[B];if(!N.data.id){Lt("cy.json() cannot handle elements without an ID attribute");continue}var I=""+N.data.id,P=n.getElementById(I);o[I]=!0,P.length!==0?D.push({ele:P,json:N}):(T&&(N.group=T),R.push(N))}n.add(R);for(var F=0;F<D.length;F++){var O=D[F],U=O.ele,L=O.json;U.json(L)}};if(Qt(e.elements))l(e.elements);else for(var u=["nodes","edges"],c=0;c<u.length;c++){var h=u[c],d=e.elements[h];Qt(d)&&l(d,h)}var v=n.collection();a.filter(function(E){return!o[E.id()]}).forEach(function(E){E.isParent()?v.merge(E):E.remove()}),v.forEach(function(E){return E.children().move({parent:null})}),v.forEach(function(E){return s(E).remove()})}e.style&&n.style(e.style),e.zoom!=null&&e.zoom!==i.zoom&&n.zoom(e.zoom),e.pan&&(e.pan.x!==i.pan.x||e.pan.y!==i.pan.y)&&n.pan(e.pan),e.data&&n.data(e.data);for(var m=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],y=0;y<m.length;y++){var b=m[y];e[b]!=null&&n[b](e[b])}return n.endBatch(),this}else{var x=!!e,A={};x?A.elements=this.elements().map(function(E){return E.json()}):(A.elements={},a.forEach(function(E){var S=E.group();A.elements[S]||(A.elements[S]=[]),A.elements[S].push(E.json())})),this._private.styleEnabled&&(A.style=n.style().json()),A.data=zi(n.data());var C=i.options;return A.zoomingEnabled=i.zoomingEnabled,A.userZoomingEnabled=i.userZoomingEnabled,A.zoom=i.zoom,A.minZoom=i.minZoom,A.maxZoom=i.maxZoom,A.panningEnabled=i.panningEnabled,A.userPanningEnabled=i.userPanningEnabled,A.pan=zi(i.pan),A.boxSelectionEnabled=i.boxSelectionEnabled,A.renderer=zi(C.renderer),A.hideEdgesOnViewport=C.hideEdgesOnViewport,A.textureOnViewport=C.textureOnViewport,A.wheelSensitivity=C.wheelSensitivity,A.motionBlur=C.motionBlur,A.multiClickDebounceTime=C.multiClickDebounceTime,A}}});jd.$id=jd.getElementById;[cI,vI,qE,xp,xd,pI,bp,bd,xI,go,zc].forEach(function(r){et(jd,r)});var wI={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}},CI={maximal:!1,acyclic:!1},fl=function(e){return e.scratch("breadthfirst")},d3=function(e,n){return e.scratch("breadthfirst",n)};function GE(r){this.options=et({},wI,CI,r)}GE.prototype.run=function(){var r=this.options,e=r.cy,n=r.eles,i=n.nodes().filter(function(Ze){return Ze.isChildless()}),a=n,s=r.directed,o=r.acyclic||r.maximal||r.maximalAdjustments>0,l=!!r.boundingBox,u=yn(l?r.boundingBox:structuredClone(e.extent())),c;if(jn(r.roots))c=r.roots;else if(Qt(r.roots)){for(var h=[],d=0;d<r.roots.length;d++){var v=r.roots[d],m=e.getElementById(v);h.push(m)}c=e.collection(h)}else if(Je(r.roots))c=e.$(r.roots);else if(s)c=i.roots();else{var y=n.components();c=e.collection();for(var b=function(){var Ie=y[x],_e=Ie.maxDegree(!1),je=Ie.filter(function(it){return it.degree(!1)===_e});c=c.add(je)},x=0;x<y.length;x++)b()}var A=[],C={},E=function(Ie,_e){A[_e]==null&&(A[_e]=[]);var je=A[_e].length;A[_e].push(Ie),d3(Ie,{index:je,depth:_e})},S=function(Ie,_e){var je=fl(Ie),it=je.depth,Xe=je.index;A[it][Xe]=null,Ie.isChildless()&&E(Ie,_e)};a.bfs({roots:c,directed:r.directed,visit:function(Ie,_e,je,it,Xe){var ht=Ie[0],vt=ht.id();ht.isChildless()&&E(ht,Xe),C[vt]=!0}});for(var T=[],R=0;R<i.length;R++){var D=i[R];C[D.id()]||T.push(D)}var B=function(Ie){for(var _e=A[Ie],je=0;je<_e.length;je++){var it=_e[je];if(it==null){_e.splice(je,1),je--;continue}d3(it,{depth:Ie,index:je})}},N=function(Ie,_e){for(var je=fl(Ie),it=Ie.incomers().filter(function(at){return at.isNode()&&n.has(at)}),Xe=-1,ht=Ie.id(),vt=0;vt<it.length;vt++){var ot=it[vt],pt=fl(ot);Xe=Math.max(Xe,pt.depth)}if(je.depth<=Xe){if(!r.acyclic&&_e[ht])return null;var lt=Xe+1;return S(Ie,lt),_e[ht]=lt,!0}return!1};if(s&&o){var I=[],P={},F=function(Ie){return I.push(Ie)},O=function(){return I.shift()};for(i.forEach(function(Ze){return I.push(Ze)});I.length>0;){var U=O(),L=N(U,P);if(L)U.outgoers().filter(function(Ze){return Ze.isNode()&&n.has(Ze)}).forEach(F);else if(L===null){Lt("Detected double maximal shift for node `"+U.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var V=0;if(r.avoidOverlap)for(var _=0;_<i.length;_++){var G=i[_],K=G.layoutDimensions(r),z=K.w,Y=K.h;V=Math.max(V,z,Y)}var Z={},J=function(Ie){if(Z[Ie.id()])return Z[Ie.id()];for(var _e=fl(Ie).depth,je=Ie.neighborhood(),it=0,Xe=0,ht=0;ht<je.length;ht++){var vt=je[ht];if(!(vt.isEdge()||vt.isParent()||!i.has(vt))){var ot=fl(vt);if(ot!=null){var pt=ot.index,lt=ot.depth;if(!(pt==null||lt==null)){var at=A[lt].length;lt<_e&&(it+=pt/at,Xe++)}}}}return Xe=Math.max(1,Xe),it=it/Xe,Xe===0&&(it=0),Z[Ie.id()]=it,it},ee=function(Ie,_e){var je=J(Ie),it=J(_e),Xe=je-it;return Xe===0?YC(Ie.id(),_e.id()):Xe};r.depthSort!==void 0&&(ee=r.depthSort);for(var ne=A.length,oe=0;oe<ne;oe++)A[oe].sort(ee),B(oe);for(var me=[],ye=0;ye<T.length;ye++)me.push(T[ye]);var ve=function(){for(var Ie=0;Ie<ne;Ie++)B(Ie)};me.length&&(A.unshift(me),ne=A.length,ve());for(var re=0,ae=0;ae<ne;ae++)re=Math.max(A[ae].length,re);var le={x:u.x1+u.w/2,y:u.y1+u.h/2},Ae=i.reduce(function(Ze,Ie){return(function(_e){return{w:Ze.w===-1?_e.w:(Ze.w+_e.w)/2,h:Ze.h===-1?_e.h:(Ze.h+_e.h)/2}})(Ie.boundingBox({includeLabels:r.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),Re=Math.max(ne===1?0:l?(u.h-r.padding*2-Ae.h)/(ne-1):(u.h-r.padding*2-Ae.h)/(ne+1),V),Le=A.reduce(function(Ze,Ie){return Math.max(Ze,Ie.length)},0),bt=function(Ie){var _e=fl(Ie),je=_e.depth,it=_e.index;if(r.circle){var Xe=Math.min(u.w/2/ne,u.h/2/ne);Xe=Math.max(Xe,V);var ht=Xe*je+Xe-(ne>0&&A[0].length<=3?Xe/2:0),vt=2*Math.PI/A[je].length*it;return je===0&&A[0].length===1&&(ht=1),{x:le.x+ht*Math.cos(vt),y:le.y+ht*Math.sin(vt)}}else{var ot=A[je].length,pt=Math.max(ot===1?0:l?(u.w-r.padding*2-Ae.w)/((r.grid?Le:ot)-1):(u.w-r.padding*2-Ae.w)/((r.grid?Le:ot)+1),V),lt={x:le.x+(it+1-(ot+1)/2)*pt,y:le.y+(je+1-(ne+1)/2)*Re};return lt}},He={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(He).indexOf(r.direction)===-1&&cr("Invalid direction '".concat(r.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(He).join(", ")));var $e=function(Ie){return L8(bt(Ie),u,He[r.direction])};return n.nodes().layoutPositions(this,r,$e),this};var EI={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function YE(r){this.options=et({},EI,r)}YE.prototype.run=function(){var r=this.options,e=r,n=r.cy,i=e.eles,a=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,s=i.nodes().not(":parent");e.sort&&(s=s.sort(e.sort));for(var o=yn(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},u=e.sweep===void 0?2*Math.PI-2*Math.PI/s.length:e.sweep,c=u/Math.max(1,s.length-1),h,d=0,v=0;v<s.length;v++){var m=s[v],y=m.layoutDimensions(e),b=y.w,x=y.h;d=Math.max(d,b,x)}if(Be(e.radius)?h=e.radius:s.length<=1?h=0:h=Math.min(o.h,o.w)/2-d,s.length>1&&e.avoidOverlap){d*=1.75;var A=Math.cos(c)-Math.cos(0),C=Math.sin(c)-Math.sin(0),E=Math.sqrt(d*d/(A*A+C*C));h=Math.max(E,h)}var S=function(R,D){var B=e.startAngle+D*c*(a?1:-1),N=h*Math.cos(B),I=h*Math.sin(B),P={x:l.x+N,y:l.y+I};return P};return i.nodes().layoutPositions(this,e,S),this};var SI={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function HE(r){this.options=et({},SI,r)}HE.prototype.run=function(){for(var r=this.options,e=r,n=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,i=r.cy,a=e.eles,s=a.nodes().not(":parent"),o=yn(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},u=[],c=0,h=0;h<s.length;h++){var d=s[h],v=void 0;v=e.concentric(d),u.push({value:v,node:d}),d._private.scratch.concentric=v}s.updateStyle();for(var m=0;m<s.length;m++){var y=s[m],b=y.layoutDimensions(e);c=Math.max(c,b.w,b.h)}u.sort(function(Re,Le){return Le.value-Re.value});for(var x=e.levelWidth(s),A=[[]],C=A[0],E=0;E<u.length;E++){var S=u[E];if(C.length>0){var T=Math.abs(C[0].value-S.value);T>=x&&(C=[],A.push(C))}C.push(S)}var R=c+e.minNodeSpacing;if(!e.avoidOverlap){var D=A.length>0&&A[0].length>1,B=Math.min(o.w,o.h)/2-R,N=B/(A.length+D?1:0);R=Math.min(R,N)}for(var I=0,P=0;P<A.length;P++){var F=A[P],O=e.sweep===void 0?2*Math.PI-2*Math.PI/F.length:e.sweep,U=F.dTheta=O/Math.max(1,F.length-1);if(F.length>1&&e.avoidOverlap){var L=Math.cos(U)-Math.cos(0),V=Math.sin(U)-Math.sin(0),_=Math.sqrt(R*R/(L*L+V*V));I=Math.max(_,I)}F.r=I,I+=R}if(e.equidistant){for(var G=0,K=0,z=0;z<A.length;z++){var Y=A[z],Z=Y.r-K;G=Math.max(G,Z)}K=0;for(var J=0;J<A.length;J++){var ee=A[J];J===0&&(K=ee.r),ee.r=K,K+=G}}for(var ne={},oe=0;oe<A.length;oe++)for(var me=A[oe],ye=me.dTheta,ve=me.r,re=0;re<me.length;re++){var ae=me[re],le=e.startAngle+(n?1:-1)*ye*re,Ae={x:l.x+ve*Math.cos(le),y:l.y+ve*Math.sin(le)};ne[ae.node.id()]=Ae}return a.nodes().layoutPositions(this,e,function(Re){var Le=Re.id();return ne[Le]}),this};var Tm,TI={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,n){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function D0(r){this.options=et({},TI,r),this.options.layout=this;var e=this.options.eles.nodes(),n=this.options.eles.edges(),i=n.filter(function(a){var s=a.source().data("id"),o=a.target().data("id"),l=e.some(function(c){return c.data("id")===s}),u=e.some(function(c){return c.data("id")===o});return!l||!u});this.options.eles=this.options.eles.not(i)}D0.prototype.run=function(){var r=this.options,e=r.cy,n=this;n.stopped=!1,(r.animate===!0||r.animate===!1)&&n.emit({type:"layoutstart",layout:n}),r.debug===!0?Tm=!0:Tm=!1;var i=MI(e,n,r);Tm&&RI(i),r.randomize&&BI(i);var a=wa(),s=function(){II(i,e,r),r.fit===!0&&e.fit(r.padding)},o=function(v){return!(n.stopped||v>=r.numIter||(NI(i,r),i.temperature=i.temperature*r.coolingFactor,i.temperature<r.minTemp))},l=function(){if(r.animate===!0||r.animate===!1)s(),n.one("layoutstop",r.stop),n.emit({type:"layoutstop",layout:n});else{var v=r.eles.nodes(),m=KE(i,r,v);v.layoutPositions(n,r,m)}},u=0,c=!0;if(r.animate===!0){var h=function(){for(var v=0;c&&v<r.refresh;)c=o(u),u++,v++;if(!c)v3(i,r),l();else{var m=wa();m-a>=r.animationThreshold&&s(),_d(h)}};h()}else{for(;c;)c=o(u),u++;v3(i,r),l()}return this};D0.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};D0.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var MI=function(e,n,i){for(var a=i.eles.edges(),s=i.eles.nodes(),o=yn(i.boundingBox?i.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),l={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:s.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:a.size(),temperature:i.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o},u=i.eles.components(),c={},h=0;h<u.length;h++)for(var d=u[h],v=0;v<d.length;v++){var m=d[v];c[m.id()]=h}for(var h=0;h<l.nodeSize;h++){var y=s[h],b=y.layoutDimensions(i),x={};x.isLocked=y.locked(),x.id=y.data("id"),x.parentId=y.data("parent"),x.cmptId=c[y.id()],x.children=[],x.positionX=y.position("x"),x.positionY=y.position("y"),x.offsetX=0,x.offsetY=0,x.height=b.w,x.width=b.h,x.maxX=x.positionX+x.width/2,x.minX=x.positionX-x.width/2,x.maxY=x.positionY+x.height/2,x.minY=x.positionY-x.height/2,x.padLeft=parseFloat(y.style("padding")),x.padRight=parseFloat(y.style("padding")),x.padTop=parseFloat(y.style("padding")),x.padBottom=parseFloat(y.style("padding")),x.nodeRepulsion=gr(i.nodeRepulsion)?i.nodeRepulsion(y):i.nodeRepulsion,l.layoutNodes.push(x),l.idToIndex[x.id]=h}for(var A=[],C=0,E=-1,S=[],h=0;h<l.nodeSize;h++){var y=l.layoutNodes[h],T=y.parentId;T!=null?l.layoutNodes[l.idToIndex[T]].children.push(y.id):(A[++E]=y.id,S.push(y.id))}for(l.graphSet.push(S);C<=E;){var R=A[C++],D=l.idToIndex[R],m=l.layoutNodes[D],B=m.children;if(B.length>0){l.graphSet.push(B);for(var h=0;h<B.length;h++)A[++E]=B[h]}}for(var h=0;h<l.graphSet.length;h++)for(var N=l.graphSet[h],v=0;v<N.length;v++){var I=l.idToIndex[N[v]];l.indexToGraph[I]=h}for(var h=0;h<l.edgeSize;h++){var P=a[h],F={};F.id=P.data("id"),F.sourceId=P.data("source"),F.targetId=P.data("target");var O=gr(i.idealEdgeLength)?i.idealEdgeLength(P):i.idealEdgeLength,U=gr(i.edgeElasticity)?i.edgeElasticity(P):i.edgeElasticity,L=l.idToIndex[F.sourceId],V=l.idToIndex[F.targetId],_=l.indexToGraph[L],G=l.indexToGraph[V];if(_!=G){for(var K=DI(F.sourceId,F.targetId,l),z=l.graphSet[K],Y=0,x=l.layoutNodes[L];z.indexOf(x.id)===-1;)x=l.layoutNodes[l.idToIndex[x.parentId]],Y++;for(x=l.layoutNodes[V];z.indexOf(x.id)===-1;)x=l.layoutNodes[l.idToIndex[x.parentId]],Y++;O*=Y*i.nestingFactor}F.idealLength=O,F.elasticity=U,l.layoutEdges.push(F)}return l},DI=function(e,n,i){var a=jE(e,n,0,i);return 2>a.count?0:a.graph},jE=function(e,n,i,a){var s=a.graphSet[i];if(-1<s.indexOf(e)&&-1<s.indexOf(n))return{count:2,graph:i};for(var o=0,l=0;l<s.length;l++){var u=s[l],c=a.idToIndex[u],h=a.layoutNodes[c].children;if(h.length!==0){var d=a.indexToGraph[a.idToIndex[h[0]]],v=jE(e,n,d,a);if(v.count!==0)if(v.count===1){if(o++,o===2)break}else return v}}return{count:o,graph:i}},RI,BI=function(e,n){for(var i=e.clientWidth,a=e.clientHeight,s=0;s<e.nodeSize;s++){var o=e.layoutNodes[s];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*i,o.positionY=Math.random()*a)}},KE=function(e,n,i){var a=e.boundingBox,s={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return n.boundingBox&&(i.forEach(function(o){var l=e.layoutNodes[e.idToIndex[o.data("id")]];s.x1=Math.min(s.x1,l.positionX),s.x2=Math.max(s.x2,l.positionX),s.y1=Math.min(s.y1,l.positionY),s.y2=Math.max(s.y2,l.positionY)}),s.w=s.x2-s.x1,s.h=s.y2-s.y1),function(o,l){var u=e.layoutNodes[e.idToIndex[o.data("id")]];if(n.boundingBox){var c=s.w===0?.5:(u.positionX-s.x1)/s.w,h=s.h===0?.5:(u.positionY-s.y1)/s.h;return{x:a.x1+c*a.w,y:a.y1+h*a.h}}else return{x:u.positionX,y:u.positionY}}},II=function(e,n,i){var a=i.layout,s=i.eles.nodes(),o=KE(e,i,s);s.positions(o),e.ready!==!0&&(e.ready=!0,a.one("layoutready",i.ready),a.emit({type:"layoutready",layout:this}))},NI=function(e,n,i){FI(e,n),UI(e),VI(e,n),OI(e),LI(e)},FI=function(e,n){for(var i=0;i<e.graphSet.length;i++)for(var a=e.graphSet[i],s=a.length,o=0;o<s;o++)for(var l=e.layoutNodes[e.idToIndex[a[o]]],u=o+1;u<s;u++){var c=e.layoutNodes[e.idToIndex[a[u]]];kI(l,c,e,n)}},g3=function(e){return-1+2*e*Math.random()},kI=function(e,n,i,a){var s=e.cmptId,o=n.cmptId;if(!(s!==o&&!i.isCompound)){var l=n.positionX-e.positionX,u=n.positionY-e.positionY,c=1;l===0&&u===0&&(l=g3(c),u=g3(c));var h=PI(e,n,l,u);if(h>0)var d=a.nodeOverlap*h,v=Math.sqrt(l*l+u*u),m=d*l/v,y=d*u/v;else var b=Kd(e,l,u),x=Kd(n,-1*l,-1*u),A=x.x-b.x,C=x.y-b.y,E=A*A+C*C,v=Math.sqrt(E),d=(e.nodeRepulsion+n.nodeRepulsion)/E,m=d*A/v,y=d*C/v;e.isLocked||(e.offsetX-=m,e.offsetY-=y),n.isLocked||(n.offsetX+=m,n.offsetY+=y)}},PI=function(e,n,i,a){if(i>0)var s=e.maxX-n.minX;else var s=n.maxX-e.minX;if(a>0)var o=e.maxY-n.minY;else var o=n.maxY-e.minY;return s>=0&&o>=0?Math.sqrt(s*s+o*o):0},Kd=function(e,n,i){var a=e.positionX,s=e.positionY,o=e.height||1,l=e.width||1,u=i/n,c=o/l,h={};return n===0&&0<i||n===0&&0>i?(h.x=a,h.y=s+o/2,h):0<n&&-1*c<=u&&u<=c?(h.x=a+l/2,h.y=s+l*i/2/n,h):0>n&&-1*c<=u&&u<=c?(h.x=a-l/2,h.y=s-l*i/2/n,h):0<i&&(u<=-1*c||u>=c)?(h.x=a+o*n/2/i,h.y=s+o/2,h):(0>i&&(u<=-1*c||u>=c)&&(h.x=a-o*n/2/i,h.y=s-o/2),h)},UI=function(e,n){for(var i=0;i<e.edgeSize;i++){var a=e.layoutEdges[i],s=e.idToIndex[a.sourceId],o=e.layoutNodes[s],l=e.idToIndex[a.targetId],u=e.layoutNodes[l],c=u.positionX-o.positionX,h=u.positionY-o.positionY;if(!(c===0&&h===0)){var d=Kd(o,c,h),v=Kd(u,-1*c,-1*h),m=v.x-d.x,y=v.y-d.y,b=Math.sqrt(m*m+y*y),x=Math.pow(a.idealLength-b,2)/a.elasticity;if(b!==0)var A=x*m/b,C=x*y/b;else var A=0,C=0;o.isLocked||(o.offsetX+=A,o.offsetY+=C),u.isLocked||(u.offsetX-=A,u.offsetY-=C)}}},VI=function(e,n){if(n.gravity!==0)for(var i=1,a=0;a<e.graphSet.length;a++){var s=e.graphSet[a],o=s.length;if(a===0)var l=e.clientHeight/2,u=e.clientWidth/2;else var c=e.layoutNodes[e.idToIndex[s[0]]],h=e.layoutNodes[e.idToIndex[c.parentId]],l=h.positionX,u=h.positionY;for(var d=0;d<o;d++){var v=e.layoutNodes[e.idToIndex[s[d]]];if(!v.isLocked){var m=l-v.positionX,y=u-v.positionY,b=Math.sqrt(m*m+y*y);if(b>i){var x=n.gravity*m/b,A=n.gravity*y/b;v.offsetX+=x,v.offsetY+=A}}}}},OI=function(e,n){var i=[],a=0,s=-1;for(i.push.apply(i,e.graphSet[0]),s+=e.graphSet[0].length;a<=s;){var o=i[a++],l=e.idToIndex[o],u=e.layoutNodes[l],c=u.children;if(0<c.length&&!u.isLocked){for(var h=u.offsetX,d=u.offsetY,v=0;v<c.length;v++){var m=e.layoutNodes[e.idToIndex[c[v]]];m.offsetX+=h,m.offsetY+=d,i[++s]=c[v]}u.offsetX=0,u.offsetY=0}}},LI=function(e,n){for(var i=0;i<e.nodeSize;i++){var a=e.layoutNodes[i];0<a.children.length&&(a.maxX=void 0,a.minX=void 0,a.maxY=void 0,a.minY=void 0)}for(var i=0;i<e.nodeSize;i++){var a=e.layoutNodes[i];if(!(0<a.children.length||a.isLocked)){var s=_I(a.offsetX,a.offsetY,e.temperature);a.positionX+=s.x,a.positionY+=s.y,a.offsetX=0,a.offsetY=0,a.minX=a.positionX-a.width,a.maxX=a.positionX+a.width,a.minY=a.positionY-a.height,a.maxY=a.positionY+a.height,XE(a,e)}}for(var i=0;i<e.nodeSize;i++){var a=e.layoutNodes[i];0<a.children.length&&!a.isLocked&&(a.positionX=(a.maxX+a.minX)/2,a.positionY=(a.maxY+a.minY)/2,a.width=a.maxX-a.minX,a.height=a.maxY-a.minY)}},_I=function(e,n,i){var a=Math.sqrt(e*e+n*n);if(a>i)var s={x:i*e/a,y:i*n/a};else var s={x:e,y:n};return s},XE=function(e,n){var i=e.parentId;if(i!=null){var a=n.layoutNodes[n.idToIndex[i]],s=!1;if((a.maxX==null||e.maxX+a.padRight>a.maxX)&&(a.maxX=e.maxX+a.padRight,s=!0),(a.minX==null||e.minX-a.padLeft<a.minX)&&(a.minX=e.minX-a.padLeft,s=!0),(a.maxY==null||e.maxY+a.padBottom>a.maxY)&&(a.maxY=e.maxY+a.padBottom,s=!0),(a.minY==null||e.minY-a.padTop<a.minY)&&(a.minY=e.minY-a.padTop,s=!0),s)return XE(a,n)}},v3=function(e,n){for(var i=e.layoutNodes,a=[],s=0;s<i.length;s++){var o=i[s],l=o.cmptId,u=a[l]=a[l]||[];u.push(o)}for(var c=0,s=0;s<a.length;s++){var h=a[s];if(h){h.x1=1/0,h.x2=-1/0,h.y1=1/0,h.y2=-1/0;for(var d=0;d<h.length;d++){var v=h[d];h.x1=Math.min(h.x1,v.positionX-v.width/2),h.x2=Math.max(h.x2,v.positionX+v.width/2),h.y1=Math.min(h.y1,v.positionY-v.height/2),h.y2=Math.max(h.y2,v.positionY+v.height/2)}h.w=h.x2-h.x1,h.h=h.y2-h.y1,c+=h.w*h.h}}a.sort(function(C,E){return E.w*E.h-C.w*C.h});for(var m=0,y=0,b=0,x=0,A=Math.sqrt(c)*e.clientWidth/e.clientHeight,s=0;s<a.length;s++){var h=a[s];if(h){for(var d=0;d<h.length;d++){var v=h[d];v.isLocked||(v.positionX+=m-h.x1,v.positionY+=y-h.y1)}m+=h.w+n.componentSpacing,b+=h.w+n.componentSpacing,x=Math.max(x,h.h),b>A&&(y+=x+n.componentSpacing,m=0,b=0,x=0)}}},zI={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function QE(r){this.options=et({},zI,r)}QE.prototype.run=function(){var r=this.options,e=r,n=r.cy,i=e.eles,a=i.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));var s=yn(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});if(s.h===0||s.w===0)i.nodes().layoutPositions(this,e,function(J){return{x:s.x1,y:s.y1}});else{var o=a.size(),l=Math.sqrt(o*s.h/s.w),u=Math.round(l),c=Math.round(s.w/s.h*l),h=function(ee){if(ee==null)return Math.min(u,c);var ne=Math.min(u,c);ne==u?u=ee:c=ee},d=function(ee){if(ee==null)return Math.max(u,c);var ne=Math.max(u,c);ne==u?u=ee:c=ee},v=e.rows,m=e.cols!=null?e.cols:e.columns;if(v!=null&&m!=null)u=v,c=m;else if(v!=null&&m==null)u=v,c=Math.ceil(o/u);else if(v==null&&m!=null)c=m,u=Math.ceil(o/c);else if(c*u>o){var y=h(),b=d();(y-1)*b>=o?h(y-1):(b-1)*y>=o&&d(b-1)}else for(;c*u<o;){var x=h(),A=d();(A+1)*x>=o?d(A+1):h(x+1)}var C=s.w/c,E=s.h/u;if(e.condense&&(C=0,E=0),e.avoidOverlap)for(var S=0;S<a.length;S++){var T=a[S],R=T._private.position;(R.x==null||R.y==null)&&(R.x=0,R.y=0);var D=T.layoutDimensions(e),B=e.avoidOverlapPadding,N=D.w+B,I=D.h+B;C=Math.max(C,N),E=Math.max(E,I)}for(var P={},F=function(ee,ne){return!!P["c-"+ee+"-"+ne]},O=function(ee,ne){P["c-"+ee+"-"+ne]=!0},U=0,L=0,V=function(){L++,L>=c&&(L=0,U++)},_={},G=0;G<a.length;G++){var K=a[G],z=e.position(K);if(z&&(z.row!==void 0||z.col!==void 0)){var Y={row:z.row,col:z.col};if(Y.col===void 0)for(Y.col=0;F(Y.row,Y.col);)Y.col++;else if(Y.row===void 0)for(Y.row=0;F(Y.row,Y.col);)Y.row++;_[K.id()]=Y,O(Y.row,Y.col)}}var Z=function(ee,ne){var oe,me;if(ee.locked()||ee.isParent())return!1;var ye=_[ee.id()];if(ye)oe=ye.col*C+C/2+s.x1,me=ye.row*E+E/2+s.y1;else{for(;F(U,L);)V();oe=L*C+C/2+s.x1,me=U*E+E/2+s.y1,O(U,L),V()}return{x:oe,y:me}};a.layoutPositions(this,e,Z)}return this};var qI={ready:function(){},stop:function(){}};function M2(r){this.options=et({},qI,r)}M2.prototype.run=function(){var r=this.options,e=r.eles,n=this;return r.cy,n.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),n.one("layoutready",r.ready),n.emit("layoutready"),n.one("layoutstop",r.stop),n.emit("layoutstop"),this};M2.prototype.stop=function(){return this};var GI={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function WE(r){this.options=et({},GI,r)}WE.prototype.run=function(){var r=this.options,e=r.eles,n=e.nodes(),i=gr(r.positions);function a(s){if(r.positions==null)return fR(s.position());if(i)return r.positions(s);var o=r.positions[s._private.data.id];return o??null}return n.layoutPositions(this,r,function(s,o){var l=a(s);return s.locked()||l==null?!1:l}),this};var YI={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function ZE(r){this.options=et({},YI,r)}ZE.prototype.run=function(){var r=this.options,e=r.cy,n=r.eles,i=yn(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),a=function(o,l){return{x:i.x1+Math.round(Math.random()*i.w),y:i.y1+Math.round(Math.random()*i.h)}};return n.nodes().layoutPositions(this,r,a),this};var HI=[{name:"breadthfirst",impl:GE},{name:"circle",impl:YE},{name:"concentric",impl:HE},{name:"cose",impl:D0},{name:"grid",impl:QE},{name:"null",impl:M2},{name:"preset",impl:WE},{name:"random",impl:ZE}];function JE(r){this.options=r,this.notifications=0}var m3=function(){},p3=function(){throw new Error("A headless instance can not render images")};JE.prototype={recalculateRenderedStyle:m3,notify:function(){this.notifications++},init:m3,isHeadless:function(){return!0},png:p3,jpg:p3};var D2={};D2.arrowShapeWidth=.3;D2.registerArrowShapes=function(){var r=this.arrowShapes={},e=this,n=function(c,h,d,v,m,y,b){var x=m.x-d/2-b,A=m.x+d/2+b,C=m.y-d/2-b,E=m.y+d/2+b,S=x<=c&&c<=A&&C<=h&&h<=E;return S},i=function(c,h,d,v,m){var y=c*Math.cos(v)-h*Math.sin(v),b=c*Math.sin(v)+h*Math.cos(v),x=y*d,A=b*d,C=x+m.x,E=A+m.y;return{x:C,y:E}},a=function(c,h,d,v){for(var m=[],y=0;y<c.length;y+=2){var b=c[y],x=c[y+1];m.push(i(b,x,h,d,v))}return m},s=function(c){for(var h=[],d=0;d<c.length;d++){var v=c[d];h.push(v.x,v.y)}return h},o=function(c){return c.pstyle("width").pfValue*c.pstyle("arrow-scale").pfValue*2},l=function(c,h){Je(h)&&(h=r[h]),r[c]=et({name:c,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(v,m,y,b,x,A){var C=s(a(this.points,y+2*A,b,x)),E=Rn(v,m,C);return E},roughCollide:n,draw:function(v,m,y,b){var x=a(this.points,m,y,b);e.arrowShapeImpl("polygon")(v,x)},spacing:function(v){return 0},gap:o},h)};l("none",{collide:zd,roughCollide:zd,draw:d2,spacing:Iw,gap:Iw}),l("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),l("arrow","triangle"),l("triangle-backcurve",{points:r.triangle.points,controlPoint:[0,-.15],roughCollide:n,draw:function(c,h,d,v,m){var y=a(this.points,h,d,v),b=this.controlPoint,x=i(b[0],b[1],h,d,v);e.arrowShapeImpl(this.name)(c,y,x)},gap:function(c){return o(c)*.8}}),l("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(c,h,d,v,m,y,b){var x=s(a(this.points,d+2*b,v,m)),A=s(a(this.pointsTee,d+2*b,v,m)),C=Rn(c,h,x)||Rn(c,h,A);return C},draw:function(c,h,d,v,m){var y=a(this.points,h,d,v),b=a(this.pointsTee,h,d,v);e.arrowShapeImpl(this.name)(c,y,b)}}),l("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(c,h,d,v,m,y,b){var x=m,A=Math.pow(x.x-c,2)+Math.pow(x.y-h,2)<=Math.pow((d+2*b)*this.radius,2),C=s(a(this.points,d+2*b,v,m));return Rn(c,h,C)||A},draw:function(c,h,d,v,m){var y=a(this.pointsTr,h,d,v);e.arrowShapeImpl(this.name)(c,y,v.x,v.y,this.radius*h)},spacing:function(c){return e.getArrowWidth(c.pstyle("width").pfValue,c.pstyle("arrow-scale").value)*this.radius}}),l("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(c,h){var d=this.baseCrossLinePts.slice(),v=h/c,m=3,y=5;return d[m]=d[m]-v,d[y]=d[y]-v,d},collide:function(c,h,d,v,m,y,b){var x=s(a(this.points,d+2*b,v,m)),A=s(a(this.crossLinePts(d,y),d+2*b,v,m)),C=Rn(c,h,x)||Rn(c,h,A);return C},draw:function(c,h,d,v,m){var y=a(this.points,h,d,v),b=a(this.crossLinePts(h,m),h,d,v);e.arrowShapeImpl(this.name)(c,y,b)}}),l("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(c){return o(c)*.525}}),l("circle",{radius:.15,collide:function(c,h,d,v,m,y,b){var x=m,A=Math.pow(x.x-c,2)+Math.pow(x.y-h,2)<=Math.pow((d+2*b)*this.radius,2);return A},draw:function(c,h,d,v,m){e.arrowShapeImpl(this.name)(c,v.x,v.y,this.radius*h)},spacing:function(c){return e.getArrowWidth(c.pstyle("width").pfValue,c.pstyle("arrow-scale").value)*this.radius}}),l("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(c){return 1},gap:function(c){return 1}}),l("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),l("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(c){return c.pstyle("width").pfValue*c.pstyle("arrow-scale").value}}),l("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(c){return .95*c.pstyle("width").pfValue*c.pstyle("arrow-scale").value}})};var xo={};xo.projectIntoViewport=function(r,e){var n=this.cy,i=this.findContainerClientCoords(),a=i[0],s=i[1],o=i[4],l=n.pan(),u=n.zoom(),c=((r-a)/o-l.x)/u,h=((e-s)/o-l.y)/u;return[c,h]};xo.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var r=this.container,e=r.getBoundingClientRect(),n=this.cy.window().getComputedStyle(r),i=function(A){return parseFloat(n.getPropertyValue(A))},a={left:i("padding-left"),right:i("padding-right"),top:i("padding-top"),bottom:i("padding-bottom")},s={left:i("border-left-width"),right:i("border-right-width"),top:i("border-top-width"),bottom:i("border-bottom-width")},o=r.clientWidth,l=r.clientHeight,u=a.left+a.right,c=a.top+a.bottom,h=s.left+s.right,d=e.width/(o+h),v=o-u,m=l-c,y=e.left+a.left+s.left,b=e.top+a.top+s.top;return this.containerBB=[y,b,v,m,d]};xo.invalidateContainerClientCoordsCache=function(){this.containerBB=null};xo.findNearestElement=function(r,e,n,i){return this.findNearestElements(r,e,n,i)[0]};xo.findNearestElements=function(r,e,n,i){var a=this,s=this,o=s.getCachedZSortedEles(),l=[],u=s.cy.zoom(),c=s.cy.hasCompoundNodes(),h=(i?24:8)/u,d=(i?8:2)/u,v=(i?8:2)/u,m=1/0,y,b;n&&(o=o.interactive);function x(D,B){if(D.isNode()){if(b)return;b=D,l.push(D)}if(D.isEdge()&&(B==null||B<m))if(y){if(y.pstyle("z-compound-depth").value===D.pstyle("z-compound-depth").value&&y.pstyle("z-compound-depth").value===D.pstyle("z-compound-depth").value){for(var N=0;N<l.length;N++)if(l[N].isEdge()){l[N]=D,y=D,m=B??m;break}}}else l.push(D),y=D,m=B??m}function A(D){var B=D.outerWidth()+2*d,N=D.outerHeight()+2*d,I=B/2,P=N/2,F=D.position(),O=D.pstyle("corner-radius").value==="auto"?"auto":D.pstyle("corner-radius").pfValue,U=D._private.rscratch;if(F.x-I<=r&&r<=F.x+I&&F.y-P<=e&&e<=F.y+P){var L=s.nodeShapes[a.getNodeShape(D)];if(L.checkPoint(r,e,0,B,N,F.x,F.y,O,U))return x(D,0),!0}}function C(D){var B=D._private,N=B.rscratch,I=D.pstyle("width").pfValue,P=D.pstyle("arrow-scale").value,F=I/2+h,O=F*F,U=F*2,G=B.source,K=B.target,L;if(N.edgeType==="segments"||N.edgeType==="straight"||N.edgeType==="haystack"){for(var V=N.allpts,_=0;_+3<V.length;_+=2)if(SR(r,e,V[_],V[_+1],V[_+2],V[_+3],U)&&O>(L=BR(r,e,V[_],V[_+1],V[_+2],V[_+3])))return x(D,L),!0}else if(N.edgeType==="bezier"||N.edgeType==="multibezier"||N.edgeType==="self"||N.edgeType==="compound"){for(var V=N.allpts,_=0;_+5<N.allpts.length;_+=4)if(TR(r,e,V[_],V[_+1],V[_+2],V[_+3],V[_+4],V[_+5],U)&&O>(L=RR(r,e,V[_],V[_+1],V[_+2],V[_+3],V[_+4],V[_+5])))return x(D,L),!0}for(var G=G||B.source,K=K||B.target,z=a.getArrowWidth(I,P),Y=[{name:"source",x:N.arrowStartX,y:N.arrowStartY,angle:N.srcArrowAngle},{name:"target",x:N.arrowEndX,y:N.arrowEndY,angle:N.tgtArrowAngle},{name:"mid-source",x:N.midX,y:N.midY,angle:N.midsrcArrowAngle},{name:"mid-target",x:N.midX,y:N.midY,angle:N.midtgtArrowAngle}],_=0;_<Y.length;_++){var Z=Y[_],J=s.arrowShapes[D.pstyle(Z.name+"-arrow-shape").value],ee=D.pstyle("width").pfValue;if(J.roughCollide(r,e,z,Z.angle,{x:Z.x,y:Z.y},ee,h)&&J.collide(r,e,z,Z.angle,{x:Z.x,y:Z.y},ee,h))return x(D),!0}c&&l.length>0&&(A(G),A(K))}function E(D,B,N){return Dn(D,B,N)}function S(D,B){var N=D._private,I=v,P;B?P=B+"-":P="",D.boundingBox();var F=N.labelBounds[B||"main"],O=D.pstyle(P+"label").value,U=D.pstyle("text-events").strValue==="yes";if(!(!U||!O)){var L=E(N.rscratch,"labelX",B),V=E(N.rscratch,"labelY",B),_=E(N.rscratch,"labelAngle",B),G=D.pstyle(P+"text-margin-x").pfValue,K=D.pstyle(P+"text-margin-y").pfValue,z=F.x1-I-G,Y=F.x2+I-G,Z=F.y1-I-K,J=F.y2+I-K;if(_){var ee=Math.cos(_),ne=Math.sin(_),oe=function(Ae,Re){return Ae=Ae-L,Re=Re-V,{x:Ae*ee-Re*ne+L,y:Ae*ne+Re*ee+V}},me=oe(z,Z),ye=oe(z,J),ve=oe(Y,Z),re=oe(Y,J),ae=[me.x+G,me.y+K,ve.x+G,ve.y+K,re.x+G,re.y+K,ye.x+G,ye.y+K];if(Rn(r,e,ae))return x(D),!0}else if(cs(F,r,e))return x(D),!0}}for(var T=o.length-1;T>=0;T--){var R=o[T];R.isNode()?A(R)||S(R):C(R)||S(R)||S(R,"source")||S(R,"target")}return l};xo.getAllInBox=function(r,e,n,i){var a=this.getCachedZSortedEles().interactive,s=this.cy.zoom(),o=2/s,l=[],u=Math.min(r,n),c=Math.max(r,n),h=Math.min(e,i),d=Math.max(e,i);r=u,n=c,e=h,i=d;var v=yn({x1:r,y1:e,x2:n,y2:i}),m=[{x:v.x1,y:v.y1},{x:v.x2,y:v.y1},{x:v.x2,y:v.y2},{x:v.x1,y:v.y2}],y=[[m[0],m[1]],[m[1],m[2]],[m[2],m[3]],[m[3],m[0]]];function b(Ae,Re,Le){return Dn(Ae,Re,Le)}function x(Ae,Re){var Le=Ae._private,bt=o,He="";Ae.boundingBox();var $e=Le.labelBounds.main;if(!$e)return null;var Ze=b(Le.rscratch,"labelX",Re),Ie=b(Le.rscratch,"labelY",Re),_e=b(Le.rscratch,"labelAngle",Re),je=Ae.pstyle(He+"text-margin-x").pfValue,it=Ae.pstyle(He+"text-margin-y").pfValue,Xe=$e.x1-bt-je,ht=$e.x2+bt-je,vt=$e.y1-bt-it,ot=$e.y2+bt-it;if(_e){var pt=Math.cos(_e),lt=Math.sin(_e),at=function(be,X){return be=be-Ze,X=X-Ie,{x:be*pt-X*lt+Ze,y:be*lt+X*pt+Ie}};return[at(Xe,vt),at(ht,vt),at(ht,ot),at(Xe,ot)]}else return[{x:Xe,y:vt},{x:ht,y:vt},{x:ht,y:ot},{x:Xe,y:ot}]}function A(Ae,Re,Le,bt){function He($e,Ze,Ie){return(Ie.y-$e.y)*(Ze.x-$e.x)>(Ze.y-$e.y)*(Ie.x-$e.x)}return He(Ae,Le,bt)!==He(Re,Le,bt)&&He(Ae,Re,Le)!==He(Ae,Re,bt)}for(var C=0;C<a.length;C++){var E=a[C];if(E.isNode()){var S=E,T=S.pstyle("text-events").strValue==="yes",R=S.pstyle("box-selection").strValue,D=S.pstyle("box-select-labels").strValue==="yes";if(R==="none")continue;var B=(R==="overlap"||D)&&T,N=S.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:B});if(R==="contain"){var I=!1;if(D&&T){var P=x(S);P&&E1(P,m)&&(l.push(S),I=!0)}!I&&aE(v,N)&&l.push(S)}else if(R==="overlap"&&p2(v,N)){var F=S.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),O=[{x:F.x1,y:F.y1},{x:F.x2,y:F.y1},{x:F.x2,y:F.y2},{x:F.x1,y:F.y2}];if(E1(O,m))l.push(S);else{var U=x(S);U&&E1(U,m)&&l.push(S)}}}else{var L=E,V=L._private,_=V.rscratch,G=L.pstyle("box-selection").strValue;if(G==="none")continue;if(G==="contain"){if(_.startX!=null&&_.startY!=null&&!cs(v,_.startX,_.startY)||_.endX!=null&&_.endY!=null&&!cs(v,_.endX,_.endY))continue;if(_.edgeType==="bezier"||_.edgeType==="multibezier"||_.edgeType==="self"||_.edgeType==="compound"||_.edgeType==="segments"||_.edgeType==="haystack"){for(var K=V.rstyle.bezierPts||V.rstyle.linePts||V.rstyle.haystackPts,z=!0,Y=0;Y<K.length;Y++)if(!Uw(v,K[Y])){z=!1;break}z&&l.push(L)}else _.edgeType==="straight"&&l.push(L)}else if(G==="overlap"){var Z=!1;if(_.startX!=null&&_.startY!=null&&_.endX!=null&&_.endY!=null&&(cs(v,_.startX,_.startY)||cs(v,_.endX,_.endY)))l.push(L),Z=!0;else if(!Z&&_.edgeType==="haystack"){for(var J=V.rstyle.haystackPts,ee=0;ee<J.length;ee++)if(Uw(v,J[ee])){l.push(L),Z=!0;break}}if(!Z){var ne=V.rstyle.bezierPts||V.rstyle.linePts||V.rstyle.haystackPts;if((!ne||ne.length<2)&&_.edgeType==="straight"&&_.startX!=null&&_.startY!=null&&_.endX!=null&&_.endY!=null&&(ne=[{x:_.startX,y:_.startY},{x:_.endX,y:_.endY}]),!ne||ne.length<2)continue;for(var oe=0;oe<ne.length-1;oe++){for(var me=ne[oe],ye=ne[oe+1],ve=0;ve<y.length;ve++){var re=Rr(y[ve],2),ae=re[0],le=re[1];if(A(me,ye,ae,le)){l.push(L),Z=!0;break}}if(Z)break}}}}}return l};var Xd={};Xd.calculateArrowAngles=function(r){var e=r._private.rscratch,n=e.edgeType==="haystack",i=e.edgeType==="bezier",a=e.edgeType==="multibezier",s=e.edgeType==="segments",o=e.edgeType==="compound",l=e.edgeType==="self",u,c,h,d,v,m,A,C;if(n?(h=e.haystackPts[0],d=e.haystackPts[1],v=e.haystackPts[2],m=e.haystackPts[3]):(h=e.arrowStartX,d=e.arrowStartY,v=e.arrowEndX,m=e.arrowEndY),A=e.midX,C=e.midY,s)u=h-e.segpts[0],c=d-e.segpts[1];else if(a||o||l||i){var y=e.allpts,b=zr(y[0],y[2],y[4],.1),x=zr(y[1],y[3],y[5],.1);u=h-b,c=d-x}else u=h-A,c=d-C;e.srcArrowAngle=Fh(u,c);var A=e.midX,C=e.midY;if(n&&(A=(h+v)/2,C=(d+m)/2),u=v-h,c=m-d,s){var y=e.allpts;if(y.length/2%2===0){var E=y.length/2,S=E-2;u=y[E]-y[S],c=y[E+1]-y[S+1]}else if(e.isRound)u=e.midVector[1],c=-e.midVector[0];else{var E=y.length/2-1,S=E-2;u=y[E]-y[S],c=y[E+1]-y[S+1]}}else if(a||o||l){var y=e.allpts,T=e.ctrlpts,R,D,B,N;if(T.length/2%2===0){var I=y.length/2-1,P=I+2,F=P+2;R=zr(y[I],y[P],y[F],0),D=zr(y[I+1],y[P+1],y[F+1],0),B=zr(y[I],y[P],y[F],1e-4),N=zr(y[I+1],y[P+1],y[F+1],1e-4)}else{var P=y.length/2-1,I=P-2,F=P+2;R=zr(y[I],y[P],y[F],.4999),D=zr(y[I+1],y[P+1],y[F+1],.4999),B=zr(y[I],y[P],y[F],.5),N=zr(y[I+1],y[P+1],y[F+1],.5)}u=B-R,c=N-D}if(e.midtgtArrowAngle=Fh(u,c),e.midDispX=u,e.midDispY=c,u*=-1,c*=-1,s){var y=e.allpts;if(y.length/2%2!==0){if(!e.isRound){var E=y.length/2-1,O=E+2;u=-(y[O]-y[E]),c=-(y[O+1]-y[E+1])}}}if(e.midsrcArrowAngle=Fh(u,c),s)u=v-e.segpts[e.segpts.length-2],c=m-e.segpts[e.segpts.length-1];else if(a||o||l||i){var y=e.allpts,U=y.length,b=zr(y[U-6],y[U-4],y[U-2],.9),x=zr(y[U-5],y[U-3],y[U-1],.9);u=v-b,c=m-x}else u=v-A,c=m-C;e.tgtArrowAngle=Fh(u,c)};Xd.getArrowWidth=Xd.getArrowHeight=function(r,e){var n=this.arrowWidthCache=this.arrowWidthCache||{},i=n[r+", "+e];return i||(i=Math.max(Math.pow(r*13.37,.9),29)*e,n[r+", "+e]=i,i)};var wp,Cp,Vi={},ii={},y3,A3,eo,wd,fa,js,Js,Pi,hl,zh,$E,eS,Ep,Sp,x3,b3=function(e,n,i){i.x=n.x-e.x,i.y=n.y-e.y,i.len=Math.sqrt(i.x*i.x+i.y*i.y),i.nx=i.x/i.len,i.ny=i.y/i.len,i.ang=Math.atan2(i.ny,i.nx)},jI=function(e,n){n.x=e.x*-1,n.y=e.y*-1,n.nx=e.nx*-1,n.ny=e.ny*-1,n.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},KI=function(e,n,i,a,s){if(e!==x3?b3(n,e,Vi):jI(ii,Vi),b3(n,i,ii),y3=Vi.nx*ii.ny-Vi.ny*ii.nx,A3=Vi.nx*ii.nx-Vi.ny*-ii.ny,fa=Math.asin(Math.max(-1,Math.min(1,y3))),Math.abs(fa)<1e-6){wp=n.x,Cp=n.y,Js=hl=0;return}eo=1,wd=!1,A3<0?fa<0?fa=Math.PI+fa:(fa=Math.PI-fa,eo=-1,wd=!0):fa>0&&(eo=-1,wd=!0),n.radius!==void 0?hl=n.radius:hl=a,js=fa/2,zh=Math.min(Vi.len/2,ii.len/2),s?(Pi=Math.abs(Math.cos(js)*hl/Math.sin(js)),Pi>zh?(Pi=zh,Js=Math.abs(Pi*Math.sin(js)/Math.cos(js))):Js=hl):(Pi=Math.min(zh,hl),Js=Math.abs(Pi*Math.sin(js)/Math.cos(js))),Ep=n.x+ii.nx*Pi,Sp=n.y+ii.ny*Pi,wp=Ep-ii.ny*Js*eo,Cp=Sp+ii.nx*Js*eo,$E=n.x+Vi.nx*Pi,eS=n.y+Vi.ny*Pi,x3=n};function tS(r,e){e.radius===0?r.lineTo(e.cx,e.cy):r.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function R2(r,e,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return i===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(KI(r,e,n,i,a),{cx:wp,cy:Cp,radius:Js,startX:$E,startY:eS,stopX:Ep,stopY:Sp,startAngle:Vi.ang+Math.PI/2*eo,endAngle:ii.ang-Math.PI/2*eo,counterClockwise:wd})}var Gc=.01,XI=Math.sqrt(2*Gc),ln={};ln.findMidptPtsEtc=function(r,e){var n=e.posPts,i=e.intersectionPts,a=e.vectorNormInverse,s,o=r.pstyle("source-endpoint"),l=r.pstyle("target-endpoint"),u=o.units!=null&&l.units!=null,c=function(T,R,D,B){var N=B-R,I=D-T,P=Math.sqrt(I*I+N*N);return{x:-N/P,y:I/P}},h=r.pstyle("edge-distances").value;switch(h){case"node-position":s=n;break;case"intersection":s=i;break;case"endpoints":{if(u){var d=this.manualEndptToPx(r.source()[0],o),v=Rr(d,2),m=v[0],y=v[1],b=this.manualEndptToPx(r.target()[0],l),x=Rr(b,2),A=x[0],C=x[1],E={x1:m,y1:y,x2:A,y2:C};a=c(m,y,A,C),s=E}else Lt("Edge ".concat(r.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),s=i;break}}return{midptPts:s,vectorNormInverse:a}};ln.findHaystackPoints=function(r){for(var e=0;e<r.length;e++){var n=r[e],i=n._private,a=i.rscratch;if(!a.haystack){var s=Math.random()*2*Math.PI;a.source={x:Math.cos(s),y:Math.sin(s)},s=Math.random()*2*Math.PI,a.target={x:Math.cos(s),y:Math.sin(s)}}var o=i.source,l=i.target,u=o.position(),c=l.position(),h=o.width(),d=l.width(),v=o.height(),m=l.height(),y=n.pstyle("haystack-radius").value,b=y/2;a.haystackPts=a.allpts=[a.source.x*h*b+u.x,a.source.y*v*b+u.y,a.target.x*d*b+c.x,a.target.y*m*b+c.y],a.midX=(a.allpts[0]+a.allpts[2])/2,a.midY=(a.allpts[1]+a.allpts[3])/2,a.edgeType="haystack",a.haystack=!0,this.storeEdgeProjections(n),this.calculateArrowAngles(n),this.recalculateEdgeLabelProjections(n),this.calculateLabelAngles(n)}};ln.findSegmentsPoints=function(r,e){var n=r._private.rscratch,i=r.pstyle("segment-weights"),a=r.pstyle("segment-distances"),s=r.pstyle("segment-radii"),o=r.pstyle("radius-type"),l=Math.min(i.pfValue.length,a.pfValue.length),u=s.pfValue[s.pfValue.length-1],c=o.pfValue[o.pfValue.length-1];n.edgeType="segments",n.segpts=[],n.radii=[],n.isArcRadius=[];for(var h=0;h<l;h++){var d=i.pfValue[h],v=a.pfValue[h],m=1-d,y=d,b=this.findMidptPtsEtc(r,e),x=b.midptPts,A=b.vectorNormInverse,C={x:x.x1*m+x.x2*y,y:x.y1*m+x.y2*y};n.segpts.push(C.x+A.x*v,C.y+A.y*v),n.radii.push(s.pfValue[h]!==void 0?s.pfValue[h]:u),n.isArcRadius.push((o.pfValue[h]!==void 0?o.pfValue[h]:c)==="arc-radius")}};ln.findLoopPoints=function(r,e,n,i){var a=r._private.rscratch,s=e.dirCounts,o=e.srcPos,l=r.pstyle("control-point-distances"),u=l?l.pfValue[0]:void 0,c=r.pstyle("loop-direction").pfValue,h=r.pstyle("loop-sweep").pfValue,d=r.pstyle("control-point-step-size").pfValue;a.edgeType="self";var v=n,m=d;i&&(v=0,m=u);var y=c-Math.PI/2,b=y-h/2,x=y+h/2,A=c+"_"+h;v=s[A]===void 0?s[A]=0:++s[A],a.ctrlpts=[o.x+Math.cos(b)*1.4*m*(v/3+1),o.y+Math.sin(b)*1.4*m*(v/3+1),o.x+Math.cos(x)*1.4*m*(v/3+1),o.y+Math.sin(x)*1.4*m*(v/3+1)]};ln.findCompoundLoopPoints=function(r,e,n,i){var a=r._private.rscratch;a.edgeType="compound";var s=e.srcPos,o=e.tgtPos,l=e.srcW,u=e.srcH,c=e.tgtW,h=e.tgtH,d=r.pstyle("control-point-step-size").pfValue,v=r.pstyle("control-point-distances"),m=v?v.pfValue[0]:void 0,y=n,b=d;i&&(y=0,b=m);var x=50,A={x:s.x-l/2,y:s.y-u/2},C={x:o.x-c/2,y:o.y-h/2},E={x:Math.min(A.x,C.x),y:Math.min(A.y,C.y)},S=.5,T=Math.max(S,Math.log(l*Gc)),R=Math.max(S,Math.log(c*Gc));a.ctrlpts=[E.x,E.y-(1+Math.pow(x,1.12)/100)*b*(y/3+1)*T,E.x-(1+Math.pow(x,1.12)/100)*b*(y/3+1)*R,E.y]};ln.findStraightEdgePoints=function(r){r._private.rscratch.edgeType="straight"};ln.findBezierPoints=function(r,e,n,i,a){var s=r._private.rscratch,o=r.pstyle("control-point-step-size").pfValue,l=r.pstyle("control-point-distances"),u=r.pstyle("control-point-weights"),c=l&&u?Math.min(l.value.length,u.value.length):1,h=l?l.pfValue[0]:void 0,d=u.value[0],v=i;s.edgeType=v?"multibezier":"bezier",s.ctrlpts=[];for(var m=0;m<c;m++){var y=(.5-e.eles.length/2+n)*o*(a?-1:1),b=void 0,x=m2(y);v&&(h=l?l.pfValue[m]:o,d=u.value[m]),i?b=h:b=h!==void 0?x*h:void 0;var A=b!==void 0?b:y,C=1-d,E=d,S=this.findMidptPtsEtc(r,e),T=S.midptPts,R=S.vectorNormInverse,D={x:T.x1*C+T.x2*E,y:T.y1*C+T.y2*E};s.ctrlpts.push(D.x+R.x*A,D.y+R.y*A)}};ln.findTaxiPoints=function(r,e){var n=r._private.rscratch;n.edgeType="segments";var i="vertical",a="horizontal",s="leftward",o="rightward",l="downward",u="upward",c="auto",h=e.posPts,d=e.srcW,v=e.srcH,m=e.tgtW,y=e.tgtH,b=r.pstyle("edge-distances").value,x=b!=="node-position",A=r.pstyle("taxi-direction").value,C=A,E=r.pstyle("taxi-turn"),S=E.units==="%",T=E.pfValue,R=T<0,D=r.pstyle("taxi-turn-min-distance").pfValue,B=x?(d+m)/2:0,N=x?(v+y)/2:0,I=h.x2-h.x1,P=h.y2-h.y1,F=function(X,ce){return X>0?Math.max(X-ce,0):Math.min(X+ce,0)},O=F(I,B),U=F(P,N),L=!1;C===c?A=Math.abs(O)>Math.abs(U)?a:i:C===u||C===l?(A=i,L=!0):(C===s||C===o)&&(A=a,L=!0);var V=A===i,_=V?U:O,G=V?P:I,K=m2(G),z=!1;!(L&&(S||R))&&(C===l&&G<0||C===u&&G>0||C===s&&G>0||C===o&&G<0)&&(K*=-1,_=K*Math.abs(_),z=!0);var Y;if(S){var Z=T<0?1+T:T;Y=Z*_}else{var J=T<0?_:0;Y=J+T*K}var ee=function(X){return Math.abs(X)<D||Math.abs(X)>=Math.abs(_)},ne=ee(Y),oe=ee(Math.abs(_)-Math.abs(Y)),me=ne||oe;if(me&&!z)if(V){var ye=Math.abs(G)<=v/2,ve=Math.abs(I)<=m/2;if(ye){var re=(h.x1+h.x2)/2,ae=h.y1,le=h.y2;n.segpts=[re,ae,re,le]}else if(ve){var Ae=(h.y1+h.y2)/2,Re=h.x1,Le=h.x2;n.segpts=[Re,Ae,Le,Ae]}else n.segpts=[h.x1,h.y2]}else{var bt=Math.abs(G)<=d/2,He=Math.abs(P)<=y/2;if(bt){var $e=(h.y1+h.y2)/2,Ze=h.x1,Ie=h.x2;n.segpts=[Ze,$e,Ie,$e]}else if(He){var _e=(h.x1+h.x2)/2,je=h.y1,it=h.y2;n.segpts=[_e,je,_e,it]}else n.segpts=[h.x2,h.y1]}else if(V){var Xe=h.y1+Y+(x?v/2*K:0),ht=h.x1,vt=h.x2;n.segpts=[ht,Xe,vt,Xe]}else{var ot=h.x1+Y+(x?d/2*K:0),pt=h.y1,lt=h.y2;n.segpts=[ot,pt,ot,lt]}if(n.isRound){var at=r.pstyle("taxi-radius").value,Pe=r.pstyle("radius-type").value[0]==="arc-radius";n.radii=new Array(n.segpts.length/2).fill(at),n.isArcRadius=new Array(n.segpts.length/2).fill(Pe)}};ln.tryToCorrectInvalidPoints=function(r,e){var n=r._private.rscratch;if(n.edgeType==="bezier"){var i=e.srcPos,a=e.tgtPos,s=e.srcW,o=e.srcH,l=e.tgtW,u=e.tgtH,c=e.srcShape,h=e.tgtShape,d=e.srcCornerRadius,v=e.tgtCornerRadius,m=e.srcRs,y=e.tgtRs,b=!Be(n.startX)||!Be(n.startY),x=!Be(n.arrowStartX)||!Be(n.arrowStartY),A=!Be(n.endX)||!Be(n.endY),C=!Be(n.arrowEndX)||!Be(n.arrowEndY),E=3,S=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth,T=E*S,R=fo({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.startX,y:n.startY}),D=R<T,B=fo({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.endX,y:n.endY}),N=B<T,I=!1;if(b||x||D){I=!0;var P={x:n.ctrlpts[0]-i.x,y:n.ctrlpts[1]-i.y},F=Math.sqrt(P.x*P.x+P.y*P.y),O={x:P.x/F,y:P.y/F},U=Math.max(s,o),L={x:n.ctrlpts[0]+O.x*2*U,y:n.ctrlpts[1]+O.y*2*U},V=c.intersectLine(i.x,i.y,s,o,L.x,L.y,0,d,m);D?(n.ctrlpts[0]=n.ctrlpts[0]+O.x*(T-R),n.ctrlpts[1]=n.ctrlpts[1]+O.y*(T-R)):(n.ctrlpts[0]=V[0]+O.x*T,n.ctrlpts[1]=V[1]+O.y*T)}if(A||C||N){I=!0;var _={x:n.ctrlpts[0]-a.x,y:n.ctrlpts[1]-a.y},G=Math.sqrt(_.x*_.x+_.y*_.y),K={x:_.x/G,y:_.y/G},z=Math.max(s,o),Y={x:n.ctrlpts[0]+K.x*2*z,y:n.ctrlpts[1]+K.y*2*z},Z=h.intersectLine(a.x,a.y,l,u,Y.x,Y.y,0,v,y);N?(n.ctrlpts[0]=n.ctrlpts[0]+K.x*(T-B),n.ctrlpts[1]=n.ctrlpts[1]+K.y*(T-B)):(n.ctrlpts[0]=Z[0]+K.x*T,n.ctrlpts[1]=Z[1]+K.y*T)}I&&this.findEndpoints(r)}};ln.storeAllpts=function(r){var e=r._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var n=0;n+1<e.ctrlpts.length;n+=2)e.allpts.push(e.ctrlpts[n],e.ctrlpts[n+1]),n+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[n]+e.ctrlpts[n+2])/2,(e.ctrlpts[n+1]+e.ctrlpts[n+3])/2);e.allpts.push(e.endX,e.endY);var i,a;e.ctrlpts.length/2%2===0?(i=e.allpts.length/2-1,e.midX=e.allpts[i],e.midY=e.allpts[i+1]):(i=e.allpts.length/2-3,a=.5,e.midX=zr(e.allpts[i],e.allpts[i+2],e.allpts[i+4],a),e.midY=zr(e.allpts[i+1],e.allpts[i+3],e.allpts[i+5],a))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var s=2;s+3<e.allpts.length;s+=2){var o=e.radii[s/2-1],l=e.isArcRadius[s/2-1];e.roundCorners.push(R2({x:e.allpts[s-2],y:e.allpts[s-1]},{x:e.allpts[s],y:e.allpts[s+1],radius:o},{x:e.allpts[s+2],y:e.allpts[s+3]},o,l))}}if(e.segpts.length%4===0){var u=e.segpts.length/2,c=u-2;e.midX=(e.segpts[c]+e.segpts[u])/2,e.midY=(e.segpts[c+1]+e.segpts[u+1])/2}else{var h=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[h],e.midY=e.segpts[h+1];else{var d={x:e.segpts[h],y:e.segpts[h+1]},v=e.roundCorners[h/2];if(v.radius===0){var m={x:e.segpts[h+2],y:e.segpts[h+3]};e.midX=d.x,e.midY=d.y,e.midVector=[d.y-m.y,m.x-d.x]}else{var y=[d.x-v.cx,d.y-v.cy],b=v.radius/Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2));y=y.map(function(x){return x*b}),e.midX=v.cx+y[0],e.midY=v.cy+y[1],e.midVector=y}}}}};ln.checkForInvalidEdgeWarning=function(r){var e=r[0]._private.rscratch;e.nodesOverlap||Be(e.startX)&&Be(e.startY)&&Be(e.endX)&&Be(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,Lt("Edge `"+r.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};ln.findEdgeControlPoints=function(r){var e=this;if(!(!r||r.length===0)){for(var n=this,i=n.cy,a=i.hasCompoundNodes(),s=new ya,o=function(N,I){return[].concat(Od(N),[I?1:0]).join("-")},l=[],u=[],c=0;c<r.length;c++){var h=r[c],d=h._private,v=h.pstyle("curve-style").value;if(!(h.removed()||!h.takesUpSpace())){if(v==="haystack"){u.push(h);continue}var m=v==="unbundled-bezier"||us(v,"segments")||v==="straight"||v==="straight-triangle"||us(v,"taxi"),y=v==="unbundled-bezier"||v==="bezier",b=d.source,x=d.target,A=b.poolIndex(),C=x.poolIndex(),E=[A,C].sort(),S=o(E,m),T=s.get(S);T==null&&(T={eles:[]},l.push({pairId:E,edgeIsUnbundled:m}),s.set(S,T)),T.eles.push(h),m&&(T.hasUnbundled=!0),y&&(T.hasBezier=!0)}}for(var R=function(){var N=l[D],I=N.pairId,P=N.edgeIsUnbundled,F=o(I,P),O=s.get(F),U;if(!O.hasUnbundled){var L=O.eles[0].parallelEdges().filter(function(Pe){return Pe.isBundledBezier()});g2(O.eles),L.forEach(function(Pe){return O.eles.push(Pe)}),O.eles.sort(function(Pe,be){return Pe.poolIndex()-be.poolIndex()})}var V=O.eles[0],_=V.source(),G=V.target();if(_.poolIndex()>G.poolIndex()){var K=_;_=G,G=K}var z=O.srcPos=_.position(),Y=O.tgtPos=G.position(),Z=O.srcW=_.outerWidth(),J=O.srcH=_.outerHeight(),ee=O.tgtW=G.outerWidth(),ne=O.tgtH=G.outerHeight(),oe=O.srcShape=n.nodeShapes[e.getNodeShape(_)],me=O.tgtShape=n.nodeShapes[e.getNodeShape(G)],ye=O.srcCornerRadius=_.pstyle("corner-radius").value==="auto"?"auto":_.pstyle("corner-radius").pfValue,ve=O.tgtCornerRadius=G.pstyle("corner-radius").value==="auto"?"auto":G.pstyle("corner-radius").pfValue,re=O.tgtRs=G._private.rscratch,ae=O.srcRs=_._private.rscratch;O.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var le=0;le<O.eles.length;le++){var Ae=O.eles[le],Re=Ae[0]._private.rscratch,Le=Ae.pstyle("curve-style").value,bt=Le==="unbundled-bezier"||us(Le,"segments")||us(Le,"taxi"),He=!_.same(Ae.source());if(!O.calculatedIntersection&&_!==G&&(O.hasBezier||O.hasUnbundled)){O.calculatedIntersection=!0;var $e=oe.intersectLine(z.x,z.y,Z,J,Y.x,Y.y,0,ye,ae),Ze=O.srcIntn=$e,Ie=me.intersectLine(Y.x,Y.y,ee,ne,z.x,z.y,0,ve,re),_e=O.tgtIntn=Ie,je=O.intersectionPts={x1:$e[0],x2:Ie[0],y1:$e[1],y2:Ie[1]},it=O.posPts={x1:z.x,x2:Y.x,y1:z.y,y2:Y.y},Xe=Ie[1]-$e[1],ht=Ie[0]-$e[0],vt=Math.sqrt(ht*ht+Xe*Xe);Be(vt)&&vt>=XI||(vt=Math.sqrt(Math.max(ht*ht,Gc)+Math.max(Xe*Xe,Gc)));var ot=O.vector={x:ht,y:Xe},pt=O.vectorNorm={x:ot.x/vt,y:ot.y/vt},lt={x:-pt.y,y:pt.x};O.nodesOverlap=!Be(vt)||me.checkPoint($e[0],$e[1],0,ee,ne,Y.x,Y.y,ve,re)||oe.checkPoint(Ie[0],Ie[1],0,Z,J,z.x,z.y,ye,ae),O.vectorNormInverse=lt,U={nodesOverlap:O.nodesOverlap,dirCounts:O.dirCounts,calculatedIntersection:!0,hasBezier:O.hasBezier,hasUnbundled:O.hasUnbundled,eles:O.eles,srcPos:Y,srcRs:re,tgtPos:z,tgtRs:ae,srcW:ee,srcH:ne,tgtW:Z,tgtH:J,srcIntn:_e,tgtIntn:Ze,srcShape:me,tgtShape:oe,posPts:{x1:it.x2,y1:it.y2,x2:it.x1,y2:it.y1},intersectionPts:{x1:je.x2,y1:je.y2,x2:je.x1,y2:je.y1},vector:{x:-ot.x,y:-ot.y},vectorNorm:{x:-pt.x,y:-pt.y},vectorNormInverse:{x:-lt.x,y:-lt.y}}}var at=He?U:O;Re.nodesOverlap=at.nodesOverlap,Re.srcIntn=at.srcIntn,Re.tgtIntn=at.tgtIntn,Re.isRound=Le.startsWith("round"),a&&(_.isParent()||_.isChild()||G.isParent()||G.isChild())&&(_.parents().anySame(G)||G.parents().anySame(_)||_.same(G)&&_.isParent())?e.findCompoundLoopPoints(Ae,at,le,bt):_===G?e.findLoopPoints(Ae,at,le,bt):Le.endsWith("segments")?e.findSegmentsPoints(Ae,at):Le.endsWith("taxi")?e.findTaxiPoints(Ae,at):Le==="straight"||!bt&&O.eles.length%2===1&&le===Math.floor(O.eles.length/2)?e.findStraightEdgePoints(Ae):e.findBezierPoints(Ae,at,le,bt,He),e.findEndpoints(Ae),e.tryToCorrectInvalidPoints(Ae,at),e.checkForInvalidEdgeWarning(Ae),e.storeAllpts(Ae),e.storeEdgeProjections(Ae),e.calculateArrowAngles(Ae),e.recalculateEdgeLabelProjections(Ae),e.calculateLabelAngles(Ae)}},D=0;D<l.length;D++)R();this.findHaystackPoints(u)}};function rS(r){var e=[];if(r!=null){for(var n=0;n<r.length;n+=2){var i=r[n],a=r[n+1];e.push({x:i,y:a})}return e}}ln.getSegmentPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var n=e.edgeType;if(n==="segments")return rS(e.segpts)};ln.getControlPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var n=e.edgeType;if(n==="bezier"||n==="multibezier"||n==="self"||n==="compound")return rS(e.ctrlpts)};ln.getEdgeMidpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),{x:e.midX,y:e.midY}};var uf={};uf.manualEndptToPx=function(r,e){var n=this,i=r.position(),a=r.outerWidth(),s=r.outerHeight(),o=r._private.rscratch;if(e.value.length===2){var l=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(l[0]=l[0]*a),e.units[1]==="%"&&(l[1]=l[1]*s),l[0]+=i.x,l[1]+=i.y,l}else{var u=e.pfValue[0];u=-Math.PI/2+u;var c=2*Math.max(a,s),h=[i.x+Math.cos(u)*c,i.y+Math.sin(u)*c];return n.nodeShapes[this.getNodeShape(r)].intersectLine(i.x,i.y,a,s,h[0],h[1],0,r.pstyle("corner-radius").value==="auto"?"auto":r.pstyle("corner-radius").pfValue,o)}};uf.findEndpoints=function(r){var e,n,i,a,s=this,o,l=r.source()[0],u=r.target()[0],c=l.position(),h=u.position(),d=r.pstyle("target-arrow-shape").value,v=r.pstyle("source-arrow-shape").value,m=r.pstyle("target-distance-from-node").pfValue,y=r.pstyle("source-distance-from-node").pfValue,b=l._private.rscratch,x=u._private.rscratch,A=r.pstyle("curve-style").value,C=r._private.rscratch,E=C.edgeType,S=us(A,"taxi"),T=E==="self"||E==="compound",R=E==="bezier"||E==="multibezier"||T,D=E!=="bezier",B=E==="straight"||E==="segments",N=E==="segments",I=R||D||B,P=T||S,F=r.pstyle("source-endpoint"),O=P?"outside-to-node":F.value,U=l.pstyle("corner-radius").value==="auto"?"auto":l.pstyle("corner-radius").pfValue,L=r.pstyle("target-endpoint"),V=P?"outside-to-node":L.value,_=u.pstyle("corner-radius").value==="auto"?"auto":u.pstyle("corner-radius").pfValue;C.srcManEndpt=F,C.tgtManEndpt=L;var G,K,z,Y,Z=(e=(L==null||(n=L.pfValue)===null||n===void 0?void 0:n.length)===2?L.pfValue:null)!==null&&e!==void 0?e:[0,0],J=(i=(F==null||(a=F.pfValue)===null||a===void 0?void 0:a.length)===2?F.pfValue:null)!==null&&i!==void 0?i:[0,0];if(R){var ee=[C.ctrlpts[0],C.ctrlpts[1]],ne=D?[C.ctrlpts[C.ctrlpts.length-2],C.ctrlpts[C.ctrlpts.length-1]]:ee;G=ne,K=ee}else if(B){var oe=N?C.segpts.slice(0,2):[h.x+Z[0],h.y+Z[1]],me=N?C.segpts.slice(C.segpts.length-2):[c.x+J[0],c.y+J[1]];G=me,K=oe}if(V==="inside-to-node")o=[h.x,h.y];else if(L.units)o=this.manualEndptToPx(u,L);else if(V==="outside-to-line")o=C.tgtIntn;else if(V==="outside-to-node"||V==="outside-to-node-or-label"?z=G:(V==="outside-to-line"||V==="outside-to-line-or-label")&&(z=[c.x,c.y]),o=s.nodeShapes[this.getNodeShape(u)].intersectLine(h.x,h.y,u.outerWidth(),u.outerHeight(),z[0],z[1],0,_,x),V==="outside-to-node-or-label"||V==="outside-to-line-or-label"){var ye=u._private.rscratch,ve=ye.labelWidth,re=ye.labelHeight,ae=ye.labelX,le=ye.labelY,Ae=ve/2,Re=re/2,Le=u.pstyle("text-valign").value;Le==="top"?le-=Re:Le==="bottom"&&(le+=Re);var bt=u.pstyle("text-halign").value;bt==="left"?ae-=Ae:bt==="right"&&(ae+=Ae);var He=Oc(z[0],z[1],[ae-Ae,le-Re,ae+Ae,le-Re,ae+Ae,le+Re,ae-Ae,le+Re],h.x,h.y);if(He.length>0){var $e=c,Ze=Zs($e,Tl(o)),Ie=Zs($e,Tl(He)),_e=Ze;if(Ie<Ze&&(o=He,_e=Ie),He.length>2){var je=Zs($e,{x:He[2],y:He[3]});je<_e&&(o=[He[2],He[3]])}}}var it=kh(o,G,s.arrowShapes[d].spacing(r)+m),Xe=kh(o,G,s.arrowShapes[d].gap(r)+m);if(C.endX=Xe[0],C.endY=Xe[1],C.arrowEndX=it[0],C.arrowEndY=it[1],O==="inside-to-node")o=[c.x,c.y];else if(F.units)o=this.manualEndptToPx(l,F);else if(O==="outside-to-line")o=C.srcIntn;else if(O==="outside-to-node"||O==="outside-to-node-or-label"?Y=K:(O==="outside-to-line"||O==="outside-to-line-or-label")&&(Y=[h.x,h.y]),o=s.nodeShapes[this.getNodeShape(l)].intersectLine(c.x,c.y,l.outerWidth(),l.outerHeight(),Y[0],Y[1],0,U,b),O==="outside-to-node-or-label"||O==="outside-to-line-or-label"){var ht=l._private.rscratch,vt=ht.labelWidth,ot=ht.labelHeight,pt=ht.labelX,lt=ht.labelY,at=vt/2,Pe=ot/2,be=l.pstyle("text-valign").value;be==="top"?lt-=Pe:be==="bottom"&&(lt+=Pe);var X=l.pstyle("text-halign").value;X==="left"?pt-=at:X==="right"&&(pt+=at);var ce=Oc(Y[0],Y[1],[pt-at,lt-Pe,pt+at,lt-Pe,pt+at,lt+Pe,pt-at,lt+Pe],c.x,c.y);if(ce.length>0){var ge=h,pe=Zs(ge,Tl(o)),xe=Zs(ge,Tl(ce)),Fe=pe;if(xe<pe&&(o=[ce[0],ce[1]],Fe=xe),ce.length>2){var Se=Zs(ge,{x:ce[2],y:ce[3]});Se<Fe&&(o=[ce[2],ce[3]])}}}var ze=kh(o,K,s.arrowShapes[v].spacing(r)+y),ke=kh(o,K,s.arrowShapes[v].gap(r)+y);C.startX=ke[0],C.startY=ke[1],C.arrowStartX=ze[0],C.arrowStartY=ze[1],I&&(!Be(C.startX)||!Be(C.startY)||!Be(C.endX)||!Be(C.endY)?C.badLine=!0:C.badLine=!1)};uf.getSourceEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};uf.getTargetEndpoint=function(r){var e=r[0]._private.rscratch;switch(this.recalculateRenderedStyle(r),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var B2={};function QI(r,e,n){for(var i=function(c,h,d,v){return zr(c,h,d,v)},a=e._private,s=a.rstyle.bezierPts,o=0;o<r.bezierProjPcts.length;o++){var l=r.bezierProjPcts[o];s.push({x:i(n[0],n[2],n[4],l),y:i(n[1],n[3],n[5],l)})}}B2.storeEdgeProjections=function(r){var e=r._private,n=e.rscratch,i=n.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,i==="multibezier"||i==="bezier"||i==="self"||i==="compound"){e.rstyle.bezierPts=[];for(var a=0;a+5<n.allpts.length;a+=4)QI(this,r,n.allpts.slice(a,a+6))}else if(i==="segments")for(var s=e.rstyle.linePts=[],a=0;a+1<n.allpts.length;a+=2)s.push({x:n.allpts[a],y:n.allpts[a+1]});else if(i==="haystack"){var o=n.haystackPts;e.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth};B2.recalculateEdgeProjections=function(r){this.findEdgeControlPoints(r)};var Ki={};Ki.recalculateNodeLabelProjection=function(r){var e=r.pstyle("label").strValue;if(!ps(e)){var n,i,a=r._private,s=r.width(),o=r.height(),l=r.padding(),u=r.position(),c=r.pstyle("text-halign").strValue,h=r.pstyle("text-valign").strValue,d=a.rscratch,v=a.rstyle;switch(c){case"left":n=u.x-s/2-l;break;case"right":n=u.x+s/2+l;break;default:n=u.x}switch(h){case"top":i=u.y-o/2-l;break;case"bottom":i=u.y+o/2+l;break;default:i=u.y}d.labelX=n,d.labelY=i,v.labelX=n,v.labelY=i,this.calculateLabelAngles(r),this.applyLabelDimensions(r)}};var nS=function(e,n){var i=Math.atan(n/e);return e===0&&i<0&&(i=i*-1),i},iS=function(e,n){var i=n.x-e.x,a=n.y-e.y;return nS(i,a)},WI=function(e,n,i,a){var s=Vc(0,a-.001,1),o=Vc(0,a+.001,1),l=Bl(e,n,i,s),u=Bl(e,n,i,o);return iS(l,u)};Ki.recalculateEdgeLabelProjections=function(r){var e,n=r._private,i=n.rscratch,a=this,s={mid:r.pstyle("label").strValue,source:r.pstyle("source-label").strValue,target:r.pstyle("target-label").strValue};if(s.mid||s.source||s.target){e={x:i.midX,y:i.midY};var o=function(d,v,m){ma(n.rscratch,d,v,m),ma(n.rstyle,d,v,m)};o("labelX",null,e.x),o("labelY",null,e.y);var l=nS(i.midDispX,i.midDispY);o("labelAutoAngle",null,l);var u=function(){if(u.cache)return u.cache;for(var d=[],v=0;v+5<i.allpts.length;v+=4){var m={x:i.allpts[v],y:i.allpts[v+1]},y={x:i.allpts[v+2],y:i.allpts[v+3]},b={x:i.allpts[v+4],y:i.allpts[v+5]};d.push({p0:m,p1:y,p2:b,startDist:0,length:0,segments:[]})}var x=n.rstyle.bezierPts,A=a.bezierProjPcts.length;function C(D,B,N,I,P){var F=fo(B,N),O=D.segments[D.segments.length-1],U={p0:B,p1:N,t0:I,t1:P,startDist:O?O.startDist+O.length:0,length:F};D.segments.push(U),D.length+=F}for(var E=0;E<d.length;E++){var S=d[E],T=d[E-1];T&&(S.startDist=T.startDist+T.length),C(S,S.p0,x[E*A],0,a.bezierProjPcts[0]);for(var R=0;R<A-1;R++)C(S,x[E*A+R],x[E*A+R+1],a.bezierProjPcts[R],a.bezierProjPcts[R+1]);C(S,x[E*A+A-1],S.p2,a.bezierProjPcts[A-1],1)}return u.cache=d},c=function(d){var v,m=d==="source";if(s[d]){var y=r.pstyle(d+"-text-offset").pfValue;switch(i.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var b=u(),x,A=0,C=0,E=0;E<b.length;E++){for(var S=b[m?E:b.length-1-E],T=0;T<S.segments.length;T++){var R=S.segments[m?T:S.segments.length-1-T],D=E===b.length-1&&T===S.segments.length-1;if(A=C,C+=R.length,C>=y||D){x={cp:S,segment:R};break}}if(x)break}var B=x.cp,N=x.segment,I=(y-A)/N.length,P=N.t1-N.t0,F=m?N.t0+P*I:N.t1-P*I;F=Vc(0,F,1),e=Bl(B.p0,B.p1,B.p2,F),v=WI(B.p0,B.p1,B.p2,F);break}case"straight":case"segments":case"haystack":{for(var O=0,U,L,V,_,G=i.allpts.length,K=0;K+3<G&&(m?(V={x:i.allpts[K],y:i.allpts[K+1]},_={x:i.allpts[K+2],y:i.allpts[K+3]}):(V={x:i.allpts[G-2-K],y:i.allpts[G-1-K]},_={x:i.allpts[G-4-K],y:i.allpts[G-3-K]}),U=fo(V,_),L=O,O+=U,!(O>=y));K+=2);var z=y-L,Y=z/U;Y=Vc(0,Y,1),e=yR(V,_,Y),v=iS(V,_);break}}o("labelX",d,e.x),o("labelY",d,e.y),o("labelAutoAngle",d,v)}};c("source"),c("target"),this.applyLabelDimensions(r)}};Ki.applyLabelDimensions=function(r){this.applyPrefixedLabelDimensions(r),r.isEdge()&&(this.applyPrefixedLabelDimensions(r,"source"),this.applyPrefixedLabelDimensions(r,"target"))};Ki.applyPrefixedLabelDimensions=function(r,e){var n=r._private,i=this.getLabelText(r,e),a=co(i,r._private.labelDimsKey);if(Dn(n.rscratch,"prefixedLabelDimsKey",e)!==a){ma(n.rscratch,"prefixedLabelDimsKey",e,a);var s=this.calculateLabelDimensions(r,i),o=r.pstyle("line-height").pfValue,l=r.pstyle("text-wrap").strValue,u=Dn(n.rscratch,"labelWrapCachedLines",e)||[],c=l!=="wrap"?1:Math.max(u.length,1),h=s.height/c,d=h*o,v=s.width,m=s.height+(c-1)*(o-1)*h;ma(n.rstyle,"labelWidth",e,v),ma(n.rscratch,"labelWidth",e,v),ma(n.rstyle,"labelHeight",e,m),ma(n.rscratch,"labelHeight",e,m),ma(n.rscratch,"labelLineHeight",e,d)}};Ki.getLabelText=function(r,e){var n=r._private,i=e?e+"-":"",a=r.pstyle(i+"label").strValue,s=r.pstyle("text-transform").value,o=function(J,ee){return ee?(ma(n.rscratch,J,e,ee),ee):Dn(n.rscratch,J,e)};if(!a)return"";s=="none"||(s=="uppercase"?a=a.toUpperCase():s=="lowercase"&&(a=a.toLowerCase()));var l=r.pstyle("text-wrap").value;if(l==="wrap"){var u=o("labelKey");if(u!=null&&o("labelWrapKey")===u)return o("labelWrapCachedText");for(var c="​",h=a.split(`
`),d=r.pstyle("text-max-width").pfValue,v=r.pstyle("text-overflow-wrap").value,m=v==="anywhere",y=[],b=/[\s\u200b]+|$/g,x=0;x<h.length;x++){var A=h[x],C=this.calculateLabelDimensions(r,A),E=C.width;if(m){var S=A.split("").join(c);A=S}if(E>d){var T=A.matchAll(b),R="",D=0,B=Bn(T),N;try{for(B.s();!(N=B.n()).done;){var I=N.value,P=I[0],F=A.substring(D,I.index);D=I.index+P.length;var O=R.length===0?F:R+F+P,U=this.calculateLabelDimensions(r,O),L=U.width;L<=d?R+=F+P:(R&&y.push(R),R=F+P)}}catch(Z){B.e(Z)}finally{B.f()}R.match(/^[\s\u200b]+$/)||y.push(R)}else y.push(A)}o("labelWrapCachedLines",y),a=o("labelWrapCachedText",y.join(`
`)),o("labelWrapKey",u)}else if(l==="ellipsis"){var V=r.pstyle("text-max-width").pfValue,_="",G="…",K=!1;if(this.calculateLabelDimensions(r,a).width<V)return a;for(var z=0;z<a.length;z++){var Y=this.calculateLabelDimensions(r,_+a[z]+G).width;if(Y>V)break;_+=a[z],z===a.length-1&&(K=!0)}return K||(_+=G),_}return a};Ki.getLabelJustification=function(r){var e=r.pstyle("text-justification").strValue,n=r.pstyle("text-halign").strValue;if(e==="auto")if(r.isNode())switch(n){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};Ki.calculateLabelDimensions=function(r,e){var n=this,i=n.cy.window(),a=i.document,s=0,o=r.pstyle("font-style").strValue,l=r.pstyle("font-size").pfValue,u=r.pstyle("font-family").strValue,c=r.pstyle("font-weight").strValue,h=this.labelCalcCanvas,d=this.labelCalcCanvasContext;if(!h){h=this.labelCalcCanvas=a.createElement("canvas"),d=this.labelCalcCanvasContext=h.getContext("2d");var v=h.style;v.position="absolute",v.left="-9999px",v.top="-9999px",v.zIndex="-1",v.visibility="hidden",v.pointerEvents="none"}d.font="".concat(o," ").concat(c," ").concat(l,"px ").concat(u);for(var m=0,y=0,b=e.split(`
`),x=0;x<b.length;x++){var A=b[x],C=d.measureText(A),E=Math.ceil(C.width),S=l;m=Math.max(E,m),y+=S}return m+=s,y+=s,{width:m,height:y}};Ki.calculateLabelAngle=function(r,e){var n=r._private,i=n.rscratch,a=r.isEdge(),s=e?e+"-":"",o=r.pstyle(s+"text-rotation"),l=o.strValue;return l==="none"?0:a&&l==="autorotate"?i.labelAutoAngle:l==="autorotate"?0:o.pfValue};Ki.calculateLabelAngles=function(r){var e=this,n=r.isEdge(),i=r._private,a=i.rscratch;a.labelAngle=e.calculateLabelAngle(r),n&&(a.sourceLabelAngle=e.calculateLabelAngle(r,"source"),a.targetLabelAngle=e.calculateLabelAngle(r,"target"))};var aS={},w3=28,C3=!1;aS.getNodeShape=function(r){var e=this,n=r.pstyle("shape").value;if(n==="cutrectangle"&&(r.width()<w3||r.height()<w3))return C3||(Lt("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),C3=!0),"rectangle";if(r.isParent())return n==="rectangle"||n==="roundrectangle"||n==="round-rectangle"||n==="cutrectangle"||n==="cut-rectangle"||n==="barrel"?n:"rectangle";if(n==="polygon"){var i=r.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(i).name}return n};var R0={};R0.registerCalculationListeners=function(){var r=this.cy,e=r.collection(),n=this,i=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(o),l)for(var u=0;u<o.length;u++){var c=o[u],h=c._private,d=h.rstyle;d.clean=!1,d.cleanConnected=!1}};n.binder(r).on("bounds.* dirty.*",function(o){var l=o.target;i(l)}).on("style.* background.*",function(o){var l=o.target;i(l,!1)});var a=function(o){if(o){var l=n.onUpdateEleCalcsFns;e.cleanStyle();for(var u=0;u<e.length;u++){var c=e[u],h=c._private.rstyle;c.isNode()&&!h.cleanConnected&&(i(c.connectedEdges()),h.cleanConnected=!0)}if(l)for(var d=0;d<l.length;d++){var v=l[d];v(o,e)}n.recalculateRenderedStyle(e),e=r.collection()}};n.flushRenderedStyleQueue=function(){a(!0)},n.beforeRender(a,n.beforeRenderPriorities.eleCalcs)};R0.onUpdateEleCalcs=function(r){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(r)};R0.recalculateRenderedStyle=function(r,e){var n=function(S){return S._private.rstyle.cleanConnected};if(r.length!==0){var i=[],a=[];if(!this.destroyed){e===void 0&&(e=!0);for(var s=0;s<r.length;s++){var o=r[s],l=o._private,u=l.rstyle;o.isEdge()&&(!n(o.source())||!n(o.target()))&&(u.clean=!1),o.isEdge()&&o.isBundledBezier()&&o.parallelEdges().some(function(E){return!E._private.rstyle.clean&&E.isBundledBezier()})&&(u.clean=!1),!(e&&u.clean||o.removed())&&o.pstyle("display").value!=="none"&&(l.group==="nodes"?a.push(o):i.push(o),u.clean=!0)}for(var c=0;c<a.length;c++){var h=a[c],d=h._private,v=d.rstyle,m=h.position();this.recalculateNodeLabelProjection(h),v.nodeX=m.x,v.nodeY=m.y,v.nodeW=h.pstyle("width").pfValue,v.nodeH=h.pstyle("height").pfValue}this.recalculateEdgeProjections(i);for(var y=0;y<i.length;y++){var b=i[y],x=b._private,A=x.rstyle,C=x.rscratch;A.srcX=C.arrowStartX,A.srcY=C.arrowStartY,A.tgtX=C.arrowEndX,A.tgtY=C.arrowEndY,A.midX=C.midX,A.midY=C.midY,A.labelAngle=C.labelAngle,A.sourceLabelAngle=C.sourceLabelAngle,A.targetLabelAngle=C.targetLabelAngle}}}};var B0={};B0.updateCachedGrabbedEles=function(){var r=this.cachedZSortedEles;if(r){r.drag=[],r.nondrag=[];for(var e=[],n=0;n<r.length;n++){var i=r[n],a=i._private.rscratch;i.grabbed()&&!i.isParent()?e.push(i):a.inDragLayer?r.drag.push(i):r.nondrag.push(i)}for(var n=0;n<e.length;n++){var i=e[n];r.drag.push(i)}}};B0.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};B0.getCachedZSortedEles=function(r){if(r||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(_E),e.interactive=e.filter(function(n){return n.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var sS={};[xo,Xd,ln,uf,B2,Ki,aS,R0,B0].forEach(function(r){et(sS,r)});var oS={};oS.getCachedImage=function(r,e,n){var i=this,a=i.imageCache=i.imageCache||{},s=a[r];if(s)return s.image.complete||s.image.addEventListener("load",n),s.image;s=a[r]=a[r]||{};var o=s.image=new Image;o.addEventListener("load",n),o.addEventListener("error",function(){o.error=!0});var l="data:",u=r.substring(0,l.length).toLowerCase()===l;return u||(e=e==="null"?null:e,o.crossOrigin=e),o.src=r,o};var jl={};jl.registerBinding=function(r,e,n,i){var a=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(r)){for(var s=[],o=0;o<r.length;o++){var l=r[o];if(l!==void 0){var u=this.binder(l);s.push(u.on.apply(u,a))}}return s}var u=this.binder(r);return u.on.apply(u,a)};jl.binder=function(r){var e=this,n=e.cy.window(),i=r===n||r===n.document||r===n.document.body||l8(r);if(e.supportsPassiveEvents==null){var a=!1;try{var s=Object.defineProperty({},"passive",{get:function(){return a=!0,!0}});n.addEventListener("test",null,s)}catch{}e.supportsPassiveEvents=a}var o=function(u,c,h){var d=Array.prototype.slice.call(arguments);return i&&e.supportsPassiveEvents&&(d[2]={capture:h??!1,passive:!1,once:!1}),e.bindings.push({target:r,args:d}),(r.addEventListener||r.on).apply(r,d),this};return{on:o,addEventListener:o,addListener:o,bind:o}};jl.nodeIsDraggable=function(r){return r&&r.isNode()&&!r.locked()&&r.grabbable()};jl.nodeIsGrabbable=function(r){return this.nodeIsDraggable(r)&&r.interactive()};jl.load=function(){var r=this,e=r.cy.window(),n=function(X){return X.selected()},i=function(X){var ce=X.getRootNode();if(ce&&ce.nodeType===11&&ce.host!==void 0)return ce},a=function(X,ce,ge,pe){X==null&&(X=r.cy);for(var xe=0;xe<ce.length;xe++){var Fe=ce[xe];X.emit({originalEvent:ge,type:Fe,position:pe})}},s=function(X){return X.shiftKey||X.metaKey||X.ctrlKey},o=function(X,ce){var ge=!0;if(r.cy.hasCompoundNodes()&&X&&X.pannable())for(var pe=0;ce&&pe<ce.length;pe++){var X=ce[pe];if(X.isNode()&&X.isParent()&&!X.pannable()){ge=!1;break}}else ge=!0;return ge},l=function(X){X[0]._private.grabbed=!0},u=function(X){X[0]._private.grabbed=!1},c=function(X){X[0]._private.rscratch.inDragLayer=!0},h=function(X){X[0]._private.rscratch.inDragLayer=!1},d=function(X){X[0]._private.rscratch.isGrabTarget=!0},v=function(X){X[0]._private.rscratch.isGrabTarget=!1},m=function(X,ce){var ge=ce.addToList,pe=ge.has(X);!pe&&X.grabbable()&&!X.locked()&&(ge.merge(X),l(X))},y=function(X,ce){if(X.cy().hasCompoundNodes()&&!(ce.inDragLayer==null&&ce.addToList==null)){var ge=X.descendants();ce.inDragLayer&&(ge.forEach(c),ge.connectedEdges().forEach(c)),ce.addToList&&m(ge,ce)}},b=function(X,ce){ce=ce||{};var ge=X.cy().hasCompoundNodes();ce.inDragLayer&&(X.forEach(c),X.neighborhood().stdFilter(function(pe){return!ge||pe.isEdge()}).forEach(c)),ce.addToList&&X.forEach(function(pe){m(pe,ce)}),y(X,ce),C(X,{inDragLayer:ce.inDragLayer}),r.updateCachedGrabbedEles()},x=b,A=function(X){X&&(r.getCachedZSortedEles().forEach(function(ce){u(ce),h(ce),v(ce)}),r.updateCachedGrabbedEles())},C=function(X,ce){if(!(ce.inDragLayer==null&&ce.addToList==null)&&X.cy().hasCompoundNodes()){var ge=X.ancestors().orphans();if(!ge.same(X)){var pe=ge.descendants().spawnSelf().merge(ge).unmerge(X).unmerge(X.descendants()),xe=pe.connectedEdges();ce.inDragLayer&&(xe.forEach(c),pe.forEach(c)),ce.addToList&&pe.forEach(function(Fe){m(Fe,ce)})}}},E=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},S=typeof MutationObserver<"u",T=typeof ResizeObserver<"u";S?(r.removeObserver=new MutationObserver(function(be){for(var X=0;X<be.length;X++){var ce=be[X],ge=ce.removedNodes;if(ge)for(var pe=0;pe<ge.length;pe++){var xe=ge[pe];if(xe===r.container){r.destroy();break}}}}),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",function(be){r.destroy()});var R=af(function(){r.cy.resize()},100);S&&(r.styleObserver=new MutationObserver(R),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(e,"resize",R),T&&(r.resizeObserver=new ResizeObserver(R),r.resizeObserver.observe(r.container));var D=function(X,ce){for(;X!=null;)ce(X),X=X.parentNode},B=function(){r.invalidateContainerClientCoordsCache()};D(r.container,function(be){r.registerBinding(be,"transitionend",B),r.registerBinding(be,"animationend",B),r.registerBinding(be,"scroll",B)}),r.registerBinding(r.container,"contextmenu",function(be){be.preventDefault()});var N=function(){return r.selection[4]!==0},I=function(X){for(var ce=r.findContainerClientCoords(),ge=ce[0],pe=ce[1],xe=ce[2],Fe=ce[3],Se=X.touches?X.touches:[X],ze=!1,ke=0;ke<Se.length;ke++){var Ke=Se[ke];if(ge<=Ke.clientX&&Ke.clientX<=ge+xe&&pe<=Ke.clientY&&Ke.clientY<=pe+Fe){ze=!0;break}}if(!ze)return!1;for(var mt=r.container,ct=X.target,qe=ct.parentNode,dt=!1;qe;){if(qe===mt){dt=!0;break}qe=qe.parentNode}return!!dt};r.registerBinding(r.container,"mousedown",function(X){if(I(X)&&!(r.hoverData.which===1&&X.which!==1)){X.preventDefault(),E(),r.hoverData.capture=!0,r.hoverData.which=X.which;var ce=r.cy,ge=[X.clientX,X.clientY],pe=r.projectIntoViewport(ge[0],ge[1]),xe=r.selection,Fe=r.findNearestElements(pe[0],pe[1],!0,!1),Se=Fe[0],ze=r.dragData.possibleDragElements;r.hoverData.mdownPos=pe,r.hoverData.mdownGPos=ge;var ke=function(ft){return{originalEvent:X,type:ft,position:{x:pe[0],y:pe[1]}}},Ke=function(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout(function(){if(!r.hoverData.tapholdCancelled){var ft=r.hoverData.down;ft?ft.emit(ke("taphold")):ce.emit(ke("taphold"))}},r.tapholdDuration)};if(X.which==3){r.hoverData.cxtStarted=!0;var mt={originalEvent:X,type:"cxttapstart",position:{x:pe[0],y:pe[1]}};Se?(Se.activate(),Se.emit(mt),r.hoverData.down=Se):ce.emit(mt),r.hoverData.downTime=new Date().getTime(),r.hoverData.cxtDragged=!1}else if(X.which==1){Se&&Se.activate();{if(Se!=null&&r.nodeIsGrabbable(Se)){var ct=function(ft){ft.emit(ke("grab"))};if(d(Se),!Se.selected())ze=r.dragData.possibleDragElements=ce.collection(),x(Se,{addToList:ze}),Se.emit(ke("grabon")).emit(ke("grab"));else{ze=r.dragData.possibleDragElements=ce.collection();var qe=ce.$(function(dt){return dt.isNode()&&dt.selected()&&r.nodeIsGrabbable(dt)});b(qe,{addToList:ze}),Se.emit(ke("grabon")),qe.forEach(ct)}r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=Se,r.hoverData.downs=Fe,r.hoverData.downTime=new Date().getTime()}a(Se,["mousedown","tapstart","vmousedown"],X,{x:pe[0],y:pe[1]}),Se==null?(xe[4]=1,r.data.bgActivePosistion={x:pe[0],y:pe[1]},r.redrawHint("select",!0),r.redraw()):Se.pannable()&&(xe[4]=1),Ke()}xe[0]=xe[2]=pe[0],xe[1]=xe[3]=pe[1]}},!1);var P=i(r.container);r.registerBinding([e,P],"mousemove",function(X){var ce=r.hoverData.capture;if(!(!ce&&!I(X))){var ge=!1,pe=r.cy,xe=pe.zoom(),Fe=[X.clientX,X.clientY],Se=r.projectIntoViewport(Fe[0],Fe[1]),ze=r.hoverData.mdownPos,ke=r.hoverData.mdownGPos,Ke=r.selection,mt=null;!r.hoverData.draggingEles&&!r.hoverData.dragging&&!r.hoverData.selecting&&(mt=r.findNearestElement(Se[0],Se[1],!0,!1));var ct=r.hoverData.last,qe=r.hoverData.down,dt=[Se[0]-Ke[2],Se[1]-Ke[3]],ft=r.dragData.possibleDragElements,vr;if(ke){var ar=Fe[0]-ke[0],sr=ar*ar,wt=Fe[1]-ke[1],Dt=wt*wt,Wt=sr+Dt;r.hoverData.isOverThresholdDrag=vr=Wt>=r.desktopTapThreshold2}var br=s(X);vr&&(r.hoverData.tapholdCancelled=!0);var Mi=function(){var cn=r.hoverData.dragDelta=r.hoverData.dragDelta||[];cn.length===0?(cn.push(dt[0]),cn.push(dt[1])):(cn[0]+=dt[0],cn[1]+=dt[1])};ge=!0,a(mt,["mousemove","vmousemove","tapdrag"],X,{x:Se[0],y:Se[1]});var mr=function(cn){return{originalEvent:X,type:cn,position:{x:Se[0],y:Se[1]}}},Xn=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||pe.emit(mr("boxstart")),Ke[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(r.hoverData.which===3){if(vr){var un=mr("cxtdrag");qe?qe.emit(un):pe.emit(un),r.hoverData.cxtDragged=!0,(!r.hoverData.cxtOver||mt!==r.hoverData.cxtOver)&&(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit(mr("cxtdragout")),r.hoverData.cxtOver=mt,mt&&mt.emit(mr("cxtdragover")))}}else if(r.hoverData.dragging){if(ge=!0,pe.panningEnabled()&&pe.userPanningEnabled()){var Di;if(r.hoverData.justStartedPan){var fi=r.hoverData.mdownPos;Di={x:(Se[0]-fi[0])*xe,y:(Se[1]-fi[1])*xe},r.hoverData.justStartedPan=!1}else Di={x:dt[0]*xe,y:dt[1]*xe};pe.panBy(Di),pe.emit(mr("dragpan")),r.hoverData.dragged=!0}Se=r.projectIntoViewport(X.clientX,X.clientY)}else if(Ke[4]==1&&(qe==null||qe.pannable())){if(vr){if(!r.hoverData.dragging&&pe.boxSelectionEnabled()&&(br||!pe.panningEnabled()||!pe.userPanningEnabled()))Xn();else if(!r.hoverData.selecting&&pe.panningEnabled()&&pe.userPanningEnabled()){var bn=o(qe,r.hoverData.downs);bn&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,Ke[4]=0,r.data.bgActivePosistion=Tl(ze),r.redrawHint("select",!0),r.redraw())}qe&&qe.pannable()&&qe.active()&&qe.unactivate()}}else{if(qe&&qe.pannable()&&qe.active()&&qe.unactivate(),(!qe||!qe.grabbed())&&mt!=ct&&(ct&&a(ct,["mouseout","tapdragout"],X,{x:Se[0],y:Se[1]}),mt&&a(mt,["mouseover","tapdragover"],X,{x:Se[0],y:Se[1]}),r.hoverData.last=mt),qe)if(vr){if(pe.boxSelectionEnabled()&&br)qe&&qe.grabbed()&&(A(ft),qe.emit(mr("freeon")),ft.emit(mr("free")),r.dragData.didDrag&&(qe.emit(mr("dragfreeon")),ft.emit(mr("dragfree")))),Xn();else if(qe&&qe.grabbed()&&r.nodeIsDraggable(qe)){var Sr=!r.dragData.didDrag;Sr&&r.redrawHint("eles",!0),r.dragData.didDrag=!0,r.hoverData.draggingEles||b(ft,{inDragLayer:!0});var hr={x:0,y:0};if(Be(dt[0])&&Be(dt[1])&&(hr.x+=dt[0],hr.y+=dt[1],Sr)){var Rt=r.hoverData.dragDelta;Rt&&Be(Rt[0])&&Be(Rt[1])&&(hr.x+=Rt[0],hr.y+=Rt[1])}r.hoverData.draggingEles=!0,ft.silentShift(hr).emit(mr("position")).emit(mr("drag")),r.redrawHint("drag",!0),r.redraw()}}else Mi();ge=!0}if(Ke[2]=Se[0],Ke[3]=Se[1],ge)return X.stopPropagation&&X.stopPropagation(),X.preventDefault&&X.preventDefault(),!1}},!1);var F,O,U;r.registerBinding(e,"mouseup",function(X){if(!(r.hoverData.which===1&&X.which!==1&&r.hoverData.capture)){var ce=r.hoverData.capture;if(ce){r.hoverData.capture=!1;var ge=r.cy,pe=r.projectIntoViewport(X.clientX,X.clientY),xe=r.selection,Fe=r.findNearestElement(pe[0],pe[1],!0,!1),Se=r.dragData.possibleDragElements,ze=r.hoverData.down,ke=s(X);r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,ze&&ze.unactivate();var Ke=function(ar){return{originalEvent:X,type:ar,position:{x:pe[0],y:pe[1]}}};if(r.hoverData.which===3){var mt=Ke("cxttapend");if(ze?ze.emit(mt):ge.emit(mt),!r.hoverData.cxtDragged){var ct=Ke("cxttap");ze?ze.emit(ct):ge.emit(ct)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(r.hoverData.which===1){if(a(Fe,["mouseup","tapend","vmouseup"],X,{x:pe[0],y:pe[1]}),!r.dragData.didDrag&&!r.hoverData.dragged&&!r.hoverData.selecting&&!r.hoverData.isOverThresholdDrag&&(a(ze,["click","tap","vclick"],X,{x:pe[0],y:pe[1]}),O=!1,X.timeStamp-U<=ge.multiClickDebounceTime()?(F&&clearTimeout(F),O=!0,U=null,a(ze,["dblclick","dbltap","vdblclick"],X,{x:pe[0],y:pe[1]})):(F=setTimeout(function(){O||a(ze,["oneclick","onetap","voneclick"],X,{x:pe[0],y:pe[1]})},ge.multiClickDebounceTime()),U=X.timeStamp)),ze==null&&!r.dragData.didDrag&&!r.hoverData.selecting&&!r.hoverData.dragged&&!s(X)&&(ge.$(n).unselect(["tapunselect"]),Se.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=Se=ge.collection()),Fe==ze&&!r.dragData.didDrag&&!r.hoverData.selecting&&Fe!=null&&Fe._private.selectable&&(r.hoverData.dragging||(ge.selectionType()==="additive"||ke?Fe.selected()?Fe.unselect(["tapunselect"]):Fe.select(["tapselect"]):ke||(ge.$(n).unmerge(Fe).unselect(["tapunselect"]),Fe.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var qe=ge.collection(r.getAllInBox(xe[0],xe[1],xe[2],xe[3]));r.redrawHint("select",!0),qe.length>0&&r.redrawHint("eles",!0),ge.emit(Ke("boxend"));var dt=function(ar){return ar.selectable()&&!ar.selected()};ge.selectionType()==="additive"||ke||ge.$(n).unmerge(qe).unselect(),qe.emit(Ke("box")).stdFilter(dt).select().emit(Ke("boxselect")),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!xe[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var ft=ze&&ze.grabbed();A(Se),ft&&(ze.emit(Ke("freeon")),Se.emit(Ke("free")),r.dragData.didDrag&&(ze.emit(Ke("dragfreeon")),Se.emit(Ke("dragfree"))))}}xe[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null,r.hoverData.which=null}}},!1);var L=[],V=4,_,G=1e5,K=function(X,ce){for(var ge=0;ge<X.length;ge++)if(X[ge]%ce!==0)return!1;return!0},z=function(X){for(var ce=Math.abs(X[0]),ge=1;ge<X.length;ge++)if(Math.abs(X[ge])!==ce)return!1;return!0},Y=function(X){var ce=!1,ge=X.deltaY;if(ge==null&&(X.wheelDeltaY!=null?ge=X.wheelDeltaY/4:X.wheelDelta!=null&&(ge=X.wheelDelta/4)),ge!==0){if(_==null)if(L.length>=V){var pe=L;if(_=K(pe,5),!_){var xe=Math.abs(pe[0]);_=z(pe)&&xe>5}if(_)for(var Fe=0;Fe<pe.length;Fe++)G=Math.min(Math.abs(pe[Fe]),G)}else L.push(ge),ce=!0;else _&&(G=Math.min(Math.abs(ge),G));if(!r.scrollingPage){var Se=r.cy,ze=Se.zoom(),ke=Se.pan(),Ke=r.projectIntoViewport(X.clientX,X.clientY),mt=[Ke[0]*ze+ke.x,Ke[1]*ze+ke.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||N()){X.preventDefault();return}if(Se.panningEnabled()&&Se.userPanningEnabled()&&Se.zoomingEnabled()&&Se.userZoomingEnabled()){X.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout(function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()},150);var ct;ce&&Math.abs(ge)>5&&(ge=m2(ge)*5),ct=ge/-250,_&&(ct/=G,ct*=3),ct=ct*r.wheelSensitivity;var qe=X.deltaMode===1;qe&&(ct*=33);var dt=Se.zoom()*Math.pow(10,ct);X.type==="gesturechange"&&(dt=r.gestureStartZoom*X.scale),Se.zoom({level:dt,renderedPosition:{x:mt[0],y:mt[1]}}),Se.emit({type:X.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:X,position:{x:Ke[0],y:Ke[1]}})}}}};r.registerBinding(r.container,"wheel",Y,!0),r.registerBinding(e,"scroll",function(X){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout(function(){r.scrollingPage=!1},250)},!0),r.registerBinding(r.container,"gesturestart",function(X){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||X.preventDefault()},!0),r.registerBinding(r.container,"gesturechange",function(be){r.hasTouchStarted||Y(be)},!0),r.registerBinding(r.container,"mouseout",function(X){var ce=r.projectIntoViewport(X.clientX,X.clientY);r.cy.emit({originalEvent:X,type:"mouseout",position:{x:ce[0],y:ce[1]}})},!1),r.registerBinding(r.container,"mouseover",function(X){var ce=r.projectIntoViewport(X.clientX,X.clientY);r.cy.emit({originalEvent:X,type:"mouseover",position:{x:ce[0],y:ce[1]}})},!1);var Z,J,ee,ne,oe,me,ye,ve,re,ae,le,Ae,Re,Le=function(X,ce,ge,pe){return Math.sqrt((ge-X)*(ge-X)+(pe-ce)*(pe-ce))},bt=function(X,ce,ge,pe){return(ge-X)*(ge-X)+(pe-ce)*(pe-ce)},He;r.registerBinding(r.container,"touchstart",He=function(X){if(r.hasTouchStarted=!0,!!I(X)){E(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var ce=r.cy,ge=r.touchData.now,pe=r.touchData.earlier;if(X.touches[0]){var xe=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);ge[0]=xe[0],ge[1]=xe[1]}if(X.touches[1]){var xe=r.projectIntoViewport(X.touches[1].clientX,X.touches[1].clientY);ge[2]=xe[0],ge[3]=xe[1]}if(X.touches[2]){var xe=r.projectIntoViewport(X.touches[2].clientX,X.touches[2].clientY);ge[4]=xe[0],ge[5]=xe[1]}var Fe=function(br){return{originalEvent:X,type:br,position:{x:ge[0],y:ge[1]}}};if(X.touches[1]){r.touchData.singleTouchMoved=!0,A(r.dragData.touchDragEles);var Se=r.findContainerClientCoords();re=Se[0],ae=Se[1],le=Se[2],Ae=Se[3],Z=X.touches[0].clientX-re,J=X.touches[0].clientY-ae,ee=X.touches[1].clientX-re,ne=X.touches[1].clientY-ae,Re=0<=Z&&Z<=le&&0<=ee&&ee<=le&&0<=J&&J<=Ae&&0<=ne&&ne<=Ae;var ze=ce.pan(),ke=ce.zoom();oe=Le(Z,J,ee,ne),me=bt(Z,J,ee,ne),ye=[(Z+ee)/2,(J+ne)/2],ve=[(ye[0]-ze.x)/ke,(ye[1]-ze.y)/ke];var Ke=200,mt=Ke*Ke;if(me<mt&&!X.touches[2]){var ct=r.findNearestElement(ge[0],ge[1],!0,!0),qe=r.findNearestElement(ge[2],ge[3],!0,!0);ct&&ct.isNode()?(ct.activate().emit(Fe("cxttapstart")),r.touchData.start=ct):qe&&qe.isNode()?(qe.activate().emit(Fe("cxttapstart")),r.touchData.start=qe):ce.emit(Fe("cxttapstart")),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,r.redraw();return}}if(X.touches[2])ce.boxSelectionEnabled()&&X.preventDefault();else if(!X.touches[1]){if(X.touches[0]){var dt=r.findNearestElements(ge[0],ge[1],!0,!0),ft=dt[0];if(ft!=null&&(ft.activate(),r.touchData.start=ft,r.touchData.starts=dt,r.nodeIsGrabbable(ft))){var vr=r.dragData.touchDragEles=ce.collection(),ar=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),ft.selected()?(ar=ce.$(function(Wt){return Wt.selected()&&r.nodeIsGrabbable(Wt)}),b(ar,{addToList:vr})):x(ft,{addToList:vr}),d(ft),ft.emit(Fe("grabon")),ar?ar.forEach(function(Wt){Wt.emit(Fe("grab"))}):ft.emit(Fe("grab"))}a(ft,["touchstart","tapstart","vmousedown"],X,{x:ge[0],y:ge[1]}),ft==null&&(r.data.bgActivePosistion={x:xe[0],y:xe[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout(function(){r.touchData.singleTouchMoved===!1&&!r.pinching&&!r.touchData.selecting&&a(r.touchData.start,["taphold"],X,{x:ge[0],y:ge[1]})},r.tapholdDuration)}}if(X.touches.length>=1){for(var sr=r.touchData.startPosition=[null,null,null,null,null,null],wt=0;wt<ge.length;wt++)sr[wt]=pe[wt]=ge[wt];var Dt=X.touches[0];r.touchData.startGPosition=[Dt.clientX,Dt.clientY]}}},!1);var $e;r.registerBinding(e,"touchmove",$e=function(X){var ce=r.touchData.capture;if(!(!ce&&!I(X))){var ge=r.selection,pe=r.cy,xe=r.touchData.now,Fe=r.touchData.earlier,Se=pe.zoom();if(X.touches[0]){var ze=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);xe[0]=ze[0],xe[1]=ze[1]}if(X.touches[1]){var ze=r.projectIntoViewport(X.touches[1].clientX,X.touches[1].clientY);xe[2]=ze[0],xe[3]=ze[1]}if(X.touches[2]){var ze=r.projectIntoViewport(X.touches[2].clientX,X.touches[2].clientY);xe[4]=ze[0],xe[5]=ze[1]}var ke=function(Do){return{originalEvent:X,type:Do,position:{x:xe[0],y:xe[1]}}},Ke=r.touchData.startGPosition,mt;if(ce&&X.touches[0]&&Ke){for(var ct=[],qe=0;qe<xe.length;qe++)ct[qe]=xe[qe]-Fe[qe];var dt=X.touches[0].clientX-Ke[0],ft=dt*dt,vr=X.touches[0].clientY-Ke[1],ar=vr*vr,sr=ft+ar;mt=sr>=r.touchTapThreshold2}if(ce&&r.touchData.cxt){X.preventDefault();var wt=X.touches[0].clientX-re,Dt=X.touches[0].clientY-ae,Wt=X.touches[1].clientX-re,br=X.touches[1].clientY-ae,Mi=bt(wt,Dt,Wt,br),mr=Mi/me,Xn=150,un=Xn*Xn,Di=1.5,fi=Di*Di;if(mr>=fi||Mi>=un){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var bn=ke("cxttapend");r.touchData.start?(r.touchData.start.unactivate().emit(bn),r.touchData.start=null):pe.emit(bn)}}if(ce&&r.touchData.cxt){var bn=ke("cxtdrag");r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(bn):pe.emit(bn),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var Sr=r.findNearestElement(xe[0],xe[1],!0,!0);(!r.touchData.cxtOver||Sr!==r.touchData.cxtOver)&&(r.touchData.cxtOver&&r.touchData.cxtOver.emit(ke("cxtdragout")),r.touchData.cxtOver=Sr,Sr&&Sr.emit(ke("cxtdragover")))}else if(ce&&X.touches[2]&&pe.boxSelectionEnabled())X.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||pe.emit(ke("boxstart")),r.touchData.selecting=!0,r.touchData.didSelect=!0,ge[4]=1,!ge||ge.length===0||ge[0]===void 0?(ge[0]=(xe[0]+xe[2]+xe[4])/3,ge[1]=(xe[1]+xe[3]+xe[5])/3,ge[2]=(xe[0]+xe[2]+xe[4])/3+1,ge[3]=(xe[1]+xe[3]+xe[5])/3+1):(ge[2]=(xe[0]+xe[2]+xe[4])/3,ge[3]=(xe[1]+xe[3]+xe[5])/3),r.redrawHint("select",!0),r.redraw();else if(ce&&X.touches[1]&&!r.touchData.didSelect&&pe.zoomingEnabled()&&pe.panningEnabled()&&pe.userZoomingEnabled()&&pe.userPanningEnabled()){X.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var hr=r.dragData.touchDragEles;if(hr){r.redrawHint("drag",!0);for(var Rt=0;Rt<hr.length;Rt++){var Ma=hr[Rt]._private;Ma.grabbed=!1,Ma.rscratch.inDragLayer=!1}}var cn=r.touchData.start,wt=X.touches[0].clientX-re,Dt=X.touches[0].clientY-ae,Wt=X.touches[1].clientX-re,br=X.touches[1].clientY-ae,Ri=Le(wt,Dt,Wt,br),Da=Ri/oe;if(Re){var Y0=wt-Z,Cf=Dt-J,Ef=Wt-ee,H0=br-ne,Co=(Y0+Ef)/2,Eo=(Cf+H0)/2,fn=pe.zoom(),Ds=fn*Da,Rs=pe.pan(),Wi=ve[0]*fn+Rs.x,So=ve[1]*fn+Rs.y,Xl={x:-Ds/fn*(Wi-Rs.x-Co)+Wi,y:-Ds/fn*(So-Rs.y-Eo)+So};if(cn&&cn.active()){var hr=r.dragData.touchDragEles;A(hr),r.redrawHint("drag",!0),r.redrawHint("eles",!0),cn.unactivate().emit(ke("freeon")),hr.emit(ke("free")),r.dragData.didDrag&&(cn.emit(ke("dragfreeon")),hr.emit(ke("dragfree")))}pe.viewport({zoom:Ds,pan:Xl,cancelOnFailedZoom:!0}),pe.emit(ke("pinchzoom")),oe=Ri,Z=wt,J=Dt,ee=Wt,ne=br,r.pinching=!0}if(X.touches[0]){var ze=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);xe[0]=ze[0],xe[1]=ze[1]}if(X.touches[1]){var ze=r.projectIntoViewport(X.touches[1].clientX,X.touches[1].clientY);xe[2]=ze[0],xe[3]=ze[1]}if(X.touches[2]){var ze=r.projectIntoViewport(X.touches[2].clientX,X.touches[2].clientY);xe[4]=ze[0],xe[5]=ze[1]}}else if(X.touches[0]&&!r.touchData.didSelect){var Fn=r.touchData.start,To=r.touchData.last,Sr;if(!r.hoverData.draggingEles&&!r.swipePanning&&(Sr=r.findNearestElement(xe[0],xe[1],!0,!0)),ce&&Fn!=null&&X.preventDefault(),ce&&Fn!=null&&r.nodeIsDraggable(Fn))if(mt){var hr=r.dragData.touchDragEles,hn=!r.dragData.didDrag;hn&&b(hr,{inDragLayer:!0}),r.dragData.didDrag=!0;var Ra={x:0,y:0};if(Be(ct[0])&&Be(ct[1])&&(Ra.x+=ct[0],Ra.y+=ct[1],hn)){r.redrawHint("eles",!0);var kn=r.touchData.dragDelta;kn&&Be(kn[0])&&Be(kn[1])&&(Ra.x+=kn[0],Ra.y+=kn[1])}r.hoverData.draggingEles=!0,hr.silentShift(Ra).emit(ke("position")).emit(ke("drag")),r.redrawHint("drag",!0),r.touchData.startPosition[0]==Fe[0]&&r.touchData.startPosition[1]==Fe[1]&&r.redrawHint("eles",!0),r.redraw()}else{var kn=r.touchData.dragDelta=r.touchData.dragDelta||[];kn.length===0?(kn.push(ct[0]),kn.push(ct[1])):(kn[0]+=ct[0],kn[1]+=ct[1])}if(a(Fn||Sr,["touchmove","tapdrag","vmousemove"],X,{x:xe[0],y:xe[1]}),(!Fn||!Fn.grabbed())&&Sr!=To&&(To&&To.emit(ke("tapdragout")),Sr&&Sr.emit(ke("tapdragover"))),r.touchData.last=Sr,ce)for(var Rt=0;Rt<xe.length;Rt++)xe[Rt]&&r.touchData.startPosition[Rt]&&mt&&(r.touchData.singleTouchMoved=!0);if(ce&&(Fn==null||Fn.pannable())&&pe.panningEnabled()&&pe.userPanningEnabled()){var Mo=o(Fn,r.touchData.starts);Mo&&(X.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=Tl(r.touchData.startPosition)),r.swipePanning?(pe.panBy({x:ct[0]*Se,y:ct[1]*Se}),pe.emit(ke("dragpan"))):mt&&(r.swipePanning=!0,pe.panBy({x:dt*Se,y:vr*Se}),pe.emit(ke("dragpan")),Fn&&(Fn.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));var ze=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);xe[0]=ze[0],xe[1]=ze[1]}}for(var qe=0;qe<xe.length;qe++)Fe[qe]=xe[qe];ce&&X.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&r.data.bgActivePosistion!=null&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1);var Ze;r.registerBinding(e,"touchcancel",Ze=function(X){var ce=r.touchData.start;r.touchData.capture=!1,ce&&ce.unactivate()});var Ie,_e,je,it;if(r.registerBinding(e,"touchend",Ie=function(X){var ce=r.touchData.start,ge=r.touchData.capture;if(ge)X.touches.length===0&&(r.touchData.capture=!1),X.preventDefault();else return;var pe=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var xe=r.cy,Fe=xe.zoom(),Se=r.touchData.now,ze=r.touchData.earlier;if(X.touches[0]){var ke=r.projectIntoViewport(X.touches[0].clientX,X.touches[0].clientY);Se[0]=ke[0],Se[1]=ke[1]}if(X.touches[1]){var ke=r.projectIntoViewport(X.touches[1].clientX,X.touches[1].clientY);Se[2]=ke[0],Se[3]=ke[1]}if(X.touches[2]){var ke=r.projectIntoViewport(X.touches[2].clientX,X.touches[2].clientY);Se[4]=ke[0],Se[5]=ke[1]}var Ke=function(un){return{originalEvent:X,type:un,position:{x:Se[0],y:Se[1]}}};ce&&ce.unactivate();var mt;if(r.touchData.cxt){if(mt=Ke("cxttapend"),ce?ce.emit(mt):xe.emit(mt),!r.touchData.cxtDragged){var ct=Ke("cxttap");ce?ce.emit(ct):xe.emit(ct)}r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,r.redraw();return}if(!X.touches[2]&&xe.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var qe=xe.collection(r.getAllInBox(pe[0],pe[1],pe[2],pe[3]));pe[0]=void 0,pe[1]=void 0,pe[2]=void 0,pe[3]=void 0,pe[4]=0,r.redrawHint("select",!0),xe.emit(Ke("boxend"));var dt=function(un){return un.selectable()&&!un.selected()};qe.emit(Ke("box")).stdFilter(dt).select().emit(Ke("boxselect")),qe.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(ce?.unactivate(),X.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(!X.touches[1]){if(!X.touches[0]){if(!X.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var ft=r.dragData.touchDragEles;if(ce!=null){var vr=ce._private.grabbed;A(ft),r.redrawHint("drag",!0),r.redrawHint("eles",!0),vr&&(ce.emit(Ke("freeon")),ft.emit(Ke("free")),r.dragData.didDrag&&(ce.emit(Ke("dragfreeon")),ft.emit(Ke("dragfree")))),a(ce,["touchend","tapend","vmouseup","tapdragout"],X,{x:Se[0],y:Se[1]}),ce.unactivate(),r.touchData.start=null}else{var ar=r.findNearestElement(Se[0],Se[1],!0,!0);a(ar,["touchend","tapend","vmouseup","tapdragout"],X,{x:Se[0],y:Se[1]})}var sr=r.touchData.startPosition[0]-Se[0],wt=sr*sr,Dt=r.touchData.startPosition[1]-Se[1],Wt=Dt*Dt,br=wt+Wt,Mi=br*Fe*Fe;r.touchData.singleTouchMoved||(ce||xe.$(":selected").unselect(["tapunselect"]),a(ce,["tap","vclick"],X,{x:Se[0],y:Se[1]}),_e=!1,X.timeStamp-it<=xe.multiClickDebounceTime()?(je&&clearTimeout(je),_e=!0,it=null,a(ce,["dbltap","vdblclick"],X,{x:Se[0],y:Se[1]})):(je=setTimeout(function(){_e||a(ce,["onetap","voneclick"],X,{x:Se[0],y:Se[1]})},xe.multiClickDebounceTime()),it=X.timeStamp)),ce!=null&&!r.dragData.didDrag&&ce._private.selectable&&Mi<r.touchTapThreshold2&&!r.pinching&&(xe.selectionType()==="single"?(xe.$(n).unmerge(ce).unselect(["tapunselect"]),ce.select(["tapselect"])):ce.selected()?ce.unselect(["tapunselect"]):ce.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}}}for(var mr=0;mr<Se.length;mr++)ze[mr]=Se[mr];r.dragData.didDrag=!1,X.touches.length===0&&(r.touchData.dragDelta=[],r.touchData.startPosition=[null,null,null,null,null,null],r.touchData.startGPosition=null,r.touchData.didSelect=!1),X.touches.length<2&&(X.touches.length===1&&(r.touchData.startGPosition=[X.touches[0].clientX,X.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())},!1),typeof TouchEvent>"u"){var Xe=[],ht=function(X){return{clientX:X.clientX,clientY:X.clientY,force:1,identifier:X.pointerId,pageX:X.pageX,pageY:X.pageY,radiusX:X.width/2,radiusY:X.height/2,screenX:X.screenX,screenY:X.screenY,target:X.target}},vt=function(X){return{event:X,touch:ht(X)}},ot=function(X){Xe.push(vt(X))},pt=function(X){for(var ce=0;ce<Xe.length;ce++){var ge=Xe[ce];if(ge.event.pointerId===X.pointerId){Xe.splice(ce,1);return}}},lt=function(X){var ce=Xe.filter(function(ge){return ge.event.pointerId===X.pointerId})[0];ce.event=X,ce.touch=ht(X)},at=function(X){X.touches=Xe.map(function(ce){return ce.touch})},Pe=function(X){return X.pointerType==="mouse"||X.pointerType===4};r.registerBinding(r.container,"pointerdown",function(be){Pe(be)||(be.preventDefault(),ot(be),at(be),He(be))}),r.registerBinding(r.container,"pointerup",function(be){Pe(be)||(pt(be),at(be),Ie(be))}),r.registerBinding(r.container,"pointercancel",function(be){Pe(be)||(pt(be),at(be),Ze(be))}),r.registerBinding(r.container,"pointermove",function(be){Pe(be)||(be.preventDefault(),lt(be),at(be),$e(be))})}};var Sa={};Sa.generatePolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,draw:function(i,a,s,o,l,u){this.renderer.nodeShapeImpl("polygon",i,a,s,o,l,this.points)},intersectLine:function(i,a,s,o,l,u,c,h){return Oc(l,u,this.points,i,a,s/2,o/2,c)},checkPoint:function(i,a,s,o,l,u,c,h){return Ca(i,a,this.points,u,c,o,l,[0,-1],s)},hasMiterBounds:r!=="rectangle",miterBounds:function(i,a,s,o,l,u){return ER(this.points,i,a,s,o,l)}}};Sa.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s)},intersectLine:function(e,n,i,a,s,o,l,u){return NR(s,o,e,n,i/2+l,a/2+l)},checkPoint:function(e,n,i,a,s,o,l,u){return no(e,n,a,s,o,l,i)}}};Sa.generateRoundPolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,getOrCreateCorners:function(i,a,s,o,l,u,c){if(u[c]!==void 0&&u[c+"-cx"]===i&&u[c+"-cy"]===a)return u[c];u[c]=new Array(e.length/2),u[c+"-cx"]=i,u[c+"-cy"]=a;var h=s/2,d=o/2;l=l==="auto"?lE(s,o):l;for(var v=new Array(e.length/2),m=0;m<e.length/2;m++)v[m]={x:i+h*e[m*2],y:a+d*e[m*2+1]};var y,b,x,A,C=v.length;for(b=v[C-1],y=0;y<C;y++)x=v[y%C],A=v[(y+1)%C],u[c][y]=R2(b,x,A,l),b=x,x=A;return u[c]},draw:function(i,a,s,o,l,u,c){this.renderer.nodeShapeImpl("round-polygon",i,a,s,o,l,this.points,this.getOrCreateCorners(a,s,o,l,u,c,"drawCorners"))},intersectLine:function(i,a,s,o,l,u,c,h,d){return kR(l,u,this.points,i,a,s,o,c,this.getOrCreateCorners(i,a,s,o,h,d,"corners"))},checkPoint:function(i,a,s,o,l,u,c,h,d){return IR(i,a,this.points,u,c,o,l,this.getOrCreateCorners(u,c,o,l,h,d,"corners"))}}};Sa.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:vn(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s,this.points,o)},intersectLine:function(e,n,i,a,s,o,l,u){return sE(s,o,e,n,i,a,l,u)},checkPoint:function(e,n,i,a,s,o,l,u){var c=a/2,h=s/2;u=u==="auto"?As(a,s):u,u=Math.min(c,h,u);var d=u*2;return!!(Ca(e,n,this.points,o,l,a,s-d,[0,-1],i)||Ca(e,n,this.points,o,l,a-d,s,[0,-1],i)||no(e,n,d,d,o-c+u,l-h+u,i)||no(e,n,d,d,o+c-u,l-h+u,i)||no(e,n,d,d,o+c-u,l+h-u,i)||no(e,n,d,d,o-c+u,l+h-u,i))}}};Sa.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:y2(),points:vn(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s,null,o)},generateCutTrianglePts:function(e,n,i,a,s){var o=s==="auto"?this.cornerLength:s,l=n/2,u=e/2,c=i-u,h=i+u,d=a-l,v=a+l;return{topLeft:[c,d+o,c+o,d,c+o,d+o],topRight:[h-o,d,h,d+o,h-o,d+o],bottomRight:[h,v-o,h-o,v,h-o,v-o],bottomLeft:[c+o,v,c,v-o,c+o,v-o]}},intersectLine:function(e,n,i,a,s,o,l,u){var c=this.generateCutTrianglePts(i+2*l,a+2*l,e,n,u),h=[].concat.apply([],[c.topLeft.splice(0,4),c.topRight.splice(0,4),c.bottomRight.splice(0,4),c.bottomLeft.splice(0,4)]);return Oc(s,o,h,e,n)},checkPoint:function(e,n,i,a,s,o,l,u){var c=u==="auto"?this.cornerLength:u;if(Ca(e,n,this.points,o,l,a,s-2*c,[0,-1],i)||Ca(e,n,this.points,o,l,a-2*c,s,[0,-1],i))return!0;var h=this.generateCutTrianglePts(a,s,o,l);return Rn(e,n,h.topLeft)||Rn(e,n,h.topRight)||Rn(e,n,h.bottomRight)||Rn(e,n,h.bottomLeft)}}};Sa.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:vn(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s)},intersectLine:function(e,n,i,a,s,o,l,u){var c=.15,h=.5,d=.85,v=this.generateBarrelBezierPts(i+2*l,a+2*l,e,n),m=function(x){var A=Bl({x:x[0],y:x[1]},{x:x[2],y:x[3]},{x:x[4],y:x[5]},c),C=Bl({x:x[0],y:x[1]},{x:x[2],y:x[3]},{x:x[4],y:x[5]},h),E=Bl({x:x[0],y:x[1]},{x:x[2],y:x[3]},{x:x[4],y:x[5]},d);return[x[0],x[1],A.x,A.y,C.x,C.y,E.x,E.y,x[4],x[5]]},y=[].concat(m(v.topLeft),m(v.topRight),m(v.bottomRight),m(v.bottomLeft));return Oc(s,o,y,e,n)},generateBarrelBezierPts:function(e,n,i,a){var s=n/2,o=e/2,l=i-o,u=i+o,c=a-s,h=a+s,d=dp(e,n),v=d.heightOffset,m=d.widthOffset,y=d.ctrlPtOffsetPct*e,b={topLeft:[l,c+v,l+y,c,l+m,c],topRight:[u-m,c,u-y,c,u,c+v],bottomRight:[u,h-v,u-y,h,u-m,h],bottomLeft:[l+m,h,l+y,h,l,h-v]};return b.topLeft.isTop=!0,b.topRight.isTop=!0,b.bottomLeft.isBottom=!0,b.bottomRight.isBottom=!0,b},checkPoint:function(e,n,i,a,s,o,l,u){var c=dp(a,s),h=c.heightOffset,d=c.widthOffset;if(Ca(e,n,this.points,o,l,a,s-2*h,[0,-1],i)||Ca(e,n,this.points,o,l,a-2*d,s,[0,-1],i))return!0;for(var v=this.generateBarrelBezierPts(a,s,o,l),m=function(B,N,I){var P=I[4],F=I[2],O=I[0],U=I[5],L=I[1],V=Math.min(P,O),_=Math.max(P,O),G=Math.min(U,L),K=Math.max(U,L);if(V<=B&&B<=_&&G<=N&&N<=K){var z=PR(P,F,O),Y=MR(z[0],z[1],z[2],B),Z=Y.filter(function(J){return 0<=J&&J<=1});if(Z.length>0)return Z[0]}return null},y=Object.keys(v),b=0;b<y.length;b++){var x=y[b],A=v[x],C=m(e,n,A);if(C!=null){var E=A[5],S=A[3],T=A[1],R=zr(E,S,T,C);if(A.isTop&&R<=n||A.isBottom&&n<=R)return!0}}return!1}}};Sa.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:vn(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s,this.points,o)},intersectLine:function(e,n,i,a,s,o,l,u){var c=e-(i/2+l),h=n-(a/2+l),d=h,v=e+(i/2+l),m=fs(s,o,e,n,c,h,v,d,!1);return m.length>0?m:sE(s,o,e,n,i,a,l,u)},checkPoint:function(e,n,i,a,s,o,l,u){u=u==="auto"?As(a,s):u;var c=2*u;if(Ca(e,n,this.points,o,l,a,s-c,[0,-1],i)||Ca(e,n,this.points,o,l,a-c,s,[0,-1],i))return!0;var h=a/2+2*i,d=s/2+2*i,v=[o-h,l-d,o-h,l,o+h,l,o+h,l-d];return!!(Rn(e,n,v)||no(e,n,c,c,o+a/2-u,l+s/2-u,i)||no(e,n,c,c,o-a/2+u,l+s/2-u,i))}}};Sa.registerNodeShapes=function(){var r=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",vn(3,0)),this.generateRoundPolygon("round-triangle",vn(3,0)),this.generatePolygon("rectangle",vn(4,0)),r.square=r.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var n=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",n),this.generateRoundPolygon("round-diamond",n)}this.generatePolygon("pentagon",vn(5,0)),this.generateRoundPolygon("round-pentagon",vn(5,0)),this.generatePolygon("hexagon",vn(6,0)),this.generateRoundPolygon("round-hexagon",vn(6,0)),this.generatePolygon("heptagon",vn(7,0)),this.generateRoundPolygon("round-heptagon",vn(7,0)),this.generatePolygon("octagon",vn(8,0)),this.generateRoundPolygon("round-octagon",vn(8,0));var i=new Array(20);{var a=hp(5,0),s=hp(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var l=0;l<s.length/2;l++)s[l*2]*=o,s[l*2+1]*=o;for(var l=0;l<20/4;l++)i[l*4]=a[l*2],i[l*4+1]=a[l*2+1],i[l*4+2]=s[l*2],i[l*4+3]=s[l*2+1]}i=oE(i),this.generatePolygon("star",i),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var u=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",u),this.generateRoundPolygon("round-tag",u)}r.makePolygon=function(c){var h=c.join("$"),d="polygon-"+h,v;return(v=this[d])?v:e.generatePolygon(d,c)}};var cf={};cf.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};cf.redraw=function(r){r=r||rE();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=r};cf.beforeRender=function(r,e){if(!this.destroyed){e==null&&cr("Priority is not optional for beforeRender");var n=this.beforeRenderCallbacks;n.push({fn:r,priority:e}),n.sort(function(i,a){return a.priority-i.priority})}};var E3=function(e,n,i){for(var a=e.beforeRenderCallbacks,s=0;s<a.length;s++)a[s].fn(n,i)};cf.startRenderLoop=function(){var r=this,e=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;var n=function(a){if(!r.destroyed){if(!e.batching())if(r.requestedFrame&&!r.skipFrame){E3(r,!0,a);var s=wa();r.render(r.renderOptions);var o=r.lastDrawTime=wa();r.averageRedrawTime===void 0&&(r.averageRedrawTime=o-s),r.redrawCount===void 0&&(r.redrawCount=0),r.redrawCount++,r.redrawTotalTime===void 0&&(r.redrawTotalTime=0);var l=o-s;r.redrawTotalTime+=l,r.lastRedrawTime=l,r.averageRedrawTime=r.averageRedrawTime/2+l/2,r.requestedFrame=!1}else E3(r,!1,a);r.skipFrame=!1,_d(n)}};_d(n)}};var ZI=function(e){this.init(e)},lS=ZI,Kl=lS.prototype;Kl.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];Kl.init=function(r){var e=this;e.options=r,e.cy=r.cy;var n=e.container=r.cy.container(),i=e.cy.window();if(i){var a=i.document,s=a.head,o="__________cytoscape_stylesheet",l="__________cytoscape_container",u=a.getElementById(o)!=null;if(n.className.indexOf(l)<0&&(n.className=(n.className||"")+" "+l),!u){var c=a.createElement("style");c.id=o,c.textContent="."+l+" { position: relative; }",s.insertBefore(c,s.children[0])}var h=i.getComputedStyle(n),d=h.getPropertyValue("position");d==="static"&&Lt("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=r.showFps,e.debug=r.debug,e.webgl=r.webgl,e.hideEdgesOnViewport=r.hideEdgesOnViewport,e.textureOnViewport=r.textureOnViewport,e.wheelSensitivity=r.wheelSensitivity,e.motionBlurEnabled=r.motionBlur,e.forcedPixelRatio=Be(r.pixelRatio)?r.pixelRatio:null,e.motionBlur=r.motionBlur,e.motionBlurOpacity=r.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=r.desktopTapThreshold,e.desktopTapThreshold2=r.desktopTapThreshold*r.desktopTapThreshold,e.touchTapThreshold=r.touchTapThreshold,e.touchTapThreshold2=r.touchTapThreshold*r.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};Kl.notify=function(r,e){var n=this,i=n.cy;if(!this.destroyed){if(r==="init"){n.load();return}if(r==="destroy"){n.destroy();return}(r==="add"||r==="remove"||r==="move"&&i.hasCompoundNodes()||r==="load"||r==="zorder"||r==="mount")&&n.invalidateCachedZSortedEles(),r==="viewport"&&n.redrawHint("select",!0),r==="gc"&&n.redrawHint("gc",!0),(r==="load"||r==="resize"||r==="mount")&&(n.invalidateContainerClientCoordsCache(),n.matchCanvasSize(n.container)),n.redrawHint("eles",!0),n.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};Kl.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var e=0;e<r.bindings.length;e++){var n=r.bindings[e],i=n,a=i.target;(a.off||a.removeEventListener).apply(a,i.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch{}};Kl.isHeadless=function(){return!1};[D2,sS,oS,jl,Sa,cf].forEach(function(r){et(Kl,r)});var Mm=1e3/60,uS={setupDequeueing:function(e){return function(){var i=this,a=this.renderer;if(!i.dequeueingSetup){i.dequeueingSetup=!0;var s=af(function(){a.redrawHint("eles",!0),a.redrawHint("drag",!0),a.redraw()},e.deqRedrawThreshold),o=function(c,h){var d=wa(),v=a.averageRedrawTime,m=a.lastRedrawTime,y=[],b=a.cy.extent(),x=a.getPixelRatio();for(c||a.flushRenderedStyleQueue();;){var A=wa(),C=A-d,E=A-h;if(m<Mm){var S=Mm-(c?v:0);if(E>=e.deqFastCost*S)break}else if(c){if(C>=e.deqCost*m||C>=e.deqAvgCost*v)break}else if(E>=e.deqNoDrawCost*Mm)break;var T=e.deq(i,x,b);if(T.length>0)for(var R=0;R<T.length;R++)y.push(T[R]);else break}y.length>0&&(e.onDeqd(i,y),!c&&e.shouldRedraw(i,y,x,b)&&s())},l=e.priority||d2;a.beforeRender(o,l(i))}}}},JI=(function(){function r(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zd;Cs(this,r),this.idsByKey=new ya,this.keyForId=new ya,this.cachesByLvl=new ya,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=n}return Es(r,[{key:"getIdsFor",value:function(n){n==null&&cr("Can not get id list for null key");var i=this.idsByKey,a=this.idsByKey.get(n);return a||(a=new ql,i.set(n,a)),a}},{key:"addIdForKey",value:function(n,i){n!=null&&this.getIdsFor(n).add(i)}},{key:"deleteIdForKey",value:function(n,i){n!=null&&this.getIdsFor(n).delete(i)}},{key:"getNumberOfIdsForKey",value:function(n){return n==null?0:this.getIdsFor(n).size}},{key:"updateKeyMappingFor",value:function(n){var i=n.id(),a=this.keyForId.get(i),s=this.getKey(n);this.deleteIdForKey(a,i),this.addIdForKey(s,i),this.keyForId.set(i,s)}},{key:"deleteKeyMappingFor",value:function(n){var i=n.id(),a=this.keyForId.get(i);this.deleteIdForKey(a,i),this.keyForId.delete(i)}},{key:"keyHasChangedFor",value:function(n){var i=n.id(),a=this.keyForId.get(i),s=this.getKey(n);return a!==s}},{key:"isInvalid",value:function(n){return this.keyHasChangedFor(n)||this.doesEleInvalidateKey(n)}},{key:"getCachesAt",value:function(n){var i=this.cachesByLvl,a=this.lvls,s=i.get(n);return s||(s=new ya,i.set(n,s),a.push(n)),s}},{key:"getCache",value:function(n,i){return this.getCachesAt(i).get(n)}},{key:"get",value:function(n,i){var a=this.getKey(n),s=this.getCache(a,i);return s!=null&&this.updateKeyMappingFor(n),s}},{key:"getForCachedKey",value:function(n,i){var a=this.keyForId.get(n.id()),s=this.getCache(a,i);return s}},{key:"hasCache",value:function(n,i){return this.getCachesAt(i).has(n)}},{key:"has",value:function(n,i){var a=this.getKey(n);return this.hasCache(a,i)}},{key:"setCache",value:function(n,i,a){a.key=n,this.getCachesAt(i).set(n,a)}},{key:"set",value:function(n,i,a){var s=this.getKey(n);this.setCache(s,i,a),this.updateKeyMappingFor(n)}},{key:"deleteCache",value:function(n,i){this.getCachesAt(i).delete(n)}},{key:"delete",value:function(n,i){var a=this.getKey(n);this.deleteCache(a,i)}},{key:"invalidateKey",value:function(n){var i=this;this.lvls.forEach(function(a){return i.deleteCache(n,a)})}},{key:"invalidate",value:function(n){var i=n.id(),a=this.keyForId.get(i);this.deleteKeyMappingFor(n);var s=this.doesEleInvalidateKey(n);return s&&this.invalidateKey(a),s||this.getNumberOfIdsForKey(a)===0}}])})(),S3=25,qh=50,Cd=-4,Tp=3,cS=7.99,$I=8,eN=1024,tN=1024,rN=1024,nN=.2,iN=.8,aN=10,sN=.15,oN=.1,lN=.9,uN=.9,cN=100,fN=1,Dl={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},hN=$r({getKey:null,doesEleInvalidateKey:zd,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:$C,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),vc=function(e,n){var i=this;i.renderer=e,i.onDequeues=[];var a=hN(n);et(i,a),i.lookup=new JI(a.getKey,a.doesEleInvalidateKey),i.setupDequeueing()},Ur=vc.prototype;Ur.reasons=Dl;Ur.getTextureQueue=function(r){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[r]=e.eleImgCaches[r]||[]};Ur.getRetiredTextureQueue=function(r){var e=this,n=e.eleImgCaches.retired=e.eleImgCaches.retired||{},i=n[r]=n[r]||[];return i};Ur.getElementQueue=function(){var r=this,e=r.eleCacheQueue=r.eleCacheQueue||new sf(function(n,i){return i.reqs-n.reqs});return e};Ur.getElementKeyToQueue=function(){var r=this,e=r.eleKeyToCacheQueue=r.eleKeyToCacheQueue||{};return e};Ur.getElement=function(r,e,n,i,a){var s=this,o=this.renderer,l=o.cy.zoom(),u=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!r.visible()||r.removed()||!s.allowEdgeTxrCaching&&r.isEdge()||!s.allowParentTxrCaching&&r.isParent())return null;if(i==null&&(i=Math.ceil(v2(l*n))),i<Cd)i=Cd;else if(l>=cS||i>Tp)return null;var c=Math.pow(2,i),h=e.h*c,d=e.w*c,v=o.eleTextBiggerThanMin(r,c);if(!this.isVisible(r,v))return null;var m=u.get(r,i);if(m&&m.invalidated&&(m.invalidated=!1,m.texture.invalidatedWidth-=m.width),m)return m;var y;if(h<=S3?y=S3:h<=qh?y=qh:y=Math.ceil(h/qh)*qh,h>rN||d>tN)return null;var b=s.getTextureQueue(y),x=b[b.length-2],A=function(){return s.recycleTexture(y,d)||s.addTexture(y,d)};x||(x=b[b.length-1]),x||(x=A()),x.width-x.usedWidth<d&&(x=A());for(var C=function(V){return V&&V.scaledLabelShown===v},E=a&&a===Dl.dequeue,S=a&&a===Dl.highQuality,T=a&&a===Dl.downscale,R,D=i+1;D<=Tp;D++){var B=u.get(r,D);if(B){R=B;break}}var N=R&&R.level===i+1?R:null,I=function(){x.context.drawImage(N.texture.canvas,N.x,0,N.width,N.height,x.usedWidth,0,d,h)};if(x.context.setTransform(1,0,0,1,0,0),x.context.clearRect(x.usedWidth,0,d,y),C(N))I();else if(C(R))if(S){for(var P=R.level;P>i;P--)N=s.getElement(r,e,n,P,Dl.downscale);I()}else return s.queueElement(r,R.level-1),R;else{var F;if(!E&&!S&&!T)for(var O=i-1;O>=Cd;O--){var U=u.get(r,O);if(U){F=U;break}}if(C(F))return s.queueElement(r,i),F;x.context.translate(x.usedWidth,0),x.context.scale(c,c),this.drawElement(x.context,r,e,v,!1),x.context.scale(1/c,1/c),x.context.translate(-x.usedWidth,0)}return m={x:x.usedWidth,texture:x,level:i,scale:c,width:d,height:h,scaledLabelShown:v},x.usedWidth+=Math.ceil(d+$I),x.eleCaches.push(m),u.set(r,i,m),s.checkTextureFullness(x),m};Ur.invalidateElements=function(r){for(var e=0;e<r.length;e++)this.invalidateElement(r[e])};Ur.invalidateElement=function(r){var e=this,n=e.lookup,i=[],a=n.isInvalid(r);if(a){for(var s=Cd;s<=Tp;s++){var o=n.getForCachedKey(r,s);o&&i.push(o)}var l=n.invalidate(r);if(l)for(var u=0;u<i.length;u++){var c=i[u],h=c.texture;h.invalidatedWidth+=c.width,c.invalidated=!0,e.checkTextureUtility(h)}e.removeFromQueue(r)}};Ur.checkTextureUtility=function(r){r.invalidatedWidth>=nN*r.width&&this.retireTexture(r)};Ur.checkTextureFullness=function(r){var e=this,n=e.getTextureQueue(r.height);r.usedWidth/r.width>iN&&r.fullnessChecks>=aN?ys(n,r):r.fullnessChecks++};Ur.retireTexture=function(r){var e=this,n=r.height,i=e.getTextureQueue(n),a=this.lookup;ys(i,r),r.retired=!0;for(var s=r.eleCaches,o=0;o<s.length;o++){var l=s[o];a.deleteCache(l.key,l.level)}g2(s);var u=e.getRetiredTextureQueue(n);u.push(r)};Ur.addTexture=function(r,e){var n=this,i=n.getTextureQueue(r),a={};return i.push(a),a.eleCaches=[],a.height=r,a.width=Math.max(eN,e),a.usedWidth=0,a.invalidatedWidth=0,a.fullnessChecks=0,a.canvas=n.renderer.makeOffscreenCanvas(a.width,a.height),a.context=a.canvas.getContext("2d"),a};Ur.recycleTexture=function(r,e){for(var n=this,i=n.getTextureQueue(r),a=n.getRetiredTextureQueue(r),s=0;s<a.length;s++){var o=a[s];if(o.width>=e)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,g2(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),ys(a,o),i.push(o),o}};Ur.queueElement=function(r,e){var n=this,i=n.getElementQueue(),a=n.getElementKeyToQueue(),s=this.getKey(r),o=a[s];if(o)o.level=Math.max(o.level,e),o.eles.merge(r),o.reqs++,i.updateItem(o);else{var l={eles:r.spawn().merge(r),level:e,reqs:1,key:s};i.push(l),a[s]=l}};Ur.dequeue=function(r){for(var e=this,n=e.getElementQueue(),i=e.getElementKeyToQueue(),a=[],s=e.lookup,o=0;o<fN&&n.size()>0;o++){var l=n.pop(),u=l.key,c=l.eles[0],h=s.hasCache(c,l.level);if(i[u]=null,h)continue;a.push(l);var d=e.getBoundingBox(c);e.getElement(c,d,r,l.level,Dl.dequeue)}return a};Ur.removeFromQueue=function(r){var e=this,n=e.getElementQueue(),i=e.getElementKeyToQueue(),a=this.getKey(r),s=i[a];s!=null&&(s.eles.length===1?(s.reqs=h2,n.updateItem(s),n.pop(),i[a]=null):s.eles.unmerge(r))};Ur.onDequeue=function(r){this.onDequeues.push(r)};Ur.offDequeue=function(r){ys(this.onDequeues,r)};Ur.setupDequeueing=uS.setupDequeueing({deqRedrawThreshold:cN,deqCost:sN,deqAvgCost:oN,deqNoDrawCost:lN,deqFastCost:uN,deq:function(e,n,i){return e.dequeue(n,i)},onDeqd:function(e,n){for(var i=0;i<e.onDequeues.length;i++){var a=e.onDequeues[i];a(n)}},shouldRedraw:function(e,n,i,a){for(var s=0;s<n.length;s++)for(var o=n[s].eles,l=0;l<o.length;l++){var u=o[l].boundingBox();if(p2(u,a))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var dN=1,Sc=-4,Qd=2,gN=3.99,vN=50,mN=50,pN=.15,yN=.1,AN=.9,xN=.9,bN=1,T3=250,wN=4e3*4e3,M3=32767,CN=!0,fS=function(e){var n=this,i=n.renderer=e,a=i.cy;n.layersByLevel={},n.firstGet=!0,n.lastInvalidationTime=wa()-2*T3,n.skipping=!1,n.eleTxrDeqs=a.collection(),n.scheduleElementRefinement=af(function(){n.refineElementTextures(n.eleTxrDeqs),n.eleTxrDeqs.unmerge(n.eleTxrDeqs)},mN),i.beforeRender(function(o,l){l-n.lastInvalidationTime<=T3?n.skipping=!0:n.skipping=!1},i.beforeRenderPriorities.lyrTxrSkip);var s=function(l,u){return u.reqs-l.reqs};n.layersQueue=new sf(s),n.setupDequeueing()},en=fS.prototype,D3=0,EN=Math.pow(2,53)-1;en.makeLayer=function(r,e){var n=Math.pow(2,e),i=Math.ceil(r.w*n),a=Math.ceil(r.h*n),s=this.renderer.makeOffscreenCanvas(i,a),o={id:D3=++D3%EN,bb:r,level:e,width:i,height:a,canvas:s,context:s.getContext("2d"),eles:[],elesQueue:[],reqs:0},l=o.context,u=-o.bb.x1,c=-o.bb.y1;return l.scale(n,n),l.translate(u,c),o};en.getLayers=function(r,e,n){var i=this,a=i.renderer,s=a.cy,o=s.zoom(),l=i.firstGet;if(i.firstGet=!1,n==null){if(n=Math.ceil(v2(o*e)),n<Sc)n=Sc;else if(o>=gN||n>Qd)return null}i.validateLayersElesOrdering(n,r);var u=i.layersByLevel,c=Math.pow(2,n),h=u[n]=u[n]||[],d,v=i.levelIsComplete(n,r),m,y=function(){var I=function(L){if(i.validateLayersElesOrdering(L,r),i.levelIsComplete(L,r))return m=u[L],!0},P=function(L){if(!m)for(var V=n+L;Sc<=V&&V<=Qd&&!I(V);V+=L);};P(1),P(-1);for(var F=h.length-1;F>=0;F--){var O=h[F];O.invalid&&ys(h,O)}};if(!v)y();else return h;var b=function(){if(!d){d=yn();for(var I=0;I<r.length;I++)bR(d,r[I].boundingBox())}return d},x=function(I){I=I||{};var P=I.after;b();var F=Math.ceil(d.w*c),O=Math.ceil(d.h*c);if(F>M3||O>M3)return null;var U=F*O;if(U>wN)return null;var L=i.makeLayer(d,n);if(P!=null){var V=h.indexOf(P)+1;h.splice(V,0,L)}else(I.insert===void 0||I.insert)&&h.unshift(L);return L};if(i.skipping&&!l)return null;for(var A=null,C=r.length/dN,E=!l,S=0;S<r.length;S++){var T=r[S],R=T._private.rscratch,D=R.imgLayerCaches=R.imgLayerCaches||{},B=D[n];if(B){A=B;continue}if((!A||A.eles.length>=C||!aE(A.bb,T.boundingBox()))&&(A=x({insert:!0,after:A}),!A))return null;m||E?i.queueLayer(A,T):i.drawEleInLayer(A,T,n,e),A.eles.push(T),D[n]=A}return m||(E?null:h)};en.getEleLevelForLayerLevel=function(r,e){return r};en.drawEleInLayer=function(r,e,n,i){var a=this,s=this.renderer,o=r.context,l=e.boundingBox();l.w===0||l.h===0||!e.visible()||(n=a.getEleLevelForLayerLevel(n,i),s.setImgSmoothing(o,!1),s.drawCachedElement(o,e,null,null,n,CN),s.setImgSmoothing(o,!0))};en.levelIsComplete=function(r,e){var n=this,i=n.layersByLevel[r];if(!i||i.length===0)return!1;for(var a=0,s=0;s<i.length;s++){var o=i[s];if(o.reqs>0||o.invalid)return!1;a+=o.eles.length}return a===e.length};en.validateLayersElesOrdering=function(r,e){var n=this.layersByLevel[r];if(n)for(var i=0;i<n.length;i++){for(var a=n[i],s=-1,o=0;o<e.length;o++)if(a.eles[0]===e[o]){s=o;break}if(s<0){this.invalidateLayer(a);continue}for(var l=s,o=0;o<a.eles.length;o++)if(a.eles[o]!==e[l+o]){this.invalidateLayer(a);break}}};en.updateElementsInLayers=function(r,e){for(var n=this,i=ef(r[0]),a=0;a<r.length;a++)for(var s=i?null:r[a],o=i?r[a]:r[a].ele,l=o._private.rscratch,u=l.imgLayerCaches=l.imgLayerCaches||{},c=Sc;c<=Qd;c++){var h=u[c];h&&(s&&n.getEleLevelForLayerLevel(h.level)!==s.level||e(h,o,s))}};en.haveLayers=function(){for(var r=this,e=!1,n=Sc;n<=Qd;n++){var i=r.layersByLevel[n];if(i&&i.length>0){e=!0;break}}return e};en.invalidateElements=function(r){var e=this;r.length!==0&&(e.lastInvalidationTime=wa(),!(r.length===0||!e.haveLayers())&&e.updateElementsInLayers(r,function(i,a,s){e.invalidateLayer(i)}))};en.invalidateLayer=function(r){if(this.lastInvalidationTime=wa(),!r.invalid){var e=r.level,n=r.eles,i=this.layersByLevel[e];ys(i,r),r.elesQueue=[],r.invalid=!0,r.replacement&&(r.replacement.invalid=!0);for(var a=0;a<n.length;a++){var s=n[a]._private.rscratch.imgLayerCaches;s&&(s[e]=null)}}};en.refineElementTextures=function(r){var e=this;e.updateElementsInLayers(r,function(i,a,s){var o=i.replacement;if(o||(o=i.replacement=e.makeLayer(i.bb,i.level),o.replaces=i,o.eles=i.eles),!o.reqs)for(var l=0;l<o.eles.length;l++)e.queueLayer(o,o.eles[l])})};en.enqueueElementRefinement=function(r){this.eleTxrDeqs.merge(r),this.scheduleElementRefinement()};en.queueLayer=function(r,e){var n=this,i=n.layersQueue,a=r.elesQueue,s=a.hasId=a.hasId||{};if(!r.replacement){if(e){if(s[e.id()])return;a.push(e),s[e.id()]=!0}r.reqs?(r.reqs++,i.updateItem(r)):(r.reqs=1,i.push(r))}};en.dequeue=function(r){for(var e=this,n=e.layersQueue,i=[],a=0;a<bN&&n.size()!==0;){var s=n.peek();if(s.replacement){n.pop();continue}if(s.replaces&&s!==s.replaces.replacement){n.pop();continue}if(s.invalid){n.pop();continue}var o=s.elesQueue.shift();o&&(e.drawEleInLayer(s,o,s.level,r),a++),i.length===0&&i.push(!0),s.elesQueue.length===0&&(n.pop(),s.reqs=0,s.replaces&&e.applyLayerReplacement(s),e.requestRedraw())}return i};en.applyLayerReplacement=function(r){var e=this,n=e.layersByLevel[r.level],i=r.replaces,a=n.indexOf(i);if(!(a<0||i.invalid)){n[a]=r;for(var s=0;s<r.eles.length;s++){var o=r.eles[s]._private,l=o.imgLayerCaches=o.imgLayerCaches||{};l&&(l[r.level]=r)}e.requestRedraw()}};en.requestRedraw=af(function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()},100);en.setupDequeueing=uS.setupDequeueing({deqRedrawThreshold:vN,deqCost:pN,deqAvgCost:yN,deqNoDrawCost:AN,deqFastCost:xN,deq:function(e,n){return e.dequeue(n)},onDeqd:d2,shouldRedraw:$C,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var hS={},R3;function SN(r,e){for(var n=0;n<e.length;n++){var i=e[n];r.lineTo(i.x,i.y)}}function TN(r,e,n){for(var i,a=0;a<e.length;a++){var s=e[a];a===0&&(i=s),r.lineTo(s.x,s.y)}r.quadraticCurveTo(n.x,n.y,i.x,i.y)}function B3(r,e,n){r.beginPath&&r.beginPath();for(var i=e,a=0;a<i.length;a++){var s=i[a];r.lineTo(s.x,s.y)}var o=n,l=n[0];r.moveTo(l.x,l.y);for(var a=1;a<o.length;a++){var s=o[a];r.lineTo(s.x,s.y)}r.closePath&&r.closePath()}function MN(r,e,n,i,a){r.beginPath&&r.beginPath(),r.arc(n,i,a,0,Math.PI*2,!1);var s=e,o=s[0];r.moveTo(o.x,o.y);for(var l=0;l<s.length;l++){var u=s[l];r.lineTo(u.x,u.y)}r.closePath&&r.closePath()}function DN(r,e,n,i){r.arc(e,n,i,0,Math.PI*2,!1)}hS.arrowShapeImpl=function(r){return(R3||(R3={polygon:SN,"triangle-backcurve":TN,"triangle-tee":B3,"circle-triangle":MN,"triangle-cross":B3,circle:DN}))[r]};var Xi={};Xi.drawElement=function(r,e,n,i,a,s){var o=this;e.isNode()?o.drawNode(r,e,n,i,a,s):o.drawEdge(r,e,n,i,a,s)};Xi.drawElementOverlay=function(r,e){var n=this;e.isNode()?n.drawNodeOverlay(r,e):n.drawEdgeOverlay(r,e)};Xi.drawElementUnderlay=function(r,e){var n=this;e.isNode()?n.drawNodeUnderlay(r,e):n.drawEdgeUnderlay(r,e)};Xi.drawCachedElementPortion=function(r,e,n,i,a,s,o,l){var u=this,c=n.getBoundingBox(e);if(!(c.w===0||c.h===0)){var h=n.getElement(e,c,i,a,s);if(h!=null){var d=l(u,e);if(d===0)return;var v=o(u,e),m=c.x1,y=c.y1,b=c.w,x=c.h,A,C,E,S,T;if(v!==0){var R=n.getRotationPoint(e);E=R.x,S=R.y,r.translate(E,S),r.rotate(v),T=u.getImgSmoothing(r),T||u.setImgSmoothing(r,!0);var D=n.getRotationOffset(e);A=D.x,C=D.y}else A=m,C=y;var B;d!==1&&(B=r.globalAlpha,r.globalAlpha=B*d),r.drawImage(h.texture.canvas,h.x,0,h.width,h.height,A,C,b,x),d!==1&&(r.globalAlpha=B),v!==0&&(r.rotate(-v),r.translate(-E,-S),T||u.setImgSmoothing(r,!1))}else n.drawElement(r,e)}};var RN=function(){return 0},BN=function(e,n){return e.getTextAngle(n,null)},IN=function(e,n){return e.getTextAngle(n,"source")},NN=function(e,n){return e.getTextAngle(n,"target")},FN=function(e,n){return n.effectiveOpacity()},Dm=function(e,n){return n.pstyle("text-opacity").pfValue*n.effectiveOpacity()};Xi.drawCachedElement=function(r,e,n,i,a,s){var o=this,l=o.data,u=l.eleTxrCache,c=l.lblTxrCache,h=l.slbTxrCache,d=l.tlbTxrCache,v=e.boundingBox(),m=s===!0?u.reasons.highQuality:null;if(!(v.w===0||v.h===0||!e.visible())&&(!i||p2(v,i))){var y=e.isEdge(),b=e.element()._private.rscratch.badLine;o.drawElementUnderlay(r,e),o.drawCachedElementPortion(r,e,u,n,a,m,RN,FN),(!y||!b)&&o.drawCachedElementPortion(r,e,c,n,a,m,BN,Dm),y&&!b&&(o.drawCachedElementPortion(r,e,h,n,a,m,IN,Dm),o.drawCachedElementPortion(r,e,d,n,a,m,NN,Dm)),o.drawElementOverlay(r,e)}};Xi.drawElements=function(r,e){for(var n=this,i=0;i<e.length;i++){var a=e[i];n.drawElement(r,a)}};Xi.drawCachedElements=function(r,e,n,i){for(var a=this,s=0;s<e.length;s++){var o=e[s];a.drawCachedElement(r,o,n,i)}};Xi.drawCachedNodes=function(r,e,n,i){for(var a=this,s=0;s<e.length;s++){var o=e[s];o.isNode()&&a.drawCachedElement(r,o,n,i)}};Xi.drawLayeredElements=function(r,e,n,i){var a=this,s=a.data.lyrTxrCache.getLayers(e,n);if(s)for(var o=0;o<s.length;o++){var l=s[o],u=l.bb;u.w===0||u.h===0||r.drawImage(l.canvas,u.x1,u.y1,u.w,u.h)}else a.drawCachedElements(r,e,n,i)};var Ta={};Ta.drawEdge=function(r,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l=e._private.rscratch;if(!(s&&!e.visible())&&!(l.badLine||l.allpts==null||isNaN(l.allpts[0]))){var u;n&&(u=n,r.translate(-u.x1,-u.y1));var c=s?e.pstyle("opacity").value:1,h=s?e.pstyle("line-opacity").value:1,d=e.pstyle("curve-style").value,v=e.pstyle("line-style").value,m=e.pstyle("width").pfValue,y=e.pstyle("line-cap").value,b=e.pstyle("line-outline-width").value,x=e.pstyle("line-outline-color").value,A=c*h,C=c*h,E=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:A;d==="straight-triangle"?(o.eleStrokeStyle(r,e,L),o.drawEdgeTrianglePath(e,r,l.allpts)):(r.lineWidth=m,r.lineCap=y,o.eleStrokeStyle(r,e,L),o.drawEdgePath(e,r,l.allpts,v),r.lineCap="butt")},S=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:A;if(r.lineWidth=m+b,r.lineCap=y,b>0)o.colorStrokeStyle(r,x[0],x[1],x[2],L);else{r.lineCap="butt";return}d==="straight-triangle"?o.drawEdgeTrianglePath(e,r,l.allpts):(o.drawEdgePath(e,r,l.allpts,v),r.lineCap="butt")},T=function(){a&&o.drawEdgeOverlay(r,e)},R=function(){a&&o.drawEdgeUnderlay(r,e)},D=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C;o.drawArrowheads(r,e,L)},B=function(){o.drawElementText(r,e,null,i)};r.lineJoin="round";var N=e.pstyle("ghost").value==="yes";if(N){var I=e.pstyle("ghost-offset-x").pfValue,P=e.pstyle("ghost-offset-y").pfValue,F=e.pstyle("ghost-opacity").value,O=A*F;r.translate(I,P),E(O),D(O),r.translate(-I,-P)}else S();R(),E(),D(),T(),B(),n&&r.translate(u.x1,u.y1)}};var dS=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(n,i){if(i.visible()){var a=i.pstyle("".concat(e,"-opacity")).value;if(a!==0){var s=this,o=s.usePaths(),l=i._private.rscratch,u=i.pstyle("".concat(e,"-padding")).pfValue,c=2*u,h=i.pstyle("".concat(e,"-color")).value;n.lineWidth=c,l.edgeType==="self"&&!o?n.lineCap="butt":n.lineCap="round",s.colorStrokeStyle(n,h[0],h[1],h[2],a),s.drawEdgePath(i,n,l.allpts,"solid")}}}};Ta.drawEdgeOverlay=dS("overlay");Ta.drawEdgeUnderlay=dS("underlay");Ta.drawEdgePath=function(r,e,n,i){var a=r._private.rscratch,s=e,o,l=!1,u=this.usePaths(),c=r.pstyle("line-dash-pattern").pfValue,h=r.pstyle("line-dash-offset").pfValue;if(u){var d=n.join("$"),v=a.pathCacheKey&&a.pathCacheKey===d;v?(o=e=a.pathCache,l=!0):(o=e=new Path2D,a.pathCacheKey=d,a.pathCache=o)}if(s.setLineDash)switch(i){case"dotted":s.setLineDash([1,1]);break;case"dashed":s.setLineDash(c),s.lineDashOffset=h;break;case"solid":s.setLineDash([]);break}if(!l&&!a.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(n[0],n[1]),a.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var m=2;m+3<n.length;m+=4)e.quadraticCurveTo(n[m],n[m+1],n[m+2],n[m+3]);break;case"straight":case"haystack":for(var y=2;y+1<n.length;y+=2)e.lineTo(n[y],n[y+1]);break;case"segments":if(a.isRound){var b=Bn(a.roundCorners),x;try{for(b.s();!(x=b.n()).done;){var A=x.value;tS(e,A)}}catch(E){b.e(E)}finally{b.f()}e.lineTo(n[n.length-2],n[n.length-1])}else for(var C=2;C+1<n.length;C+=2)e.lineTo(n[C],n[C+1]);break}e=s,u?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])};Ta.drawEdgeTrianglePath=function(r,e,n){e.fillStyle=e.strokeStyle;for(var i=r.pstyle("width").pfValue,a=0;a+1<n.length;a+=2){var s=[n[a+2]-n[a],n[a+3]-n[a+1]],o=Math.sqrt(s[0]*s[0]+s[1]*s[1]),l=[s[1]/o,-s[0]/o],u=[l[0]*i/2,l[1]*i/2];e.beginPath(),e.moveTo(n[a]-u[0],n[a+1]-u[1]),e.lineTo(n[a]+u[0],n[a+1]+u[1]),e.lineTo(n[a+2],n[a+3]),e.closePath(),e.fill()}};Ta.drawArrowheads=function(r,e,n){var i=e._private.rscratch,a=i.edgeType==="haystack";a||this.drawArrowhead(r,e,"source",i.arrowStartX,i.arrowStartY,i.srcArrowAngle,n),this.drawArrowhead(r,e,"mid-target",i.midX,i.midY,i.midtgtArrowAngle,n),this.drawArrowhead(r,e,"mid-source",i.midX,i.midY,i.midsrcArrowAngle,n),a||this.drawArrowhead(r,e,"target",i.arrowEndX,i.arrowEndY,i.tgtArrowAngle,n)};Ta.drawArrowhead=function(r,e,n,i,a,s,o){if(!(isNaN(i)||i==null||isNaN(a)||a==null||isNaN(s)||s==null)){var l=this,u=e.pstyle(n+"-arrow-shape").value;if(u!=="none"){var c=e.pstyle(n+"-arrow-fill").value==="hollow"?"both":"filled",h=e.pstyle(n+"-arrow-fill").value,d=e.pstyle("width").pfValue,v=e.pstyle(n+"-arrow-width"),m=v.value==="match-line"?d:v.pfValue;v.units==="%"&&(m*=d);var y=e.pstyle("opacity").value;o===void 0&&(o=y);var b=r.globalCompositeOperation;(o!==1||h==="hollow")&&(r.globalCompositeOperation="destination-out",l.colorFillStyle(r,255,255,255,1),l.colorStrokeStyle(r,255,255,255,1),l.drawArrowShape(e,r,c,d,u,m,i,a,s),r.globalCompositeOperation=b);var x=e.pstyle(n+"-arrow-color").value;l.colorFillStyle(r,x[0],x[1],x[2],o),l.colorStrokeStyle(r,x[0],x[1],x[2],o),l.drawArrowShape(e,r,h,d,u,m,i,a,s)}}};Ta.drawArrowShape=function(r,e,n,i,a,s,o,l,u){var c=this,h=this.usePaths()&&a!=="triangle-cross",d=!1,v,m=e,y={x:o,y:l},b=r.pstyle("arrow-scale").value,x=this.getArrowWidth(i,b),A=c.arrowShapes[a];if(h){var C=c.arrowPathCache=c.arrowPathCache||[],E=co(a),S=C[E];S!=null?(v=e=S,d=!0):(v=e=new Path2D,C[E]=v)}d||(e.beginPath&&e.beginPath(),h?A.draw(e,1,0,{x:0,y:0},1):A.draw(e,x,u,y,i),e.closePath&&e.closePath()),e=m,h&&(e.translate(o,l),e.rotate(u),e.scale(x,x)),(n==="filled"||n==="both")&&(h?e.fill(v):e.fill()),(n==="hollow"||n==="both")&&(e.lineWidth=s/(h?x:1),e.lineJoin="miter",h?e.stroke(v):e.stroke()),h&&(e.scale(1/x,1/x),e.rotate(-u),e.translate(-o,-l))};var I2={};I2.safeDrawImage=function(r,e,n,i,a,s,o,l,u,c){if(!(a<=0||s<=0||u<=0||c<=0))try{r.drawImage(e,n,i,a,s,o,l,u,c)}catch(h){Lt(h)}};I2.drawInscribedImage=function(r,e,n,i,a){var s=this,o=n.position(),l=o.x,u=o.y,c=n.cy().style(),h=c.getIndexedStyle.bind(c),d=h(n,"background-fit","value",i),v=h(n,"background-repeat","value",i),m=n.width(),y=n.height(),b=n.padding()*2,x=m+(h(n,"background-width-relative-to","value",i)==="inner"?0:b),A=y+(h(n,"background-height-relative-to","value",i)==="inner"?0:b),C=n._private.rscratch,E=h(n,"background-clip","value",i),S=E==="node",T=h(n,"background-image-opacity","value",i)*a,R=h(n,"background-image-smoothing","value",i),D=n.pstyle("corner-radius").value;D!=="auto"&&(D=n.pstyle("corner-radius").pfValue);var B=e.width||e.cachedW,N=e.height||e.cachedH;(B==null||N==null)&&(document.body.appendChild(e),B=e.cachedW=e.width||e.offsetWidth,N=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var I=B,P=N;if(h(n,"background-width","value",i)!=="auto"&&(h(n,"background-width","units",i)==="%"?I=h(n,"background-width","pfValue",i)*x:I=h(n,"background-width","pfValue",i)),h(n,"background-height","value",i)!=="auto"&&(h(n,"background-height","units",i)==="%"?P=h(n,"background-height","pfValue",i)*A:P=h(n,"background-height","pfValue",i)),!(I===0||P===0)){if(d==="contain"){var F=Math.min(x/I,A/P);I*=F,P*=F}else if(d==="cover"){var F=Math.max(x/I,A/P);I*=F,P*=F}var O=l-x/2,U=h(n,"background-position-x","units",i),L=h(n,"background-position-x","pfValue",i);U==="%"?O+=(x-I)*L:O+=L;var V=h(n,"background-offset-x","units",i),_=h(n,"background-offset-x","pfValue",i);V==="%"?O+=(x-I)*_:O+=_;var G=u-A/2,K=h(n,"background-position-y","units",i),z=h(n,"background-position-y","pfValue",i);K==="%"?G+=(A-P)*z:G+=z;var Y=h(n,"background-offset-y","units",i),Z=h(n,"background-offset-y","pfValue",i);Y==="%"?G+=(A-P)*Z:G+=Z,C.pathCache&&(O-=l,G-=u,l=0,u=0);var J=r.globalAlpha;r.globalAlpha=T;var ee=s.getImgSmoothing(r),ne=!1;if(R==="no"&&ee?(s.setImgSmoothing(r,!1),ne=!0):R==="yes"&&!ee&&(s.setImgSmoothing(r,!0),ne=!0),v==="no-repeat")S&&(r.save(),C.pathCache?r.clip(C.pathCache):(s.nodeShapes[s.getNodeShape(n)].draw(r,l,u,x,A,D,C),r.clip())),s.safeDrawImage(r,e,0,0,B,N,O,G,I,P),S&&r.restore();else{var oe=r.createPattern(e,v);r.fillStyle=oe,s.nodeShapes[s.getNodeShape(n)].draw(r,l,u,x,A,D,C),r.translate(O,G),r.fill(),r.translate(-O,-G)}r.globalAlpha=J,ne&&s.setImgSmoothing(r,ee)}};var bo={};bo.eleTextBiggerThanMin=function(r,e){if(!e){var n=r.cy().zoom(),i=this.getPixelRatio(),a=Math.ceil(v2(n*i));e=Math.pow(2,a)}var s=r.pstyle("font-size").pfValue*e,o=r.pstyle("min-zoomed-font-size").pfValue;return!(s<o)};bo.drawElementText=function(r,e,n,i,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(i==null){if(s&&!o.eleTextBiggerThanMin(e))return}else if(i===!1)return;if(e.isNode()){var l=e.pstyle("label");if(!l||!l.value)return;var u=o.getLabelJustification(e);r.textAlign=u,r.textBaseline="bottom"}else{var c=e.element()._private.rscratch.badLine,h=e.pstyle("label"),d=e.pstyle("source-label"),v=e.pstyle("target-label");if(c||(!h||!h.value)&&(!d||!d.value)&&(!v||!v.value))return;r.textAlign="center",r.textBaseline="bottom"}var m=!n,y;n&&(y=n,r.translate(-y.x1,-y.y1)),a==null?(o.drawText(r,e,null,m,s),e.isEdge()&&(o.drawText(r,e,"source",m,s),o.drawText(r,e,"target",m,s))):o.drawText(r,e,a,m,s),n&&r.translate(y.x1,y.y1)};bo.getFontCache=function(r){var e;this.fontCaches=this.fontCaches||[];for(var n=0;n<this.fontCaches.length;n++)if(e=this.fontCaches[n],e.context===r)return e;return e={context:r},this.fontCaches.push(e),e};bo.setupTextStyle=function(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=e.pstyle("font-style").strValue,a=e.pstyle("font-size").pfValue+"px",s=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,l=n?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,u=e.pstyle("text-outline-opacity").value*l,c=e.pstyle("color").value,h=e.pstyle("text-outline-color").value;r.font=i+" "+o+" "+a+" "+s,r.lineJoin="round",this.colorFillStyle(r,c[0],c[1],c[2],l),this.colorStrokeStyle(r,h[0],h[1],h[2],u)};function kN(r,e,n,i,a){var s=Math.min(i,a),o=s/2,l=e+i/2,u=n+a/2;r.beginPath(),r.arc(l,u,o,0,Math.PI*2),r.closePath()}function I3(r,e,n,i,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=Math.min(s,i/2,a/2);r.beginPath(),r.moveTo(e+o,n),r.lineTo(e+i-o,n),r.quadraticCurveTo(e+i,n,e+i,n+o),r.lineTo(e+i,n+a-o),r.quadraticCurveTo(e+i,n+a,e+i-o,n+a),r.lineTo(e+o,n+a),r.quadraticCurveTo(e,n+a,e,n+a-o),r.lineTo(e,n+o),r.quadraticCurveTo(e,n,e+o,n),r.closePath()}bo.getTextAngle=function(r,e){var n,i=r._private,a=i.rscratch,s=e?e+"-":"",o=r.pstyle(s+"text-rotation");if(o.strValue==="autorotate"){var l=Dn(a,"labelAngle",e);n=r.isEdge()?l:0}else o.strValue==="none"?n=0:n=o.pfValue;return n};bo.drawText=function(r,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=e._private,o=s.rscratch,l=a?e.effectiveOpacity():1;if(!(a&&(l===0||e.pstyle("text-opacity").value===0))){n==="main"&&(n=null);var u=Dn(o,"labelX",n),c=Dn(o,"labelY",n),h,d,v=this.getLabelText(e,n);if(v!=null&&v!==""&&!isNaN(u)&&!isNaN(c)){this.setupTextStyle(r,e,a);var m=n?n+"-":"",y=Dn(o,"labelWidth",n),b=Dn(o,"labelHeight",n),x=e.pstyle(m+"text-margin-x").pfValue,A=e.pstyle(m+"text-margin-y").pfValue,C=e.isEdge(),E=e.pstyle("text-halign").value,S=e.pstyle("text-valign").value;C&&(E="center",S="center"),u+=x,c+=A;var T;switch(i?T=this.getTextAngle(e,n):T=0,T!==0&&(h=u,d=c,r.translate(h,d),r.rotate(T),u=0,c=0),S){case"top":break;case"center":c+=b/2;break;case"bottom":c+=b;break}var R=e.pstyle("text-background-opacity").value,D=e.pstyle("text-border-opacity").value,B=e.pstyle("text-border-width").pfValue,N=e.pstyle("text-background-padding").pfValue,I=e.pstyle("text-background-shape").strValue,P=I==="round-rectangle"||I==="roundrectangle",F=I==="circle",O=2;if(R>0||B>0&&D>0){var U=r.fillStyle,L=r.strokeStyle,V=r.lineWidth,_=e.pstyle("text-background-color").value,G=e.pstyle("text-border-color").value,K=e.pstyle("text-border-style").value,z=R>0,Y=B>0&&D>0,Z=u-N;switch(E){case"left":Z-=y;break;case"center":Z-=y/2;break}var J=c-b-N,ee=y+2*N,ne=b+2*N;if(z&&(r.fillStyle="rgba(".concat(_[0],",").concat(_[1],",").concat(_[2],",").concat(R*l,")")),Y&&(r.strokeStyle="rgba(".concat(G[0],",").concat(G[1],",").concat(G[2],",").concat(D*l,")"),r.lineWidth=B,r.setLineDash))switch(K){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"double":r.lineWidth=B/4,r.setLineDash([]);break;case"solid":default:r.setLineDash([]);break}if(P?(r.beginPath(),I3(r,Z,J,ee,ne,O)):F?(r.beginPath(),kN(r,Z,J,ee,ne)):(r.beginPath(),r.rect(Z,J,ee,ne)),z&&r.fill(),Y&&r.stroke(),Y&&K==="double"){var oe=B/2;r.beginPath(),P?I3(r,Z+oe,J+oe,ee-2*oe,ne-2*oe,O):r.rect(Z+oe,J+oe,ee-2*oe,ne-2*oe),r.stroke()}r.fillStyle=U,r.strokeStyle=L,r.lineWidth=V,r.setLineDash&&r.setLineDash([])}var me=2*e.pstyle("text-outline-width").pfValue;if(me>0&&(r.lineWidth=me),e.pstyle("text-wrap").value==="wrap"){var ye=Dn(o,"labelWrapCachedLines",n),ve=Dn(o,"labelLineHeight",n),re=y/2,ae=this.getLabelJustification(e);switch(ae==="auto"||(E==="left"?ae==="left"?u+=-y:ae==="center"&&(u+=-re):E==="center"?ae==="left"?u+=-re:ae==="right"&&(u+=re):E==="right"&&(ae==="center"?u+=re:ae==="right"&&(u+=y))),S){case"top":c-=(ye.length-1)*ve;break;case"center":case"bottom":c-=(ye.length-1)*ve;break}for(var le=0;le<ye.length;le++)me>0&&r.strokeText(ye[le],u,c),r.fillText(ye[le],u,c),c+=ve}else me>0&&r.strokeText(v,u,c),r.fillText(v,u,c);T!==0&&(r.rotate(-T),r.translate(-h,-d))}}};var Ts={};Ts.drawNode=function(r,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l,u,c=e._private,h=c.rscratch,d=e.position();if(!(!Be(d.x)||!Be(d.y))&&!(s&&!e.visible())){var v=s?e.effectiveOpacity():1,m=o.usePaths(),y,b=!1,x=e.padding();l=e.width()+2*x,u=e.height()+2*x;var A;n&&(A=n,r.translate(-A.x1,-A.y1));for(var C=e.pstyle("background-image"),E=C.value,S=new Array(E.length),T=new Array(E.length),R=0,D=0;D<E.length;D++){var B=E[D],N=S[D]=B!=null&&B!=="none";if(N){var I=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",D);R++,T[D]=o.getCachedImage(B,I,function(){c.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var P=e.pstyle("background-blacken").value,F=e.pstyle("border-width").pfValue,O=e.pstyle("background-opacity").value*v,U=e.pstyle("border-color").value,L=e.pstyle("border-style").value,V=e.pstyle("border-join").value,_=e.pstyle("border-cap").value,G=e.pstyle("border-position").value,K=e.pstyle("border-dash-pattern").pfValue,z=e.pstyle("border-dash-offset").pfValue,Y=e.pstyle("border-opacity").value*v,Z=e.pstyle("outline-width").pfValue,J=e.pstyle("outline-color").value,ee=e.pstyle("outline-style").value,ne=e.pstyle("outline-opacity").value*v,oe=e.pstyle("outline-offset").value,me=e.pstyle("corner-radius").value;me!=="auto"&&(me=e.pstyle("corner-radius").pfValue);var ye=function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:O;o.eleFillStyle(r,e,Pe)},ve=function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y;o.colorStrokeStyle(r,U[0],U[1],U[2],Pe)},re=function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ne;o.colorStrokeStyle(r,J[0],J[1],J[2],Pe)},ae=function(Pe,be,X,ce){var ge=o.nodePathCache=o.nodePathCache||[],pe=JC(X==="polygon"?X+","+ce.join(","):X,""+be,""+Pe,""+me),xe=ge[pe],Fe,Se=!1;return xe!=null?(Fe=xe,Se=!0,h.pathCache=Fe):(Fe=new Path2D,ge[pe]=h.pathCache=Fe),{path:Fe,cacheHit:Se}},le=e.pstyle("shape").strValue,Ae=e.pstyle("shape-polygon-points").pfValue;if(m){r.translate(d.x,d.y);var Re=ae(l,u,le,Ae);y=Re.path,b=Re.cacheHit}var Le=function(){if(!b){var Pe=d;m&&(Pe={x:0,y:0}),o.nodeShapes[o.getNodeShape(e)].draw(y||r,Pe.x,Pe.y,l,u,me,h)}m?r.fill(y):r.fill()},bt=function(){for(var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,X=c.backgrounding,ce=0,ge=0;ge<T.length;ge++){var pe=e.cy().style().getIndexedStyle(e,"background-image-containment","value",ge);if(be&&pe==="over"||!be&&pe==="inside"){ce++;continue}S[ge]&&T[ge].complete&&!T[ge].error&&(ce++,o.drawInscribedImage(r,T[ge],e,ge,Pe))}c.backgrounding=ce!==R,X!==c.backgrounding&&e.updateStyle(!1)},He=function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v;o.hasPie(e)&&(o.drawPie(r,e,be),Pe&&(m||o.nodeShapes[o.getNodeShape(e)].draw(r,d.x,d.y,l,u,me,h)))},$e=function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v;o.hasStripe(e)&&(r.save(),m?r.clip(h.pathCache):(o.nodeShapes[o.getNodeShape(e)].draw(r,d.x,d.y,l,u,me,h),r.clip()),o.drawStripe(r,e,be),r.restore(),Pe&&(m||o.nodeShapes[o.getNodeShape(e)].draw(r,d.x,d.y,l,u,me,h)))},Ze=function(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v,be=(P>0?P:-P)*Pe,X=P>0?0:255;P!==0&&(o.colorFillStyle(r,X,X,X,be),m?r.fill(y):r.fill())},Ie=function(){if(F>0){if(r.lineWidth=F,r.lineCap=_,r.lineJoin=V,r.setLineDash)switch(L){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(K),r.lineDashOffset=z;break;case"solid":case"double":r.setLineDash([]);break}if(G!=="center"){if(r.save(),r.lineWidth*=2,G==="inside")m?r.clip(y):r.clip();else{var Pe=new Path2D;Pe.rect(-l/2-F,-u/2-F,l+2*F,u+2*F),Pe.addPath(y),r.clip(Pe,"evenodd")}m?r.stroke(y):r.stroke(),r.restore()}else m?r.stroke(y):r.stroke();if(L==="double"){r.lineWidth=F/3;var be=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",m?r.stroke(y):r.stroke(),r.globalCompositeOperation=be}r.setLineDash&&r.setLineDash([])}},_e=function(){if(Z>0){if(r.lineWidth=Z,r.lineCap="butt",r.setLineDash)switch(ee){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"solid":case"double":r.setLineDash([]);break}var Pe=d;m&&(Pe={x:0,y:0});var be=o.getNodeShape(e),X=F;G==="inside"&&(X=0),G==="outside"&&(X*=2);var ce=(l+X+(Z+oe))/l,ge=(u+X+(Z+oe))/u,pe=l*ce,xe=u*ge,Fe=o.nodeShapes[be].points,Se;if(m){var ze=ae(pe,xe,be,Fe);Se=ze.path}if(be==="ellipse")o.drawEllipsePath(Se||r,Pe.x,Pe.y,pe,xe);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(be)){var ke=0,Ke=0,mt=0;be==="round-diamond"?ke=(X+oe+Z)*1.4:be==="round-heptagon"?(ke=(X+oe+Z)*1.075,mt=-(X/2+oe+Z)/35):be==="round-hexagon"?ke=(X+oe+Z)*1.12:be==="round-pentagon"?(ke=(X+oe+Z)*1.13,mt=-(X/2+oe+Z)/15):be==="round-tag"?(ke=(X+oe+Z)*1.12,Ke=(X/2+Z+oe)*.07):be==="round-triangle"&&(ke=(X+oe+Z)*(Math.PI/2),mt=-(X+oe/2+Z)/Math.PI),ke!==0&&(ce=(l+ke)/l,pe=l*ce,["round-hexagon","round-tag"].includes(be)||(ge=(u+ke)/u,xe=u*ge)),me=me==="auto"?lE(pe,xe):me;for(var ct=pe/2,qe=xe/2,dt=me+(X+Z+oe)/2,ft=new Array(Fe.length/2),vr=new Array(Fe.length/2),ar=0;ar<Fe.length/2;ar++)ft[ar]={x:Pe.x+Ke+ct*Fe[ar*2],y:Pe.y+mt+qe*Fe[ar*2+1]};var sr,wt,Dt,Wt,br=ft.length;for(wt=ft[br-1],sr=0;sr<br;sr++)Dt=ft[sr%br],Wt=ft[(sr+1)%br],vr[sr]=R2(wt,Dt,Wt,dt),wt=Dt,Dt=Wt;o.drawRoundPolygonPath(Se||r,Pe.x+Ke,Pe.y+mt,l*ce,u*ge,Fe,vr)}else if(["roundrectangle","round-rectangle"].includes(be))me=me==="auto"?As(pe,xe):me,o.drawRoundRectanglePath(Se||r,Pe.x,Pe.y,pe,xe,me+(X+Z+oe)/2);else if(["cutrectangle","cut-rectangle"].includes(be))me=me==="auto"?y2():me,o.drawCutRectanglePath(Se||r,Pe.x,Pe.y,pe,xe,null,me+(X+Z+oe)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(be))me=me==="auto"?As(pe,xe):me,o.drawBottomRoundRectanglePath(Se||r,Pe.x,Pe.y,pe,xe,me+(X+Z+oe)/2);else if(be==="barrel")o.drawBarrelPath(Se||r,Pe.x,Pe.y,pe,xe);else if(be.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(be)){var Mi=(X+Z+oe)/l;Fe=qd(Gd(Fe,Mi)),o.drawPolygonPath(Se||r,Pe.x,Pe.y,l,u,Fe)}else{var mr=(X+Z+oe)/l;Fe=qd(Gd(Fe,-mr)),o.drawPolygonPath(Se||r,Pe.x,Pe.y,l,u,Fe)}if(m?r.stroke(Se):r.stroke(),ee==="double"){r.lineWidth=X/3;var Xn=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",m?r.stroke(Se):r.stroke(),r.globalCompositeOperation=Xn}r.setLineDash&&r.setLineDash([])}},je=function(){a&&o.drawNodeOverlay(r,e,d,l,u)},it=function(){a&&o.drawNodeUnderlay(r,e,d,l,u)},Xe=function(){o.drawElementText(r,e,null,i)},ht=e.pstyle("ghost").value==="yes";if(ht){var vt=e.pstyle("ghost-offset-x").pfValue,ot=e.pstyle("ghost-offset-y").pfValue,pt=e.pstyle("ghost-opacity").value,lt=pt*v;r.translate(vt,ot),re(),_e(),ye(pt*O),Le(),bt(lt,!0),ve(pt*Y),Ie(),He(P!==0||F!==0),$e(P!==0||F!==0),bt(lt,!1),Ze(lt),r.translate(-vt,-ot)}m&&r.translate(-d.x,-d.y),it(),m&&r.translate(d.x,d.y),re(),_e(),ye(),Le(),bt(v,!0),ve(),Ie(),He(P!==0||F!==0),$e(P!==0||F!==0),bt(v,!1),Ze(),m&&r.translate(-d.x,-d.y),Xe(),je(),n&&r.translate(A.x1,A.y1)}};var gS=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(n,i,a,s,o){var l=this;if(i.visible()){var u=i.pstyle("".concat(e,"-padding")).pfValue,c=i.pstyle("".concat(e,"-opacity")).value,h=i.pstyle("".concat(e,"-color")).value,d=i.pstyle("".concat(e,"-shape")).value,v=i.pstyle("".concat(e,"-corner-radius")).value;if(c>0){if(a=a||i.position(),s==null||o==null){var m=i.padding();s=i.width()+2*m,o=i.height()+2*m}l.colorFillStyle(n,h[0],h[1],h[2],c),l.nodeShapes[d].draw(n,a.x,a.y,s+u*2,o+u*2,v),n.fill()}}}};Ts.drawNodeOverlay=gS("overlay");Ts.drawNodeUnderlay=gS("underlay");Ts.hasPie=function(r){return r=r[0],r._private.hasPie};Ts.hasStripe=function(r){return r=r[0],r._private.hasStripe};Ts.drawPie=function(r,e,n,i){e=e[0],i=i||e.position();var a=e.cy().style(),s=e.pstyle("pie-size"),o=e.pstyle("pie-hole"),l=e.pstyle("pie-start-angle").pfValue,u=i.x,c=i.y,h=e.width(),d=e.height(),v=Math.min(h,d)/2,m,y=0,b=this.usePaths();if(b&&(u=0,c=0),s.units==="%"?v=v*s.pfValue:s.pfValue!==void 0&&(v=s.pfValue/2),o.units==="%"?m=v*o.pfValue:o.pfValue!==void 0&&(m=o.pfValue/2),!(m>=v))for(var x=1;x<=a.pieBackgroundN;x++){var A=e.pstyle("pie-"+x+"-background-size").value,C=e.pstyle("pie-"+x+"-background-color").value,E=e.pstyle("pie-"+x+"-background-opacity").value*n,S=A/100;S+y>1&&(S=1-y);var T=1.5*Math.PI+2*Math.PI*y;T+=l;var R=2*Math.PI*S,D=T+R;A===0||y>=1||y+S>1||(m===0?(r.beginPath(),r.moveTo(u,c),r.arc(u,c,v,T,D),r.closePath()):(r.beginPath(),r.arc(u,c,v,T,D),r.arc(u,c,m,D,T,!0),r.closePath()),this.colorFillStyle(r,C[0],C[1],C[2],E),r.fill(),y+=S)}};Ts.drawStripe=function(r,e,n,i){e=e[0],i=i||e.position();var a=e.cy().style(),s=i.x,o=i.y,l=e.width(),u=e.height(),c=0,h=this.usePaths();r.save();var d=e.pstyle("stripe-direction").value,v=e.pstyle("stripe-size");switch(d){case"vertical":break;case"righward":r.rotate(-Math.PI/2);break}var m=l,y=u;v.units==="%"?(m=m*v.pfValue,y=y*v.pfValue):v.pfValue!==void 0&&(m=v.pfValue,y=v.pfValue),h&&(s=0,o=0),o-=m/2,s-=y/2;for(var b=1;b<=a.stripeBackgroundN;b++){var x=e.pstyle("stripe-"+b+"-background-size").value,A=e.pstyle("stripe-"+b+"-background-color").value,C=e.pstyle("stripe-"+b+"-background-opacity").value*n,E=x/100;E+c>1&&(E=1-c),!(x===0||c>=1||c+E>1)&&(r.beginPath(),r.rect(s,o+y*c,m,y*E),r.closePath(),this.colorFillStyle(r,A[0],A[1],A[2],C),r.fill(),c+=E)}r.restore()};var An={},PN=100;An.getPixelRatio=function(){var r=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),n=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/n};An.paintCache=function(r){for(var e=this.paintCaches=this.paintCaches||[],n=!0,i,a=0;a<e.length;a++)if(i=e[a],i.context===r){n=!1;break}return n&&(i={context:r},e.push(i)),i};An.createGradientStyleFor=function(r,e,n,i,a){var s,o=this.usePaths(),l=n.pstyle(e+"-gradient-stop-colors").value,u=n.pstyle(e+"-gradient-stop-positions").pfValue;if(i==="radial-gradient")if(n.isEdge()){var c=n.sourceEndpoint(),h=n.targetEndpoint(),d=n.midpoint(),v=fo(c,d),m=fo(h,d);s=r.createRadialGradient(d.x,d.y,0,d.x,d.y,Math.max(v,m))}else{var y=o?{x:0,y:0}:n.position(),b=n.paddedWidth(),x=n.paddedHeight();s=r.createRadialGradient(y.x,y.y,0,y.x,y.y,Math.max(b,x))}else if(n.isEdge()){var A=n.sourceEndpoint(),C=n.targetEndpoint();s=r.createLinearGradient(A.x,A.y,C.x,C.y)}else{var E=o?{x:0,y:0}:n.position(),S=n.paddedWidth(),T=n.paddedHeight(),R=S/2,D=T/2,B=n.pstyle("background-gradient-direction").value;switch(B){case"to-bottom":s=r.createLinearGradient(E.x,E.y-D,E.x,E.y+D);break;case"to-top":s=r.createLinearGradient(E.x,E.y+D,E.x,E.y-D);break;case"to-left":s=r.createLinearGradient(E.x+R,E.y,E.x-R,E.y);break;case"to-right":s=r.createLinearGradient(E.x-R,E.y,E.x+R,E.y);break;case"to-bottom-right":case"to-right-bottom":s=r.createLinearGradient(E.x-R,E.y-D,E.x+R,E.y+D);break;case"to-top-right":case"to-right-top":s=r.createLinearGradient(E.x-R,E.y+D,E.x+R,E.y-D);break;case"to-bottom-left":case"to-left-bottom":s=r.createLinearGradient(E.x+R,E.y-D,E.x-R,E.y+D);break;case"to-top-left":case"to-left-top":s=r.createLinearGradient(E.x+R,E.y+D,E.x-R,E.y-D);break}}if(!s)return null;for(var N=u.length===l.length,I=l.length,P=0;P<I;P++)s.addColorStop(N?u[P]:P/(I-1),"rgba("+l[P][0]+","+l[P][1]+","+l[P][2]+","+a+")");return s};An.gradientFillStyle=function(r,e,n,i){var a=this.createGradientStyleFor(r,"background",e,n,i);if(!a)return null;r.fillStyle=a};An.colorFillStyle=function(r,e,n,i,a){r.fillStyle="rgba("+e+","+n+","+i+","+a+")"};An.eleFillStyle=function(r,e,n){var i=e.pstyle("background-fill").value;if(i==="linear-gradient"||i==="radial-gradient")this.gradientFillStyle(r,e,i,n);else{var a=e.pstyle("background-color").value;this.colorFillStyle(r,a[0],a[1],a[2],n)}};An.gradientStrokeStyle=function(r,e,n,i){var a=this.createGradientStyleFor(r,"line",e,n,i);if(!a)return null;r.strokeStyle=a};An.colorStrokeStyle=function(r,e,n,i,a){r.strokeStyle="rgba("+e+","+n+","+i+","+a+")"};An.eleStrokeStyle=function(r,e,n){var i=e.pstyle("line-fill").value;if(i==="linear-gradient"||i==="radial-gradient")this.gradientStrokeStyle(r,e,i,n);else{var a=e.pstyle("line-color").value;this.colorStrokeStyle(r,a[0],a[1],a[2],n)}};An.matchCanvasSize=function(r){var e=this,n=e.data,i=e.findContainerClientCoords(),a=i[2],s=i[3],o=e.getPixelRatio(),l=e.motionBlurPxRatio;(r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(o=l);var u=a*o,c=s*o,h;if(!(u===e.canvasWidth&&c===e.canvasHeight)){e.fontCaches=null;var d=n.canvasContainer;d.style.width=a+"px",d.style.height=s+"px";for(var v=0;v<e.CANVAS_LAYERS;v++)h=n.canvases[v],h.width=u,h.height=c,h.style.width=a+"px",h.style.height=s+"px";for(var v=0;v<e.BUFFER_COUNT;v++)h=n.bufferCanvases[v],h.width=u,h.height=c,h.style.width=a+"px",h.style.height=s+"px";e.textureMult=1,o<=1&&(h=n.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,h.width=u*e.textureMult,h.height=c*e.textureMult),e.canvasWidth=u,e.canvasHeight=c,e.pixelRatio=o}};An.renderTo=function(r,e,n,i){this.render({forcedContext:r,forcedZoom:e,forcedPan:n,drawAllLayers:!0,forcedPxRatio:i})};An.clearCanvas=function(){var r=this,e=r.data;function n(i){i.clearRect(0,0,r.canvasWidth,r.canvasHeight)}n(e.contexts[r.NODE]),n(e.contexts[r.DRAG])};An.render=function(r){var e=this;r=r||rE();var n=e.cy,i=r.forcedContext,a=r.drawAllLayers,s=r.drawOnlyNodeLayer,o=r.forcedZoom,l=r.forcedPan,u=r.forcedPxRatio===void 0?this.getPixelRatio():r.forcedPxRatio,c=e.data,h=c.canvasNeedsRedraw,d=e.textureOnViewport&&!i&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),v=r.motionBlur!==void 0?r.motionBlur:e.motionBlur,m=e.motionBlurPxRatio,y=n.hasCompoundNodes(),b=e.hoverData.draggingEles,x=!!(e.hoverData.selecting||e.touchData.selecting);v=v&&!i&&e.motionBlurEnabled&&!x;var A=v;i||(e.prevPxRatio!==u&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=u),!i&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),v&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(A=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!d&&(h[e.NODE]=!0,h[e.SELECT_BOX]=!0);var C=n.style(),E=n.zoom(),S=o!==void 0?o:E,T=n.pan(),R={x:T.x,y:T.y},D={zoom:E,pan:{x:T.x,y:T.y}},B=e.prevViewport,N=B===void 0||D.zoom!==B.zoom||D.pan.x!==B.pan.x||D.pan.y!==B.pan.y;!N&&!(b&&!y)&&(e.motionBlurPxRatio=1),l&&(R=l),S*=u,R.x*=u,R.y*=u;var I=e.getCachedZSortedEles();function P(ve,re,ae,le,Ae){var Re=ve.globalCompositeOperation;ve.globalCompositeOperation="destination-out",e.colorFillStyle(ve,255,255,255,e.motionBlurTransparency),ve.fillRect(re,ae,le,Ae),ve.globalCompositeOperation=Re}function F(ve,re){var ae,le,Ae,Re;!e.clearingMotionBlur&&(ve===c.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||ve===c.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(ae={x:T.x*m,y:T.y*m},le=E*m,Ae=e.canvasWidth*m,Re=e.canvasHeight*m):(ae=R,le=S,Ae=e.canvasWidth,Re=e.canvasHeight),ve.setTransform(1,0,0,1,0,0),re==="motionBlur"?P(ve,0,0,Ae,Re):!i&&(re===void 0||re)&&ve.clearRect(0,0,Ae,Re),a||(ve.translate(ae.x,ae.y),ve.scale(le,le)),l&&ve.translate(l.x,l.y),o&&ve.scale(o,o)}if(d||(e.textureDrawLastFrame=!1),d){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=n.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var O=e.data.bufferContexts[e.TEXTURE_BUFFER];O.setTransform(1,0,0,1,0,0),O.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:O,drawOnlyNodeLayer:!0,forcedPxRatio:u*e.textureMult});var D=e.textureCache.viewport={zoom:n.zoom(),pan:n.pan(),width:e.canvasWidth,height:e.canvasHeight};D.mpan={x:(0-D.pan.x)/D.zoom,y:(0-D.pan.y)/D.zoom}}h[e.DRAG]=!1,h[e.NODE]=!1;var U=c.contexts[e.NODE],L=e.textureCache.texture,D=e.textureCache.viewport;U.setTransform(1,0,0,1,0,0),v?P(U,0,0,D.width,D.height):U.clearRect(0,0,D.width,D.height);var V=C.core("outside-texture-bg-color").value,_=C.core("outside-texture-bg-opacity").value;e.colorFillStyle(U,V[0],V[1],V[2],_),U.fillRect(0,0,D.width,D.height);var E=n.zoom();F(U,!1),U.clearRect(D.mpan.x,D.mpan.y,D.width/D.zoom/u,D.height/D.zoom/u),U.drawImage(L,D.mpan.x,D.mpan.y,D.width/D.zoom/u,D.height/D.zoom/u)}else e.textureOnViewport&&!i&&(e.textureCache=null);var G=n.extent(),K=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),z=e.hideEdgesOnViewport&&K,Y=[];if(Y[e.NODE]=!h[e.NODE]&&v&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,Y[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),Y[e.DRAG]=!h[e.DRAG]&&v&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,Y[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),h[e.NODE]||a||s||Y[e.NODE]){var Z=v&&!Y[e.NODE]&&m!==1,U=i||(Z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:c.contexts[e.NODE]),J=v&&!Z?"motionBlur":void 0;F(U,J),z?e.drawCachedNodes(U,I.nondrag,u,G):e.drawLayeredElements(U,I.nondrag,u,G),e.debug&&e.drawDebugPoints(U,I.nondrag),!a&&!v&&(h[e.NODE]=!1)}if(!s&&(h[e.DRAG]||a||Y[e.DRAG])){var Z=v&&!Y[e.DRAG]&&m!==1,U=i||(Z?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:c.contexts[e.DRAG]);F(U,v&&!Z?"motionBlur":void 0),z?e.drawCachedNodes(U,I.drag,u,G):e.drawCachedElements(U,I.drag,u,G),e.debug&&e.drawDebugPoints(U,I.drag),!a&&!v&&(h[e.DRAG]=!1)}if(this.drawSelectionRectangle(r,F),v&&m!==1){var ee=c.contexts[e.NODE],ne=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],oe=c.contexts[e.DRAG],me=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],ye=function(re,ae,le){re.setTransform(1,0,0,1,0,0),le||!A?re.clearRect(0,0,e.canvasWidth,e.canvasHeight):P(re,0,0,e.canvasWidth,e.canvasHeight);var Ae=m;re.drawImage(ae,0,0,e.canvasWidth*Ae,e.canvasHeight*Ae,0,0,e.canvasWidth,e.canvasHeight)};(h[e.NODE]||Y[e.NODE])&&(ye(ee,ne,Y[e.NODE]),h[e.NODE]=!1),(h[e.DRAG]||Y[e.DRAG])&&(ye(oe,me,Y[e.DRAG]),h[e.DRAG]=!1)}e.prevViewport=D,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),v&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!d,e.mbFrames=0,h[e.NODE]=!0,h[e.DRAG]=!0,e.redraw()},PN)),i||n.emit("render")};var Ku;An.drawSelectionRectangle=function(r,e){var n=this,i=n.cy,a=n.data,s=i.style(),o=r.drawOnlyNodeLayer,l=r.drawAllLayers,u=a.canvasNeedsRedraw,c=r.forcedContext;if(n.showFps||!o&&u[n.SELECT_BOX]&&!l){var h=c||a.contexts[n.SELECT_BOX];if(e(h),n.selection[4]==1&&(n.hoverData.selecting||n.touchData.selecting)){var d=n.cy.zoom(),v=s.core("selection-box-border-width").value/d;h.lineWidth=v,h.fillStyle="rgba("+s.core("selection-box-color").value[0]+","+s.core("selection-box-color").value[1]+","+s.core("selection-box-color").value[2]+","+s.core("selection-box-opacity").value+")",h.fillRect(n.selection[0],n.selection[1],n.selection[2]-n.selection[0],n.selection[3]-n.selection[1]),v>0&&(h.strokeStyle="rgba("+s.core("selection-box-border-color").value[0]+","+s.core("selection-box-border-color").value[1]+","+s.core("selection-box-border-color").value[2]+","+s.core("selection-box-opacity").value+")",h.strokeRect(n.selection[0],n.selection[1],n.selection[2]-n.selection[0],n.selection[3]-n.selection[1]))}if(a.bgActivePosistion&&!n.hoverData.selecting){var d=n.cy.zoom(),m=a.bgActivePosistion;h.fillStyle="rgba("+s.core("active-bg-color").value[0]+","+s.core("active-bg-color").value[1]+","+s.core("active-bg-color").value[2]+","+s.core("active-bg-opacity").value+")",h.beginPath(),h.arc(m.x,m.y,s.core("active-bg-size").pfValue/d,0,2*Math.PI),h.fill()}var y=n.lastRedrawTime;if(n.showFps&&y){y=Math.round(y);var b=Math.round(1e3/y),x="1 frame = "+y+" ms = "+b+" fps";if(h.setTransform(1,0,0,1,0,0),h.fillStyle="rgba(255, 0, 0, 0.75)",h.strokeStyle="rgba(255, 0, 0, 0.75)",h.font="30px Arial",!Ku){var A=h.measureText(x);Ku=A.actualBoundingBoxAscent}h.fillText(x,0,Ku);var C=60;h.strokeRect(0,Ku+10,250,20),h.fillRect(0,Ku+10,250*Math.min(b/C,1),20)}l||(u[n.SELECT_BOX]=!1)}};function N3(r,e,n){var i=r.createShader(e);if(r.shaderSource(i,n),r.compileShader(i),!r.getShaderParameter(i,r.COMPILE_STATUS))throw new Error(r.getShaderInfoLog(i));return i}function UN(r,e,n){var i=N3(r,r.VERTEX_SHADER,e),a=N3(r,r.FRAGMENT_SHADER,n),s=r.createProgram();if(r.attachShader(s,i),r.attachShader(s,a),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))throw new Error("Could not initialize shaders");return s}function VN(r,e,n){n===void 0&&(n=e);var i=r.makeOffscreenCanvas(e,n),a=i.context=i.getContext("2d");return i.clear=function(){return a.clearRect(0,0,i.width,i.height)},i.clear(),i}function N2(r){var e=r.pixelRatio,n=r.cy.zoom(),i=r.cy.pan();return{zoom:n*e,pan:{x:i.x*e,y:i.y*e}}}function ON(r){var e=r.pixelRatio,n=r.cy.zoom();return n*e}function LN(r,e,n,i,a){var s=i*n+e.x,o=a*n+e.y;return o=Math.round(r.canvasHeight-o),[s,o]}function _N(r){return r.pstyle("background-fill").value!=="solid"||r.pstyle("background-image").strValue!=="none"?!1:r.pstyle("border-width").value===0||r.pstyle("border-opacity").value===0?!0:r.pstyle("border-style").value==="solid"}function zN(r,e){if(r.length!==e.length)return!1;for(var n=0;n<r.length;n++)if(r[n]!==e[n])return!1;return!0}function Ks(r,e,n){var i=r[0]/255,a=r[1]/255,s=r[2]/255,o=e,l=n||new Array(4);return l[0]=i*o,l[1]=a*o,l[2]=s*o,l[3]=o,l}function dl(r,e){var n=e||new Array(4);return n[0]=(r>>0&255)/255,n[1]=(r>>8&255)/255,n[2]=(r>>16&255)/255,n[3]=(r>>24&255)/255,n}function qN(r){return r[0]+(r[1]<<8)+(r[2]<<16)+(r[3]<<24)}function GN(r,e){var n=r.createTexture();return n.buffer=function(i){r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,i),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null)},n.deleteTexture=function(){r.deleteTexture(n)},n}function vS(r,e){switch(e){case"float":return[1,r.FLOAT,4];case"vec2":return[2,r.FLOAT,4];case"vec3":return[3,r.FLOAT,4];case"vec4":return[4,r.FLOAT,4];case"int":return[1,r.INT,4];case"ivec2":return[2,r.INT,4]}}function mS(r,e,n){switch(e){case r.FLOAT:return new Float32Array(n);case r.INT:return new Int32Array(n)}}function YN(r,e,n,i,a,s){switch(e){case r.FLOAT:return new Float32Array(n.buffer,s*i,a);case r.INT:return new Int32Array(n.buffer,s*i,a)}}function HN(r,e,n,i){var a=vS(r,e),s=Rr(a,2),o=s[0],l=s[1],u=mS(r,l,i),c=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,c),r.bufferData(r.ARRAY_BUFFER,u,r.STATIC_DRAW),l===r.FLOAT?r.vertexAttribPointer(n,o,l,!1,0,0):l===r.INT&&r.vertexAttribIPointer(n,o,l,0,0),r.enableVertexAttribArray(n),r.bindBuffer(r.ARRAY_BUFFER,null),c}function Ui(r,e,n,i){var a=vS(r,n),s=Rr(a,3),o=s[0],l=s[1],u=s[2],c=mS(r,l,e*o),h=o*u,d=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,d),r.bufferData(r.ARRAY_BUFFER,e*h,r.DYNAMIC_DRAW),r.enableVertexAttribArray(i),l===r.FLOAT?r.vertexAttribPointer(i,o,l,!1,h,0):l===r.INT&&r.vertexAttribIPointer(i,o,l,h,0),r.vertexAttribDivisor(i,1),r.bindBuffer(r.ARRAY_BUFFER,null);for(var v=new Array(e),m=0;m<e;m++)v[m]=YN(r,l,c,h,o,m);return d.dataArray=c,d.stride=h,d.size=o,d.getView=function(y){return v[y]},d.setPoint=function(y,b,x){var A=v[y];A[0]=b,A[1]=x},d.bufferSubData=function(y){r.bindBuffer(r.ARRAY_BUFFER,d),y?r.bufferSubData(r.ARRAY_BUFFER,0,c,0,y*o):r.bufferSubData(r.ARRAY_BUFFER,0,c)},d}function jN(r,e,n){for(var i=9,a=new Float32Array(e*i),s=new Array(e),o=0;o<e;o++){var l=o*i*4;s[o]=new Float32Array(a.buffer,l,i)}var u=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,u),r.bufferData(r.ARRAY_BUFFER,a.byteLength,r.DYNAMIC_DRAW);for(var c=0;c<3;c++){var h=n+c;r.enableVertexAttribArray(h),r.vertexAttribPointer(h,3,r.FLOAT,!1,36,c*12),r.vertexAttribDivisor(h,1)}return r.bindBuffer(r.ARRAY_BUFFER,null),u.getMatrixView=function(d){return s[d]},u.setData=function(d,v){s[v].set(d,0)},u.bufferSubData=function(){r.bindBuffer(r.ARRAY_BUFFER,u),r.bufferSubData(r.ARRAY_BUFFER,0,a)},u}function KN(r){var e=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,e);var n=r.createTexture();return r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0),r.bindFramebuffer(r.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(i,a){r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i,a,0,r.RGBA,r.UNSIGNED_BYTE,null)},e}var F3=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function Rm(){var r=new F3(9);return F3!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function k3(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function XN(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],d=e[8],v=n[0],m=n[1],y=n[2],b=n[3],x=n[4],A=n[5],C=n[6],E=n[7],S=n[8];return r[0]=v*i+m*o+y*c,r[1]=v*a+m*l+y*h,r[2]=v*s+m*u+y*d,r[3]=b*i+x*o+A*c,r[4]=b*a+x*l+A*h,r[5]=b*s+x*u+A*d,r[6]=C*i+E*o+S*c,r[7]=C*a+E*l+S*h,r[8]=C*s+E*u+S*d,r}function Ed(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],d=e[8],v=n[0],m=n[1];return r[0]=i,r[1]=a,r[2]=s,r[3]=o,r[4]=l,r[5]=u,r[6]=v*i+m*o+c,r[7]=v*a+m*l+h,r[8]=v*s+m*u+d,r}function P3(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],d=e[8],v=Math.sin(n),m=Math.cos(n);return r[0]=m*i+v*o,r[1]=m*a+v*l,r[2]=m*s+v*u,r[3]=m*o-v*i,r[4]=m*l-v*a,r[5]=m*u-v*s,r[6]=c,r[7]=h,r[8]=d,r}function Mp(r,e,n){var i=n[0],a=n[1];return r[0]=i*e[0],r[1]=i*e[1],r[2]=i*e[2],r[3]=a*e[3],r[4]=a*e[4],r[5]=a*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function QN(r,e,n){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/n,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}var WN=(function(){function r(e,n,i,a){Cs(this,r),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.texSize=n,this.texRows=i,this.texHeight=Math.floor(n/i),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=a(e,n,n),this.scratch=a(e,n,this.texHeight,"scratch")}return Es(r,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(n){var i=n.w,a=n.h,s=this.texHeight,o=this.texSize,l=s/a,u=i*l,c=a*l;return u>o&&(l=o/i,u=i*l,c=a*l),{scale:l,texW:u,texH:c}}},{key:"draw",value:function(n,i,a){var s=this;if(this.locked)throw new Error("can't draw, atlas is locked");var o=this.texSize,l=this.texRows,u=this.texHeight,c=this.getScale(i),h=c.scale,d=c.texW,v=c.texH,m=function(E,S){if(a&&S){var T=S.context,R=E.x,D=E.row,B=R,N=u*D;T.save(),T.translate(B,N),T.scale(h,h),a(T,i),T.restore()}},y=[null,null],b=function(){m(s.freePointer,s.canvas),y[0]={x:s.freePointer.x,y:s.freePointer.row*u,w:d,h:v},y[1]={x:s.freePointer.x+d,y:s.freePointer.row*u,w:0,h:v},s.freePointer.x+=d,s.freePointer.x==o&&(s.freePointer.x=0,s.freePointer.row++)},x=function(){var E=s.scratch,S=s.canvas;E.clear(),m({x:0,row:0},E);var T=o-s.freePointer.x,R=d-T,D=u;{var B=s.freePointer.x,N=s.freePointer.row*u,I=T;S.context.drawImage(E,0,0,I,D,B,N,I,D),y[0]={x:B,y:N,w:I,h:v}}{var P=T,F=(s.freePointer.row+1)*u,O=R;S&&S.context.drawImage(E,P,0,O,D,0,F,O,D),y[1]={x:0,y:F,w:O,h:v}}s.freePointer.x=R,s.freePointer.row++},A=function(){s.freePointer.x=0,s.freePointer.row++};if(this.freePointer.x+d<=o)b();else{if(this.freePointer.row>=l-1)return!1;this.freePointer.x===o?(A(),b()):this.enableWrapping?x():(A(),b())}return this.keyToLocation.set(n,y),this.needsBuffer=!0,y}},{key:"getOffsets",value:function(n){return this.keyToLocation.get(n)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(n){if(this.locked)return!1;var i=this.texSize,a=this.texRows,s=this.getScale(n),o=s.texW;return this.freePointer.x+o>i?this.freePointer.row<a-1:!0}},{key:"bufferIfNeeded",value:function(n){this.texture||(this.texture=GN(n,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])})(),ZN=(function(){function r(e,n,i,a){Cs(this,r),this.r=e,this.texSize=n,this.texRows=i,this.createTextureCanvas=a,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return Es(r,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var n=this.r,i=this.texSize,a=this.texRows,s=this.createTextureCanvas;return new WN(n,i,a,s)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var n=this.r,i=this.texSize,a=this.texRows,s=this.createTextureCanvas,o=Math.floor(i/a);this.scratch=s(n,i,o,"scratch")}return this.scratch}},{key:"draw",value:function(n,i,a){var s=this.styleKeyToAtlas.get(n);return s||(s=this.atlases[this.atlases.length-1],(!s||!s.canFit(i))&&(s&&s.lock(),s=this._createAtlas(),this.atlases.push(s)),s.draw(n,i,a),this.styleKeyToAtlas.set(n,s)),s}},{key:"getAtlas",value:function(n){return this.styleKeyToAtlas.get(n)}},{key:"hasAtlas",value:function(n){return this.styleKeyToAtlas.has(n)}},{key:"markKeyForGC",value:function(n){this.markedKeys.add(n)}},{key:"gc",value:function(){var n=this,i=this.markedKeys;if(i.size===0){console.log("nothing to garbage collect");return}var a=[],s=new Map,o=null,l=Bn(this.atlases),u;try{var c=function(){var d=u.value,v=d.getKeys(),m=JN(i,v);if(m.size===0)return a.push(d),v.forEach(function(T){return s.set(T,d)}),1;o||(o=n._createAtlas(),a.push(o));var y=Bn(v),b;try{for(y.s();!(b=y.n()).done;){var x=b.value;if(!m.has(x)){var A=d.getOffsets(x),C=Rr(A,2),E=C[0],S=C[1];o.canFit({w:E.w+S.w,h:E.h})||(o.lock(),o=n._createAtlas(),a.push(o)),d.canvas&&(n._copyTextureToNewAtlas(x,d,o),s.set(x,o))}}}catch(T){y.e(T)}finally{y.f()}d.dispose()};for(l.s();!(u=l.n()).done;)c()}catch(h){l.e(h)}finally{l.f()}this.atlases=a,this.styleKeyToAtlas=s,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(n,i,a){var s=i.getOffsets(n),o=Rr(s,2),l=o[0],u=o[1];if(u.w===0)a.draw(n,l,function(v){v.drawImage(i.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h)});else{var c=this._getScratchCanvas();c.clear(),c.context.drawImage(i.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h),c.context.drawImage(i.canvas,u.x,u.y,u.w,u.h,l.w,0,u.w,u.h);var h=l.w+u.w,d=l.h;a.draw(n,{w:h,h:d},function(v){v.drawImage(c,0,0,h,d,0,0,h,d)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])})();function JN(r,e){return r.intersection?r.intersection(e):new Set(Od(r).filter(function(n){return e.has(n)}))}var $N=(function(){function r(e,n){Cs(this,r),this.r=e,this.globalOptions=n,this.atlasSize=n.webglTexSize,this.maxAtlasesPerBatch=n.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return Es(r,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(n,i){var a=this.globalOptions,s=a.webglTexSize,o=a.createTextureCanvas,l=i.texRows,u=this._cacheScratchCanvas(o),c=new ZN(this.r,s,l,u);this.collections.set(n,c)}},{key:"addRenderType",value:function(n,i){var a=i.collection;if(!this.collections.has(a))throw new Error("invalid atlas collection name '".concat(a,"'"));var s=this.collections.get(a),o=et({type:n,atlasCollection:s},i);this.renderTypes.set(n,o)}},{key:"getRenderTypeOpts",value:function(n){return this.renderTypes.get(n)}},{key:"getAtlasCollection",value:function(n){return this.collections.get(n)}},{key:"_cacheScratchCanvas",value:function(n){var i=-1,a=-1,s=null;return function(o,l,u,c){return c?((!s||l!=i||u!=a)&&(i=l,a=u,s=n(o,l,u)),s):n(o,l,u)}}},{key:"_key",value:function(n,i){return"".concat(n,"-").concat(i)}},{key:"invalidate",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.forceRedraw,o=s===void 0?!1:s,l=a.filterEle,u=l===void 0?function(){return!0}:l,c=a.filterType,h=c===void 0?function(){return!0}:c,d=!1,v=!1,m=Bn(n),y;try{for(m.s();!(y=m.n()).done;){var b=y.value;if(u(b)){var x=Bn(this.renderTypes.values()),A;try{var C=function(){var S=A.value,T=S.type;if(h(T)){var R=i.collections.get(S.collection),D=S.getKey(b),B=Array.isArray(D)?D:[D];if(o)B.forEach(function(F){return R.markKeyForGC(F)}),v=!0;else{var N=S.getID?S.getID(b):b.id(),I=i._key(T,N),P=i.typeAndIdToKey.get(I);P!==void 0&&!zN(B,P)&&(d=!0,i.typeAndIdToKey.delete(I),P.forEach(function(F){return R.markKeyForGC(F)}))}}};for(x.s();!(A=x.n()).done;)C()}catch(E){x.e(E)}finally{x.f()}}}}catch(E){m.e(E)}finally{m.f()}return v&&(this.gc(),d=!1),d}},{key:"gc",value:function(){var n=Bn(this.collections.values()),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;a.gc()}}catch(s){n.e(s)}finally{n.f()}}},{key:"getOrCreateAtlas",value:function(n,i,a,s){var o=this.renderTypes.get(i),l=this.collections.get(o.collection),u=!1,c=l.draw(s,a,function(v){o.drawClipped?(v.save(),v.beginPath(),v.rect(0,0,a.w,a.h),v.clip(),o.drawElement(v,n,a,!0,!0),v.restore()):o.drawElement(v,n,a,!0,!0),u=!0});if(u){var h=o.getID?o.getID(n):n.id(),d=this._key(i,h);this.typeAndIdToKey.has(d)?this.typeAndIdToKey.get(d).push(s):this.typeAndIdToKey.set(d,[s])}return c}},{key:"getAtlasInfo",value:function(n,i){var a=this,s=this.renderTypes.get(i),o=s.getKey(n),l=Array.isArray(o)?o:[o];return l.map(function(u){var c=s.getBoundingBox(n,u),h=a.getOrCreateAtlas(n,i,c,u),d=h.getOffsets(u),v=Rr(d,2),m=v[0],y=v[1];return{atlas:h,tex:m,tex1:m,tex2:y,bb:c}})}},{key:"getDebugInfo",value:function(){var n=[],i=Bn(this.collections),a;try{for(i.s();!(a=i.n()).done;){var s=Rr(a.value,2),o=s[0],l=s[1],u=l.getCounts(),c=u.keyCount,h=u.atlasCount;n.push({type:o,keyCount:c,atlasCount:h})}}catch(d){i.e(d)}finally{i.f()}return n}}])})(),eF=(function(){function r(e){Cs(this,r),this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.batchAtlases=[]}return Es(r,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(n,i){return i})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(n){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(n):!0}},{key:"getAtlasIndexForBatch",value:function(n){var i=this.batchAtlases.indexOf(n);if(i<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(n),i=this.batchAtlases.length-1}return i}}])})(),tF=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,rF=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,nF=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,iF=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,Tc={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},Wd={IGNORE:1,USE_BB:2},Bm=0,U3=1,V3=2,Im=3,gl=4,Gh=5,Xu=6,Qu=7,aF=(function(){function r(e,n,i){Cs(this,r),this.r=e,this.gl=n,this.maxInstances=i.webglBatchSize,this.atlasSize=i.webglTexSize,this.bgColor=i.bgColor,this.debug=i.webglDebug,this.batchDebugInfo=[],i.enableWrapping=!0,i.createTextureCanvas=VN,this.atlasManager=new $N(e,i),this.batchManager=new eF(i),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(Tc.SCREEN),this.pickingProgram=this._createShaderProgram(Tc.PICKING),this.vao=this._createVAO()}return Es(r,[{key:"addAtlasCollection",value:function(n,i){this.atlasManager.addAtlasCollection(n,i)}},{key:"addTextureAtlasRenderType",value:function(n,i){this.atlasManager.addRenderType(n,i)}},{key:"addSimpleShapeRenderType",value:function(n,i){this.simpleShapeOptions.set(n,i)}},{key:"invalidate",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.type,s=this.atlasManager;return a?s.invalidate(n,{filterType:function(l){return l===a},forceRedraw:!0}):s.invalidate(n)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(n){var i=this.gl,a=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(Bm,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(gl," || aVertType == ").concat(Qu,` 
             || aVertType == `).concat(Gh," || aVertType == ").concat(Xu,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(U3,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(V3,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(Im,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),s=this.batchManager.getIndexArray(),o=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(s.map(function(c){return"uniform sampler2D uTexture".concat(c,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(tF,`
      `).concat(rF,`
      `).concat(nF,`
      `).concat(iF,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(Bm,`) {
          // look up the texel from the texture unit
          `).concat(s.map(function(c){return"if(vAtlasId == ".concat(c,") outColor = texture(uTexture").concat(c,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(Im,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(gl,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(gl," || vVertType == ").concat(Qu,` 
          || vVertType == `).concat(Gh," || vVertType == ").concat(Xu,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(gl,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(Qu,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(Qu,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(n.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),l=UN(i,a,o);l.aPosition=i.getAttribLocation(l,"aPosition"),l.aIndex=i.getAttribLocation(l,"aIndex"),l.aVertType=i.getAttribLocation(l,"aVertType"),l.aTransform=i.getAttribLocation(l,"aTransform"),l.aAtlasId=i.getAttribLocation(l,"aAtlasId"),l.aTex=i.getAttribLocation(l,"aTex"),l.aPointAPointB=i.getAttribLocation(l,"aPointAPointB"),l.aPointCPointD=i.getAttribLocation(l,"aPointCPointD"),l.aLineWidth=i.getAttribLocation(l,"aLineWidth"),l.aColor=i.getAttribLocation(l,"aColor"),l.aCornerRadius=i.getAttribLocation(l,"aCornerRadius"),l.aBorderColor=i.getAttribLocation(l,"aBorderColor"),l.uPanZoomMatrix=i.getUniformLocation(l,"uPanZoomMatrix"),l.uAtlasSize=i.getUniformLocation(l,"uAtlasSize"),l.uBGColor=i.getUniformLocation(l,"uBGColor"),l.uZoom=i.getUniformLocation(l,"uZoom"),l.uTextures=[];for(var u=0;u<this.batchManager.getMaxAtlasesPerBatch();u++)l.uTextures.push(i.getUniformLocation(l,"uTexture".concat(u)));return l}},{key:"_createVAO",value:function(){var n=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=n.length/2;var i=this.maxInstances,a=this.gl,s=this.program,o=a.createVertexArray();return a.bindVertexArray(o),HN(a,"vec2",s.aPosition,n),this.transformBuffer=jN(a,i,s.aTransform),this.indexBuffer=Ui(a,i,"vec4",s.aIndex),this.vertTypeBuffer=Ui(a,i,"int",s.aVertType),this.atlasIdBuffer=Ui(a,i,"int",s.aAtlasId),this.texBuffer=Ui(a,i,"vec4",s.aTex),this.pointAPointBBuffer=Ui(a,i,"vec4",s.aPointAPointB),this.pointCPointDBuffer=Ui(a,i,"vec4",s.aPointCPointD),this.lineWidthBuffer=Ui(a,i,"vec2",s.aLineWidth),this.colorBuffer=Ui(a,i,"vec4",s.aColor),this.cornerRadiusBuffer=Ui(a,i,"vec4",s.aCornerRadius),this.borderColorBuffer=Ui(a,i,"vec4",s.aBorderColor),a.bindVertexArray(null),o}},{key:"buffers",get:function(){var n=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(i){return us(i,"Buffer")}).map(function(i){return n[i]})),this._buffers}},{key:"startFrame",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Tc.SCREEN;this.panZoomMatrix=n,this.renderTarget=i,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(n,i){return n.visible()?i&&i.isVisible?i.isVisible(n):!0:!1}},{key:"drawTexture",value:function(n,i,a){var s=this.atlasManager,o=this.batchManager,l=s.getRenderTypeOpts(a);if(this._isVisible(n,l)&&!(n.isEdge()&&!this._isValidEdge(n))){if(this.renderTarget.picking&&l.getTexPickingMode){var u=l.getTexPickingMode(n);if(u===Wd.IGNORE)return;if(u==Wd.USE_BB){this.drawPickingRectangle(n,i,a);return}}var c=s.getAtlasInfo(n,a),h=Bn(c),d;try{for(h.s();!(d=h.n()).done;){var v=d.value,m=v.atlas,y=v.tex1,b=v.tex2;o.canAddToCurrentBatch(m)||this.endBatch();for(var x=o.getAtlasIndexForBatch(m),A=0,C=[[y,!0],[b,!1]];A<C.length;A++){var E=Rr(C[A],2),S=E[0],T=E[1];if(S.w!=0){var R=this.instanceCount;this.vertTypeBuffer.getView(R)[0]=Bm;var D=this.indexBuffer.getView(R);dl(i,D);var B=this.atlasIdBuffer.getView(R);B[0]=x;var N=this.texBuffer.getView(R);N[0]=S.x,N[1]=S.y,N[2]=S.w,N[3]=S.h;var I=this.transformBuffer.getMatrixView(R);this.setTransformMatrix(n,I,l,v,T),this.instanceCount++,T||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(P){h.e(P)}finally{h.f()}}}},{key:"setTransformMatrix",value:function(n,i,a,s){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,l=0;if(a.shapeProps&&a.shapeProps.padding&&(l=n.pstyle(a.shapeProps.padding).pfValue),s){var u=s.bb,c=s.tex1,h=s.tex2,d=c.w/(c.w+h.w);o||(d=1-d);var v=this._getAdjustedBB(u,l,o,d);this._applyTransformMatrix(i,v,a,n)}else{var m=a.getBoundingBox(n),y=this._getAdjustedBB(m,l,!0,1);this._applyTransformMatrix(i,y,a,n)}}},{key:"_applyTransformMatrix",value:function(n,i,a,s){var o,l;k3(n);var u=a.getRotation?a.getRotation(s):0;if(u!==0){var c=a.getRotationPoint(s),h=c.x,d=c.y;Ed(n,n,[h,d]),P3(n,n,u);var v=a.getRotationOffset(s);o=v.x+(i.xOffset||0),l=v.y+(i.yOffset||0)}else o=i.x1,l=i.y1;Ed(n,n,[o,l]),Mp(n,n,[i.w,i.h])}},{key:"_getAdjustedBB",value:function(n,i,a,s){var o=n.x1,l=n.y1,u=n.w,c=n.h,h=n.yOffset;i&&(o-=i,l-=i,u+=2*i,c+=2*i);var d=0,v=u*s;return a&&s<1?u=v:!a&&s<1&&(d=u-v,o+=d,u=v),{x1:o,y1:l,w:u,h:c,xOffset:d,yOffset:h}}},{key:"drawPickingRectangle",value:function(n,i,a){var s=this.atlasManager.getRenderTypeOpts(a),o=this.instanceCount;this.vertTypeBuffer.getView(o)[0]=gl;var l=this.indexBuffer.getView(o);dl(i,l);var u=this.colorBuffer.getView(o);Ks([0,0,0],1,u);var c=this.transformBuffer.getMatrixView(o);this.setTransformMatrix(n,c,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(n,i,a){var s=this.simpleShapeOptions.get(a);if(this._isVisible(n,s)){var o=s.shapeProps,l=this._getVertTypeForShape(n,o.shape);if(l===void 0||s.isSimple&&!s.isSimple(n)){this.drawTexture(n,i,a);return}var u=this.instanceCount;if(this.vertTypeBuffer.getView(u)[0]=l,l===Gh||l===Xu){var c=s.getBoundingBox(n),h=this._getCornerRadius(n,o.radius,c),d=this.cornerRadiusBuffer.getView(u);d[0]=h,d[1]=h,d[2]=h,d[3]=h,l===Xu&&(d[0]=0,d[2]=0)}var v=this.indexBuffer.getView(u);dl(i,v);var m=n.pstyle(o.color).value,y=n.pstyle(o.opacity).value,b=this.colorBuffer.getView(u);Ks(m,y,b);var x=this.lineWidthBuffer.getView(u);if(x[0]=0,x[1]=0,o.border){var A=n.pstyle("border-width").value;if(A>0){var C=n.pstyle("border-color").value,E=n.pstyle("border-opacity").value,S=this.borderColorBuffer.getView(u);Ks(C,E,S);var T=n.pstyle("border-position").value;if(T==="inside")x[0]=0,x[1]=-A;else if(T==="outside")x[0]=A,x[1]=0;else{var R=A/2;x[0]=R,x[1]=-R}}}var D=this.transformBuffer.getMatrixView(u);this.setTransformMatrix(n,D,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(n,i){var a=n.pstyle(i).value;switch(a){case"rectangle":return gl;case"ellipse":return Qu;case"roundrectangle":case"round-rectangle":return Gh;case"bottom-round-rectangle":return Xu;default:return}}},{key:"_getCornerRadius",value:function(n,i,a){var s=a.w,o=a.h;if(n.pstyle(i).value==="auto")return As(s,o);var l=n.pstyle(i).pfValue,u=s/2,c=o/2;return Math.min(l,c,u)}},{key:"drawEdgeArrow",value:function(n,i,a){if(n.visible()){var s=n._private.rscratch,o,l,u;if(a==="source"?(o=s.arrowStartX,l=s.arrowStartY,u=s.srcArrowAngle):(o=s.arrowEndX,l=s.arrowEndY,u=s.tgtArrowAngle),!(isNaN(o)||o==null||isNaN(l)||l==null||isNaN(u)||u==null)){var c=n.pstyle(a+"-arrow-shape").value;if(c!=="none"){var h=n.pstyle(a+"-arrow-color").value,d=n.pstyle("opacity").value,v=n.pstyle("line-opacity").value,m=d*v,y=n.pstyle("width").pfValue,b=n.pstyle("arrow-scale").value,x=this.r.getArrowWidth(y,b),A=this.instanceCount,C=this.transformBuffer.getMatrixView(A);k3(C),Ed(C,C,[o,l]),Mp(C,C,[x,x]),P3(C,C,u),this.vertTypeBuffer.getView(A)[0]=Im;var E=this.indexBuffer.getView(A);dl(i,E);var S=this.colorBuffer.getView(A);Ks(h,m,S),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(n,i){if(n.visible()){var a=this._getEdgePoints(n);if(a){var s=n.pstyle("opacity").value,o=n.pstyle("line-opacity").value,l=n.pstyle("width").pfValue,u=n.pstyle("line-color").value,c=s*o;if(a.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),a.length==4){var h=this.instanceCount;this.vertTypeBuffer.getView(h)[0]=U3;var d=this.indexBuffer.getView(h);dl(i,d);var v=this.colorBuffer.getView(h);Ks(u,c,v);var m=this.lineWidthBuffer.getView(h);m[0]=l;var y=this.pointAPointBBuffer.getView(h);y[0]=a[0],y[1]=a[1],y[2]=a[2],y[3]=a[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var b=0;b<a.length-2;b+=2){var x=this.instanceCount;this.vertTypeBuffer.getView(x)[0]=V3;var A=this.indexBuffer.getView(x);dl(i,A);var C=this.colorBuffer.getView(x);Ks(u,c,C);var E=this.lineWidthBuffer.getView(x);E[0]=l;var S=a[b-2],T=a[b-1],R=a[b],D=a[b+1],B=a[b+2],N=a[b+3],I=a[b+4],P=a[b+5];b==0&&(S=2*R-B+.001,T=2*D-N+.001),b==a.length-4&&(I=2*B-R+.001,P=2*N-D+.001);var F=this.pointAPointBBuffer.getView(x);F[0]=S,F[1]=T,F[2]=R,F[3]=D;var O=this.pointCPointDBuffer.getView(x);O[0]=B,O[1]=N,O[2]=I,O[3]=P,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(n){var i=n._private.rscratch;return!(i.badLine||i.allpts==null||isNaN(i.allpts[0]))}},{key:"_getEdgePoints",value:function(n){var i=n._private.rscratch;if(this._isValidEdge(n)){var a=i.allpts;if(a.length==4)return a;var s=this._getNumSegments(n);return this._getCurveSegmentPoints(a,s)}}},{key:"_getNumSegments",value:function(n){var i=15;return Math.min(Math.max(i,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(n,i){if(n.length==4)return n;for(var a=Array((i+1)*2),s=0;s<=i;s++)if(s==0)a[0]=n[0],a[1]=n[1];else if(s==i)a[s*2]=n[n.length-2],a[s*2+1]=n[n.length-1];else{var o=s/i;this._setCurvePoint(n,o,a,s*2)}return a}},{key:"_setCurvePoint",value:function(n,i,a,s){if(n.length<=2)a[s]=n[0],a[s+1]=n[1];else{for(var o=Array(n.length-2),l=0;l<o.length;l+=2){var u=(1-i)*n[l]+i*n[l+2],c=(1-i)*n[l+1]+i*n[l+3];o[l]=u,o[l+1]=c}return this._setCurvePoint(o,i,a,s)}}},{key:"endBatch",value:function(){var n=this.gl,i=this.vao,a=this.vertexCount,s=this.instanceCount;if(s!==0){var o=this.renderTarget.picking?this.pickingProgram:this.program;n.useProgram(o),n.bindVertexArray(i);var l=Bn(this.buffers),u;try{for(l.s();!(u=l.n()).done;){var c=u.value;c.bufferSubData(s)}}catch(y){l.e(y)}finally{l.f()}for(var h=this.batchManager.getAtlases(),d=0;d<h.length;d++)h[d].bufferIfNeeded(n);for(var v=0;v<h.length;v++)n.activeTexture(n.TEXTURE0+v),n.bindTexture(n.TEXTURE_2D,h[v].texture),n.uniform1i(o.uTextures[v],v);n.uniform1f(o.uZoom,ON(this.r)),n.uniformMatrix3fv(o.uPanZoomMatrix,!1,this.panZoomMatrix),n.uniform1i(o.uAtlasSize,this.batchManager.getAtlasSize());var m=Ks(this.bgColor,1);n.uniform4fv(o.uBGColor,m),n.drawArraysInstanced(n.TRIANGLES,0,a,s),n.bindVertexArray(null),n.bindTexture(n.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:s,atlasCount:h.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var n=this.atlasManager.getDebugInfo(),i=n.reduce(function(o,l){return o+l.atlasCount},0),a=this.batchDebugInfo,s=a.reduce(function(o,l){return o+l.count},0);return{atlasInfo:n,totalAtlases:i,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:a.length,batchInfo:a,totalInstances:s}}}])})(),pS={};pS.initWebgl=function(r,e){var n=this,i=n.data.contexts[n.WEBGL];r.bgColor=sF(n),r.webglTexSize=Math.min(r.webglTexSize,i.getParameter(i.MAX_TEXTURE_SIZE)),r.webglTexRows=Math.min(r.webglTexRows,54),r.webglTexRowsNodes=Math.min(r.webglTexRowsNodes,54),r.webglBatchSize=Math.min(r.webglBatchSize,16384),r.webglTexPerBatch=Math.min(r.webglTexPerBatch,i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS)),n.webglDebug=r.webglDebug,n.webglDebugShowAtlases=r.webglDebugShowAtlases,n.pickingFrameBuffer=KN(i),n.pickingFrameBuffer.needsDraw=!0,n.drawing=new aF(n,i,r);var a=function(d){return function(v){return n.getTextAngle(v,d)}},s=function(d){return function(v){var m=v.pstyle(d);return m&&m.value}},o=function(d){return function(v){return v.pstyle("".concat(d,"-opacity")).value>0}},l=function(d){var v=d.pstyle("text-events").strValue==="yes";return v?Wd.USE_BB:Wd.IGNORE},u=function(d){var v=d.position(),m=v.x,y=v.y,b=d.outerWidth(),x=d.outerHeight();return{w:b,h:x,x1:m-b/2,y1:y-x/2}};n.drawing.addAtlasCollection("node",{texRows:r.webglTexRowsNodes}),n.drawing.addAtlasCollection("label",{texRows:r.webglTexRows}),n.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement}),n.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:u,isSimple:_N,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),n.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:u,isVisible:o("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),n.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:u,isVisible:o("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),n.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:l,getKey:Nm(e.getLabelKey,null),getBoundingBox:Fm(e.getLabelBox,null),drawClipped:!0,drawElement:e.drawLabel,getRotation:a(null),getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:s("label")}),n.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:l,getKey:Nm(e.getSourceLabelKey,"source"),getBoundingBox:Fm(e.getSourceLabelBox,"source"),drawClipped:!0,drawElement:e.drawSourceLabel,getRotation:a("source"),getRotationPoint:e.getSourceLabelRotationPoint,getRotationOffset:e.getSourceLabelRotationOffset,isVisible:s("source-label")}),n.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:l,getKey:Nm(e.getTargetLabelKey,"target"),getBoundingBox:Fm(e.getTargetLabelBox,"target"),drawClipped:!0,drawElement:e.drawTargetLabel,getRotation:a("target"),getRotationPoint:e.getTargetLabelRotationPoint,getRotationOffset:e.getTargetLabelRotationOffset,isVisible:s("target-label")});var c=af(function(){console.log("garbage collect flag set"),n.data.gc=!0},1e4);n.onUpdateEleCalcs(function(h,d){var v=!1;d&&d.length>0&&(v|=n.drawing.invalidate(d)),v&&c()}),oF(n)};function sF(r){var e=r.cy.container(),n=e&&e.style&&e.style.backgroundColor||"white";return HC(n)}function yS(r,e){var n=r._private.rscratch;return Dn(n,"labelWrapCachedLines",e)||[]}var Nm=function(e,n){return function(i){var a=e(i),s=yS(i,n);return s.length>1?s.map(function(o,l){return"".concat(a,"_").concat(l)}):a}},Fm=function(e,n){return function(i,a){var s=e(i);if(typeof a=="string"){var o=a.indexOf("_");if(o>0){var l=Number(a.substring(o+1)),u=yS(i,n),c=s.h/u.length,h=c*l,d=s.y1+h;return{x1:s.x1,w:s.w,y1:d,h:c,yOffset:h}}}return s}};function oF(r){{var e=r.render;r.render=function(s){s=s||{};var o=r.cy;r.webgl&&(o.zoom()>cS?(lF(r),e.call(r,s)):(uF(r),xS(r,s,Tc.SCREEN)))}}{var n=r.matchCanvasSize;r.matchCanvasSize=function(s){n.call(r,s),r.pickingFrameBuffer.setFramebufferAttachmentSizes(r.canvasWidth,r.canvasHeight),r.pickingFrameBuffer.needsDraw=!0}}r.findNearestElements=function(s,o,l,u){return vF(r,s,o)};{var i=r.invalidateCachedZSortedEles;r.invalidateCachedZSortedEles=function(){i.call(r),r.pickingFrameBuffer.needsDraw=!0}}{var a=r.notify;r.notify=function(s,o){a.call(r,s,o),s==="viewport"||s==="bounds"?r.pickingFrameBuffer.needsDraw=!0:s==="background"&&r.drawing.invalidate(o,{type:"node-body"})}}}function lF(r){var e=r.data.contexts[r.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function uF(r){var e=function(i){i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,r.canvasWidth,r.canvasHeight),i.restore()};e(r.data.contexts[r.NODE]),e(r.data.contexts[r.DRAG])}function cF(r){var e=r.canvasWidth,n=r.canvasHeight,i=N2(r),a=i.pan,s=i.zoom,o=Rm();Ed(o,o,[a.x,a.y]),Mp(o,o,[s,s]);var l=Rm();QN(l,e,n);var u=Rm();return XN(u,l,o),u}function AS(r,e){var n=r.canvasWidth,i=r.canvasHeight,a=N2(r),s=a.pan,o=a.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,n,i),e.translate(s.x,s.y),e.scale(o,o)}function fF(r,e){r.drawSelectionRectangle(e,function(n){return AS(r,n)})}function hF(r){var e=r.data.contexts[r.NODE];e.save(),AS(r,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function dF(r){var e=function(a,s,o){for(var l=a.atlasManager.getAtlasCollection(s),u=r.data.contexts[r.NODE],c=l.atlases,h=0;h<c.length;h++){var d=c[h],v=d.canvas;if(v){var m=v.width,y=v.height,b=m*h,x=v.height*o,A=.4;u.save(),u.scale(A,A),u.drawImage(v,b,x),u.strokeStyle="black",u.rect(b,x,m,y),u.stroke(),u.restore()}}},n=0;e(r.drawing,"node",n++),e(r.drawing,"label",n++)}function gF(r,e,n,i,a){var s,o,l,u,c=N2(r),h=c.pan,d=c.zoom;{var v=LN(r,h,d,e,n),m=Rr(v,2),y=m[0],b=m[1],x=6;s=y-x/2,o=b-x/2,l=x,u=x}if(l===0||u===0)return[];var A=r.data.contexts[r.WEBGL];A.bindFramebuffer(A.FRAMEBUFFER,r.pickingFrameBuffer),r.pickingFrameBuffer.needsDraw&&(A.viewport(0,0,A.canvas.width,A.canvas.height),xS(r,null,Tc.PICKING),r.pickingFrameBuffer.needsDraw=!1);var C=l*u,E=new Uint8Array(C*4);A.readPixels(s,o,l,u,A.RGBA,A.UNSIGNED_BYTE,E),A.bindFramebuffer(A.FRAMEBUFFER,null);for(var S=new Set,T=0;T<C;T++){var R=E.slice(T*4,T*4+4),D=qN(R)-1;D>=0&&S.add(D)}return S}function vF(r,e,n){var i=gF(r,e,n),a=r.getCachedZSortedEles(),s,o,l=Bn(i),u;try{for(l.s();!(u=l.n()).done;){var c=u.value,h=a[c];if(!s&&h.isNode()&&(s=h),!o&&h.isEdge()&&(o=h),s&&o)break}}catch(d){l.e(d)}finally{l.f()}return[s,o].filter(Boolean)}function km(r,e,n){var i=r.drawing;e+=1,n.isNode()?(i.drawNode(n,e,"node-underlay"),i.drawNode(n,e,"node-body"),i.drawTexture(n,e,"label"),i.drawNode(n,e,"node-overlay")):(i.drawEdgeLine(n,e),i.drawEdgeArrow(n,e,"source"),i.drawEdgeArrow(n,e,"target"),i.drawTexture(n,e,"label"),i.drawTexture(n,e,"edge-source-label"),i.drawTexture(n,e,"edge-target-label"))}function xS(r,e,n){var i;r.webglDebug&&(i=performance.now());var a=r.drawing,s=0;if(n.screen&&r.data.canvasNeedsRedraw[r.SELECT_BOX]&&fF(r,e),r.data.canvasNeedsRedraw[r.NODE]||n.picking){var o=r.data.contexts[r.WEBGL];n.screen?(o.clearColor(0,0,0,0),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA)):o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.viewport(0,0,o.canvas.width,o.canvas.height);var l=cF(r),u=r.getCachedZSortedEles();if(s=u.length,a.startFrame(l,n),n.screen){for(var c=0;c<u.nondrag.length;c++)km(r,c,u.nondrag[c]);for(var h=0;h<u.drag.length;h++)km(r,h,u.drag[h])}else if(n.picking)for(var d=0;d<u.length;d++)km(r,d,u[d]);a.endFrame(),n.screen&&r.webglDebugShowAtlases&&(hF(r),dF(r)),r.data.canvasNeedsRedraw[r.NODE]=!1,r.data.canvasNeedsRedraw[r.DRAG]=!1}if(r.webglDebug){var v=performance.now(),m=!1,y=Math.ceil(v-i),b=a.getDebugInfo(),x=["".concat(s," elements"),"".concat(b.totalInstances," instances"),"".concat(b.batchCount," batches"),"".concat(b.totalAtlases," atlases"),"".concat(b.wrappedCount," wrapped textures"),"".concat(b.simpleCount," simple shapes")].join(", ");if(m)console.log("WebGL (".concat(n.name,") - time ").concat(y,"ms, ").concat(x));else{console.log("WebGL (".concat(n.name,") - frame time ").concat(y,"ms")),console.log("Totals:"),console.log("  ".concat(x)),console.log("Texture Atlases Used:");var A=b.atlasInfo,C=Bn(A),E;try{for(C.s();!(E=C.n()).done;){var S=E.value;console.log("  ".concat(S.type,": ").concat(S.keyCount," keys, ").concat(S.atlasCount," atlases"))}}catch(T){C.e(T)}finally{C.f()}console.log("")}}r.data.gc&&(console.log("Garbage Collect!"),r.data.gc=!1,a.gc())}var Ms={};Ms.drawPolygonPath=function(r,e,n,i,a,s){var o=i/2,l=a/2;r.beginPath&&r.beginPath(),r.moveTo(e+o*s[0],n+l*s[1]);for(var u=1;u<s.length/2;u++)r.lineTo(e+o*s[u*2],n+l*s[u*2+1]);r.closePath()};Ms.drawRoundPolygonPath=function(r,e,n,i,a,s,o){o.forEach(function(l){return tS(r,l)}),r.closePath()};Ms.drawRoundRectanglePath=function(r,e,n,i,a,s){var o=i/2,l=a/2,u=s==="auto"?As(i,a):Math.min(s,l,o);r.beginPath&&r.beginPath(),r.moveTo(e,n-l),r.arcTo(e+o,n-l,e+o,n,u),r.arcTo(e+o,n+l,e,n+l,u),r.arcTo(e-o,n+l,e-o,n,u),r.arcTo(e-o,n-l,e,n-l,u),r.lineTo(e,n-l),r.closePath()};Ms.drawBottomRoundRectanglePath=function(r,e,n,i,a,s){var o=i/2,l=a/2,u=s==="auto"?As(i,a):s;r.beginPath&&r.beginPath(),r.moveTo(e,n-l),r.lineTo(e+o,n-l),r.lineTo(e+o,n),r.arcTo(e+o,n+l,e,n+l,u),r.arcTo(e-o,n+l,e-o,n,u),r.lineTo(e-o,n-l),r.lineTo(e,n-l),r.closePath()};Ms.drawCutRectanglePath=function(r,e,n,i,a,s,o){var l=i/2,u=a/2,c=o==="auto"?y2():o;r.beginPath&&r.beginPath(),r.moveTo(e-l+c,n-u),r.lineTo(e+l-c,n-u),r.lineTo(e+l,n-u+c),r.lineTo(e+l,n+u-c),r.lineTo(e+l-c,n+u),r.lineTo(e-l+c,n+u),r.lineTo(e-l,n+u-c),r.lineTo(e-l,n-u+c),r.closePath()};Ms.drawBarrelPath=function(r,e,n,i,a){var s=i/2,o=a/2,l=e-s,u=e+s,c=n-o,h=n+o,d=dp(i,a),v=d.widthOffset,m=d.heightOffset,y=d.ctrlPtOffsetPct*v;r.beginPath&&r.beginPath(),r.moveTo(l,c+m),r.lineTo(l,h-m),r.quadraticCurveTo(l+y,h,l+v,h),r.lineTo(u-v,h),r.quadraticCurveTo(u-y,h,u,h-m),r.lineTo(u,c+m),r.quadraticCurveTo(u-y,c,u-v,c),r.lineTo(l+v,c),r.quadraticCurveTo(l+y,c,l,c+m),r.closePath()};var O3=Math.sin(0),L3=Math.cos(0),Dp={},Rp={},bS=Math.PI/40;for(var vl=0*Math.PI;vl<2*Math.PI;vl+=bS)Dp[vl]=Math.sin(vl),Rp[vl]=Math.cos(vl);Ms.drawEllipsePath=function(r,e,n,i,a){if(r.beginPath&&r.beginPath(),r.ellipse)r.ellipse(e,n,i/2,a/2,0,0,2*Math.PI);else for(var s,o,l=i/2,u=a/2,c=0*Math.PI;c<2*Math.PI;c+=bS)s=e-l*Dp[c]*O3+l*Rp[c]*L3,o=n+u*Rp[c]*O3+u*Dp[c]*L3,c===0?r.moveTo(s,o):r.lineTo(s,o);r.closePath()};var ff={};ff.createBuffer=function(r,e){var n=document.createElement("canvas");return n.width=r,n.height=e,[n,n.getContext("2d")]};ff.bufferCanvasImage=function(r){var e=this.cy,n=e.mutableElements(),i=n.boundingBox(),a=this.findContainerClientCoords(),s=r.full?Math.ceil(i.w):a[2],o=r.full?Math.ceil(i.h):a[3],l=Be(r.maxWidth)||Be(r.maxHeight),u=this.getPixelRatio(),c=1;if(r.scale!==void 0)s*=r.scale,o*=r.scale,c=r.scale;else if(l){var h=1/0,d=1/0;Be(r.maxWidth)&&(h=c*r.maxWidth/s),Be(r.maxHeight)&&(d=c*r.maxHeight/o),c=Math.min(h,d),s*=c,o*=c}l||(s*=u,o*=u,c*=u);var v=document.createElement("canvas");v.width=s,v.height=o,v.style.width=s+"px",v.style.height=o+"px";var m=v.getContext("2d");if(s>0&&o>0){m.clearRect(0,0,s,o),m.globalCompositeOperation="source-over";var y=this.getCachedZSortedEles();if(r.full)m.translate(-i.x1*c,-i.y1*c),m.scale(c,c),this.drawElements(m,y),m.scale(1/c,1/c),m.translate(i.x1*c,i.y1*c);else{var b=e.pan(),x={x:b.x*c,y:b.y*c};c*=e.zoom(),m.translate(x.x,x.y),m.scale(c,c),this.drawElements(m,y),m.scale(1/c,1/c),m.translate(-x.x,-x.y)}r.bg&&(m.globalCompositeOperation="destination-over",m.fillStyle=r.bg,m.rect(0,0,s,o),m.fill())}return v};function mF(r,e){for(var n=atob(r),i=new ArrayBuffer(n.length),a=new Uint8Array(i),s=0;s<n.length;s++)a[s]=n.charCodeAt(s);return new Blob([i],{type:e})}function _3(r){var e=r.indexOf(",");return r.substr(e+1)}function wS(r,e,n){var i=function(){return e.toDataURL(n,r.quality)};switch(r.output){case"blob-promise":return new Gl(function(a,s){try{e.toBlob(function(o){o!=null?a(o):s(new Error("`canvas.toBlob()` sent a null value in its callback"))},n,r.quality)}catch(o){s(o)}});case"blob":return mF(_3(i()),n);case"base64":return _3(i());case"base64uri":default:return i()}}ff.png=function(r){return wS(r,this.bufferCanvasImage(r),"image/png")};ff.jpg=function(r){return wS(r,this.bufferCanvasImage(r),"image/jpeg")};var CS={};CS.nodeShapeImpl=function(r,e,n,i,a,s,o,l){switch(r){case"ellipse":return this.drawEllipsePath(e,n,i,a,s);case"polygon":return this.drawPolygonPath(e,n,i,a,s,o);case"round-polygon":return this.drawRoundPolygonPath(e,n,i,a,s,o,l);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,n,i,a,s,l);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,n,i,a,s,o,l);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,n,i,a,s,l);case"barrel":return this.drawBarrelPath(e,n,i,a,s)}};var pF=ES,At=ES.prototype;At.CANVAS_LAYERS=3;At.SELECT_BOX=0;At.DRAG=1;At.NODE=2;At.WEBGL=3;At.CANVAS_TYPES=["2d","2d","2d","webgl2"];At.BUFFER_COUNT=3;At.TEXTURE_BUFFER=0;At.MOTIONBLUR_BUFFER_NODE=1;At.MOTIONBLUR_BUFFER_DRAG=2;function ES(r){var e=this,n=e.cy.window(),i=n.document;r.webgl&&(At.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(At.CANVAS_LAYERS),contexts:new Array(At.CANVAS_LAYERS),canvasNeedsRedraw:new Array(At.CANVAS_LAYERS),bufferCanvases:new Array(At.BUFFER_COUNT),bufferContexts:new Array(At.CANVAS_LAYERS)};var a="-webkit-tap-highlight-color",s="rgba(0,0,0,0)";e.data.canvasContainer=i.createElement("div");var o=e.data.canvasContainer.style;e.data.canvasContainer.style[a]=s,o.position="relative",o.zIndex="0",o.overflow="hidden";var l=r.cy.container();l.appendChild(e.data.canvasContainer),l.style[a]=s;var u={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};f8()&&(u["-ms-touch-action"]="none",u["touch-action"]="none");for(var c=0;c<At.CANVAS_LAYERS;c++){var h=e.data.canvases[c]=i.createElement("canvas"),d=At.CANVAS_TYPES[c];e.data.contexts[c]=h.getContext(d),e.data.contexts[c]||cr("Could not create canvas of type "+d),Object.keys(u).forEach(function(ve){h.style[ve]=u[ve]}),h.style.position="absolute",h.setAttribute("data-id","layer"+c),h.style.zIndex=String(At.CANVAS_LAYERS-c),e.data.canvasContainer.appendChild(h),e.data.canvasNeedsRedraw[c]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[At.NODE].setAttribute("data-id","layer"+At.NODE+"-node"),e.data.canvases[At.SELECT_BOX].setAttribute("data-id","layer"+At.SELECT_BOX+"-selectbox"),e.data.canvases[At.DRAG].setAttribute("data-id","layer"+At.DRAG+"-drag"),e.data.canvases[At.WEBGL]&&e.data.canvases[At.WEBGL].setAttribute("data-id","layer"+At.WEBGL+"-webgl");for(var c=0;c<At.BUFFER_COUNT;c++)e.data.bufferCanvases[c]=i.createElement("canvas"),e.data.bufferContexts[c]=e.data.bufferCanvases[c].getContext("2d"),e.data.bufferCanvases[c].style.position="absolute",e.data.bufferCanvases[c].setAttribute("data-id","buffer"+c),e.data.bufferCanvases[c].style.zIndex=String(-c-1),e.data.bufferCanvases[c].style.visibility="hidden";e.pathsEnabled=!0;var v=yn(),m=function(re){return{x:(re.x1+re.x2)/2,y:(re.y1+re.y2)/2}},y=function(re){return{x:-re.w/2,y:-re.h/2}},b=function(re){var ae=re[0]._private,le=ae.oldBackgroundTimestamp===ae.backgroundTimestamp;return!le},x=function(re){return re[0]._private.nodeKey},A=function(re){return re[0]._private.labelStyleKey},C=function(re){return re[0]._private.sourceLabelStyleKey},E=function(re){return re[0]._private.targetLabelStyleKey},S=function(re,ae,le,Ae,Re){return e.drawElement(re,ae,le,!1,!1,Re)},T=function(re,ae,le,Ae,Re){return e.drawElementText(re,ae,le,Ae,"main",Re)},R=function(re,ae,le,Ae,Re){return e.drawElementText(re,ae,le,Ae,"source",Re)},D=function(re,ae,le,Ae,Re){return e.drawElementText(re,ae,le,Ae,"target",Re)},B=function(re){return re.boundingBox(),re[0]._private.bodyBounds},N=function(re){return re.boundingBox(),re[0]._private.labelBounds.main||v},I=function(re){return re.boundingBox(),re[0]._private.labelBounds.source||v},P=function(re){return re.boundingBox(),re[0]._private.labelBounds.target||v},F=function(re,ae){return ae},O=function(re){return m(B(re))},U=function(re,ae,le){var Ae=re?re+"-":"";return{x:ae.x+le.pstyle(Ae+"text-margin-x").pfValue,y:ae.y+le.pstyle(Ae+"text-margin-y").pfValue}},L=function(re,ae,le){var Ae=re[0]._private.rscratch;return{x:Ae[ae],y:Ae[le]}},V=function(re){return U("",L(re,"labelX","labelY"),re)},_=function(re){return U("source",L(re,"sourceLabelX","sourceLabelY"),re)},G=function(re){return U("target",L(re,"targetLabelX","targetLabelY"),re)},K=function(re){return y(B(re))},z=function(re){return y(I(re))},Y=function(re){return y(P(re))},Z=function(re){var ae=N(re),le=y(N(re));if(re.isNode()){switch(re.pstyle("text-halign").value){case"left":le.x=-ae.w-(ae.leftPad||0);break;case"right":le.x=-(ae.rightPad||0);break}switch(re.pstyle("text-valign").value){case"top":le.y=-ae.h-(ae.topPad||0);break;case"bottom":le.y=-(ae.botPad||0);break}}return le},J=e.data.eleTxrCache=new vc(e,{getKey:x,doesEleInvalidateKey:b,drawElement:S,getBoundingBox:B,getRotationPoint:O,getRotationOffset:K,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),ee=e.data.lblTxrCache=new vc(e,{getKey:A,drawElement:T,getBoundingBox:N,getRotationPoint:V,getRotationOffset:Z,isVisible:F}),ne=e.data.slbTxrCache=new vc(e,{getKey:C,drawElement:R,getBoundingBox:I,getRotationPoint:_,getRotationOffset:z,isVisible:F}),oe=e.data.tlbTxrCache=new vc(e,{getKey:E,drawElement:D,getBoundingBox:P,getRotationPoint:G,getRotationOffset:Y,isVisible:F}),me=e.data.lyrTxrCache=new fS(e);e.onUpdateEleCalcs(function(re,ae){J.invalidateElements(ae),ee.invalidateElements(ae),ne.invalidateElements(ae),oe.invalidateElements(ae),me.invalidateElements(ae);for(var le=0;le<ae.length;le++){var Ae=ae[le]._private;Ae.oldBackgroundTimestamp=Ae.backgroundTimestamp}});var ye=function(re){for(var ae=0;ae<re.length;ae++)me.enqueueElementRefinement(re[ae].ele)};J.onDequeue(ye),ee.onDequeue(ye),ne.onDequeue(ye),oe.onDequeue(ye),r.webgl&&e.initWebgl(r,{getStyleKey:x,getLabelKey:A,getSourceLabelKey:C,getTargetLabelKey:E,drawElement:S,drawLabel:T,drawSourceLabel:R,drawTargetLabel:D,getElementBox:B,getLabelBox:N,getSourceLabelBox:I,getTargetLabelBox:P,getElementRotationPoint:O,getElementRotationOffset:K,getLabelRotationPoint:V,getSourceLabelRotationPoint:_,getTargetLabelRotationPoint:G,getLabelRotationOffset:Z,getSourceLabelRotationOffset:z,getTargetLabelRotationOffset:Y})}At.redrawHint=function(r,e){var n=this;switch(r){case"eles":n.data.canvasNeedsRedraw[At.NODE]=e;break;case"drag":n.data.canvasNeedsRedraw[At.DRAG]=e;break;case"select":n.data.canvasNeedsRedraw[At.SELECT_BOX]=e;break;case"gc":n.data.gc=!0;break}};var yF=typeof Path2D<"u";At.path2dEnabled=function(r){if(r===void 0)return this.pathsEnabled;this.pathsEnabled=!!r};At.usePaths=function(){return yF&&this.pathsEnabled};At.setImgSmoothing=function(r,e){r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled=e:(r.webkitImageSmoothingEnabled=e,r.mozImageSmoothingEnabled=e,r.msImageSmoothingEnabled=e)};At.getImgSmoothing=function(r){return r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled:r.webkitImageSmoothingEnabled||r.mozImageSmoothingEnabled||r.msImageSmoothingEnabled};At.makeOffscreenCanvas=function(r,e){var n;if((typeof OffscreenCanvas>"u"?"undefined":Pr(OffscreenCanvas))!=="undefined")n=new OffscreenCanvas(r,e);else{var i=this.cy.window(),a=i.document;n=a.createElement("canvas"),n.width=r,n.height=e}return n};[hS,Xi,Ta,I2,bo,Ts,An,pS,Ms,ff,CS].forEach(function(r){et(At,r)});var AF=[{name:"null",impl:JE},{name:"base",impl:lS},{name:"canvas",impl:pF}],xF=[{type:"layout",extensions:HI},{type:"renderer",extensions:AF}],SS={},TS={};function MS(r,e,n){var i=n,a=function(B){Lt("Can not register `"+e+"` for `"+r+"` since `"+B+"` already exists in the prototype and can not be overridden")};if(r==="core"){if(qc.prototype[e])return a(e);qc.prototype[e]=n}else if(r==="collection"){if(Jr.prototype[e])return a(e);Jr.prototype[e]=n}else if(r==="layout"){for(var s=function(B){this.options=B,n.call(this,B),It(this._private)||(this._private={}),this._private.cy=B.cy,this._private.listeners=[],this.createEmitter()},o=s.prototype=Object.create(n.prototype),l=[],u=0;u<l.length;u++){var c=l[u];o[c]=o[c]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var h=n.prototype.stop;o.stop=function(){var D=this.options;if(D&&D.animate){var B=this.animations;if(B)for(var N=0;N<B.length;N++)B[N].stop()}return h?h.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var d=function(B){return B._private.cy},v={addEventFields:function(B,N){N.layout=B,N.cy=d(B),N.target=B},bubble:function(){return!0},parent:function(B){return d(B)}};et(o,{createEmitter:function(){return this._private.emitter=new C0(v,this),this},emitter:function(){return this._private.emitter},on:function(B,N){return this.emitter().on(B,N),this},one:function(B,N){return this.emitter().one(B,N),this},once:function(B,N){return this.emitter().one(B,N),this},removeListener:function(B,N){return this.emitter().removeListener(B,N),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(B,N){return this.emitter().emit(B,N),this}}),Ot.eventAliasesOn(o),i=s}else if(r==="renderer"&&e!=="null"&&e!=="base"){var m=DS("renderer","base"),y=m.prototype,b=n,x=n.prototype,A=function(){m.apply(this,arguments),b.apply(this,arguments)},C=A.prototype;for(var E in y){var S=y[E],T=x[E]!=null;if(T)return a(E);C[E]=S}for(var R in x)C[R]=x[R];y.clientFunctions.forEach(function(D){C[D]=C[D]||function(){cr("Renderer does not implement `renderer."+D+"()` on its prototype")}}),i=A}else if(r==="__proto__"||r==="constructor"||r==="prototype")return cr(r+" is an illegal type to be registered, possibly lead to prototype pollutions");return jC({map:SS,keys:[r,e],value:i})}function DS(r,e){return KC({map:SS,keys:[r,e]})}function bF(r,e,n,i,a){return jC({map:TS,keys:[r,e,n,i],value:a})}function wF(r,e,n,i){return KC({map:TS,keys:[r,e,n,i]})}var Bp=function(){if(arguments.length===2)return DS.apply(null,arguments);if(arguments.length===3)return MS.apply(null,arguments);if(arguments.length===4)return wF.apply(null,arguments);if(arguments.length===5)return bF.apply(null,arguments);cr("Invalid extension access syntax")};qc.prototype.extension=Bp;xF.forEach(function(r){r.extensions.forEach(function(e){MS(r.type,e.name,e.impl)})});var Zd=function(){if(!(this instanceof Zd))return new Zd;this.length=0},vo=Zd.prototype;vo.instanceString=function(){return"stylesheet"};vo.selector=function(r){var e=this.length++;return this[e]={selector:r,properties:[]},this};vo.css=function(r,e){var n=this.length-1;if(Je(r))this[n].properties.push({name:r,value:e});else if(It(r))for(var i=r,a=Object.keys(i),s=0;s<a.length;s++){var o=a[s],l=i[o];if(l!=null){var u=Yr.properties[o]||Yr.properties[d0(o)];if(u!=null){var c=u.name,h=l;this[n].properties.push({name:c,value:h})}}}return this};vo.style=vo.css;vo.generateStyle=function(r){var e=new Yr(r);return this.appendToStyle(e)};vo.appendToStyle=function(r){for(var e=0;e<this.length;e++){var n=this[e],i=n.selector,a=n.properties;r.selector(i);for(var s=0;s<a.length;s++){var o=a[s];r.css(o.name,o.value)}}return r};var CF="3.33.1",mo=function(e){if(e===void 0&&(e={}),It(e))return new qc(e);if(Je(e))return Bp.apply(Bp,arguments)};mo.use=function(r){var e=Array.prototype.slice.call(arguments,1);return e.unshift(mo),r.apply(null,e),this};mo.warnings=function(r){return eE(r)};mo.version=CF;mo.stylesheet=mo.Stylesheet=Zd;const{string:Yh,array:z3,object:Hh,number:Wu,bool:qn,oneOfType:ml,any:jh,func:Zu}=W,EF={id:Yh,className:Yh,style:ml([Yh,Hh]),elements:ml([z3,jh]),stylesheet:ml([z3,jh]),layout:ml([Hh,jh]),pan:ml([Hh,jh]),zoom:Wu,panningEnabled:qn,userPanningEnabled:qn,minZoom:Wu,maxZoom:Wu,zoomingEnabled:qn,userZoomingEnabled:qn,boxSelectionEnabled:qn,autoungrabify:qn,autolock:qn,autounselectify:qn,get:Zu,toJson:Zu,diff:Zu,forEach:Zu,cy:Zu,headless:qn,styleEnabled:qn,hideEdgesOnViewport:qn,textureOnViewport:qn,motionBlur:qn,motionBlurOpacity:Wu,wheelSensitivity:Wu,pixelRatio:ml([Yh,Hh])},RS=(r,e)=>{if(((s,o)=>s==null||o==null)(r,e)&&(r!=null||e!=null))return!0;if(r===e)return!1;if(typeof r!="object"||typeof e!="object")return r!==e;const n=Object.keys(r),i=Object.keys(e),a=s=>r[s]!==e[s];return n.length!==i.length||!(!n.some(a)&&!i.some(a))},yi=(r,e)=>r!=null?r[e]:null,SF={diff:RS,get:yi,toJson:r=>r,forEach:(r,e)=>r.forEach(e),elements:[{data:{id:"a",label:"Example node A"}},{data:{id:"b",label:"Example node B"}},{data:{id:"e",source:"a",target:"b"}}],stylesheet:[{selector:"node",style:{label:"data(label)"}}],zoom:1,pan:{x:0,y:0}},Kh=(r,e,n,i)=>n(yi(r,i),yi(e,i)),TF=(r,e,n,i,a,s,o)=>{r.batch(()=>{(i===RS||Kh(e,n,i,"elements"))&&BF(r,yi(e,"elements"),yi(n,"elements"),a,s,o,i),Kh(e,n,i,"stylesheet")&&RF(r,yi(e,"stylesheet"),yi(n,"stylesheet"),a),["zoom","minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","pan","panningEnabled","userPanningEnabled","boxSelectionEnabled","autoungrabify","autolock","autounselectify"].forEach(l=>{Kh(e,n,i,l)&&MF(r,l,yi(e,l),yi(n,l),a)})}),Kh(e,n,i,"layout")&&DF(r,yi(e,"layout"),yi(n,"layout"),a)},MF=(r,e,n,i,a)=>{r[e](a(i))},DF=(r,e,n,i)=>{const a=i(n);a!=null&&r.layout(a).run()},RF=(r,e,n,i)=>{const a=r.style();a?.fromJson(i(n)).update()},BF=(r,e,n,i,a,s,o)=>{const l=[],u=r.collection(),c=[],h={},d={},v=m=>a(a(m,"data"),"id");s(n,m=>{const y=v(m);d[y]=m}),e!=null&&s(e,m=>{const y=v(m);h[y]=m,(b=>d[b]!=null)(y)||u.merge(r.getElementById(y))}),s(n,m=>{const y=v(m),b=(x=>h[x])(y);(x=>h[x]!=null)(y)?c.push({ele1:b,ele2:m}):l.push(i(m))}),u.length>0&&r.remove(u),l.length>0&&r.add(l),c.forEach(({ele1:m,ele2:y})=>IF(r,m,y,i,a,o))},IF=(r,e,n,i,a,s)=>{const o=a(a(n,"data"),"id"),l=r.getElementById(o),u={};["data","position","selected","selectable","locked","grabbable","classes"].forEach(h=>{const d=a(n,h);s(d,a(e,h))&&(u[h]=i(d))});const c=a(n,"scratch");s(c,a(e,"scratch"))&&l.scratch(i(c)),Object.keys(u).length>0&&l.json(u)};let NF=class extends dd.Component{static get propTypes(){return EF}static get defaultProps(){return SF}static normalizeElements(e){if(e.length!=null)return e;{let{nodes:n,edges:i}=e;return n==null&&(n=[]),i==null&&(i=[]),n.concat(i)}}constructor(e){super(e),this.displayName="CytoscapeComponent",this.containerRef=dd.createRef()}componentDidMount(){const e=this.containerRef.current,{global:n,headless:i,styleEnabled:a,hideEdgesOnViewport:s,textureOnViewport:o,motionBlur:l,motionBlurOpacity:u,wheelSensitivity:c,pixelRatio:h}=this.props,d=this._cy=new mo({container:e,headless:i,styleEnabled:a,hideEdgesOnViewport:s,textureOnViewport:o,motionBlur:l,motionBlurOpacity:u,wheelSensitivity:c,pixelRatio:h});n&&(window[n]=d),this.updateCytoscape(null,this.props)}updateCytoscape(e,n){const i=this._cy,{diff:a,toJson:s,get:o,forEach:l}=n;TF(i,e,n,a,s,o,l),n.cy!=null&&n.cy(i)}componentDidUpdate(e){this.updateCytoscape(e,this.props)}componentWillUnmount(){this._cy.destroy()}render(){const{id:e,className:n,style:i}=this.props;return dd.createElement("div",{ref:this.containerRef,id:e,className:n,style:i})}};const FF={name:"cose",fit:!0,padding:20,animate:!1},kF=[{selector:"node",style:{"background-color":"data(color)",label:"data(label)",color:"#f5f5f5","font-size":"10px","text-valign":"center","text-halign":"center","text-wrap":"wrap","text-max-width":"120px","border-width":2,"border-color":"#1e3a8a"}},{selector:"edge",style:{width:2,"line-color":"#8ecae6","target-arrow-color":"#8ecae6","target-arrow-shape":"triangle","curve-style":"bezier",opacity:.75,label:"data(label)","font-size":"8px",color:"#bbdefb"}},{selector:"node:selected",style:{"border-width":6,"border-color":"#f97316","shadow-blur":16,"shadow-color":"rgba(249, 115, 22, 0.55)","shadow-opacity":.8}}],Xh=["#5a6acf","#8b5cf6","#ec4899","#0ea5e9","#22c55e","#f59e0b"];function PF(r,e){if(!r)return Xh[e%Xh.length];const n=Math.abs([...r].reduce((i,a)=>i*33+a.charCodeAt(0),7));return Xh[n%Xh.length]}function F2({elements:r,selectedId:e,onSelect:n}){const i=Ye.useRef(null),a=Ye.useMemo(()=>r.map((s,o)=>s.data?.id?{...s,data:{...s.data,color:PF(s.data.category,o)}}:s),[r]);return Ye.useEffect(()=>{const s=i.current;s&&(s.off("tap"),s.on("tap","node",o=>{const l=o.target.id();n&&n(l)}))},[n]),Ye.useEffect(()=>{const s=i.current;if(s&&(s.nodes().unselect(),e)){const o=s.getElementById(e);o&&(o.select(),s.animate({center:{eles:o}},{duration:250}))}},[e]),ie.jsx("div",{className:"cytoscape-wrapper","data-testid":"cytoscape-view",children:ie.jsx(NF,{cy:s=>{i.current=s},elements:a,layout:FF,stylesheet:kF,style:{width:"100%",height:"100%"}})})}F2.propTypes={elements:W.arrayOf(W.shape({data:W.shape({id:W.string,label:W.string,category:W.string})})),selectedId:W.string,onSelect:W.func};F2.defaultProps={elements:[],selectedId:null,onSelect:void 0};function UF(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],u=!0,c=!1;try{if(s=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);u=!0);}catch(h){c=!0,a=h}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function VF(r,e,n){return e=HF(e),e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function q3(r,e){return _F(r)||UF(r,e)||BS(r,e)||GF()}function OF(r){return LF(r)||zF(r)||BS(r)||qF()}function LF(r){if(Array.isArray(r))return Ip(r)}function _F(r){if(Array.isArray(r))return r}function zF(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function BS(r,e){if(r){if(typeof r=="string")return Ip(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ip(r,e)}}function Ip(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=r[n];return i}function qF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YF(r,e){if(typeof r!="object"||r===null)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function HF(r){var e=YF(r,"string");return typeof e=="symbol"?e:String(e)}var jF=function(e,n){var i=new Set(n);return Object.assign.apply(Object,[{}].concat(OF(Object.entries(e).filter(function(a){var s=q3(a,1),o=s[0];return!i.has(o)}).map(function(a){var s=q3(a,2),o=s[0],l=s[1];return VF({},o,l)}))))};function Np(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function KF(r){if(Array.isArray(r))return r}function XF(r){if(Array.isArray(r))return Np(r)}function QF(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function WF(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],u=!0,c=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(u=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);u=!0);}catch(h){c=!0,a=h}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function ZF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JF(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $F(r,e){return KF(r)||WF(r,e)||IS(r,e)||ZF()}function G3(r){return XF(r)||QF(r)||IS(r)||JF()}function IS(r,e){if(r){if(typeof r=="string")return Np(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Np(r,e):void 0}}function e9(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.wrapperElementType,i=n===void 0?"div":n,a=e.nodeMapper,s=a===void 0?function(h){return h}:a,o=e.methodNames,l=o===void 0?[]:o,u=e.initPropNames,c=u===void 0?[]:u;return Ye.forwardRef(function(h,d){var v=Ye.useRef(),m=Ye.useMemo(function(){var x=Object.fromEntries(c.filter(function(A){return h.hasOwnProperty(A)}).map(function(A){return[A,h[A]]}));return r(x)},[]);Y3(function(){m(s(v.current))},Ye.useLayoutEffect),Y3(function(){return m._destructor instanceof Function?m._destructor:void 0});var y=Ye.useCallback(function(x){for(var A=arguments.length,C=new Array(A>1?A-1:0),E=1;E<A;E++)C[E-1]=arguments[E];return m[x]instanceof Function?m[x].apply(m,C):void 0},[m]),b=Ye.useRef({});return Object.keys(jF(h,[].concat(G3(l),G3(c)))).filter(function(x){return b.current[x]!==h[x]}).forEach(function(x){return y(x,h[x])}),b.current=h,Ye.useImperativeHandle(d,function(){return Object.fromEntries(l.map(function(x){return[x,function(){for(var A=arguments.length,C=new Array(A),E=0;E<A;E++)C[E]=arguments[E];return y.apply(void 0,[x].concat(C))}]}))},[y]),dd.createElement(i,{ref:v})})}function Y3(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ye.useEffect,n=Ye.useRef(),i=Ye.useRef(!1),a=Ye.useRef(!1),s=Ye.useState(0),o=$F(s,2);o[0];var l=o[1];i.current&&(a.current=!0),e(function(){return i.current||(n.current=r(),i.current=!0),l(function(u){return u+1}),function(){a.current&&n.current&&n.current()}},[])}var Fp="http://www.w3.org/1999/xhtml";const H3={svg:"http://www.w3.org/2000/svg",xhtml:Fp,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function I0(r){var e=r+="",n=e.indexOf(":");return n>=0&&(e=r.slice(0,n))!=="xmlns"&&(r=r.slice(n+1)),H3.hasOwnProperty(e)?{space:H3[e],local:r}:r}function t9(r){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Fp&&e.documentElement.namespaceURI===Fp?e.createElement(r):e.createElementNS(n,r)}}function r9(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function NS(r){var e=I0(r);return(e.local?r9:t9)(e)}function n9(){}function k2(r){return r==null?n9:function(){return this.querySelector(r)}}function i9(r){typeof r!="function"&&(r=k2(r));for(var e=this._groups,n=e.length,i=new Array(n),a=0;a<n;++a)for(var s=e[a],o=s.length,l=i[a]=new Array(o),u,c,h=0;h<o;++h)(u=s[h])&&(c=r.call(u,u.__data__,h,s))&&("__data__"in u&&(c.__data__=u.__data__),l[h]=c);return new Kn(i,this._parents)}function a9(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function s9(){return[]}function FS(r){return r==null?s9:function(){return this.querySelectorAll(r)}}function o9(r){return function(){return a9(r.apply(this,arguments))}}function l9(r){typeof r=="function"?r=o9(r):r=FS(r);for(var e=this._groups,n=e.length,i=[],a=[],s=0;s<n;++s)for(var o=e[s],l=o.length,u,c=0;c<l;++c)(u=o[c])&&(i.push(r.call(u,u.__data__,c,o)),a.push(u));return new Kn(i,a)}function kS(r){return function(){return this.matches(r)}}function PS(r){return function(e){return e.matches(r)}}var u9=Array.prototype.find;function c9(r){return function(){return u9.call(this.children,r)}}function f9(){return this.firstElementChild}function h9(r){return this.select(r==null?f9:c9(typeof r=="function"?r:PS(r)))}var d9=Array.prototype.filter;function g9(){return Array.from(this.children)}function v9(r){return function(){return d9.call(this.children,r)}}function m9(r){return this.selectAll(r==null?g9:v9(typeof r=="function"?r:PS(r)))}function p9(r){typeof r!="function"&&(r=kS(r));for(var e=this._groups,n=e.length,i=new Array(n),a=0;a<n;++a)for(var s=e[a],o=s.length,l=i[a]=[],u,c=0;c<o;++c)(u=s[c])&&r.call(u,u.__data__,c,s)&&l.push(u);return new Kn(i,this._parents)}function US(r){return new Array(r.length)}function y9(){return new Kn(this._enter||this._groups.map(US),this._parents)}function Jd(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}Jd.prototype={constructor:Jd,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function A9(r){return function(){return r}}function x9(r,e,n,i,a,s){for(var o=0,l,u=e.length,c=s.length;o<c;++o)(l=e[o])?(l.__data__=s[o],i[o]=l):n[o]=new Jd(r,s[o]);for(;o<u;++o)(l=e[o])&&(a[o]=l)}function b9(r,e,n,i,a,s,o){var l,u,c=new Map,h=e.length,d=s.length,v=new Array(h),m;for(l=0;l<h;++l)(u=e[l])&&(v[l]=m=o.call(u,u.__data__,l,e)+"",c.has(m)?a[l]=u:c.set(m,u));for(l=0;l<d;++l)m=o.call(r,s[l],l,s)+"",(u=c.get(m))?(i[l]=u,u.__data__=s[l],c.delete(m)):n[l]=new Jd(r,s[l]);for(l=0;l<h;++l)(u=e[l])&&c.get(v[l])===u&&(a[l]=u)}function w9(r){return r.__data__}function C9(r,e){if(!arguments.length)return Array.from(this,w9);var n=e?b9:x9,i=this._parents,a=this._groups;typeof r!="function"&&(r=A9(r));for(var s=a.length,o=new Array(s),l=new Array(s),u=new Array(s),c=0;c<s;++c){var h=i[c],d=a[c],v=d.length,m=E9(r.call(h,h&&h.__data__,c,i)),y=m.length,b=l[c]=new Array(y),x=o[c]=new Array(y),A=u[c]=new Array(v);n(h,d,b,x,A,m,e);for(var C=0,E=0,S,T;C<y;++C)if(S=b[C]){for(C>=E&&(E=C+1);!(T=x[E])&&++E<y;);S._next=T||null}}return o=new Kn(o,i),o._enter=l,o._exit=u,o}function E9(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function S9(){return new Kn(this._exit||this._groups.map(US),this._parents)}function T9(r,e,n){var i=this.enter(),a=this,s=this.exit();return typeof r=="function"?(i=r(i),i&&(i=i.selection())):i=i.append(r+""),e!=null&&(a=e(a),a&&(a=a.selection())),n==null?s.remove():n(s),i&&a?i.merge(a).order():a}function M9(r){for(var e=r.selection?r.selection():r,n=this._groups,i=e._groups,a=n.length,s=i.length,o=Math.min(a,s),l=new Array(a),u=0;u<o;++u)for(var c=n[u],h=i[u],d=c.length,v=l[u]=new Array(d),m,y=0;y<d;++y)(m=c[y]||h[y])&&(v[y]=m);for(;u<a;++u)l[u]=n[u];return new Kn(l,this._parents)}function D9(){for(var r=this._groups,e=-1,n=r.length;++e<n;)for(var i=r[e],a=i.length-1,s=i[a],o;--a>=0;)(o=i[a])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function R9(r){r||(r=B9);function e(d,v){return d&&v?r(d.__data__,v.__data__):!d-!v}for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s){for(var o=n[s],l=o.length,u=a[s]=new Array(l),c,h=0;h<l;++h)(c=o[h])&&(u[h]=c);u.sort(e)}return new Kn(a,this._parents).order()}function B9(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function I9(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function N9(){return Array.from(this)}function F9(){for(var r=this._groups,e=0,n=r.length;e<n;++e)for(var i=r[e],a=0,s=i.length;a<s;++a){var o=i[a];if(o)return o}return null}function k9(){let r=0;for(const e of this)++r;return r}function P9(){return!this.node()}function U9(r){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var a=e[n],s=0,o=a.length,l;s<o;++s)(l=a[s])&&r.call(l,l.__data__,s,a);return this}function V9(r){return function(){this.removeAttribute(r)}}function O9(r){return function(){this.removeAttributeNS(r.space,r.local)}}function L9(r,e){return function(){this.setAttribute(r,e)}}function _9(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function z9(r,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(r):this.setAttribute(r,n)}}function q9(r,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,n)}}function G9(r,e){var n=I0(r);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?O9:V9:typeof e=="function"?n.local?q9:z9:n.local?_9:L9)(n,e))}function VS(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function Y9(r){return function(){this.style.removeProperty(r)}}function H9(r,e,n){return function(){this.style.setProperty(r,e,n)}}function j9(r,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(r):this.style.setProperty(r,i,n)}}function K9(r,e,n){return arguments.length>1?this.each((e==null?Y9:typeof e=="function"?j9:H9)(r,e,n??"")):Ll(this.node(),r)}function Ll(r,e){return r.style.getPropertyValue(e)||VS(r).getComputedStyle(r,null).getPropertyValue(e)}function X9(r){return function(){delete this[r]}}function Q9(r,e){return function(){this[r]=e}}function W9(r,e){return function(){var n=e.apply(this,arguments);n==null?delete this[r]:this[r]=n}}function Z9(r,e){return arguments.length>1?this.each((e==null?X9:typeof e=="function"?W9:Q9)(r,e)):this.node()[r]}function OS(r){return r.trim().split(/^|\s+/)}function P2(r){return r.classList||new LS(r)}function LS(r){this._node=r,this._names=OS(r.getAttribute("class")||"")}LS.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function _S(r,e){for(var n=P2(r),i=-1,a=e.length;++i<a;)n.add(e[i])}function zS(r,e){for(var n=P2(r),i=-1,a=e.length;++i<a;)n.remove(e[i])}function J9(r){return function(){_S(this,r)}}function $9(r){return function(){zS(this,r)}}function ek(r,e){return function(){(e.apply(this,arguments)?_S:zS)(this,r)}}function tk(r,e){var n=OS(r+"");if(arguments.length<2){for(var i=P2(this.node()),a=-1,s=n.length;++a<s;)if(!i.contains(n[a]))return!1;return!0}return this.each((typeof e=="function"?ek:e?J9:$9)(n,e))}function rk(){this.textContent=""}function nk(r){return function(){this.textContent=r}}function ik(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function ak(r){return arguments.length?this.each(r==null?rk:(typeof r=="function"?ik:nk)(r)):this.node().textContent}function sk(){this.innerHTML=""}function ok(r){return function(){this.innerHTML=r}}function lk(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function uk(r){return arguments.length?this.each(r==null?sk:(typeof r=="function"?lk:ok)(r)):this.node().innerHTML}function ck(){this.nextSibling&&this.parentNode.appendChild(this)}function fk(){return this.each(ck)}function hk(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function dk(){return this.each(hk)}function gk(r){var e=typeof r=="function"?r:NS(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function vk(){return null}function mk(r,e){var n=typeof r=="function"?r:NS(r),i=e==null?vk:typeof e=="function"?e:k2(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function pk(){var r=this.parentNode;r&&r.removeChild(this)}function yk(){return this.each(pk)}function Ak(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function xk(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function bk(r){return this.select(r?xk:Ak)}function wk(r){return arguments.length?this.property("__data__",r):this.node().__data__}function Ck(r){return function(e){r.call(this,e,this.__data__)}}function Ek(r){return r.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Sk(r){return function(){var e=this.__on;if(e){for(var n=0,i=-1,a=e.length,s;n<a;++n)s=e[n],(!r.type||s.type===r.type)&&s.name===r.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function Tk(r,e,n){return function(){var i=this.__on,a,s=Ck(e);if(i){for(var o=0,l=i.length;o<l;++o)if((a=i[o]).type===r.type&&a.name===r.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=s,a.options=n),a.value=e;return}}this.addEventListener(r.type,s,n),a={type:r.type,name:r.name,value:e,listener:s,options:n},i?i.push(a):this.__on=[a]}}function Mk(r,e,n){var i=Ek(r+""),a,s=i.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var u=0,c=l.length,h;u<c;++u)for(a=0,h=l[u];a<s;++a)if((o=i[a]).type===h.type&&o.name===h.name)return h.value}return}for(l=e?Tk:Sk,a=0;a<s;++a)this.each(l(i[a],e,n));return this}function qS(r,e,n){var i=VS(r),a=i.CustomEvent;typeof a=="function"?a=new a(e,n):(a=i.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),r.dispatchEvent(a)}function Dk(r,e){return function(){return qS(this,r,e)}}function Rk(r,e){return function(){return qS(this,r,e.apply(this,arguments))}}function Bk(r,e){return this.each((typeof e=="function"?Rk:Dk)(r,e))}function*Ik(){for(var r=this._groups,e=0,n=r.length;e<n;++e)for(var i=r[e],a=0,s=i.length,o;a<s;++a)(o=i[a])&&(yield o)}var GS=[null];function Kn(r,e){this._groups=r,this._parents=e}function hf(){return new Kn([[document.documentElement]],GS)}function Nk(){return this}Kn.prototype=hf.prototype={constructor:Kn,select:i9,selectAll:l9,selectChild:h9,selectChildren:m9,filter:p9,data:C9,enter:y9,exit:S9,join:T9,merge:M9,selection:Nk,order:D9,sort:R9,call:I9,nodes:N9,node:F9,size:k9,empty:P9,each:U9,attr:G9,style:K9,property:Z9,classed:tk,text:ak,html:uk,raise:fk,lower:dk,append:gk,insert:mk,remove:yk,clone:bk,datum:wk,on:Mk,dispatch:Bk,[Symbol.iterator]:Ik};function oi(r){return typeof r=="string"?new Kn([[document.querySelector(r)]],[document.documentElement]):new Kn([[r]],GS)}function Fk(r){let e;for(;e=r.sourceEvent;)r=e;return r}function _i(r,e){if(r=Fk(r),e===void 0&&(e=r.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=r.clientX,i.y=r.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[r.clientX-a.left-e.clientLeft,r.clientY-a.top-e.clientTop]}}return[r.pageX,r.pageY]}var kk={value:()=>{}};function df(){for(var r=0,e=arguments.length,n={},i;r<e;++r){if(!(i=arguments[r]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Sd(n)}function Sd(r){this._=r}function Pk(r,e){return r.trim().split(/^|\s+/).map(function(n){var i="",a=n.indexOf(".");if(a>=0&&(i=n.slice(a+1),n=n.slice(0,a)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Sd.prototype=df.prototype={constructor:Sd,on:function(r,e){var n=this._,i=Pk(r+"",n),a,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((a=(r=i[s]).type)&&(a=Uk(n[a],r.name)))return a;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(a=(r=i[s]).type)n[a]=j3(n[a],r.name,e);else if(e==null)for(a in n)n[a]=j3(n[a],r.name,null);return this},copy:function(){var r={},e=this._;for(var n in e)r[n]=e[n].slice();return new Sd(r)},call:function(r,e){if((a=arguments.length-2)>0)for(var n=new Array(a),i=0,a,s;i<a;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(s=this._[r],i=0,a=s.length;i<a;++i)s[i].value.apply(e,n)},apply:function(r,e,n){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var i=this._[r],a=0,s=i.length;a<s;++a)i[a].value.apply(e,n)}};function Uk(r,e){for(var n=0,i=r.length,a;n<i;++n)if((a=r[n]).name===e)return a.value}function j3(r,e,n){for(var i=0,a=r.length;i<a;++i)if(r[i].name===e){r[i]=kk,r=r.slice(0,i).concat(r.slice(i+1));break}return n!=null&&r.push({name:e,value:n}),r}const Vk={passive:!1},Yc={capture:!0,passive:!1};function Pm(r){r.stopImmediatePropagation()}function kl(r){r.preventDefault(),r.stopImmediatePropagation()}function YS(r){var e=r.document.documentElement,n=oi(r).on("dragstart.drag",kl,Yc);"onselectstart"in e?n.on("selectstart.drag",kl,Yc):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function HS(r,e){var n=r.document.documentElement,i=oi(r).on("dragstart.drag",null);e&&(i.on("click.drag",kl,Yc),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Qh=r=>()=>r;function kp(r,{sourceEvent:e,subject:n,target:i,identifier:a,active:s,x:o,y:l,dx:u,dy:c,dispatch:h}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}kp.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function Ok(r){return!r.ctrlKey&&!r.button}function Lk(){return this.parentNode}function _k(r,e){return e??{x:r.x,y:r.y}}function zk(){return navigator.maxTouchPoints||"ontouchstart"in this}function qk(){var r=Ok,e=Lk,n=_k,i=zk,a={},s=df("start","drag","end"),o=0,l,u,c,h,d=0;function v(S){S.on("mousedown.drag",m).filter(i).on("touchstart.drag",x).on("touchmove.drag",A,Vk).on("touchend.drag touchcancel.drag",C).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(S,T){if(!(h||!r.call(this,S,T))){var R=E(this,e.call(this,S,T),S,T,"mouse");R&&(oi(S.view).on("mousemove.drag",y,Yc).on("mouseup.drag",b,Yc),YS(S.view),Pm(S),c=!1,l=S.clientX,u=S.clientY,R("start",S))}}function y(S){if(kl(S),!c){var T=S.clientX-l,R=S.clientY-u;c=T*T+R*R>d}a.mouse("drag",S)}function b(S){oi(S.view).on("mousemove.drag mouseup.drag",null),HS(S.view,c),kl(S),a.mouse("end",S)}function x(S,T){if(r.call(this,S,T)){var R=S.changedTouches,D=e.call(this,S,T),B=R.length,N,I;for(N=0;N<B;++N)(I=E(this,D,S,T,R[N].identifier,R[N]))&&(Pm(S),I("start",S,R[N]))}}function A(S){var T=S.changedTouches,R=T.length,D,B;for(D=0;D<R;++D)(B=a[T[D].identifier])&&(kl(S),B("drag",S,T[D]))}function C(S){var T=S.changedTouches,R=T.length,D,B;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),D=0;D<R;++D)(B=a[T[D].identifier])&&(Pm(S),B("end",S,T[D]))}function E(S,T,R,D,B,N){var I=s.copy(),P=_i(N||R,T),F,O,U;if((U=n.call(S,new kp("beforestart",{sourceEvent:R,target:v,identifier:B,active:o,x:P[0],y:P[1],dx:0,dy:0,dispatch:I}),D))!=null)return F=U.x-P[0]||0,O=U.y-P[1]||0,function L(V,_,G){var K=P,z;switch(V){case"start":a[B]=L,z=o++;break;case"end":delete a[B],--o;case"drag":P=_i(G||_,T),z=o;break}I.call(V,S,new kp(V,{sourceEvent:_,subject:U,target:v,identifier:B,active:z,x:P[0]+F,y:P[1]+O,dx:P[0]-K[0],dy:P[1]-K[1],dispatch:I}),D)}}return v.filter=function(S){return arguments.length?(r=typeof S=="function"?S:Qh(!!S),v):r},v.container=function(S){return arguments.length?(e=typeof S=="function"?S:Qh(S),v):e},v.subject=function(S){return arguments.length?(n=typeof S=="function"?S:Qh(S),v):n},v.touchable=function(S){return arguments.length?(i=typeof S=="function"?S:Qh(!!S),v):i},v.on=function(){var S=s.on.apply(s,arguments);return S===s?v:S},v.clickDistance=function(S){return arguments.length?(d=(S=+S)*S,v):Math.sqrt(d)},v}function U2(r,e,n){r.prototype=e.prototype=n,n.constructor=r}function jS(r,e){var n=Object.create(r.prototype);for(var i in e)n[i]=e[i];return n}function gf(){}var Hc=.7,$d=1/Hc,Pl="\\s*([+-]?\\d+)\\s*",jc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Gi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Gk=/^#([0-9a-f]{3,8})$/,Yk=new RegExp(`^rgb\\(${Pl},${Pl},${Pl}\\)$`),Hk=new RegExp(`^rgb\\(${Gi},${Gi},${Gi}\\)$`),jk=new RegExp(`^rgba\\(${Pl},${Pl},${Pl},${jc}\\)$`),Kk=new RegExp(`^rgba\\(${Gi},${Gi},${Gi},${jc}\\)$`),Xk=new RegExp(`^hsl\\(${jc},${Gi},${Gi}\\)$`),Qk=new RegExp(`^hsla\\(${jc},${Gi},${Gi},${jc}\\)$`),K3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};U2(gf,Kc,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:X3,formatHex:X3,formatHex8:Wk,formatHsl:Zk,formatRgb:Q3,toString:Q3});function X3(){return this.rgb().formatHex()}function Wk(){return this.rgb().formatHex8()}function Zk(){return KS(this).formatHsl()}function Q3(){return this.rgb().formatRgb()}function Kc(r){var e,n;return r=(r+"").trim().toLowerCase(),(e=Gk.exec(r))?(n=e[1].length,e=parseInt(e[1],16),n===6?W3(e):n===3?new In(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Wh(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Wh(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Yk.exec(r))?new In(e[1],e[2],e[3],1):(e=Hk.exec(r))?new In(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=jk.exec(r))?Wh(e[1],e[2],e[3],e[4]):(e=Kk.exec(r))?Wh(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Xk.exec(r))?$3(e[1],e[2]/100,e[3]/100,1):(e=Qk.exec(r))?$3(e[1],e[2]/100,e[3]/100,e[4]):K3.hasOwnProperty(r)?W3(K3[r]):r==="transparent"?new In(NaN,NaN,NaN,0):null}function W3(r){return new In(r>>16&255,r>>8&255,r&255,1)}function Wh(r,e,n,i){return i<=0&&(r=e=n=NaN),new In(r,e,n,i)}function Jk(r){return r instanceof gf||(r=Kc(r)),r?(r=r.rgb(),new In(r.r,r.g,r.b,r.opacity)):new In}function Pp(r,e,n,i){return arguments.length===1?Jk(r):new In(r,e,n,i??1)}function In(r,e,n,i){this.r=+r,this.g=+e,this.b=+n,this.opacity=+i}U2(In,Pp,jS(gf,{brighter(r){return r=r==null?$d:Math.pow($d,r),new In(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Hc:Math.pow(Hc,r),new In(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new In(oo(this.r),oo(this.g),oo(this.b),e0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Z3,formatHex:Z3,formatHex8:$k,formatRgb:J3,toString:J3}));function Z3(){return`#${io(this.r)}${io(this.g)}${io(this.b)}`}function $k(){return`#${io(this.r)}${io(this.g)}${io(this.b)}${io((isNaN(this.opacity)?1:this.opacity)*255)}`}function J3(){const r=e0(this.opacity);return`${r===1?"rgb(":"rgba("}${oo(this.r)}, ${oo(this.g)}, ${oo(this.b)}${r===1?")":`, ${r})`}`}function e0(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function oo(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function io(r){return r=oo(r),(r<16?"0":"")+r.toString(16)}function $3(r,e,n,i){return i<=0?r=e=n=NaN:n<=0||n>=1?r=e=NaN:e<=0&&(r=NaN),new wi(r,e,n,i)}function KS(r){if(r instanceof wi)return new wi(r.h,r.s,r.l,r.opacity);if(r instanceof gf||(r=Kc(r)),!r)return new wi;if(r instanceof wi)return r;r=r.rgb();var e=r.r/255,n=r.g/255,i=r.b/255,a=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,l=s-a,u=(s+a)/2;return l?(e===s?o=(n-i)/l+(n<i)*6:n===s?o=(i-e)/l+2:o=(e-n)/l+4,l/=u<.5?s+a:2-s-a,o*=60):l=u>0&&u<1?0:o,new wi(o,l,u,r.opacity)}function eP(r,e,n,i){return arguments.length===1?KS(r):new wi(r,e,n,i??1)}function wi(r,e,n,i){this.h=+r,this.s=+e,this.l=+n,this.opacity=+i}U2(wi,eP,jS(gf,{brighter(r){return r=r==null?$d:Math.pow($d,r),new wi(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Hc:Math.pow(Hc,r),new wi(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,a=2*n-i;return new In(Um(r>=240?r-240:r+120,a,i),Um(r,a,i),Um(r<120?r+240:r-120,a,i),this.opacity)},clamp(){return new wi(e4(this.h),Zh(this.s),Zh(this.l),e0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=e0(this.opacity);return`${r===1?"hsl(":"hsla("}${e4(this.h)}, ${Zh(this.s)*100}%, ${Zh(this.l)*100}%${r===1?")":`, ${r})`}`}}));function e4(r){return r=(r||0)%360,r<0?r+360:r}function Zh(r){return Math.max(0,Math.min(1,r||0))}function Um(r,e,n){return(r<60?e+(n-e)*r/60:r<180?n:r<240?e+(n-e)*(240-r)/60:e)*255}const XS=r=>()=>r;function tP(r,e){return function(n){return r+n*e}}function rP(r,e,n){return r=Math.pow(r,n),e=Math.pow(e,n)-r,n=1/n,function(i){return Math.pow(r+i*e,n)}}function nP(r){return(r=+r)==1?QS:function(e,n){return n-e?rP(e,n,r):XS(isNaN(e)?n:e)}}function QS(r,e){var n=e-r;return n?tP(r,n):XS(isNaN(r)?e:r)}const t4=(function r(e){var n=nP(e);function i(a,s){var o=n((a=Pp(a)).r,(s=Pp(s)).r),l=n(a.g,s.g),u=n(a.b,s.b),c=QS(a.opacity,s.opacity);return function(h){return a.r=o(h),a.g=l(h),a.b=u(h),a.opacity=c(h),a+""}}return i.gamma=r,i})(1);function os(r,e){return r=+r,e=+e,function(n){return r*(1-n)+e*n}}var Up=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Vm=new RegExp(Up.source,"g");function iP(r){return function(){return r}}function aP(r){return function(e){return r(e)+""}}function sP(r,e){var n=Up.lastIndex=Vm.lastIndex=0,i,a,s,o=-1,l=[],u=[];for(r=r+"",e=e+"";(i=Up.exec(r))&&(a=Vm.exec(e));)(s=a.index)>n&&(s=e.slice(n,s),l[o]?l[o]+=s:l[++o]=s),(i=i[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,u.push({i:o,x:os(i,a)})),n=Vm.lastIndex;return n<e.length&&(s=e.slice(n),l[o]?l[o]+=s:l[++o]=s),l.length<2?u[0]?aP(u[0].x):iP(e):(e=u.length,function(c){for(var h=0,d;h<e;++h)l[(d=u[h]).i]=d.x(c);return l.join("")})}var r4=180/Math.PI,Vp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function WS(r,e,n,i,a,s){var o,l,u;return(o=Math.sqrt(r*r+e*e))&&(r/=o,e/=o),(u=r*n+e*i)&&(n-=r*u,i-=e*u),(l=Math.sqrt(n*n+i*i))&&(n/=l,i/=l,u/=l),r*i<e*n&&(r=-r,e=-e,u=-u,o=-o),{translateX:a,translateY:s,rotate:Math.atan2(e,r)*r4,skewX:Math.atan(u)*r4,scaleX:o,scaleY:l}}var Jh;function oP(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?Vp:WS(e.a,e.b,e.c,e.d,e.e,e.f)}function lP(r){return r==null||(Jh||(Jh=document.createElementNS("http://www.w3.org/2000/svg","g")),Jh.setAttribute("transform",r),!(r=Jh.transform.baseVal.consolidate()))?Vp:(r=r.matrix,WS(r.a,r.b,r.c,r.d,r.e,r.f))}function ZS(r,e,n,i){function a(c){return c.length?c.pop()+" ":""}function s(c,h,d,v,m,y){if(c!==d||h!==v){var b=m.push("translate(",null,e,null,n);y.push({i:b-4,x:os(c,d)},{i:b-2,x:os(h,v)})}else(d||v)&&m.push("translate("+d+e+v+n)}function o(c,h,d,v){c!==h?(c-h>180?h+=360:h-c>180&&(c+=360),v.push({i:d.push(a(d)+"rotate(",null,i)-2,x:os(c,h)})):h&&d.push(a(d)+"rotate("+h+i)}function l(c,h,d,v){c!==h?v.push({i:d.push(a(d)+"skewX(",null,i)-2,x:os(c,h)}):h&&d.push(a(d)+"skewX("+h+i)}function u(c,h,d,v,m,y){if(c!==d||h!==v){var b=m.push(a(m)+"scale(",null,",",null,")");y.push({i:b-4,x:os(c,d)},{i:b-2,x:os(h,v)})}else(d!==1||v!==1)&&m.push(a(m)+"scale("+d+","+v+")")}return function(c,h){var d=[],v=[];return c=r(c),h=r(h),s(c.translateX,c.translateY,h.translateX,h.translateY,d,v),o(c.rotate,h.rotate,d,v),l(c.skewX,h.skewX,d,v),u(c.scaleX,c.scaleY,h.scaleX,h.scaleY,d,v),c=h=null,function(m){for(var y=-1,b=v.length,x;++y<b;)d[(x=v[y]).i]=x.x(m);return d.join("")}}}var uP=ZS(oP,"px, ","px)","deg)"),cP=ZS(lP,", ",")",")"),fP=1e-12;function n4(r){return((r=Math.exp(r))+1/r)/2}function hP(r){return((r=Math.exp(r))-1/r)/2}function dP(r){return((r=Math.exp(2*r))-1)/(r+1)}const gP=(function r(e,n,i){function a(s,o){var l=s[0],u=s[1],c=s[2],h=o[0],d=o[1],v=o[2],m=h-l,y=d-u,b=m*m+y*y,x,A;if(b<fP)A=Math.log(v/c)/e,x=function(D){return[l+D*m,u+D*y,c*Math.exp(e*D*A)]};else{var C=Math.sqrt(b),E=(v*v-c*c+i*b)/(2*c*n*C),S=(v*v-c*c-i*b)/(2*v*n*C),T=Math.log(Math.sqrt(E*E+1)-E),R=Math.log(Math.sqrt(S*S+1)-S);A=(R-T)/e,x=function(D){var B=D*A,N=n4(T),I=c/(n*C)*(N*dP(e*B+T)-hP(T));return[l+I*m,u+I*y,c*N/n4(e*B+T)]}}return x.duration=A*1e3*e/Math.SQRT2,x}return a.rho=function(s){var o=Math.max(.001,+s),l=o*o,u=l*l;return r(o,l,u)},a})(Math.SQRT2,2,4);var _l=0,mc=0,Ju=0,JS=1e3,t0,pc,r0=0,po=0,N0=0,Xc=typeof performance=="object"&&performance.now?performance:Date,$S=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function V2(){return po||($S(vP),po=Xc.now()+N0)}function vP(){po=0}function n0(){this._call=this._time=this._next=null}n0.prototype=O2.prototype={constructor:n0,restart:function(r,e,n){if(typeof r!="function")throw new TypeError("callback is not a function");n=(n==null?V2():+n)+(e==null?0:+e),!this._next&&pc!==this&&(pc?pc._next=this:t0=this,pc=this),this._call=r,this._time=n,Op()},stop:function(){this._call&&(this._call=null,this._time=1/0,Op())}};function O2(r,e,n){var i=new n0;return i.restart(r,e,n),i}function mP(){V2(),++_l;for(var r=t0,e;r;)(e=po-r._time)>=0&&r._call.call(void 0,e),r=r._next;--_l}function i4(){po=(r0=Xc.now())+N0,_l=mc=0;try{mP()}finally{_l=0,yP(),po=0}}function pP(){var r=Xc.now(),e=r-r0;e>JS&&(N0-=e,r0=r)}function yP(){for(var r,e=t0,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),r=e,e=e._next):(n=e._next,e._next=null,e=r?r._next=n:t0=n);pc=r,Op(i)}function Op(r){if(!_l){mc&&(mc=clearTimeout(mc));var e=r-po;e>24?(r<1/0&&(mc=setTimeout(i4,r-Xc.now()-N0)),Ju&&(Ju=clearInterval(Ju))):(Ju||(r0=Xc.now(),Ju=setInterval(pP,JS)),_l=1,$S(i4))}}function a4(r,e,n){var i=new n0;return e=e==null?0:+e,i.restart(a=>{i.stop(),r(a+e)},e,n),i}var AP=df("start","end","cancel","interrupt"),xP=[],e6=0,s4=1,Lp=2,Td=3,o4=4,_p=5,Md=6;function F0(r,e,n,i,a,s){var o=r.__transition;if(!o)r.__transition={};else if(n in o)return;bP(r,n,{name:e,index:i,group:a,on:AP,tween:xP,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:e6})}function L2(r,e){var n=Ti(r,e);if(n.state>e6)throw new Error("too late; already scheduled");return n}function Qi(r,e){var n=Ti(r,e);if(n.state>Td)throw new Error("too late; already running");return n}function Ti(r,e){var n=r.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function bP(r,e,n){var i=r.__transition,a;i[e]=n,n.timer=O2(s,0,n.time);function s(c){n.state=s4,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var h,d,v,m;if(n.state!==s4)return u();for(h in i)if(m=i[h],m.name===n.name){if(m.state===Td)return a4(o);m.state===o4?(m.state=Md,m.timer.stop(),m.on.call("interrupt",r,r.__data__,m.index,m.group),delete i[h]):+h<e&&(m.state=Md,m.timer.stop(),m.on.call("cancel",r,r.__data__,m.index,m.group),delete i[h])}if(a4(function(){n.state===Td&&(n.state=o4,n.timer.restart(l,n.delay,n.time),l(c))}),n.state=Lp,n.on.call("start",r,r.__data__,n.index,n.group),n.state===Lp){for(n.state=Td,a=new Array(v=n.tween.length),h=0,d=-1;h<v;++h)(m=n.tween[h].value.call(r,r.__data__,n.index,n.group))&&(a[++d]=m);a.length=d+1}}function l(c){for(var h=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=_p,1),d=-1,v=a.length;++d<v;)a[d].call(r,h);n.state===_p&&(n.on.call("end",r,r.__data__,n.index,n.group),u())}function u(){n.state=Md,n.timer.stop(),delete i[e];for(var c in i)return;delete r.__transition}}function Dd(r,e){var n=r.__transition,i,a,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((i=n[o]).name!==e){s=!1;continue}a=i.state>Lp&&i.state<_p,i.state=Md,i.timer.stop(),i.on.call(a?"interrupt":"cancel",r,r.__data__,i.index,i.group),delete n[o]}s&&delete r.__transition}}function wP(r){return this.each(function(){Dd(this,r)})}function CP(r,e){var n,i;return function(){var a=Qi(this,r),s=a.tween;if(s!==n){i=n=s;for(var o=0,l=i.length;o<l;++o)if(i[o].name===e){i=i.slice(),i.splice(o,1);break}}a.tween=i}}function EP(r,e,n){var i,a;if(typeof n!="function")throw new Error;return function(){var s=Qi(this,r),o=s.tween;if(o!==i){a=(i=o).slice();for(var l={name:e,value:n},u=0,c=a.length;u<c;++u)if(a[u].name===e){a[u]=l;break}u===c&&a.push(l)}s.tween=a}}function SP(r,e){var n=this._id;if(r+="",arguments.length<2){for(var i=Ti(this.node(),n).tween,a=0,s=i.length,o;a<s;++a)if((o=i[a]).name===r)return o.value;return null}return this.each((e==null?CP:EP)(n,r,e))}function _2(r,e,n){var i=r._id;return r.each(function(){var a=Qi(this,i);(a.value||(a.value={}))[e]=n.apply(this,arguments)}),function(a){return Ti(a,i).value[e]}}function t6(r,e){var n;return(typeof e=="number"?os:e instanceof Kc?t4:(n=Kc(e))?(e=n,t4):sP)(r,e)}function TP(r){return function(){this.removeAttribute(r)}}function MP(r){return function(){this.removeAttributeNS(r.space,r.local)}}function DP(r,e,n){var i,a=n+"",s;return function(){var o=this.getAttribute(r);return o===a?null:o===i?s:s=e(i=o,n)}}function RP(r,e,n){var i,a=n+"",s;return function(){var o=this.getAttributeNS(r.space,r.local);return o===a?null:o===i?s:s=e(i=o,n)}}function BP(r,e,n){var i,a,s;return function(){var o,l=n(this),u;return l==null?void this.removeAttribute(r):(o=this.getAttribute(r),u=l+"",o===u?null:o===i&&u===a?s:(a=u,s=e(i=o,l)))}}function IP(r,e,n){var i,a,s;return function(){var o,l=n(this),u;return l==null?void this.removeAttributeNS(r.space,r.local):(o=this.getAttributeNS(r.space,r.local),u=l+"",o===u?null:o===i&&u===a?s:(a=u,s=e(i=o,l)))}}function NP(r,e){var n=I0(r),i=n==="transform"?cP:t6;return this.attrTween(r,typeof e=="function"?(n.local?IP:BP)(n,i,_2(this,"attr."+r,e)):e==null?(n.local?MP:TP)(n):(n.local?RP:DP)(n,i,e))}function FP(r,e){return function(n){this.setAttribute(r,e.call(this,n))}}function kP(r,e){return function(n){this.setAttributeNS(r.space,r.local,e.call(this,n))}}function PP(r,e){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&kP(r,s)),n}return a._value=e,a}function UP(r,e){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&FP(r,s)),n}return a._value=e,a}function VP(r,e){var n="attr."+r;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=I0(r);return this.tween(n,(i.local?PP:UP)(i,e))}function OP(r,e){return function(){L2(this,r).delay=+e.apply(this,arguments)}}function LP(r,e){return e=+e,function(){L2(this,r).delay=e}}function _P(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?OP:LP)(e,r)):Ti(this.node(),e).delay}function zP(r,e){return function(){Qi(this,r).duration=+e.apply(this,arguments)}}function qP(r,e){return e=+e,function(){Qi(this,r).duration=e}}function GP(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?zP:qP)(e,r)):Ti(this.node(),e).duration}function YP(r,e){if(typeof e!="function")throw new Error;return function(){Qi(this,r).ease=e}}function HP(r){var e=this._id;return arguments.length?this.each(YP(e,r)):Ti(this.node(),e).ease}function jP(r,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Qi(this,r).ease=n}}function KP(r){if(typeof r!="function")throw new Error;return this.each(jP(this._id,r))}function XP(r){typeof r!="function"&&(r=kS(r));for(var e=this._groups,n=e.length,i=new Array(n),a=0;a<n;++a)for(var s=e[a],o=s.length,l=i[a]=[],u,c=0;c<o;++c)(u=s[c])&&r.call(u,u.__data__,c,s)&&l.push(u);return new Ea(i,this._parents,this._name,this._id)}function QP(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,n=r._groups,i=e.length,a=n.length,s=Math.min(i,a),o=new Array(i),l=0;l<s;++l)for(var u=e[l],c=n[l],h=u.length,d=o[l]=new Array(h),v,m=0;m<h;++m)(v=u[m]||c[m])&&(d[m]=v);for(;l<i;++l)o[l]=e[l];return new Ea(o,this._parents,this._name,this._id)}function WP(r){return(r+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function ZP(r,e,n){var i,a,s=WP(e)?L2:Qi;return function(){var o=s(this,r),l=o.on;l!==i&&(a=(i=l).copy()).on(e,n),o.on=a}}function JP(r,e){var n=this._id;return arguments.length<2?Ti(this.node(),n).on.on(r):this.each(ZP(n,r,e))}function $P(r){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==r)return;e&&e.removeChild(this)}}function eU(){return this.on("end.remove",$P(this._id))}function tU(r){var e=this._name,n=this._id;typeof r!="function"&&(r=k2(r));for(var i=this._groups,a=i.length,s=new Array(a),o=0;o<a;++o)for(var l=i[o],u=l.length,c=s[o]=new Array(u),h,d,v=0;v<u;++v)(h=l[v])&&(d=r.call(h,h.__data__,v,l))&&("__data__"in h&&(d.__data__=h.__data__),c[v]=d,F0(c[v],e,n,v,c,Ti(h,n)));return new Ea(s,this._parents,e,n)}function rU(r){var e=this._name,n=this._id;typeof r!="function"&&(r=FS(r));for(var i=this._groups,a=i.length,s=[],o=[],l=0;l<a;++l)for(var u=i[l],c=u.length,h,d=0;d<c;++d)if(h=u[d]){for(var v=r.call(h,h.__data__,d,u),m,y=Ti(h,n),b=0,x=v.length;b<x;++b)(m=v[b])&&F0(m,e,n,b,v,y);s.push(v),o.push(h)}return new Ea(s,o,e,n)}var nU=hf.prototype.constructor;function iU(){return new nU(this._groups,this._parents)}function aU(r,e){var n,i,a;return function(){var s=Ll(this,r),o=(this.style.removeProperty(r),Ll(this,r));return s===o?null:s===n&&o===i?a:a=e(n=s,i=o)}}function r6(r){return function(){this.style.removeProperty(r)}}function sU(r,e,n){var i,a=n+"",s;return function(){var o=Ll(this,r);return o===a?null:o===i?s:s=e(i=o,n)}}function oU(r,e,n){var i,a,s;return function(){var o=Ll(this,r),l=n(this),u=l+"";return l==null&&(u=l=(this.style.removeProperty(r),Ll(this,r))),o===u?null:o===i&&u===a?s:(a=u,s=e(i=o,l))}}function lU(r,e){var n,i,a,s="style."+e,o="end."+s,l;return function(){var u=Qi(this,r),c=u.on,h=u.value[s]==null?l||(l=r6(e)):void 0;(c!==n||a!==h)&&(i=(n=c).copy()).on(o,a=h),u.on=i}}function uU(r,e,n){var i=(r+="")=="transform"?uP:t6;return e==null?this.styleTween(r,aU(r,i)).on("end.style."+r,r6(r)):typeof e=="function"?this.styleTween(r,oU(r,i,_2(this,"style."+r,e))).each(lU(this._id,r)):this.styleTween(r,sU(r,i,e),n).on("end.style."+r,null)}function cU(r,e,n){return function(i){this.style.setProperty(r,e.call(this,i),n)}}function fU(r,e,n){var i,a;function s(){var o=e.apply(this,arguments);return o!==a&&(i=(a=o)&&cU(r,o,n)),i}return s._value=e,s}function hU(r,e,n){var i="style."+(r+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,fU(r,e,n??""))}function dU(r){return function(){this.textContent=r}}function gU(r){return function(){var e=r(this);this.textContent=e??""}}function vU(r){return this.tween("text",typeof r=="function"?gU(_2(this,"text",r)):dU(r==null?"":r+""))}function mU(r){return function(e){this.textContent=r.call(this,e)}}function pU(r){var e,n;function i(){var a=r.apply(this,arguments);return a!==n&&(e=(n=a)&&mU(a)),e}return i._value=r,i}function yU(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,pU(r))}function AU(){for(var r=this._name,e=this._id,n=n6(),i=this._groups,a=i.length,s=0;s<a;++s)for(var o=i[s],l=o.length,u,c=0;c<l;++c)if(u=o[c]){var h=Ti(u,e);F0(u,r,n,c,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Ea(i,this._parents,r,n)}function xU(){var r,e,n=this,i=n._id,a=n.size();return new Promise(function(s,o){var l={value:o},u={value:function(){--a===0&&s()}};n.each(function(){var c=Qi(this,i),h=c.on;h!==r&&(e=(r=h).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(u)),c.on=e}),a===0&&s()})}var bU=0;function Ea(r,e,n,i){this._groups=r,this._parents=e,this._name=n,this._id=i}function n6(){return++bU}var ha=hf.prototype;Ea.prototype={constructor:Ea,select:tU,selectAll:rU,selectChild:ha.selectChild,selectChildren:ha.selectChildren,filter:XP,merge:QP,selection:iU,transition:AU,call:ha.call,nodes:ha.nodes,node:ha.node,size:ha.size,empty:ha.empty,each:ha.each,on:JP,attr:NP,attrTween:VP,style:uU,styleTween:hU,text:vU,textTween:yU,remove:eU,tween:SP,delay:_P,duration:GP,ease:HP,easeVarying:KP,end:xU,[Symbol.iterator]:ha[Symbol.iterator]};function wU(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var CU={time:null,delay:0,duration:250,ease:wU};function EU(r,e){for(var n;!(n=r.__transition)||!(n=n[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return n}function SU(r){var e,n;r instanceof Ea?(e=r._id,r=r._name):(e=n6(),(n=CU).time=V2(),r=r==null?null:r+"");for(var i=this._groups,a=i.length,s=0;s<a;++s)for(var o=i[s],l=o.length,u,c=0;c<l;++c)(u=o[c])&&F0(u,r,e,c,o,n||EU(u,e));return new Ea(i,this._parents,r,e)}hf.prototype.interrupt=wP;hf.prototype.transition=SU;const $h=r=>()=>r;function TU(r,{sourceEvent:e,target:n,transform:i,dispatch:a}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:a}})}function Aa(r,e,n){this.k=r,this.x=e,this.y=n}Aa.prototype={constructor:Aa,scale:function(r){return r===1?this:new Aa(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new Aa(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var z2=new Aa(1,0,0);Li.prototype=Aa.prototype;function Li(r){for(;!r.__zoom;)if(!(r=r.parentNode))return z2;return r.__zoom}function Om(r){r.stopImmediatePropagation()}function $u(r){r.preventDefault(),r.stopImmediatePropagation()}function MU(r){return(!r.ctrlKey||r.type==="wheel")&&!r.button}function DU(){var r=this;return r instanceof SVGElement?(r=r.ownerSVGElement||r,r.hasAttribute("viewBox")?(r=r.viewBox.baseVal,[[r.x,r.y],[r.x+r.width,r.y+r.height]]):[[0,0],[r.width.baseVal.value,r.height.baseVal.value]]):[[0,0],[r.clientWidth,r.clientHeight]]}function l4(){return this.__zoom||z2}function RU(r){return-r.deltaY*(r.deltaMode===1?.05:r.deltaMode?1:.002)*(r.ctrlKey?10:1)}function BU(){return navigator.maxTouchPoints||"ontouchstart"in this}function IU(r,e,n){var i=r.invertX(e[0][0])-n[0][0],a=r.invertX(e[1][0])-n[1][0],s=r.invertY(e[0][1])-n[0][1],o=r.invertY(e[1][1])-n[1][1];return r.translate(a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function NU(){var r=MU,e=DU,n=IU,i=RU,a=BU,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,u=gP,c=df("start","zoom","end"),h,d,v,m=500,y=150,b=0,x=10;function A(U){U.property("__zoom",l4).on("wheel.zoom",B,{passive:!1}).on("mousedown.zoom",N).on("dblclick.zoom",I).filter(a).on("touchstart.zoom",P).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",O).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}A.transform=function(U,L,V,_){var G=U.selection?U.selection():U;G.property("__zoom",l4),U!==G?T(U,L,V,_):G.interrupt().each(function(){R(this,arguments).event(_).start().zoom(null,typeof L=="function"?L.apply(this,arguments):L).end()})},A.scaleBy=function(U,L,V,_){A.scaleTo(U,function(){var G=this.__zoom.k,K=typeof L=="function"?L.apply(this,arguments):L;return G*K},V,_)},A.scaleTo=function(U,L,V,_){A.transform(U,function(){var G=e.apply(this,arguments),K=this.__zoom,z=V==null?S(G):typeof V=="function"?V.apply(this,arguments):V,Y=K.invert(z),Z=typeof L=="function"?L.apply(this,arguments):L;return n(E(C(K,Z),z,Y),G,o)},V,_)},A.translateBy=function(U,L,V,_){A.transform(U,function(){return n(this.__zoom.translate(typeof L=="function"?L.apply(this,arguments):L,typeof V=="function"?V.apply(this,arguments):V),e.apply(this,arguments),o)},null,_)},A.translateTo=function(U,L,V,_,G){A.transform(U,function(){var K=e.apply(this,arguments),z=this.__zoom,Y=_==null?S(K):typeof _=="function"?_.apply(this,arguments):_;return n(z2.translate(Y[0],Y[1]).scale(z.k).translate(typeof L=="function"?-L.apply(this,arguments):-L,typeof V=="function"?-V.apply(this,arguments):-V),K,o)},_,G)};function C(U,L){return L=Math.max(s[0],Math.min(s[1],L)),L===U.k?U:new Aa(L,U.x,U.y)}function E(U,L,V){var _=L[0]-V[0]*U.k,G=L[1]-V[1]*U.k;return _===U.x&&G===U.y?U:new Aa(U.k,_,G)}function S(U){return[(+U[0][0]+ +U[1][0])/2,(+U[0][1]+ +U[1][1])/2]}function T(U,L,V,_){U.on("start.zoom",function(){R(this,arguments).event(_).start()}).on("interrupt.zoom end.zoom",function(){R(this,arguments).event(_).end()}).tween("zoom",function(){var G=this,K=arguments,z=R(G,K).event(_),Y=e.apply(G,K),Z=V==null?S(Y):typeof V=="function"?V.apply(G,K):V,J=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),ee=G.__zoom,ne=typeof L=="function"?L.apply(G,K):L,oe=u(ee.invert(Z).concat(J/ee.k),ne.invert(Z).concat(J/ne.k));return function(me){if(me===1)me=ne;else{var ye=oe(me),ve=J/ye[2];me=new Aa(ve,Z[0]-ye[0]*ve,Z[1]-ye[1]*ve)}z.zoom(null,me)}})}function R(U,L,V){return!V&&U.__zooming||new D(U,L)}function D(U,L){this.that=U,this.args=L,this.active=0,this.sourceEvent=null,this.extent=e.apply(U,L),this.taps=0}D.prototype={event:function(U){return U&&(this.sourceEvent=U),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(U,L){return this.mouse&&U!=="mouse"&&(this.mouse[1]=L.invert(this.mouse[0])),this.touch0&&U!=="touch"&&(this.touch0[1]=L.invert(this.touch0[0])),this.touch1&&U!=="touch"&&(this.touch1[1]=L.invert(this.touch1[0])),this.that.__zoom=L,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(U){var L=oi(this.that).datum();c.call(U,this.that,new TU(U,{sourceEvent:this.sourceEvent,target:A,transform:this.that.__zoom,dispatch:c}),L)}};function B(U,...L){if(!r.apply(this,arguments))return;var V=R(this,L).event(U),_=this.__zoom,G=Math.max(s[0],Math.min(s[1],_.k*Math.pow(2,i.apply(this,arguments)))),K=_i(U);if(V.wheel)(V.mouse[0][0]!==K[0]||V.mouse[0][1]!==K[1])&&(V.mouse[1]=_.invert(V.mouse[0]=K)),clearTimeout(V.wheel);else{if(_.k===G)return;V.mouse=[K,_.invert(K)],Dd(this),V.start()}$u(U),V.wheel=setTimeout(z,y),V.zoom("mouse",n(E(C(_,G),V.mouse[0],V.mouse[1]),V.extent,o));function z(){V.wheel=null,V.end()}}function N(U,...L){if(v||!r.apply(this,arguments))return;var V=U.currentTarget,_=R(this,L,!0).event(U),G=oi(U.view).on("mousemove.zoom",Z,!0).on("mouseup.zoom",J,!0),K=_i(U,V),z=U.clientX,Y=U.clientY;YS(U.view),Om(U),_.mouse=[K,this.__zoom.invert(K)],Dd(this),_.start();function Z(ee){if($u(ee),!_.moved){var ne=ee.clientX-z,oe=ee.clientY-Y;_.moved=ne*ne+oe*oe>b}_.event(ee).zoom("mouse",n(E(_.that.__zoom,_.mouse[0]=_i(ee,V),_.mouse[1]),_.extent,o))}function J(ee){G.on("mousemove.zoom mouseup.zoom",null),HS(ee.view,_.moved),$u(ee),_.event(ee).end()}}function I(U,...L){if(r.apply(this,arguments)){var V=this.__zoom,_=_i(U.changedTouches?U.changedTouches[0]:U,this),G=V.invert(_),K=V.k*(U.shiftKey?.5:2),z=n(E(C(V,K),_,G),e.apply(this,L),o);$u(U),l>0?oi(this).transition().duration(l).call(T,z,_,U):oi(this).call(A.transform,z,_,U)}}function P(U,...L){if(r.apply(this,arguments)){var V=U.touches,_=V.length,G=R(this,L,U.changedTouches.length===_).event(U),K,z,Y,Z;for(Om(U),z=0;z<_;++z)Y=V[z],Z=_i(Y,this),Z=[Z,this.__zoom.invert(Z),Y.identifier],G.touch0?!G.touch1&&G.touch0[2]!==Z[2]&&(G.touch1=Z,G.taps=0):(G.touch0=Z,K=!0,G.taps=1+!!h);h&&(h=clearTimeout(h)),K&&(G.taps<2&&(d=Z[0],h=setTimeout(function(){h=null},m)),Dd(this),G.start())}}function F(U,...L){if(this.__zooming){var V=R(this,L).event(U),_=U.changedTouches,G=_.length,K,z,Y,Z;for($u(U),K=0;K<G;++K)z=_[K],Y=_i(z,this),V.touch0&&V.touch0[2]===z.identifier?V.touch0[0]=Y:V.touch1&&V.touch1[2]===z.identifier&&(V.touch1[0]=Y);if(z=V.that.__zoom,V.touch1){var J=V.touch0[0],ee=V.touch0[1],ne=V.touch1[0],oe=V.touch1[1],me=(me=ne[0]-J[0])*me+(me=ne[1]-J[1])*me,ye=(ye=oe[0]-ee[0])*ye+(ye=oe[1]-ee[1])*ye;z=C(z,Math.sqrt(me/ye)),Y=[(J[0]+ne[0])/2,(J[1]+ne[1])/2],Z=[(ee[0]+oe[0])/2,(ee[1]+oe[1])/2]}else if(V.touch0)Y=V.touch0[0],Z=V.touch0[1];else return;V.zoom("touch",n(E(z,Y,Z),V.extent,o))}}function O(U,...L){if(this.__zooming){var V=R(this,L).event(U),_=U.changedTouches,G=_.length,K,z;for(Om(U),v&&clearTimeout(v),v=setTimeout(function(){v=null},m),K=0;K<G;++K)z=_[K],V.touch0&&V.touch0[2]===z.identifier?delete V.touch0:V.touch1&&V.touch1[2]===z.identifier&&delete V.touch1;if(V.touch1&&!V.touch0&&(V.touch0=V.touch1,delete V.touch1),V.touch0)V.touch0[1]=this.__zoom.invert(V.touch0[0]);else if(V.end(),V.taps===2&&(z=_i(z,this),Math.hypot(d[0]-z[0],d[1]-z[1])<x)){var Y=oi(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return A.wheelDelta=function(U){return arguments.length?(i=typeof U=="function"?U:$h(+U),A):i},A.filter=function(U){return arguments.length?(r=typeof U=="function"?U:$h(!!U),A):r},A.touchable=function(U){return arguments.length?(a=typeof U=="function"?U:$h(!!U),A):a},A.extent=function(U){return arguments.length?(e=typeof U=="function"?U:$h([[+U[0][0],+U[0][1]],[+U[1][0],+U[1][1]]]),A):e},A.scaleExtent=function(U){return arguments.length?(s[0]=+U[0],s[1]=+U[1],A):[s[0],s[1]]},A.translateExtent=function(U){return arguments.length?(o[0][0]=+U[0][0],o[1][0]=+U[1][0],o[0][1]=+U[0][1],o[1][1]=+U[1][1],A):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},A.constrain=function(U){return arguments.length?(n=U,A):n},A.duration=function(U){return arguments.length?(l=+U,A):l},A.interpolate=function(U){return arguments.length?(u=U,A):u},A.on=function(){var U=c.on.apply(c,arguments);return U===c?A:U},A.clickDistance=function(U){return arguments.length?(b=(U=+U)*U,A):Math.sqrt(b)},A.tapDistance=function(U){return arguments.length?(x=+U,A):x},A}class u4 extends Map{constructor(e,n=PU){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,a]of e)this.set(i,a)}get(e){return super.get(c4(this,e))}has(e){return super.has(c4(this,e))}set(e,n){return super.set(FU(this,e),n)}delete(e){return super.delete(kU(this,e))}}function c4({_intern:r,_key:e},n){const i=e(n);return r.has(i)?r.get(i):n}function FU({_intern:r,_key:e},n){const i=e(n);return r.has(i)?r.get(i):(r.set(i,n),n)}function kU({_intern:r,_key:e},n){const i=e(n);return r.has(i)&&(n=r.get(i),r.delete(i)),n}function PU(r){return r!==null&&typeof r=="object"?r.valueOf():r}function f4(r,e){let n;if(e===void 0)for(const i of r)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let a of r)(a=e(a,++i,r))!=null&&(n<a||n===void 0&&a>=a)&&(n=a)}return n}function h4(r,e){let n;if(e===void 0)for(const i of r)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let a of r)(a=e(a,++i,r))!=null&&(n>a||n===void 0&&a>=a)&&(n=a)}return n}function UU(r,e){let n=0;for(let i of r)(i=+i)&&(n+=i);return n}var VU=typeof global=="object"&&global&&global.Object===Object&&global,OU=typeof self=="object"&&self&&self.Object===Object&&self,i6=VU||OU||Function("return this")(),i0=i6.Symbol,a6=Object.prototype,LU=a6.hasOwnProperty,_U=a6.toString,ec=i0?i0.toStringTag:void 0;function zU(r){var e=LU.call(r,ec),n=r[ec];try{r[ec]=void 0;var i=!0}catch{}var a=_U.call(r);return i&&(e?r[ec]=n:delete r[ec]),a}var qU=Object.prototype,GU=qU.toString;function YU(r){return GU.call(r)}var HU="[object Null]",jU="[object Undefined]",d4=i0?i0.toStringTag:void 0;function KU(r){return r==null?r===void 0?jU:HU:d4&&d4 in Object(r)?zU(r):YU(r)}function XU(r){return r!=null&&typeof r=="object"}var QU="[object Symbol]";function WU(r){return typeof r=="symbol"||XU(r)&&KU(r)==QU}var ZU=/\s/;function JU(r){for(var e=r.length;e--&&ZU.test(r.charAt(e)););return e}var $U=/^\s+/;function eV(r){return r&&r.slice(0,JU(r)+1).replace($U,"")}function a0(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var g4=NaN,tV=/^[-+]0x[0-9a-f]+$/i,rV=/^0b[01]+$/i,nV=/^0o[0-7]+$/i,iV=parseInt;function v4(r){if(typeof r=="number")return r;if(WU(r))return g4;if(a0(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=a0(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=eV(r);var n=rV.test(r);return n||nV.test(r)?iV(r.slice(2),n?2:8):tV.test(r)?g4:+r}var Lm=function(){return i6.Date.now()},aV="Expected a function",sV=Math.max,oV=Math.min;function s6(r,e,n){var i,a,s,o,l,u,c=0,h=!1,d=!1,v=!0;if(typeof r!="function")throw new TypeError(aV);e=v4(e)||0,a0(n)&&(h=!!n.leading,d="maxWait"in n,s=d?sV(v4(n.maxWait)||0,e):s,v="trailing"in n?!!n.trailing:v);function m(R){var D=i,B=a;return i=a=void 0,c=R,o=r.apply(B,D),o}function y(R){return c=R,l=setTimeout(A,e),h?m(R):o}function b(R){var D=R-u,B=R-c,N=e-D;return d?oV(N,s-B):N}function x(R){var D=R-u,B=R-c;return u===void 0||D>=e||D<0||d&&B>=s}function A(){var R=Lm();if(x(R))return C(R);l=setTimeout(A,b(R))}function C(R){return l=void 0,v&&i?m(R):(i=a=void 0,o)}function E(){l!==void 0&&clearTimeout(l),c=0,i=u=a=l=void 0}function S(){return l===void 0?o:C(Lm())}function T(){var R=Lm(),D=x(R);if(i=arguments,a=this,u=R,D){if(l===void 0)return y(u);if(d)return clearTimeout(l),l=setTimeout(A,e),m(u)}return l===void 0&&(l=setTimeout(A,e)),o}return T.cancel=E,T.flush=S,T}var lV="Expected a function";function uV(r,e,n){var i=!0,a=!0;if(typeof r!="function")throw new TypeError(lV);return a0(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),s6(r,e,{leading:i,maxWait:e,trailing:a})}var lo=Object.freeze({Linear:Object.freeze({None:function(r){return r},In:function(r){return r},Out:function(r){return r},InOut:function(r){return r}}),Quadratic:Object.freeze({In:function(r){return r*r},Out:function(r){return r*(2-r)},InOut:function(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)}}),Cubic:Object.freeze({In:function(r){return r*r*r},Out:function(r){return--r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)}}),Quartic:Object.freeze({In:function(r){return r*r*r*r},Out:function(r){return 1- --r*r*r*r},InOut:function(r){return(r*=2)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2)}}),Quintic:Object.freeze({In:function(r){return r*r*r*r*r},Out:function(r){return--r*r*r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2)}}),Sinusoidal:Object.freeze({In:function(r){return 1-Math.sin((1-r)*Math.PI/2)},Out:function(r){return Math.sin(r*Math.PI/2)},InOut:function(r){return .5*(1-Math.sin(Math.PI*(.5-r)))}}),Exponential:Object.freeze({In:function(r){return r===0?0:Math.pow(1024,r-1)},Out:function(r){return r===1?1:1-Math.pow(2,-10*r)},InOut:function(r){return r===0?0:r===1?1:(r*=2)<1?.5*Math.pow(1024,r-1):.5*(-Math.pow(2,-10*(r-1))+2)}}),Circular:Object.freeze({In:function(r){return 1-Math.sqrt(1-r*r)},Out:function(r){return Math.sqrt(1- --r*r)},InOut:function(r){return(r*=2)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1)}}),Elastic:Object.freeze({In:function(r){return r===0?0:r===1?1:-Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI)},Out:function(r){return r===0?0:r===1?1:Math.pow(2,-10*r)*Math.sin((r-.1)*5*Math.PI)+1},InOut:function(r){return r===0?0:r===1?1:(r*=2,r<1?-.5*Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI):.5*Math.pow(2,-10*(r-1))*Math.sin((r-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(r){var e=1.70158;return r===1?1:r*r*((e+1)*r-e)},Out:function(r){var e=1.70158;return r===0?0:--r*r*((e+1)*r+e)+1},InOut:function(r){var e=2.5949095;return(r*=2)<1?.5*(r*r*((e+1)*r-e)):.5*((r-=2)*r*((e+1)*r+e)+2)}}),Bounce:Object.freeze({In:function(r){return 1-lo.Bounce.Out(1-r)},Out:function(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},InOut:function(r){return r<.5?lo.Bounce.In(r*2)*.5:lo.Bounce.Out(r*2-1)*.5+.5}}),generatePow:function(r){return r===void 0&&(r=4),r=r<Number.EPSILON?Number.EPSILON:r,r=r>1e4?1e4:r,{In:function(e){return Math.pow(e,r)},Out:function(e){return 1-Math.pow(1-e,r)},InOut:function(e){return e<.5?Math.pow(e*2,r)/2:(1-Math.pow(2-e*2,r))/2+.5}}}}),yc=function(){return performance.now()},o6=(function(){function r(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return r.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(n){return e._tweens[n]})},r.prototype.removeAll=function(){this._tweens={}},r.prototype.add=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var a=0,s=n;a<s.length;a++){var o=s[a];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},r.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var i=0,a=e;i<a.length;i++){var s=a[i];s._group=void 0,delete this._tweens[s.getId()],delete this._tweensAddedDuringUpdate[s.getId()]}},r.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},r.prototype.update=function(e,n){e===void 0&&(e=yc()),n===void 0&&(n=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var a=0;a<i.length;a++){var s=this._tweens[i[a]],o=!n;s&&s.update(e,o)===!1&&!n&&this.remove(s)}i=Object.keys(this._tweensAddedDuringUpdate)}},r})(),zp={Linear:function(r,e){var n=r.length-1,i=n*e,a=Math.floor(i),s=zp.Utils.Linear;return e<0?s(r[0],r[1],i):e>1?s(r[n],r[n-1],n-i):s(r[a],r[a+1>n?n:a+1],i-a)},Utils:{Linear:function(r,e,n){return(e-r)*n+r}}},l6=(function(){function r(){}return r.nextId=function(){return r._nextId++},r._nextId=0,r})(),qp=new o6,m4=(function(){function r(e,n){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=lo.Linear.None,this._interpolationFunction=zp.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=l6.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof n=="object"?(this._group=n,n.add(this)):n===!0&&(this._group=qp,qp.add(this))}return r.prototype.getId=function(){return this._id},r.prototype.isPlaying=function(){return this._isPlaying},r.prototype.isPaused=function(){return this._isPaused},r.prototype.getDuration=function(){return this._duration},r.prototype.to=function(e,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},r.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},r.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},r.prototype.start=function(e,n){if(e===void 0&&(e=yc()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var a={};for(var s in this._valuesEnd)a[s]=this._valuesEnd[s];this._valuesEnd=a}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},r.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},r.prototype._setupProperties=function(e,n,i,a,s){for(var o in i){var l=e[o],u=Array.isArray(l),c=u?"array":typeof l,h=!u&&Array.isArray(i[o]);if(!(c==="undefined"||c==="function")){if(h){var d=i[o];if(d.length===0)continue;for(var v=[l],m=0,y=d.length;m<y;m+=1){var b=this._handleRelativeValue(l,d[m]);if(isNaN(b)){h=!1,console.warn("Found invalid interpolation list. Skipping.");break}v.push(b)}h&&(i[o]=v)}if((c==="object"||u)&&l&&!h){n[o]=u?[]:{};var x=l;for(var A in x)n[o][A]=x[A];a[o]=u?[]:{};var d=i[o];if(!this._isDynamic){var C={};for(var A in d)C[A]=d[A];i[o]=d=C}this._setupProperties(x,n[o],d,a[o],s)}else(typeof n[o]>"u"||s)&&(n[o]=l),u||(n[o]*=1),h?a[o]=i[o].slice().reverse():a[o]=n[o]||0}}},r.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},r.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},r.prototype.pause=function(e){return e===void 0&&(e=yc()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},r.prototype.resume=function(e){return e===void 0&&(e=yc()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},r.prototype.stopChainedTweens=function(){for(var e=0,n=this._chainedTweens.length;e<n;e++)this._chainedTweens[e].stop();return this},r.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},r.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},r.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},r.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},r.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},r.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},r.prototype.easing=function(e){return e===void 0&&(e=lo.Linear.None),this._easingFunction=e,this},r.prototype.interpolation=function(e){return e===void 0&&(e=zp.Linear),this._interpolationFunction=e,this},r.prototype.chain=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._chainedTweens=e,this},r.prototype.onStart=function(e){return this._onStartCallback=e,this},r.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},r.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},r.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},r.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},r.prototype.onStop=function(e){return this._onStopCallback=e,this},r.prototype.update=function(e,n){var i=this,a;if(e===void 0&&(e=yc()),n===void 0&&(n=r.autoStartOnUpdate),this._isPaused)return!0;var s;if(!this._goToEnd&&!this._isPlaying)if(n)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,l=this._duration+((a=this._repeatDelayTime)!==null&&a!==void 0?a:this._delayTime),u=this._duration+this._repeat*l,c=function(){if(i._duration===0||o>u)return 1;var b=Math.trunc(o/l),x=o-b*l,A=Math.min(x/i._duration,1);return A===0&&o===i._duration?1:A},h=c(),d=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,d),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),this._duration===0||o>=this._duration)if(this._repeat>0){var v=Math.min(Math.trunc((o-this._duration)/l)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=v);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=l*v,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var m=0,y=this._chainedTweens.length;m<y;m++)this._chainedTweens[m].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},r.prototype._updateProperties=function(e,n,i,a){for(var s in i)if(n[s]!==void 0){var o=n[s]||0,l=i[s],u=Array.isArray(e[s]),c=Array.isArray(l),h=!u&&c;h?e[s]=this._interpolationFunction(l,a):typeof l=="object"&&l?this._updateProperties(e[s],o,l,a):(l=this._handleRelativeValue(o,l),typeof l=="number"&&(e[s]=o+(l-o)*a))}},r.prototype._handleRelativeValue=function(e,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?e+parseFloat(n):parseFloat(n)},r.prototype._swapEndStartRepeatValues=function(e){var n=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=n},r.autoStartOnUpdate=!1,r})();l6.nextId;var ji=qp;ji.getAll.bind(ji);ji.removeAll.bind(ji);ji.add.bind(ji);ji.remove.bind(ji);ji.update.bind(ji);function p4(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function cV(r){if(Array.isArray(r))return r}function fV(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function hV(r,e,n){return Object.defineProperty(r,"prototype",{writable:!1}),r}function dV(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],u=!0,c=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(u=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);u=!0);}catch(h){c=!0,a=h}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function gV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vV(r,e){return cV(r)||dV(r,e)||mV(r,e)||gV()}function mV(r,e){if(r){if(typeof r=="string")return p4(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p4(r,e):void 0}}var pV=hV(function r(e,n){var i=n.default,a=i===void 0?null:i,s=n.triggerUpdate,o=s===void 0?!0:s,l=n.onChange,u=l===void 0?function(c,h){}:l;fV(this,r),this.name=e,this.defaultVal=a,this.triggerUpdate=o,this.onChange=u});function q2(r){var e=r.stateInit,n=e===void 0?function(){return{}}:e,i=r.props,a=i===void 0?{}:i,s=r.methods,o=s===void 0?{}:s,l=r.aliases,u=l===void 0?{}:l,c=r.init,h=c===void 0?function(){}:c,d=r.update,v=d===void 0?function(){}:d,m=Object.keys(a).map(function(y){return new pV(y,a[y])});return function y(){for(var b=arguments.length,x=new Array(b),A=0;A<b;A++)x[A]=arguments[A];var C=!!(this instanceof y&&this.constructor),E=C?x.shift():void 0,S=x[0],T=S===void 0?{}:S,R=Object.assign({},n instanceof Function?n(T):n,{initialised:!1}),D={};function B(P){return N(P,T),I(),B}var N=function(F,O){h.call(B,F,R,O),R.initialised=!0},I=s6(function(){R.initialised&&(v.call(B,R,D),D={})},1);return m.forEach(function(P){B[P.name]=F(P);function F(O){var U=O.name,L=O.triggerUpdate,V=L===void 0?!1:L,_=O.onChange,G=_===void 0?function(Y,Z){}:_,K=O.defaultVal,z=K===void 0?null:K;return function(Y){var Z=R[U];if(!arguments.length)return Z;var J=Y===void 0?z:Y;return R[U]=J,G.call(B,J,R,Z),!D.hasOwnProperty(U)&&(D[U]=Z),V&&I(),B}}}),Object.keys(o).forEach(function(P){B[P]=function(){for(var F,O=arguments.length,U=new Array(O),L=0;L<O;L++)U[L]=arguments[L];return(F=o[P]).call.apply(F,[B,R].concat(U))}}),Object.entries(u).forEach(function(P){var F=vV(P,2),O=F[0],U=F[1];return B[O]=B[U]}),B.resetProps=function(){return m.forEach(function(P){B[P.name](P.defaultVal)}),B},B.resetProps(),R._rerender=I,C&&E&&B(E),B}}var Ut=(function(r){return typeof r=="function"?r:typeof r=="string"?function(e){return e[r]}:function(e){return r}});function s0(r){"@babel/helpers - typeof";return s0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s0(r)}var yV=/^\s+/,AV=/\s+$/;function We(r,e){if(r=r||"",e=e||{},r instanceof We)return r;if(!(this instanceof We))return new We(r,e);var n=xV(r);this._originalInput=r,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}We.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),n,i,a,s,o,l;return n=e.r/255,i=e.g/255,a=e.b/255,n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),a<=.03928?l=a/12.92:l=Math.pow((a+.055)/1.055,2.4),.2126*s+.7152*o+.0722*l},setAlpha:function(e){return this._a=u6(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=A4(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=A4(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),a=Math.round(e.v*100);return this._a==1?"hsv("+n+", "+i+"%, "+a+"%)":"hsva("+n+", "+i+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var e=y4(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=y4(this._r,this._g,this._b),n=Math.round(e.h*360),i=Math.round(e.s*100),a=Math.round(e.l*100);return this._a==1?"hsl("+n+", "+i+"%, "+a+"%)":"hsla("+n+", "+i+"%, "+a+"%, "+this._roundA+")"},toHex:function(e){return x4(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return EV(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ur(this._r,255)*100)+"%",g:Math.round(ur(this._g,255)*100)+"%",b:Math.round(ur(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ur(this._r,255)*100)+"%, "+Math.round(ur(this._g,255)*100)+"%, "+Math.round(ur(this._b,255)*100)+"%)":"rgba("+Math.round(ur(this._r,255)*100)+"%, "+Math.round(ur(this._g,255)*100)+"%, "+Math.round(ur(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:UV[x4(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var n="#"+b4(this._r,this._g,this._b,this._a),i=n,a=this._gradientType?"GradientType = 1, ":"";if(e){var s=We(e);i="#"+b4(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+n+",endColorstr="+i+")"},toString:function(e){var n=!!e;e=e||this._format;var i=!1,a=this._a<1&&this._a>=0,s=!n&&a&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return We(this.toString())},_applyModification:function(e,n){var i=e.apply(null,[this].concat([].slice.call(n)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(DV,arguments)},brighten:function(){return this._applyModification(RV,arguments)},darken:function(){return this._applyModification(BV,arguments)},desaturate:function(){return this._applyModification(SV,arguments)},saturate:function(){return this._applyModification(TV,arguments)},greyscale:function(){return this._applyModification(MV,arguments)},spin:function(){return this._applyModification(IV,arguments)},_applyCombination:function(e,n){return e.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(kV,arguments)},complement:function(){return this._applyCombination(NV,arguments)},monochromatic:function(){return this._applyCombination(PV,arguments)},splitcomplement:function(){return this._applyCombination(FV,arguments)},triad:function(){return this._applyCombination(w4,[3])},tetrad:function(){return this._applyCombination(w4,[4])}};We.fromRatio=function(r,e){if(s0(r)=="object"){var n={};for(var i in r)r.hasOwnProperty(i)&&(i==="a"?n[i]=r[i]:n[i]=Ac(r[i]));r=n}return We(r,e)};function xV(r){var e={r:0,g:0,b:0},n=1,i=null,a=null,s=null,o=!1,l=!1;return typeof r=="string"&&(r=_V(r)),s0(r)=="object"&&(da(r.r)&&da(r.g)&&da(r.b)?(e=bV(r.r,r.g,r.b),o=!0,l=String(r.r).substr(-1)==="%"?"prgb":"rgb"):da(r.h)&&da(r.s)&&da(r.v)?(i=Ac(r.s),a=Ac(r.v),e=CV(r.h,i,a),o=!0,l="hsv"):da(r.h)&&da(r.s)&&da(r.l)&&(i=Ac(r.s),s=Ac(r.l),e=wV(r.h,i,s),o=!0,l="hsl"),r.hasOwnProperty("a")&&(n=r.a)),n=u6(n),{ok:o,format:r.format||l,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}function bV(r,e,n){return{r:ur(r,255)*255,g:ur(e,255)*255,b:ur(n,255)*255}}function y4(r,e,n){r=ur(r,255),e=ur(e,255),n=ur(n,255);var i=Math.max(r,e,n),a=Math.min(r,e,n),s,o,l=(i+a)/2;if(i==a)s=o=0;else{var u=i-a;switch(o=l>.5?u/(2-i-a):u/(i+a),i){case r:s=(e-n)/u+(e<n?6:0);break;case e:s=(n-r)/u+2;break;case n:s=(r-e)/u+4;break}s/=6}return{h:s,s:o,l}}function wV(r,e,n){var i,a,s;r=ur(r,360),e=ur(e,100),n=ur(n,100);function o(c,h,d){return d<0&&(d+=1),d>1&&(d-=1),d<1/6?c+(h-c)*6*d:d<1/2?h:d<2/3?c+(h-c)*(2/3-d)*6:c}if(e===0)i=a=s=n;else{var l=n<.5?n*(1+e):n+e-n*e,u=2*n-l;i=o(u,l,r+1/3),a=o(u,l,r),s=o(u,l,r-1/3)}return{r:i*255,g:a*255,b:s*255}}function A4(r,e,n){r=ur(r,255),e=ur(e,255),n=ur(n,255);var i=Math.max(r,e,n),a=Math.min(r,e,n),s,o,l=i,u=i-a;if(o=i===0?0:u/i,i==a)s=0;else{switch(i){case r:s=(e-n)/u+(e<n?6:0);break;case e:s=(n-r)/u+2;break;case n:s=(r-e)/u+4;break}s/=6}return{h:s,s:o,v:l}}function CV(r,e,n){r=ur(r,360)*6,e=ur(e,100),n=ur(n,100);var i=Math.floor(r),a=r-i,s=n*(1-e),o=n*(1-a*e),l=n*(1-(1-a)*e),u=i%6,c=[n,o,s,s,l,n][u],h=[l,n,n,o,s,s][u],d=[s,s,l,n,n,o][u];return{r:c*255,g:h*255,b:d*255}}function x4(r,e,n,i){var a=[Ci(Math.round(r).toString(16)),Ci(Math.round(e).toString(16)),Ci(Math.round(n).toString(16))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function EV(r,e,n,i,a){var s=[Ci(Math.round(r).toString(16)),Ci(Math.round(e).toString(16)),Ci(Math.round(n).toString(16)),Ci(c6(i))];return a&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function b4(r,e,n,i){var a=[Ci(c6(i)),Ci(Math.round(r).toString(16)),Ci(Math.round(e).toString(16)),Ci(Math.round(n).toString(16))];return a.join("")}We.equals=function(r,e){return!r||!e?!1:We(r).toRgbString()==We(e).toRgbString()};We.random=function(){return We.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function SV(r,e){e=e===0?0:e||10;var n=We(r).toHsl();return n.s-=e/100,n.s=k0(n.s),We(n)}function TV(r,e){e=e===0?0:e||10;var n=We(r).toHsl();return n.s+=e/100,n.s=k0(n.s),We(n)}function MV(r){return We(r).desaturate(100)}function DV(r,e){e=e===0?0:e||10;var n=We(r).toHsl();return n.l+=e/100,n.l=k0(n.l),We(n)}function RV(r,e){e=e===0?0:e||10;var n=We(r).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),We(n)}function BV(r,e){e=e===0?0:e||10;var n=We(r).toHsl();return n.l-=e/100,n.l=k0(n.l),We(n)}function IV(r,e){var n=We(r).toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,We(n)}function NV(r){var e=We(r).toHsl();return e.h=(e.h+180)%360,We(e)}function w4(r,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=We(r).toHsl(),i=[We(r)],a=360/e,s=1;s<e;s++)i.push(We({h:(n.h+s*a)%360,s:n.s,l:n.l}));return i}function FV(r){var e=We(r).toHsl(),n=e.h;return[We(r),We({h:(n+72)%360,s:e.s,l:e.l}),We({h:(n+216)%360,s:e.s,l:e.l})]}function kV(r,e,n){e=e||6,n=n||30;var i=We(r).toHsl(),a=360/n,s=[We(r)];for(i.h=(i.h-(a*e>>1)+720)%360;--e;)i.h=(i.h+a)%360,s.push(We(i));return s}function PV(r,e){e=e||6;for(var n=We(r).toHsv(),i=n.h,a=n.s,s=n.v,o=[],l=1/e;e--;)o.push(We({h:i,s:a,v:s})),s=(s+l)%1;return o}We.mix=function(r,e,n){n=n===0?0:n||50;var i=We(r).toRgb(),a=We(e).toRgb(),s=n/100,o={r:(a.r-i.r)*s+i.r,g:(a.g-i.g)*s+i.g,b:(a.b-i.b)*s+i.b,a:(a.a-i.a)*s+i.a};return We(o)};We.readability=function(r,e){var n=We(r),i=We(e);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)};We.isReadable=function(r,e,n){var i=We.readability(r,e),a,s;switch(s=!1,a=zV(n),a.level+a.size){case"AAsmall":case"AAAlarge":s=i>=4.5;break;case"AAlarge":s=i>=3;break;case"AAAsmall":s=i>=7;break}return s};We.mostReadable=function(r,e,n){var i=null,a=0,s,o,l,u;n=n||{},o=n.includeFallbackColors,l=n.level,u=n.size;for(var c=0;c<e.length;c++)s=We.readability(r,e[c]),s>a&&(a=s,i=We(e[c]));return We.isReadable(r,i,{level:l,size:u})||!o?i:(n.includeFallbackColors=!1,We.mostReadable(r,["#fff","#000"],n))};var Gp=We.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},UV=We.hexNames=VV(Gp);function VV(r){var e={};for(var n in r)r.hasOwnProperty(n)&&(e[r[n]]=n);return e}function u6(r){return r=parseFloat(r),(isNaN(r)||r<0||r>1)&&(r=1),r}function ur(r,e){OV(r)&&(r="100%");var n=LV(r);return r=Math.min(e,Math.max(0,parseFloat(r))),n&&(r=parseInt(r*e,10)/100),Math.abs(r-e)<1e-6?1:r%e/parseFloat(e)}function k0(r){return Math.min(1,Math.max(0,r))}function Gn(r){return parseInt(r,16)}function OV(r){return typeof r=="string"&&r.indexOf(".")!=-1&&parseFloat(r)===1}function LV(r){return typeof r=="string"&&r.indexOf("%")!=-1}function Ci(r){return r.length==1?"0"+r:""+r}function Ac(r){return r<=1&&(r=r*100+"%"),r}function c6(r){return Math.round(parseFloat(r)*255).toString(16)}function C4(r){return Gn(r)/255}var mi=(function(){var r="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+r+")",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",a="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{CSS_UNIT:new RegExp(n),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function da(r){return!!mi.CSS_UNIT.exec(r)}function _V(r){r=r.replace(yV,"").replace(AV,"").toLowerCase();var e=!1;if(Gp[r])r=Gp[r],e=!0;else if(r=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=mi.rgb.exec(r))?{r:n[1],g:n[2],b:n[3]}:(n=mi.rgba.exec(r))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=mi.hsl.exec(r))?{h:n[1],s:n[2],l:n[3]}:(n=mi.hsla.exec(r))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=mi.hsv.exec(r))?{h:n[1],s:n[2],v:n[3]}:(n=mi.hsva.exec(r))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=mi.hex8.exec(r))?{r:Gn(n[1]),g:Gn(n[2]),b:Gn(n[3]),a:C4(n[4]),format:e?"name":"hex8"}:(n=mi.hex6.exec(r))?{r:Gn(n[1]),g:Gn(n[2]),b:Gn(n[3]),format:e?"name":"hex"}:(n=mi.hex4.exec(r))?{r:Gn(n[1]+""+n[1]),g:Gn(n[2]+""+n[2]),b:Gn(n[3]+""+n[3]),a:C4(n[4]+""+n[4]),format:e?"name":"hex8"}:(n=mi.hex3.exec(r))?{r:Gn(n[1]+""+n[1]),g:Gn(n[2]+""+n[2]),b:Gn(n[3]+""+n[3]),format:e?"name":"hex"}:!1}function zV(r){var e,n;return r=r||{level:"AA",size:"small"},e=(r.level||"AA").toUpperCase(),n=(r.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),n!=="small"&&n!=="large"&&(n="small"),{level:e,size:n}}function Yp(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function qV(r){if(Array.isArray(r))return Yp(r)}function f6(r,e,n){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function GV(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YV(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function ni(r,e){return r.get(f6(r,e))}function E4(r,e,n){GV(r,e),e.set(r,n)}function S4(r,e,n){return r.set(f6(r,e),n),n}function HV(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,ZV(i.key),i)}}function jV(r,e,n){return e&&HV(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function KV(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function XV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QV(r){return qV(r)||KV(r)||JV(r)||XV()}function WV(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function ZV(r){var e=WV(r,"string");return typeof e=="symbol"?e:e+""}function JV(r,e){if(r){if(typeof r=="string")return Yp(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yp(r,e):void 0}}var $V=123,eO=function(e){return"#".concat(Math.min(e,Math.pow(2,24)).toString(16).padStart(6,"0"))},h6=function(e,n,i){return(e<<16)+(n<<8)+i},tO=function(e){var n=We(e).toRgb(),i=n.r,a=n.g,s=n.b;return h6(i,a,s)},T4=function(e,n){return e*$V%Math.pow(2,n)},Xs=new WeakMap,ga=new WeakMap,rO=(function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;YV(this,r),E4(this,Xs,void 0),E4(this,ga,void 0),S4(ga,this,e),this.reset()}return jV(r,[{key:"reset",value:function(){S4(Xs,this,["__reserved for background__"])}},{key:"register",value:function(n){if(ni(Xs,this).length>=Math.pow(2,24-ni(ga,this)))return null;var i=ni(Xs,this).length,a=T4(i,ni(ga,this)),s=eO(i+(a<<24-ni(ga,this)));return ni(Xs,this).push(n),s}},{key:"lookup",value:function(n){if(!n)return null;var i=typeof n=="string"?tO(n):h6.apply(void 0,QV(n));if(!i)return null;var a=i&Math.pow(2,24-ni(ga,this))-1,s=i>>24-ni(ga,this)&Math.pow(2,ni(ga,this))-1;return T4(a,ni(ga,this))!==s||a>=ni(Xs,this).length?null:ni(Xs,this)[a]}}])})(),vf,fr,d6,g6,to,M4,v6,m6,p6,G2,Hp,jp,Qc={},y6=[],nO=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,P0=Array.isArray;function qi(r,e){for(var n in e)r[n]=e[n];return r}function Y2(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function iO(r,e,n){var i,a,s,o={};for(s in e)s=="key"?i=e[s]:s=="ref"?a=e[s]:o[s]=e[s];if(arguments.length>2&&(o.children=arguments.length>3?vf.call(arguments,2):n),typeof r=="function"&&r.defaultProps!=null)for(s in r.defaultProps)o[s]===void 0&&(o[s]=r.defaultProps[s]);return Mc(r,o,i,a,null)}function Mc(r,e,n,i,a){var s={type:r,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++d6,__i:-1,__u:0};return a==null&&fr.vnode!=null&&fr.vnode(s),s}function U0(r){return r.children}function Rd(r,e){this.props=r,this.context=e}function zl(r,e){if(e==null)return r.__?zl(r.__,r.__i+1):null;for(var n;e<r.__k.length;e++)if((n=r.__k[e])!=null&&n.__e!=null)return n.__e;return typeof r.type=="function"?zl(r):null}function A6(r){var e,n;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((n=r.__k[e])!=null&&n.__e!=null){r.__e=r.__c.base=n.__e;break}return A6(r)}}function D4(r){(!r.__d&&(r.__d=!0)&&to.push(r)&&!o0.__r++||M4!=fr.debounceRendering)&&((M4=fr.debounceRendering)||v6)(o0)}function o0(){for(var r,e,n,i,a,s,o,l=1;to.length;)to.length>l&&to.sort(m6),r=to.shift(),l=to.length,r.__d&&(n=void 0,i=void 0,a=(i=(e=r).__v).__e,s=[],o=[],e.__P&&((n=qi({},i)).__v=i.__v+1,fr.vnode&&fr.vnode(n),H2(e.__P,n,i,e.__n,e.__P.namespaceURI,32&i.__u?[a]:null,s,a??zl(i),!!(32&i.__u),o),n.__v=i.__v,n.__.__k[n.__i]=n,w6(s,n,o),i.__e=i.__=null,n.__e!=a&&A6(n)));o0.__r=0}function x6(r,e,n,i,a,s,o,l,u,c,h){var d,v,m,y,b,x,A,C=i&&i.__k||y6,E=e.length;for(u=aO(n,e,C,u,E),d=0;d<E;d++)(m=n.__k[d])!=null&&(v=m.__i==-1?Qc:C[m.__i]||Qc,m.__i=d,x=H2(r,m,v,a,s,o,l,u,c,h),y=m.__e,m.ref&&v.ref!=m.ref&&(v.ref&&j2(v.ref,null,m),h.push(m.ref,m.__c||y,m)),b==null&&y!=null&&(b=y),(A=!!(4&m.__u))||v.__k===m.__k?u=b6(m,u,r,A):typeof m.type=="function"&&x!==void 0?u=x:y&&(u=y.nextSibling),m.__u&=-7);return n.__e=b,u}function aO(r,e,n,i,a){var s,o,l,u,c,h=n.length,d=h,v=0;for(r.__k=new Array(a),s=0;s<a;s++)(o=e[s])!=null&&typeof o!="boolean"&&typeof o!="function"?(u=s+v,(o=r.__k[s]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?Mc(null,o,null,null,null):P0(o)?Mc(U0,{children:o},null,null,null):o.constructor==null&&o.__b>0?Mc(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=r,o.__b=r.__b+1,l=null,(c=o.__i=sO(o,n,u,d))!=-1&&(d--,(l=n[c])&&(l.__u|=2)),l==null||l.__v==null?(c==-1&&(a>h?v--:a<h&&v++),typeof o.type!="function"&&(o.__u|=4)):c!=u&&(c==u-1?v--:c==u+1?v++:(c>u?v--:v++,o.__u|=4))):r.__k[s]=null;if(d)for(s=0;s<h;s++)(l=n[s])!=null&&(2&l.__u)==0&&(l.__e==i&&(i=zl(l)),E6(l,l));return i}function b6(r,e,n,i){var a,s;if(typeof r.type=="function"){for(a=r.__k,s=0;a&&s<a.length;s++)a[s]&&(a[s].__=r,e=b6(a[s],e,n,i));return e}r.__e!=e&&(i&&(e&&r.type&&!e.parentNode&&(e=zl(r)),n.insertBefore(r.__e,e||null)),e=r.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function sO(r,e,n,i){var a,s,o,l=r.key,u=r.type,c=e[n],h=c!=null&&(2&c.__u)==0;if(c===null&&r.key==null||h&&l==c.key&&u==c.type)return n;if(i>(h?1:0)){for(a=n-1,s=n+1;a>=0||s<e.length;)if((c=e[o=a>=0?a--:s++])!=null&&(2&c.__u)==0&&l==c.key&&u==c.type)return o}return-1}function R4(r,e,n){e[0]=="-"?r.setProperty(e,n??""):r[e]=n==null?"":typeof n!="number"||nO.test(e)?n:n+"px"}function ed(r,e,n,i,a){var s,o;e:if(e=="style")if(typeof n=="string")r.style.cssText=n;else{if(typeof i=="string"&&(r.style.cssText=i=""),i)for(e in i)n&&e in n||R4(r.style,e,"");if(n)for(e in n)i&&n[e]==i[e]||R4(r.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(p6,"$1")),o=e.toLowerCase(),e=o in r||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),r.l||(r.l={}),r.l[e+s]=n,n?i?n.u=i.u:(n.u=G2,r.addEventListener(e,s?jp:Hp,s)):r.removeEventListener(e,s?jp:Hp,s);else{if(a=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in r)try{r[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?r.removeAttribute(e):r.setAttribute(e,e=="popover"&&n==1?"":n))}}function B4(r){return function(e){if(this.l){var n=this.l[e.type+r];if(e.t==null)e.t=G2++;else if(e.t<n.u)return;return n(fr.event?fr.event(e):e)}}}function H2(r,e,n,i,a,s,o,l,u,c){var h,d,v,m,y,b,x,A,C,E,S,T,R,D,B,N,I,P=e.type;if(e.constructor!=null)return null;128&n.__u&&(u=!!(32&n.__u),s=[l=e.__e=n.__e]),(h=fr.__b)&&h(e);e:if(typeof P=="function")try{if(A=e.props,C="prototype"in P&&P.prototype.render,E=(h=P.contextType)&&i[h.__c],S=h?E?E.props.value:h.__:i,n.__c?x=(d=e.__c=n.__c).__=d.__E:(C?e.__c=d=new P(A,S):(e.__c=d=new Rd(A,S),d.constructor=P,d.render=lO),E&&E.sub(d),d.props=A,d.state||(d.state={}),d.context=S,d.__n=i,v=d.__d=!0,d.__h=[],d._sb=[]),C&&d.__s==null&&(d.__s=d.state),C&&P.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=qi({},d.__s)),qi(d.__s,P.getDerivedStateFromProps(A,d.__s))),m=d.props,y=d.state,d.__v=e,v)C&&P.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),C&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(C&&P.getDerivedStateFromProps==null&&A!==m&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(A,S),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(A,d.__s,S)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(d.props=A,d.state=d.__s,d.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(F){F&&(F.__=e)}),T=0;T<d._sb.length;T++)d.__h.push(d._sb[T]);d._sb=[],d.__h.length&&o.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(A,d.__s,S),C&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(m,y,b)})}if(d.context=S,d.props=A,d.__P=r,d.__e=!1,R=fr.__r,D=0,C){for(d.state=d.__s,d.__d=!1,R&&R(e),h=d.render(d.props,d.state,d.context),B=0;B<d._sb.length;B++)d.__h.push(d._sb[B]);d._sb=[]}else do d.__d=!1,R&&R(e),h=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++D<25);d.state=d.__s,d.getChildContext!=null&&(i=qi(qi({},i),d.getChildContext())),C&&!v&&d.getSnapshotBeforeUpdate!=null&&(b=d.getSnapshotBeforeUpdate(m,y)),N=h,h!=null&&h.type===U0&&h.key==null&&(N=C6(h.props.children)),l=x6(r,P0(N)?N:[N],e,n,i,a,s,o,l,u,c),d.base=e.__e,e.__u&=-161,d.__h.length&&o.push(d),x&&(d.__E=d.__=null)}catch(F){if(e.__v=null,u||s!=null)if(F.then){for(e.__u|=u?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;s[s.indexOf(l)]=null,e.__e=l}else{for(I=s.length;I--;)Y2(s[I]);Kp(e)}else e.__e=n.__e,e.__k=n.__k,F.then||Kp(e);fr.__e(F,e,n)}else s==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):l=e.__e=oO(n.__e,e,n,i,a,s,o,u,c);return(h=fr.diffed)&&h(e),128&e.__u?void 0:l}function Kp(r){r&&r.__c&&(r.__c.__e=!0),r&&r.__k&&r.__k.forEach(Kp)}function w6(r,e,n){for(var i=0;i<n.length;i++)j2(n[i],n[++i],n[++i]);fr.__c&&fr.__c(e,r),r.some(function(a){try{r=a.__h,a.__h=[],r.some(function(s){s.call(a)})}catch(s){fr.__e(s,a.__v)}})}function C6(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:P0(r)?r.map(C6):qi({},r)}function oO(r,e,n,i,a,s,o,l,u){var c,h,d,v,m,y,b,x=n.props,A=e.props,C=e.type;if(C=="svg"?a="http://www.w3.org/2000/svg":C=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),s!=null){for(c=0;c<s.length;c++)if((m=s[c])&&"setAttribute"in m==!!C&&(C?m.localName==C:m.nodeType==3)){r=m,s[c]=null;break}}if(r==null){if(C==null)return document.createTextNode(A);r=document.createElementNS(a,C,A.is&&A),l&&(fr.__m&&fr.__m(e,s),l=!1),s=null}if(C==null)x===A||l&&r.data==A||(r.data=A);else{if(s=s&&vf.call(r.childNodes),x=n.props||Qc,!l&&s!=null)for(x={},c=0;c<r.attributes.length;c++)x[(m=r.attributes[c]).name]=m.value;for(c in x)if(m=x[c],c!="children"){if(c=="dangerouslySetInnerHTML")d=m;else if(!(c in A)){if(c=="value"&&"defaultValue"in A||c=="checked"&&"defaultChecked"in A)continue;ed(r,c,null,m,a)}}for(c in A)m=A[c],c=="children"?v=m:c=="dangerouslySetInnerHTML"?h=m:c=="value"?y=m:c=="checked"?b=m:l&&typeof m!="function"||x[c]===m||ed(r,c,m,x[c],a);if(h)l||d&&(h.__html==d.__html||h.__html==r.innerHTML)||(r.innerHTML=h.__html),e.__k=[];else if(d&&(r.innerHTML=""),x6(e.type=="template"?r.content:r,P0(v)?v:[v],e,n,i,C=="foreignObject"?"http://www.w3.org/1999/xhtml":a,s,o,s?s[0]:n.__k&&zl(n,0),l,u),s!=null)for(c=s.length;c--;)Y2(s[c]);l||(c="value",C=="progress"&&y==null?r.removeAttribute("value"):y!=null&&(y!==r[c]||C=="progress"&&!y||C=="option"&&y!=x[c])&&ed(r,c,y,x[c],a),c="checked",b!=null&&b!=r[c]&&ed(r,c,b,x[c],a))}return r}function j2(r,e,n){try{if(typeof r=="function"){var i=typeof r.__u=="function";i&&r.__u(),i&&e==null||(r.__u=r(e))}else r.current=e}catch(a){fr.__e(a,n)}}function E6(r,e,n){var i,a;if(fr.unmount&&fr.unmount(r),(i=r.ref)&&(i.current&&i.current!=r.__e||j2(i,null,e)),(i=r.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){fr.__e(s,e)}i.base=i.__P=null}if(i=r.__k)for(a=0;a<i.length;a++)i[a]&&E6(i[a],e,n||typeof r.type!="function");n||Y2(r.__e),r.__c=r.__=r.__e=void 0}function lO(r,e,n){return this.constructor(r,n)}function uO(r,e,n){var i,a,s,o;e==document&&(e=document.documentElement),fr.__&&fr.__(r,e),a=(i=!1)?null:e.__k,s=[],o=[],H2(e,r=e.__k=iO(U0,null,[r]),a||Qc,Qc,e.namespaceURI,a?null:e.firstChild?vf.call(e.childNodes):null,s,a?a.__e:e.firstChild,i,o),w6(s,r,o)}function S6(r,e,n){var i,a,s,o,l=qi({},r.props);for(s in r.type&&r.type.defaultProps&&(o=r.type.defaultProps),e)s=="key"?i=e[s]:s=="ref"?a=e[s]:l[s]=e[s]===void 0&&o!=null?o[s]:e[s];return arguments.length>2&&(l.children=arguments.length>3?vf.call(arguments,2):n),Mc(r.type,l,i||r.key,a||r.ref,null)}vf=y6.slice,fr={__e:function(r,e,n,i){for(var a,s,o;e=e.__;)if((a=e.__c)&&!a.__)try{if((s=a.constructor)&&s.getDerivedStateFromError!=null&&(a.setState(s.getDerivedStateFromError(r)),o=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(r,i||{}),o=a.__d),o)return a.__E=a}catch(l){r=l}throw r}},d6=0,g6=function(r){return r!=null&&r.constructor==null},Rd.prototype.setState=function(r,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=qi({},this.state),typeof r=="function"&&(r=r(qi({},n),this.props)),r&&qi(n,r),r!=null&&this.__v&&(e&&this._sb.push(e),D4(this))},Rd.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),D4(this))},Rd.prototype.render=U0,to=[],v6=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,m6=function(r,e){return r.__v.__b-e.__v.__b},o0.__r=0,p6=/(PointerCapture)$|Capture$/i,G2=0,Hp=B4(!1),jp=B4(!0);function I4(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function cO(r){if(Array.isArray(r))return r}function fO(r,e,n){return(e=pO(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function hO(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],u=!0,c=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(u=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);u=!0);}catch(h){c=!0,a=h}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function dO(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N4(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),n.push.apply(n,i)}return n}function gO(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?N4(Object(n),!0).forEach(function(i){fO(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):N4(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function vO(r,e){return cO(r)||hO(r,e)||yO(r,e)||dO()}function mO(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function pO(r){var e=mO(r,"string");return typeof e=="symbol"?e:e+""}function l0(r){"@babel/helpers - typeof";return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l0(r)}function yO(r,e){if(r){if(typeof r=="string")return I4(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I4(r,e):void 0}}var Xp=function(e){if(l0(e)!=="object")return e;var n=S6(e);if(n.props){var i;n.props=gO({},n.props),n!=null&&(i=n.props)!==null&&i!==void 0&&i.children&&(n.props.children=Array.isArray(n.props.children)?n.props.children.map(Xp):Xp(n.props.children))}return n},AO=function(e){return g6(S6(e))},xO=function(e,n){delete n.__k,uO(Xp(e),n)};function bO(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",n==="top"&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=r:a.appendChild(document.createTextNode(r))}}var wO=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;bO(wO);var CO=q2({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.style,s=a===void 0?{}:a,o=!!e&&l0(e)==="object"&&!!e.node&&typeof e.node=="function",l=oi(o?e.node():e);l.style("position")==="static"&&l.style("position","relative"),n.tooltipEl=l.append("div").attr("class","float-tooltip-kap"),Object.entries(s).forEach(function(c){var h=vO(c,2),d=h[0],v=h[1];return n.tooltipEl.style(d,v)}),n.tooltipEl.style("left","-10000px").style("display","none");var u="tooltip-".concat(Math.round(Math.random()*1e12));n.mouseInside=!1,l.on("mousemove.".concat(u),function(c){n.mouseInside=!0;var h=_i(c),d=l.node(),v=d.offsetWidth,m=d.offsetHeight,y=[n.offsetX===null||n.offsetX===void 0?"-".concat(h[0]/v*100,"%"):typeof n.offsetX=="number"?"calc(-50% + ".concat(n.offsetX,"px)"):n.offsetX,n.offsetY===null||n.offsetY===void 0?m>130&&m-h[1]<100?"calc(-100% - 6px)":"21px":typeof n.offsetY=="number"?n.offsetY<0?"calc(-100% - ".concat(Math.abs(n.offsetY),"px)"):"".concat(n.offsetY,"px"):n.offsetY];n.tooltipEl.style("left",h[0]+"px").style("top",h[1]+"px").style("transform","translate(".concat(y.join(","),")")),n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseover.".concat(u),function(){n.mouseInside=!0,n.content&&n.tooltipEl.style("display","inline")}),l.on("mouseout.".concat(u),function(){n.mouseInside=!1,n.tooltipEl.style("display","none")})},update:function(e){e.tooltipEl.style("display",e.content&&e.mouseInside?"inline":"none"),e.content?e.content instanceof HTMLElement?(e.tooltipEl.text(""),e.tooltipEl.append(function(){return e.content})):typeof e.content=="string"?e.tooltipEl.html(e.content):AO(e.content)?(e.tooltipEl.text(""),xO(e.content,e.tooltipEl.node())):(e.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",e.content,e.content.toString())):e.tooltipEl.text("")}});function EO(r,e,n){var i,a=1;r==null&&(r=0),e==null&&(e=0),n==null&&(n=0);function s(){var o,l=i.length,u,c=0,h=0,d=0;for(o=0;o<l;++o)u=i[o],c+=u.x||0,h+=u.y||0,d+=u.z||0;for(c=(c/l-r)*a,h=(h/l-e)*a,d=(d/l-n)*a,o=0;o<l;++o)u=i[o],c&&(u.x-=c),h&&(u.y-=h),d&&(u.z-=d)}return s.initialize=function(o){i=o},s.x=function(o){return arguments.length?(r=+o,s):r},s.y=function(o){return arguments.length?(e=+o,s):e},s.z=function(o){return arguments.length?(n=+o,s):n},s.strength=function(o){return arguments.length?(a=+o,s):a},s}function SO(r){const e=+this._x.call(null,r);return T6(this.cover(e),e,r)}function T6(r,e,n){if(isNaN(e))return r;var i,a=r._root,s={data:n},o=r._x0,l=r._x1,u,c,h,d,v;if(!a)return r._root=s,r;for(;a.length;)if((h=e>=(u=(o+l)/2))?o=u:l=u,i=a,!(a=a[d=+h]))return i[d]=s,r;if(c=+r._x.call(null,a.data),e===c)return s.next=a,i?i[d]=s:r._root=s,r;do i=i?i[d]=new Array(2):r._root=new Array(2),(h=e>=(u=(o+l)/2))?o=u:l=u;while((d=+h)==(v=+(c>=u)));return i[v]=a,i[d]=s,r}function TO(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,n=new Float64Array(e);let i=1/0,a=-1/0;for(let s=0,o;s<e;++s)isNaN(o=+this._x.call(null,r[s]))||(n[s]=o,o<i&&(i=o),o>a&&(a=o));if(i>a)return this;this.cover(i).cover(a);for(let s=0;s<e;++s)T6(this,n[s],r[s]);return this}function MO(r){if(isNaN(r=+r))return this;var e=this._x0,n=this._x1;if(isNaN(e))n=(e=Math.floor(r))+1;else{for(var i=n-e||1,a=this._root,s,o;e>r||r>=n;)switch(o=+(r<e),s=new Array(2),s[o]=a,a=s,i*=2,o){case 0:n=e+i;break;case 1:e=n-i;break}this._root&&this._root.length&&(this._root=a)}return this._x0=e,this._x1=n,this}function DO(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function RO(r){return arguments.length?this.cover(+r[0][0]).cover(+r[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function ba(r,e,n){this.node=r,this.x0=e,this.x1=n}function BO(r,e){var n,i=this._x0,a,s,o=this._x1,l=[],u=this._root,c,h;for(u&&l.push(new ba(u,i,o)),e==null?e=1/0:(i=r-e,o=r+e);c=l.pop();)if(!(!(u=c.node)||(a=c.x0)>o||(s=c.x1)<i))if(u.length){var d=(a+s)/2;l.push(new ba(u[1],d,s),new ba(u[0],a,d)),(h=+(r>=d))&&(c=l[l.length-1],l[l.length-1]=l[l.length-1-h],l[l.length-1-h]=c)}else{var v=Math.abs(r-+this._x.call(null,u.data));v<e&&(e=v,i=r-v,o=r+v,n=u.data)}return n}function IO(r){if(isNaN(u=+this._x.call(null,r)))return this;var e,n=this._root,i,a,s,o=this._x0,l=this._x1,u,c,h,d,v;if(!n)return this;if(n.length)for(;;){if((h=u>=(c=(o+l)/2))?o=c:l=c,e=n,!(n=n[d=+h]))return this;if(!n.length)break;e[d+1&1]&&(i=e,v=d)}for(;n.data!==r;)if(a=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,a?(s?a.next=s:delete a.next,this):e?(s?e[d]=s:delete e[d],(n=e[0]||e[1])&&n===(e[1]||e[0])&&!n.length&&(i?i[v]=n:this._root=n),this):(this._root=s,this)}function NO(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function FO(){return this._root}function kO(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function PO(r){var e=[],n,i=this._root,a,s,o;for(i&&e.push(new ba(i,this._x0,this._x1));n=e.pop();)if(!r(i=n.node,s=n.x0,o=n.x1)&&i.length){var l=(s+o)/2;(a=i[1])&&e.push(new ba(a,l,o)),(a=i[0])&&e.push(new ba(a,s,l))}return this}function UO(r){var e=[],n=[],i;for(this._root&&e.push(new ba(this._root,this._x0,this._x1));i=e.pop();){var a=i.node;if(a.length){var s,o=i.x0,l=i.x1,u=(o+l)/2;(s=a[0])&&e.push(new ba(s,o,u)),(s=a[1])&&e.push(new ba(s,u,l))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.x1);return this}function VO(r){return r[0]}function OO(r){return arguments.length?(this._x=r,this):this._x}function M6(r,e){var n=new K2(e??VO,NaN,NaN);return r==null?n:n.addAll(r)}function K2(r,e,n){this._x=r,this._x0=e,this._x1=n,this._root=void 0}function F4(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var Nn=M6.prototype=K2.prototype;Nn.copy=function(){var r=new K2(this._x,this._x0,this._x1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=F4(e),r;for(n=[{source:e,target:r._root=new Array(2)}];e=n.pop();)for(var a=0;a<2;++a)(i=e.source[a])&&(i.length?n.push({source:i,target:e.target[a]=new Array(2)}):e.target[a]=F4(i));return r};Nn.add=SO;Nn.addAll=TO;Nn.cover=MO;Nn.data=DO;Nn.extent=RO;Nn.find=BO;Nn.remove=IO;Nn.removeAll=NO;Nn.root=FO;Nn.size=kO;Nn.visit=PO;Nn.visitAfter=UO;Nn.x=OO;function LO(r){const e=+this._x.call(null,r),n=+this._y.call(null,r);return D6(this.cover(e,n),e,n,r)}function D6(r,e,n,i){if(isNaN(e)||isNaN(n))return r;var a,s=r._root,o={data:i},l=r._x0,u=r._y0,c=r._x1,h=r._y1,d,v,m,y,b,x,A,C;if(!s)return r._root=o,r;for(;s.length;)if((b=e>=(d=(l+c)/2))?l=d:c=d,(x=n>=(v=(u+h)/2))?u=v:h=v,a=s,!(s=s[A=x<<1|b]))return a[A]=o,r;if(m=+r._x.call(null,s.data),y=+r._y.call(null,s.data),e===m&&n===y)return o.next=s,a?a[A]=o:r._root=o,r;do a=a?a[A]=new Array(4):r._root=new Array(4),(b=e>=(d=(l+c)/2))?l=d:c=d,(x=n>=(v=(u+h)/2))?u=v:h=v;while((A=x<<1|b)===(C=(y>=v)<<1|m>=d));return a[C]=s,a[A]=o,r}function _O(r){var e,n,i=r.length,a,s,o=new Array(i),l=new Array(i),u=1/0,c=1/0,h=-1/0,d=-1/0;for(n=0;n<i;++n)isNaN(a=+this._x.call(null,e=r[n]))||isNaN(s=+this._y.call(null,e))||(o[n]=a,l[n]=s,a<u&&(u=a),a>h&&(h=a),s<c&&(c=s),s>d&&(d=s));if(u>h||c>d)return this;for(this.cover(u,c).cover(h,d),n=0;n<i;++n)D6(this,o[n],l[n],r[n]);return this}function zO(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,a=this._x1,s=this._y1;if(isNaN(n))a=(n=Math.floor(r))+1,s=(i=Math.floor(e))+1;else{for(var o=a-n||1,l=this._root,u,c;n>r||r>=a||i>e||e>=s;)switch(c=(e<i)<<1|r<n,u=new Array(4),u[c]=l,l=u,o*=2,c){case 0:a=n+o,s=i+o;break;case 1:n=a-o,s=i+o;break;case 2:a=n+o,i=s-o;break;case 3:n=a-o,i=s-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=i,this._x1=a,this._y1=s,this}function qO(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function GO(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function pn(r,e,n,i,a){this.node=r,this.x0=e,this.y0=n,this.x1=i,this.y1=a}function YO(r,e,n){var i,a=this._x0,s=this._y0,o,l,u,c,h=this._x1,d=this._y1,v=[],m=this._root,y,b;for(m&&v.push(new pn(m,a,s,h,d)),n==null?n=1/0:(a=r-n,s=e-n,h=r+n,d=e+n,n*=n);y=v.pop();)if(!(!(m=y.node)||(o=y.x0)>h||(l=y.y0)>d||(u=y.x1)<a||(c=y.y1)<s))if(m.length){var x=(o+u)/2,A=(l+c)/2;v.push(new pn(m[3],x,A,u,c),new pn(m[2],o,A,x,c),new pn(m[1],x,l,u,A),new pn(m[0],o,l,x,A)),(b=(e>=A)<<1|r>=x)&&(y=v[v.length-1],v[v.length-1]=v[v.length-1-b],v[v.length-1-b]=y)}else{var C=r-+this._x.call(null,m.data),E=e-+this._y.call(null,m.data),S=C*C+E*E;if(S<n){var T=Math.sqrt(n=S);a=r-T,s=e-T,h=r+T,d=e+T,i=m.data}}return i}function HO(r){if(isNaN(h=+this._x.call(null,r))||isNaN(d=+this._y.call(null,r)))return this;var e,n=this._root,i,a,s,o=this._x0,l=this._y0,u=this._x1,c=this._y1,h,d,v,m,y,b,x,A;if(!n)return this;if(n.length)for(;;){if((y=h>=(v=(o+u)/2))?o=v:u=v,(b=d>=(m=(l+c)/2))?l=m:c=m,e=n,!(n=n[x=b<<1|y]))return this;if(!n.length)break;(e[x+1&3]||e[x+2&3]||e[x+3&3])&&(i=e,A=x)}for(;n.data!==r;)if(a=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,a?(s?a.next=s:delete a.next,this):e?(s?e[x]=s:delete e[x],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[A]=n:this._root=n),this):(this._root=s,this)}function jO(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function KO(){return this._root}function XO(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function QO(r){var e=[],n,i=this._root,a,s,o,l,u;for(i&&e.push(new pn(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!r(i=n.node,s=n.x0,o=n.y0,l=n.x1,u=n.y1)&&i.length){var c=(s+l)/2,h=(o+u)/2;(a=i[3])&&e.push(new pn(a,c,h,l,u)),(a=i[2])&&e.push(new pn(a,s,h,c,u)),(a=i[1])&&e.push(new pn(a,c,o,l,h)),(a=i[0])&&e.push(new pn(a,s,o,c,h))}return this}function WO(r){var e=[],n=[],i;for(this._root&&e.push(new pn(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var a=i.node;if(a.length){var s,o=i.x0,l=i.y0,u=i.x1,c=i.y1,h=(o+u)/2,d=(l+c)/2;(s=a[0])&&e.push(new pn(s,o,l,h,d)),(s=a[1])&&e.push(new pn(s,h,l,u,d)),(s=a[2])&&e.push(new pn(s,o,d,h,c)),(s=a[3])&&e.push(new pn(s,h,d,u,c))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.y0,i.x1,i.y1);return this}function ZO(r){return r[0]}function JO(r){return arguments.length?(this._x=r,this):this._x}function $O(r){return r[1]}function eL(r){return arguments.length?(this._y=r,this):this._y}function R6(r,e,n){var i=new X2(e??ZO,n??$O,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function X2(r,e,n,i,a,s){this._x=r,this._y=e,this._x0=n,this._y0=i,this._x1=a,this._y1=s,this._root=void 0}function k4(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var xn=R6.prototype=X2.prototype;xn.copy=function(){var r=new X2(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=k4(e),r;for(n=[{source:e,target:r._root=new Array(4)}];e=n.pop();)for(var a=0;a<4;++a)(i=e.source[a])&&(i.length?n.push({source:i,target:e.target[a]=new Array(4)}):e.target[a]=k4(i));return r};xn.add=LO;xn.addAll=_O;xn.cover=zO;xn.data=qO;xn.extent=GO;xn.find=YO;xn.remove=HO;xn.removeAll=jO;xn.root=KO;xn.size=XO;xn.visit=QO;xn.visitAfter=WO;xn.x=JO;xn.y=eL;function tL(r){const e=+this._x.call(null,r),n=+this._y.call(null,r),i=+this._z.call(null,r);return B6(this.cover(e,n,i),e,n,i,r)}function B6(r,e,n,i,a){if(isNaN(e)||isNaN(n)||isNaN(i))return r;var s,o=r._root,l={data:a},u=r._x0,c=r._y0,h=r._z0,d=r._x1,v=r._y1,m=r._z1,y,b,x,A,C,E,S,T,R,D,B;if(!o)return r._root=l,r;for(;o.length;)if((S=e>=(y=(u+d)/2))?u=y:d=y,(T=n>=(b=(c+v)/2))?c=b:v=b,(R=i>=(x=(h+m)/2))?h=x:m=x,s=o,!(o=o[D=R<<2|T<<1|S]))return s[D]=l,r;if(A=+r._x.call(null,o.data),C=+r._y.call(null,o.data),E=+r._z.call(null,o.data),e===A&&n===C&&i===E)return l.next=o,s?s[D]=l:r._root=l,r;do s=s?s[D]=new Array(8):r._root=new Array(8),(S=e>=(y=(u+d)/2))?u=y:d=y,(T=n>=(b=(c+v)/2))?c=b:v=b,(R=i>=(x=(h+m)/2))?h=x:m=x;while((D=R<<2|T<<1|S)===(B=(E>=x)<<2|(C>=b)<<1|A>=y));return s[B]=o,s[D]=l,r}function rL(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,n=new Float64Array(e),i=new Float64Array(e),a=new Float64Array(e);let s=1/0,o=1/0,l=1/0,u=-1/0,c=-1/0,h=-1/0;for(let d=0,v,m,y,b;d<e;++d)isNaN(m=+this._x.call(null,v=r[d]))||isNaN(y=+this._y.call(null,v))||isNaN(b=+this._z.call(null,v))||(n[d]=m,i[d]=y,a[d]=b,m<s&&(s=m),m>u&&(u=m),y<o&&(o=y),y>c&&(c=y),b<l&&(l=b),b>h&&(h=b));if(s>u||o>c||l>h)return this;this.cover(s,o,l).cover(u,c,h);for(let d=0;d<e;++d)B6(this,n[d],i[d],a[d],r[d]);return this}function nL(r,e,n){if(isNaN(r=+r)||isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,a=this._y0,s=this._z0,o=this._x1,l=this._y1,u=this._z1;if(isNaN(i))o=(i=Math.floor(r))+1,l=(a=Math.floor(e))+1,u=(s=Math.floor(n))+1;else{for(var c=o-i||1,h=this._root,d,v;i>r||r>=o||a>e||e>=l||s>n||n>=u;)switch(v=(n<s)<<2|(e<a)<<1|r<i,d=new Array(8),d[v]=h,h=d,c*=2,v){case 0:o=i+c,l=a+c,u=s+c;break;case 1:i=o-c,l=a+c,u=s+c;break;case 2:o=i+c,a=l-c,u=s+c;break;case 3:i=o-c,a=l-c,u=s+c;break;case 4:o=i+c,l=a+c,s=u-c;break;case 5:i=o-c,l=a+c,s=u-c;break;case 6:o=i+c,a=l-c,s=u-c;break;case 7:i=o-c,a=l-c,s=u-c;break}this._root&&this._root.length&&(this._root=h)}return this._x0=i,this._y0=a,this._z0=s,this._x1=o,this._y1=l,this._z1=u,this}function iL(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function aL(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Xt(r,e,n,i,a,s,o){this.node=r,this.x0=e,this.y0=n,this.z0=i,this.x1=a,this.y1=s,this.z1=o}function sL(r,e,n,i){var a,s=this._x0,o=this._y0,l=this._z0,u,c,h,d,v,m,y=this._x1,b=this._y1,x=this._z1,A=[],C=this._root,E,S;for(C&&A.push(new Xt(C,s,o,l,y,b,x)),i==null?i=1/0:(s=r-i,o=e-i,l=n-i,y=r+i,b=e+i,x=n+i,i*=i);E=A.pop();)if(!(!(C=E.node)||(u=E.x0)>y||(c=E.y0)>b||(h=E.z0)>x||(d=E.x1)<s||(v=E.y1)<o||(m=E.z1)<l))if(C.length){var T=(u+d)/2,R=(c+v)/2,D=(h+m)/2;A.push(new Xt(C[7],T,R,D,d,v,m),new Xt(C[6],u,R,D,T,v,m),new Xt(C[5],T,c,D,d,R,m),new Xt(C[4],u,c,D,T,R,m),new Xt(C[3],T,R,h,d,v,D),new Xt(C[2],u,R,h,T,v,D),new Xt(C[1],T,c,h,d,R,D),new Xt(C[0],u,c,h,T,R,D)),(S=(n>=D)<<2|(e>=R)<<1|r>=T)&&(E=A[A.length-1],A[A.length-1]=A[A.length-1-S],A[A.length-1-S]=E)}else{var B=r-+this._x.call(null,C.data),N=e-+this._y.call(null,C.data),I=n-+this._z.call(null,C.data),P=B*B+N*N+I*I;if(P<i){var F=Math.sqrt(i=P);s=r-F,o=e-F,l=n-F,y=r+F,b=e+F,x=n+F,a=C.data}}return a}const oL=(r,e,n,i,a,s)=>Math.sqrt((r-i)**2+(e-a)**2+(n-s)**2);function lL(r,e,n,i){const a=[],s=r-i,o=e-i,l=n-i,u=r+i,c=e+i,h=n+i;return this.visit((d,v,m,y,b,x,A)=>{if(!d.length)do{const C=d.data;oL(r,e,n,this._x(C),this._y(C),this._z(C))<=i&&a.push(C)}while(d=d.next);return v>u||m>c||y>h||b<s||x<o||A<l}),a}function uL(r){if(isNaN(v=+this._x.call(null,r))||isNaN(m=+this._y.call(null,r))||isNaN(y=+this._z.call(null,r)))return this;var e,n=this._root,i,a,s,o=this._x0,l=this._y0,u=this._z0,c=this._x1,h=this._y1,d=this._z1,v,m,y,b,x,A,C,E,S,T,R;if(!n)return this;if(n.length)for(;;){if((C=v>=(b=(o+c)/2))?o=b:c=b,(E=m>=(x=(l+h)/2))?l=x:h=x,(S=y>=(A=(u+d)/2))?u=A:d=A,e=n,!(n=n[T=S<<2|E<<1|C]))return this;if(!n.length)break;(e[T+1&7]||e[T+2&7]||e[T+3&7]||e[T+4&7]||e[T+5&7]||e[T+6&7]||e[T+7&7])&&(i=e,R=T)}for(;n.data!==r;)if(a=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,a?(s?a.next=s:delete a.next,this):e?(s?e[T]=s:delete e[T],(n=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&n===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[R]=n:this._root=n),this):(this._root=s,this)}function cL(r){for(var e=0,n=r.length;e<n;++e)this.remove(r[e]);return this}function fL(){return this._root}function hL(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function dL(r){var e=[],n,i=this._root,a,s,o,l,u,c,h;for(i&&e.push(new Xt(i,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();)if(!r(i=n.node,s=n.x0,o=n.y0,l=n.z0,u=n.x1,c=n.y1,h=n.z1)&&i.length){var d=(s+u)/2,v=(o+c)/2,m=(l+h)/2;(a=i[7])&&e.push(new Xt(a,d,v,m,u,c,h)),(a=i[6])&&e.push(new Xt(a,s,v,m,d,c,h)),(a=i[5])&&e.push(new Xt(a,d,o,m,u,v,h)),(a=i[4])&&e.push(new Xt(a,s,o,m,d,v,h)),(a=i[3])&&e.push(new Xt(a,d,v,l,u,c,m)),(a=i[2])&&e.push(new Xt(a,s,v,l,d,c,m)),(a=i[1])&&e.push(new Xt(a,d,o,l,u,v,m)),(a=i[0])&&e.push(new Xt(a,s,o,l,d,v,m))}return this}function gL(r){var e=[],n=[],i;for(this._root&&e.push(new Xt(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=e.pop();){var a=i.node;if(a.length){var s,o=i.x0,l=i.y0,u=i.z0,c=i.x1,h=i.y1,d=i.z1,v=(o+c)/2,m=(l+h)/2,y=(u+d)/2;(s=a[0])&&e.push(new Xt(s,o,l,u,v,m,y)),(s=a[1])&&e.push(new Xt(s,v,l,u,c,m,y)),(s=a[2])&&e.push(new Xt(s,o,m,u,v,h,y)),(s=a[3])&&e.push(new Xt(s,v,m,u,c,h,y)),(s=a[4])&&e.push(new Xt(s,o,l,y,v,m,d)),(s=a[5])&&e.push(new Xt(s,v,l,y,c,m,d)),(s=a[6])&&e.push(new Xt(s,o,m,y,v,h,d)),(s=a[7])&&e.push(new Xt(s,v,m,y,c,h,d))}n.push(i)}for(;i=n.pop();)r(i.node,i.x0,i.y0,i.z0,i.x1,i.y1,i.z1);return this}function vL(r){return r[0]}function mL(r){return arguments.length?(this._x=r,this):this._x}function pL(r){return r[1]}function yL(r){return arguments.length?(this._y=r,this):this._y}function AL(r){return r[2]}function xL(r){return arguments.length?(this._z=r,this):this._z}function I6(r,e,n,i){var a=new Q2(e??vL,n??pL,i??AL,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?a:a.addAll(r)}function Q2(r,e,n,i,a,s,o,l,u){this._x=r,this._y=e,this._z=n,this._x0=i,this._y0=a,this._z0=s,this._x1=o,this._y1=l,this._z1=u,this._root=void 0}function P4(r){for(var e={data:r.data},n=e;r=r.next;)n=n.next={data:r.data};return e}var tn=I6.prototype=Q2.prototype;tn.copy=function(){var r=new Q2(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,n,i;if(!e)return r;if(!e.length)return r._root=P4(e),r;for(n=[{source:e,target:r._root=new Array(8)}];e=n.pop();)for(var a=0;a<8;++a)(i=e.source[a])&&(i.length?n.push({source:i,target:e.target[a]=new Array(8)}):e.target[a]=P4(i));return r};tn.add=tL;tn.addAll=rL;tn.cover=nL;tn.data=iL;tn.extent=aL;tn.find=sL;tn.findAllWithinRadius=lL;tn.remove=uL;tn.removeAll=cL;tn.root=fL;tn.size=hL;tn.visit=dL;tn.visitAfter=gL;tn.x=mL;tn.y=yL;tn.z=xL;function xa(r){return function(){return r}}function pa(r){return(r()-.5)*1e-6}function bL(r){return r.index}function U4(r,e){var n=r.get(e);if(!n)throw new Error("node not found: "+e);return n}function wL(r){var e=bL,n=v,i,a=xa(30),s,o,l,u,c,h,d=1;r==null&&(r=[]);function v(A){return 1/Math.min(u[A.source.index],u[A.target.index])}function m(A){for(var C=0,E=r.length;C<d;++C)for(var S=0,T,R,D,B=0,N=0,I=0,P,F;S<E;++S)T=r[S],R=T.source,D=T.target,B=D.x+D.vx-R.x-R.vx||pa(h),l>1&&(N=D.y+D.vy-R.y-R.vy||pa(h)),l>2&&(I=D.z+D.vz-R.z-R.vz||pa(h)),P=Math.sqrt(B*B+N*N+I*I),P=(P-s[S])/P*A*i[S],B*=P,N*=P,I*=P,D.vx-=B*(F=c[S]),l>1&&(D.vy-=N*F),l>2&&(D.vz-=I*F),R.vx+=B*(F=1-F),l>1&&(R.vy+=N*F),l>2&&(R.vz+=I*F)}function y(){if(o){var A,C=o.length,E=r.length,S=new Map(o.map((R,D)=>[e(R,D,o),R])),T;for(A=0,u=new Array(C);A<E;++A)T=r[A],T.index=A,typeof T.source!="object"&&(T.source=U4(S,T.source)),typeof T.target!="object"&&(T.target=U4(S,T.target)),u[T.source.index]=(u[T.source.index]||0)+1,u[T.target.index]=(u[T.target.index]||0)+1;for(A=0,c=new Array(E);A<E;++A)T=r[A],c[A]=u[T.source.index]/(u[T.source.index]+u[T.target.index]);i=new Array(E),b(),s=new Array(E),x()}}function b(){if(o)for(var A=0,C=r.length;A<C;++A)i[A]=+n(r[A],A,r)}function x(){if(o)for(var A=0,C=r.length;A<C;++A)s[A]=+a(r[A],A,r)}return m.initialize=function(A,...C){o=A,h=C.find(E=>typeof E=="function")||Math.random,l=C.find(E=>[1,2,3].includes(E))||2,y()},m.links=function(A){return arguments.length?(r=A,y(),m):r},m.id=function(A){return arguments.length?(e=A,m):e},m.iterations=function(A){return arguments.length?(d=+A,m):d},m.strength=function(A){return arguments.length?(n=typeof A=="function"?A:xa(+A),b(),m):n},m.distance=function(A){return arguments.length?(a=typeof A=="function"?A:xa(+A),x(),m):a},m}const CL=1664525,EL=1013904223,V4=4294967296;function SL(){let r=1;return()=>(r=(CL*r+EL)%V4)/V4}var O4=3;function _m(r){return r.x}function L4(r){return r.y}function TL(r){return r.z}var ML=10,DL=Math.PI*(3-Math.sqrt(5)),RL=Math.PI*20/(9+Math.sqrt(221));function BL(r,e){e=e||2;var n=Math.min(O4,Math.max(1,Math.round(e))),i,a=1,s=.001,o=1-Math.pow(s,1/300),l=0,u=.6,c=new Map,h=O2(m),d=df("tick","end"),v=SL();r==null&&(r=[]);function m(){y(),d.call("tick",i),a<s&&(h.stop(),d.call("end",i))}function y(A){var C,E=r.length,S;A===void 0&&(A=1);for(var T=0;T<A;++T)for(a+=(l-a)*o,c.forEach(function(R){R(a)}),C=0;C<E;++C)S=r[C],S.fx==null?S.x+=S.vx*=u:(S.x=S.fx,S.vx=0),n>1&&(S.fy==null?S.y+=S.vy*=u:(S.y=S.fy,S.vy=0)),n>2&&(S.fz==null?S.z+=S.vz*=u:(S.z=S.fz,S.vz=0));return i}function b(){for(var A=0,C=r.length,E;A<C;++A){if(E=r[A],E.index=A,E.fx!=null&&(E.x=E.fx),E.fy!=null&&(E.y=E.fy),E.fz!=null&&(E.z=E.fz),isNaN(E.x)||n>1&&isNaN(E.y)||n>2&&isNaN(E.z)){var S=ML*(n>2?Math.cbrt(.5+A):n>1?Math.sqrt(.5+A):A),T=A*DL,R=A*RL;n===1?E.x=S:n===2?(E.x=S*Math.cos(T),E.y=S*Math.sin(T)):(E.x=S*Math.sin(T)*Math.cos(R),E.y=S*Math.cos(T),E.z=S*Math.sin(T)*Math.sin(R))}(isNaN(E.vx)||n>1&&isNaN(E.vy)||n>2&&isNaN(E.vz))&&(E.vx=0,n>1&&(E.vy=0),n>2&&(E.vz=0))}}function x(A){return A.initialize&&A.initialize(r,v,n),A}return b(),i={tick:y,restart:function(){return h.restart(m),i},stop:function(){return h.stop(),i},numDimensions:function(A){return arguments.length?(n=Math.min(O4,Math.max(1,Math.round(A))),c.forEach(x),i):n},nodes:function(A){return arguments.length?(r=A,b(),c.forEach(x),i):r},alpha:function(A){return arguments.length?(a=+A,i):a},alphaMin:function(A){return arguments.length?(s=+A,i):s},alphaDecay:function(A){return arguments.length?(o=+A,i):+o},alphaTarget:function(A){return arguments.length?(l=+A,i):l},velocityDecay:function(A){return arguments.length?(u=1-A,i):1-u},randomSource:function(A){return arguments.length?(v=A,c.forEach(x),i):v},force:function(A,C){return arguments.length>1?(C==null?c.delete(A):c.set(A,x(C)),i):c.get(A)},find:function(){var A=Array.prototype.slice.call(arguments),C=A.shift()||0,E=(n>1?A.shift():null)||0,S=(n>2?A.shift():null)||0,T=A.shift()||1/0,R=0,D=r.length,B,N,I,P,F,O;for(T*=T,R=0;R<D;++R)F=r[R],B=C-F.x,N=E-(F.y||0),I=S-(F.z||0),P=B*B+N*N+I*I,P<T&&(O=F,T=P);return O},on:function(A,C){return arguments.length>1?(d.on(A,C),i):d.on(A)}}}function IL(){var r,e,n,i,a,s=xa(-30),o,l=1,u=1/0,c=.81;function h(y){var b,x=r.length,A=(e===1?M6(r,_m):e===2?R6(r,_m,L4):e===3?I6(r,_m,L4,TL):null).visitAfter(v);for(a=y,b=0;b<x;++b)n=r[b],A.visit(m)}function d(){if(r){var y,b=r.length,x;for(o=new Array(b),y=0;y<b;++y)x=r[y],o[x.index]=+s(x,y,r)}}function v(y){var b=0,x,A,C=0,E,S,T,R,D=y.length;if(D){for(E=S=T=R=0;R<D;++R)(x=y[R])&&(A=Math.abs(x.value))&&(b+=x.value,C+=A,E+=A*(x.x||0),S+=A*(x.y||0),T+=A*(x.z||0));b*=Math.sqrt(4/D),y.x=E/C,e>1&&(y.y=S/C),e>2&&(y.z=T/C)}else{x=y,x.x=x.data.x,e>1&&(x.y=x.data.y),e>2&&(x.z=x.data.z);do b+=o[x.data.index];while(x=x.next)}y.value=b}function m(y,b,x,A,C){if(!y.value)return!0;var E=[x,A,C][e-1],S=y.x-n.x,T=e>1?y.y-n.y:0,R=e>2?y.z-n.z:0,D=E-b,B=S*S+T*T+R*R;if(D*D/c<B)return B<u&&(S===0&&(S=pa(i),B+=S*S),e>1&&T===0&&(T=pa(i),B+=T*T),e>2&&R===0&&(R=pa(i),B+=R*R),B<l&&(B=Math.sqrt(l*B)),n.vx+=S*y.value*a/B,e>1&&(n.vy+=T*y.value*a/B),e>2&&(n.vz+=R*y.value*a/B)),!0;if(y.length||B>=u)return;(y.data!==n||y.next)&&(S===0&&(S=pa(i),B+=S*S),e>1&&T===0&&(T=pa(i),B+=T*T),e>2&&R===0&&(R=pa(i),B+=R*R),B<l&&(B=Math.sqrt(l*B)));do y.data!==n&&(D=o[y.data.index]*a/B,n.vx+=S*D,e>1&&(n.vy+=T*D),e>2&&(n.vz+=R*D));while(y=y.next)}return h.initialize=function(y,...b){r=y,i=b.find(x=>typeof x=="function")||Math.random,e=b.find(x=>[1,2,3].includes(x))||2,d()},h.strength=function(y){return arguments.length?(s=typeof y=="function"?y:xa(+y),d(),h):s},h.distanceMin=function(y){return arguments.length?(l=y*y,h):Math.sqrt(l)},h.distanceMax=function(y){return arguments.length?(u=y*y,h):Math.sqrt(u)},h.theta=function(y){return arguments.length?(c=y*y,h):Math.sqrt(c)},h}function NL(r,e,n,i){var a,s,o=xa(.1),l,u;typeof r!="function"&&(r=xa(+r)),e==null&&(e=0),n==null&&(n=0),i==null&&(i=0);function c(d){for(var v=0,m=a.length;v<m;++v){var y=a[v],b=y.x-e||1e-6,x=(y.y||0)-n||1e-6,A=(y.z||0)-i||1e-6,C=Math.sqrt(b*b+x*x+A*A),E=(u[v]-C)*l[v]*d/C;y.vx+=b*E,s>1&&(y.vy+=x*E),s>2&&(y.vz+=A*E)}}function h(){if(a){var d,v=a.length;for(l=new Array(v),u=new Array(v),d=0;d<v;++d)u[d]=+r(a[d],d,a),l[d]=isNaN(u[d])?0:+o(a[d],d,a)}}return c.initialize=function(d,...v){a=d,s=v.find(m=>[1,2,3].includes(m))||2,h()},c.strength=function(d){return arguments.length?(o=typeof d=="function"?d:xa(+d),h(),c):o},c.radius=function(d){return arguments.length?(r=typeof d=="function"?d:xa(+d),h(),c):r},c.x=function(d){return arguments.length?(e=+d,c):e},c.y=function(d){return arguments.length?(n=+d,c):n},c.z=function(d){return arguments.length?(i=+d,c):i},c}const{abs:tc,cos:va,sin:pl,acos:FL,atan2:rc,sqrt:es,pow:ai}=Math;function nc(r){return r<0?-ai(-r,1/3):ai(r,1/3)}const N6=Math.PI,td=2*N6,ts=N6/2,kL=1e-6,zm=Number.MAX_SAFE_INTEGER||9007199254740991,qm=Number.MIN_SAFE_INTEGER||-9007199254740991,PL={x:0,y:0,z:0},De={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,e){const n=e(r);let i=n.x*n.x+n.y*n.y;return typeof n.z<"u"&&(i+=n.z*n.z),es(i)},compute:function(r,e,n){if(r===0)return e[0].t=0,e[0];const i=e.length-1;if(r===1)return e[i].t=1,e[i];const a=1-r;let s=e;if(i===0)return e[0].t=r,e[0];if(i===1){const l={x:a*s[0].x+r*s[1].x,y:a*s[0].y+r*s[1].y,t:r};return n&&(l.z=a*s[0].z+r*s[1].z),l}if(i<4){let l=a*a,u=r*r,c,h,d,v=0;i===2?(s=[s[0],s[1],s[2],PL],c=l,h=a*r*2,d=u):i===3&&(c=l*a,h=l*r*3,d=a*u*3,v=r*u);const m={x:c*s[0].x+h*s[1].x+d*s[2].x+v*s[3].x,y:c*s[0].y+h*s[1].y+d*s[2].y+v*s[3].y,t:r};return n&&(m.z=c*s[0].z+h*s[1].z+d*s[2].z+v*s[3].z),m}const o=JSON.parse(JSON.stringify(e));for(;o.length>1;){for(let l=0;l<o.length-1;l++)o[l]={x:o[l].x+(o[l+1].x-o[l].x)*r,y:o[l].y+(o[l+1].y-o[l].y)*r},typeof o[l].z<"u"&&(o[l].z=o[l].z+(o[l+1].z-o[l].z)*r);o.splice(o.length-1,1)}return o[0].t=r,o[0]},computeWithRatios:function(r,e,n,i){const a=1-r,s=n,o=e;let l=s[0],u=s[1],c=s[2],h=s[3],d;if(l*=a,u*=r,o.length===2)return d=l+u,{x:(l*o[0].x+u*o[1].x)/d,y:(l*o[0].y+u*o[1].y)/d,z:i?(l*o[0].z+u*o[1].z)/d:!1,t:r};if(l*=a,u*=2*a,c*=r*r,o.length===3)return d=l+u+c,{x:(l*o[0].x+u*o[1].x+c*o[2].x)/d,y:(l*o[0].y+u*o[1].y+c*o[2].y)/d,z:i?(l*o[0].z+u*o[1].z+c*o[2].z)/d:!1,t:r};if(l*=a,u*=1.5*a,c*=3*a,h*=r*r*r,o.length===4)return d=l+u+c+h,{x:(l*o[0].x+u*o[1].x+c*o[2].x+h*o[3].x)/d,y:(l*o[0].y+u*o[1].y+c*o[2].y+h*o[3].y)/d,z:i?(l*o[0].z+u*o[1].z+c*o[2].z+h*o[3].z)/d:!1,t:r}},derive:function(r,e){const n=[];for(let i=r,a=i.length,s=a-1;a>1;a--,s--){const o=[];for(let l=0,u;l<s;l++)u={x:s*(i[l+1].x-i[l].x),y:s*(i[l+1].y-i[l].y)},e&&(u.z=s*(i[l+1].z-i[l].z)),o.push(u);n.push(o),i=o}return n},between:function(r,e,n){return e<=r&&r<=n||De.approximately(r,e)||De.approximately(r,n)},approximately:function(r,e,n){return tc(r-e)<=(n||kL)},length:function(r){const n=De.Tvalues.length;let i=0;for(let a=0,s;a<n;a++)s=.5*De.Tvalues[a]+.5,i+=De.Cvalues[a]*De.arcfn(s,r);return .5*i},map:function(r,e,n,i,a){const s=n-e,o=a-i,l=r-e,u=l/s;return i+o*u},lerp:function(r,e,n){const i={x:e.x+r*(n.x-e.x),y:e.y+r*(n.y-e.y)};return e.z!==void 0&&n.z!==void 0&&(i.z=e.z+r*(n.z-e.z)),i},pointToString:function(r){let e=r.x+"/"+r.y;return typeof r.z<"u"&&(e+="/"+r.z),e},pointsToString:function(r){return"["+r.map(De.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,e,n){const i=e.x-r.x,a=e.y-r.y,s=n.x-r.x,o=n.y-r.y,l=i*o-a*s,u=i*s+a*o;return rc(l,u)},round:function(r,e){const n=""+r,i=n.indexOf(".");return parseFloat(n.substring(0,i+1+e))},dist:function(r,e){const n=r.x-e.x,i=r.y-e.y;return es(n*n+i*i)},closest:function(r,e){let n=ai(2,63),i,a;return r.forEach(function(s,o){a=De.dist(e,s),a<n&&(n=a,i=o)}),{mdist:n,mpos:i}},abcratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=ai(r,e)+ai(1-r,e),i=n-1;return tc(i/n)},projectionratio:function(r,e){if(e!==2&&e!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const n=ai(1-r,e),i=ai(r,e)+n;return n/i},lli8:function(r,e,n,i,a,s,o,l){const u=(r*i-e*n)*(a-o)-(r-n)*(a*l-s*o),c=(r*i-e*n)*(s-l)-(e-i)*(a*l-s*o),h=(r-n)*(s-l)-(e-i)*(a-o);return h==0?!1:{x:u/h,y:c/h}},lli4:function(r,e,n,i){const a=r.x,s=r.y,o=e.x,l=e.y,u=n.x,c=n.y,h=i.x,d=i.y;return De.lli8(a,s,o,l,u,c,h,d)},lli:function(r,e){return De.lli4(r,r.c,e,e.c)},makeline:function(r,e){return new rr(r.x,r.y,(r.x+e.x)/2,(r.y+e.y)/2,e.x,e.y)},findbbox:function(r){let e=zm,n=zm,i=qm,a=qm;return r.forEach(function(s){const o=s.bbox();e>o.x.min&&(e=o.x.min),n>o.y.min&&(n=o.y.min),i<o.x.max&&(i=o.x.max),a<o.y.max&&(a=o.y.max)}),{x:{min:e,mid:(e+i)/2,max:i,size:i-e},y:{min:n,mid:(n+a)/2,max:a,size:a-n}}},shapeintersections:function(r,e,n,i,a){if(!De.bboxoverlap(e,i))return[];const s=[],o=[r.startcap,r.forward,r.back,r.endcap],l=[n.startcap,n.forward,n.back,n.endcap];return o.forEach(function(u){u.virtual||l.forEach(function(c){if(c.virtual)return;const h=u.intersects(c,a);h.length>0&&(h.c1=u,h.c2=c,h.s1=r,h.s2=n,s.push(h))})}),s},makeshape:function(r,e,n){const i=e.points.length,a=r.points.length,s=De.makeline(e.points[i-1],r.points[0]),o=De.makeline(r.points[a-1],e.points[0]),l={startcap:s,forward:r,back:e,endcap:o,bbox:De.findbbox([s,r,e,o])};return l.intersections=function(u){return De.shapeintersections(l,l.bbox,u,u.bbox,n)},l},getminmax:function(r,e,n){if(!n)return{min:0,max:0};let i=zm,a=qm,s,o;n.indexOf(0)===-1&&(n=[0].concat(n)),n.indexOf(1)===-1&&n.push(1);for(let l=0,u=n.length;l<u;l++)s=n[l],o=r.get(s),o[e]<i&&(i=o[e]),o[e]>a&&(a=o[e]);return{min:i,mid:(i+a)/2,max:a,size:a-i}},align:function(r,e){const n=e.p1.x,i=e.p1.y,a=-rc(e.p2.y-i,e.p2.x-n),s=function(o){return{x:(o.x-n)*va(a)-(o.y-i)*pl(a),y:(o.x-n)*pl(a)+(o.y-i)*va(a)}};return r.map(s)},roots:function(r,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=r.length-1,i=De.align(r,e),a=function(D){return 0<=D&&D<=1};if(n===2){const D=i[0].y,B=i[1].y,N=i[2].y,I=D-2*B+N;if(I!==0){const P=-es(B*B-D*N),F=-D+B,O=-(P+F)/I,U=-(-P+F)/I;return[O,U].filter(a)}else if(B!==N&&I===0)return[(2*B-N)/(2*B-2*N)].filter(a);return[]}const s=i[0].y,o=i[1].y,l=i[2].y,u=i[3].y;let c=-s+3*o-3*l+u,h=3*s-6*o+3*l,d=-3*s+3*o,v=s;if(De.approximately(c,0)){if(De.approximately(h,0))return De.approximately(d,0)?[]:[-v/d].filter(a);const D=es(d*d-4*h*v),B=2*h;return[(D-d)/B,(-d-D)/B].filter(a)}h/=c,d/=c,v/=c;const m=(3*d-h*h)/3,y=m/3,b=(2*h*h*h-9*h*d+27*v)/27,x=b/2,A=x*x+y*y*y;let C,E,S,T,R;if(A<0){const D=-m/3,B=D*D*D,N=es(B),I=-b/(2*N),P=I<-1?-1:I>1?1:I,F=FL(P),O=nc(N),U=2*O;return S=U*va(F/3)-h/3,T=U*va((F+td)/3)-h/3,R=U*va((F+2*td)/3)-h/3,[S,T,R].filter(a)}else{if(A===0)return C=x<0?nc(-x):-nc(x),S=2*C-h/3,T=-C-h/3,[S,T].filter(a);{const D=es(A);return C=nc(-x+D),E=nc(x+D),[C-E-h/3].filter(a)}}},droots:function(r){if(r.length===3){const e=r[0],n=r[1],i=r[2],a=e-2*n+i;if(a!==0){const s=-es(n*n-e*i),o=-e+n,l=-(s+o)/a,u=-(-s+o)/a;return[l,u]}else if(n!==i&&a===0)return[(2*n-i)/(2*(n-i))];return[]}if(r.length===2){const e=r[0],n=r[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(r,e,n,i,a){let s,o,l,u,c=0,h=0;const d=De.compute(r,e),v=De.compute(r,n),m=d.x*d.x+d.y*d.y;if(i?(s=es(ai(d.y*v.z-v.y*d.z,2)+ai(d.z*v.x-v.z*d.x,2)+ai(d.x*v.y-v.x*d.y,2)),o=ai(m+d.z*d.z,3/2)):(s=d.x*v.y-d.y*v.x,o=ai(m,3/2)),s===0||o===0)return{k:0,r:0};if(c=s/o,h=o/s,!a){const y=De.curvature(r-.001,e,n,i,!0).k,b=De.curvature(r+.001,e,n,i,!0).k;u=(b-c+(c-y))/2,l=(tc(b-c)+tc(c-y))/2}return{k:c,r:h,dk:u,adk:l}},inflections:function(r){if(r.length<4)return[];const e=De.align(r,{p1:r[0],p2:r.slice(-1)[0]}),n=e[2].x*e[1].y,i=e[3].x*e[1].y,a=e[1].x*e[2].y,s=e[3].x*e[2].y,o=18*(-3*n+2*i+3*a-s),l=18*(3*n-i-3*a),u=18*(a-n);if(De.approximately(o,0)){if(!De.approximately(l,0)){let v=-u/l;if(0<=v&&v<=1)return[v]}return[]}const c=2*o;if(De.approximately(c,0))return[];const h=l*l-4*o*u;if(h<0)return[];const d=Math.sqrt(h);return[(d-l)/c,-(l+d)/c].filter(function(v){return 0<=v&&v<=1})},bboxoverlap:function(r,e){const n=["x","y"],i=n.length;for(let a=0,s,o,l,u;a<i;a++)if(s=n[a],o=r[s].mid,l=e[s].mid,u=(r[s].size+e[s].size)/2,tc(o-l)>=u)return!1;return!0},expandbox:function(r,e){e.x.min<r.x.min&&(r.x.min=e.x.min),e.y.min<r.y.min&&(r.y.min=e.y.min),e.z&&e.z.min<r.z.min&&(r.z.min=e.z.min),e.x.max>r.x.max&&(r.x.max=e.x.max),e.y.max>r.y.max&&(r.y.max=e.y.max),e.z&&e.z.max>r.z.max&&(r.z.max=e.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,e,n){const i=r.bbox(),a=e.bbox(),s=1e5,o=n||.5;if(i.x.size+i.y.size<o&&a.x.size+a.y.size<o)return[(s*(r._t1+r._t2)/2|0)/s+"/"+(s*(e._t1+e._t2)/2|0)/s];let l=r.split(.5),u=e.split(.5),c=[{left:l.left,right:u.left},{left:l.left,right:u.right},{left:l.right,right:u.right},{left:l.right,right:u.left}];c=c.filter(function(d){return De.bboxoverlap(d.left.bbox(),d.right.bbox())});let h=[];return c.length===0||(c.forEach(function(d){h=h.concat(De.pairiteration(d.left,d.right,o))}),h=h.filter(function(d,v){return h.indexOf(d)===v})),h},getccenter:function(r,e,n){const i=e.x-r.x,a=e.y-r.y,s=n.x-e.x,o=n.y-e.y,l=i*va(ts)-a*pl(ts),u=i*pl(ts)+a*va(ts),c=s*va(ts)-o*pl(ts),h=s*pl(ts)+o*va(ts),d=(r.x+e.x)/2,v=(r.y+e.y)/2,m=(e.x+n.x)/2,y=(e.y+n.y)/2,b=d+l,x=v+u,A=m+c,C=y+h,E=De.lli8(d,v,b,x,m,y,A,C),S=De.dist(E,r);let T=rc(r.y-E.y,r.x-E.x),R=rc(e.y-E.y,e.x-E.x),D=rc(n.y-E.y,n.x-E.x),B;return T<D?((T>R||R>D)&&(T+=td),T>D&&(B=D,D=T,T=B)):D<R&&R<T?(B=D,D=T,T=B):D+=td,E.s=T,E.e=D,E.r=S,E},numberSort:function(r,e){return r-e}};class Dc{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return De.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,n){return e+n})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var n=e[0].bbox(),i=1;i<e.length;i++)De.expandbox(n,e[i].bbox());return n}offset(e){const n=[];return this.curves.forEach(function(i){n.push(...i.offset(e))}),new Dc(n)}}const{abs:ic,min:_4,max:z4,cos:UL,sin:VL,acos:OL,sqrt:ac}=Math,LL=Math.PI;class rr{constructor(e){let n=e&&e.forEach?e:Array.from(arguments).slice(),i=!1;if(typeof n[0]=="object"){i=n.length;const m=[];n.forEach(function(y){["x","y","z"].forEach(function(b){typeof y[b]<"u"&&m.push(y[b])})}),n=m}let a=!1;const s=n.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");a=!0}}else if(s!==6&&s!==8&&s!==9&&s!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!a&&(s===9||s===12)||e&&e[0]&&typeof e[0].z<"u",l=this.points=[];for(let m=0,y=o?3:2;m<s;m+=y){var u={x:n[m],y:n[m+1]};o&&(u.z=n[m+2]),l.push(u)}const c=this.order=l.length-1,h=this.dims=["x","y"];o&&h.push("z"),this.dimlen=h.length;const d=De.align(l,{p1:l[0],p2:l[c]}),v=De.dist(l[0],l[c]);this._linear=d.reduce((m,y)=>m+ic(y.y),0)<v/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,n,i,a){if(typeof a>"u"&&(a=.5),a===0)return new rr(n,n,i);if(a===1)return new rr(e,n,n);const s=rr.getABC(2,e,n,i,a);return new rr(e,s.A,i)}static cubicFromPoints(e,n,i,a,s){typeof a>"u"&&(a=.5);const o=rr.getABC(3,e,n,i,a);typeof s>"u"&&(s=De.dist(n,o.C));const l=s*(1-a)/a,u=De.dist(e,i),c=(i.x-e.x)/u,h=(i.y-e.y)/u,d=s*c,v=s*h,m=l*c,y=l*h,b={x:n.x-d,y:n.y-v},x={x:n.x+m,y:n.y+y},A=o.A,C={x:A.x+(b.x-A.x)/(1-a),y:A.y+(b.y-A.y)/(1-a)},E={x:A.x+(x.x-A.x)/a,y:A.y+(x.y-A.y)/a},S={x:e.x+(C.x-e.x)/a,y:e.y+(C.y-e.y)/a},T={x:i.x+(E.x-i.x)/(1-a),y:i.y+(E.y-i.y)/(1-a)};return new rr(e,S,T,i)}static getUtils(){return De}getUtils(){return rr.getUtils()}static get PolyBezier(){return Dc}valueOf(){return this.toString()}toString(){return De.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,n=e[0].x,i=e[0].y,a=["M",n,i,this.order===2?"Q":"C"];for(let s=1,o=e.length;s<o;s++)a.push(e[s].x),a.push(e[s].y);return a.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,n){return""+n+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=De.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,n=De.angle(e[0],e[this.order],e[1]);this.clockwise=n>0}length(){return De.length(this.derivative.bind(this))}static getABC(e=2,n,i,a,s=.5){const o=De.projectionratio(s,e),l=1-o,u={x:o*n.x+l*a.x,y:o*n.y+l*a.y},c=De.abcratio(s,e);return{A:{x:i.x+(i.x-u.x)/c,y:i.y+(i.y-u.y)/c},B:i,C:u,S:n,E:a}}getABC(e,n){n=n||this.get(e);let i=this.points[0],a=this.points[this.order];return rr.getABC(this.order,i,n,a,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let n=0,i,a;n<e;n++)a=n/(e-1),i=this.compute(a),i.t=a,this._lut.push(i);return this._lut}on(e,n){n=n||5;const i=this.getLUT(),a=[];for(let s=0,o,l=0;s<i.length;s++)o=i[s],De.dist(o,e)<n&&(a.push(o),l+=s/i.length);return a.length?t/=a.length:!1}project(e){const n=this.getLUT(),i=n.length-1,a=De.closest(n,e),s=a.mpos,o=(s-1)/i,l=(s+1)/i,u=.1/i;let c=a.mdist,h=o,d=h,v;c+=1;for(let m;h<l+u;h+=u)v=this.compute(h),m=De.dist(e,v),m<c&&(c=m,d=h);return d=d<0?0:d>1?1:d,v=this.compute(d),v.t=d,v.d=c,v}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?De.computeWithRatios(e,this.points,this.ratios,this._3d):De.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,n=[e[0]],i=e.length;for(let a=1,s,o;a<i;a++)s=e[a],o=e[a-1],n[a]={x:(i-a)/i*s.x+a/i*o.x,y:(i-a)/i*s.y+a/i*o.y};return n[i]=e[i-1],new rr(n)}derivative(e){return De.compute(e,this.dpoints[0],this._3d)}dderivative(e){return De.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new rr(De.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return De.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return De.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const n=this.derivative(e),i=ac(n.x*n.x+n.y*n.y);return{t:e,x:-n.y/i,y:n.x/i}}__normal3(e){const n=this.derivative(e),i=this.derivative(e+.01),a=ac(n.x*n.x+n.y*n.y+n.z*n.z),s=ac(i.x*i.x+i.y*i.y+i.z*i.z);n.x/=a,n.y/=a,n.z/=a,i.x/=s,i.y/=s,i.z/=s;const o={x:i.y*n.z-i.z*n.y,y:i.z*n.x-i.x*n.z,z:i.x*n.y-i.y*n.x},l=ac(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=l,o.y/=l,o.z/=l;const u=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:e,x:u[0]*n.x+u[1]*n.y+u[2]*n.z,y:u[3]*n.x+u[4]*n.y+u[5]*n.z,z:u[6]*n.x+u[7]*n.y+u[8]*n.z}}hull(e){let n=this.points,i=[],a=[],s=0;for(a[s++]=n[0],a[s++]=n[1],a[s++]=n[2],this.order===3&&(a[s++]=n[3]);n.length>1;){i=[];for(let o=0,l,u=n.length-1;o<u;o++)l=De.lerp(e,n[o],n[o+1]),a[s++]=l,i.push(l);n=i}return a}split(e,n){if(e===0&&n)return this.split(n).left;if(n===1)return this.split(e).right;const i=this.hull(e),a={left:this.order===2?new rr([i[0],i[3],i[5]]):new rr([i[0],i[4],i[7],i[9]]),right:this.order===2?new rr([i[5],i[4],i[2]]):new rr([i[9],i[8],i[6],i[3]]),span:i};return a.left._t1=De.map(0,0,1,this._t1,this._t2),a.left._t2=De.map(e,0,1,this._t1,this._t2),a.right._t1=De.map(e,0,1,this._t1,this._t2),a.right._t2=De.map(1,0,1,this._t1,this._t2),n?(n=De.map(n,e,1,0,1),a.right.split(n).left):a}extrema(){const e={};let n=[];return this.dims.forEach((function(i){let a=function(o){return o[i]},s=this.dpoints[0].map(a);e[i]=De.droots(s),this.order===3&&(s=this.dpoints[1].map(a),e[i]=e[i].concat(De.droots(s))),e[i]=e[i].filter(function(o){return o>=0&&o<=1}),n=n.concat(e[i].sort(De.numberSort))}).bind(this)),e.values=n.sort(De.numberSort).filter(function(i,a){return n.indexOf(i)===a}),e}bbox(){const e=this.extrema(),n={};return this.dims.forEach((function(i){n[i]=De.getminmax(this,i,e[i])}).bind(this)),n}overlaps(e){const n=this.bbox(),i=e.bbox();return De.bboxoverlap(n,i)}offset(e,n){if(typeof n<"u"){const i=this.get(e),a=this.normal(e),s={c:i,n:a,x:i.x+a.x*n,y:i.y+a.y*n};return this._3d&&(s.z=i.z+a.z*n),s}if(this._linear){const i=this.normal(0),a=this.points.map(function(s){const o={x:s.x+e*i.x,y:s.y+e*i.y};return s.z&&i.z&&(o.z=s.z+e*i.z),o});return[new rr(a)]}return this.reduce().map(function(i){return i._linear?i.offset(e)[0]:i.scale(e)})}simple(){if(this.order===3){const a=De.angle(this.points[0],this.points[3],this.points[1]),s=De.angle(this.points[0],this.points[3],this.points[2]);if(a>0&&s<0||a<0&&s>0)return!1}const e=this.normal(0),n=this.normal(1);let i=e.x*n.x+e.y*n.y;return this._3d&&(i+=e.z*n.z),ic(OL(i))<LL/3}reduce(){let e,n=0,i=0,a=.01,s,o=[],l=[],u=this.extrema().values;for(u.indexOf(0)===-1&&(u=[0].concat(u)),u.indexOf(1)===-1&&u.push(1),n=u[0],e=1;e<u.length;e++)i=u[e],s=this.split(n,i),s._t1=n,s._t2=i,o.push(s),n=i;return o.forEach(function(c){for(n=0,i=0;i<=1;)for(i=n+a;i<=1+a;i+=a)if(s=c.split(n,i),!s.simple()){if(i-=a,ic(n-i)<a)return[];s=c.split(n,i),s._t1=De.map(n,0,1,c._t1,c._t2),s._t2=De.map(i,0,1,c._t1,c._t2),l.push(s),n=i;break}n<1&&(s=c.split(n,1),s._t1=De.map(n,0,1,c._t1,c._t2),s._t2=c._t2,l.push(s))}),l}translate(e,n,i){i=typeof i=="number"?i:n;const a=this.order;let s=this.points.map((o,l)=>(1-l/a)*n+l/a*i);return new rr(this.points.map((o,l)=>({x:o.x+e.x*s[l],y:o.y+e.y*s[l]})))}scale(e){const n=this.order;let i=!1;if(typeof e=="function"&&(i=e),i&&n===2)return this.raise().scale(i);const a=this.clockwise,s=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):e,i?i(1):e);const o=i?i(0):e,l=i?i(1):e,u=[this.offset(0,10),this.offset(1,10)],c=[],h=De.lli4(u[0],u[0].c,u[1],u[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(d){const v=c[d*n]=De.copy(s[d*n]);v.x+=(d?l:o)*u[d].n.x,v.y+=(d?l:o)*u[d].n.y}),i?([0,1].forEach(function(d){if(!(n===2&&d)){var v=s[d+1],m={x:v.x-h.x,y:v.y-h.y},y=i?i((d+1)/n):e;i&&!a&&(y=-y);var b=ac(m.x*m.x+m.y*m.y);m.x/=b,m.y/=b,c[d+1]={x:v.x+y*m.x,y:v.y+y*m.y}}}),new rr(c)):([0,1].forEach(d=>{if(n===2&&d)return;const v=c[d*n],m=this.derivative(d),y={x:v.x+m.x,y:v.y+m.y};c[d+1]=De.lli4(v,y,h,s[d+1])}),new rr(c))}outline(e,n,i,a){if(n=n===void 0?e:n,this._linear){const T=this.normal(0),R=this.points[0],D=this.points[this.points.length-1];let B,N,I;i===void 0&&(i=e,a=n),B={x:R.x+T.x*e,y:R.y+T.y*e},I={x:D.x+T.x*i,y:D.y+T.y*i},N={x:(B.x+I.x)/2,y:(B.y+I.y)/2};const P=[B,N,I];B={x:R.x-T.x*n,y:R.y-T.y*n},I={x:D.x-T.x*a,y:D.y-T.y*a},N={x:(B.x+I.x)/2,y:(B.y+I.y)/2};const F=[I,N,B],O=De.makeline(F[2],P[0]),U=De.makeline(P[2],F[0]),L=[O,new rr(P),U,new rr(F)];return new Dc(L)}const s=this.reduce(),o=s.length,l=[];let u=[],c,h=0,d=this.length();const v=typeof i<"u"&&typeof a<"u";function m(T,R,D,B,N){return function(I){const P=B/D,F=(B+N)/D,O=R-T;return De.map(I,0,1,T+P*O,T+F*O)}}s.forEach(function(T){const R=T.length();v?(l.push(T.scale(m(e,i,d,h,R))),u.push(T.scale(m(-n,-a,d,h,R)))):(l.push(T.scale(e)),u.push(T.scale(-n))),h+=R}),u=u.map(function(T){return c=T.points,c[3]?T.points=[c[3],c[2],c[1],c[0]]:T.points=[c[2],c[1],c[0]],T}).reverse();const y=l[0].points[0],b=l[o-1].points[l[o-1].points.length-1],x=u[o-1].points[u[o-1].points.length-1],A=u[0].points[0],C=De.makeline(x,y),E=De.makeline(b,A),S=[C].concat(l).concat([E]).concat(u);return new Dc(S)}outlineshapes(e,n,i){n=n||e;const a=this.outline(e,n).curves,s=[];for(let o=1,l=a.length;o<l/2;o++){const u=De.makeshape(a[o],a[l-o],i);u.startcap.virtual=o>1,u.endcap.virtual=o<l/2-1,s.push(u)}return s}intersects(e,n){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof rr&&(e=e.reduce()),this.curveintersects(this.reduce(),e,n)):this.selfintersects(n)}lineIntersects(e){const n=_4(e.p1.x,e.p2.x),i=_4(e.p1.y,e.p2.y),a=z4(e.p1.x,e.p2.x),s=z4(e.p1.y,e.p2.y);return De.roots(this.points,e).filter(o=>{var l=this.get(o);return De.between(l.x,n,a)&&De.between(l.y,i,s)})}selfintersects(e){const n=this.reduce(),i=n.length-2,a=[];for(let s=0,o,l,u;s<i;s++)l=n.slice(s,s+1),u=n.slice(s+2),o=this.curveintersects(l,u,e),a.push(...o);return a}curveintersects(e,n,i){const a=[];e.forEach(function(o){n.forEach(function(l){o.overlaps(l)&&a.push({left:o,right:l})})});let s=[];return a.forEach(function(o){const l=De.pairiteration(o.left,o.right,i);l.length>0&&(s=s.concat(l))}),s}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,n,i,a){const s=(a-i)/4,o=this.get(i+s),l=this.get(a-s),u=De.dist(e,n),c=De.dist(e,o),h=De.dist(e,l);return ic(c-u)+ic(h-u)}_iterate(e,n){let i=0,a=1,s;do{s=0,a=1;let o=this.get(i),l,u,c,h,d=!1,v=!1,m,y=a,b=1;do if(v=d,h=c,y=(i+a)/2,l=this.get(y),u=this.get(a),c=De.getccenter(o,l,u),c.interval={start:i,end:a},d=this._error(c,o,i,a)<=e,m=v&&!d,m||(b=a),d){if(a>=1){if(c.interval.end=b=1,h=c,a>1){let A={x:c.x+c.r*UL(c.e),y:c.y+c.r*VL(c.e)};c.e+=De.angle({x:c.x,y:c.y},A,this.get(1))}break}a=a+(a-i)/2}else a=y;while(!m&&s++<100);if(s>=100)break;h=h||c,n.push(h),i=b}while(a<1);return n}}function Qp(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function _L(r){if(Array.isArray(r))return r}function zL(r){if(Array.isArray(r))return Qp(r)}function qL(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function GL(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],u=!0,c=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(u=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);u=!0);}catch(h){c=!0,a=h}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function YL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HL(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jL(r,e){if(r==null)return{};var n,i,a=KL(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(i=0;i<s.length;i++)n=s[i],e.includes(n)||{}.propertyIsEnumerable.call(r,n)&&(a[n]=r[n])}return a}function KL(r,e){if(r==null)return{};var n={};for(var i in r)if({}.hasOwnProperty.call(r,i)){if(e.includes(i))continue;n[i]=r[i]}return n}function XL(r,e){return _L(r)||GL(r,e)||F6(r,e)||YL()}function QL(r){return zL(r)||qL(r)||F6(r)||HL()}function WL(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function ZL(r){var e=WL(r,"string");return typeof e=="symbol"?e:e+""}function F6(r,e){if(r){if(typeof r=="string")return Qp(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qp(r,e):void 0}}var JL=(function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(l){return{keyAccessor:l,isProp:!(l instanceof Function)}}),s=r.reduce(function(l,u){var c=l,h=u;return a.forEach(function(d,v){var m=d.keyAccessor,y=d.isProp,b;if(y){var x=h,A=x[m],C=jL(x,[m].map(ZL));b=A,h=C}else b=m(h,v);v+1<a.length?(c.hasOwnProperty(b)||(c[b]={}),c=c[b]):n?(c.hasOwnProperty(b)||(c[b]=[]),c[b].push(h)):c[b]=h}),l},{});n instanceof Function&&(function l(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;c===a.length?Object.keys(u).forEach(function(h){return u[h]=n(u[h])}):Object.values(u).forEach(function(h){return l(h,c+1)})})(s);var o=s;return i&&(o=[],(function l(u){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];c.length===a.length?o.push({keys:c,vals:u}):Object.entries(u).forEach(function(h){var d=XL(h,2),v=d[0],m=d[1];return l(m,[].concat(QL(c),[v]))})})(s),e instanceof Array&&e.length===0&&o.length===1&&(o[0].keys=[])),o});function $L(r,e){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(e).domain(r);break}return this}const q4=Symbol("implicit");function k6(){var r=new u4,e=[],n=[],i=q4;function a(s){let o=r.get(s);if(o===void 0){if(i!==q4)return i;r.set(s,o=e.push(s)-1)}return n[o%n.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],r=new u4;for(const o of s)r.has(o)||r.set(o,e.push(o)-1);return a},a.range=function(s){return arguments.length?(n=Array.from(s),a):n.slice()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.copy=function(){return k6(e,n).unknown(i)},$L.apply(a,arguments),a}function e_(r){for(var e=r.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+r.slice(i*6,++i*6);return n}const t_=e_("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function r_(r,e){e===void 0&&(e={});var n=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",n==="top"&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=r:a.appendChild(document.createTextNode(r))}}var n_=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;r_(n_);function Wp(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function i_(r){if(Array.isArray(r))return r}function a_(r){if(Array.isArray(r))return Wp(r)}function G4(r,e,n){if(P6())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var a=new(r.bind.apply(r,i));return a}function Wc(r,e,n){return(e=f_(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function P6(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(P6=function(){return!!r})()}function s_(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function o_(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],u=!0,c=!1;try{if(s=(n=n.call(r)).next,e!==0)for(;!(u=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);u=!0);}catch(h){c=!0,a=h}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function l_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u_(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y4(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),n.push.apply(n,i)}return n}function yl(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Y4(Object(n),!0).forEach(function(i){Wc(r,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):Y4(Object(n)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(n,i))})}return r}function Rc(r,e){return i_(r)||o_(r,e)||U6(r,e)||l_()}function li(r){return a_(r)||s_(r)||U6(r)||u_()}function c_(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function f_(r){var e=c_(r,"string");return typeof e=="symbol"?e:e+""}function Zp(r){"@babel/helpers - typeof";return Zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zp(r)}function U6(r,e){if(r){if(typeof r=="string")return Wp(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wp(r,e):void 0}}var h_=k6(t_);function H4(r,e,n){!e||typeof n!="string"||r.filter(function(i){return!i[n]}).forEach(function(i){i[n]=h_(e(i))})}function d_(r,e){var n=r.nodes,i=r.links,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=a.nodeFilter,o=s===void 0?function(){return!0}:s,l=a.onLoopError,u=l===void 0?function(m){throw"Invalid DAG structure! Found cycle in node path: ".concat(m.join(" -> "),".")}:l,c={};n.forEach(function(m){return c[e(m)]={data:m,out:[],depth:-1,skip:!o(m)}}),i.forEach(function(m){var y=m.source,b=m.target,x=S(y),A=S(b);if(!c.hasOwnProperty(x))throw"Missing source node with id: ".concat(x);if(!c.hasOwnProperty(A))throw"Missing target node with id: ".concat(A);var C=c[x],E=c[A];C.out.push(E);function S(T){return Zp(T)==="object"?e(T):T}});var h=[];v(Object.values(c));var d=Object.assign.apply(Object,[{}].concat(li(Object.entries(c).filter(function(m){var y=Rc(m,2),b=y[1];return!b.skip}).map(function(m){var y=Rc(m,2),b=y[0],x=y[1];return Wc({},b,x.depth)}))));return d;function v(m){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,x=function(){var S=m[A];if(y.indexOf(S)!==-1){var T=[].concat(li(y.slice(y.indexOf(S))),[S]).map(function(R){return e(R.data)});return h.some(function(R){return R.length===T.length&&R.every(function(D,B){return D===T[B]})})||(h.push(T),u(T)),1}b>S.depth&&(S.depth=b,v(S.out,[].concat(li(y),[S]),b+(S.skip?0:1)))},A=0,C=m.length;A<C;A++)x()}}var g_=2,an=function(e,n){return n.onNeedsRedraw&&n.onNeedsRedraw()},j4=function(e,n){if(!n.isShadow){var i=Ut(n.linkDirectionalParticles);n.graphData.links.forEach(function(a){var s=Math.round(Math.abs(i(a)));s?a.__photons=li(Array(s)).map(function(){return{}}):delete a.__photons})}},u0=q2({props:{graphData:{default:{nodes:[],links:[]},onChange:function(e,n){n.engineRunning=!1,j4(e,n)}},dagMode:{onChange:function(e,n){!e&&(n.graphData.nodes||[]).forEach(function(i){return i.fx=i.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:an},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:an},nodeColor:{default:"color",triggerUpdate:!1,onChange:an},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:an},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:an},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:an},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:an},linkColor:{default:"color",triggerUpdate:!1,onChange:an},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:an},linkWidth:{default:1,triggerUpdate:!1,onChange:an},linkCurvature:{default:0,triggerUpdate:!1,onChange:an},linkCanvasObject:{triggerUpdate:!1,onChange:an},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:an},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:an},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:an},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:an},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:j4},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleOffset:{default:0,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},linkDirectionalParticleCanvasObject:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,n){n.forceLayout.velocityDecay(e)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(e,n,i){return i===void 0?e.forceLayout.force(n):(e.forceLayout.force(n,i),this)},d3ReheatSimulation:function(e){return e.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},isEngineRunning:function(e){return!!e.engineRunning},tickFrame:function(e){return!e.isShadow&&n(),a(),!e.isShadow&&s(),!e.isShadow&&o(),i(),this;function n(){e.engineRunning&&(++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.forceLayout.tick(),e.onEngineTick()))}function i(){var l=Ut(e.nodeVisibility),u=Ut(e.nodeVal),c=Ut(e.nodeColor),h=Ut(e.nodeCanvasObjectMode),d=e.ctx,v=e.isShadow/e.globalScale,m=e.graphData.nodes.filter(l);d.save(),m.forEach(function(y){var b=h(y);if(e.nodeCanvasObject&&(b==="before"||b==="replace")&&(e.nodeCanvasObject(y,d,e.globalScale),b==="replace")){d.restore();return}var x=Math.sqrt(Math.max(0,u(y)||1))*e.nodeRelSize+v;d.beginPath(),d.arc(y.x,y.y,x,0,2*Math.PI,!1),d.fillStyle=c(y)||"rgba(31, 120, 180, 0.92)",d.fill(),e.nodeCanvasObject&&b==="after"&&e.nodeCanvasObject(y,e.ctx,e.globalScale)}),d.restore()}function a(){var l=Ut(e.linkVisibility),u=Ut(e.linkColor),c=Ut(e.linkWidth),h=Ut(e.linkLineDash),d=Ut(e.linkCurvature),v=Ut(e.linkCanvasObjectMode),m=e.ctx,y=e.isShadow*2,b=e.graphData.links.filter(l);b.forEach(R);var x=[],A=[],C=b;if(e.linkCanvasObject){var E=[],S=[];b.forEach(function(D){return({before:x,after:A,replace:E}[v(D)]||S).push(D)}),C=[].concat(li(x),A,S),x=x.concat(E)}m.save(),x.forEach(function(D){return e.linkCanvasObject(D,m,e.globalScale)}),m.restore();var T=JL(C,[u,c,h]);m.save(),Object.entries(T).forEach(function(D){var B=Rc(D,2),N=B[0],I=B[1],P=!N||N==="undefined"?"rgba(0,0,0,0.15)":N;Object.entries(I).forEach(function(F){var O=Rc(F,2),U=O[0],L=O[1],V=(U||1)/e.globalScale+y;Object.entries(L).forEach(function(_){var G=Rc(_,2);G[0];var K=G[1],z=h(K[0]);m.beginPath(),K.forEach(function(Y){var Z=Y.source,J=Y.target;if(!(!Z||!J||!Z.hasOwnProperty("x")||!J.hasOwnProperty("x"))){m.moveTo(Z.x,Z.y);var ee=Y.__controlPoints;ee?m[ee.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(m,li(ee).concat([J.x,J.y])):m.lineTo(J.x,J.y)}}),m.strokeStyle=P,m.lineWidth=V,m.setLineDash(z||[]),m.stroke()})})}),m.restore(),m.save(),A.forEach(function(D){return e.linkCanvasObject(D,m,e.globalScale)}),m.restore();function R(D){var B=d(D);if(!B){D.__controlPoints=null;return}var N=D.source,I=D.target;if(!(!N||!I||!N.hasOwnProperty("x")||!I.hasOwnProperty("x"))){var P=Math.sqrt(Math.pow(I.x-N.x,2)+Math.pow(I.y-N.y,2));if(P>0){var F=Math.atan2(I.y-N.y,I.x-N.x),O=P*B,U={x:(N.x+I.x)/2+O*Math.cos(F-Math.PI/2),y:(N.y+I.y)/2+O*Math.sin(F-Math.PI/2)};D.__controlPoints=[U.x,U.y]}else{var L=B*70;D.__controlPoints=[I.x,I.y-L,I.x+L,I.y]}}}}function s(){var l=1.6,u=.2,c=Ut(e.linkDirectionalArrowLength),h=Ut(e.linkDirectionalArrowRelPos),d=Ut(e.linkVisibility),v=Ut(e.linkDirectionalArrowColor||e.linkColor),m=Ut(e.nodeVal),y=e.ctx;y.save(),e.graphData.links.filter(d).forEach(function(b){var x=c(b);if(!(!x||x<0)){var A=b.source,C=b.target;if(!(!A||!C||!A.hasOwnProperty("x")||!C.hasOwnProperty("x"))){var E=Math.sqrt(Math.max(0,m(A)||1))*e.nodeRelSize,S=Math.sqrt(Math.max(0,m(C)||1))*e.nodeRelSize,T=Math.min(1,Math.max(0,h(b))),R=v(b)||"rgba(0,0,0,0.28)",D=x/l/2,B=b.__controlPoints&&G4(rr,[A.x,A.y].concat(li(b.__controlPoints),[C.x,C.y])),N=B?function(V){return B.get(V)}:function(V){return{x:A.x+(C.x-A.x)*V||0,y:A.y+(C.y-A.y)*V||0}},I=B?B.length():Math.sqrt(Math.pow(C.x-A.x,2)+Math.pow(C.y-A.y,2)),P=E+x+(I-E-S-x)*T,F=N(P/I),O=N((P-x)/I),U=N((P-x*(1-u))/I),L=Math.atan2(F.y-O.y,F.x-O.x)-Math.PI/2;y.beginPath(),y.moveTo(F.x,F.y),y.lineTo(O.x+D*Math.cos(L),O.y+D*Math.sin(L)),y.lineTo(U.x,U.y),y.lineTo(O.x-D*Math.cos(L),O.y-D*Math.sin(L)),y.fillStyle=R,y.fill()}}}),y.restore()}function o(){var l=Ut(e.linkDirectionalParticles),u=Ut(e.linkDirectionalParticleSpeed),c=Ut(e.linkDirectionalParticleOffset),h=Ut(e.linkDirectionalParticleWidth),d=Ut(e.linkVisibility),v=Ut(e.linkDirectionalParticleColor||e.linkColor),m=e.ctx;m.save(),e.graphData.links.filter(d).forEach(function(y){var b=l(y);if(!(!y.hasOwnProperty("__photons")||!y.__photons.length)){var x=y.source,A=y.target;if(!(!x||!A||!x.hasOwnProperty("x")||!A.hasOwnProperty("x"))){var C=u(y),E=Math.abs(c(y)),S=y.__photons||[],T=Math.max(0,h(y)/2)/Math.sqrt(e.globalScale),R=v(y)||"rgba(0,0,0,0.28)";m.fillStyle=R;var D=y.__controlPoints?G4(rr,[x.x,x.y].concat(li(y.__controlPoints),[A.x,A.y])):null,B=0,N=!1;S.forEach(function(I){var P=!!I.__singleHop;if(I.hasOwnProperty("__progressRatio")||(I.__progressRatio=P?0:(B+E)/b),!P&&B++,I.__progressRatio+=C,I.__progressRatio>=1)if(!P)I.__progressRatio=I.__progressRatio%1;else{N=!0;return}var F=I.__progressRatio,O=D?D.get(F):{x:x.x+(A.x-x.x)*F||0,y:x.y+(A.y-x.y)*F||0};e.linkDirectionalParticleCanvasObject?e.linkDirectionalParticleCanvasObject(O.x,O.y,y,m,e.globalScale):(m.beginPath(),m.arc(O.x,O.y,T,0,2*Math.PI,!1),m.fill())}),N&&(y.__photons=y.__photons.filter(function(I){return!I.__singleHop||I.__progressRatio<=1}))}}}),m.restore()}},emitParticle:function(e,n){return n&&(!n.__photons&&(n.__photons=[]),n.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:BL().force("link",wL()).force("charge",IL()).force("center",EO()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,n){n.ctx=e},update:function(e,n){e.engineRunning=!1,e.onUpdate(),e.nodeAutoColorBy!==null&&H4(e.graphData.nodes,Ut(e.nodeAutoColorBy),e.nodeColor),e.linkAutoColorBy!==null&&H4(e.graphData.links,Ut(e.linkAutoColorBy),e.linkColor),e.graphData.links.forEach(function(v){v.source=v[e.linkSource],v.target=v[e.linkTarget]}),e.forceLayout.stop().alpha(1).nodes(e.graphData.nodes);var i=e.forceLayout.force("link");i&&i.id(function(v){return v[e.nodeId]}).links(e.graphData.links);var a=e.dagMode&&d_(e.graphData,function(v){return v[e.nodeId]},{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),s=Math.max.apply(Math,li(Object.values(a||[]))),o=e.dagLevelDistance||e.graphData.nodes.length/(s||1)*g_*(["radialin","radialout"].indexOf(e.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(n.dagMode)){var l=["lr","rl"].includes(n.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(v){return delete v[l]})}if(["lr","rl","td","bu"].includes(e.dagMode)){var u=["rl","bu"].includes(e.dagMode),c=function(m){return(a[m[e.nodeId]]-s/2)*o*(u?-1:1)},h=["lr","rl"].includes(e.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach(function(v){return v[h]=c(v)})}e.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(e.dagMode)!==-1?NL(function(v){var m=a[v[e.nodeId]]||-1;return(e.dagMode==="radialin"?s-m:m)*o}).strength(function(v){return e.dagNodeFilter(v)?1:0}):null);for(var d=0;d<e.warmupTicks&&!(e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin);d++)e.forceLayout.tick();this.resetCountdown(),e.onFinishUpdate()}});function V6(r,e){var n=r instanceof Array?r:[r],i=new e;return i._destructor&&i._destructor(),{linkProp:function(s){return{default:i[s](),onChange:function(l,u){n.forEach(function(c){return u[c][s](l)})},triggerUpdate:!1}},linkMethod:function(s){return function(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];var h=[];return n.forEach(function(d){var v=o[d],m=v[s].apply(v,u);m!==v&&h.push(m)}),h.length?h[0]:this}}}}var v_=800,m_=4,p_=5,O6=V6("forceGraph",u0),y_=V6(["forceGraph","shadowGraph"],u0),A_=Object.assign.apply(Object,li(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleOffset","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleCanvasObject","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return Wc({},r,O6.linkProp(r))})).concat(li(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(r){return Wc({},r,y_.linkProp(r))})))),x_=Object.assign.apply(Object,li(["d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return Wc({},r,O6.linkMethod(r))})));function Gm(r){if(r.canvas){var e=r.canvas.width,n=r.canvas.height;e===300&&n===150&&(e=n=0);var i=window.devicePixelRatio;e/=i,n/=i,[r.canvas,r.shadowCanvas].forEach(function(s){s.style.width="".concat(r.width,"px"),s.style.height="".concat(r.height,"px"),s.width=r.width*i,s.height=r.height*i,!e&&!n&&s.getContext("2d").scale(i,i)});var a=Li(r.canvas).k;r.zoom.translateBy(r.zoom.__baseElem,(r.width-e)/2/a,(r.height-n)/2/a),r.needsRedraw=!0}}function L6(r){var e=window.devicePixelRatio;r.setTransform(e,0,0,e,0,0)}function K4(r,e,n){r.save(),L6(r),r.clearRect(0,0,e,n),r.restore()}var b_=q2({props:yl({width:{default:window.innerWidth,onChange:function(e,n){return Gm(n)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(e,n){return Gm(n)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,n){[e.nodes,e.links].every(function(a){return(a||[]).every(function(s){return!s.hasOwnProperty("__indexColor")})})&&n.colorTracker.reset(),[{type:"Node",objs:e.nodes},{type:"Link",objs:e.links}].forEach(i),n.forceGraph.graphData(e),n.shadowGraph.graphData(e);function i(a){var s=a.type,o=a.objs;o.filter(function(l){if(!l.hasOwnProperty("__indexColor"))return!0;var u=n.colorTracker.lookup(l.__indexColor);return!u||!u.hasOwnProperty("d")||u.d!==l}).forEach(function(l){l.__indexColor=n.colorTracker.register({type:s,d:l})})}},triggerUpdate:!1},backgroundColor:{onChange:function(e,n){n.canvas&&e&&(n.canvas.style.background=e)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(e,n){n.shadowGraph.nodeCanvasObject(e?function(i,a,s){return e(i,i.__indexColor,a,s)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(e,n){n.shadowGraph.linkCanvasObject(e?function(i,a,s){return e(i,i.__indexColor,a,s)}:null),n.flushShadowCanvas&&n.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(e,n){n.zoom.scaleExtent([e,n.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(e,n){n.zoom.scaleExtent([n.zoom.scaleExtent()[0],e])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(e,n){n.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},showPointerCursor:{default:!0,triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},A_),aliases:{stopAnimation:"pauseAnimation"},methods:yl({graph2ScreenCoords:function(e,n,i){var a=Li(e.canvas);return{x:n*a.k+a.x,y:i*a.k+a.y}},screen2GraphCoords:function(e,n,i){var a=Li(e.canvas);return{x:(n-a.x)/a.k,y:(i-a.y)/a.k}},centerAt:function(e,n,i,a){if(!e.canvas)return null;if(n!==void 0||i!==void 0){var s=Object.assign({},n!==void 0?{x:n}:{},i!==void 0?{y:i}:{});return a?e.tweenGroup.add(new m4(o()).to(s,a).easing(lo.Quadratic.Out).onUpdate(l).start()):l(s),this}return o();function o(){var u=Li(e.canvas);return{x:(e.width/2-u.x)/u.k,y:(e.height/2-u.y)/u.k}}function l(u){var c=u.x,h=u.y;e.zoom.translateTo(e.zoom.__baseElem,c===void 0?o().x:c,h===void 0?o().y:h),e.needsRedraw=!0}},zoom:function(e,n,i){if(!e.canvas)return null;if(n!==void 0)return i?e.tweenGroup.add(new m4({k:a()}).to({k:n},i).easing(lo.Quadratic.Out).onUpdate(function(o){var l=o.k;return s(l)}).start()):s(n),this;return a();function a(){return Li(e.canvas).k}function s(o){e.zoom.scaleTo(e.zoom.__baseElem,o),e.needsRedraw=!0}},zoomToFit:function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,a=arguments.length,s=new Array(a>3?a-3:0),o=3;o<a;o++)s[o-3]=arguments[o];var l=this.getGraphBbox.apply(this,s);if(l){var u={x:(l.x[0]+l.x[1])/2,y:(l.y[0]+l.y[1])/2},c=Math.max(1e-12,Math.min(1e12,(e.width-i*2)/(l.x[1]-l.x[0]),(e.height-i*2)/(l.y[1]-l.y[0])));this.centerAt(u.x,u.y,n),this.zoom(c,n)}return this},getGraphBbox:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=Ut(e.nodeVal),a=function(l){return Math.sqrt(Math.max(0,i(l)||1))*e.nodeRelSize},s=e.graphData.nodes.filter(n).map(function(o){return{x:o.x,y:o.y,r:a(o)}});return s.length?{x:[h4(s,function(o){return o.x-o.r}),f4(s,function(o){return o.x+o.r})],y:[h4(s,function(o){return o.y-o.r}),f4(s,function(o){return o.y+o.r})]}:null},pauseAnimation:function(e){return e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},x_),stateInit:function(){return{lastSetZoom:1,zoom:NU(),forceGraph:new u0,shadowGraph:new u0().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new rO,tweenGroup:new o6}},init:function(e,n){var i=this;e.innerHTML="";var a=document.createElement("div");a.classList.add("force-graph-container"),a.style.position="relative",e.appendChild(a),n.canvas=document.createElement("canvas"),n.backgroundColor&&(n.canvas.style.background=n.backgroundColor),a.appendChild(n.canvas),n.shadowCanvas=document.createElement("canvas");var s=n.canvas.getContext("2d"),o=n.shadowCanvas.getContext("2d",{willReadFrequently:!0}),l={x:-1e12,y:-1e12},u=function(){var d=null,v=window.devicePixelRatio,m=l.x>0&&l.y>0?o.getImageData(l.x*v,l.y*v,1,1):null;return m&&(d=n.colorTracker.lookup(m.data)),d};oi(n.canvas).call(qk().subject(function(){if(!n.enableNodeDrag)return null;var h=u();return h&&h.type==="Node"?h.d:null}).on("start",function(h){var d=h.subject;d.__initialDragPos={x:d.x,y:d.y,fx:d.fx,fy:d.fy},h.active||(d.fx=d.x,d.fy=d.y),n.canvas.classList.add("grabbable")}).on("drag",function(h){var d=h.subject,v=d.__initialDragPos,m=h,y=Li(n.canvas).k,b={x:v.x+(m.x-v.x)/y-d.x,y:v.y+(m.y-v.y)/y-d.y};["x","y"].forEach(function(x){return d["f".concat(x)]=d[x]=v[x]+(m[x]-v[x])/y}),!(!d.__dragged&&p_>=Math.sqrt(UU(["x","y"].map(function(x){return Math.pow(h[x]-v[x],2)}))))&&(n.forceGraph.d3AlphaTarget(.3).resetCountdown(),n.isPointerDragging=!0,d.__dragged=!0,n.onNodeDrag(d,b))}).on("end",function(h){var d=h.subject,v=d.__initialDragPos,m={x:d.x-v.x,y:d.y-v.y};v.fx===void 0&&(d.fx=void 0),v.fy===void 0&&(d.fy=void 0),delete d.__initialDragPos,n.forceGraph.d3AlphaTarget()&&n.forceGraph.d3AlphaTarget(0).resetCountdown(),n.canvas.classList.remove("grabbable"),n.isPointerDragging=!1,d.__dragged&&(delete d.__dragged,n.onNodeDragEnd(d,m))})),n.zoom(n.zoom.__baseElem=oi(n.canvas)),n.zoom.__baseElem.on("dblclick.zoom",null),n.zoom.filter(function(h){return!h.button&&n.enableZoomPanInteraction&&(h.type!=="wheel"||Ut(n.enableZoomInteraction)(h))&&(h.type==="wheel"||Ut(n.enablePanInteraction)(h))}).on("zoom",function(h){var d=h.transform;[s,o].forEach(function(v){L6(v),v.translate(d.x,d.y),v.scale(d.k,d.k)}),n.isPointerDragging=!0,n.onZoom&&n.onZoom(yl(yl({},d),i.centerAt())),n.needsRedraw=!0}).on("end",function(h){n.isPointerDragging=!1,n.onZoomEnd&&n.onZoomEnd(yl(yl({},h.transform),i.centerAt()))}),Gm(n),n.forceGraph.onNeedsRedraw(function(){return n.needsRedraw=!0}).onFinishUpdate(function(){Li(n.canvas).k===n.lastSetZoom&&n.graphData.nodes.length&&(n.zoom.scaleTo(n.zoom.__baseElem,n.lastSetZoom=m_/Math.cbrt(n.graphData.nodes.length)),n.needsRedraw=!0)}),n.tooltip=new CO(a),["pointermove","pointerdown"].forEach(function(h){return a.addEventListener(h,function(d){h==="pointerdown"&&(n.isPointerPressed=!0,n.pointerDownEvent=d),!n.isPointerDragging&&d.type==="pointermove"&&n.onBackgroundClick&&(d.pressure>0||n.isPointerPressed)&&(d.pointerType==="mouse"||d.movementX===void 0||[d.movementX,d.movementY].some(function(y){return Math.abs(y)>1}))&&(n.isPointerDragging=!0);var v=m(a);l.x=d.pageX-v.left,l.y=d.pageY-v.top;function m(y){var b=y.getBoundingClientRect(),x=window.pageXOffset||document.documentElement.scrollLeft,A=window.pageYOffset||document.documentElement.scrollTop;return{top:b.top+A,left:b.left+x}}},{passive:!0})}),a.addEventListener("pointerup",function(h){if(n.isPointerPressed){if(n.isPointerPressed=!1,n.isPointerDragging){n.isPointerDragging=!1;return}var d=[h,n.pointerDownEvent];requestAnimationFrame(function(){if(h.button===0)if(n.hoverObj){var v=n["on".concat(n.hoverObj.type,"Click")];v&&v.apply(void 0,[n.hoverObj.d].concat(d))}else n.onBackgroundClick&&n.onBackgroundClick.apply(n,d);if(h.button===2)if(n.hoverObj){var m=n["on".concat(n.hoverObj.type,"RightClick")];m&&m.apply(void 0,[n.hoverObj.d].concat(d))}else n.onBackgroundRightClick&&n.onBackgroundRightClick.apply(n,d)})}},{passive:!0}),a.addEventListener("contextmenu",function(h){return!n.onBackgroundRightClick&&!n.onNodeRightClick&&!n.onLinkRightClick?!0:(h.preventDefault(),!1)}),n.forceGraph(s),n.shadowGraph(o);var c=uV(function(){K4(o,n.width,n.height),n.shadowGraph.linkWidth(function(d){return Ut(n.linkWidth)(d)+n.linkHoverPrecision});var h=Li(n.canvas);n.shadowGraph.globalScale(h.k).tickFrame()},v_);n.flushShadowCanvas=c.flush,(this._animationCycle=function h(){var d=!n.autoPauseRedraw||!!n.needsRedraw||n.forceGraph.isEngineRunning()||n.graphData.links.some(function(E){return E.__photons&&E.__photons.length});if(n.needsRedraw=!1,n.enablePointerInteraction){var v=n.isPointerDragging?null:u();if(v!==n.hoverObj){var m=n.hoverObj,y=m?m.type:null,b=v?v.type:null;if(y&&y!==b){var x=n["on".concat(y,"Hover")];x&&x(null,m.d)}if(b){var A=n["on".concat(b,"Hover")];A&&A(v.d,y===b?m.d:null)}n.tooltip.content(v&&Ut(n["".concat(v.type.toLowerCase(),"Label")])(v.d)||null),n.canvas.classList[(v&&n["on".concat(b,"Click")]||!v&&n.onBackgroundClick)&&Ut(n.showPointerCursor)(v?.d)?"add":"remove"]("clickable"),n.hoverObj=v}d&&c()}if(d){K4(s,n.width,n.height);var C=Li(n.canvas).k;n.onRenderFramePre&&n.onRenderFramePre(s,C),n.forceGraph.globalScale(C).tickFrame(),n.onRenderFramePost&&n.onRenderFramePost(s,C)}n.tweenGroup.update(),n.animationFrameRequestId=requestAnimationFrame(h)})()},update:function(e){}});const V0={width:W.number,height:W.number,graphData:W.shape({nodes:W.arrayOf(W.object).isRequired,links:W.arrayOf(W.object).isRequired}),backgroundColor:W.string,nodeRelSize:W.number,nodeId:W.string,nodeLabel:W.oneOfType([W.string,W.func]),nodeVal:W.oneOfType([W.number,W.string,W.func]),nodeVisibility:W.oneOfType([W.bool,W.string,W.func]),nodeColor:W.oneOfType([W.string,W.func]),nodeAutoColorBy:W.oneOfType([W.string,W.func]),onNodeHover:W.func,onNodeClick:W.func,linkSource:W.string,linkTarget:W.string,linkLabel:W.oneOfType([W.string,W.func]),linkVisibility:W.oneOfType([W.bool,W.string,W.func]),linkColor:W.oneOfType([W.string,W.func]),linkAutoColorBy:W.oneOfType([W.string,W.func]),linkWidth:W.oneOfType([W.number,W.string,W.func]),linkCurvature:W.oneOfType([W.number,W.string,W.func]),linkDirectionalArrowLength:W.oneOfType([W.number,W.string,W.func]),linkDirectionalArrowColor:W.oneOfType([W.string,W.func]),linkDirectionalArrowRelPos:W.oneOfType([W.number,W.string,W.func]),linkDirectionalParticles:W.oneOfType([W.number,W.string,W.func]),linkDirectionalParticleSpeed:W.oneOfType([W.number,W.string,W.func]),linkDirectionalParticleOffset:W.oneOfType([W.number,W.string,W.func]),linkDirectionalParticleWidth:W.oneOfType([W.number,W.string,W.func]),linkDirectionalParticleColor:W.oneOfType([W.string,W.func]),onLinkHover:W.func,onLinkClick:W.func,dagMode:W.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:W.number,dagNodeFilter:W.func,onDagError:W.func,d3AlphaMin:W.number,d3AlphaDecay:W.number,d3VelocityDecay:W.number,warmupTicks:W.number,cooldownTicks:W.number,cooldownTime:W.number,onEngineTick:W.func,onEngineStop:W.func,getGraphBbox:W.func},_6={zoomToFit:W.func,onNodeRightClick:W.func,onNodeDrag:W.func,onNodeDragEnd:W.func,onLinkRightClick:W.func,linkHoverPrecision:W.number,onBackgroundClick:W.func,onBackgroundRightClick:W.func,showPointerCursor:W.oneOfType([W.bool,W.func]),enablePointerInteraction:W.bool,enableNodeDrag:W.bool},W2={showNavInfo:W.bool,nodeOpacity:W.number,nodeResolution:W.number,nodeThreeObject:W.oneOfType([W.object,W.string,W.func]),nodeThreeObjectExtend:W.oneOfType([W.bool,W.string,W.func]),nodePositionUpdate:W.func,linkOpacity:W.number,linkResolution:W.number,linkCurveRotation:W.oneOfType([W.number,W.string,W.func]),linkMaterial:W.oneOfType([W.object,W.string,W.func]),linkThreeObject:W.oneOfType([W.object,W.string,W.func]),linkThreeObjectExtend:W.oneOfType([W.bool,W.string,W.func]),linkPositionUpdate:W.func,linkDirectionalArrowResolution:W.number,linkDirectionalParticleResolution:W.number,linkDirectionalParticleThreeObject:W.oneOfType([W.object,W.string,W.func]),forceEngine:W.oneOf(["d3","ngraph"]),ngraphPhysics:W.object,numDimensions:W.oneOf([1,2,3])},w_=Object.assign({},V0,_6,{linkLineDash:W.oneOfType([W.arrayOf(W.number),W.string,W.func]),nodeCanvasObjectMode:W.oneOfType([W.string,W.func]),nodeCanvasObject:W.func,nodePointerAreaPaint:W.func,linkCanvasObjectMode:W.oneOfType([W.string,W.func]),linkCanvasObject:W.func,linkPointerAreaPaint:W.func,linkDirectionalParticleCanvasObject:W.func,autoPauseRedraw:W.bool,minZoom:W.number,maxZoom:W.number,enableZoomInteraction:W.oneOfType([W.bool,W.func]),enablePanInteraction:W.oneOfType([W.bool,W.func]),onZoom:W.func,onZoomEnd:W.func,onRenderFramePre:W.func,onRenderFramePost:W.func});Object.assign({},V0,_6,W2,{enableNavigationControls:W.bool,controlType:W.oneOf(["trackball","orbit","fly"]),rendererConfig:W.object,extraRenderers:W.arrayOf(W.shape({render:W.func.isRequired}))});Object.assign({},V0,W2,{nodeDesc:W.oneOfType([W.string,W.func]),linkDesc:W.oneOfType([W.string,W.func])});Object.assign({},V0,W2,{markerAttrs:W.object,yOffset:W.number,glScale:W.number});const Z2=e9(b_,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});Z2.displayName="ForceGraph2D";Z2.propTypes=w_;function C_(r){if(!r)return"#34d399";const e=["#34d399","#60a5fa","#a855f7","#f97316","#f43f5e"],n=Math.abs([...r].reduce((i,a)=>i*17+a.charCodeAt(0),11));return e[n%e.length]}function J2({graph:r,onNodeSelect:e}){const n=Ye.useMemo(()=>({nodes:r.nodes.map(i=>({id:i.id,name:i.name,category:i.category,val:i.value??3,color:C_(i.category)})),links:r.links.map(i=>({id:i.id,source:i.source,target:i.target,label:i.label,confidence:i.confidence}))}),[r]);return ie.jsx("div",{className:"force-graph-wrapper","data-testid":"force-graph-view",children:ie.jsx(Z2,{graphData:n,nodeLabel:i=>`${i.name}
${i.category??"unknown"}`,linkDirectionalParticles:2,linkDirectionalParticleWidth:i=>2+(i.confidence??.3)*2,linkDirectionalParticleSpeed:.005,linkColor:()=>"rgba(129, 199, 212, 0.7)",nodeRelSize:6,width:void 0,height:void 0,backgroundColor:"rgba(9, 13, 26, 0.85)",onNodeClick:i=>{e&&e(i.id)}})})}J2.propTypes={graph:W.shape({nodes:W.arrayOf(W.shape({id:W.string.isRequired,name:W.string,category:W.string,value:W.number})),links:W.arrayOf(W.shape({id:W.string,source:W.oneOfType([W.string,W.object]).isRequired,target:W.oneOfType([W.string,W.object]).isRequired,label:W.string,confidence:W.number}))}),onNodeSelect:W.func};J2.defaultProps={graph:{nodes:[],links:[]},onNodeSelect:void 0};var E_=1e-6,Hr=typeof Float32Array<"u"?Float32Array:Array;function S_(){var r=new Hr(9);return Hr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function ao(r,e,n,i,a,s,o,l,u){var c=new Hr(9);return c[0]=r,c[1]=e,c[2]=n,c[3]=i,c[4]=a,c[5]=s,c[6]=o,c[7]=l,c[8]=u,c}function z6(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],d=e[8],v=n[0],m=n[1],y=n[2],b=n[3],x=n[4],A=n[5],C=n[6],E=n[7],S=n[8];return r[0]=v*i+m*o+y*c,r[1]=v*a+m*l+y*h,r[2]=v*s+m*u+y*d,r[3]=b*i+x*o+A*c,r[4]=b*a+x*l+A*h,r[5]=b*s+x*u+A*d,r[6]=C*i+E*o+S*c,r[7]=C*a+E*l+S*h,r[8]=C*s+E*u+S*d,r}function Tt(){var r=new Hr(16);return Hr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function Er(r){var e=new Hr(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function T_(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Hn(r,e,n,i,a,s,o,l,u,c,h,d,v,m,y,b){var x=new Hr(16);return x[0]=r,x[1]=e,x[2]=n,x[3]=i,x[4]=a,x[5]=s,x[6]=o,x[7]=l,x[8]=u,x[9]=c,x[10]=h,x[11]=d,x[12]=v,x[13]=m,x[14]=y,x[15]=b,x}function q6(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Yn(r,e){if(r===e){var n=e[1],i=e[2],a=e[3],s=e[6],o=e[7],l=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=n,r[6]=e[9],r[7]=e[13],r[8]=i,r[9]=s,r[11]=e[14],r[12]=a,r[13]=o,r[14]=l}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function Mn(r,e){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],v=e[10],m=e[11],y=e[12],b=e[13],x=e[14],A=e[15],C=n*l-i*o,E=n*u-a*o,S=n*c-s*o,T=i*u-a*l,R=i*c-s*l,D=a*c-s*u,B=h*b-d*y,N=h*x-v*y,I=h*A-m*y,P=d*x-v*b,F=d*A-m*b,O=v*A-m*x,U=C*O-E*F+S*P+T*I-R*N+D*B;return U?(U=1/U,r[0]=(l*O-u*F+c*P)*U,r[1]=(a*F-i*O-s*P)*U,r[2]=(b*D-x*R+A*T)*U,r[3]=(v*R-d*D-m*T)*U,r[4]=(u*I-o*O-c*N)*U,r[5]=(n*O-a*I+s*N)*U,r[6]=(x*S-y*D-A*E)*U,r[7]=(h*D-v*S+m*E)*U,r[8]=(o*F-l*I+c*B)*U,r[9]=(i*I-n*F-s*B)*U,r[10]=(y*R-b*S+A*C)*U,r[11]=(d*S-h*R-m*C)*U,r[12]=(l*N-o*P-u*B)*U,r[13]=(n*P-i*N+a*B)*U,r[14]=(b*E-y*T-x*C)*U,r[15]=(h*T-d*E+v*C)*U,r):null}function ls(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],d=e[8],v=e[9],m=e[10],y=e[11],b=e[12],x=e[13],A=e[14],C=e[15],E=n[0],S=n[1],T=n[2],R=n[3];return r[0]=E*i+S*l+T*d+R*b,r[1]=E*a+S*u+T*v+R*x,r[2]=E*s+S*c+T*m+R*A,r[3]=E*o+S*h+T*y+R*C,E=n[4],S=n[5],T=n[6],R=n[7],r[4]=E*i+S*l+T*d+R*b,r[5]=E*a+S*u+T*v+R*x,r[6]=E*s+S*c+T*m+R*A,r[7]=E*o+S*h+T*y+R*C,E=n[8],S=n[9],T=n[10],R=n[11],r[8]=E*i+S*l+T*d+R*b,r[9]=E*a+S*u+T*v+R*x,r[10]=E*s+S*c+T*m+R*A,r[11]=E*o+S*h+T*y+R*C,E=n[12],S=n[13],T=n[14],R=n[15],r[12]=E*i+S*l+T*d+R*b,r[13]=E*a+S*u+T*v+R*x,r[14]=E*s+S*c+T*m+R*A,r[15]=E*o+S*h+T*y+R*C,r}function Cl(r,e,n){var i=n[0],a=n[1],s=n[2],o,l,u,c,h,d,v,m,y,b,x,A;return e===r?(r[12]=e[0]*i+e[4]*a+e[8]*s+e[12],r[13]=e[1]*i+e[5]*a+e[9]*s+e[13],r[14]=e[2]*i+e[6]*a+e[10]*s+e[14],r[15]=e[3]*i+e[7]*a+e[11]*s+e[15]):(o=e[0],l=e[1],u=e[2],c=e[3],h=e[4],d=e[5],v=e[6],m=e[7],y=e[8],b=e[9],x=e[10],A=e[11],r[0]=o,r[1]=l,r[2]=u,r[3]=c,r[4]=h,r[5]=d,r[6]=v,r[7]=m,r[8]=y,r[9]=b,r[10]=x,r[11]=A,r[12]=o*i+h*a+y*s+e[12],r[13]=l*i+d*a+b*s+e[13],r[14]=u*i+v*a+x*s+e[14],r[15]=c*i+m*a+A*s+e[15]),r}function X4(r,e,n){var i=n[0],a=n[1],s=n[2];return r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r[3]=e[3]*i,r[4]=e[4]*a,r[5]=e[5]*a,r[6]=e[6]*a,r[7]=e[7]*a,r[8]=e[8]*s,r[9]=e[9]*s,r[10]=e[10]*s,r[11]=e[11]*s,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function rd(r,e,n){var i=Math.sin(n),a=Math.cos(n),s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],v=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=s*a+c*i,r[5]=o*a+h*i,r[6]=l*a+d*i,r[7]=u*a+v*i,r[8]=c*a-s*i,r[9]=h*a-o*i,r[10]=d*a-l*i,r[11]=v*a-u*i,r}function nd(r,e,n){var i=Math.sin(n),a=Math.cos(n),s=e[0],o=e[1],l=e[2],u=e[3],c=e[4],h=e[5],d=e[6],v=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*a+c*i,r[1]=o*a+h*i,r[2]=l*a+d*i,r[3]=u*a+v*i,r[4]=c*a-s*i,r[5]=h*a-o*i,r[6]=d*a-l*i,r[7]=v*a-u*i,r}function M_(r,e,n){var i=n[0],a=n[1],s=n[2],o=Math.sqrt(i*i+a*a+s*s),l,u,c;return o<E_?null:(o=1/o,i*=o,a*=o,s*=o,l=Math.sin(e),u=Math.cos(e),c=1-u,r[0]=i*i*c+u,r[1]=a*i*c+s*l,r[2]=s*i*c-a*l,r[3]=0,r[4]=i*a*c-s*l,r[5]=a*a*c+u,r[6]=s*a*c+i*l,r[7]=0,r[8]=i*s*c+a*l,r[9]=a*s*c-i*l,r[10]=s*s*c+u,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function D_(r,e,n,i,a,s,o){var l=1/(e-n),u=1/(i-a),c=1/(s-o);return r[0]=-2*l,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*c,r[11]=0,r[12]=(e+n)*l,r[13]=(a+i)*u,r[14]=(o+s)*c,r[15]=1,r}var id=D_;function R_(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*n,r[9]=e[9]*n,r[10]=e[10]*n,r[11]=e[11]*n,r[12]=e[12]*n,r[13]=e[13]*n,r[14]=e[14]*n,r[15]=e[15]*n,r}var G6=ls;function Kt(){var r=new Hr(3);return Hr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function bi(r){var e=new Hr(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function ms(r){var e=r[0],n=r[1],i=r[2];return Math.sqrt(e*e+n*n+i*i)}function Me(r,e,n){var i=new Hr(3);return i[0]=r,i[1]=e,i[2]=n,i}function Q4(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function uo(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r}function $t(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r}function $2(r,e,n){return r[0]=Math.min(e[0],n[0]),r[1]=Math.min(e[1],n[1]),r[2]=Math.min(e[2],n[2]),r}function ey(r,e,n){return r[0]=Math.max(e[0],n[0]),r[1]=Math.max(e[1],n[1]),r[2]=Math.max(e[2],n[2]),r}function B_(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r}function I_(r,e){var n=e[0]-r[0],i=e[1]-r[1],a=e[2]-r[2];return Math.sqrt(n*n+i*i+a*a)}function N_(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r}function ui(r,e){var n=e[0],i=e[1],a=e[2],s=n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r}function F_(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Bd(r,e,n){var i=e[0],a=e[1],s=e[2],o=n[0],l=n[1],u=n[2];return r[0]=a*u-s*l,r[1]=s*o-i*u,r[2]=i*l-a*o,r}function k_(r,e,n,i){var a=e[0],s=e[1],o=e[2];return r[0]=a+i*(n[0]-a),r[1]=s+i*(n[1]-s),r[2]=o+i*(n[2]-o),r}function Ym(r,e){var n=r[0],i=r[1],a=r[2],s=e[0],o=e[1],l=e[2],u=Math.sqrt((n*n+i*i+a*a)*(s*s+o*o+l*l)),c=u&&F_(r,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}var W4=$t,Zc=ms;(function(){var r=Kt();return function(e,n,i,a,s,o){var l,u;for(n||(n=3),i||(i=0),a?u=Math.min(a*n+i,e.length):u=e.length,l=i;l<u;l+=n)r[0]=e[l],r[1]=e[l+1],r[2]=e[l+2],s(r,r,o),e[l]=r[0],e[l+1]=r[1],e[l+2]=r[2];return e}})();function Yi(){var r=new Hr(4);return Hr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function hs(r){var e=new Hr(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function er(r,e,n,i){var a=new Hr(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=i,a}function Z4(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r}function P_(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r}function U_(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r}function qr(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3];return r[0]=n[0]*i+n[4]*a+n[8]*s+n[12]*o,r[1]=n[1]*i+n[5]*a+n[9]*s+n[13]*o,r[2]=n[2]*i+n[6]*a+n[10]*s+n[14]*o,r[3]=n[3]*i+n[7]*a+n[11]*s+n[15]*o,r}var V_=P_;(function(){var r=Yi();return function(e,n,i,a,s,o){var l,u;for(n||(n=4),i||(i=0),a?u=Math.min(a*n+i,e.length):u=e.length,l=i;l<u;l+=n)r[0]=e[l],r[1]=e[l+1],r[2]=e[l+2],r[3]=e[l+3],s(r,r,o),e[l]=r[0],e[l+1]=r[1],e[l+2]=r[2],e[l+3]=r[3];return e}})();function O_(){var r=new Hr(2);return Hr!=Float32Array&&(r[0]=0,r[1]=0),r}function J4(r,e){var n=new Hr(2);return n[0]=r,n[1]=e,n}function L_(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r}function $4(r){var e=r[0],n=r[1];return Math.sqrt(e*e+n*n)}function __(r,e){var n=e[0],i=e[1],a=n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),r[0]=e[0]*a,r[1]=e[1]*a,r}(function(){var r=O_();return function(e,n,i,a,s,o){var l,u;for(n||(n=2),i||(i=0),a?u=Math.min(a*n+i,e.length):u=e.length,l=i;l<u;l+=n)r[0]=e[l],r[1]=e[l+1],s(r,r,o),e[l]=r[0],e[l+1]=r[1];return e}})();var so=256,Id=[],ad;for(;so--;)Id[so]=(so+256).toString(16).substring(1);function Jp(){var r=0,e,n="";if(!ad||so+16>256){for(ad=Array(r=256);r--;)ad[r]=256*Math.random()|0;r=so=0}for(;r<16;r++)e=ad[so+r],r==6?n+=Id[e&15|64]:r==8?n+=Id[e&63|128]:n+=Id[e],r&1&&r>1&&r<11&&(n+="-");return so++,n}var Hm,eC;function z_(){return eC||(eC=1,Hm=function(e,n){var i=e.length;if(e===n)return!0;if(i!==n.length)return!1;for(var a=0;a<i;a++)if(e[a]!==n[a])return!1;return!0}),Hm}var q_=z_();const G_=a2(q_),Y6=-1,O0=0,Bc=1,c0=2,ty=3,ry=4,ny=5,iy=6,H6=7,j6=8,tC=typeof self=="object"?self:globalThis,Y_=(r,e)=>{const n=(a,s)=>(r.set(s,a),a),i=a=>{if(r.has(a))return r.get(a);const[s,o]=e[a];switch(s){case O0:case Y6:return n(o,a);case Bc:{const l=n([],a);for(const u of o)l.push(i(u));return l}case c0:{const l=n({},a);for(const[u,c]of o)l[i(u)]=i(c);return l}case ty:return n(new Date(o),a);case ry:{const{source:l,flags:u}=o;return n(new RegExp(l,u),a)}case ny:{const l=n(new Map,a);for(const[u,c]of o)l.set(i(u),i(c));return l}case iy:{const l=n(new Set,a);for(const u of o)l.add(i(u));return l}case H6:{const{name:l,message:u}=o;return n(new tC[l](u),a)}case j6:return n(BigInt(o),a);case"BigInt":return n(Object(BigInt(o)),a);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new tC[s](o),a)};return i},H_=r=>Y_(new Map,r)(0),Al="",{toString:j_}={},{keys:K_}=Object,sc=r=>{const e=typeof r;if(e!=="object"||!r)return[O0,e];const n=j_.call(r).slice(8,-1);switch(n){case"Array":return[Bc,Al];case"Object":return[c0,Al];case"Date":return[ty,Al];case"RegExp":return[ry,Al];case"Map":return[ny,Al];case"Set":return[iy,Al];case"DataView":return[Bc,n]}return n.includes("Array")?[Bc,n]:n.includes("Error")?[H6,n]:[c0,n]},sd=([r,e])=>r===O0&&(e==="function"||e==="symbol"),X_=(r,e,n,i)=>{const a=(o,l)=>{const u=i.push(o)-1;return n.set(l,u),u},s=o=>{if(n.has(o))return n.get(o);let[l,u]=sc(o);switch(l){case O0:{let h=o;switch(u){case"bigint":l=j6,h=o.toString();break;case"function":case"symbol":if(r)throw new TypeError("unable to serialize "+u);h=null;break;case"undefined":return a([Y6],o)}return a([l,h],o)}case Bc:{if(u){let v=o;return u==="DataView"?v=new Uint8Array(o.buffer):u==="ArrayBuffer"&&(v=new Uint8Array(o)),a([u,[...v]],o)}const h=[],d=a([l,h],o);for(const v of o)h.push(s(v));return d}case c0:{if(u)switch(u){case"BigInt":return a([u,o.toString()],o);case"Boolean":case"Number":case"String":return a([u,o.valueOf()],o)}if(e&&"toJSON"in o)return s(o.toJSON());const h=[],d=a([l,h],o);for(const v of K_(o))(r||!sd(sc(o[v])))&&h.push([s(v),s(o[v])]);return d}case ty:return a([l,o.toISOString()],o);case ry:{const{source:h,flags:d}=o;return a([l,{source:h,flags:d}],o)}case ny:{const h=[],d=a([l,h],o);for(const[v,m]of o)(r||!(sd(sc(v))||sd(sc(m))))&&h.push([s(v),s(m)]);return d}case iy:{const h=[],d=a([l,h],o);for(const v of o)(r||!sd(sc(v)))&&h.push(s(v));return d}}const{message:c}=o;return a([l,{name:u,message:c}],o)};return s},Q_=(r,{json:e,lossy:n}={})=>{const i=[];return X_(!(e||n),!!e,new Map,i)(r),i};var Gr=Uint8Array,Rl=Uint16Array,W_=Int32Array,K6=new Gr([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),X6=new Gr([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Z_=new Gr([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Q6=function(r,e){for(var n=new Rl(31),i=0;i<31;++i)n[i]=e+=1<<r[i-1];for(var a=new W_(n[30]),i=1;i<30;++i)for(var s=n[i];s<n[i+1];++s)a[s]=s-n[i]<<5|i;return{b:n,r:a}},W6=Q6(K6,2),Z6=W6.b,J_=W6.r;Z6[28]=258,J_[258]=28;var $_=Q6(X6,0),ez=$_.b,$p=new Rl(32768);for(var nr=0;nr<32768;++nr){var rs=(nr&43690)>>1|(nr&21845)<<1;rs=(rs&52428)>>2|(rs&13107)<<2,rs=(rs&61680)>>4|(rs&3855)<<4,$p[nr]=((rs&65280)>>8|(rs&255)<<8)>>1}var Ic=(function(r,e,n){for(var i=r.length,a=0,s=new Rl(e);a<i;++a)r[a]&&++s[r[a]-1];var o=new Rl(e);for(a=1;a<e;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(n){l=new Rl(1<<e);var u=15-e;for(a=0;a<i;++a)if(r[a])for(var c=a<<4|r[a],h=e-r[a],d=o[r[a]-1]++<<h,v=d|(1<<h)-1;d<=v;++d)l[$p[d]>>u]=c}else for(l=new Rl(i),a=0;a<i;++a)r[a]&&(l[a]=$p[o[r[a]-1]++]>>15-r[a]);return l}),mf=new Gr(288);for(var nr=0;nr<144;++nr)mf[nr]=8;for(var nr=144;nr<256;++nr)mf[nr]=9;for(var nr=256;nr<280;++nr)mf[nr]=7;for(var nr=280;nr<288;++nr)mf[nr]=8;var J6=new Gr(32);for(var nr=0;nr<32;++nr)J6[nr]=5;var tz=Ic(mf,9,1),rz=Ic(J6,5,1),jm=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},vi=function(r,e,n){var i=e/8|0;return(r[i]|r[i+1]<<8)>>(e&7)&n},Km=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},$6=function(r){return(r+7)/8|0},Nd=function(r,e,n){return(e==null||e<0)&&(e=0),(n==null||n>r.length)&&(n=r.length),new Gr(r.subarray(e,n))},nz=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],mn=function(r,e,n){var i=new Error(e||nz[r]);if(i.code=r,Error.captureStackTrace&&Error.captureStackTrace(i,mn),!n)throw i;return i},L0=function(r,e,n,i){var a=r.length,s=0;if(!a||e.f&&!e.l)return n||new Gr(0);var o=!n,l=o||e.i!=2,u=e.i;o&&(n=new Gr(a*3));var c=function(ae){var le=n.length;if(ae>le){var Ae=new Gr(Math.max(le*2,ae));Ae.set(n),n=Ae}},h=e.f||0,d=e.p||0,v=e.b||0,m=e.l,y=e.d,b=e.m,x=e.n,A=a*8;do{if(!m){h=vi(r,d,1);var C=vi(r,d+1,3);if(d+=3,C)if(C==1)m=tz,y=rz,b=9,x=5;else if(C==2){var R=vi(r,d,31)+257,D=vi(r,d+10,15)+4,B=R+vi(r,d+5,31)+1;d+=14;for(var N=new Gr(B),I=new Gr(19),P=0;P<D;++P)I[Z_[P]]=vi(r,d+P*3,7);d+=D*3;for(var F=jm(I),O=(1<<F)-1,U=Ic(I,F,1),P=0;P<B;){var L=U[vi(r,d,O)];d+=L&15;var E=L>>4;if(E<16)N[P++]=E;else{var V=0,_=0;for(E==16?(_=3+vi(r,d,3),d+=2,V=N[P-1]):E==17?(_=3+vi(r,d,7),d+=3):E==18&&(_=11+vi(r,d,127),d+=7);_--;)N[P++]=V}}var G=N.subarray(0,R),K=N.subarray(R);b=jm(G),x=jm(K),m=Ic(G,b,1),y=Ic(K,x,1)}else mn(1);else{var E=$6(d)+4,S=r[E-4]|r[E-3]<<8,T=E+S;if(T>a){u&&mn(0);break}l&&c(v+S),n.set(r.subarray(E,T),v),e.b=v+=S,e.p=d=T*8,e.f=h;continue}if(d>A){u&&mn(0);break}}l&&c(v+131072);for(var z=(1<<b)-1,Y=(1<<x)-1,Z=d;;Z=d){var V=m[Km(r,d)&z],J=V>>4;if(d+=V&15,d>A){u&&mn(0);break}if(V||mn(2),J<256)n[v++]=J;else if(J==256){Z=d,m=null;break}else{var ee=J-254;if(J>264){var P=J-257,ne=K6[P];ee=vi(r,d,(1<<ne)-1)+Z6[P],d+=ne}var oe=y[Km(r,d)&Y],me=oe>>4;oe||mn(3),d+=oe&15;var K=ez[me];if(me>3){var ne=X6[me];K+=Km(r,d)&(1<<ne)-1,d+=ne}if(d>A){u&&mn(0);break}l&&c(v+131072);var ye=v+ee;if(v<K){var ve=s-K,re=Math.min(K,ye);for(ve+v<0&&mn(3);v<re;++v)n[v]=i[ve+v]}for(;v<ye;++v)n[v]=n[v-K]}}e.l=m,e.p=Z,e.b=v,e.f=h,m&&(h=1,e.m=b,e.d=y,e.n=x)}while(!h);return v!=n.length&&o?Nd(n,0,v):n.subarray(0,v)},iz=new Gr(0),eT=function(r){(r[0]!=31||r[1]!=139||r[2]!=8)&&mn(6,"invalid gzip data");var e=r[3],n=10;e&4&&(n+=(r[10]|r[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!r[n++]);return n+(e&2)},az=function(r){var e=r.length;return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0},sz=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&mn(6,"invalid zlib data"),(r[1]>>5&1)==1&&mn(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2},Xm=(function(){function r(e,n){typeof e=="function"&&(n=e,e={}),this.ondata=n;var i=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:i?i.length:0},this.o=new Gr(32768),this.p=new Gr(0),i&&this.o.set(i)}return r.prototype.e=function(e){if(this.ondata||mn(5),this.d&&mn(4),!this.p.length)this.p=e;else if(e.length){var n=new Gr(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length),this.p=n}},r.prototype.c=function(e){this.s.i=+(this.d=e||!1);var n=this.s.b,i=L0(this.p,this.s,this.o);this.ondata(Nd(i,n,this.s.b),this.d),this.o=Nd(i,this.s.b-32768),this.s.b=this.o.length,this.p=Nd(this.p,this.s.p/8|0),this.s.p&=7},r.prototype.push=function(e,n){this.e(e),this.c(n)},r})();function oz(r,e){return L0(r,{i:2},e,e)}var lz=(function(){function r(e,n){this.v=1,this.r=0,Xm.call(this,e,n)}return r.prototype.push=function(e,n){if(Xm.prototype.e.call(this,e),this.r+=e.length,this.v){var i=this.p.subarray(this.v-1),a=i.length>3?eT(i):4;if(a>i.length){if(!n)return}else this.v>1&&this.onmember&&this.onmember(this.r-i.length);this.p=i.subarray(a),this.v=0}Xm.prototype.c.call(this,n),this.s.f&&!this.s.l&&!n&&(this.v=$6(this.s.p)+9,this.s={i:0},this.o=new Gr(0),this.push(new Gr(0),n))},r})();function uz(r,e){var n=eT(r);return n+8>r.length&&mn(6,"invalid gzip data"),L0(r.subarray(n,-8),{i:2},new Gr(az(r)),e)}function cz(r,e){return L0(r.subarray(sz(r),-4),{i:2},e,e)}function fz(r,e){return r[0]==31&&r[1]==139&&r[2]==8?uz(r,e):(r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31?oz(r,e):cz(r,e)}var hz=typeof TextDecoder<"u"&&new TextDecoder,dz=0;try{hz.decode(iz,{stream:!0}),dz=1}catch{}class tT{esize;ecode;edata;littleEndian;constructor(e,n,i,a){if(e%16!=0)throw new Error("This does not appear to be a NIFTI extension");this.esize=e,this.ecode=n,this.edata=i,this.littleEndian=a}toArrayBuffer(){let e=new Uint8Array(this.esize),n=new Uint8Array(this.edata);e.set(n,8);let i=new DataView(e.buffer);return i.setInt32(0,this.esize,this.littleEndian),i.setInt32(4,this.ecode,this.littleEndian),e.buffer}}class Te{static crcTable=null;static GUNZIP_MAGIC_COOKIE1=31;static GUNZIP_MAGIC_COOKIE2=139;static getStringAt(e,n,i){var a="",s,o;for(s=n;s<i;s+=1)o=e.getUint8(s),o!==0&&(a+=String.fromCharCode(o));return a}static getByteAt=function(e,n){return e.getUint8(n)};static getShortAt=function(e,n,i){return e.getInt16(n,i)};static getIntAt(e,n,i){return e.getInt32(n,i)}static getFloatAt(e,n,i){return e.getFloat32(n,i)}static getDoubleAt(e,n,i){return e.getFloat64(n,i)}static getInt64At(e,n,i){const a=e.getUint32(n,i),s=e.getInt32(n+4,i);let o;return i?o=s*2**32+a:o=a*2**32+s,s<0&&(o+=-1*2**32*2**32),o}static getUint64At(e,n,i){const a=e.getUint32(n+(i?0:4),i),s=e.getUint32(n+(i?4:0),i);return i?s*2**32+a:a*2**32+s}static getExtensionsAt(e,n,i,a){let s=[],o=n;for(;o<a;){let l=i,u=Te.getIntAt(e,o,i);if(!u)break;if(u+o>a&&(l=!l,u=Te.getIntAt(e,o,l),u+o>a))throw new Error("This does not appear to be a valid NIFTI extension");if(u%16!=0)throw new Error("This does not appear to be a NIFTI extension");let c=Te.getIntAt(e,o+4,l),h=e.buffer.slice(o+8,o+u),d=new tT(u,c,h,l);s.push(d),o+=u}return s}static toArrayBuffer(e){var n,i,a;for(n=new ArrayBuffer(e.length),i=new Uint8Array(n),a=0;a<e.length;a+=1)i[a]=e[a];return n}static isString(e){return typeof e=="string"||e instanceof String}static formatNumber(e,n=void 0){let i;return Te.isString(e)?i=Number(e):i=e,n?i=i.toPrecision(5):i=i.toPrecision(7),parseFloat(i)}static makeCRCTable(){let e,n=[];for(var i=0;i<256;i++){e=i;for(var a=0;a<8;a++)e=e&1?3988292384^e>>>1:e>>>1;n[i]=e}return n}static crc32(e){Te.crcTable||(Te.crcTable=Te.makeCRCTable());const n=Te.crcTable;let i=-1;for(var a=0;a<e.byteLength;a++)i=i>>>8^n[(i^e.getUint8(a))&255];return(i^-1)>>>0}}class Ne{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_a=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];qfac=1;quatern_R;magic="0";isHDR=!1;extensionFlag=[0,0,0,0];extensionSize=0;extensionCode=0;extensions=[];static TYPE_NONE=0;static TYPE_BINARY=1;static TYPE_UINT8=2;static TYPE_INT16=4;static TYPE_INT32=8;static TYPE_FLOAT32=16;static TYPE_COMPLEX64=32;static TYPE_FLOAT64=64;static TYPE_RGB24=128;static TYPE_INT8=256;static TYPE_UINT16=512;static TYPE_UINT32=768;static TYPE_INT64=1024;static TYPE_UINT64=1280;static TYPE_FLOAT128=1536;static TYPE_COMPLEX128=1792;static TYPE_COMPLEX256=2048;static XFORM_UNKNOWN=0;static XFORM_SCANNER_ANAT=1;static XFORM_ALIGNED_ANAT=2;static XFORM_TALAIRACH=3;static XFORM_MNI_152=4;static SPATIAL_UNITS_MASK=7;static TEMPORAL_UNITS_MASK=56;static UNITS_UNKNOWN=0;static UNITS_METER=1;static UNITS_MM=2;static UNITS_MICRON=3;static UNITS_SEC=8;static UNITS_MSEC=16;static UNITS_USEC=24;static UNITS_HZ=32;static UNITS_PPM=40;static UNITS_RADS=48;static MAGIC_COOKIE=348;static STANDARD_HEADER_SIZE=348;static MAGIC_NUMBER_LOCATION=344;static MAGIC_NUMBER=[110,43,49];static MAGIC_NUMBER2=[110,105,49];static EXTENSION_HEADER_SIZE=8;readHeader(e){var n=new DataView(e),i=Te.getIntAt(n,0,this.littleEndian),a,s,o,l;if(i!==Ne.MAGIC_COOKIE&&(this.littleEndian=!0,i=Te.getIntAt(n,0,this.littleEndian)),i!==Ne.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=Te.getByteAt(n,39),a=0;a<8;a+=1)l=40+a*2,this.dims[a]=Te.getShortAt(n,l,this.littleEndian);for(this.intent_p1=Te.getFloatAt(n,56,this.littleEndian),this.intent_p2=Te.getFloatAt(n,60,this.littleEndian),this.intent_p3=Te.getFloatAt(n,64,this.littleEndian),this.intent_code=Te.getShortAt(n,68,this.littleEndian),this.datatypeCode=Te.getShortAt(n,70,this.littleEndian),this.numBitsPerVoxel=Te.getShortAt(n,72,this.littleEndian),this.slice_start=Te.getShortAt(n,74,this.littleEndian),a=0;a<8;a+=1)l=76+a*4,this.pixDims[a]=Te.getFloatAt(n,l,this.littleEndian);if(this.vox_offset=Te.getFloatAt(n,108,this.littleEndian),this.scl_slope=Te.getFloatAt(n,112,this.littleEndian),this.scl_inter=Te.getFloatAt(n,116,this.littleEndian),this.slice_end=Te.getShortAt(n,120,this.littleEndian),this.slice_code=Te.getByteAt(n,122),this.xyzt_units=Te.getByteAt(n,123),this.cal_max=Te.getFloatAt(n,124,this.littleEndian),this.cal_min=Te.getFloatAt(n,128,this.littleEndian),this.slice_duration=Te.getFloatAt(n,132,this.littleEndian),this.toffset=Te.getFloatAt(n,136,this.littleEndian),this.description=Te.getStringAt(n,148,228),this.aux_file=Te.getStringAt(n,228,252),this.qform_code=Te.getShortAt(n,252,this.littleEndian),this.sform_code=Te.getShortAt(n,254,this.littleEndian),this.quatern_b=Te.getFloatAt(n,256,this.littleEndian),this.quatern_c=Te.getFloatAt(n,260,this.littleEndian),this.quatern_d=Te.getFloatAt(n,264,this.littleEndian),this.quatern_a=Math.sqrt(1-(Math.pow(this.quatern_b,2)+Math.pow(this.quatern_c,2)+Math.pow(this.quatern_d,2))),this.qoffset_x=Te.getFloatAt(n,268,this.littleEndian),this.qoffset_y=Te.getFloatAt(n,272,this.littleEndian),this.qoffset_z=Te.getFloatAt(n,276,this.littleEndian),this.qform_code<1&&this.sform_code<1&&(this.affine[0][0]=this.pixDims[1],this.affine[1][1]=this.pixDims[2],this.affine[2][2]=this.pixDims[3]),this.qform_code>0&&this.sform_code<this.qform_code){const u=this.quatern_a,c=this.quatern_b,h=this.quatern_c,d=this.quatern_d;for(this.qfac=this.pixDims[0]===0?1:this.pixDims[0],this.quatern_R=[[u*u+c*c-h*h-d*d,2*c*h-2*u*d,2*c*d+2*u*h],[2*c*h+2*u*d,u*u+h*h-c*c-d*d,2*h*d-2*u*c],[2*c*d-2*u*h,2*h*d+2*u*c,u*u+d*d-h*h-c*c]],s=0;s<3;s+=1)for(o=0;o<3;o+=1)this.affine[s][o]=this.quatern_R[s][o]*this.pixDims[o+1],o===2&&(this.affine[s][o]*=this.qfac);this.affine[0][3]=this.qoffset_x,this.affine[1][3]=this.qoffset_y,this.affine[2][3]=this.qoffset_z}else if(this.sform_code>0)for(s=0;s<3;s+=1)for(o=0;o<4;o+=1)l=280+(s*4+o)*4,this.affine[s][o]=Te.getFloatAt(n,l,this.littleEndian);if(this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=Te.getStringAt(n,328,344),this.magic=Te.getStringAt(n,344,348),this.isHDR=this.magic===String.fromCharCode.apply(null,Ne.MAGIC_NUMBER2),n.byteLength>Ne.MAGIC_COOKIE){this.extensionFlag[0]=Te.getByteAt(n,348),this.extensionFlag[1]=Te.getByteAt(n,349),this.extensionFlag[2]=Te.getByteAt(n,350),this.extensionFlag[3]=Te.getByteAt(n,351);let u=!0;!this.isHDR&&this.vox_offset<=352&&(u=!1),n.byteLength<=368&&(u=!1),u&&this.extensionFlag[0]&&(this.extensions=Te.getExtensionsAt(n,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode)}}toFormattedString(){var e=Te.formatNumber,n="";return n+="Dim Info = "+this.dim_info+`
`,n+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,n+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,n+="Intent Code = "+this.intent_code+`
`,n+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,n+="Bits Per Voxel = "+this.numBitsPerVoxel+`
`,n+="Slice Start = "+this.slice_start+`
`,n+="Voxel Dimensions (1-8): "+e(this.pixDims[0])+", "+e(this.pixDims[1])+", "+e(this.pixDims[2])+", "+e(this.pixDims[3])+", "+e(this.pixDims[4])+", "+e(this.pixDims[5])+", "+e(this.pixDims[6])+", "+e(this.pixDims[7])+`
`,n+="Image Offset = "+this.vox_offset+`
`,n+="Data Scale:  Slope = "+e(this.scl_slope)+"  Intercept = "+e(this.scl_inter)+`
`,n+="Slice End = "+this.slice_end+`
`,n+="Slice Code = "+this.slice_code+`
`,n+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(Ne.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(Ne.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,n+="Display Range:  Max = "+e(this.cal_max)+"  Min = "+e(this.cal_min)+`
`,n+="Slice Duration = "+this.slice_duration+`
`,n+="Time Axis Shift = "+this.toffset+`
`,n+='Description: "'+this.description+`"
`,n+='Auxiliary File: "'+this.aux_file+`"
`,n+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,n+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,n+="Quaternion Parameters:  b = "+e(this.quatern_b)+"  c = "+e(this.quatern_c)+"  d = "+e(this.quatern_d)+`
`,n+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,n+="S-Form Parameters X: "+e(this.affine[0][0])+", "+e(this.affine[0][1])+", "+e(this.affine[0][2])+", "+e(this.affine[0][3])+`
`,n+="S-Form Parameters Y: "+e(this.affine[1][0])+", "+e(this.affine[1][1])+", "+e(this.affine[1][2])+", "+e(this.affine[1][3])+`
`,n+="S-Form Parameters Z: "+e(this.affine[2][0])+", "+e(this.affine[2][1])+", "+e(this.affine[2][2])+", "+e(this.affine[2][3])+`
`,n+='Intent Name: "'+this.intent_name+`"
`,this.extensionFlag[0]&&(n+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+`
`),n}getDatatypeCodeString=function(e){return e===Ne.TYPE_UINT8?"1-Byte Unsigned Integer":e===Ne.TYPE_INT16?"2-Byte Signed Integer":e===Ne.TYPE_INT32?"4-Byte Signed Integer":e===Ne.TYPE_FLOAT32?"4-Byte Float":e===Ne.TYPE_FLOAT64?"8-Byte Float":e===Ne.TYPE_RGB24?"RGB":e===Ne.TYPE_INT8?"1-Byte Signed Integer":e===Ne.TYPE_UINT16?"2-Byte Unsigned Integer":e===Ne.TYPE_UINT32?"4-Byte Unsigned Integer":e===Ne.TYPE_INT64?"8-Byte Signed Integer":e===Ne.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"};getTransformCodeString=function(e){return e===Ne.XFORM_SCANNER_ANAT?"Scanner":e===Ne.XFORM_ALIGNED_ANAT?"Aligned":e===Ne.XFORM_TALAIRACH?"Talairach":e===Ne.XFORM_MNI_152?"MNI":"Unknown"};getUnitsCodeString=function(e){return e===Ne.UNITS_METER?"Meters":e===Ne.UNITS_MM?"Millimeters":e===Ne.UNITS_MICRON?"Microns":e===Ne.UNITS_SEC?"Seconds":e===Ne.UNITS_MSEC?"Milliseconds":e===Ne.UNITS_USEC?"Microseconds":e===Ne.UNITS_HZ?"Hz":e===Ne.UNITS_PPM?"PPM":e===Ne.UNITS_RADS?"Rads":"Unknown"};getQformMat(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])}convertNiftiQFormToNiftiSForm(e,n,i,a,s,o,l,u,c,h){var d=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],v,m=e,y=n,b=i,x,A,C;return d[3][0]=d[3][1]=d[3][2]=0,d[3][3]=1,v=1-(m*m+y*y+b*b),v<1e-7?(v=1/Math.sqrt(m*m+y*y+b*b),m*=v,y*=v,b*=v,v=0):v=Math.sqrt(v),x=l>0?l:1,A=u>0?u:1,C=c>0?c:1,h<0&&(C=-C),d[0][0]=(v*v+m*m-y*y-b*b)*x,d[0][1]=2*(m*y-v*b)*A,d[0][2]=2*(m*b+v*y)*C,d[1][0]=2*(m*y+v*b)*x,d[1][1]=(v*v+y*y-m*m-b*b)*A,d[1][2]=2*(y*b-v*m)*C,d[2][0]=2*(m*b-v*y)*x,d[2][1]=2*(y*b+v*m)*A,d[2][2]=(v*v+b*b-y*y-m*m)*C,d[0][3]=a,d[1][3]=s,d[2][3]=o,d}convertNiftiSFormToNEMA(e){var n,i,a,s,o,l,u,c,h,d,v,m,y,b,x,A,C,E,S,T,R,D,B,N,I,P,F,O,U,L,V,_,G,K;if(x=0,F=[[0,0,0],[0,0,0],[0,0,0]],O=[[0,0,0],[0,0,0],[0,0,0]],n=e[0][0],i=e[0][1],a=e[0][2],s=e[1][0],o=e[1][1],l=e[1][2],u=e[2][0],c=e[2][1],h=e[2][2],d=Math.sqrt(n*n+s*s+u*u),d===0||(n/=d,s/=d,u/=d,d=Math.sqrt(i*i+o*o+c*c),d===0))return null;if(i/=d,o/=d,c/=d,d=n*i+s*o+u*c,Math.abs(d)>1e-4){if(i-=d*n,o-=d*s,c-=d*u,d=Math.sqrt(i*i+o*o+c*c),d===0)return null;i/=d,o/=d,c/=d}if(d=Math.sqrt(a*a+l*l+h*h),d===0?(a=s*c-u*o,l=u*i-c*n,h=n*o-s*i):(a/=d,l/=d,h/=d),d=n*a+s*l+u*h,Math.abs(d)>1e-4){if(a-=d*n,l-=d*s,h-=d*u,d=Math.sqrt(a*a+l*l+h*h),d===0)return null;a/=d,l/=d,h/=d}if(d=i*a+o*l+c*h,Math.abs(d)>1e-4){if(a-=d*i,l-=d*o,h-=d*c,d=Math.sqrt(a*a+l*l+h*h),d===0)return null;a/=d,l/=d,h/=d}if(F[0][0]=n,F[0][1]=i,F[0][2]=a,F[1][0]=s,F[1][1]=o,F[1][2]=l,F[2][0]=u,F[2][1]=c,F[2][2]=h,v=this.nifti_mat33_determ(F),v===0)return null;for(P=-666,S=D=B=N=1,T=2,R=3,y=1;y<=3;y+=1)for(b=1;b<=3;b+=1)if(y!==b){for(x=1;x<=3;x+=1)if(!(y===x||b===x))for(O[0][0]=O[0][1]=O[0][2]=O[1][0]=O[1][1]=O[1][2]=O[2][0]=O[2][1]=O[2][2]=0,A=-1;A<=1;A+=2)for(C=-1;C<=1;C+=2)for(E=-1;E<=1;E+=2)O[0][y-1]=A,O[1][b-1]=C,O[2][x-1]=E,m=this.nifti_mat33_determ(O),m*v>0&&(I=this.nifti_mat33_mul(O,F),d=I[0][0]+I[1][1]+I[2][2],d>P&&(P=d,S=y,T=b,R=x,D=A,B=C,N=E))}switch(U=L=V=_=G=K="",S*D){case 1:U="X",_="+";break;case-1:U="X",_="-";break;case 2:U="Y",_="+";break;case-2:U="Y",_="-";break;case 3:U="Z",_="+";break;case-3:U="Z",_="-";break}switch(T*B){case 1:L="X",G="+";break;case-1:L="X",G="-";break;case 2:L="Y",G="+";break;case-2:L="Y",G="-";break;case 3:L="Z",G="+";break;case-3:L="Z",G="-";break}switch(R*N){case 1:V="X",K="+";break;case-1:V="X",K="-";break;case 2:V="Y",K="+";break;case-2:V="Y",K="-";break;case 3:V="Z",K="+";break;case-3:V="Z",K="-";break}return U+L+V+_+G+K}nifti_mat33_mul=function(e,n){var i=[[0,0,0],[0,0,0],[0,0,0]],a,s;for(a=0;a<3;a+=1)for(s=0;s<3;s+=1)i[a][s]=e[a][0]*n[0][s]+e[a][1]*n[1][s]+e[a][2]*n[2][s];return i};nifti_mat33_determ=function(e){var n,i,a,s,o,l,u,c,h;return n=e[0][0],i=e[0][1],a=e[0][2],s=e[1][0],o=e[1][1],l=e[1][2],u=e[2][0],c=e[2][1],h=e[2][2],n*o*h-n*c*l-s*i*h+s*c*a+u*i*l-u*o*a};getExtensionLocation(){return Ne.MAGIC_COOKIE+4}getExtensionSize(e){return Te.getIntAt(e,this.getExtensionLocation(),this.littleEndian)}getExtensionCode(e){return Te.getIntAt(e,this.getExtensionLocation()+4,this.littleEndian)}addExtension(e,n=-1){n==-1?this.extensions.push(e):this.extensions.splice(n,0,e),this.vox_offset+=e.esize}removeExtension(e){let n=this.extensions[e];n&&(this.vox_offset-=n.esize),this.extensions.splice(e,1)}toArrayBuffer(e=!1){let a=352;if(e)for(let u of this.extensions)a+=u.esize;let s=new Uint8Array(a),o=new DataView(s.buffer);o.setInt32(0,348,this.littleEndian),o.setUint8(39,this.dim_info);for(let u=0;u<8;u++)o.setUint16(40+2*u,this.dims[u],this.littleEndian);o.setFloat32(56,this.intent_p1,this.littleEndian),o.setFloat32(60,this.intent_p2,this.littleEndian),o.setFloat32(64,this.intent_p3,this.littleEndian),o.setInt16(68,this.intent_code,this.littleEndian),o.setInt16(70,this.datatypeCode,this.littleEndian),o.setInt16(72,this.numBitsPerVoxel,this.littleEndian),o.setInt16(74,this.slice_start,this.littleEndian);for(let u=0;u<8;u++)o.setFloat32(76+4*u,this.pixDims[u],this.littleEndian);o.setFloat32(108,this.vox_offset,this.littleEndian),o.setFloat32(112,this.scl_slope,this.littleEndian),o.setFloat32(116,this.scl_inter,this.littleEndian),o.setInt16(120,this.slice_end,this.littleEndian),o.setUint8(122,this.slice_code),o.setUint8(123,this.xyzt_units),o.setFloat32(124,this.cal_max,this.littleEndian),o.setFloat32(128,this.cal_min,this.littleEndian),o.setFloat32(132,this.slice_duration,this.littleEndian),o.setFloat32(136,this.toffset,this.littleEndian),s.set(new TextEncoder().encode(this.description),148),s.set(new TextEncoder().encode(this.aux_file),228),o.setInt16(252,this.qform_code,this.littleEndian),o.setInt16(254,this.sform_code,this.littleEndian),o.setFloat32(256,this.quatern_b,this.littleEndian),o.setFloat32(260,this.quatern_c,this.littleEndian),o.setFloat32(264,this.quatern_d,this.littleEndian),o.setFloat32(268,this.qoffset_x,this.littleEndian),o.setFloat32(272,this.qoffset_y,this.littleEndian),o.setFloat32(276,this.qoffset_z,this.littleEndian);const l=this.affine.flat();for(let u=0;u<12;u++)o.setFloat32(280+4*u,l[u],this.littleEndian);if(s.set(new TextEncoder().encode(this.intent_name),328),s.set(new TextEncoder().encode(this.magic),344),e){s.set(Uint8Array.from([1,0,0,0]),348);let u=this.getExtensionLocation();for(const c of this.extensions)o.setInt32(u,c.esize,c.littleEndian),o.setInt32(u+4,c.ecode,c.littleEndian),s.set(new Uint8Array(c.edata),u+8),u+=c.esize}else s.set(new Uint8Array(4).fill(0),348);return s.buffer}}class Wr{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];magic="0";extensionFlag=[0,0,0,0];extensions=[];extensionSize=0;extensionCode=0;static MAGIC_COOKIE=540;static MAGIC_NUMBER_LOCATION=4;static MAGIC_NUMBER=[110,43,50,0,13,10,26,10];static MAGIC_NUMBER2=[110,105,50,0,13,10,26,10];readHeader(e){var n=new DataView(e),i=Te.getIntAt(n,0,this.littleEndian),a,s,o,l;if(i!==Wr.MAGIC_COOKIE&&(this.littleEndian=!0,i=Te.getIntAt(n,0,this.littleEndian)),i!==Wr.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.magic=Te.getStringAt(n,4,12),this.datatypeCode=Te.getShortAt(n,12,this.littleEndian),this.numBitsPerVoxel=Te.getShortAt(n,14,this.littleEndian),a=0;a<8;a+=1)l=16+a*8,this.dims[a]=Te.getInt64At(n,l,this.littleEndian);for(this.intent_p1=Te.getDoubleAt(n,80,this.littleEndian),this.intent_p2=Te.getDoubleAt(n,88,this.littleEndian),this.intent_p3=Te.getDoubleAt(n,96,this.littleEndian),a=0;a<8;a+=1)l=104+a*8,this.pixDims[a]=Te.getDoubleAt(n,l,this.littleEndian);for(this.vox_offset=Te.getInt64At(n,168,this.littleEndian),this.scl_slope=Te.getDoubleAt(n,176,this.littleEndian),this.scl_inter=Te.getDoubleAt(n,184,this.littleEndian),this.cal_max=Te.getDoubleAt(n,192,this.littleEndian),this.cal_min=Te.getDoubleAt(n,200,this.littleEndian),this.slice_duration=Te.getDoubleAt(n,208,this.littleEndian),this.toffset=Te.getDoubleAt(n,216,this.littleEndian),this.slice_start=Te.getInt64At(n,224,this.littleEndian),this.slice_end=Te.getInt64At(n,232,this.littleEndian),this.description=Te.getStringAt(n,240,320),this.aux_file=Te.getStringAt(n,320,344),this.qform_code=Te.getIntAt(n,344,this.littleEndian),this.sform_code=Te.getIntAt(n,348,this.littleEndian),this.quatern_b=Te.getDoubleAt(n,352,this.littleEndian),this.quatern_c=Te.getDoubleAt(n,360,this.littleEndian),this.quatern_d=Te.getDoubleAt(n,368,this.littleEndian),this.qoffset_x=Te.getDoubleAt(n,376,this.littleEndian),this.qoffset_y=Te.getDoubleAt(n,384,this.littleEndian),this.qoffset_z=Te.getDoubleAt(n,392,this.littleEndian),s=0;s<3;s+=1)for(o=0;o<4;o+=1)l=400+(s*4+o)*8,this.affine[s][o]=Te.getDoubleAt(n,l,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=Te.getIntAt(n,496,this.littleEndian),this.xyzt_units=Te.getIntAt(n,500,this.littleEndian),this.intent_code=Te.getIntAt(n,504,this.littleEndian),this.intent_name=Te.getStringAt(n,508,524),this.dim_info=Te.getByteAt(n,524),n.byteLength>Wr.MAGIC_COOKIE&&(this.extensionFlag[0]=Te.getByteAt(n,540),this.extensionFlag[1]=Te.getByteAt(n,541),this.extensionFlag[2]=Te.getByteAt(n,542),this.extensionFlag[3]=Te.getByteAt(n,543),this.extensionFlag[0]&&(this.extensions=Te.getExtensionsAt(n,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode))}toFormattedString(){var e=Te.formatNumber,n="";return n+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+`)
`,n+="Bits Per Voxel =  = "+this.numBitsPerVoxel+`
`,n+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+`
`,n+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+`
`,n+="Voxel Dimensions (1-8): "+e(this.pixDims[0])+", "+e(this.pixDims[1])+", "+e(this.pixDims[2])+", "+e(this.pixDims[3])+", "+e(this.pixDims[4])+", "+e(this.pixDims[5])+", "+e(this.pixDims[6])+", "+e(this.pixDims[7])+`
`,n+="Image Offset = "+this.vox_offset+`
`,n+="Data Scale:  Slope = "+e(this.scl_slope)+"  Intercept = "+e(this.scl_inter)+`
`,n+="Display Range:  Max = "+e(this.cal_max)+"  Min = "+e(this.cal_min)+`
`,n+="Slice Duration = "+this.slice_duration+`
`,n+="Time Axis Shift = "+this.toffset+`
`,n+="Slice Start = "+this.slice_start+`
`,n+="Slice End = "+this.slice_end+`
`,n+='Description: "'+this.description+`"
`,n+='Auxiliary File: "'+this.aux_file+`"
`,n+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+`)
`,n+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+`)
`,n+="Quaternion Parameters:  b = "+e(this.quatern_b)+"  c = "+e(this.quatern_c)+"  d = "+e(this.quatern_d)+`
`,n+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+`
`,n+="S-Form Parameters X: "+e(this.affine[0][0])+", "+e(this.affine[0][1])+", "+e(this.affine[0][2])+", "+e(this.affine[0][3])+`
`,n+="S-Form Parameters Y: "+e(this.affine[1][0])+", "+e(this.affine[1][1])+", "+e(this.affine[1][2])+", "+e(this.affine[1][3])+`
`,n+="S-Form Parameters Z: "+e(this.affine[2][0])+", "+e(this.affine[2][1])+", "+e(this.affine[2][2])+", "+e(this.affine[2][3])+`
`,n+="Slice Code = "+this.slice_code+`
`,n+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(Ne.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(Ne.TEMPORAL_UNITS_MASK&this.xyzt_units)+`)
`,n+="Intent Code = "+this.intent_code+`
`,n+='Intent Name: "'+this.intent_name+`"
`,n+="Dim Info = "+this.dim_info+`
`,n}getExtensionLocation=function(){return Wr.MAGIC_COOKIE+4};getExtensionSize=Ne.prototype.getExtensionSize;getExtensionCode=Ne.prototype.getExtensionCode;addExtension=Ne.prototype.addExtension;removeExtension=Ne.prototype.removeExtension;getDatatypeCodeString=Ne.prototype.getDatatypeCodeString;getTransformCodeString=Ne.prototype.getTransformCodeString;getUnitsCodeString=Ne.prototype.getUnitsCodeString;getQformMat=Ne.prototype.getQformMat;convertNiftiQFormToNiftiSForm=Ne.prototype.convertNiftiQFormToNiftiSForm;convertNiftiSFormToNEMA=Ne.prototype.convertNiftiSFormToNEMA;nifti_mat33_mul=Ne.prototype.nifti_mat33_mul;nifti_mat33_determ=Ne.prototype.nifti_mat33_determ;toArrayBuffer(e=!1){let a=544;if(e)for(let u of this.extensions)a+=u.esize;let s=new Uint8Array(a),o=new DataView(s.buffer);o.setInt32(0,540,this.littleEndian),s.set(new TextEncoder().encode(this.magic),4),o.setInt16(12,this.datatypeCode,this.littleEndian),o.setInt16(14,this.numBitsPerVoxel,this.littleEndian);for(let u=0;u<8;u++)o.setBigInt64(16+8*u,BigInt(this.dims[u]),this.littleEndian);o.setFloat64(80,this.intent_p1,this.littleEndian),o.setFloat64(88,this.intent_p2,this.littleEndian),o.setFloat64(96,this.intent_p3,this.littleEndian);for(let u=0;u<8;u++)o.setFloat64(104+8*u,this.pixDims[u],this.littleEndian);o.setBigInt64(168,BigInt(this.vox_offset),this.littleEndian),o.setFloat64(176,this.scl_slope,this.littleEndian),o.setFloat64(184,this.scl_inter,this.littleEndian),o.setFloat64(192,this.cal_max,this.littleEndian),o.setFloat64(200,this.cal_min,this.littleEndian),o.setFloat64(208,this.slice_duration,this.littleEndian),o.setFloat64(216,this.toffset,this.littleEndian),o.setBigInt64(224,BigInt(this.slice_start),this.littleEndian),o.setBigInt64(232,BigInt(this.slice_end),this.littleEndian),s.set(new TextEncoder().encode(this.description),240),s.set(new TextEncoder().encode(this.aux_file),320),o.setInt32(344,this.qform_code,this.littleEndian),o.setInt32(348,this.sform_code,this.littleEndian),o.setFloat64(352,this.quatern_b,this.littleEndian),o.setFloat64(360,this.quatern_c,this.littleEndian),o.setFloat64(368,this.quatern_d,this.littleEndian),o.setFloat64(376,this.qoffset_x,this.littleEndian),o.setFloat64(384,this.qoffset_y,this.littleEndian),o.setFloat64(392,this.qoffset_z,this.littleEndian);const l=this.affine.flat();for(let u=0;u<12;u++)o.setFloat64(400+8*u,l[u],this.littleEndian);if(o.setInt32(496,this.slice_code,this.littleEndian),o.setInt32(500,this.xyzt_units,this.littleEndian),o.setInt32(504,this.intent_code,this.littleEndian),s.set(new TextEncoder().encode(this.intent_name),508),o.setUint8(524,this.dim_info),e){s.set(Uint8Array.from([1,0,0,0]),540);let u=this.getExtensionLocation();for(const c of this.extensions)o.setInt32(u,c.esize,c.littleEndian),o.setInt32(u+4,c.ecode,c.littleEndian),s.set(new Uint8Array(c.edata),u+8),u+=c.esize}else s.set(new Uint8Array(4).fill(0),540);return s.buffer}}function gz(r,e=!1){var n,i,a,s;return r.byteLength<Ne.STANDARD_HEADER_SIZE?!1:(n=new DataView(r),n&&(i=n.getUint8(Ne.MAGIC_NUMBER_LOCATION)),a=n.getUint8(Ne.MAGIC_NUMBER_LOCATION+1),s=n.getUint8(Ne.MAGIC_NUMBER_LOCATION+2),e&&i===Ne.MAGIC_NUMBER2[0]&&a===Ne.MAGIC_NUMBER2[1]&&s===Ne.MAGIC_NUMBER2[2]?!0:i===Ne.MAGIC_NUMBER[0]&&a===Ne.MAGIC_NUMBER[1]&&s===Ne.MAGIC_NUMBER[2])}function vz(r,e=!1){var n,i,a,s;return r.byteLength<Ne.STANDARD_HEADER_SIZE?!1:(n=new DataView(r),i=n.getUint8(Wr.MAGIC_NUMBER_LOCATION),a=n.getUint8(Wr.MAGIC_NUMBER_LOCATION+1),s=n.getUint8(Wr.MAGIC_NUMBER_LOCATION+2),e&&i===Wr.MAGIC_NUMBER2[0]&&a===Wr.MAGIC_NUMBER2[1]&&s===Wr.MAGIC_NUMBER2[2]?!0:i===Wr.MAGIC_NUMBER[0]&&a===Wr.MAGIC_NUMBER[1]&&s===Wr.MAGIC_NUMBER[2])}function ay(r){var e,n,i;return!!(r&&(e=new DataView(r),n=e.getUint8(0),i=e.getUint8(1),n===Te.GUNZIP_MAGIC_COOKIE1||i===Te.GUNZIP_MAGIC_COOKIE2))}function mz(r){return fz(new Uint8Array(r)).buffer}async function pz(r){const e=new Uint8Array(r),n=e[0]===31&&e[1]===139&&e[2]===8?"gzip":e[0]===120&&(e[1]===1||e[1]===94||e[1]===156||e[1]===218)?"deflate":"deflate-raw",i=new DecompressionStream(n),a=i.writable.getWriter();a.write(e).catch(console.error);const s=a.close().catch(console.error),l=await new Response(i.readable).arrayBuffer();return await s,l}async function rC(r,e=1/0){const n=m=>m[0]===31&&m[1]===139&&m[2]===8?"gzip":m[0]===120&&[1,94,156,218].includes(m[1])?"deflate":"deflate-raw",i=new Uint8Array(r),a=n(i),s=new DecompressionStream(a),o=new TransformStream({transform(m,y){y.enqueue(m)},flush(m){m.terminate()}}),{readable:l,writable:u}=s,c=u.getWriter(),h=l.pipeThrough(o).getReader();c.write(i).catch(m=>{m instanceof Error&&m.name==="AbortError"||console.error("Error during write:",m)});const d=[];let v=0;try{for(;v<e;){const{done:m,value:y}=await h.read();if(m)break;const b=e-v,x=y.subarray(0,Math.min(y.length,b));if(d.push(x),v+=x.length,v>=e){await Promise.all([h.cancel().catch(()=>{}),c.abort().catch(()=>{})]);break}}}catch(m){m instanceof Error&&m.name==="AbortError"||console.error("Error during decompression:",m)}finally{await Promise.allSettled([h.cancel().catch(()=>{}),c.close().catch(()=>{})])}return d.length===1?d[0].buffer:d.reduce((m,y)=>{const b=new Uint8Array(m.byteLength+y.byteLength);return b.set(new Uint8Array(m),0),b.set(y,m.byteLength),b.buffer},new ArrayBuffer(0))}function yz(r,e=!1){let n=null;if(ay(r)&&(r=mz(r)),gz(r,e)?n=new Ne:vz(r,e)&&(n=new Wr),n)n.readHeader(r);else throw new Error("That file does not appear to be NIFTI!");return n}async function xc(r,e=!1){if(!ay(r))return yz(r,e);let n=null,i=await rC(r,540),a=!0,s=!0;var o=new DataView(i);const l=o.getInt32(0,!0),u=o.getInt32(0,!1);if(l!==348)if(u===348)a=!1;else if(l===540)s=!1;else if(u===540)s=!1,a=!1;else throw new Error("That file does not appear to be NIFTI!");let c=Math.round(o.getFloat32(108,a));return Wr&&(c=Te.getUint64At(o,168,a)),c>i.byteLength&&(i=await rC(r,c)),s?n=new Ne:n=new Wr,n.readHeader(i),n}function Az(r){return r.extensionFlag[0]!=0}function xz(r,e){var n=r.vox_offset,i=1,a=1;r.dims[4]&&(i=r.dims[4]),r.dims[5]&&(a=r.dims[5]);var s=r.dims[1]*r.dims[2]*r.dims[3]*i*a*(r.numBitsPerVoxel/8);return e.slice(n,n+s)}function rT(r,e,n,i={}){return e!==void 0&&n!==void 0&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+n-1}`}}),fetch(r,i)}function bz(r,e){return{...r,...e,headers:{...r.headers,...e.headers}}}function nC(r,e){const n=typeof r=="string"?new URL(r):r;n.pathname.endsWith("/")||(n.pathname+="/");const i=new URL(e.slice(1),n);return i.search=n.search,i}async function iC(r){if(r.status!==404){if(r.status===200||r.status===206)return new Uint8Array(await r.arrayBuffer());throw new Error(`Unexpected response status ${r.status} ${r.statusText}`)}}async function wz(r,e,n,i){if(i)return fetch(r,{...n,headers:{...n.headers,Range:`bytes=-${e}`}});let a=await fetch(r,{...n,method:"HEAD"});if(!a.ok)return a;let s=a.headers.get("Content-Length"),o=Number(s);return rT(r,o-e,o,n)}class Cz{url;#e;#t;constructor(e,n={}){this.url=e,this.#e=n.overrides??{},this.#t=n.useSuffixRequest??!1}#r(e){return bz(this.#e,e)}async get(e,n={}){let i=nC(this.url,e).href,a=await fetch(i,this.#r(n));return iC(a)}async getRange(e,n,i={}){let a=nC(this.url,e),s=this.#r(i),o;return"suffixLength"in n?o=await wz(a,n.suffixLength,s,this.#t):o=await rT(a,n.offset,n.length,s),iC(o)}}const Ez="modulepreload",Sz=function(r){return"/"+r},aC={},Qm=function(e,n,i){let a=Promise.resolve();if(n&&n.length>0){let c=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};var o=c;document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");a=c(n.map(h=>{if(h=Sz(h),h in aC)return;aC[h]=!0;const d=h.endsWith(".css"),v=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${v}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":Ez,d||(m.as="script"),m.crossOrigin="",m.href=h,u&&m.setAttribute("nonce",u),document.head.appendChild(m),d)return new Promise((y,b)=>{m.addEventListener("load",y),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return a.then(l=>{for(const u of l||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})};class nT{#e;constructor(e,n,i){typeof e=="number"?this.#e=new Uint8Array(e):e instanceof ArrayBuffer?this.#e=new Uint8Array(e,n,i):this.#e=new Uint8Array(Array.from(e,a=>a?1:0))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return this.#e.byteOffset}get byteLength(){return this.#e.byteLength}get buffer(){return this.#e.buffer}get length(){return this.#e.length}get(e){let n=this.#e[e];return typeof n=="number"?n!==0:n}set(e,n){this.#e[e]=n?1:0}fill(e){this.#e.fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}class sy{_data;chars;#e;constructor(e,n,i,a){if(this.chars=e,this.#e=new TextEncoder,typeof n=="number")this._data=new Uint8Array(n*e);else if(n instanceof ArrayBuffer)a&&(a=a*e),this._data=new Uint8Array(n,i,a);else{let s=Array.from(n);this._data=new Uint8Array(s.length*e);for(let o=0;o<s.length;o++)this.set(o,s[o])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return new TextDecoder().decode(n).replace(/\x00/g,"")}set(e,n){const i=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);i.fill(0),i.set(this.#e.encode(n))}fill(e){const n=this.#e.encode(e);for(let i=0;i<this.length;i++)this._data.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}class pf{#e;chars;constructor(e,n,i,a){if(this.chars=e,typeof n=="number")this.#e=new Int32Array(n*e);else if(n instanceof ArrayBuffer)a&&(a*=e),this.#e=new Int32Array(n,i,a);else{const s=n,o=new pf(e,1);this.#e=new Int32Array((function*(){for(let l of s)o.set(0,l),yield*o.#e})())}}get BYTES_PER_ELEMENT(){return this.#e.BYTES_PER_ELEMENT*this.chars}get byteLength(){return this.#e.byteLength}get byteOffset(){return this.#e.byteOffset}get buffer(){return this.#e.buffer}get length(){return this.#e.length/this.chars}get(e){const n=this.chars*e;let i="";for(let a=0;a<this.chars;a++)i+=String.fromCodePoint(this.#e[n+a]);return i.replace(/\u0000/g,"")}set(e,n){const i=this.chars*e,a=this.#e.subarray(i,i+this.chars);a.fill(0);for(let s=0;s<this.chars;s++)a[s]=n.codePointAt(s)??0}fill(e){this.set(0,e);let n=this.#e.subarray(0,this.chars);for(let i=1;i<this.length;i++)this.#e.set(n,i*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}function yf(r){const e=new TextDecoder().decode(r);return JSON.parse(e)}function sC(r,e){const n=e/2,i=e-1;let a=0;for(let s=0;s<r.length;s+=e)for(let o=0;o<n;o+=1)a=r[s+o],r[s+o]=r[s+i-o],r[s+i-o]=a}function iT(r){if(r==="v2:object")return globalThis.Array;let e=r.match(/v2:([US])(\d+)/);if(e){let[,i,a]=e;return(i==="U"?pf:sy).bind(null,Number(a))}let n={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:nT}[r];return kr(n,`Unknown or unsupported data_type: ${r}`),n}function yo(r,e){const n=r.length;typeof e=="string"&&(e=e==="C"?Array.from({length:n},(s,o)=>o):Array.from({length:n},(s,o)=>n-1-o)),kr(n===e.length,"Order length must match the number of dimensions.");let i=1,a=new Array(n);for(let s=e.length-1;s>=0;s--)a[e[s]]=i,i*=r[e[s]];return a}function Tz({name:r,configuration:e}){if(r==="default"){const n=e?.separator??"/";return i=>["c",...i].join(n)}if(r==="v2"){const n=e?.separator??".";return i=>i.join(n)||"0"}throw new Error(`Unknown chunk key encoding: ${r}`)}function Mz(r){if(r==="|O")return{data_type:"v2:object"};let e=r.match(/^([<|>])(.*)$/);kr(e,`Invalid dtype: ${r}`);let[,n,i]=e,a={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);return kr(a,`Unsupported or unknown dtype: ${r}`),n==="|"?{data_type:a}:{data_type:a,endian:n==="<"?"little":"big"}}function Dz(r,e={}){let n=[],i=Mz(r.dtype);r.order==="F"&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&i.endian==="big"&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:a,...s}of r.filters??[])n.push({name:a,configuration:s});if(r.compressor){let{id:a,...s}=r.compressor;n.push({name:a,configuration:s})}return{zarr_format:3,node_type:"array",shape:r.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:r.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:r.dimension_separator??"."}},codecs:n,fill_value:r.fill_value,attributes:e}}function Rz(r,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function Bz(r,e){if(e!=="number"&&e!=="bigint"&&e!=="boolean"&&e!=="object"&&e!=="string")return r===e;let n=r==="bool";if(e==="boolean")return n;let i=r.startsWith("v2:U")||r.startsWith("v2:S");if(e==="string")return i;let a=r==="int64"||r==="uint64";if(e==="bigint")return a;let s=r==="v2:object";return e==="object"?s:!i&&!a&&!n&&!s}function Iz(r){return r?.name==="sharding_indexed"}function aT(r){return(r.data_type==="uint64"||r.data_type==="int64")&&r.fill_value!=null?BigInt(r.fill_value):r.fill_value}function sT(r,...e){if(!e.some(n=>r instanceof n))throw r}function kr(r,e=""){if(!r)throw new Error(e)}async function oT(r,{format:e,signal:n}){const i=r instanceof Response?r:new Response(r);kr(i.body,"Response does not contain body.");try{return await new Response(i.body.pipeThrough(new DecompressionStream(e),{signal:n})).arrayBuffer()}catch{throw n?.throwIfAborted(),new Error(`Failed to decode ${e}`)}}class oy{kind="array_to_array";constructor(e,n){kr(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,n){return new oy(e,n)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const oC=Nz();function Nz(){const r=new Uint32Array([305419896]);return new Uint8Array(r.buffer,r.byteOffset,r.byteLength)[0]!==18}function lC(r){return"BYTES_PER_ELEMENT"in r?r.BYTES_PER_ELEMENT:4}class _0{kind="array_to_bytes";#e;#t;#r;#i;#n;constructor(e,n){this.#n=e?.endian,this.#t=iT(n.data_type),this.#i=n.shape,this.#e=yo(n.shape,"C");const i=new this.#t(0);this.#r=i.BYTES_PER_ELEMENT}static fromConfig(e,n){return new _0(e,n)}encode(e){let n=new Uint8Array(e.data.buffer);return oC&&this.#n==="big"&&sC(n,lC(this.#t)),n}decode(e){return oC&&this.#n==="big"&&sC(e,lC(this.#t)),{data:new this.#t(e.buffer,e.byteOffset,e.byteLength/this.#r),shape:this.#i,stride:this.#e}}}class ly{kind="bytes_to_bytes";static fromConfig(){return new ly}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}class uy{kind="bytes_to_bytes";static fromConfig(e){return new uy}encode(e){throw new Error("Gzip encoding is not enabled by default. Please register a custom codec with `numcodecs/gzip`.")}async decode(e){const n=await oT(e,{format:"gzip"});return new Uint8Array(n)}}function Fz(r,e){return kr(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),kr(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),kr(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function kz(r,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce((n,i)=>(n[i]=e[i],n),{}):e}class cy{configuration;kind="array_to_bytes";#e;#t;constructor(e={}){this.configuration=e;const{encoding:n="utf-8",skipkeys:i=!1,ensure_ascii:a=!0,check_circular:s=!0,allow_nan:o=!0,sort_keys:l=!0,indent:u,strict:c=!0}=e;let h=e.separators;h||(u?h=[", ",": "]:h=[",",":"]),this.#e={encoding:n,skipkeys:i,ensure_ascii:a,check_circular:s,allow_nan:o,indent:u,separators:h,sort_keys:l},this.#t={strict:c}}static fromConfig(e){return new cy(e)}encode(e){const{indent:n,encoding:i,ensure_ascii:a,check_circular:s,allow_nan:o,sort_keys:l}=this.#e;kr(i==="utf-8","JsonCodec does not yet support non-utf-8 encoding.");const u=[];kr(s,"JsonCodec does not yet support skipping the check for circular references during encoding."),o||u.push(Fz),l&&u.push(kz);const c=Array.from(e.data);c.push("|O"),c.push(e.shape);let h;u.length&&(h=(v,m)=>{let y=m;for(let b of u)y=b(v,y);return y});let d=JSON.stringify(c,h,n);return a&&(d=d.replace(/[\u007F-\uFFFF]/g,v=>{const m=`0000${v.charCodeAt(0).toString(16)}`;return`\\u${m.substring(m.length-4)}`})),new TextEncoder().encode(d)}decode(e){const{strict:n}=this.#t;kr(n,"JsonCodec does not yet support non-strict decoding.");const i=yf(e),a=i.pop();i.pop(),kr(a,"0D not implemented for JsonCodec.");const s=yo(a,"C");return{data:i,shape:a,stride:s}}}function uC(r){return r instanceof nT||r instanceof sy||r instanceof pf?new Proxy(r,{get(n,i){return n.get(Number(i))},set(n,i,a){return n.set(Number(i),a),!0}}):r}function Pz(r,e){let n;return r.data instanceof sy||r.data instanceof pf?n=new r.constructor(r.data.length,r.data.chars):n=new r.constructor(r.data.length),{data:n,shape:r.shape,stride:yo(r.shape,e)}}function Uz(r,e){let n=Pz(r,e),i=r.shape.length,a=r.data.length,s=Array(i).fill(0),o=uC(r.data),l=uC(n.data);for(let u=0;u<a;u++){let c=0;for(let h=0;h<i;h++)c+=s[h]*n.stride[h];l[c]=o[u],s[0]+=1;for(let h=0;h<i;h++)if(s[h]===r.shape[h]){if(h+1===i)break;s[h]=0,s[h+1]+=1}}return n}function Vz(r){let e=r.shape.length;return kr(e===r.stride.length,"Shape and stride must have the same length."),r.stride.map((n,i)=>({stride:n,index:i})).sort((n,i)=>i.stride-n.stride).map(n=>n.index)}function Oz(r,e){let n=Vz(r);return kr(n.length===e.length,"Orders must match"),n.every((i,a)=>i===e[a])}class fy{kind="array_to_array";#e;#t;constructor(e,n){let i=e.order??"C",a=n.shape.length,s=new Array(a),o=new Array(a);if(i==="C")for(let l=0;l<a;++l)s[l]=l,o[l]=l;else if(i==="F")for(let l=0;l<a;++l)s[l]=a-l-1,o[l]=a-l-1;else s=i,s.forEach((l,u)=>{kr(o[l]===void 0,`Invalid permutation: ${JSON.stringify(i)}`),o[l]=u});this.#e=s,this.#t=o}static fromConfig(e,n){return new fy(e,n)}encode(e){return Oz(e,this.#t)?e:Uz(e,this.#t)}decode(e){return{data:e.data,shape:e.shape,stride:yo(e.shape,this.#e)}}}class hy{kind="array_to_bytes";#e;#t;constructor(e){this.#e=e,this.#t=yo(e,"C")}static fromConfig(e,n){return new hy(n.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let n=new TextDecoder,i=new DataView(e.buffer),a=Array(i.getUint32(0,!0)),s=4;for(let o=0;o<a.length;o++){let l=i.getUint32(s,!0);s+=4,a[o]=n.decode(e.buffer.slice(s,s+l)),s+=l}return{data:a,shape:this.#e,stride:this.#t}}}class dy{kind="bytes_to_bytes";static fromConfig(e){return new dy}encode(e){throw new Error("Zlib encoding is not enabled by default. Please register a codec with `numcodecs/zlib`.")}async decode(e){const n=await oT(e,{format:"deflate"});return new Uint8Array(n)}}function Lz(){return new Map().set("blosc",()=>Qm(()=>import("./blosc-CrUiACa7.js"),__vite__mapDeps([0,1])).then(r=>r.default)).set("lz4",()=>Qm(()=>import("./lz4-B_Exjfmr.js"),__vite__mapDeps([2,1])).then(r=>r.default)).set("zstd",()=>Qm(()=>import("./zstd-u5eweWyS.js"),__vite__mapDeps([3,1])).then(r=>r.default)).set("gzip",()=>uy).set("zlib",()=>dy).set("transpose",()=>fy).set("bytes",()=>_0).set("crc32c",()=>ly).set("vlen-utf8",()=>hy).set("json2",()=>cy).set("bitround",()=>oy)}const _z=Lz();function e2(r){let e;return{async encode(n){e||(e=await cC(r));for(const a of e.array_to_array)n=await a.encode(n);let i=await e.array_to_bytes.encode(n);for(const a of e.bytes_to_bytes)i=await a.encode(i);return i},async decode(n){e||(e=await cC(r));for(let a=e.bytes_to_bytes.length-1;a>=0;a--)n=await e.bytes_to_bytes[a].decode(n);let i=await e.array_to_bytes.decode(n);for(let a=e.array_to_array.length-1;a>=0;a--)i=await e.array_to_array[a].decode(i);return i}}}async function cC(r){let e=r.codecs.map(async s=>{let o=await _z.get(s.name)?.();return kr(o,`Unknown codec: ${s.name}`),{Codec:o,meta:s}}),n=[],i,a=[];for await(let{Codec:s,meta:o}of e){let l=s.fromConfig(o.configuration,r);switch(l.kind){case"array_to_array":n.push(l);break;case"array_to_bytes":i=l;break;default:a.push(l)}}return i||(kr(zz(r),`Cannot encode ${r.data_type} to bytes without a codec`),i=_0.fromConfig({endian:"little"},r)),{array_to_array:n,array_to_bytes:i,bytes_to_bytes:a}}function zz(r){return r.data_type!=="v2:object"}class Af extends Error{constructor(e,n={}){super(`Node not found: ${e}`,n),this.name="NodeNotFoundError"}}class gy extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}const fC=18446744073709551615n;function qz(r,e,n,i){kr(r.store.getRange,"Store does not support range requests");let a=r.store.getRange.bind(r.store),s=e.map((u,c)=>u/i.chunk_shape[c]),o=e2({data_type:"uint64",shape:[...s,2],codecs:i.index_codecs}),l={};return async u=>{let c=u.map((C,E)=>Math.floor(C/s[E])),h=r.resolve(n(c)).path,d;if(h in l)d=l[h];else{let C=4,E=16*s.reduce((T,R)=>T*R,1),S=await a(h,{suffixLength:E+C});d=l[h]=S?await o.decode(S):null}if(d===null)return;let{data:v,shape:m,stride:y}=d,b=u.map((C,E)=>C%m[E]).reduce((C,E,S)=>C+E*y[S],0),x=v[b],A=v[b+1];if(!(x===fC&&A===fC))return a(h,{offset:Number(x),length:Number(A)})}}class wo{store;path;constructor(e,n="/"){this.store=e,this.path=n}resolve(e){let n=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new wo(this.store,new URL(e,n).pathname)}}function Gz(r){return new wo(r??new Map)}class vy extends wo{kind="group";#e;constructor(e,n,i){super(e,n),this.#e=i}get attrs(){return this.#e.attributes}}function hC(r){return r.find(n=>n.name==="transpose")?.configuration?.order??"C"}const bc=Symbol("zarrita.context");function Yz(r){return r[bc]}function Hz(r,e){let{configuration:n}=e.codecs.find(Iz)??{},i={encode_chunk_key:Tz(e.chunk_key_encoding),TypedArray:iT(e.data_type),fill_value:e.fill_value};if(n){let s=hC(n.codecs);return{...i,kind:"sharded",chunk_shape:n.chunk_shape,codec:e2({data_type:e.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides(o){return yo(o,s)},get_chunk_bytes:qz(r,e.chunk_grid.configuration.chunk_shape,i.encode_chunk_key,n)}}let a=hC(e.codecs);return{...i,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:e2({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides(s){return yo(s,a)},async get_chunk_bytes(s,o){let l=i.encode_chunk_key(s),u=r.resolve(l).path;return r.store.get(u,o)}}}let f0=class extends wo{kind="array";#e;[bc];constructor(e,n,i){super(e,n),this.#e={...i,fill_value:aT(i)},this[bc]=Hz(this,i)}get attrs(){return this.#e.attributes}get shape(){return this.#e.shape}get chunks(){return this[bc].chunk_shape}get dtype(){return this.#e.data_type}async getChunk(e,n){let i=this[bc],a=await i.get_chunk_bytes(e,n);if(!a){let s=i.chunk_shape.reduce((l,u)=>l*u,1),o=new i.TypedArray(s);return o.fill(i.fill_value),{data:o,shape:i.chunk_shape,stride:i.get_strides(i.chunk_shape)}}return i.codec.decode(a)}is(e){return Bz(this.dtype,e)}};function*jz(r,e,n=1){e===void 0&&(e=r,r=0);for(let i=r;i<e;i+=n)yield i}function*Kz(...r){if(r.length===0)return;const e=r.map(i=>i[Symbol.iterator]()),n=e.map(i=>i.next());if(n.some(i=>i.done))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(n[i].done){if(e[i]=r[i][Symbol.iterator](),n[i]=e[i].next(),++i>=e.length)return}else yield n.map(({value:a})=>a),i=0;n[i]=e[i].next()}}function Xz({start:r,stop:e,step:n},i){if(n===0)throw new Error("slice step cannot be zero");n=n??1;const a=n<0,[s,o]=a?[-1,i-1]:[0,i];return r===null?r=a?o:s:r<0?(r+=i,r<s&&(r=s)):r>o&&(r=o),e===null?e=a?s:o:e<0?(e+=i,e<s&&(e=s)):e>o&&(e=o),[r,e,n]}function Nc(r,e,n=null){return e===void 0&&(e=r,r=null),{start:r,stop:e,step:n}}function Qz(){const r=[];return{add:e=>r.push(e()),onIdle:()=>Promise.all(r)}}class my extends Error{constructor(e){super(e),this.name="IndexError"}}function Wz(r,e){throw new my(`too many indicies for array; expected ${e.length}, got ${r.length}`)}function Zz(r){throw new my(`index out of bounds for dimension with length ${r}`)}function Jz(){throw new my("only slices with step >= 1 are supported")}function $z(r,e){r.length>e.length&&Wz(r,e)}function eq(r,e){return r=Math.trunc(r),r<0&&(r=e+r),(r>=e||r<0)&&Zz(e),r}class tq{dim_sel;dim_len;dim_chunk_len;nitems;constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){e=eq(e,n),this.dim_sel=e,this.dim_len=n,this.dim_chunk_len=i,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),n=e*this.dim_chunk_len,i=this.dim_sel-n;yield{dim_chunk_ix:e,dim_chunk_sel:i}}}class dC{start;stop;step;dim_len;dim_chunk_len;nitems;nchunks;constructor({dim_sel:e,dim_len:n,dim_chunk_len:i}){const[a,s,o]=Xz(e,n);this.start=a,this.stop=s,this.step=o,this.step<1&&Jz(),this.dim_len=n,this.dim_chunk_len=i,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),n=Math.ceil(this.stop/this.dim_chunk_len);for(const i of jz(e,n)){const a=i*this.dim_chunk_len,s=Math.min(this.dim_len,(i+1)*this.dim_chunk_len),o=s-a;let l=0,u=0;if(this.start<a){const m=(a-this.start)%this.step;m&&(u+=this.step-m),l=Math.ceil((a-this.start)/this.step)}else u=this.start-a;const c=this.stop>s?o:this.stop-a,h=[u,c,this.step],d=Math.ceil((c-u)/this.step),v=[l,l+d,1];yield{dim_chunk_ix:i,dim_chunk_sel:h,dim_out_sel:v}}}}function rq(r,e){let n=[];return r===null?n=e.map(i=>Nc(null)):Array.isArray(r)&&(n=r.map(i=>i??Nc(null))),$z(n,e),n}class nq{dim_indexers;shape;constructor({selection:e,shape:n,chunk_shape:i}){this.dim_indexers=rq(e,n).map((a,s)=>new(typeof a=="number"?tq:dC)({dim_sel:a,dim_len:n[s],dim_chunk_len:i[s]})),this.shape=this.dim_indexers.filter(a=>a instanceof dC).map(a=>a.nitems)}*[Symbol.iterator](){for(const e of Kz(...this.dim_indexers)){const n=e.map(a=>a.dim_chunk_ix),i=e.map(a=>"dim_out_sel"in a?{from:a.dim_chunk_sel,to:a.dim_out_sel}:{from:a.dim_chunk_sel,to:null});yield{chunk_coords:n,mapping:i}}}}function iq(r,e){return"get"in r?r.get(e):r[e]}async function aq(r,e,n,i){let a=Yz(r),s=new nq({selection:e,shape:r.shape,chunk_shape:r.chunks}),o=i.prepare(new a.TypedArray(s.shape.reduce((u,c)=>u*c,1)),s.shape,a.get_strides(s.shape)),l=n.create_queue?.()??Qz();for(const{chunk_coords:u,mapping:c}of s)l.add(async()=>{let{data:h,shape:d,stride:v}=await r.getChunk(u,n.opts),m=i.prepare(h,d,v);i.set_from_chunk(o,m,c)});return await l.onIdle(),s.shape.length===0?iq(o.data,0):o}function py(r,e=0,n){let i=n??r.length-e;return{length:i,subarray(a,s=i){return py(r,e+a,s-a)},set(a,s=0){for(let o=0;o<a.length;o++)r[e+s+o]=a.get(o)},get(a){return r[e+a]}}}function Wm(r){return globalThis.Array.isArray(r.data)?{data:py(r.data),stride:r.stride,bytes_per_element:1}:{data:new Uint8Array(r.data.buffer,r.data.byteOffset,r.data.byteLength),stride:r.stride,bytes_per_element:r.data.BYTES_PER_ELEMENT}}function sq(r){return"chars"in r?r.constructor.bind(null,r.chars):r.constructor}function oq(r,e){if(globalThis.Array.isArray(r.data))return py([e]);let n=sq(r.data),i=new n([e]);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}const lq={prepare(r,e,n){return{data:r,shape:e,stride:n}},set_scalar(r,e,n){let i=Wm(r);t2(i,e,oq(r,n),i.bytes_per_element)},set_from_chunk(r,e,n){let i=Wm(r);Fd(i,Wm(e),i.bytes_per_element,n)}};async function gC(r,e=null,n={}){return aq(r,e,n,lq)}function lT(r,e,n){return n<0&&e<r?Math.floor((r-e-1)/-n)+1:r<e?Math.floor((e-r-1)/n)+1:0}function t2(r,e,n,i){if(e.length===0){r.data.set(n,0);return}const[a,...s]=e,[o,...l]=r.stride;if(typeof a=="number"){const v=r.data.subarray(o*a*i);t2({data:v,stride:l},s,n,i);return}const[u,c,h]=a,d=lT(u,c,h);if(s.length===0){for(let v=0;v<d;v++)r.data.set(n,o*(u+h*v)*i);return}for(let v=0;v<d;v++){const m=r.data.subarray(o*(u+h*v)*i);t2({data:m,stride:l},s,n,i)}}function Fd(r,e,n,i){const[a,...s]=i,[o,...l]=r.stride,[u,...c]=e.stride;if(a.from===null){if(s.length===0){r.data.set(e.data.subarray(0,n),a.to*n);return}Fd({data:r.data.subarray(o*a.to*n),stride:l},e,n,s);return}if(a.to===null){if(s.length===0){let A=a.from*n;r.data.set(e.data.subarray(A,A+n),0);return}Fd(r,{data:e.data.subarray(u*a.from*n),stride:c},n,s);return}const[h,d,v]=a.to,[m,y,b]=a.from,x=lT(h,d,v);if(s.length===0){if(v===1&&b===1&&o===1&&u===1){let A=m*n,C=x*n;r.data.set(e.data.subarray(A,A+C),h*n);return}for(let A=0;A<x;A++){let C=u*(m+b*A)*n;r.data.set(e.data.subarray(C,C+n),o*(h+v*A)*n)}return}for(let A=0;A<x;A++)Fd({data:r.data.subarray(o*(h+A*v)*n),stride:l},{data:e.data.subarray(u*(m+A*b)*n),stride:c},n,s)}let z0=uq();function uq(){let r=new WeakMap;function e(n){let i=r.get(n)??{v2:0,v3:0};return r.set(n,i),i}return{increment(n,i){e(n)[i]+=1},version_max(n){let i=e(n);return i.v3>i.v2?"v3":"v2"}}}async function cq(r){let e=await r.store.get(r.resolve(".zattrs").path);return e?yf(e):{}}async function fq(r,e={}){let n="store"in r?r:new wo(r),i={};return(e.attrs??!0)&&(i=await cq(n)),e.kind==="array"?vC(n,i):e.kind==="group"?mC(n,i):vC(n,i).catch(a=>(sT(a,Af),mC(n,i)))}async function vC(r,e){let{path:n}=r.resolve(".zarray"),i=await r.store.get(n);if(!i)throw new Af("v2 array",{cause:new gy(n)});return z0.increment(r.store,"v2"),new f0(r.store,r.path,Dz(yf(i),e))}async function mC(r,e){let{path:n}=r.resolve(".zgroup"),i=await r.store.get(n);if(!i)throw new Af("v2 group",{cause:new gy(n)});return z0.increment(r.store,"v2"),new vy(r.store,r.path,Rz(yf(i),e))}async function hq(r){let{store:e,path:n}=r.resolve("zarr.json"),i=await r.store.get(n);if(!i)throw new Af("v3 array or group",{cause:new gy(n)});let a=yf(i);return a.node_type==="array"&&(a.fill_value=aT(a)),a.node_type==="array"?new f0(e,r.path,a):new vy(e,r.path,a)}async function dq(r,e={}){let n="store"in r?r:new wo(r),i=await hq(n);if(z0.increment(n.store,"v3"),e.kind===void 0||e.kind==="array"&&i instanceof f0||e.kind==="group"&&i instanceof vy)return i;let a=i instanceof f0?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${a}.`)}async function ds(r,e={}){let n="store"in r?r.store:r,i=z0.version_max(n),a=i==="v2"?ds.v2:ds.v3,s=i==="v2"?ds.v3:ds.v2;return a(r,e).catch(o=>(sT(o,Af),s(r,e)))}ds.v2=fq;ds.v3=dq;var uT=Object.defineProperty,cT=r=>{throw TypeError(r)},gq=(r,e,n)=>e in r?uT(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,q0=(r,e)=>{for(var n in e)uT(r,n,{get:e[n],enumerable:!0})},j=(r,e,n)=>gq(r,typeof e!="symbol"?e+"":e,n),fT=(r,e,n)=>e.has(r)||cT("Cannot "+n),Ge=(r,e,n)=>(fT(r,e,"read from private field"),n?n.call(r):e.get(r)),oc=(r,e,n)=>e.has(r)?cT("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,n),xl=(r,e,n,i)=>(fT(r,e,"write to private field"),e.set(r,n),n),vq={version:"0.62.1"},mq=new Float32Array([-1,-1,-1,.28,.28,.28,-1,-1,-1,.28,.28,.28,-1,1,-1,.28,.28,.28,1,-1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,-1,-1,1,.8,.8,.8,-1,-1,1,.8,.8,.8,1,-1,1,.8,.8,.8,-1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,-1,1,-1,0,0,.74,-1,1,-1,0,0,.74,-1,1,1,0,0,.74,1,1,-1,0,0,.74,1,1,1,0,0,.74,1,1,1,0,0,.74,-1,-1,-1,.42,0,.42,-1,-1,-1,.42,0,.42,1,-1,-1,.42,0,.42,-1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,-1,-1,-1,.64,0,0,-1,-1,-1,.64,0,0,-1,-1,1,.64,0,0,-1,1,-1,.64,0,0,-1,1,1,.64,0,0,-1,1,1,.64,0,0,1,-1,-1,0,.5,0,1,-1,-1,0,.5,0,1,1,-1,0,.5,0,1,-1,1,0,.5,0,1,1,1,0,.5,0,1,1,1,0,.5,0,-.45,1,-.8,0,0,0,-.45,1,-.8,0,0,0,-.45,1,.8,0,0,0,-.25,1,-.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.6,0,0,0,-.25,1,.6,0,0,0,-.25,1,.8,0,0,0,.45,1,.6,0,0,0,.25,1,.8,0,0,0,.25,1,.8,0,0,0,.25,1,.1,0,0,0,.25,1,.1,0,0,0,.25,1,.6,0,0,0,.45,1,.1,0,0,0,.45,1,.6,0,0,0,.45,1,.6,0,0,0,-.25,1,-.1,0,0,0,-.25,1,-.1,0,0,0,-.25,1,.1,0,0,0,.25,1,-.1,0,0,0,.45,1,.1,0,0,0,.45,1,.1,0,0,0,.45,-1,-.8,0,0,0,.45,-1,-.8,0,0,0,.05,-1,.8,0,0,0,.25,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,-.25,-1,-.8,0,0,0,-.25,-1,-.8,0,0,0,.05,-1,.8,0,0,0,-.45,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,.13,-1,-.3,0,0,0,.13,-1,-.3,0,0,0,.07,-1,-.1,0,0,0,-.33,-1,-.3,0,0,0,-.27,-1,-.1,0,0,0,-.27,-1,-.1,0,0,0,-.45,.6,1,0,0,0,-.45,.6,1,0,0,0,-.45,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.4,1,0,0,0,-.25,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.8,1,0,0,0,-.25,.6,1,0,0,0,.25,.8,1,0,0,0,.45,.6,1,0,0,0,.45,.6,1,0,0,0,.25,.8,1,0,0,0,.25,.8,1,0,0,0,.25,-.1,1,0,0,0,.45,.6,1,0,0,0,.45,.1,1,0,0,0,.45,.1,1,0,0,0,-.25,.1,1,0,0,0,-.25,.1,1,0,0,0,-.45,-.1,1,0,0,0,.25,.1,1,0,0,0,.25,-.1,1,0,0,0,.25,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.6,1,0,0,0,-.25,-.1,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.8,1,0,0,0,.45,-.6,1,0,0,0,.25,-.8,1,0,0,0,.25,-.8,1,0,0,0,.25,-.4,1,0,0,0,.25,-.4,1,0,0,0,.25,-.6,1,0,0,0,.45,-.4,1,0,0,0,.45,-.6,1,0,0,0,.45,-.6,1,0,0,0,-.1,-.8,-1,0,0,0,-.1,-.8,-1,0,0,0,-.1,.8,-1,0,0,0,.1,-.8,-1,0,0,0,.1,.8,-1,0,0,0,.1,.8,-1,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.6,0,0,0,-1,.45,-.8,0,0,0,-1,.45,-.6,0,0,0,-1,.45,-.6,0,0,0,1,.45,-.8,0,0,0,1,.45,-.8,0,0,0,1,.45,.8,0,0,0,1,.25,-.8,0,0,0,1,.25,.8,0,0,0,1,.25,.8,0,0,0,1,.25,.6,0,0,0,1,.25,.6,0,0,0,1,.25,.8,0,0,0,1,-.45,.6,0,0,0,1,-.25,.8,0,0,0,1,-.25,.8,0,0,0,1,-.25,.1,0,0,0,1,-.25,.1,0,0,0,1,-.25,.6,0,0,0,1,-.45,.1,0,0,0,1,-.45,.6,0,0,0,1,-.45,.6,0,0,0,1,.25,-.1,0,0,0,1,.25,-.1,0,0,0,1,.25,.1,0,0,0,1,-.25,-.1,0,0,0,1,-.45,.1,0,0,0,1,-.45,.1,0,0,0,1,-.25,-.8,0,0,0,1,-.25,-.8,0,0,0,1,-.05,-.1,0,0,0,1,-.45,-.8,0,0,0,1,-.25,-.1,0,0,0,1,-.25,-.1,0,0,0]),Ft=class{constructor(e,n,i,a,s=null,o=null){j(this,"sphereIdx",[]),j(this,"sphereVtx",[]),j(this,"renderShaders",[]),j(this,"isVisible",!0),j(this,"isPickable",!0),j(this,"vertexBuffer"),j(this,"indexCount"),j(this,"indexBuffer"),j(this,"vao"),j(this,"mode"),j(this,"glFlags",0),j(this,"id"),j(this,"colorId"),j(this,"modelMatrix",Tt()),j(this,"scale",[1,1,1]),j(this,"position",[0,0,0]),j(this,"rotation",[0,0,0]),j(this,"rotationRadians",0),j(this,"extentsMin",[]),j(this,"extentsMax",[]),j(this,"furthestVertexFromOrigin"),j(this,"originNegate"),j(this,"fieldOfViewDeObliqueMM"),j(this,"mm"),this.vertexBuffer=n,this.indexCount=a,this.indexBuffer=s,this.vao=o,this.mode=i,this.id=e,this.colorId=[(e>>0&255)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255]}};j(Ft,"BLEND",1);j(Ft,"CULL_FACE",2);j(Ft,"CULL_FRONT",4);j(Ft,"CULL_BACK",8);j(Ft,"ENABLE_DEPTH_TEST",16);j(Ft,"generateCrosshairs",function(r,e,n,i,a,s,o=20,l=0){const u=Ft.generateCrosshairsGeometry(r,n,i,a,s,o,l);return new Ft(e,u.vertexBuffer,r.TRIANGLES,u.indexCount,u.indexBuffer,u.vao)});j(Ft,"generateCrosshairsGeometry",function(r,e,n,i,a,s=20,o=0){const l=[],u=[],c=a*o;if(c<=0){let m=Me(n[0],e[1],e[2]),y=Me(i[0],e[1],e[2]);Ft.makeCylinder(l,u,m,y,a,s),m=Me(e[0],n[1],e[2]),y=Me(e[0],i[1],e[2]),Ft.makeCylinder(l,u,m,y,a,s),m=Me(e[0],e[1],n[2]),y=Me(e[0],e[1],i[2]),Ft.makeCylinder(l,u,m,y,a,s)}else{let m=Me(n[0],e[1],e[2]),y=Me(e[0]-c,e[1],e[2]);Ft.makeCylinder(l,u,m,y,a,s,!1),m=Me(e[0]+c,e[1],e[2]),y=Me(i[0],e[1],e[2]),Ft.makeCylinder(l,u,m,y,a,s,!1),m=Me(e[0],n[1],e[2]),y=Me(e[0],e[1]-c,e[2]),Ft.makeCylinder(l,u,m,y,a,s,!1),m=Me(e[0],e[1]+c,e[2]),y=Me(e[0],i[1],e[2]),Ft.makeCylinder(l,u,m,y,a,s,!1),m=Me(e[0],e[1],n[2]),y=Me(e[0],e[1],e[2]-c),Ft.makeCylinder(l,u,m,y,a,s,!1),m=Me(e[0],e[1],e[2]+c),y=Me(e[0],e[1],i[2]),Ft.makeCylinder(l,u,m,y,a,s,!1)}const h=r.createBuffer();if(h===null)throw new Error("could not instantiate vertex buffer");r.bindBuffer(r.ARRAY_BUFFER,h),r.bufferData(r.ARRAY_BUFFER,new Float32Array(l),r.STATIC_DRAW);const d=r.createBuffer();if(d===null)throw new Error("could not instantiate index buffer");r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,d),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint32Array(u),r.STATIC_DRAW);const v=r.createVertexArray();return r.bindVertexArray(v),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,d),r.bindBuffer(r.ARRAY_BUFFER,h),r.enableVertexAttribArray(0),r.vertexAttribPointer(0,3,r.FLOAT,!1,0,0),r.bindVertexArray(null),{vertexBuffer:h,indexBuffer:d,indexCount:u.length,vao:v}});j(Ft,"getFirstPerpVector",function(r){const e=Me(0,0,0);return r[0]===0?e[0]=1:r[1]===0?e[1]=1:r[2]===0?e[2]=1:(e[0]=r[2],e[1]=r[2],e[2]=-(r[0]+r[1]),ui(e,e)),e});j(Ft,"subdivide",function(r,e){let n=r.length/3,i=e.length/3;const a=i,s=Kt(),o=Kt();for(let l=0;l<a;l++){const u=e[l*3+0],c=e[l*3+1],h=e[l*3+2],d=Me(r[u*3+0],r[u*3+1],r[u*3+2]),v=Me(r[c*3+0],r[c*3+1],r[c*3+2]),m=Me(r[h*3+0],r[h*3+1],r[h*3+2]);uo(s,d,v),ui(o,s),r.push(...o),uo(s,v,m),ui(o,s),r.push(...o),uo(s,d,m),ui(o,s),r.push(...o);let y=[n,n+1,n+2];e.push(...y),y=[u,n,n+2],e.push(...y),y=[n,c,n+1],e.push(...y),e[l*3+0]=n+2,e[l*3+1]=n+1,e[l*3+2]=h,i=i+3,n=n+3}});j(Ft,"weldVertices",function(r,e){const n=r.length/3;let i=0;const a=new Int32Array(n);for(let l=0;l<n-1;l++){if(a[l]!==0)continue;a[l]=i;let u=l*3;const c=r[u],h=r[u+1],d=r[u+2];for(let v=l+1;v<n;v++)u+=3,c===r[u]&&h===r[u+1]&&d===r[u+2]&&(a[v]=i);i++}if(i===n)return r;const s=e.length;for(let l=0;l<s;l++)e[l]=a[e[l]];const o=r.slice(0,i*3-1);for(let l=0;l<n-1;l++){const u=l*3,c=a[l]*3;o[c]=r[u],o[c+1]=r[u+1],o[c+2]=r[u+2]}return o});j(Ft,"makeSphere",function(r,e,n,i=[0,0,0]){let a=[0,0,1,.894,0,.447,.276,.851,.447,-.724,.526,.447,-.724,-.526,.447,.276,-.851,.447,.724,.526,-.447,-.276,.851,-.447,-.894,0,-.447,-.276,-.851,-.447,.724,-.526,-.447,0,0,-1];const s=[0,1,2,0,2,3,0,3,4,0,4,5,0,5,1,7,6,11,8,7,11,9,8,11,10,9,11,6,10,11,6,2,1,7,3,2,8,4,3,9,5,4,10,1,5,6,7,2,7,8,3,8,9,4,9,10,5,10,6,1];Ft.subdivide(a,s),Ft.subdivide(a,s),a=Ft.weldVertices(a,s);for(let c=0;c<a.length;c++)a[c]=a[c]*n;const o=a.length/3;let l=0;for(let c=0;c<o;c++)a[l]=a[l]+i[0],l++,a[l]=a[l]+i[1],l++,a[l]=a[l]+i[2],l++;const u=Math.floor(r.length/3);for(let c=0;c<s.length;c++)s[c]=s[c]+u;e.push(...s),r.push(...a)});j(Ft,"makeCylinder",function(r,e,n,i,a,s=20,o=!0){s<3&&(s=3);const l=Kt();$t(l,i,n),ui(l,l);const u=Ft.getFirstPerpVector(l),c=Kt();Bd(c,l,u),ui(c,c);let h=2*s,d=2*s;o&&(d+=2*s,h+=2);const v=Math.floor(r.length/3),m=new Uint32Array(d*3),y=new Float32Array(h*3);function b(T,R){y[T*3+0]=R[0],y[T*3+1]=R[1],y[T*3+2]=R[2]}function x(T,R,D,B){m[T*3+0]=R+v,m[T*3+1]=D+v,m[T*3+2]=B+v}const A=2*s,C=A+1;o&&(b(A,n),b(C,i));const E=Kt(),S=Kt();for(let T=0;T<s;T++){const R=Math.cos(T/s*2*Math.PI),D=Math.sin(T/s*2*Math.PI);E[0]=a*(R*u[0]+D*c[0]),E[1]=a*(R*u[1]+D*c[1]),E[2]=a*(R*u[2]+D*c[2]),uo(S,n,E),b(T,S),uo(S,i,E),b(T+s,S);let B=0;T<s-1&&(B=T+1),x(T*2,T,B,T+s),x(T*2+1,B,B+s,T+s),o&&(x(s*2+T,T,A,B),x(s*2+T+s,C,T+s,B+s))}e.push(...m),r.push(...y)});j(Ft,"makeColoredCylinder",function(r,e,n,i,a,s,o=[192,0,0,255],l=20,u=!1){let c=r.length/3;Ft.makeCylinder(r,e,i,a,s,l,u),c=r.length/3-c;const h=[];for(let d=0;d<c*4-1;d+=4)h[d]=o[0],h[d+1]=o[1],h[d+2]=o[2],h[d+3]=o[3];n.push(...h)});j(Ft,"makeColoredSphere",function(r,e,n,i,a=[0,0,0],s=[0,0,192,255]){let o=r.length/3;Ft.makeSphere(r,e,i,a),o=r.length/3-o;const l=[];for(let u=0;u<o*4-1;u+=4)l[u]=s[0],l[u+1]=s[1],l[u+2]=s[2],l[u+3]=s[3];n.push(...l)});var Ao=Ft,hT=class pi{constructor({name:e="niivue",level:n="info"}={}){j(this,"level"),j(this,"name"),this.name=`${e}`,this.level=n}debug(...e){pi.levels[this.level]>pi.levels.debug||console.debug(`${this.name}-debug`,...e)}info(...e){pi.levels[this.level]>pi.levels.info||console.info(`${this.name}-info`,...e)}warn(...e){pi.levels[this.level]>pi.levels.warn||console.warn(`${this.name}-warn`,...e)}error(...e){pi.levels[this.level]>pi.levels.error||console.error(`${this.name}-error`,...e)}fatal(...e){pi.levels[this.level]>pi.levels.fatal||console.error(`${this.name}-fatal`,...e)}setLogLevel(e){this.level=e}setName(e){this.name=e}};j(hT,"levels",{debug:0,info:1,warn:2,error:3,fatal:4,silent:1/0});var pq=hT,Q=new pq({name:"niivue",level:"info"}),kd={};q0(kd,{$itksnap:()=>yq,$slicer3d:()=>Aq,actc:()=>xq,afni_blues_inv:()=>FG,afni_reds_inv:()=>kG,batlow:()=>bq,bcgwhw:()=>Cq,bcgwhw_dark:()=>wq,blue:()=>Dq,blue2cyan:()=>Tq,blue2magenta:()=>Sq,blue2red:()=>Eq,bluegrn:()=>Mq,bone:()=>Rq,bronze:()=>Bq,cet_l17:()=>Iq,cividis:()=>Nq,cool:()=>Fq,copper:()=>Pq,copper2:()=>kq,ct_airways:()=>Uq,ct_artery:()=>Vq,ct_bones:()=>Oq,ct_brain:()=>_q,ct_brain_gray:()=>Lq,ct_cardiac:()=>zq,ct_head:()=>qq,ct_kidneys:()=>Gq,ct_liver:()=>Yq,ct_muscles:()=>Hq,ct_scalp:()=>jq,ct_skull:()=>Kq,ct_soft:()=>Xq,ct_soft_tissue:()=>Qq,ct_surface:()=>Wq,ct_vessels:()=>Zq,ct_w_contrast:()=>Jq,cubehelix:()=>$q,electric_blue:()=>eG,freesurfer:()=>tG,ge_color:()=>rG,gold:()=>nG,gray:()=>iG,green:()=>aG,green2cyan:()=>sG,green2orange:()=>oG,hot:()=>uG,hotiron:()=>lG,hsv:()=>cG,inferno:()=>fG,jet:()=>hG,kry:()=>dG,linspecer:()=>gG,lipari:()=>vG,magma:()=>mG,mako:()=>pG,navia:()=>yG,nih:()=>AG,plasma:()=>xG,random:()=>bG,red:()=>wG,redyell:()=>CG,rocket:()=>EG,roi_i256:()=>PG,surface:()=>SG,thermal:()=>TG,turbo:()=>MG,violet:()=>DG,viridis:()=>RG,warm:()=>BG,winter:()=>IG,x_rain:()=>NG});var yq={R:[0,255,0,0,255,0,255,255,0,205,210,102,0,0,46,255,106,221,233,165,255,147,218,75,255,60,255,255,218,0,188,255,255,222,127,139,124,255,70,0,238,238,240,245,184,32,255,25,112,34,248,245,255,144,173,65,255,250,128,50,244,255,123,255,173,255,127,255,143,220,253,255,0,0,128,255,250,148,178,255,135,100,240,250,255,107,135,0,139,245,186,255,255,0,210,255,47,72,175,128,176,255,139,240,255,216,119,219,72,255,199,154,189,240,230,0,85,64,153,205,250,95,0,255,224,176,138,30,240,152,160],G:[0,0,255,0,255,255,0,239,0,133,180,205,0,139,139,228,90,160,150,42,250,112,112,0,182,179,235,228,165,128,143,105,218,184,255,69,252,255,130,100,130,232,255,222,134,178,20,25,128,139,248,255,160,238,255,105,99,240,0,205,164,255,104,165,216,192,255,140,188,20,245,250,206,255,0,250,128,0,34,127,206,149,230,235,245,142,206,0,0,245,85,228,222,191,105,248,79,61,238,128,224,240,0,255,215,191,136,112,209,0,21,205,183,248,230,250,107,224,50,92,250,158,128,69,255,196,43,144,128,251,82],B:[0,0,0,255,0,255,255,213,205,63,140,170,128,139,87,225,205,221,122,42,250,219,214,130,193,113,205,196,32,128,143,180,185,135,0,19,0,224,180,0,238,170,240,179,11,170,147,112,144,34,255,250,122,144,47,225,71,230,0,50,96,240,238,0,230,203,212,0,143,60,230,240,209,127,128,205,114,211,34,80,235,237,140,215,238,35,250,139,139,220,211,181,173,255,30,220,79,139,238,0,230,245,0,255,0,216,153,147,204,255,133,50,107,255,250,154,47,208,204,92,210,160,0,0,255,222,226,255,128,152,45],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130]},Aq={labels:["background","tissue","bone","skin","connective tissue","blood","organ","mass","muscle","foreign object","waste","teeth","fat","gray matter","white matter","nerve","vein","artery","capillary","ligament","tendon","cartilage","meniscus","lymph node","lymphatic vessel","cerebro-spinal fluid","bile","urine","feces","gas","fluid","edema","bleeding","necrosis","clot","embolism","head","central nervous system","brain","gray matter of brain","telencephalon","cerebral cortex","right frontal lobe","left frontal lobe","right temporal lobe","left temporal lobe","right parietal lobe","left parietal lobe","right occipital lobe","left occipital lobe","right insular lobe","left insular lobe","right limbic lobe","left limbic lobe","right striatum","left striatum","right caudate nucleus","left caudate nucleus","right putamen","left putamen","right pallidum","left pallidum","right amygdaloid complex","left amygdaloid complex","diencephalon","thalamus","right thalamus","left thalamus","pineal gland","midbrain","substantia nigra","right substantia nigra","left substantia nigra","cerebral white matter","right superior longitudinal fasciculus","left superior longitudinal fasciculus","right inferior longitudinal fasciculus","left inferior longitudinal fasciculus","right arcuate fasciculus","left arcuate fasciculus","right uncinate fasciculus","left uncinate fasciculus","right cingulum bundle","left cingulum bundle","projection fibers","right corticospinal tract","left corticospinal tract","right optic radiation","left optic radiation","right medial lemniscus","left medial lemniscus","right superior cerebellar peduncle","left superior cerebellar peduncle","right middle cerebellar peduncle","left middle cerebellar peduncle","right inferior cerebellar peduncle","left inferior cerebellar peduncle","optic chiasm","right optic tract","left optic tract","right fornix","left fornix","commissural fibers","corpus callosum","posterior commissure","cerebellar white matter","CSF space","ventricles of brain","right lateral ventricle","left lateral ventricle","right third ventricle","left third ventricle","cerebral aqueduct","fourth ventricle","subarachnoid space","spinal cord","gray matter of spinal cord","white matter of spinal cord","endocrine system of brain","pituitary gland","adenohypophysis","neurohypophysis","meninges","dura mater","arachnoid","pia mater","muscles of head","salivary glands","lips","nose","tongue","soft palate","right inner ear","left inner ear","right external ear","left external ear","right middle ear","left middle ear","right eyeball","left eyeball","skull","right frontal bone","left frontal bone","right parietal bone","left parietal bone","right temporal bone","left temporal bone","right sphenoid bone","left sphenoid bone","right ethmoid bone","left ethmoid bone","occipital bone","maxilla","right zygomatic bone","right lacrimal bone","vomer bone","right palatine bone","left palatine bone","mandible","neck","muscles of neck","pharynx","larynx","thyroid gland","right parathyroid glands","left parathyroid glands","skeleton of neck","hyoid bone","cervical vertebral column","thorax","trachea","bronchi","right lung","left lung","superior lobe of right lung","superior lobe of left lung","middle lobe of right lung","inferior lobe of right lung","inferior lobe of left lung","pleura","heart","right atrium","left atrium","atrial septum","ventricular septum","right ventricle of heart","left ventricle of heart","mitral valve","tricuspid valve","aortic valve","pulmonary valve","aorta","pericardium","pericardial cavity","esophagus","thymus","mediastinum","skin of thoracic wall","muscles of thoracic wall","skeleton of thorax","thoracic vertebral column","ribs","sternum","right clavicle","left clavicle","abdominal cavity","abdomen","peritoneum","omentum","peritoneal cavity","retroperitoneal space","stomach","duodenum","small bowel","colon","anus","liver","biliary tree","gallbladder","pancreas","spleen","urinary system","right kidney","left kidney","right ureter","left ureter","urinary bladder","urethra","right adrenal gland","left adrenal gland","female internal genitalia","uterus","right fallopian tube","left fallopian tube","right ovary","left ovary","vagina","male internal genitalia","prostate","right seminal vesicle","left seminal vesicle","right deferent duct","left deferent duct","skin of abdominal wall","muscles of abdominal wall","skeleton of abdomen","lumbar vertebral column","female external genitalia","male external genitalia","skeleton of upper limb","muscles of upper limb","right upper limb","left upper limb","right shoulder","left shoulder","right arm"],R:[0,128,241,177,111,216,221,144,192,220,78,255,230,200,250,244,0,216,183,183,152,111,178,68,111,85,0,214,78,218,170,140,188,216,145,150,177,244,250,200,68,128,83,83,162,162,141,141,182,182,188,188,154,154,177,177,30,30,210,210,48,48,98,98,69,166,122,122,253,145,46,0,0,250,127,127,159,159,125,125,106,106,154,154,126,201,201,78,78,174,174,139,139,148,148,186,186,99,156,156,64,64,138,97,126,194,85,88,88,88,88,88,88,88,88,244,200,250,82,57,60,92,255,255,255,255,201,70,188,177,166,182,229,229,174,174,201,201,194,194,241,203,203,229,229,255,255,209,209,248,248,255,196,255,255,255,242,242,222,177,213,184,150,62,62,62,242,250,255,177,182,175,197,197,172,172,202,224,224,255,206,210,203,233,195,181,152,159,166,218,225,224,255,184,211,47,255,173,188,255,226,253,244,205,205,186,177,255,234,204,180,216,255,205,204,255,221,0,139,249,157,203,185,185,247,247,222,124,249,249,244,255,255,227,213,213,193,216,230,245,245,241,241,177,171,217,212,185,185,198,194,177,177,177,177,177],G:[0,174,214,122,184,101,130,238,104,245,63,250,220,200,250,214,151,101,156,214,189,184,212,172,197,188,145,230,63,255,250,224,65,191,60,98,122,214,250,200,131,174,146,146,115,115,93,93,166,166,135,135,150,150,140,140,111,111,157,157,129,129,153,153,110,113,101,101,135,92,101,108,108,250,150,150,116,116,102,102,174,174,146,146,126,160,160,152,152,140,140,126,126,120,120,135,135,106,171,171,123,123,95,113,161,195,188,106,106,106,106,106,106,106,106,214,200,250,174,157,143,162,244,244,244,244,121,163,91,122,84,105,147,147,122,122,112,112,142,142,213,179,179,204,204,243,243,185,185,223,223,230,172,255,250,237,217,217,198,122,124,105,208,162,162,162,206,210,255,122,228,216,165,165,138,138,164,186,186,245,110,115,108,138,100,85,55,63,70,123,130,97,244,122,171,150,244,121,95,239,202,232,217,179,179,124,122,255,234,142,119,132,253,167,168,224,130,145,150,180,108,136,102,102,182,182,154,186,186,186,170,181,190,153,141,141,123,146,158,172,172,172,172,124,85,198,188,135,135,175,98,122,122,122,122,122],B:[0,128,145,101,210,79,101,144,88,20,0,220,70,235,210,49,206,79,220,211,207,210,242,100,131,255,30,130,0,255,250,228,28,216,66,83,101,49,225,215,98,128,164,164,105,105,137,137,110,110,166,166,201,201,190,190,85,85,166,166,126,126,112,112,53,137,38,38,192,109,131,112,112,225,88,88,163,163,154,154,155,155,83,83,55,133,133,141,141,103,103,177,177,72,72,135,135,24,108,108,147,147,74,158,197,164,255,215,215,215,215,215,215,215,215,49,215,225,128,110,83,109,209,209,209,209,77,117,95,101,94,107,118,118,90,90,73,73,0,0,144,77,77,109,109,152,152,85,85,131,131,138,68,167,160,145,123,123,101,101,109,108,243,114,114,114,142,139,207,101,255,244,145,145,115,115,140,162,162,217,84,89,81,112,73,57,13,27,38,97,104,76,209,154,143,103,209,88,76,172,134,158,154,108,108,161,101,220,194,178,153,105,229,142,143,199,101,30,98,111,162,116,83,83,164,164,132,223,150,150,147,158,165,130,113,113,103,127,140,147,147,151,151,92,68,131,102,134,134,125,79,101,101,101,101,101],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},xq={R:[0,0,24,248,255],G:[0,0,177,254,0],B:[0,136,0,0,0],A:[0,32,64,78,128],I:[0,64,128,156,255]},bq={R:[1,10,15,17,21,27,36,49,65,82,99,118,140,161,183,203,222,238,248,253,253,253,252,250],G:[25,42,56,68,79,88,97,105,111,116,122,127,133,138,142,146,150,155,162,170,178,186,195,204],B:[89,92,95,96,98,98,96,91,83,74,64,55,46,43,49,62,79,100,126,151,175,199,223,250],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},wq={R:[0,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[0,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[0,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},Cq={R:[255,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[255,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[255,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},Eq={R:[0,0,0,0,196,255],G:[0,32,128,128,128,32],B:[0,255,196,0,0,0],A:[0,128,64,64,64,128],I:[0,1,64,128,192,255]},Sq={R:[0,255],G:[0,0],B:[255,255],A:[0,128],I:[0,255]},Tq={R:[0,0],G:[0,255],B:[255,255],A:[0,128],I:[0,255]},Mq={R:[0,0,0,0],G:[0,1,128,255],B:[0,222,127,32],A:[0,0,64,128],I:[0,1,128,255]},Dq={R:[0,0,0],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},Rq={R:[0,103,255],G:[0,126,255],B:[0,165,255],A:[0,76,128],I:[0,153,255]},Bq={R:[0,43,103,199,216,255],G:[0,0,37,155,213,255],B:[0,0,20,97,201,255],A:[0,44,48,54,56,56],I:[0,64,128,196,240,255]},Iq={R:[0,9,24,33,40,46,52,57,62,66,70,74,78,81,85,88,91,94,98,101,103,106,109,112,114,117,119,121,124,126,128,130,133,135,137,139,141,143,145,147,149,151,153,155,157,159,161,163,164,166,168,169,171,172,174,175,177,178,180,181,183,184,186,187,189,190,191,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,222,223,224,224,225,226,226,227,228,228,229,229,230,231,231,232,233,233,234,234,235,235,236,236,236,237,237,237,238,238,238,239,239,239,240,240,240,241,241,241,242,242,242,243,243,243,243,243,243,243,243,244,244,244,244,244,244,244,244,244,244,244,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,244,244,244,244,244,244,244,244,244,244,244,244,244,244,244,243,243,243,243,243,243,243,243,243,243,243,243,242,242,242,242,242,242,242,242,241,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,243,243,244,244,245,246,246,247,247,248,249,249,250,250,251,251,252,252,253,253,254,254,254],G:[42,41,41,41,40,40,40,39,39,39,38,38,37,37,36,36,35,35,34,34,33,32,32,31,30,30,30,30,29,29,29,29,28,28,28,27,27,27,26,26,26,25,25,25,24,24,24,24,24,25,25,26,27,27,28,28,29,30,30,31,31,32,33,33,34,34,35,36,36,37,38,39,40,42,43,44,45,47,48,49,50,51,53,54,55,56,57,58,59,60,62,63,64,65,66,68,69,71,72,73,75,76,77,79,80,81,83,84,85,87,88,89,90,92,93,94,95,97,98,100,101,102,104,105,107,108,109,111,112,113,115,116,117,119,120,121,122,124,125,126,128,129,130,132,133,134,136,137,138,140,141,142,144,145,146,147,149,150,151,153,154,155,156,158,159,160,161,163,164,165,167,168,169,170,172,173,174,175,176,178,179,180,181,183,184,185,186,187,189,190,191,192,193,194,196,197,198,199,200,201,203,204,205,206,207,208,209,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,228,229,230,231,232,233,234,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,248,248,249,250,251,251,252,253,254,255],B:[167,167,166,166,166,165,165,165,164,164,164,163,163,162,162,162,161,161,161,160,160,160,159,159,158,158,157,157,156,155,155,154,154,153,153,152,151,151,150,150,149,149,148,147,147,146,146,145,144,144,143,143,142,141,141,140,139,139,138,137,137,136,135,135,134,133,133,132,131,131,130,130,129,128,128,127,127,126,125,125,124,124,123,123,122,121,121,120,119,119,118,118,117,116,116,116,115,115,114,114,113,113,113,112,112,111,111,110,110,109,109,109,108,108,107,107,106,106,106,106,106,105,105,105,105,105,105,105,104,104,104,104,104,103,103,103,103,103,102,102,102,103,103,103,103,104,104,104,104,104,105,105,105,105,106,106,106,106,106,107,107,107,107,108,108,109,110,111,111,112,113,113,114,115,115,116,117,117,118,119,120,120,121,122,122,123,124,125,126,128,129,130,131,132,134,135,136,137,138,140,141,142,143,144,146,147,148,149,150,152,153,155,157,158,160,162,163,165,167,168,170,172,173,175,177,178,180,182,183,185,187,188,190,193,196,199,201,204,207,210,212,215,218,221,224,226,229,232,235,238,240,243,246,249,252,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},Nq={R:[0,86,166,255],G:[32,92,156,233],B:[76,108,117,69],A:[0,56,80,88],I:[0,64,192,255]},Fq={R:[0,0,0],G:[127,196,254],B:[255,255,255],A:[0,64,128],I:[0,128,255]},kq={R:[0,61,122,183,244,255],G:[0,41,81,122,163,255],B:[0,25,51,76,102,255],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},Pq={R:[0,61,122,183,244,255],G:[0,41,81,122,163,203],B:[0,25,51,76,102,127],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},Uq={min:-643,max:-235,R:[0,0,0],G:[154,154,154],B:[179,179,101],A:[0,32,0],I:[0,163,255]},Vq={min:114,max:800,R:[0,255,255,255],G:[0,0,129,255],B:[0,0,0,255],A:[0,64,88,228],I:[0,80,160,255]},Oq={min:180,max:600,R:[0,0,113,255],G:[0,0,109,250],B:[0,0,101,245],A:[0,0,100,160],I:[0,1,128,255]},Lq={min:-10,max:110,R:[0,127,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},_q={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},zq={min:-80,max:1e3,R:[0,189,150,150,150,150,255],G:[0,169,54,54,54,54,240],B:[0,153,52,52,52,52,242],A:[0,32,64,0,0,64,64],I:[0,1,82,92,234,242,255]},qq={min:-590,max:600,R:[0,241,241,248,248,178,178,232,255,255,255],G:[0,156,156,222,222,36,36,51,255,255,255],B:[0,130,130,169,169,24,24,37,255,255,255],A:[0,8,0,0,0,64,64,0,0,222,222],I:[0,2,3,64,122,142,172,182,252,253,255]},Gq={min:114,max:302,R:[0,255,255],G:[0,129,255],B:[0,0,255],A:[0,88,228],I:[0,103,255]},Yq={min:-23,max:246,R:[0,44,255,255,255],G:[0,128,90,255,255],B:[0,0,70,0,255],A:[0,0,82,184,228],I:[0,64,131,196,255]},Hq={min:-100,max:246,R:[0,128,159,255,255,255,255],G:[0,0,56,90,0,255,255],B:[0,0,41,70,0,0,255],A:[0,63,105,135,167,184,228],I:[0,100,128,155,180,209,255]},jq={min:-590,max:600,R:[0,241,241,248,248,178,232,255,255],G:[0,156,156,222,222,36,51,255,255],B:[0,130,130,169,169,24,37,255,255],A:[0,63,105,135,167,184,228,228,228],I:[0,1,52,127,137,162,172,252,255]},Kq={min:140,max:1024,R:[0,2,113,255],G:[0,1,109,250],B:[0,1,101,245],A:[0,1,96,168],I:[0,1,128,255]},Xq={min:-923,max:679,R:[0,0,0,0,0,255,255,255],G:[154,154,154,154,0,0,254,255],B:[179,179,179,179,0,0,0,255],A:[0,3,8,0,0,10,15,20],I:[0,30,62,88,170,200,232,255]},Qq={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},Wq={min:-600,max:100,R:[0,134,255],G:[0,109,250],B:[0,101,245],A:[0,60,148],I:[0,128,255]},Zq={min:114,max:246,R:[0,255,255],G:[0,128,255],B:[0,128,255],A:[0,64,96],I:[0,87,255]},Jq={min:50,max:1e3,R:[98,210,169,128,255],G:[94,26,77,128,255],B:[45,21,74,128,255],A:[0,25,0,4,168],I:[0,41,87,154,255]},$q={R:[0,13,21,26,27,25,22,21,22,28,39,54,75,98,124,148,171,189,202,210,213,211,206,200,195,193,195,201,211,225,240,255],G:[0,5,11,20,31,44,58,72,86,99,109,116,120,122,122,122,121,121,124,129,137,147,161,175,190,205,218,229,238,245,251,255],B:[0,14,30,46,61,71,77,78,75,68,60,52,48,47,53,65,83,105,131,157,183,205,222,235,241,243,242,240,239,240,245,255],A:[0,4,8,12,17,21,25,29,33,37,41,45,50,54,58,62,66,70,74,78,83,87,91,95,99,103,107,111,116,120,124,128],I:[0,8,16,25,33,41,49,58,66,74,82,90,99,107,115,123,132,140,148,156,165,173,181,189,197,206,214,222,230,239,247,255]},eG={R:[0,10,136,255],G:[0,39,220,255],B:[0,223,253,255],A:[0,48,64,70],I:[0,92,192,255]},tG={R:[0,245,205,120,196,220,230,0,122,236,12,204,42,119,220,103,60,255,165,160,0,245,205,120,196,220,230,0,122,236,13,220,103,255,165,160,0,120,200,255,255,164,164,164,234,0,0,0,0,0],G:[0,245,62,18,58,248,148,118,186,13,48,182,204,159,216,255,60,165,42,32,200,245,62,18,58,248,148,118,186,13,48,216,255,165,42,32,200,190,70,148,148,108,108,108,169,0,0,0,0,0],B:[0,245,78,134,250,164,34,14,220,176,255,142,164,176,20,255,60,0,42,240,200,245,78,134,250,164,34,14,220,176,255,20,255,0,42,240,221,150,255,10,10,226,226,226,30,64,112,160,208,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,2,3,4,5,7,8,10,11,12,13,14,15,16,17,18,24,26,28,30,31,41,42,43,44,46,47,49,50,51,52,53,54,58,60,62,63,72,77,78,79,80,81,82,85,251,252,253,254,255]},rG={R:[0,0,128,255,255],G:[0,128,0,128,255],B:[0,125,255,0,255],A:[0,32,64,96,128],I:[0,63,128,192,255]},nG={R:[0,142,227,255],G:[0,85,170,255],B:[0,14,76,255],A:[0,42,84,128],I:[0,85,170,255]},iG={R:[0,255],G:[0,255],B:[0,255],A:[0,128],I:[0,255]},aG={R:[0,0,0],G:[0,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},sG={R:[0,0,0],G:[72,72,255],B:[0,255,255],A:[0,64,128],I:[0,88,255]},oG={R:[0,255,255],G:[72,88,255],B:[0,0,0],A:[0,64,128],I:[0,88,255]},lG={R:[0,255,255,255],G:[0,0,126,255],B:[0,0,0,255],A:[0,64,96,128],I:[0,128,191,255]},uG={R:[3,255,255,255],G:[0,0,255,255],B:[0,0,0,255],A:[0,48,96,128],I:[0,95,191,255]},cG={R:[255,255,0,0,0,255,255],G:[0,255,255,255,0,0,0],B:[0,0,0,255,255,255,0],A:[0,14,28,43,57,71,85],I:[0,43,85,128,170,213,255]},fG={R:[0,120,237,240],G:[0,28,105,249],B:[4,109,37,33],A:[0,56,80,88],I:[0,64,192,255]},hG={R:[0,0,127,255,127],G:[0,127,255,127,0],B:[127,255,127,0,0],A:[0,32,64,96,128],I:[0,63,128,192,255]},dG={R:[0,255,255],G:[0,0,255],B:[0,0,0],A:[0,64,64],I:[0,86,255]},gG={R:[94,50,90,152,215,238,249,254,252,241,209,158],G:[79,131,186,214,240,244,237,210,157,100,57,1],B:[162,189,167,164,155,169,168,123,86,68,79,66],A:[0,12,23,35,47,58,70,81,93,105,116,128],I:[0,23,46,70,93,116,139,162,185,209,232,255]},vG={R:[3,7,13,25,45,67,84,98,110,124,138,154,173,191,210,225,233,233,231,229,230,235,243,253],G:[19,33,48,63,77,87,92,94,95,96,96,97,99,101,106,118,133,149,163,177,192,208,225,245],B:[38,58,79,99,114,122,122,120,117,113,110,105,101,97,94,96,103,112,122,134,149,169,192,218],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},mG={R:[0,148,183,223,247,252],G:[0,44,55,74,112,253],B:[4,128,121,104,92,191],A:[0,44,53,64,75,107],I:[0,107,128,154,179,255]},pG={R:[11,59,55,222],G:[4,45,165,245],B:[5,91,172,229],A:[0,23,70,107],I:[0,56,167,255]},yG={R:[3,5,6,8,12,19,28,36,42,48,54,61,68,76,86,96,110,129,154,181,205,224,239,252],G:[19,32,44,58,72,86,98,108,116,122,128,134,141,149,157,167,178,191,204,216,225,232,239,244],B:[39,60,82,104,123,137,144,145,142,138,134,130,126,121,116,110,105,104,112,131,155,178,198,217],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},AG={R:[0,85,0,0,0,0,0,0,85,255,255,255,172],G:[0,0,0,0,85,170,255,255,255,255,85,0,0],B:[0,170,85,255,255,170,170,0,85,0,0,0,0],A:[0,5,10,21,26,32,37,42,48,53,64,72,85],I:[0,15,31,63,79,95,111,127,143,159,191,217,255]},xG={R:[13,156,237,240],G:[8,23,121,249],B:[135,158,83,33],A:[0,56,80,88],I:[0,64,192,255]},bG={R:[208,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248],G:[182,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21],B:[191,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},wG={R:[0,128,255],G:[0,0,0],B:[0,0,0],A:[0,64,128],I:[0,128,255]},CG={R:[192,224,255],G:[1,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},EG={R:[3,112,144,188,236,246,255],G:[5,31,29,22,76,158,250],B:[26,87,91,86,62,117,235],A:[0,30,38,49,67,85,107],I:[0,73,92,118,160,205,255]},SG={R:[1,240,255],G:[1,128,255],B:[1,128,255],A:[0,76,128],I:[0,153,255]},TG={R:[0,5,18,34,53,72,90,107,126,144,161,178,194,209,222,233,242,248,251,251,249,244,241,252],G:[0,4,10,11,9,11,17,23,30,36,43,50,59,70,83,98,117,136,157,177,199,220,240,254],B:[3,24,50,76,96,106,109,110,108,104,97,89,79,67,55,42,26,12,6,22,47,79,121,164],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,11,22,33,44,55,66,77,88,99,110,121,133,144,155,166,177,188,199,210,221,232,243,255]},MG={R:[48,48,64,70,65,25,132,195,244,254,218,122],G:[18,18,64,107,150,226,255,241,199,158,57,4],B:[59,59,162,227,255,187,81,52,58,47,7,3],A:[0,22,26,30,34,43,52,57,63,67,77,86],I:[0,1,16,32,49,83,118,140,164,181,219,255]},DG={R:[0,128,255],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},RG={R:[68,49,53,253],G:[1,104,183,231],B:[84,142,121,37],A:[0,56,80,88],I:[0,64,192,255]},BG={R:[255,255,255],G:[127,196,254],B:[0,0,0],A:[0,64,128],I:[0,128,255]},IG={R:[0,0,0],G:[0,128,255],B:[255,196,128],A:[0,64,128],I:[0,128,255]},NG={R:[3,64,0,0,255,255,255],G:[0,0,0,255,255,192,3],B:[0,32,48,56,64,96,128],A:[0,8,16,24,32,52,80],I:[0,32,64,96,160,192,255]},FG={min:0,max:0,R:[0,37],G:[242,0],B:[255,255],A:[0,64],I:[0,255]},kG={R:[255,255],G:[255,11],B:[0,0],A:[0,64],I:[0,255]},PG={min:0,max:0,R:[65,10,223,120,216,207,251,93,252,217,21,253,131,165,173,143,144,217,86,89,63,254,172,1,142,107,42,78,221,8,222,71,127,126,167,33,104,2,208,216,0,251,7,105,2,101,248,190,253,62,255,224,166,37,110,138,45,34,6,37,69,201,43,122,199,37,173,194,103,211,75,159,96,4,239,98,110,193,253,166,40,255,48,130,140,243,101,9,177,220,133,32,4,81,48,48,210,109,60,132,1,119,1,159,247,33,212,187,253,144,196,254,168,79,64,196,39,97,73,173,104,216,217,43,101,119,254,5,237,103,203,122,57,87,251,164,19,75,200,2,252,150,66,0,255,157,23,254,55,16,240,161,69,253,207,195,5,60,255,251,200,217,134,123,253,180,27,246,130,136,250,232,4,125,140,22,253,255,13,180,123,61,254,111,10,185,76,192,255,223,186,61,198,5,172,13,83,172,171,6,23,73,134,133,109,61,213,55,57,132,36,209,2,144,1,253,68,155,3,160,2,77,121,70,67,176,223,131,4,162,232,255,150,94,235,191,207,10,246,0,225,4,209,116,57,112,172,253,1,6,92,227,73,62,135,223],G:[162,50,112,245,4,124,176,243,56,125,183,139,182,68,189,4,225,10,20,223,7,46,31,193,225,250,219,41,2,100,83,181,34,150,72,223,168,248,80,253,7,117,214,2,248,10,3,59,179,160,90,244,146,4,207,4,125,255,96,100,1,208,130,51,116,181,236,53,244,5,165,28,181,86,96,42,254,1,134,194,214,92,41,204,137,86,207,3,143,3,100,239,164,94,65,251,131,244,173,57,143,107,217,53,210,0,148,250,45,198,81,40,61,218,252,88,171,0,248,24,248,4,41,100,187,46,208,145,43,168,121,46,175,250,125,107,233,112,207,231,174,215,53,9,43,153,52,124,128,65,210,147,255,147,63,200,148,254,0,179,241,42,239,2,230,8,82,135,87,16,3,87,86,151,254,8,255,86,53,19,7,192,171,201,253,247,197,103,251,126,0,149,54,183,61,126,79,113,10,103,184,75,11,195,222,136,149,131,8,99,240,177,252,255,198,16,7,68,178,66,191,150,73,26,211,109,78,209,240,254,1,166,247,131,2,0,167,127,133,10,43,99,235,3,214,142,176,82,132,38,10,249,255,215,44,81],B:[176,182,248,37,117,35,96,69,32,152,108,20,237,250,2,89,141,216,111,251,211,149,10,44,214,103,31,251,3,32,252,246,97,1,219,167,197,4,36,116,206,118,106,43,205,204,114,69,127,205,87,80,41,251,145,204,253,161,247,1,149,9,43,253,97,72,136,161,171,181,26,255,108,80,218,214,231,255,84,31,109,4,218,3,217,36,68,85,241,39,221,2,240,2,173,42,206,5,110,46,103,27,212,184,2,207,246,45,116,72,110,253,38,105,248,159,243,81,192,93,141,145,24,157,234,131,57,178,62,75,65,176,148,40,253,66,76,240,51,154,17,251,139,253,207,9,114,49,200,254,96,73,138,118,204,102,137,89,145,161,4,112,66,234,147,178,212,205,185,11,203,131,2,250,118,169,1,185,154,53,171,197,61,175,249,96,15,254,95,5,222,75,246,194,2,61,180,25,133,165,15,233,59,35,221,140,109,7,114,255,198,0,115,168,252,23,242,80,75,142,137,255,12,182,68,201,4,111,37,228,83,248,24,192,249,5,54,223,160,122,160,114,145,119,252,31,253,250,10,214,8,47,0,142,222,70],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},UG=class{constructor(){j(this,"gamma",1),j(this,"version",.1),j(this,"cluts",{});const e=Object.keys(kd).filter(n=>!n.startsWith("$")).sort(new Intl.Collator("en").compare);for(const n of e)this.cluts[n]=kd[n]}addColormap(r,e){this.cluts[r]=e}colormaps(){return Object.keys(this.cluts)}colorMaps(){return this.colormaps()}colormapFromKey(r){let e=this.cluts[r];return e!==void 0||(e=this.cluts[r.toLowerCase()],e!==void 0)?e:(r.length>0&&Q.warn("No color map named "+r),{min:0,max:0,R:[0,255],G:[0,255],B:[0,255],A:[0,255],I:[0,255]})}colormap(r="",e=!1){const n=this.colormapFromKey(r);return this.makeLut(n.R,n.G,n.B,n.A,n.I,e)}makeLabelLut(r,e=255){if(r.R===void 0||r.G===void 0||r.B===void 0)throw new Error(`Invalid colormap table: ${r}`);const n=r.R.length,i=r.I??[...Array(n).keys()];if(n!==r.G.length||n!==r.B.length||n!==i.length)throw new Error(`colormap does not make sense: ${r} Rs ${r.R.length} Gs ${r.G.length} Bs ${r.B.length} Is ${i.length}`);let a=new Uint8ClampedArray(n).fill(e);a[0]=0,r.A!==void 0&&(a=Uint8ClampedArray.from(r.A));const s=Math.min(...i),o=Math.max(...i),l=o-s+1,u=new Uint8ClampedArray(l*4).fill(0);for(let h=0;h<n;h++){let d=(i[h]-s)*4;u[d++]=r.R[h],u[d++]=r.G[h],u[d++]=r.B[h],u[d++]=a[h]}const c={lut:u,min:s,max:o};if(r.labels){const h=r.labels.length;if(h===l)c.labels=r.labels;else if(h===n){c.labels=Array(l).fill("?");for(let d=0;d<n;d++){const v=i[d];c.labels[v]=r.labels[d]}}}return c}async makeLabelLutFromUrl(r){const n=await(await fetch(r)).json();return this.makeLabelLut(n)}makeDrawLut(r){let e=typeof r=="object"?r:kd[r];e===void 0&&(Q.warn("colormap undefined ",r),e=this.colormapFromKey(""));const n=this.makeLabelLut(e,255);if(n.labels===void 0&&(n.labels=[]),n.labels.length<256){const o=n.labels.length;for(let l=o;l<256;l++)n.labels.push(l.toString())}const i=new Uint8ClampedArray(256*4);let a=0;for(let o=0;o<256;o++)i[a++]=255,i[a++]=0,i[a++]=0,i[a++]=255;i[3]=0;const s=Math.min(n.lut.length,256*4);if(s>0)for(let o=0;o<s;o++)i[o]=n.lut[o];return{lut:i,labels:n.labels}}makeLut(r,e,n,i,a,s){const o=r.length,l=[...r],u=[...e],c=[...n];if(!a){a=new Array(o);for(let m=0;m<o;m++)a[m]=m/(o-1)*255}i||(i=new Array(o).fill(64),i[0]=0);let h=Uint8ClampedArray.from(i),d=Uint8ClampedArray.from(a);if(s)for(let m=0;m<o;m++)l[m]=r[o-1-m],u[m]=e[o-1-m],c[m]=n[o-1-m],h[m]=255-i[o-1-m],d[m]=255-a[o-1-m];const v=new Uint8ClampedArray(256*4);if(typeof d>"u"){d=new Uint8ClampedArray(o).fill(0);for(let m=0;m<o;m++)d[m]=Math.round(m*255/(o-1))}typeof h>"u"&&(h=new Uint8ClampedArray(o).fill(64),h[0]=0);for(let m=0;m<o-1;m++){const y=d[m];let b=d[m+1];m===0&&y!==0&&Q.warn("colormap issue: indices expected to start with 0 not ",y),m===d.length-2&&b!==255&&(Q.warn("padding colormap: indices expected end with 255 not ",b),b=255);const x=b-y;let A=y*4;for(let C=y;C<=b;C++){const E=(C-y)/x;v[A++]=l[m]+E*(l[m+1]-l[m]),v[A++]=u[m]+E*(u[m+1]-u[m]),v[A++]=c[m]+E*(c[m+1]-c[m]),v[A++]=h[m]+E*(h[m+1]-h[m])}}if(this.gamma===1)return v;for(let m=0;m<1020;m++)m%4!==3&&(v[m]=Math.pow(v[m]/255,1/this.gamma)*255);return v}},Vt=new UG,ro=class{static getClusterBoundaryU8(r,e){const n=new Array(r.length).fill(!1),i=new Array(r.length).fill(!1);for(let o=0;o<r.length;o++)r[o]>0&&(i[o]=!0);const a=e.length/3;let s=0;for(let o=0;o<a;o++){const l=e[s],u=e[s+1],c=e[s+2];s+=3,!(i[l]===i[u]&&i[l]===i[c]&&i[u]===i[c])&&(n[l]=!0,n[u]=!0,n[c]=!0)}return n}static async gzip(r){const e=new CompressionStream("gzip"),n=e.writable.getWriter();n.write(r).catch(console.error);const i=n.close().catch(console.error),a=new Response(e.readable),s=new Uint8Array(await a.arrayBuffer());return await i,s}static createMZ3(r,e,n=!1,i=null){const s=i instanceof Uint8Array&&i.length===r.length/3*4,o=s?7:3,l=e.length/3,u=r.length/3,c=0,h=16,d=l*3*4,v=u*3*4,m=h+d+v,y=new ArrayBuffer(m),b=new DataView(y);b.setUint16(0,23117,!0),b.setUint16(2,o,!0),b.setUint32(4,l,!0),b.setUint32(8,u,!0),b.setUint32(12,c,!0);let x=h;if(new Uint32Array(y,x,e.length).set(e),x+=d,new Float32Array(y,x,r.length).set(r),s&&(x+=v,new Uint8Array(y,x,i.length).set(i)),n)throw new Error("Call async createMZ3Async() for compression");return y}static async createMZ3Async(r,e,n=!1,i=null){const a=this.createMZ3(r,e,n,i);return n?await this.gzip(new Uint8Array(a)):a}static createOBJ(r,e){let n="";for(let s=0;s<r.length;s+=3)n+=`v ${r[s]} ${r[s+1]} ${r[s+2]}
`;for(let s=0;s<e.length;s+=3)n+=`f ${e[s]+1} ${e[s+1]+1} ${e[s+2]+1}
`;return new TextEncoder().encode(n).buffer}static createSTL(r,e){const n=e.length/3,i=84+n*50,a=new ArrayBuffer(i),s=new DataView(a);for(let l=0;l<80;l++)s.setUint8(l,0);s.setUint32(80,n,!0);let o=84;for(let l=0;l<e.length;l+=3){const u=e[l]*3,c=e[l+1]*3,h=e[l+2]*3;s.setFloat32(o,0,!0),s.setFloat32(o+4,0,!0),s.setFloat32(o+8,0,!0),o+=12,s.setFloat32(o,r[u],!0),s.setFloat32(o+4,r[u+1],!0),s.setFloat32(o+8,r[u+2],!0),o+=12,s.setFloat32(o,r[c],!0),s.setFloat32(o+4,r[c+1],!0),s.setFloat32(o+8,r[c+2],!0),o+=12,s.setFloat32(o,r[h],!0),s.setFloat32(o+4,r[h+1],!0),s.setFloat32(o+8,r[h+2],!0),o+=12,s.setUint16(o,0,!0),o+=2}return a}static downloadArrayBuffer(r,e){const n=new Blob([r],{type:"application/octet-stream"}),i=URL.createObjectURL(n),a=document.createElement("a");a.href=i,a.download=e,document.body.appendChild(a),a.style.display="none",a.click(),setTimeout(()=>{document.body.removeChild(a),URL.revokeObjectURL(i)},0)}static async saveMesh(r,e,n=".mz3",i=!1){let a=new ArrayBuffer(0);return/\.obj$/i.test(n)?a=this.createOBJ(r,e):/\.stl$/i.test(n)?a=this.createSTL(r,e):(/\.mz3$/i.test(n)||(n+=".mz3"),a=await this.createMZ3Async(r,e,i)),n.length>4&&this.downloadArrayBuffer(a,n),a}static getClusterBoundary(r,e){const n=new Uint32Array(r.buffer),i=new Array(n.length).fill(!1),a=e.length/3;let s=0;for(let o=0;o<a;o++){const l=e[s],u=e[s+1],c=e[s+2];s+=3,!(n[l]===n[u]&&n[l]===n[c]&&n[u]===n[c])&&(i[l]=!0,i[u]=!0,i[c]=!0)}return i}static getExtents(r){if(!ArrayBuffer.isView(r)&&!Array.isArray(r)||r.length<3)return{mxDx:0,extentsMin:0,extentsMax:0};let e=0;const n=Me(r[0],r[1],r[2]),i=Me(r[0],r[1],r[2]);for(let o=0;o<r.length;o+=3){const l=Me(r[o],r[o+1],r[o+2]);e=Math.max(e,Zc(l)),$2(n,n,l),ey(i,i,l)}const a=[n[0],n[1],n[2]],s=[i[0],i[1],i[2]];return{mxDx:e,extentsMin:a,extentsMax:s}}static generateNormals(r,e){const n=[];let i;const a=r.length;let s,o,l,u,c,h,d,v,m;const y=new Float32Array(a),b=e.length;for(i=0;i<b;i+=3){d=e[i]*3,v=e[i+1]*3,m=e[i+2]*3;const x=[r[d],r[d+1],r[d+2]],A=[r[v],r[v+1],r[v+2]],C=[r[m],r[m+1],r[m+2]];s=A[0]-x[0],o=A[1]-x[1],l=A[2]-x[2],u=C[0]-x[0],c=C[1]-x[1],h=C[2]-x[2],n[0]=c*l-h*o,n[1]=h*s-u*l,n[2]=u*o-c*s,y[d]+=n[0],y[d+1]+=n[1],y[d+2]+=n[2],y[v]+=n[0],y[v+1]+=n[1],y[v+2]+=n[2],y[m]+=n[0],y[m+1]+=n[1],y[m+2]+=n[2]}for(i=0;i<a;i+=3){n[0]=-1*y[i],n[1]=-1*y[i+1],n[2]=-1*y[i+2];let x=n[0]*n[0]+n[1]*n[1]+n[2]*n[2];x>0&&(x=1/Math.sqrt(x),n[0]*=x,n[1]*=x,n[2]*=x),y[i]=n[0],y[i+1]=n[1],y[i+2]=n[2]}return y}},rt,Tn,Pd,r2,wc,dT=class{constructor(r){oc(this,rt),oc(this,Tn,0),oc(this,Pd,[]),oc(this,r2,[]),oc(this,wc),xl(this,rt,new DataView(r)),this.read()}async extract(r){const e=new Uint8Array(Ge(this,rt).buffer.slice(r.startsAt,r.startsAt+r.compressedSize));if(r.compressionMethod===0)return e;if(r.compressionMethod===8){const n=new DecompressionStream("deflate-raw"),i=n.writable.getWriter();i.write(e).catch(console.error);const a=i.close().catch(console.error),s=new Response(n.readable),o=new Uint8Array(await s.arrayBuffer());return await a,o}throw new Error(`Unsupported compression method: ${r.compressionMethod}`)}read(){for(;!Ge(this,wc)&&Ge(this,Tn)<Ge(this,rt).byteLength;){const r=Ge(this,rt).getUint32(Ge(this,Tn),!0);if(r===67324752){const e=this.readLocalFile(Ge(this,Tn));e.extract=this.extract.bind(this,e),Ge(this,Pd).push(e);const n=(e.generalPurpose&8)!==0;if(e.startsAt=Ge(this,Tn)+30+e.fileNameLength+e.extraLength,e.compressedSize===0&&n){let i=e.startsAt;for(;i+20<=Ge(this,rt).byteLength;){if(Ge(this,rt).getUint32(i,!0)===134695760&&Ge(this,rt).getUint16(i+16,!0)===19280){i+=4;break}i++}e.crc=Ge(this,rt).getUint32(i,!0),e.compressedSize=Ge(this,rt).getUint32(i+4,!0),e.uncompressedSize=Ge(this,rt).getUint32(i+8,!0),xl(this,Tn,i+12)}else xl(this,Tn,e.startsAt+e.compressedSize)}else if(r===33639248){const e=this.readCentralDirectory(Ge(this,Tn));Ge(this,r2).push(e),xl(this,Tn,Ge(this,Tn)+(46+e.fileNameLength+e.extraLength+e.fileCommentLength))}else if(r===101010256){xl(this,wc,this.readEndCentralDirectory(Ge(this,Tn)));break}else if(r===101075792){xl(this,wc,this.readEndCentralDirectory64(Ge(this,Tn)));break}else{console.error(`Unexpected ZIP signature 0x${r.toString(16).padStart(8,"0")} at index ${Ge(this,Tn)}`);break}}}readLocalFile(r){let e=Ge(this,rt).getUint32(r+18,!0),n=Ge(this,rt).getUint32(r+22,!0);const i=Ge(this,rt).getUint16(r+26,!0),a=Ge(this,rt).getUint16(r+28,!0),s=r+30+i;if(this.readString(s,a),e===4294967295&&n===4294967295){let o=s,l=!1;for(;o<s+a-4;){const u=Ge(this,rt).getUint16(o,!0),c=Ge(this,rt).getUint16(o+2,!0);if(o+=4,u===1)if(c>=16){n=Number(Ge(this,rt).getBigUint64(o,!0)),o+=8,e=Number(Ge(this,rt).getBigUint64(o,!0)),l=!0;break}else throw new Error(`ZIP64 extra field found but is too small (expected at least 16 bytes, got ${c}).`);o+=c}if(!l)throw new Error("ZIP64 format missing extra field with signature 0x0001.")}return{signature:this.readString(r,4),version:Ge(this,rt).getUint16(r+4,!0),generalPurpose:Ge(this,rt).getUint16(r+6,!0),compressionMethod:Ge(this,rt).getUint16(r+8,!0),lastModifiedTime:Ge(this,rt).getUint16(r+10,!0),lastModifiedDate:Ge(this,rt).getUint16(r+12,!0),crc:Ge(this,rt).getUint32(r+14,!0),compressedSize:e,uncompressedSize:n,fileNameLength:i,extraLength:a,fileName:this.readString(r+30,i),extra:this.readString(r+30+i,a)}}readCentralDirectory(r){return{versionCreated:Ge(this,rt).getUint16(r+4,!0),versionNeeded:Ge(this,rt).getUint16(r+6,!0),fileNameLength:Ge(this,rt).getUint16(r+28,!0),extraLength:Ge(this,rt).getUint16(r+30,!0),fileCommentLength:Ge(this,rt).getUint16(r+32,!0),diskNumber:Ge(this,rt).getUint16(r+34,!0),internalAttributes:Ge(this,rt).getUint16(r+36,!0),externalAttributes:Ge(this,rt).getUint32(r+38,!0),offset:Ge(this,rt).getUint32(r+42,!0),comments:this.readString(r+46,Ge(this,rt).getUint16(r+32,!0))}}readEndCentralDirectory(r){const e=Ge(this,rt).getUint16(r+20,!0);return{numberOfDisks:Ge(this,rt).getUint16(r+4,!0),centralDirectoryStartDisk:Ge(this,rt).getUint16(r+6,!0),numberCentralDirectoryRecordsOnThisDisk:Ge(this,rt).getUint16(r+8,!0),numberCentralDirectoryRecords:Ge(this,rt).getUint16(r+10,!0),centralDirectorySize:Ge(this,rt).getUint32(r+12,!0),centralDirectoryOffset:Ge(this,rt).getUint32(r+16,!0),commentLength:e,comment:this.readString(r+22,e)}}readEndCentralDirectory64(r){const e=Number(Ge(this,rt).getBigUint64(r+0,!0));return{numberOfDisks:Ge(this,rt).getUint32(r+16,!0),centralDirectoryStartDisk:Ge(this,rt).getUint32(r+20,!0),numberCentralDirectoryRecordsOnThisDisk:Number(Ge(this,rt).getBigUint64(r+24,!0)),numberCentralDirectoryRecords:Number(Ge(this,rt).getBigUint64(r+32,!0)),centralDirectorySize:Number(Ge(this,rt).getBigUint64(r+40,!0)),centralDirectoryOffset:Number(Ge(this,rt).getBigUint64(r+48,!0)),commentLength:e,comment:""}}readString(r,e){return Array.from({length:e},(n,i)=>String.fromCharCode(Ge(this,rt).getUint8(r+i))).join("")}get entries(){return Ge(this,Pd)}};rt=new WeakMap;Tn=new WeakMap;Pd=new WeakMap;r2=new WeakMap;wc=new WeakMap;var Oe=class El{static arrayBufferToBase64(e){const n=new Uint8Array(e);return El.uint8tob64(n)}static async decompress(e){const n=e[0]===31&&e[1]===139&&e[2]===8?"gzip":e[0]===120&&(e[1]===1||e[1]===94||e[1]===156||e[1]===218)?"deflate":"deflate-raw",i=new DecompressionStream(n),a=i.writable.getWriter();a.write(e).catch(console.error);const s=a.close().catch(console.error),o=new Response(i.readable),l=new Uint8Array(await o.arrayBuffer());return await s,l}static async decompressToBuffer(e){const n=await El.decompress(e);return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}static async readMatV4(e,n=!1){let i=e.byteLength;if(i<40)throw new Error("File too small to be MAT v4: bytes = "+e.byteLength);let a=new DataView(e),s=a.getUint16(0,!0),o=e;if(s===35615||s===8075){const y=await this.decompress(new Uint8Array(e));a=new DataView(y.buffer),s=a.getUint16(0,!0),o=y.buffer,i=o.byteLength}const l=new TextDecoder("utf-8"),u=new Uint8Array(o);let c=0;const h={};function d(y){return Math.floor(y/10)%10}function v(y,b,x){const A=new Uint8Array(u.subarray(b,x));return y===1?new Float32Array(A.buffer):y===2?new Int32Array(A.buffer):y===3?new Int16Array(A.buffer):y===4?new Uint16Array(A.buffer):y===5?new Uint8Array(A.buffer):new Float64Array(A.buffer)}function m(){const y=a.getUint32(c,!0),b=a.getUint32(c+4,!0),x=a.getUint32(c+8,!0),A=a.getUint32(c+12,!0),C=a.getUint32(c+16,!0);if(c+=20,A!==0)throw new Error("Matlab V4 reader does not support imaginary numbers");const E=b*x;if(E<1)throw new Error("mrows * ncols must be greater than one");const S=new Uint8Array(u.subarray(c,c+C));let T=l.decode(S).trim().replaceAll("\0","");n&&(T=T.replaceAll(".","_"));const R=d(y);let D=8;if(R>=1&&R<=2)D=4;else if(R>=3&&R<=4)D=2;else if(R===5)D=1;else if(R!==0)throw new Error("impossible Matlab v4 datatype");if(c+=C,y>50)throw new Error("Does not appear to be little-endian V4 Matlab file");const B=c+E*D;h[T]=v(R,c,B),c=B}for(;c+20<i;)m();return h}static b64toUint8(e){const n=atob(e),i=n.length,a=new Uint8Array(i);for(let s=0;s<i;s++)a[s]=n.charCodeAt(s);return a}static uint8tob64(e){let n="";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=e.byteLength,s=a%3,o=a-s;let l,u,c,h,d;for(let v=0;v<o;v=v+3)d=e[v]<<16|e[v+1]<<8|e[v+2],l=(d&16515072)>>18,u=(d&258048)>>12,c=(d&4032)>>6,h=d&63,n+=i[l]+i[u]+i[c]+i[h];return s===1?(d=e[o],l=(d&252)>>2,u=(d&3)<<4,n+=i[l]+i[u]+"=="):s===2&&(d=e[o]<<8|e[o+1],l=(d&64512)>>10,u=(d&1008)>>4,c=(d&15)<<2,n+=i[l]+i[u]+i[c]+"="),n}static download(e,n,i){const a=document.createElement("a"),s=Array.isArray(e)?e:[e],o=new Blob(s,{type:i});a.href=URL.createObjectURL(o),a.download=n,a.click()}static readFileAsync(e){return new Promise((n,i)=>{const a=new FileReader;a.onload=()=>{n(a.result)},a.onerror=i,a.readAsArrayBuffer(e)})}static blobToBase64(e){return new Promise(n=>{const i=new FileReader;i.onloadend=()=>n(i.result),i.readAsDataURL(e)})}static async decompressBase64String(e){const n=atob(e),i=new ArrayBuffer(n.length),a=new Uint8Array(i);for(let s=0;s<n.length;s++)a[s]=n.charCodeAt(s);return El.decompressArrayBuffer(a)}static async compressToBase64String(e){const n=await El.compressStringToArrayBuffer(e);return El.uint8tob64(new Uint8Array(n))}static strToU8(e,n){if(n){const u=new Uint8Array(e.length);for(let c=0;c<e.length;++c)u[c]=e.charCodeAt(c);return u}const i=e.length,a=(u,c,h)=>((h==null||h>u.length)&&(h=u.length),new Uint8Array(u.subarray(c,h)));let s=new Uint8Array(e.length+(e.length>>1)),o=0;const l=u=>{s[o++]=u};for(let u=0;u<i;++u){if(o+5>s.length){const h=new Uint8Array(o+8+(i-u<<1));h.set(s),s=h}let c=e.charCodeAt(u);c<128||n?l(c):c<2048?(l(192|c>>6),l(128|c&63)):(c>55295&&c<57344,c=65536+(c&1047552)|e.charCodeAt(++u)&1023,l(240|c>>18),l(128|c>>12&63),l(128|c>>6&63),l(128|c&63))}return a(s,0,o)}static async compress(e,n="gzip"){const i=new CompressionStream(n),a=i.writable.getWriter();a.write(e).catch(console.error);const s=a.close().catch(console.error),l=await new Response(i.readable).arrayBuffer();return await s,l}static async compressStringToArrayBuffer(e){const n=this.strToU8(e);return await this.compress(n)}static isArrayBufferCompressed(e){if(e&&e.byteLength){const n=new Uint8Array(e);return(n[0]<<8|n[1])===8075}else return!1}static strFromU8(e,n){if(n){let i="";for(let a=0;a<e.length;a+=16384)i+=String.fromCharCode.apply(null,e.subarray(a,a+16384));return i}else{const i=(l,u,c)=>((u==null||u<0)&&(u=0),(c==null||c>l.length)&&(c=l.length),new Uint8Array(l.subarray(u,c))),a=l=>{for(let u="",c=0;;){let h=l[c++];const d=(h>127)+(h>223)+(h>239);if(c+d>l.length)return{s:u,r:i(l,c-1)};d?d===3?(h=((h&15)<<18|(l[c++]&63)<<12|(l[c++]&63)<<6|l[c++]&63)-65536,u+=String.fromCharCode(55296|h>>10,56320|h&1023)):d&1?u+=String.fromCharCode((h&31)<<6|l[c++]&63):u+=String.fromCharCode((h&15)<<12|(l[c++]&63)<<6|l[c++]&63):u+=String.fromCharCode(h)}},{s,r:o}=a(e);if(o.length)throw new Error("Unexpected trailing bytes in UTF-8 decoding");return s}}static async decompressArrayBuffer(e){const n=await this.decompress(new Uint8Array(e));return this.strFromU8(n)}static arraysAreEqual(e,n){return G_(e,n)}static range(e,n,i){return Array.from({length:(n-e)/i+1},(a,s)=>e+s*i)}static sph2cartDeg(e,n){const i=-n*(Math.PI/180),a=(e-90)%360*(Math.PI/180),s=[Math.cos(i)*Math.cos(a),Math.cos(i)*Math.sin(a),Math.sin(i)],o=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);return o<=0||(s[0]/=o,s[1]/=o,s[2]/=o),s}static vox2mm(e,n){const i=Er(n);Yn(i,i);const a=er(e[0],e[1],e[2],1);return qr(a,a,i),Me(a[0],a[1],a[2])}},lc=Q,lr=class _r{static readTRACT(e){const n=e.byteLength;if(n<20)throw new Error("File too small to be niml.tract: bytes = "+n);const i=new DataView(e),a=new Uint8Array(e);let s=0;function o(){for(;s<n&&a[s]!==60;)s++;const b=s;for(;s<n&&a[s]!==62;)s++;return s++,s-b<1?"":new TextDecoder().decode(e.slice(b,s-1)).trim()}let l=o();function u(b){const x=l.indexOf(b);if(x<0)return 0;const A=l.indexOf('"',x)+1,C=l.indexOf('"',A),E=l.slice(A,C);return parseInt(E)}const c=u("N_tracts=");(!l.startsWith("<network")||c<1)&&Q.warn("This is not a valid niml.tract file "+l);let h=0;const d=[];d.push(h);const v=[],m=[];for(let b=0;b<c;b++){l=o();const x=u("ni_dimen="),A=u("Bundle_Tag="),C=l.includes("binary.lsbfirst");for(let E=0;E<x;E++){s+=4;const S=i.getUint32(s,C)/3;s+=4;for(let T=0;T<S;T++)v.push(i.getFloat32(s,C)),s+=4,v.push(-i.getFloat32(s,C)),s+=4,v.push(i.getFloat32(s,C)),s+=4;h+=S,d.push(h),m.push(A)}l=o()}const y=[];return y.push({id:"tract",vals:Float32Array.from(m)}),{pts:new Float32Array(v),offsetPt0:new Uint32Array(d),dps:y}}static async readTT(e){let n=new Uint32Array(0),i=new Float32Array(0);const a=await Oe.readMatV4(e);if(!("trans_to_mni"in a))throw new Error("TT format file must have 'trans_to_mni'");if(!("voxel_size"in a))throw new Error("TT format file must have 'voxel_size'");if(!("track"in a))throw new Error("TT format file must have 'track'");let s=Tt();const o=a.trans_to_mni;s=Hn(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15]),Yn(s,s);function l(u){const c=new DataView(u.buffer),h=[];let d=0,v=0;for(;v<u.length;){h.push(v);const b=c.getUint32(v,!0);v=v+b+13,d+=b}n=new Uint32Array(h.length+1),i=new Float32Array(d);let m=0;for(let b=0;b<h.length;b++){n[b]=m/3;let x=h[b];const A=c.getUint32(x,!0)/3;let C=c.getInt32(x+4,!0),E=c.getInt32(x+8,!0),S=c.getInt32(x+12,!0);x+=16,i[m++]=C,i[m++]=E,i[m++]=S;for(let T=2;T<=A;T++)C=C+c.getInt8(x++),E=E+c.getInt8(x++),S=S+c.getInt8(x++),i[m++]=C,i[m++]=E,i[m++]=S}for(let b=0;b<m;b++)i[b]=i[b]/32;let y=0;for(let b=0;b<m/3;b++){const x=er(i[y],i[y+1],i[y+2],1);qr(x,x,s),i[y++]=x[0],i[y++]=x[1],i[y++]=x[2]}n[h.length]=m/3}return l(a.track),{pts:i,offsetPt0:n}}static async readTRX(e){function n(m){const y=(m&31744)>>10,b=m&1023;return(m>>15?-1:1)*(y?y===31?b?NaN:1/0:Math.pow(2,y-15)*(1+b/1024):6103515625e-14*(b/1024))}let i=0,a=0,s=new Float32Array([]);const o=[],l=[],u=[],c=[];let h=[],d=!1;const v=new dT(e);for(let m=0;m<v.entries.length;m++){const y=v.entries[m];if(y.uncompressedSize===0)continue;const b=y.fileName.split("/"),x=b.slice(-1)[0];if(x.startsWith("."))continue;const A=b.slice(-2)[0],C=x.split(".")[0],E=await y.extract();if(x.includes("header.json")){const R=new TextDecoder().decode(E);h=JSON.parse(R);continue}let S=0,T=[];if(x.endsWith(".uint64")||x.endsWith(".int64")){S=E.length/8,T=new Uint32Array(S);const R=new Uint32Array(E.buffer);let D=0;for(let B=0;B<S;B++)T[B]=R[D],R[D+1]!==0&&(d=!0),D+=2}else if(x.endsWith(".uint32"))T=new Uint32Array(E.buffer);else if(x.endsWith(".uint16"))T=new Uint16Array(E.buffer);else if(x.endsWith(".uint8"))T=new Uint8Array(E.buffer);else if(x.endsWith(".int32"))T=new Int32Array(E.buffer);else if(x.endsWith(".int16"))T=new Int16Array(E.buffer);else if(x.endsWith(".int8"))T=new Int8Array(E.buffer);else if(x.endsWith(".float64"))T=new Float64Array(E.buffer);else if(x.endsWith(".float32"))T=new Float32Array(E.buffer);else if(x.endsWith(".float16")){S=E.length/2,T=new Float32Array(S);const R=new Uint16Array(E.buffer),D=new Float32Array(65536);for(let B=0;B<65536;B++)D[B]=n(B);for(let B=0;B<S;B++)T[B]=D[R[B]]}else continue;if(S=T.length,A.includes("groups")){l.push({id:C,vals:Float32Array.from(T.slice())});continue}if(A.includes("dpv")){c.push({id:C,vals:Float32Array.from(T.slice())});continue}if(A.includes("dps")){u.push({id:C,vals:Float32Array.from(T.slice())});continue}if(x.startsWith("offsets.")){i=S;for(let R=0;R<S;R++)o[R]=T[R]}x.startsWith("positions.3.")&&(a=S,s=new Float32Array(T))}if(i===0||a===0)throw new Error("Failure reading TRX format (no offsets or points).");if(d)throw new Error("Too many vertices: JavaScript does not support 64 bit integers");return o[i]=a/3,{pts:s,offsetPt0:new Uint32Array(o),dpg:l,dps:u,dpv:c,header:h}}static readTSF(e,n=0){const i=new Float32Array(n),a=e.byteLength;if(a<20)throw new Error("File too small to be TSF: bytes = "+a);const s=new Uint8Array(e);let o=0;function l(){for(;o<a&&s[o]===10;)o++;const v=o;for(;o<a&&s[o]!==10;)o++;return o++,o-v<1?"":new TextDecoder().decode(e.slice(v,o-1))}let u=l();if(!u.includes("mrtrix track scalars"))throw new Error("Not a valid TSF file");let c=-1;for(;o<a&&!u.includes("END");)if(u=l(),u.toLowerCase().startsWith("file:")&&(c=parseInt(u.split(" ").pop())),u.toLowerCase().startsWith("datatype:")&&!u.endsWith("Float32LE"))throw new Error("Only supports TSF files with Float32LE");if(c<20)throw new Error("Not a valid TSF file (missing file offset)");o=c;const h=new DataView(e);let d=0;for(;o+4<=a&&d<n;){const v=h.getFloat32(o,!0);if(o+=4,isFinite(v))i[d++]=v;else if(!isNaN(v))break}return i}static readTCK(e){const n=e.byteLength;if(n<20)throw new Error("File too small to be TCK: bytes = "+n);const i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]===10;)a++;const y=a;for(;a<n&&i[a]!==10;)a++;return a++,a-y<1?"":new TextDecoder().decode(e.slice(y,a-1))}let o=s();if(!o.includes("mrtrix tracks"))throw new Error("Not a valid TCK file");let l=-1;for(;a<n&&!o.includes("END");)o=s(),o.toLowerCase().startsWith("file:")&&(l=parseInt(o.split(" ").pop()));if(l<20)throw new Error("Not a valid TCK file (missing file offset)");a=l;const u=new DataView(e);let c=0,h=new Uint32Array(n/16),d=0,v=0,m=new Float32Array(n/4);for(h[0]=0;a+12<n;){const y=u.getFloat32(a,!0);a+=4;const b=u.getFloat32(a,!0);a+=4;const x=u.getFloat32(a,!0);if(a+=4,isFinite(y))m[v++]=y,m[v++]=b,m[v++]=x,c++;else if(h[d++]=c,!isNaN(y))break}return m=m.slice(0,v),h=h.slice(0,d),{pts:m,offsetPt0:h}}static async readTRK(e){let n=new DataView(e),i=n.getUint32(0,!0);if(i!==1128354388){let P;if(i===4247762216)throw new Error("zstd TRK decompression is not supported");P=await Oe.decompress(new Uint8Array(e)),e=P.buffer,n=new DataView(e),i=n.getUint32(0,!0)}const a=n.getUint32(992,!0),s=n.getUint32(996,!0);if(a>2||s!==1e3||i!==1128354388)throw new Error("Not a valid TRK file");const o=n.getInt16(36,!0),l=[];for(let P=0;P<o;P++){const F=new Uint8Array(e.slice(38+P*20,58+P*20)),O=new TextDecoder().decode(F).split("\0").shift();l.push({id:O.trim(),vals:[]})}const u=n.getFloat32(12,!0),c=n.getFloat32(16,!0),h=n.getFloat32(20,!0),d=Hn(1/u,0,0,-.5,0,1/c,0,-.5,0,0,1/h,-.5,0,0,0,1),v=n.getInt16(238,!0),m=[];for(let P=0;P<v;P++){const F=new Uint8Array(e.slice(240+P*20,260+P*20)),O=new TextDecoder().decode(F).split("\0").shift();m.push({id:O.trim(),vals:[]})}const y=Tt();for(let P=0;P<16;P++)y[P]=n.getFloat32(440+P*4,!0);y[15]===0&&(Q.warn("TRK vox_to_ras not set"),q6(y));const b=Tt();G6(b,d,y);let x=null,A=null;x=new Int32Array(e.slice(s)),A=new Float32Array(x.buffer);const C=x.length;if(C<1)throw new Error("Empty TRK file.");let E=0,S=0,T=new Uint32Array(x.length/4),R=0,D=new Float32Array(x.length),B=0;for(;E<C;){const P=x[E];E=E+1,T[R++]=S;for(let F=0;F<P;F++){const O=A[E+0],U=A[E+1],L=A[E+2];if(E+=3,D[B++]=O*b[0]+U*b[1]+L*b[2]+b[3],D[B++]=O*b[4]+U*b[5]+L*b[6]+b[7],D[B++]=O*b[8]+U*b[9]+L*b[10]+b[11],o>0)for(let V=0;V<o;V++)l[V].vals.push(A[E]),E++;S++}if(v>0)for(let F=0;F<v;F++)m[F].vals.push(A[E]),E++}const N=[];for(let P=0;P<m.length;P++)N.push({id:m[P].id,vals:Float32Array.from(m[P].vals)});const I=[];for(let P=0;P<l.length;P++)I.push({id:l[P].id,vals:Float32Array.from(l[P].vals)});return T[R++]=S,D=D.slice(0,B),T=T.slice(0,R),{pts:D,offsetPt0:T,dps:N,dpv:I}}static readTxtVTK(e){const a=new TextDecoder("utf-8").decode(e).split(`
`);if(a.length<7||!a[0].startsWith("# vtk DataFile"))throw new Error("Invalid VTK image");if(!a[2].startsWith("ASCII"))throw new Error("Not ASCII VTK mesh");let o=3;for(;a[o].length<1;)o++;if(!a[o].includes("POLYDATA"))throw new Error("Not ASCII VTK polydata");for(o++;a[o].length<1;)o++;if(!a[o].startsWith("POINTS"))throw new Error("Not VTK POINTS");let l=a[o].trim().split(/\s+/);const u=parseInt(l[1]),c=u*3,h=new Float32Array(u*3);let d=0;for(;d<u*3;){o++;const b=a[o].trim().trim().split(/\s+/);for(let x=0;x<b.length&&!(d>=c);x++)h[d]=parseFloat(b[x]),d++}const v=[];for(o++;a[o].length<1;)o++;if(a[o].startsWith("METADATA")){for(;a[o].length>1;)o++;o++}if(l=a[o].trim().split(/\s+/),o++,l[0].includes("LINES")){const y=parseInt(l[1]);if(y<1)throw new Error("Corrupted VTK ASCII");let b=a[o].trim();const x=[];let A=[];if(b.startsWith("OFFSETS")){o++;let C=0;for(;C<y;){b=a[o].trim(),o++;const E=b.trim().split(/\s+/);for(let S=0;S<E.length&&(x[C]=parseInt(E[S]),C++,!(C>=y));S++);}A=Array.from(h)}else{let C=function(){b=a[o].trim();const R=b.trim().split(/\s+/);S=[];for(let D=0;D<R.length;D++)S.push(parseInt(R[D]));T=0,o++},E=0;x[0]=0;let S=[],T=0;C();for(let R=0;R<y;R++){T>=S.length&&C();const D=S[T++];E+=D,x[R+1]=E;for(let B=0;B<D;B++){T>=S.length&&C();const N=S[T++]*3;A.push(h[N+0]),A.push(h[N+1]),A.push(h[N+2])}}}return{pts:Float32Array.from(A),offsetPt0:Uint32Array.from(x)}}else if(l[0].includes("TRIANGLE_STRIPS")){const y=parseInt(l[1]);for(let b=0;b<y;b++){const x=a[o].trim();o++;const A=x.trim().split(/\s+/),C=parseInt(A[0])-2;let E=1;for(let S=0;S<C;S++)S%2?(v.push(parseInt(A[E+2])),v.push(parseInt(A[E+1])),v.push(parseInt(A[E]))):(v.push(parseInt(A[E])),v.push(parseInt(A[E+1])),v.push(parseInt(A[E+2]))),E+=1}}else if(l[0].includes("POLYGONS")){const y=parseInt(l[1]);for(let b=0;b<y;b++){const x=a[o].trim();o++;const A=x.trim().split(/\s+/),C=parseInt(A[0])-2,E=parseInt(A[1]);let S=parseInt(A[2]);for(let T=0;T<C;T++){const R=parseInt(A[3+T]);v.push(E),v.push(S),v.push(R),S=R}}}else throw new Error("Unsupported ASCII VTK datatype "+l[0]);const m=new Uint32Array(v);return{positions:h,indices:m}}static async readLayer(e="",n,i,a=.5,s="warm",o="winter",l=!1,u=null,c=null,h=0){const d={...KG,colormapInvert:!1,colormapType:0,isTransparentBelowCalMin:!0,isAdditiveBlend:!1,colorbarVisible:!0,colormapLabel:null},v=/(?:\.([^.]+))?$/;let m=v.exec(e)[1];m=m.toUpperCase(),m==="GZ"&&(m=v.exec(e.slice(0,-3))[1],m=m.toUpperCase());const y=i.vertexCount/3;if(i.offsetPt0){if(m!=="TSF")throw new Error("readLayer for streamlines only supports TSF files.");const A=i.pts.length/3,C=e.split("/");let E="Unknown";C.length>1&&C.pop()&&(E=E.split(".").slice(0,-1).join("."));const S=_r.readTSF(n,A);i.dpv||(i.dpv=[]);const T=S.reduce((D,B)=>Math.min(D,B)),R=S.reduce((D,B)=>Math.max(D,B));return i.dpv.push({id:E,vals:Float32Array.from(S.slice()),global_min:T,global_max:R,cal_min:T,cal_max:R}),d}if(y<3){Q.error("n_vert < 3 in layer");return}if(m==="MZ3"){const A=await _r.readMZ3(n,y);d.values=A.scalars,"colormapLabel"in A&&(d.colormapLabel=A.colormapLabel)}else if(m==="ANNOT"){const A=_r.readANNOT(n,y,!0);A instanceof Uint32Array?d.values=A:(d.values=A.scalars,d.colormapLabel=A.colormapLabel)}else if(m==="CRV"||m==="CURV"||m==="THICKNESS"||m==="AREA")d.values=_r.readCURV(n,y),d.isTransparentBelowCalMin=!1;else if(m==="GII"){const A=await _r.readGII(n,y);d.values=A.scalars,d.colormapLabel=A.colormapLabel}else if(m==="MGH"||m==="MGZ"){const A=await _r.readMGH(n,y,!0);"scalars"in A?(d.values=A.scalars,d.colormapLabel=A.colormapLabel):d.values=A}else if(m==="NII")d.values=await _r.readNII(n,y,i.anatomicalStructurePrimary);else if(m==="SMP")d.values=await _r.readSMP(n,y);else if(m==="STC")d.values=_r.readSTC(n,y);else if(_r.isCurv(n))d.values=_r.readCURV(n,y),d.isTransparentBelowCalMin=!1;else return Q.warn("Unknown layer overlay format "+e),d;if(!d.values){Q.error("no values in layer");return}d.nFrame4D=d.values.length/y,d.frame4D=0,d.outlineBorder=h;let b=d.values[0],x=d.values[0];for(let A=0;A<d.values.length;A++)b=Math.min(b,d.values[A]),x=Math.max(x,d.values[A]);return d.global_min=b,d.global_max=x,d.cal_min=u||0,u||(d.cal_min=b),d.cal_max=c||0,c||(d.cal_max=x),d.cal_minNeg=NaN,d.cal_maxNeg=NaN,d.opacity=a,d.colormap=s,d.colormapNegative=o,d.useNegativeCmap=l,d}static async readSMP(e,n){const i=e.byteLength;let a=new DataView(e),s=a.getUint16(0,!0);if(s>5){const d=await Oe.decompress(new Uint8Array(e));a=new DataView(d.buffer),s=a.getUint16(0,!0),e=d.buffer}s>5&&Q.error("Unsupported or invalid BrainVoyager SMP version "+s);const o=a.getUint32(2,!0);o!==n&&Q.error("SMP file has "+o+" vertices, background mesh has "+n);const l=a.getUint16(6,!0),u=new Float32Array(o*l);let c=9;function h(){const d=c;for(;c<i&&a.getUint8(c)!==0;)c++;return c++,new TextDecoder().decode(e.slice(d,c-1))}h();for(let d=0;d<l;d++){const v={};v.mapType=a.getUint32(c,!0),c+=4,s>=3&&v.mapType===3&&(v.nLags=a.getUint32(c,!0),c+=4,v.mnLag=a.getUint32(c,!0),c+=4,v.mxLag=a.getUint32(c,!0),c+=4,v.ccOverlay=a.getUint32(c,!0),c+=4),v.clusterSize=a.getUint32(c,!0),c+=4,v.clusterCheck=a.getUint8(c),c+=1,v.critThresh=a.getFloat32(c,!0),c+=4,v.maxThresh=a.getFloat32(c,!0),c+=4,s>=4&&(v.includeValuesGreaterThreshMax=a.getUint32(c,!0),c+=4),v.df1=a.getUint32(c,!0),c+=4,v.df2=a.getUint32(c,!0),c+=4,s>=5?(v.posNegFlag=a.getUint32(c,!0),c+=4):v.posNegFlag=3,v.cortexBonferroni=a.getUint32(c,!0),c+=4,v.posMinRGB=[0,0,0],v.posMaxRGB=[0,0,0],v.negMinRGB=[0,0,0],v.negMaxRGB=[0,0,0],s>=2&&(v.posMinRGB[0]=a.getUint8(c),c++,v.posMinRGB[1]=a.getUint8(c),c++,v.posMinRGB[2]=a.getUint8(c),c++,v.posMaxRGB[0]=a.getUint8(c),c++,v.posMaxRGB[1]=a.getUint8(c),c++,v.posMaxRGB[2]=a.getUint8(c),c++,s>=4&&(v.negMinRGB[0]=a.getUint8(c),c++,v.negMinRGB[1]=a.getUint8(c),c++,v.negMinRGB[2]=a.getUint8(c),c++,v.negMaxRGB[0]=a.getUint8(c),c++,v.negMaxRGB[1]=a.getUint8(c),c++,v.negMaxRGB[2]=a.getUint8(c),c++),v.enableSMPColor=a.getUint8(c),c++,s>=4&&(v.lut=h()),v.colorAlpha=a.getFloat32(c,!0),c+=4),v.name=h();const m=new Float32Array(e,c,o);u.set(m,d*o),c+=o*4}return u}static readSTC(e,n){const i=new DataView(e),a=i.getInt32(8,!1);if(a!==n)throw new Error("Overlay has "+a+" vertices, expected "+n);let s=12+a*4;const o=i.getUint32(s,!1);s+=4;const l=new Float32Array(o*a);for(let u=0;u<o*a;u++)l[u]=i.getFloat32(s,!1),s+=4;return l}static isCurv(e){const n=new DataView(e),i=n.getUint8(0),a=n.getUint8(1),s=n.getUint8(2);return i!==255||a!==255||s!==255?(lc.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),!1):!0}static readCURV(e,n){const i=new DataView(e),a=i.getUint8(0),s=i.getUint8(1),o=i.getUint8(2),l=i.getUint32(3,!1),u=i.getUint32(11,!1);if((a!==255||s!==255||o!==255)&&lc.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),n!==l)throw new Error("CURV file has different number of vertices ( "+l+")than mesh ("+n+")");if(e.byteLength<15+4*l*u)throw new Error("CURV file smaller than specified");const c=new Float32Array(u*l);let h=15;for(let y=0;y<u*l;y++)c[y]=i.getFloat32(h,!1),h+=4;let d=c[0],v=c[0];for(let y=0;y<c.length;y++)d=Math.min(d,c[y]),v=Math.max(v,c[y]);const m=1/(v-d);for(let y=0;y<c.length;y++)c[y]=1-(c[y]-d)*m;return c}static readANNOT(e,n,i=!1){const a=new DataView(e),s=a.getUint32(0,!1),o=this.decimateLayerVertices(s,n);if(n!==o)throw new Error("ANNOT file has different number of vertices than mesh");if(e.byteLength<4+8*s)throw new Error("ANNOT file smaller than specified");let l=0;const u=new Uint32Array(s);for(let E=0;E<s;E++){const S=a.getUint32(l+=4,!1);u[S]=a.getUint32(l+=4,!1)}if(!i)return u;let c=0;try{c=a.getInt32(l+=4,!1)}catch{return u}if(c!==1||a.getInt32(l+=4,!1)>0)return u;const v=a.getInt32(l+=4,!1),m=a.getInt32(l+=4,!1);l+=m;const y=a.getInt32(l+=4,!1);if(y<1)return u;const b={R:Array(v).fill(0),G:Array(v).fill(0),B:Array(v).fill(0),A:Array(v).fill(0),I:Array(v).fill(0),labels:Array(v).fill("")};for(let E=0;E<y;E++){const S=a.getInt32(l+=4,!1),T=a.getInt32(l+=4,!1);l+=4;let R="";for(let P=0;P<T;P++){const F=a.getUint8(l++);if(F===0)break;R+=String.fromCharCode(F)}l-=4;const D=a.getInt32(l+=4,!1),B=a.getInt32(l+=4,!1),N=a.getInt32(l+=4,!1),I=a.getInt32(l+=4,!1);if(S<0||S>=v){Q.warn("annot entry out of range");continue}b.R[S]=D,b.G[S]=B,b.B[S]=N,b.A[S]=I,b.I[S]=(I<<24)+(N<<16)+(B<<8)+D,b.labels[S]=R}const x=new Float32Array(s);x.fill(-1);let A=0;for(let E=0;E<n;E++){const S=u[E];for(let T=0;T<v;T++)if(b.I[T]===S){x[E]=T;break}x[E]<0&&(A++,x[E]=0)}A>0&&Q.error(`annot vertex colors do not match ${A} of ${s} vertices.`);for(let E=0;E<v;E++)b.I[E]=E;const C=Vt.makeLabelLut(b);return{scalars:x,colormapLabel:C}}static readNV(e){const n=e.byteLength,i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]===10;)a++;const v=a;for(;a<n&&i[a]!==10;)a++;return a++,a-v<1?"":new TextDecoder().decode(e.slice(v,a-1))}let o=0,l=0,u=0,c=0,h,d;for(;a<n;){const v=s();if(v.startsWith("#"))continue;const m=v.trim().split(/\s+/);if(o<1){o=parseInt(m[0]),h=new Float32Array(o*3);continue}if(u<o*3){h[u]=parseFloat(m[0]),h[u+1]=parseFloat(m[1]),h[u+2]=parseFloat(m[2]),u+=3;continue}if(l<1){l=parseInt(m[0]),d=new Uint32Array(l*3);continue}if(c>=l*3)break;d[c+2]=parseInt(m[0])-1,d[c+1]=parseInt(m[1])-1,d[c+0]=parseInt(m[2])-1,c+=3}return{positions:h,indices:d}}static readASC(e){const n=e.byteLength,i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]===10;)a++;const m=a;for(;a<n&&i[a]!==10;)a++;return a++,a-m<1?"":new TextDecoder().decode(e.slice(m,a-1))}let o=s();o.startsWith("#!ascii")||Q.warn("Invalid ASC mesh"),o=s();let l=o.trim().split(/\s+/);const u=parseInt(l[0]),c=parseInt(l[1]),h=new Float32Array(u*3);let d=0;for(let m=0;m<u;m++)o=s(),l=o.trim().split(/\s+/),h[d]=parseFloat(l[0]),h[d+1]=parseFloat(l[1]),h[d+2]=parseFloat(l[2]),d+=3;const v=new Uint32Array(c*3);d=0;for(let m=0;m<c;m++)o=s(),l=o.trim().split(/\s+/),v[d]=parseInt(l[0]),v[d+1]=parseInt(l[1]),v[d+2]=parseInt(l[2]),d+=3;return{positions:h,indices:v}}static readVTK(e){const n=e.byteLength;if(n<20)throw new Error("File too small to be VTK: bytes = "+e.byteLength);const i=new Uint8Array(e);let a=0;function s(b=!0){if(b)for(;a<n&&i[a]===10;)a++;const x=a;for(;a<n&&i[a]!==10;)a++;return a++,a-x<1?"":new TextDecoder().decode(e.slice(x,a-1))}let o=s();if(!o.startsWith("# vtk DataFile"))throw new Error("Invalid VTK mesh");if(o=s(!1),o=s(),o.startsWith("ASCII"))return _r.readTxtVTK(e);if(!o.startsWith("BINARY"))throw new Error("Invalid VTK image, expected ASCII or BINARY "+o);if(o=s(),!o.includes("POLYDATA"))throw new Error("Only able to read VTK POLYDATA "+o);o=s(),(!o.includes("POINTS")||!o.includes("double")&&!o.includes("float"))&&Q.warn("Only able to read VTK float or double POINTS"+o);const l=o.includes("double");let u=o.trim().split(/\s+/);const h=parseInt(u[1])*3,d=new Float32Array(h),v=new DataView(e);if(l)for(let b=0;b<h;b++)d[b]=v.getFloat64(a,!1),a+=8;else for(let b=0;b<h;b++)d[b]=v.getFloat32(a,!1),a+=4;o=s(),u=o.trim().split(/\s+/);const m=[];if(u[0].includes("LINES")){const b=parseInt(u[1]),x=a;if(o=s(),o.startsWith("OFFSETS")){let S=!1;o.includes("int64")&&(S=!0);const T=new Uint32Array(b);if(S){let D=!1;for(let B=0;B<b;B++){let N=v.getInt32(a,!1);N!==0&&(D=!0),a+=4,N=v.getInt32(a,!1),a+=4,T[B]=N}D&&Q.warn("int32 overflow: JavaScript does not support int64")}else for(let D=0;D<b;D++){const B=v.getInt32(a,!1);a+=4,T[D]=B}return{pts:d,offsetPt0:T}}a=x;let A=0;const C=[],E=[];C.push(A);for(let S=0;S<b;S++){const T=v.getInt32(a,!1);a+=4,A+=T,C.push(A);for(let R=0;R<T;R++){const D=v.getInt32(a,!1)*3;a+=4,E.push(d[D+0]),E.push(d[D+1]),E.push(d[D+2])}}return{pts:Float32Array.from(E),offsetPt0:Uint32Array.from(C)}}else if(u[0].includes("TRIANGLE_STRIPS")){const b=parseInt(u[1]);for(let x=0;x<b;x++){const A=v.getInt32(a,!1)-2;a+=4;for(let C=0;C<A;C++)C%2?(m.push(v.getInt32(a+8,!1)),m.push(v.getInt32(a+4,!1)),m.push(v.getInt32(a,!1))):(m.push(v.getInt32(a,!1)),m.push(v.getInt32(a+4,!1)),m.push(v.getInt32(a+8,!1))),a+=4;a+=8}}else if(u[0].includes("POLYGONS")){const b=parseInt(u[1]),x=a,A=s();if(A.startsWith("OFFSETS")){let C=A.includes("int64");const E=new Uint32Array(b);let S=!1;for(let B=0;B<b;B++)C&&(v.getInt32(a,!1)!==0&&(S=!0),a+=4),E[B]=v.getInt32(a,!1),a+=4;if(!Number.isSafeInteger(b)||b>=2147483648||S)throw new Error("values exceed 2GB limit");const T=s();if(!T.startsWith("CONNECTIVITY"))throw new Error("Expected CONNECTIVITY after OFFSETS");C=T.includes("int64");const R=E[b-1],D=new Uint32Array(R);for(let B=0;B<R;B++)C&&(a+=4),D[B]=v.getInt32(a,!1),a+=4;for(let B=0;B<b;B++){const N=B===0?0:E[B-1],I=E[B];for(let P=1;P<I-N-1;P++)m.push(D[N]),m.push(D[N+P]),m.push(D[N+P+1])}}else{a=x;for(let C=0;C<b;C++){const E=v.getInt32(a,!1)-2;if(C===0&&E>65535)throw new Error("Invalid VTK binary polygons using little-endian data (MRtrix)");a+=4;const S=v.getInt32(a,!1);a+=4;let T=v.getInt32(a,!1);a+=4;for(let R=0;R<E;R++){const D=v.getInt32(a,!1);a+=4,m.push(S,T,D),T=D}}}}else throw new Error("Unsupported binary VTK datatype "+u[0]);const y=new Uint32Array(m);return{positions:d,indices:y}}static readWRL(e){const n=new TextDecoder("utf-8").decode(e),i=/coord\s+Coordinate\s*\{\s*point\s*\[([\s\S]*?)\]/,a=/coordIndex\s*\[([\s\S]*?)\]/,s=/color\s+Color\s*\{\s*color\s*\[([\s\S]*?)\]/,o=i.exec(n),l=a.exec(n),u=s.exec(n);if(!o||!l)throw new Error("Invalid WRL file: Could not find vertices or indices.");const c=new Float32Array(o[1].trim().split(/[\s,]+/).map(Number));let h=null;if(u){h=new Float32Array(u[1].trim().split(/[\s,]+/).map(Number));const v=c.length/3;h.length!==v*3&&(console.warn(`Unexpected color count: expected ${v*3}, got ${h.length}`),h=null)}const d=new Uint32Array(l[1].trim().split(/[\s,]+/).map(Number).filter(v=>v!==-1));return{positions:c,indices:d,colors:h}}static readDFS(e){const n=new DataView(e),i=n.getUint32(0,!0),a=n.getUint16(4,!0);(i!==1599292996||a!==17740)&&Q.warn("Not a little-endian brainsuite DFS mesh");const s=n.getUint32(12,!0),o=n.getUint32(24,!0),l=n.getUint32(28,!0),u=n.getUint32(48,!0);let c=s;const h=new Uint32Array(e,c,o*3);c+=o*3*4;const d=new Float32Array(e,c,l*3);for(let m=0;m<l*3;m+=3){const y=d[m];d[m]=d[m+1],d[m+1]=y}let v;return u>=0&&(v=new Float32Array(e,u,l*3)),{positions:d,indices:h,colors:v}}static async readMZ3(e,n=0){if(e.byteLength<20)throw new Error("File too small to be mz3: bytes = "+e.byteLength);let i=new DataView(e),a=e,s=i.getUint16(0,!0);if(s===35615||s===8075){const N=await Oe.decompress(new Uint8Array(e));i=new DataView(N.buffer),s=i.getUint16(0,!0),a=N.buffer}const o=i.getUint16(2,!0),l=i.getUint32(4,!0);let u=i.getUint32(8,!0);const c=i.getUint32(12,!0);if(lc.debug("MZ3 magic %d attr %d face %d vert %d skip %d",s,o,l,u,c),s!==23117)throw new Error("Invalid MZ3 file");const h=(o&1)!==0,d=(o&2)!==0,v=(o&4)!==0;let m=(o&8)!==0;const y=(o&16)!==0,b=(o&32)!==0,x=(o&64)!==0;if(lc.debug(`isFace=${h} isVert=${d} isRGBA=${v} isSCALAR=${m} isDOUBLE=${y} isAOMAP=${b} isLOOKUP=${x}`),o>127)throw new Error("Unsupported future version of MZ3 file");let A=4;y&&(A=8);let C=0;if(n>0&&!h&&l<1&&!v&&(m=!0),m){const N=n||u,I=16+c+(h?l*12:0)+(d?N*12:0)+(v?N*4:0),P=Math.floor((a.byteLength-I)/A);u!==n&&P%n===0&&(u=n),C=Math.floor(P/u),C<1&&(Q.warn("Corrupt MZ3: file reports NSCALAR but not enough bytes"),m=!1)}if(u<3&&n<3)throw new Error("Not a mesh MZ3 file (maybe scalar)");n>0&&n!==u&&Q.warn("Layer has "+u+"vertices, but background mesh has "+n);let E=16+c;const S=new DataView(a);let T=null;if(h){T=new Uint32Array(l*3);for(let N=0;N<l*3;N++)T[N]=S.getUint32(E,!0),E+=4}let R=null;if(d){R=new Float32Array(u*3);for(let N=0;N<u*3;N++)R[N]=S.getFloat32(E,!0),E+=4}let D=null;if(v){D=new Float32Array(u*3);for(let N=0;N<u;N++){for(let I=0;I<3;I++)D[N*3+I]=S.getUint8(E++)/255;E++}}let B=new Float32Array;if(m&&C>0)if(y){const N=new Float64Array(C*u);for(let I=0;I<C*u;I++)N[I]=S.getFloat64(E,!0),E+=8;B=Float32Array.from(N)}else{B=new Float32Array(C*u);for(let N=0;N<C*u;N++)B[N]=S.getFloat32(E,!0),E+=4}if(n>0&&x&&m){const N=new TextDecoder("utf-8"),I=new Uint8Array(a,16,c),P=N.decode(I),F=JSON.parse(P),O=Vt.makeLabelLut(F);return{scalars:B,colormapLabel:O}}if(n>0&&v&&m){let N=B[0];for(let F=0;F<u;F++)N=Math.max(N,B[F]);const I={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let F=0;F<=N;F++)for(let O=0;O<u;O++)if(F===B[O]){const U=O*3;I.I.push(F),I.R.push(D[U]*255),I.G.push(D[U+1]*255),I.B.push(D[U+2]*255),I.A.push(255),I.labels.push(`${F}`);break}const P=Vt.makeLabelLut(I);return{scalars:B,colormapLabel:P}}return n>0?{scalars:B}:{positions:R,indices:T,scalars:B,colors:D}}static readPLY(e){const n=e.byteLength,i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]===10;)a++;const B=a;for(;a<n&&i[a]!==10;)a++;return a++,a-B<1?"":new TextDecoder().decode(e.slice(B,a-1))}let o=s();if(!o.startsWith("ply"))throw new Error("Not a valid PLY file");o=s();const l=o.includes("ascii");function u(B){if(B==="char"||B==="uchar"||B==="int8"||B==="uint8")return 1;if(B==="short"||B==="ushort"||B==="int16"||B==="uint16")return 2;if(B==="int"||B==="uint"||B==="int32"||B==="uint32"||B==="float"||B==="float32")return 4;if(B==="double")return 8;throw new Error("Unknown data type: "+B)}const c=o.includes("binary_little_endian");let h=0,d=!1,v=0,m=0,y=0,b=0,x=0,A=0,C=0;for(;a<n&&!o.startsWith("end_header");){if(o=s(),o.startsWith("comment"))continue;let B=o.split(/\s/);if(o.startsWith("element vertex"))for(h=parseInt(B[B.length-1]),o=s(),B=o.split(/\s/);o.startsWith("property");){const N=B[1];B[2]==="x"&&N.startsWith("double")?d=!0:B[2]==="x"&&!N.startsWith("float")&&Q.error("Error: expect ply xyz to be float or double: "+o),v+=u(N),o=s(),B=o.split(/\s/)}if(o.startsWith("element face"))for(C=parseInt(B[B.length-1]),o=s(),B=o.split(/\s/);o.startsWith("property");){if(B[1]==="list")y=u(B[2]),b=u(B[3]),m+=y+3*b;else{const N=u(B[1]);m+=N,b===0&&(x+=N,A++)}o=s(),B=o.split(/\s/)}}if(l){C<1&&Q.error(`Malformed ply format: faces ${C} `);const B=new Float32Array(h*3);let N=0;for(let F=0;F<h;F++){o=s();const O=o.split(/\s/);B[N]=parseFloat(O[0]),B[N+1]=parseFloat(O[1]),B[N+2]=parseFloat(O[2]),N+=3}let I=new Uint32Array(C*3),P=0;for(let F=0;F<C;F++){o=s();const O=o.split(/\s/),U=parseInt(O[A])-2;if(U<1)break;if(P+U*3>I.length){const _=new Uint32Array(I.length+I.length);_.set(I),I=_.slice()}const L=parseInt(O[A+1]);let V=parseInt(O[A+2]);for(let _=0;_<U;_++){const G=parseInt(O[A+3+_]);I[P+0]=L,I[P+1]=V,I[P+2]=G,V=G,P+=3}}return I.length!==P&&(I=I.slice(0,P)),{positions:B,indices:I}}(v<12||y<1||b<1||C<1)&&Q.warn(`Malformed ply format: stride ${v} count ${y} iBytes ${b} iStrideBytes ${m} iPadBytes ${x} faces ${C}`);const E=new DataView(e);let S;if(a%4===0&&v===12&&c)S=new Float32Array(e,a,h*3),a+=h*v;else{S=new Float32Array(h*3);let B=0;for(let N=0;N<h;N++)d?(S[B]=E.getFloat64(a,c),S[B+1]=E.getFloat64(a+8,c),S[B+2]=E.getFloat64(a+16,c)):(S[B]=E.getFloat32(a,c),S[B+1]=E.getFloat32(a+4,c),S[B+2]=E.getFloat32(a+8,c)),B+=3,a+=v}const T=new Uint32Array(C*3);let R=!0,D=0;if(y===1&&b===4&&m===13)for(let B=0;B<C;B++){const N=E.getUint8(a);a+=y,N!==3&&(R=!1),T[D]=E.getUint32(a,c),a+=4,T[D+1]=E.getUint32(a,c),a+=4,T[D+2]=E.getUint32(a,c),a+=4,D+=3}else{let B=a;for(let N=0;N<C;N++){a=B+x;let I=0;y===1?I=E.getUint8(a):y===2?I=E.getUint16(a,c):y===4&&(I=E.getUint32(a,c)),a+=y,I!==3&&(R=!1);for(let P=0;P<3;P++)b===1?T[D]=E.getUint8(a):b===2?T[D]=E.getUint16(a,c):b===4&&(T[D]=E.getUint32(a,c)),D++,a+=b;B+=m}}return R||Q.warn("Only able to read PLY meshes limited to triangles."),{positions:S,indices:T}}static readICO(e){const a=new TextDecoder("utf-8").decode(e).split(`
`);let s=a[0].trim().split(/\s+/);s.length>1&&Q.warn("This is not a valid FreeSurfer ICO/TRI mesh.");const o=parseInt(s[0]),l=new Float32Array(o*3);let u=1;for(let d=0;d<o;d++){const v=a[u].trim().split(/\s+/);u++;let m=parseInt(v[0])-1;const y=parseFloat(v[1]),b=parseFloat(v[2]),x=parseFloat(v[3]);if(m<0||m>=o){Q.error("ICO vertices corrupted");break}m*=3,l[m]=y,l[m+1]=b,l[m+2]=x}s=a[u].trim().split(/\s+/),u++;const c=parseInt(s[0]),h=new Uint32Array(c*3);for(let d=0;d<c;d++){const v=a[u].trim().split(/\s+/);u++;let m=parseInt(v[0])-1;const y=parseInt(v[1])-1,b=parseInt(v[2])-1,x=parseInt(v[3])-1;if(m<0||m>=c){Q.error("ICO indices corrupted");break}m*=3,h[m]=y,h[m+1]=b,h[m+2]=x}for(let d=0;d<h.length;d+=3){const v=h[d];h[d]=h[d+1],h[d+1]=v}return{positions:l,indices:h}}static readGEO(e,n=!1){const s=new TextDecoder("utf-8").decode(e).split(`
`),o=s[0].trim().split(/\s+/),l=parseInt(o[0]);let u=parseInt(o[1]),c=parseInt(o[2]);const h=parseInt(o[3]);(l>1||h!==c*3)&&Q.warn("Multi-part BYU/GEO header or not a triangular mesh.");const d=[];u*=3;let v=0,m=2;for(;v<u;){const C=s[m].trim().split(/\s+/);m++;for(let E=0;E<C.length&&(d.push(parseFloat(C[E])),v++,!(v>=u));E++);}const y=[];c*=3;let b=0;for(;b<c;){const C=s[m].trim().split(/\s+/);m++;for(let E=0;E<C.length&&(y.push(Math.abs(parseInt(C[E]))-1),b++,!(b>=c));E++);}if(n)for(let C=0;C<y.length;C+=3){const E=y[C];y[C]=y[C+1],y[C+1]=E}const x=new Float32Array(d),A=new Uint32Array(y);return{positions:x,indices:A}}static readOFF(e){const a=new TextDecoder("utf-8").decode(e).split(`
`),s=[],o=[];let l=0;a[l].includes("OFF")?l++:Q.warn("File does not start with OFF");let u=a[l].trim().split(/\s+/);const c=parseInt(u[0]),h=parseInt(u[1]);l++;for(let m=0;m<c;m++)u=a[l].trim().split(/\s+/),s.push(parseFloat(u[0])),s.push(parseFloat(u[1])),s.push(parseFloat(u[2])),l++;for(let m=0;m<h;m++)u=a[l].trim().split(/\s+/),parseInt(u[0])!==3&&Q.warn("Only able to read OFF files with triangular meshes"),o.push(parseInt(u[1])),o.push(parseInt(u[2])),o.push(parseInt(u[3])),l++;const d=new Float32Array(s),v=new Uint32Array(o);return{positions:d,indices:v}}static readOBJMNI(e){const a=new TextDecoder("utf-8").decode(e).trim().split(/\s*,\s*|\s+/);(a.length<1||a[0]!=="P")&&Q.warn("This is not a valid MNI OBJ mesh.");let s=6;const o=parseInt(a[s++]),l=o*3,u=new Float32Array(l);for(let y=0;y<l;y++)u[y]=parseFloat(a[s++]);s+=l;const c=parseInt(a[s++]),h=parseInt(a[s++]);(c<1||h<0||h>2)&&Q.warn("This is not a valid MNI OBJ mesh.");let d=1;h===1?d=c:h===1&&(d=o),s+=d*4,s+=c;const v=c*3,m=new Uint32Array(v);for(let y=0;y<v;y++)m[y]=parseInt(a[s++]);return{positions:u,indices:m}}static async readOBJ(e){const n=new Uint8Array(e,0,2);n[0]===31&&n[1]===139&&(e=await Oe.decompressToBuffer(new Uint8Array(e)));const a=new TextDecoder("utf-8").decode(e);if(a[0]==="P")return this.readOBJMNI(e);const s=a.split(`
`),o=s.length,l=[],u=[];for(let m=0;m<o;m++){const y=s[m];if(y[0]==="v"&&y[1]===" "){const b=y.trim().split(/\s+/);l.push(parseFloat(b[1])),l.push(parseFloat(b[2])),l.push(parseFloat(b[3]))}if(y[0]==="f"){const b=y.trim().split(/\s+/),x=b.length-3;if(x<1)break;let A=b[1].split("/");const C=parseInt(A[0])-1;A=b[2].split("/");let E=parseInt(A[0])-1;for(let S=0;S<x;S++){A=b[3+S].split("/");const T=parseInt(A[0])-1;u.push(C),u.push(E),u.push(T),E=T}}}const c=new Float32Array(l),h=new Uint32Array(u);let d=h[0],v=h[0];for(let m=1;m<h.length;m++)h[m]<d&&(d=h[m]),h[m]>v&&(v=h[m]);if(v-d+1>c.length/3)throw new Error("Not a valid OBJ file");for(let m=0;m<h.length;m++)h[m]-=d;return{positions:c,indices:h}}static readFreeSurfer(e){const n=new Uint8Array(e);if(n[0]===35&&n[1]===33&&n[2]===97)return _r.readASC(e);const i=new DataView(e),a=i.getUint32(0,!1),s=i.getUint32(4,!1);(a!==4294966883||s!==1919246708)&&lc.debug("Unable to recognize file type: does not appear to be FreeSurfer format.");let o=0;for(;i.getUint8(o)!==10;)o++;o+=2;let l=i.getUint32(o,!1);o+=4;let u=i.getUint32(o,!1);o+=4,l*=3;const c=new Float32Array(l);for(let m=0;m<l;m++)c[m]=i.getFloat32(o,!1),o+=4;u*=3;const h=new Uint32Array(u);for(let m=0;m<u;m++)h[m]=i.getUint32(o,!1),o+=4;const d=i.getUint32(o,!1);o+=4;let v=d===20;if(!v){const m=i.getUint32(o,!1);o+=4;const y=i.getUint32(o,!1);o+=4,v=d===2&&m===0&&y===20}if(!v)Q.warn("Unknown FreeSurfer Mesh extension code.");else{const y=new TextDecoder().decode(e.slice(o)).trim().split(`
`);for(let b=0;b<y.length;b++){if(!y[b].startsWith("cras"))continue;const A=y[b].split("=")[1].trim().split(" ").map(Number),C=Math.floor(c.length/3);let E=0;for(let S=0;S<C;S++)c[E]+=A[0],E++,c[E]+=A[1],E++,c[E]+=A[2],E++}}return{positions:c,indices:h}}static async readSRF(e){const n=new Uint8Array(e);if(n[0]===35&&n[1]===33&&n[2]===97)return _r.readASC(e);n[0]===31&&n[1]===139&&(e=(await Oe.decompress(new Uint8Array(e))).buffer);const i=new DataView(e),a=i.getFloat32(0,!0),s=i.getUint32(8,!0),o=i.getUint32(12,!0),l=i.getFloat32(16,!0),u=i.getFloat32(20,!0),c=i.getFloat32(24,!0),h=new Float32Array(s*3);let d=28,v=1;for(let R=0;R<s;R++)h[v]=-i.getFloat32(d,!0)+l,v+=3,d+=4;v=2;for(let R=0;R<s;R++)h[v]=-i.getFloat32(d,!0)+u,v+=3,d+=4;v=0;for(let R=0;R<s;R++)h[v]=-i.getFloat32(d,!0)+c,v+=3,d+=4;d=28+24*s;const m=i.getFloat32(d,!0),y=i.getFloat32(d+4,!0),b=i.getFloat32(d+8,!0),x=i.getFloat32(d+16,!0),A=i.getFloat32(d+20,!0),C=i.getFloat32(d+24,!0);d+=32;const E=new Float32Array(s*3),S=new Uint32Array(e,d,s);v=0;for(let R=0;R<s;R++){const D=S[R];D>1056964608&&(E[v+0]=(D>>16&255)/255,E[v+1]=(D>>8&255)/255,E[v+2]=(D&255)/255),D===0&&(E[v+0]=m,E[v+1]=y,E[v+2]=b),D===1&&(E[v+0]=x,E[v+1]=A,E[v+2]=C),v+=3}d+=s*4;for(let R=0;R<s;R++){const D=i.getUint32(d,!0);d+=4+4*D}const T=new Uint32Array(o*3);for(let R=0;R<o*3;R++)T[R]=i.getInt32(d,!0),d+=4;return a!==4&&Q.warn("Not valid SRF"),{positions:h,indices:T,colors:E}}static readTxtSTL(e){const a=new TextDecoder("utf-8").decode(e).split(`
`);if(!a[0].startsWith("solid"))throw new Error("Not a valid STL file");const s=[];for(let c=1;c<a.length;c++){if(!a[c].includes("vertex"))continue;const h=a[c].trim().split(/\s+/);for(let d=1;d<h.length;d++)s.push(parseFloat(h[d]))}const o=Math.floor(s.length/3);if(o*3!==s.length)throw new Error("Unable to parse ASCII STL file.");const l=new Float32Array(s),u=new Uint32Array(o);for(let c=0;c<o;c++)u[c]=c;return{positions:l,indices:u}}static readSTL(e){if(e.byteLength<134)throw new Error("File too small to be STL: bytes = "+e.byteLength);const n=new DataView(e);if(n.getUint32(0,!0)===1768714099)return _r.readTxtSTL(e);const a=n.getUint32(80,!0),s=3*a;if(e.byteLength<84+a*50)throw new Error("STL file too small to store triangles = "+a);const o=new Uint32Array(s),l=new Float32Array(s*3);let u=96,c=0;for(let h=0;h<a;h++){for(let d=0;d<9;d++)l[c]=n.getFloat32(u,!0),c+=1,u+=4;u+=14}for(let h=0;h<s;h++)o[h]=h;return{positions:l,indices:o}}static decimateLayerVertices(e,n){if(e%n===0)return e;const i=12,a=Math.round(Math.log((e-2)/(i-2))/Math.log(4)),s=Math.round(Math.log((n-2)/(i-2))/Math.log(4)),o=Math.pow(4,a)*(i-2)+2,l=Math.pow(4,s)*(i-2)+2;return o!==e||l!==n?e:n}static async readNII2(e,n=0,i=""){let a=new Float32Array;const s=e.byteLength;let o=!0;const l=new DataView(e);let u=l.getUint16(0,o);if(u===469893120&&(o=!1,u=l.getUint16(0,o)),u!==540)throw new Error("Not a valid NIfTI-2 dataset");const c=Number(l.getBigInt64(168,o)),h=l.getFloat64(176,o),d=l.getFloat64(184,o);(h!==1||d!==0)&&Q.warn("ignoring scale slope and intercept");const v=l.getUint32(504,o),m=l.getUint16(12,o);if(m!==2&&m!==4&&m!==8&&m!==16)throw new Error("Unsupported NIfTI datatype "+m);let y=1;const b=[1,1,1,1,1,1,1,1];for(let x=1;x<8;x++)b[x]=Math.max(Number(l.getBigInt64(16+x*8,o)),1),y*=b[x];if(v>=3e3&&v<=3099&&c>580){let x=function(){for(;N<s&&B[N]===10;)N++;const V=N;for(;N<s&&B[N]!==10;)N++;return N++,N-V<1?"":new TextDecoder().decode(e.slice(V,N-1)).trim()},A=function(){let V=x();if(!V.startsWith("<")||V.endsWith(">"))return V;for(;N<s&&!V.endsWith(">");)V+=x();return V},C=function(V,_=!1){const G=I.indexOf(V);if(G<0)return 1;const K=I.indexOf('"',G)+1,z=I.indexOf('"',K),Y=I.slice(K,z);return _?Y:parseInt(Y)},E=0,S=0,T=0,R="",D=new Uint32Array;const B=new Uint8Array(e);let N=552,I;const P=b[5],F=new Float32Array(n*P);for(;N<s&&(I=A(),!I.includes("</CIFTI>"));)if(I.includes("<BrainModel")){const V=C("SurfaceNumberOfVertices="),_=C("BrainStructure=",!0).toUpperCase();if(V%n!==0)continue;let G=!1;if(i.includes("CORTEX")&&_.includes("CORTEX")&&(G=!0),!G||(G=!1,i.includes("LEFT")&&_.includes("LEFT")&&(G=!0),i.includes("RIGHT")&&_.includes("RIGHT")&&(G=!0),!G))continue;if(T=V,E=C("IndexOffset="),S=C("IndexCount="),R=_,I.includes("<VertexIndices>")||(I=A()),!I.startsWith("<VertexIndices>")||!I.endsWith("</VertexIndices>"))return Q.warn("Unable to find CIfTI <VertexIndices>"),F;I=I.slice(15,-16);const K=I.trim().split(/\s+/);K.length<S&&Q.error("Error parsing VertexIndices"),D=new Uint32Array(S);for(let z=0;z<S;z++)D[z]=parseInt(K[z])}if(T===0||D.length===0)return Q.warn("Unable to find CIfTI structure that matches the mesh."),F;if(m!==16)return Q.warn("Only able to read float32 CIfTI (only known datatype)."),F;const O=new Float32Array(S*P),U=c+P*E*4;for(let V=0;V<S*P;V++)O[V]=l.getFloat32(U+V*4,o);let L=0;for(let V=0;V<S;V++)for(let _=0;_<P;_++)F[D[V]+_*n]=O[L],L++;return Q.debug("CIfTI diagnostics",T,R,E,S,E,i),F}if(y=this.decimateLayerVertices(y,n),y%n!==0)throw new Error("Vertices in layer ("+y+") is not a multiple of number of vertices ("+n+")");if(o)m===16?a=new Float32Array(e,c,y):m===8?a=new Int32Array(e,c,y):m===4&&(a=new Int16Array(e,c,y));else if(m===16){a=new Float32Array(y);for(let x=0;x<y;x++)a[x]=l.getFloat32(c+x*4,o)}else if(m===8){a=new Int32Array(y);for(let x=0;x<y;x++)a[x]=l.getInt32(c+x*4,o)}else if(m===4){a=new Int16Array(y);for(let x=0;x<y;x++)a[x]=l.getInt16(c+x*2,o)}return m===2&&(a=new Uint8Array(e,c,y)),a}static async readNII(e,n=0,i=""){let a=new Float32Array,s=!0,o=new DataView(e),l=o.getUint16(0,s);if(l===540||l===469893120)return _r.readNII2(e,n,i);if(l===23553&&(s=!1,l=o.getUint16(0,s)),l!==348){const m=await Oe.decompress(new Uint8Array(e));if(o=new DataView(m.buffer),e=m.buffer,l=o.getUint16(0,s),l===540||l===469893120)return _r.readNII2(e,n,i);l===23553&&(s=!1,l=o.getUint16(0,s))}l!==348&&Q.error("Not a valid NIfTI image.");const u=o.getFloat32(108,s),c=o.getFloat32(112,s),h=o.getFloat32(116,s);(c!==1||h!==0)&&Q.warn("ignoring scale slope and intercept");const d=o.getUint16(70,s);if(d!==2&&d!==4&&d!==8&&d!==16)throw new Error("Unsupported NIfTI datatype "+d);let v=1;for(let m=1;m<8;m++){const y=o.getUint16(40+m*2,s);v*=Math.max(y,1)}if(v=this.decimateLayerVertices(v,n),v%n!==0)throw new Error("Vertices in layer ("+v+") is not a multiple of number of vertices ("+n+")");if(s)d===16?a=new Float32Array(e,u,v):d===8?a=new Int32Array(e,u,v):d===4&&(a=new Int16Array(e,u,v));else if(d===16){a=new Float32Array(v);for(let m=0;m<v;m++)a[m]=o.getFloat32(u+m*4,s)}else if(d===8){a=new Int32Array(v);for(let m=0;m<v;m++)a[m]=o.getInt32(u+m*4,s)}else if(d===4){a=new Int16Array(v);for(let m=0;m<v;m++)a[m]=o.getInt16(u+m*2,s)}return d===2&&(a=new Uint8Array(e,u,v)),a}static async readMGH(e,n=0,i=!1){let a=new DataView(e),s=e;if(a.getUint8(0)===31&&a.getUint8(1)===139){const D=await Oe.decompress(new Uint8Array(e));s=new ArrayBuffer(D.byteLength),new Uint8Array(s).set(new Uint8Array(D)),a=new DataView(D.buffer)}const o=a.getInt32(0,!1),l=Math.max(1,a.getInt32(4,!1)),u=Math.max(1,a.getInt32(8,!1)),c=Math.max(1,a.getInt32(12,!1)),h=Math.max(1,a.getInt32(16,!1)),d=a.getInt32(20,!1);let v=284;const m=!1;(o!==1||d<0||d>4)&&Q.warn("Not a valid MGH file");let y=l*u*c*h,b=[];if(y=this.decimateLayerVertices(y,n),y%n!==0)return Q.warn("Vertices in layer ("+y+") is not a multiple of number of vertices ("+n+")"),b;if(d===3){b=new Float32Array(y);for(let D=0;D<y;D++)b[D]=a.getFloat32(v+D*4,m)}else if(d===1){b=new Int32Array(y);for(let D=0;D<y;D++)b[D]=a.getInt32(v+D*4,m)}else if(d===4){b=new Int16Array(y);for(let D=0;D<y;D++)b[D]=a.getInt16(v+D*2,m)}else d===0&&(b=new Uint8Array(e,v,y));if(!i)return b;let x=4;d===4&&(x=2),d===0&&(x=1),v+=x*y,v+=16;const A=1,C=2,E=20,S=30,T=s.byteLength;let R;for(;v<T-8;){const D=a.getInt32(v+=4,m);let B=0;switch(D){case S:B=a.getInt32(v+=4,m)-1;break;case E:case C:B=0;break;case A:B=0;{let N=a.getInt32(v+=4,m);if(N>0)return Q.warn("unsupported CTABreadFromBinaryV1"),b;if(N=-N,N!==2)return Q.warn("CTABreadFromBinary: unknown version"),b;const I=a.getInt32(v+=4,m);if(I<0)return Q.warn("CTABreadFromBinaryV2: nentries was ",I),b;const P=a.getInt32(v+=4,m);v+=P;const F=a.getInt32(v+=4,m);if(F<0)return b;const O={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let U=0;U<F;U++){const L=a.getInt32(v+=4,m),V=a.getInt32(v+=4,m);let _=v+4,G="";for(let J=0;J<V;J++){const ee=a.getUint8(_++);if(ee===0)break;G+=String.fromCharCode(ee)}v+=V;const K=a.getInt32(v+=4,m),z=a.getInt32(v+=4,m),Y=a.getInt32(v+=4,m),Z=255-a.getInt32(v+=4,m);O.I.push(L),O.R.push(K),O.G.push(z),O.B.push(Y),O.A.push(Z),O.labels.push(G)}R=Vt.makeLabelLut(O)}break;default:B=a.getInt32(v+=8,m)}v+=B}return{scalars:b,colormapLabel:R}}static readX3D(e){const n=e.byteLength;if(n<20)throw new Error("File too small to be X3D: bytes = "+n);const i=new Uint8Array(e);let a=0;function s(){for(;a<n&&i[a]!==60;)a++;const E=a;for(;a<n&&i[a]!==62;)a++;const S=a;return new TextDecoder().decode(e.slice(E,S+1)).trim()}let o=s();function l(E){const S=o.indexOf(E+"=");if(S<0)return"";const T=o[S+E.length+1],R=o.indexOf(T,S)+1,D=o.indexOf(T,R);return o.slice(R,D)}function u(E){const S=o.indexOf(E+"=");if(S<0)return 1;const T=o[S+E.length+1],R=o.indexOf(T,S)+1,D=o.indexOf(T,R);let B=o.slice(R,D).trim();B=B.replace(/,\s*$/,"");const N=B.trim().split(/\s*,\s*|\s+/);if(N.length<2)return parseFloat(B);let I=new Array(N.length),P=0;for(let F=0;F<N.length;F++){const O=parseFloat(N[F]);isFinite(O)&&(I[P]=O,P++)}return I=I.slice(0,P),I}o.includes("xml version")||Q.warn("Not a X3D image");let c=[],h=[],d=[],v=[],m=[0,0,0,0],y=[0,0,0,0],b=[255,255,255,255],x=[255,255,255,255];const A={};function C(){if(!o.endsWith("/>"))if(o.startsWith("<Appearance>"))for(;a<n&&!o.endsWith("</Appearance>");)o+=s();else for(;a<n&&!o.endsWith("/>");)o+=s();const E=l("USE");if(E.length>1){E in A?b=A[E]:Q.warn("Unable to find DEF for "+E);return}const S=u("diffuseColor");if(S.length<3)return;b[0]=Math.round(S[0]*255),b[1]=Math.round(S[1]*255),b[2]=Math.round(S[2]*255);const T=l("DEF");T.length<1||(A[T]=b)}for(;a<n;)if(o=s(),b=x.slice(),o.startsWith("<Transform")&&(m=u("translation"),y=u("rotation")),o.startsWith("<Appearance")&&(C(),x=b.slice()),o.startsWith("<Shape")){let E=1,S=1,T=[],R=[];for(;a<n&&(o=s(),o.startsWith("<Appearance")&&C(),!o.startsWith("</Shape"));){if(o.startsWith("<Sphere")&&(E=u("radius"),S=-1),o.startsWith("<Cylinder")&&(E=u("radius"),S=u("height")),o.startsWith("<IndexedFaceSet")&&(S=-2,T=u("coordIndex")),o.startsWith("<IndexedTriangleSet")&&(S=-7,T=u("index")),o.startsWith("<IndexedTriangleStripSet")&&(S=-3,T=u("index")),o.startsWith("<Coordinate")){R=u("point");const D=R.length%3;D!==0&&(R=R.slice(0,-D))}o.startsWith("<Color")&&(v=u("color")),o.startsWith("<Box")&&(S=-4,Q.warn("Unsupported x3d shape: Box")),o.startsWith("<Cone")&&(S=-5,Q.warn("Unsupported x3d shape: Cone")),o.startsWith("<ElevationGrid")&&(S=-6,Q.warn("Unsupported x3d shape: ElevationGrid"))}if(!(S<-3&&S!==-7))if(S<-1){if(T.length<1||R.length<3||R.length===void 0){Q.warn("Indexed mesh must specify indices and points");break}const D=Math.floor(c.length/3);let B=2;if(S===-7)h=[...h,...T];else if(S===-2){let P=0;for(;B<T.length;)T[B]>=0?(h.push(T[P]+D),h.push(T[B-1]+D),h.push(T[B-0]+D),B+=1):(B+=3,P=B-2)}else for(;B<T.length;)T[B]>=0?(h.push(T[B-2]+D),h.push(T[B-1]+D),h.push(T[B-0]+D),B+=1):B+=3;c=[...c,...R];const N=Math.floor(R.length/3),I=Array(N).fill(b).flat();if(v.length===N*3){let P=0,F=0;for(let O=0;O<N;O++){for(let U=0;U<3;U++)I[F]=Math.round(v[P]*255),P++,F++;F++}}d=[...d,...I]}else if(S<0)Ao.makeColoredSphere(c,h,d,E,m,b);else{const D=Tt();M_(D,y[3],[y[0],y[1],y[2]]);const B=er(0,-S*.5,0,1),N=er(0,+S*.5,0,1);qr(B,B,D),qr(N,N,D),Z4(B,B,m),Z4(N,N,m);const I=Me(B[0],B[1],B[2]),P=Me(N[0],N[1],N[2]);Ao.makeColoredCylinder(c,h,d,I,P,E,b)}}return{positions:Float32Array.from(c),indices:Uint32Array.from(h),rgba255:Uint8Array.from(d)}}static async readGII(e,n=0){let i=e.byteLength;if(i<20)throw new Error("File too small to be GII: bytes = "+i);let a=new TextDecoder("ascii").decode(e);if(a[0].charCodeAt(0)===31){const F=await Oe.decompress(new Uint8Array(e));e=F.buffer,a=new TextDecoder("ascii").decode(F.buffer)}let s=0;function o(){let F=!0,O=s;for(;F;){for(;s<i&&a[s]!=="<";)s++;for(O=s;s<i&&a[s]!==">";)s++;if(F=a[s-1]==="/",O+1<i&&a[O+1]==="/"&&(s+=1,F=!0),s>=i)break}const U=new TextDecoder().decode(e.slice(O+1,s)).trim(),L=U.split(" ")[0].trim(),V=s;let _=s,G=s;if(a[O+1]!=="?"&&a[O+1]!=="!"){const K="</"+L+">";_=a.indexOf(K,V),G=_+K.length-1}return{name:U,startPos:O,contentStartPos:V,contentEndPos:_,endPos:G}}let l=o();if(!l.name.startsWith("?xml"))throw new Error("readGII: Invalid XML file");for(;!l.name.startsWith("GIFTI")&&l.endPos<i;)l=o();if(!l.name.startsWith("GIFTI")||l.contentStartPos===l.contentEndPos)throw new Error("readGII: XML file does not include GIFTI tag");i=l.contentEndPos;let u=new Float32Array,c=new Uint32Array,h=new Float32Array,d="",v=!1,m=!1,y=!1,b=!1,x=[1,1,1];const A=[0,0,0];let C=0,E=!1,S=!1,T=0,R=!1;l.endPos=l.contentStartPos;let D="";function B(F,O=!1){const U=D.indexOf(F);if(U<0)return 1;const L=D.indexOf('"',U)+1,V=D.indexOf('"',L),_=D.slice(L,V);return O?parseFloat(_):parseInt(_)}function N(F){const O=D.indexOf(F);if(O<0)return"";const U=O+F.length,L=D.indexOf("]",U);return D.slice(U,L)}const I={R:[],G:[],B:[],A:[],I:[],labels:[]};for(;l.endPos<i&&l.name.length>1;){if(l=o(),l.name.startsWith("Label Key")&&(D=l.name,I.I.push(B("Key=")),I.R.push(Math.round(255*B("Red=",!0))),I.G.push(Math.round(255*B("Green=",!0))),I.B.push(Math.round(255*B("Blue=",!0))),I.A.push(Math.round(255*B("Alpha",!0))),D=new TextDecoder().decode(e.slice(l.contentStartPos+1,l.contentEndPos)).trim(),I.labels.push(N("<![CDATA["))),l.name.trim()==="Data"){if(y)continue;D=new TextDecoder().decode(e.slice(l.contentStartPos+1,l.contentEndPos)).trim();let F;if(S){const O=x[0]*x[1]*x[2],U=D.split(/\s+/);if(O!==U.length)throw new Error("Unable to parse ASCII GIfTI");if(C===2&&(C=8),C===32&&(C=16),C===8){F=new Int32Array(O);for(let L=0;L<O;L++)F[L]=parseInt(U[L])}if(C===16){F=new Float32Array(O);for(let L=0;L<O;L++)F[L]=parseFloat(U[L])}}else if(typeof Buffer>"u"){let O=function(U){const L=atob(U),V=L.length,_=new Uint8Array(V);for(let G=0;G<V;G++)_[G]=L.charCodeAt(G);return _};if(E){const U=O(D.slice());F=await Oe.decompress(new Uint8Array(U))}else F=O(D.slice())}else if(E){const O=Buffer.from(D.slice(),"base64");F=await Oe.decompress(new Uint8Array(O))}else F=Buffer.from(D.slice(),"base64");if(m){if(C!==16&&Q.warn("expect positions as FLOAT32"),u=new Float32Array(F.buffer),b){const O=u.slice(),U=O.length/3;let L=0;for(let V=0;V<U;V++)for(let _=0;_<3;_++)u[L]=O[_*U+V],L++}}else if(v){if(C!==8&&Q.warn("expect indices as INT32"),c=new Uint32Array(F.buffer),b){const O=c.slice(),U=O.length/3;let L=0;for(let V=0;V<U;V++)for(let _=0;_<3;_++)c[L]=O[_*U+V],L++}}else{let O=function(L,V){const _=L.length,G=new Float32Array(_+V.length);return G.set(L),G.set(V,_),G};T=x[0]*x[1]*x[2],n!==0&&T%n!==0&&Q.warn("Number of vertices in scalar overlay ("+T+") does not match mesh ("+n+")");let U;if(C===2){const L=new Uint8Array(F.buffer);U=Float32Array.from(L)}else if(C===8){const L=new Int32Array(F.buffer);U=Float32Array.from(L)}else if(C===16)U=new Float32Array(F.buffer);else if(C===32){const L=new Float64Array(F.buffer);U=Float32Array.from(L)}else throw new Error(`Invalid dataType: ${C}`);h=O(h,U)}continue}if(l.name.trim()==="DataSpace"&&(D=new TextDecoder().decode(e.slice(l.contentStartPos+1,l.contentEndPos)).trim(),D.includes("NIFTI_XFORM_SCANNER_ANAT")&&(R=!0)),l.name.trim()==="MD"&&(D=new TextDecoder().decode(e.slice(l.contentStartPos+1,l.contentEndPos)).trim(),D.includes("AnatomicalStructurePrimary")&&D.includes("CDATA[")&&(d=N("<Value><![CDATA[").toUpperCase()),D.includes("VolGeom")&&D.includes("CDATA["))){let F=-1;if(D.includes("VolGeomC_R")&&(F=0),D.includes("VolGeomC_A")&&(F=1),D.includes("VolGeomC_S")&&(F=2),F<0)continue;A[F]=parseFloat(N("<Value><![CDATA["))}l.name.startsWith("DataArray")&&(D=l.name,x=[1,1,1],E=D.includes('Encoding="GZipBase64Binary"'),S=D.includes('Encoding="ASCII"'),v=D.includes('Intent="NIFTI_INTENT_TRIANGLE"'),m=D.includes('Intent="NIFTI_INTENT_POINTSET"'),y=D.includes('Intent="NIFTI_INTENT_VECTOR"'),b=D.includes('ArrayIndexingOrder="ColumnMajorOrder"'),D.includes('DataType="NIFTI_TYPE_UINT8"')&&(C=2),D.includes('DataType="NIFTI_TYPE_INT32"')&&(C=8),D.includes('DataType="NIFTI_TYPE_FLOAT32"')&&(C=16),D.includes('DataType="NIFTI_TYPE_FLOAT64"')&&(C=32),x[0]=B("Dim0="),x[1]=B("Dim1="),x[2]=B("Dim2="))}let P;if(I.I.length>1&&(P=Vt.makeLabelLut(I)),n>0)return{scalars:h,colormapLabel:P,anatomicalStructurePrimary:d};if(u.length>2&&!R&&(A[0]!==0||A[1]!==0||A[2]!==0)){T=Math.floor(u.length/3);let F=0;for(let O=0;O<T;O++)u[F]+=A[0],F++,u[F]+=A[1],F++,u[F]+=A[2],F++}return{positions:u,indices:c,scalars:h,colormapLabel:P,anatomicalStructurePrimary:d}}},yy=class{constructor(r,e,n,i,a){j(this,"text"),j(this,"style"),j(this,"points"),j(this,"anchor"),j(this,"onClick"),this.text=r,this.style=e,this.points=n,this.anchor=i||0,this.onClick=a}},n2=()=>{const r=new ArrayBuffer(2);return new DataView(r).setInt16(0,256,!0),new Int16Array(r)[0]===256},gT=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.NII=1]="NII",r[r.DCM=2]="DCM",r[r.DCM_MANIFEST=3]="DCM_MANIFEST",r[r.MIH=4]="MIH",r[r.MIF=5]="MIF",r[r.NHDR=6]="NHDR",r[r.NRRD=7]="NRRD",r[r.MHD=8]="MHD",r[r.MHA=9]="MHA",r[r.MGH=10]="MGH",r[r.MGZ=11]="MGZ",r[r.V=12]="V",r[r.V16=13]="V16",r[r.VMR=14]="VMR",r[r.HEAD=15]="HEAD",r[r.DCM_FOLDER=16]="DCM_FOLDER",r[r.SRC=17]="SRC",r[r.FIB=18]="FIB",r[r.BMP=19]="BMP",r[r.ZARR=20]="ZARR",r[r.NPY=21]="NPY",r[r.NPZ=22]="NPZ",r))(gT||{}),ut=Object.freeze({...gT,parse:r=>{let e=0;switch(r.toUpperCase()){case"":case"DCM":e=2;break;case"TXT":e=3;break;case"FZ":case"GQI":case"QSDR":case"FIB":e=18;break;case"NII":e=1;break;case"MIH":e=4;break;case"MIF":e=5;break;case"NHDR":e=6;break;case"NRRD":e=7;break;case"MHD":e=8;break;case"MHA":e=9;break;case"MGH":e=10;break;case"MGZ":e=11;break;case"NPY":e=21;break;case"NPZ":e=22;break;case"SRC":e=17;break;case"V":e=12;break;case"V16":e=13;break;case"VMR":e=14;break;case"HEAD":e=15;break;case"PNG":case"BMP":case"GIF":case"JPG":case"JPEG":e=19;break;case"ZARR":e=20;break}return e}}),Ud=(r,e="",n="",i="gray",a=1,s=NaN,o=NaN,l=!0,u=.02,c=!1,h=!1,d="",v=0,m=ut.UNKNOWN,y=NaN,b=NaN,x=!0,A=!1,C=null)=>({url:r,urlImageData:e,name:n,colormap:i,colorMap:i,opacity:a,cal_min:s,cal_max:o,trustCalMinMax:l,percentileFrac:u,ignoreZeroVoxels:c,useQFormNotSForm:h,colormapNegative:d,imageType:m,cal_minNeg:y,cal_maxNeg:b,colorbarVisible:x,frame4D:v,alphaThreshold:A,colormapLabel:C});function pC(r,e=80){r=r.replace(/[`$]/g,"");const n=[],i=Math.min(e,r.length);for(let a=0;a<i;a++){const s=r.charCodeAt(a);n.push(s&255)}return n}function h0(r,e=!1,n=!1){let s=!0;n&&(s=r.littleEndian);const o=new Uint8Array(348),l=new DataView(o.buffer);l.setInt32(0,348,s),l.setUint8(38,114),l.setUint8(39,r.dim_info);for(let c=0;c<8;c++)l.setUint16(40+2*c,r.dims[c],s);l.setFloat32(56,r.intent_p1,s),l.setFloat32(60,r.intent_p2,s),l.setFloat32(64,r.intent_p3,s),l.setInt16(68,r.intent_code,s),e?(l.setInt16(70,2,s),l.setInt16(72,8,s)):(l.setInt16(70,r.datatypeCode,s),l.setInt16(72,r.numBitsPerVoxel,s)),l.setInt16(74,r.slice_start,s);for(let c=0;c<8;c++)l.setFloat32(76+4*c,r.pixDims[c],s);e?(l.setFloat32(108,352,s),l.setFloat32(112,1,s),l.setFloat32(116,0,s)):(l.setFloat32(108,r.vox_offset,s),l.setFloat32(112,r.scl_slope,s),l.setFloat32(116,r.scl_inter,s)),l.setInt16(120,r.slice_end,s),l.setUint8(122,r.slice_code),r.xyzt_units===0?l.setUint8(123,10):l.setUint8(123,r.xyzt_units),e?(l.setFloat32(124,0,s),l.setFloat32(128,0,s)):(l.setFloat32(124,r.cal_max,s),l.setFloat32(128,r.cal_min,s)),l.setFloat32(132,r.slice_duration,s),l.setFloat32(136,r.toffset,s),o.set(pC(r.description),148),o.set(pC(r.aux_file),228),l.setInt16(252,r.qform_code,s),r.sform_code<1||r.sform_code<1?l.setInt16(254,1,s):l.setInt16(254,r.sform_code,s),l.setFloat32(256,r.quatern_b,s),l.setFloat32(260,r.quatern_c,s),l.setFloat32(264,r.quatern_d,s),l.setFloat32(268,r.qoffset_x,s),l.setFloat32(272,r.qoffset_y,s),l.setFloat32(276,r.qoffset_z,s);const u=r.affine.flat();for(let c=0;c<12;c++)l.setFloat32(280+4*c,u[c],s);return l.setInt32(344,3222382,!0),o}function VG(r,e=!0){const n=Math.round(r.length/3),i=Me(0,0,0),a=Kt(),s=Kt();let o=0,l=1;e&&(l=2);for(let d=0;d<l;d++){o=0;for(let m=0;m<n;m++){const y=Me(r[m*3],r[m*3+1],r[m*3+2]);m===0&&(Q4(a,y),Q4(s,y)),$2(a,a,y),ey(s,s,y),$t(y,y,i);const b=Zc(y);o=Math.max(o,b)}if(d+1>=l)break;let v=!0;for(let m=0;m<3;++m)a[m]>i[m]&&(v=!1),s[m]<i[m]&&(v=!1);if(v)break;k_(i,a,s,.5),Q.debug("origin moved inside volume: ",i)}const u=[a[0],a[1],a[2]],c=[s[0],s[1],s[2]];return{min:u,max:c,furthestVertexFromOrigin:o,origin:i}}function yC(r){const e=[!1,!1,!1,!1],n=[!1,!1,!1,!1];for(let i=0;i<4;i++)for(let a=0;a<4;a++)if(isNaN(r[i][a]))return!1;for(let i=0;i<3;i++)for(let a=0;a<3;a++)r[i][a]!==0&&(e[i]=!0,n[a]=!0);for(let i=0;i<3;i++)if(!e[i]||!n[i])return!1;return!0}async function Zm(r){const e=r.getReader(),{done:n,value:i}=await e.read();if(n)return e.releaseLock(),new ReadableStream({start(o){o.close()}});if(!i||i.length<2)return e.releaseLock(),new ReadableStream({start(o){i&&o.enqueue(i),o.close()}});const a=i[0]===31&&i[1]===139,s=new ReadableStream({async start(o){try{for(o.enqueue(i);;){const{done:l,value:u}=await e.read();if(l){o.close(),e.releaseLock();break}o.enqueue(u)}}catch(l){o.error(l),e.releaseLock()}}});return a?s.pipeThrough(new DecompressionStream("gzip")):s}function vT(r=[256,256,256],e=[1,1,1],n=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],i=2){const a=new Ne;a.littleEndian=!0,a.dims=[3,1,1,1,0,0,0,0],a.dims[0]=Math.max(3,r.length);for(let o=0;o<r.length;o++)a.dims[o+1]=r[o];a.pixDims=[1,1,1,1,1,0,0,0];for(let o=0;o<r.length;o++)a.pixDims[o+1]=e[o];if(n.length===16){let o=0;for(let l=0;l<4;l++)for(let u=0;u<4;u++)a.affine[l][u]=n[o],o++}let s=8;return i===256||i===2?s=8:i===512||i===4?s=16:i===16||i===768||i===8||i===2304?s=32:i===64?s=64:Q.warn("Unsupported NIfTI datatypeCode for header creation: "+i),a.datatypeCode=i,a.numBitsPerVoxel=s,a.scl_inter=0,a.scl_slope=1,a.sform_code=2,a.magic="n+1",a.vox_offset=352,a}function OG(r=[256,256,256],e=[1,1,1],n=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],i=2,a=new Uint8Array){const s=vT(r,e,n,i),o=h0(s,!1);s.vox_offset=Math.max(352,o.length);const l=h0(s,!1);if(a.length<1)return l;const u=Math.max(0,s.vox_offset-l.length),c=new Uint8Array(u),h=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),d=s.vox_offset+h.length,v=new Uint8Array(d);return v.set(l,0),v.set(c,l.length),v.set(h,s.vox_offset),v}function mT(r,e=null){if(!r.hdr)throw new Error("NVImage header is not defined for toUint8Array");if(!r.img&&e===null)throw new Error("NVImage image data is not defined for toUint8Array");const n=e!==null,i=JSON.parse(JSON.stringify(r.hdr)),a=r.extensions&&r.extensions.length>0,s=new Uint8Array(4);s[0]=a?1:0;let o=new Uint8Array(0);if(a){const x=[];let A=0;for(const E of r.extensions){const S=new Uint8Array(E.edata),T=new Uint8Array(8+S.length),R=new DataView(T.buffer);R.setInt32(0,E.esize,!0),R.setInt32(4,E.ecode,!0),T.set(S,8),x.push(T),A+=T.length}o=new Uint8Array(A);let C=0;for(const E of x)o.set(E,C),C+=E.length}const l=348;i.vox_offset=Math.max(352,l+s.length+o.length),n&&(i.datatypeCode=2,i.numBitsPerVoxel=8,i.scl_slope=1,i.scl_inter=0);const u=h0(i,n);let c;if(n){const x=e,A=r.permRAS;if(A&&(A[0]!==1||A[1]!==2||A[2]!==3)){Q.debug("Reorienting drawing bytes back to native space for saving...");const C=r.hdr.dims,E=C[1]*C[2]*C[3],S=r.dimsRAS?r.dimsRAS[1]*r.dimsRAS[2]*r.dimsRAS[3]:E;if(x.length!==S)console.warn(`Drawing length (${x.length}) does not match expected RAS voxel count (${S}). Cannot reorient drawing reliably.`),c=x;else if(!r.img2RASstep||!r.img2RASstart||!r.dimsRAS)console.warn("Missing RAS transformation info (img2RASstep, img2RASstart, dimsRAS). Cannot reorient drawing reliably."),c=x;else{const T=r.img2RASstep,R=r.img2RASstart,D=r.dimsRAS,B=new Uint8Array(E);B.fill(0);const N=x;let I=0;for(let P=0;P<D[3];P++){const F=R[2]+P*T[2];for(let O=0;O<D[2];O++){const U=R[1]+O*T[1];for(let L=0;L<D[1];L++){const _=R[0]+L*T[0]+U+F;_>=0&&_<E?B[_]=N[I]:I<N.length&&console.warn(`Calculated native index ${_} is out of bounds [0..${E-1}] during drawing reorientation.`),I++}}}c=B}}else c=x}else{if(!r.img)throw new Error("NVImage image data is null when trying to save non-drawing.");c=new Uint8Array(r.img.buffer,r.img.byteOffset,r.img.byteLength)}const h=u.length+s.length+o.length,d=Math.max(0,i.vox_offset-h),v=new Uint8Array(d),m=i.vox_offset+c.length,y=new Uint8Array(m);let b=0;return y.set(u,b),b+=u.length,y.set(s,b),b+=s.length,y.set(o,b),b+=o.length,y.set(v,b),b+=v.length,y.set(c,i.vox_offset),y}async function pT(r,e,n=null){const i=mT(r,n);if(e.toLowerCase().endsWith(".gz"))try{const s=await Oe.compress(i,"gzip");return new Uint8Array(s)}catch(s){return Q.error("Compression failed:",s),Q.warn("Returning uncompressed data due to compression error."),i}else return i}async function LG(r,e="",n=null){const i=await pT(r,e,n);if(!e)return Q.debug("saveToDisk: empty file name, returning data as Uint8Array rather than triggering download"),i;try{const a=new Blob([i.buffer],{type:"application/octet-stream"}),s=URL.createObjectURL(a),o=document.createElement("a");o.setAttribute("href",s),o.setAttribute("download",e),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>URL.revokeObjectURL(s),100)}catch(a){Q.error("Failed to trigger download:",a)}return i}function yT(r,e,n,i,a=0,s=!1){if(!r.hdr)throw new Error("getValue: NVImage header is not defined.");if(!s&&!r.img)throw new Error("getValue: NVImage image data is not defined.");if(s&&!r.imaginary)return Q.warn("getValue: Attempted to read imaginary data, but none exists."),[0];const o=r.hdr.dims[1],l=r.hdr.dims[2],u=r.hdr.dims[3],c=r.permRAS.slice();if(c[0]!==1||c[1]!==2||c[2]!==3){const C=er(e,n,i,1);qr(C,C,r.toRASvox),e=C[0],n=C[1],i=C[2]}e=Math.max(0,Math.min(Math.round(e),o-1)),n=Math.max(0,Math.min(Math.round(n),l-1)),i=Math.max(0,Math.min(Math.round(i),u-1)),a=Math.max(0,a);let h=e+n*o+i*o*l;if(r.hdr.datatypeCode===2304)return r.img?(h*=4,h+3>=r.img.length?(Q.warn(`getValue: Calculated index ${h} out of bounds for RGBA data.`),[0]):[r.img[h],r.img[h+1],r.img[h+2],r.img[h+3]]):[0];if(r.hdr.datatypeCode===128)return r.img?(h*=3,h+2>=r.img.length?(Q.warn(`getValue: Calculated index ${h} out of bounds for RGB data.`),[0]):[r.img[h],r.img[h+1],r.img[h+2]]):[0];const d=o*l*u,v=a*d,m=h+v,y=s?r.imaginary:r.img;if(m<0||m>=y.length)return[0];const b=y[m],x=isNaN(r.hdr.scl_slope)||r.hdr.scl_slope===0?1:r.hdr.scl_slope,A=isNaN(r.hdr.scl_inter)?0:r.hdr.scl_inter;return[x*b+A]}function _G(r,e,n,i,a=0,s=!1){const o=yT(r,e,n,i,a,s);return o.length<3?o[0]:o[0]*.2126+o[1]*.7152+o[2]*.0722}function zG(r,e=[-1,0,0],n=[0,0,0],i="same"){const a=[new Uint8Array,[0,0,0]];if(!r.hdr||!r.img||!r.dimsRAS||!r.img2RASstep||!r.img2RASstart)return Q.error("getVolumeData: Missing required NVImage properties (hdr, img, dimsRAS, img2RASstep/start)."),a;if(e=e.slice(0,3),n=n.slice(0,3),Math.min(...e)<0||Math.min(...n)<0)return Q.warn("getVolumeData: Invalid start or end coordinates provided."),a;const s=r.dimsRAS.slice(1,4);for(let x=0;x<3;x++)if(e[x]=Math.max(0,Math.min(Math.round(e[x]),s[x]-1)),n[x]=Math.max(0,Math.min(Math.round(n[x]),s[x]-1)),n[x]<e[x]){const A=n[x];n[x]=e[x],e[x]=A}const o=[n[0]-e[0]+1,n[1]-e[1]+1,n[2]-e[2]+1],l=o[0]*o[1]*o[2];if(l<=0)return Q.warn("getVolumeData: Calculated slab size is zero or negative."),a;let u=r.img.constructor;i==="uint8"?u=Uint8Array:i==="int16"?u=Int16Array:i==="uint16"?u=Uint16Array:i==="float32"||i==="scaled"||i==="normalized"||i==="windowed"?u=Float32Array:i==="float64"?u=Float64Array:i!=="same"&&Q.warn(`getVolumeData: Unsupported dataType '${i}'. Using 'same'.`);let c;try{c=new u(l)}catch(x){return Q.error(`getVolumeData: Failed to create output array for dataType '${i}'.`,x),a}const h=r.img2RASstep,d=r.img2RASstart,v=r.img;let m=0;for(let x=e[2];x<=n[2];x++){const A=d[2]+x*h[2];for(let C=e[1];C<=n[1];C++){const E=d[1]+C*h[1];for(let S=e[0];S<=n[0];S++){const R=d[0]+S*h[0]+E+A;let D=0;R>=0&&R<v.length&&(D=v[R]),c[m++]=D}}}const y=isNaN(r.hdr.scl_slope)||r.hdr.scl_slope===0?1:r.hdr.scl_slope,b=isNaN(r.hdr.scl_inter)?0:r.hdr.scl_inter;if(i==="scaled"||i==="normalized"||i==="windowed"){c instanceof Float32Array||(Q.warn(`getVolumeData: Converting output to Float32 for scaling type '${i}'.`),c=Float32Array.from(c));for(let x=0;x<c.length;x++)c[x]=c[x]*y+b}if(i==="normalized"||i==="windowed"){let x=r.cal_min,A=r.cal_max;i==="normalized"&&(x=r.global_min,A=r.global_max);const C=A-x,E=C===0?0:1/C;for(let S=0;S<c.length;S++)c[S]=(c[S]-x)*E,c[S]=Math.max(0,Math.min(c[S],1))}return[c,o]}function qG(r,e=[-1,0,0],n=[0,0,0],i=new Uint8Array){if(!r.hdr||!r.img||!r.dimsRAS||!r.img2RASstep||!r.img2RASstart){Q.error("setVolumeData: Missing required NVImage properties (hdr, img, dimsRAS, img2RASstep/start).");return}if(i.length<1){Q.warn("setVolumeData: Input slabData is empty.");return}if(e=e.slice(0,3),n=n.slice(0,3),Math.min(...e)<0||Math.min(...n)<0){Q.warn("setVolumeData: Invalid start or end coordinates provided.");return}const a=r.dimsRAS.slice(1,4);for(let d=0;d<3;d++)if(e[d]=Math.max(0,Math.min(Math.round(e[d]),a[d]-1)),n[d]=Math.max(0,Math.min(Math.round(n[d]),a[d]-1)),n[d]<e[d]){const v=n[d];n[d]=e[d],e[d]=v}const s=[n[0]-e[0]+1,n[1]-e[1]+1,n[2]-e[2]+1],o=s[0]*s[1]*s[2];if(o<=0){Q.warn("setVolumeData: Calculated slab size is zero or negative.");return}if(i.length<o){Q.error(`setVolumeData: Input slabData length (${i.length}) is less than the calculated slab size (${o}).`);return}const l=r.img2RASstep,u=r.img2RASstart,c=r.img;let h=0;for(let d=e[2];d<=n[2];d++){const v=u[2]+d*l[2];for(let m=e[1];m<=n[1];m++){const y=u[1]+m*l[1];for(let b=e[0];b<=n[0];b++){const A=u[0]+b*l[0]+y+v;A>=0&&A<c.length&&(c[A]=i[h]),h++}}}}var AT={};q0(AT,{isFreeSurferLabelImage:()=>bT,optimizeFreeSurferLabels:()=>xT,readMgh:()=>GG});function AC(r,e,n,i=1){const a=e+n;let s=e;const o=[];for(;s+12<=a;){const l=r.getInt32(s,!1),u=r.getInt32(s+8,!1);if(s+=12,u<=0||s+u>a)break;if(l!==i){s+=u;continue}let c=u,h=s;if(i===1){if(s+4>a)break;c=r.getInt32(s,!1),h+=4}if(c>1&&h+c<=a){const d=new Uint8Array(r.buffer,h,c),v=new TextDecoder("utf-8").decode(d.slice(0,-1));o.push(v)}s+=u}return o.join(`

`)}function xT(r,e){if(r.intent_code=1002,r.datatypeCode!==16&&r.datatypeCode!==8)return e;let n=new Float32Array(e);if(r.datatypeCode===8&&(n=new Int32Array(e)),n2()){const o=new Uint32Array(e);for(let l=0;l<o.length;l++){const u=o[l];o[l]=(u&255)<<24|(u&65280)<<8|(u&16711680)>>>8|(u&4278190080)>>>24}}r.littleEndian=n2();let i=!0,a=1/0,s=-1/0;for(let o=0;o<n.length;o++){const l=n[o];Number.isFinite(l)&&(Number.isInteger(l)||(i=!1),l<a&&(a=l),l>s&&(s=l))}if(!i||a<0||s>2147483647)return Q.warn(`FreeSurfer Labels must be integers in INT32 range. range ${a}..${s}`),e;if(s>32767){r.datatypeCode=8;const o=new Int32Array(n.length);for(let l=0;l<n.length;l++)o[l]=Math.trunc(n[l]);return o.buffer}else if(s>255){r.datatypeCode=4,r.numBitsPerVoxel=16;const o=new Int16Array(n.length);for(let l=0;l<n.length;l++)o[l]=Math.trunc(n[l]);return o.buffer}else{r.datatypeCode=2,r.numBitsPerVoxel=8;const o=new Uint8Array(n.length);for(let l=0;l<n.length;l++)o[l]=Math.trunc(n[l]);return o.buffer}}function bT(r,e,n){const i=r.byteLength-e.vox_offset;if(i<n)return Q.error(`MGH image data size mismatch: expected ${n}, found ${i}`),!1;if(i===n)return!1;const a=e.vox_offset+n+20,s=r.byteLength-a;return s<=12?!1:AC(new DataView(r),a,s).toLowerCase().endsWith("lut.txt")?!0:AC(new DataView(r),a,s,3).includes("mri_label2vol")}async function GG(r,e){r.hdr||(Q.debug("readMgh called before nvImage.hdr was initialized. Creating default."),r.hdr=new Ne);const n=r.hdr;n.littleEndian=!1;let i=e,a=new DataView(i);if(i.byteLength>=2&&a.getUint8(0)===31&&a.getUint8(1)===139)try{i=await Oe.decompressToBuffer(new Uint8Array(e)),a=new DataView(i)}catch(G){return Q.error("Failed to decompress MGZ file.",G),null}if(i.byteLength<284)return Q.error("File too small to be a valid MGH/MGZ header."),null;const s=a.getInt32(0,!1),o=a.getInt32(4,!1),l=a.getInt32(8,!1),u=a.getInt32(12,!1),c=a.getInt32(16,!1),h=a.getInt32(20,!1),d=a.getFloat32(30,!1),v=a.getFloat32(34,!1),m=a.getFloat32(38,!1),y=a.getFloat32(42,!1),b=a.getFloat32(46,!1),x=a.getFloat32(50,!1),A=a.getFloat32(54,!1),C=a.getFloat32(58,!1),E=a.getFloat32(62,!1),S=a.getFloat32(66,!1),T=a.getFloat32(70,!1),R=a.getFloat32(74,!1),D=a.getFloat32(78,!1),B=a.getFloat32(82,!1),N=a.getFloat32(86,!1);if(s!==1&&Q.warn(`Unexpected MGH version: ${s}.`),o<=0||l<=0||u<=0)return Q.error(`Invalid MGH dimensions: ${o}x${l}x${u}`),null;switch(h){case 0:n.numBitsPerVoxel=8,n.datatypeCode=2;break;case 4:n.numBitsPerVoxel=16,n.datatypeCode=4;break;case 1:n.numBitsPerVoxel=32,n.datatypeCode=8;break;case 3:n.numBitsPerVoxel=32,n.datatypeCode=16;break;default:return Q.error(`Unsupported MGH data type: ${h}`),null}n.dims[1]=o,n.dims[2]=l,n.dims[3]=u,n.dims[4]=Math.max(1,c),n.dims[0]=n.dims[4]>1?4:3,n.pixDims[1]=Math.abs(d),n.pixDims[2]=Math.abs(v),n.pixDims[3]=Math.abs(m),n.pixDims[4]=0,n.sform_code=1,n.qform_code=0;const I=Hn(y*n.pixDims[1],A*n.pixDims[2],S*n.pixDims[3],0,b*n.pixDims[1],C*n.pixDims[2],T*n.pixDims[3],0,x*n.pixDims[1],E*n.pixDims[2],R*n.pixDims[3],0,0,0,0,1),P=er(n.dims[1]/2,n.dims[2]/2,n.dims[3]/2,1),F=Yi();qr(F,P,I);const O=Me(D-F[0],B-F[1],N-F[2]);n.affine=[[I[0],I[1],I[2],O[0]],[I[4],I[5],I[6],O[1]],[I[8],I[9],I[10],O[2]],[0,0,0,1]],n.vox_offset=284,n.magic="n+1";const U=n.numBitsPerVoxel/8,V=o*l*u*n.dims[4]*U,_=i.slice(n.vox_offset,n.vox_offset+V);return bT(i,n,V)?xT(n,_):_}var wT={};q0(wT,{readNifti:()=>YG});async function YG(r,e){let n=e,i=null;try{if(ay(n)&&(Q.debug(`Decompressing NIfTI file: ${r.name}`),n=await pz(n),Q.debug(`Decompression complete for: ${r.name}`)),!n||n.byteLength===0)throw new Error("Buffer became invalid after decompression attempt.");if(r.hdr=await xc(n),Az(r.hdr)&&(r.extensions=r.hdr.extensions),r.hdr===null)throw new Error(`Failed to read NIfTI header: ${r.name}`);if(r.hdr.cal_min===0&&r.hdr.cal_max===255&&r.hdr.datatypeCode!==2&&(Q.debug(`Resetting suspicious cal_min/max (0/255) for non-uint8 NIfTI: ${r.name}`),r.hdr.cal_min=0,r.hdr.cal_max=0),i=xz(r.hdr,n),i===null)throw new Error(`nifti-reader-js readImage returned null for ${r.name}`);return i}catch(a){return Q.error(`Error processing NIfTI file ${r.name}:`,a),r.hdr=null,null}}var CT={};q0(CT,{readNrrd:()=>HG});async function HG(r,e,n=null){r.hdr||(Q.warn("readNrrd called before nvImage.hdr was initialized. Creating default."),r.hdr=new Ne);const i=r.hdr;i.pixDims=[1,1,1,1,1,0,0,0];const a=e.byteLength;let s=null;const o=new Uint8Array(e);for(let R=1;R<a;R++)if(o[R-1]===10&&o[R]===10){const D=e.slice(0,R-1);s=new TextDecoder().decode(D),i.vox_offset=R+1;break}if(s===null)return Q.error("readNrrd: could not extract txt"),null;const l=s.split(`
`);if(!l[0].startsWith("NRRD"))return Q.error("Invalid NRRD image (magic signature missing)"),null;const u=l.length;let c=!1,h=!1,d=!1;const v=ao(NaN,0,0,0,1,0,0,0,1),m=Me(0,0,0);let y=S_();for(let R=1;R<u;R++){let D=l[R];if((D.length===0||D[0]==="#")&&(D.startsWith("#")||D.trim().length===0))continue;D=D.toLowerCase();const B=D.split(":");if(B.length<2)continue;const N=B[0].trim();let I=B[1].trim();switch(I=I.replaceAll(")"," "),I=I.replaceAll("("," "),I=I.trim(),N){case"data file":d=!0;break;case"encoding":if(I.includes("raw"))c=!1;else if(I.includes("gz"))c=!0;else return Q.error("Unsupported NRRD encoding"),null;break;case"type":switch(I){case"uchar":case"unsigned char":case"uint8":case"uint8_t":i.numBitsPerVoxel=8,i.datatypeCode=2;break;case"signed char":case"int8":case"int8_t":i.numBitsPerVoxel=8,i.datatypeCode=256;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":i.numBitsPerVoxel=16,i.datatypeCode=4;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":i.numBitsPerVoxel=16,i.datatypeCode=512;break;case"int":case"signed int":case"int32":case"int32_t":i.numBitsPerVoxel=32,i.datatypeCode=8;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":i.numBitsPerVoxel=32,i.datatypeCode=768;break;case"float":i.numBitsPerVoxel=32,i.datatypeCode=16;break;case"double":i.numBitsPerVoxel=64,i.datatypeCode=64;break;default:return Q.error("Unsupported NRRD data type: "+I),null}break;case"spacings":{const P=I.split(/[ ,]+/);for(let F=0;F<P.length;F++)i.pixDims[F+1]=parseFloat(P[F])}break;case"sizes":{const P=I.split(/[ ,]+/);i.dims[0]=P.length;for(let F=0;F<P.length;F++)i.dims[F+1]=parseInt(P[F])}break;case"endian":I.includes("little")?i.littleEndian=!0:I.includes("big")&&(i.littleEndian=!1);break;case"space directions":{const P=I.split(/[ ,]+/);if(P.length===9)for(let F=0;F<9;F++)v[F]=parseFloat(P[F])}break;case"space origin":{const P=I.split(/[ ,]+/);P.length===3&&(m[0]=parseFloat(P[0]),m[1]=parseFloat(P[1]),m[2]=parseFloat(P[2]))}break;case"space units":I.includes("microns")&&(h=!0);break;case"space":I.includes("right-anterior-superior")||I.includes("ras")?y=ao(1,0,0,0,1,0,0,0,1):I.includes("left-anterior-superior")||I.includes("las")?y=ao(-1,0,0,0,1,0,0,0,1):I.includes("left-posterior-superior")||I.includes("lps")?y=ao(-1,0,0,0,-1,0,0,0,1):Q.warn("Unsupported NRRD space value:",I);break;default:Q.warn("Unknown:",N);break}}if(!isNaN(v[0])){i.sform_code=2,h&&(R_(v,v,.001),m[0]*=.001,m[1]*=.001,m[2]*=.001),y[0]<0&&(m[0]=-m[0]),y[4]<0&&(m[1]=-m[1]),y[8]<0&&(m[2]=-m[2]),z6(v,y,v);const R=Hn(v[0],v[3],v[6],m[0],v[1],v[4],v[7],m[1],v[2],v[5],v[8],m[2],0,0,0,1);if(!r.vox2mm)return null;const D=r.vox2mm([0,0,0],R),B=r.vox2mm([1,0,0],R);$t(B,B,D);const N=r.vox2mm([0,1,0],R);$t(N,N,D);const I=r.vox2mm([0,0,1],R);$t(I,I,D),i.pixDims[1]=ms(B),i.pixDims[2]=ms(N),i.pixDims[3]=ms(I),i.affine=[[R[0],R[1],R[2],R[3]],[R[4],R[5],R[6],R[7]],[R[8],R[9],R[10],R[11]],[0,0,0,1]]}let b=null;const x=d?n:e,A=d?0:i.vox_offset;if(d&&!x)return Q.warn("Missing data: NRRD header describes detached data file but only one URL provided"),null;if(!x||A>=x.byteLength)return Q.error(`NRRD data offset (${A}) invalid for buffer length (${x?.byteLength??0})`),null;let C=x.slice(A);if(c)try{Q.debug("Decompressing NRRD data..."),C=await Oe.decompressToBuffer(new Uint8Array(C)),Q.debug("Decompression complete.")}catch(R){return Q.error("Failed to decompress NRRD data.",R),null}const E=i.numBitsPerVoxel/8,T=i.dims.slice(1,i.dims[0]+1).reduce((R,D)=>R*Math.max(1,D),1)*E;return C.byteLength<T?(Q.error(`NRRD image data size mismatch: expected ${T}, found ${C.byteLength}`),null):(C.byteLength>T&&(Q.warn(`NRRD has extra ${C.byteLength-T} bytes after expected image data. Truncating.`),C=C.slice(0,T)),b=C,i.datatypeCode?i.numBitsPerVoxel?b:(Q.error("NRRD parsing failed to set numBitsPerVoxel."),null):(Q.error("NRRD parsing failed to set datatypeCode."),null))}var gn=class Vd{constructor(e=null,n="",i="gray",a=1,s=null,o=NaN,l=NaN,u=!0,c=.02,h=!1,d=!1,v="",m=0,y=ut.UNKNOWN,b=NaN,x=NaN,A=!0,C=null,E=0){j(this,"name"),j(this,"id"),j(this,"url"),j(this,"headers"),j(this,"_colormap"),j(this,"_opacity"),j(this,"percentileFrac"),j(this,"ignoreZeroVoxels"),j(this,"trustCalMinMax"),j(this,"colormapNegative"),j(this,"colormapLabel"),j(this,"colormapInvert"),j(this,"nFrame4D"),j(this,"frame4D"),j(this,"nTotalFrame4D"),j(this,"cal_minNeg"),j(this,"cal_maxNeg"),j(this,"colorbarVisible",!0),j(this,"modulationImage",null),j(this,"modulateAlpha",0),j(this,"series",[]),j(this,"nVox3D"),j(this,"oblique_angle"),j(this,"maxShearDeg"),j(this,"useQFormNotSForm"),j(this,"colormapType"),j(this,"pixDims"),j(this,"matRAS"),j(this,"pixDimsRAS"),j(this,"obliqueRAS"),j(this,"dimsRAS"),j(this,"permRAS"),j(this,"img2RASstep"),j(this,"img2RASstart"),j(this,"toRAS"),j(this,"toRASvox"),j(this,"frac2mm"),j(this,"frac2mmOrtho"),j(this,"extentsMinOrtho"),j(this,"extentsMaxOrtho"),j(this,"mm2ortho"),j(this,"hdr",null),j(this,"extensions"),j(this,"imageType"),j(this,"img"),j(this,"imaginary"),j(this,"v1"),j(this,"fileObject"),j(this,"dims"),j(this,"onColormapChange",()=>{}),j(this,"onOpacityChange",()=>{}),j(this,"mm000"),j(this,"mm100"),j(this,"mm010"),j(this,"mm001"),j(this,"cal_min"),j(this,"cal_max"),j(this,"robust_min"),j(this,"robust_max"),j(this,"global_min"),j(this,"global_max"),j(this,"urlImgData"),j(this,"isManifest"),j(this,"limitFrames4D"),this.init(e,n,i,a,s,o,l,u,c,h,d,v,m,y,b,x,A,C,E)}init(e=null,n="",i="",a=1,s=null,o=NaN,l=NaN,u=!0,c=.02,h=!1,d=!1,v="",m=0,y=ut.UNKNOWN,b=NaN,x=NaN,A=!0,C=null,E=0,S=null){const T=i==="";if(T&&(i="gray"),this.name=n,this.imageType=y,this.id=Jp(),this._colormap=i,this._opacity=a>1?1:a,this.percentileFrac=c,this.ignoreZeroVoxels=h,this.trustCalMinMax=u,this.colormapNegative=v,this.colormapLabel=C,this.frame4D=m,this.cal_minNeg=b,this.cal_maxNeg=x,this.colorbarVisible=A,this.colormapType=E,this.useQFormNotSForm=d,!e)return;if(T&&this.hdr&&this.hdr.intent_code===1002&&(i="random",this._colormap=i),this.hdr&&typeof this.hdr.magic=="number"&&(this.hdr.magic="n+1"),this.nFrame4D=1,this.hdr)for(let N=4;N<7;N++)this.hdr.dims[N]>1&&(this.nFrame4D*=this.hdr.dims[N]);if(this.frame4D=Math.min(this.frame4D,this.nFrame4D-1),this.nTotalFrame4D=this.nFrame4D,!this.hdr||!S)return;this.nVox3D=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const R=this.nVox3D*(this.hdr.numBitsPerVoxel/8),D=S.byteLength/R;D!==this.nFrame4D&&(D>0&&D*R===S.byteLength?Q.debug("Loading the first "+D+" of "+this.nFrame4D+" volumes"):Q.warn("This header does not match voxel data",this.hdr,S.byteLength),this.nFrame4D=D),(this.hdr.intent_code===1007||this.hdr.intent_code===2003)&&this.nFrame4D===3&&this.hdr.datatypeCode===16&&(S=this.float32V1asRGBA(new Float32Array(S)).buffer),(this.hdr.pixDims[1]===0||this.hdr.pixDims[2]===0||this.hdr.pixDims[3]===0)&&Q.error("pixDims not plausible",this.hdr),(isNaN(this.hdr.scl_slope)||this.hdr.scl_slope===0)&&(this.hdr.scl_slope=1),isNaN(this.hdr.scl_inter)&&(this.hdr.scl_inter=0);let B=yC(this.hdr.affine);if(d||!B||this.hdr.qform_code>this.hdr.sform_code){Q.debug("spatial transform based on QForm");const N=this.hdr.quatern_b,I=this.hdr.quatern_c,P=this.hdr.quatern_d,F=Math.sqrt(1-(Math.pow(N,2)+Math.pow(I,2)+Math.pow(P,2))),O=this.hdr.pixDims[0]===0?1:this.hdr.pixDims[0],U=[[F*F+N*N-I*I-P*P,2*N*I-2*F*P,2*N*P+2*F*I],[2*N*I+2*F*P,F*F+I*I-N*N-P*P,2*I*P-2*F*N],[2*N*P-2*F*I,2*I*P+2*F*N,F*F+P*P-I*I-N*N]],L=this.hdr.affine;for(let V=0;V<3;V+=1)for(let _=0;_<3;_+=1)L[V][_]=U[V][_]*this.hdr.pixDims[_+1],_===2&&(L[V][_]*=O);L[0][3]=this.hdr.qoffset_x,L[1][3]=this.hdr.qoffset_y,L[2][3]=this.hdr.qoffset_z,this.hdr.affine=L}if(B=yC(this.hdr.affine),!B){Q.debug("Defective NIfTI: spatial transform does not make sense");let N=this.hdr.pixDims[1],I=this.hdr.pixDims[2],P=this.hdr.pixDims[3];(isNaN(N)||N===0)&&(N=1),(isNaN(I)||I===0)&&(I=1),(isNaN(P)||P===0)&&(P=1),this.hdr.pixDims[1]=N,this.hdr.pixDims[2]=I,this.hdr.pixDims[3]=P;const F=[[N,0,0,0],[0,I,0,0],[0,0,P,0],[0,0,0,1]];this.hdr.affine=F}if(this.hdr.datatypeCode!==128&&this.hdr.datatypeCode!==2304&&this.hdr.littleEndian!==n2()&&this.hdr.numBitsPerVoxel>8){if(this.hdr.numBitsPerVoxel===16){const N=new Uint16Array(S);for(let I=0;I<N.length;I++){const P=N[I];N[I]=((P&255)<<8|P>>8&255)<<16>>16}}else if(this.hdr.numBitsPerVoxel===32){const N=new Uint32Array(S);for(let I=0;I<N.length;I++){const P=N[I];N[I]=(P&255)<<24|(P&65280)<<8|P>>8&65280|P>>24&255}}else if(this.hdr.numBitsPerVoxel===64){const N=this.hdr.numBitsPerVoxel/8,I=new Uint8Array(S);for(let P=0;P<I.length;P+=N){let F=N-1;for(let O=0;O<F;O++){const U=I[P+O];I[P+O]=I[P+F],I[P+F]=U,F--}}}}switch(this.hdr.datatypeCode){case 2:this.img=new Uint8Array(S);break;case 4:this.img=new Int16Array(S);break;case 16:this.img=new Float32Array(S);break;case 64:this.img=new Float64Array(S);break;case 128:this.img=new Uint8Array(S);break;case 512:this.img=new Uint16Array(S);break;case 2304:this.img=new Uint8Array(S);break;case 256:{const N=new Int8Array(S),I=N.length;this.img=new Int16Array(I);for(let P=0;P<I;P++)this.img[P]=N[P];this.hdr.datatypeCode=4,this.hdr.numBitsPerVoxel=16;break}case 1:{const N=this.hdr.dims[1]*this.hdr.dims[2]*Math.max(1,this.hdr.dims[3])*Math.max(1,this.hdr.dims[4]),I=new Uint8Array(S);this.img=new Uint8Array(N);const P=new Uint8Array(8);for(let O=0;O<8;O++)P[O]=Math.pow(2,O);let F=-1;for(let O=0;O<N;O++){const U=O%8;U===0&&F++,(I[F]&P[U])!==0&&(this.img[O]=1)}this.hdr.datatypeCode=2,this.hdr.numBitsPerVoxel=8;break}case 768:{const N=new Uint32Array(S),I=N.length;this.img=new Float64Array(I);for(let P=0;P<I-1;P++)this.img[P]=N[P];this.hdr.datatypeCode=64;break}case 8:{const N=new Int32Array(S),I=N.length;this.img=new Float64Array(I);for(let P=0;P<I-1;P++)this.img[P]=N[P];this.hdr.datatypeCode=64;break}case 1024:{const N=new BigInt64Array(S),I=N.length;this.img=new Float64Array(I);for(let P=0;P<I-1;P++)this.img[P]=Number(N[P]);this.hdr.datatypeCode=64;break}case 32:{const N=new Float32Array(S),I=Math.floor(N.length/2);this.imaginary=new Float32Array(I),this.img=new Float32Array(I);let P=0;for(let F=0;F<I-1;F++)this.img[F]=N[P],this.imaginary[F]=N[P+1],P+=2;this.hdr.datatypeCode=16;break}default:throw new Error("datatype "+this.hdr.datatypeCode+" not supported")}this.calculateRAS(),isNaN(o)||(this.hdr.cal_min=o),isNaN(l)||(this.hdr.cal_max=l),this.calMinMax()}static async new(e=null,n="",i="",a=1,s=null,o=NaN,l=NaN,u=!0,c=.02,h=!1,d=!1,v="",m=0,y=ut.UNKNOWN,b=NaN,x=NaN,A=!0,C=null,E=0,S){const T=new Vd,R=/(?:\.([^.]+))?$/;let D=R.exec(n)[1]||"";D=D.toUpperCase(),D==="GZ"&&(D=R.exec(n.slice(0,-3))[1],D=D.toUpperCase());let B=null;if(y===ut.UNKNOWN&&(y=ut.parse(D)),e instanceof ArrayBuffer&&e.byteLength>=2&&y===ut.DCM){const N=new Uint8Array(e);(N[0]===92&&N[1]===1||N[1]===92&&N[0]===1)&&(y=ut.NII)}switch(T.imageType=y,y){case ut.DCM_FOLDER:case ut.DCM_MANIFEST:case ut.DCM:return;case ut.FIB:[B,T.v1]=await T.readFIB(e);break;case ut.MIH:case ut.MIF:B=await T.readMIF(e,s);break;case ut.NHDR:case ut.NRRD:if(B=await CT.readNrrd(T,e),B===null)throw new Error(`Failed to parse NHDR/NRRD file ${n}`);break;case ut.MHD:case ut.MHA:B=await T.readMHA(e,s);break;case ut.MGH:case ut.MGZ:if(B=await AT.readMgh(T,e),B===null)throw new Error(`Failed to parse MGH/MGZ file ${n}`);break;case ut.SRC:B=await T.readSRC(e);break;case ut.V:B=T.readECAT(e);break;case ut.V16:B=T.readV16(e);break;case ut.VMR:B=T.readVMR(e);break;case ut.HEAD:B=await T.readHEAD(e,s);break;case ut.BMP:B=await T.readBMP(e);break;case ut.NPY:B=await T.readNPY(e);break;case ut.NPZ:B=await T.readNPZ(e);break;case ut.ZARR:B=await T.readZARR(e,S);break;case ut.NII:if(B=await wT.readNifti(T,e),B===null)throw new Error(`Failed to parse NIfTI file ${n}.`);break;default:throw new Error("Image type not supported")}return T.init(e,n,i,a,s,o,l,u,c,h,d,v,m,y,b,x,A,C,E,B),T}computeObliqueAngle(e){const n=Er(e);Yn(n,e);const i=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),a=Math.max(Math.max(Math.abs(n[0]),Math.abs(n[1])),Math.abs(n[2]))/i,s=Math.sqrt(n[4]*n[4]+n[5]*n[5]+n[6]*n[6]),o=Math.max(Math.max(Math.abs(n[4]),Math.abs(n[5])),Math.abs(n[6]))/s,l=Math.sqrt(n[8]*n[8]+n[9]*n[9]+n[10]*n[10]),u=Math.max(Math.max(Math.abs(n[8]),Math.abs(n[9])),Math.abs(n[10]))/l,c=Math.min(Math.min(a,o),u);let h=Math.abs(Math.acos(c)*180/3.141592653);return h>.01?Q.warn("Warning voxels not aligned with world space: "+h+` degrees from plumb.
`):h=0,h}float32V1asRGBA(e){e.length!==this.nVox3D*3&&Q.warn("float32V1asRGBA() expects "+this.nVox3D*3+"voxels, got ",+e.length);const n=e.slice();this.hdr.datatypeCode=2304,this.nFrame4D=1;for(let u=4;u<7;u++)this.hdr.dims[u]=1;this.hdr.dims[0]=3;const i=new Uint8Array(this.nVox3D*4);let a=1;for(let u=0;u<this.nVox3D*3;u++)isNaN(n[u])||(a=Math.max(a,Math.abs(n[u])));const s=255/a,o=this.nVox3D*2;let l=0;for(let u=0;u<this.nVox3D;u++){const c=n[u],h=n[u+this.nVox3D],d=n[u+o];i[l]=Math.abs(c*s),i[l+1]=Math.abs(h*s),i[l+2]=Math.abs(d*s);const v=+(c>0)*1,m=+(h>0)*2,y=+(d>0)*4;let b=248+v+m+y;Math.abs(c)+Math.abs(h)+Math.abs(d)<.1&&(b=0),i[l+3]=b,l+=4}return i}loadImgV1(e=!1,n=!1,i=!1){let a=this.v1;if(!a&&this.nFrame4D===3&&this.img.constructor===Float32Array&&(a=this.img.slice()),!a)return Q.warn("Image does not have V1 data"),!1;if(e)for(let s=0;s<this.nVox3D;s++)a[s]=-a[s];if(n)for(let s=this.nVox3D;s<2*this.nVox3D;s++)a[s]=-a[s];if(i)for(let s=2*this.nVox3D;s<3*this.nVox3D;s++)a[s]=-a[s];return this.img=this.float32V1asRGBA(a),!0}calculateOblique(){if(!this.matRAS)throw new Error("matRAS not defined");if(this.pixDimsRAS===void 0)throw new Error("pixDimsRAS not defined");if(!this.dimsRAS)throw new Error("dimsRAS not defined");this.oblique_angle=this.computeObliqueAngle(this.matRAS);const e=this.vox2mm([0,0,0],this.matRAS),n=this.vox2mm([1/this.pixDimsRAS[1],0,0],this.matRAS),i=this.vox2mm([0,1/this.pixDimsRAS[2],0],this.matRAS),a=this.vox2mm([0,0,1/this.pixDimsRAS[3]],this.matRAS);$t(n,n,e),$t(i,i,e),$t(a,a,e);const s=Hn(n[0],n[1],n[2],0,i[0],i[1],i[2],0,a[0],a[1],a[2],0,0,0,0,1);this.obliqueRAS=Er(s);const o=Math.abs(90-Ym(n,i)*(180/Math.PI)),l=Math.abs(90-Ym(n,a)*(180/Math.PI)),u=Math.abs(90-Ym(i,a)*(180/Math.PI));this.maxShearDeg=Math.max(Math.max(o,l),u),this.maxShearDeg>.1&&Q.warn("Warning: voxels are rhomboidal, maximum shear is %f degrees.",this.maxShearDeg);const c=er(this.dimsRAS[1],this.dimsRAS[2],this.dimsRAS[3],1),h=Er(this.matRAS);Yn(h,h);const d=er(-.5,-.5,-.5,0);Cl(h,h,Me(d[0],d[1],d[2])),h[0]*=c[0],h[1]*=c[0],h[2]*=c[0],h[4]*=c[1],h[5]*=c[1],h[6]*=c[1],h[8]*=c[2],h[9]*=c[2],h[10]*=c[2],this.frac2mm=Er(h);const v=this.pixDimsRAS[1],m=this.pixDimsRAS[2],y=this.pixDimsRAS[3],b=Er(h);b[0]=v*c[0],b[1]=0,b[2]=0,b[4]=0,b[5]=m*c[1],b[6]=0,b[8]=0,b[9]=0,b[10]=y*c[2];const x=this.mm2vox([0,0,0],!0);b[12]=(-x[0]-.5)*v,b[13]=(-x[1]-.5)*m,b[14]=(-x[2]-.5)*y,this.frac2mmOrtho=Er(b),this.extentsMinOrtho=[b[12],b[13],b[14]],this.extentsMaxOrtho=[b[0]+b[12],b[5]+b[13],b[10]+b[14]],this.mm2ortho=Tt(),Mn(this.mm2ortho,s)}THD_daxes_to_NIFTI(e,n,i){const a=this.hdr;if(a===null)throw new Error("HDR is not set");a.sform_code=2;const s="xxyyzzg";let o=-1,l=-1,u=-1;const c=["x","y","z"];c[0]=s[i[0]],c[1]=s[i[1]],c[2]=s[i[2]];const h=e.slice(0,3),d=n.slice(0,3);for(let v=0;v<3;v++)c[v]==="x"?o=v:c[v]==="y"?l=v:u=v;o<0||l<0||u<0||o===l||o===u||l===u||(a.pixDims[1]=Math.abs(h[0]),a.pixDims[2]=Math.abs(h[1]),a.pixDims[3]=Math.abs(h[2]),a.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],a.affine[0][o]=-h[o],a.affine[1][l]=-h[l],a.affine[2][u]=h[u],a.affine[0][3]=-d[o],a.affine[1][3]=-d[l],a.affine[2][3]=d[u])}SetPixDimFromSForm(){if(!this.hdr)throw new Error("hdr not defined");const e=this.hdr.affine,n=Hn(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],e[3][0],e[3][1],e[3][2],e[3][3]),i=this.vox2mm([0,0,0],n),a=this.vox2mm([1,0,0],n);$t(a,a,i);const s=this.vox2mm([0,1,0],n);$t(s,s,i);const o=this.vox2mm([0,0,1],n);$t(o,o,i),this.hdr.pixDims[1]=ms(a),this.hdr.pixDims[2]=ms(s),this.hdr.pixDims[3]=ms(o)}readECAT(e){this.hdr=new Ne;const n=this.hdr;n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=new DataView(e),a=i.getInt32(0,!1),s=i.getInt16(50,!1);if(a!==1296127058||s<1||s>14)throw new Error("Not a valid ECAT file");let o=512,l=0;const u=[];let c=new Float32Array;for(;;){const h=i.getInt32(o,!1),d=i.getInt32(o+12,!1);if(h+d!==31)break;let v=o+20,m=0,y=0;for(;m<31&&(y=i.getInt32(v,!1),v+=16,y!==0);){m++;let b=y*512;const x=b-512,A=i.getUint16(x,!1);n.dims[1]=i.getUint16(x+4,!1),n.dims[2]=i.getUint16(x+6,!1),n.dims[3]=i.getUint16(x+8,!1);const C=i.getFloat32(x+26,!1);n.pixDims[1]=i.getFloat32(x+34,!1)*10,n.pixDims[2]=i.getFloat32(x+38,!1)*10,n.pixDims[3]=i.getFloat32(x+42,!1)*10,n.pixDims[4]=i.getUint32(x+46,!1)/1e3,u.push(n.pixDims[4]);const E=n.dims[1]*n.dims[2]*n.dims[3],S=new Float32Array(E);if(A===1)for(let R=0;R<E;R++)S[R]=i.getUint8(b)*C,b++;else if(A===6)for(let R=0;R<E;R++)S[R]=i.getUint16(b,!1)*C,b+=2;else if(A===7)for(let R=0;R<E;R++)S[R]=i.getUint32(b,!1)*C,b+=4;else Q.warn("Unknown ECAT data type "+A);const T=c.slice(0);c=new Float32Array(T.length+S.length),c.set(T),c.set(S,T.length),l++}if(y===0)break;o+=512}if(n.dims[4]=l,n.pixDims[4]=u[0],l>1){n.dims[0]=4;let h=!1;for(let d=0;d<l;d++)u[d]!==u[0]&&(h=!0);h&&Q.warn("Frame durations vary")}return n.sform_code=1,n.affine=[[-n.pixDims[1],0,0,(n.dims[1]-2)*.5*n.pixDims[1]],[0,-n.pixDims[2],0,(n.dims[2]-2)*.5*n.pixDims[2]],[0,0,-n.pixDims[3],(n.dims[3]-2)*.5*n.pixDims[3]],[0,0,0,1]],n.numBitsPerVoxel=32,n.datatypeCode=16,c.buffer}readV16(e){this.hdr=new Ne;const n=this.hdr;n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=new DataView(e);return n.dims[1]=i.getUint16(0,!0),n.dims[2]=i.getUint16(2,!0),n.dims[3]=i.getUint16(4,!0),2*n.dims[1]*n.dims[2]*n.dims[3]+6!==e.byteLength&&Q.warn("This does not look like a valid BrainVoyager V16 file"),n.numBitsPerVoxel=16,n.datatypeCode=512,Q.warn("Warning: V16 files have no spatial transforms"),n.affine=[[0,0,-n.pixDims[1],(n.dims[1]-2)*.5*n.pixDims[1]],[-n.pixDims[2],0,0,(n.dims[2]-2)*.5*n.pixDims[2]],[0,-n.pixDims[3],0,(n.dims[3]-2)*.5*n.pixDims[3]],[0,0,0,1]],n.littleEndian=!0,e.slice(6)}async readNPY(e){function n(S){return{"|b1":1,"<i1":1,"<u1":1,"<i2":2,"<u2":2,"<i4":4,"<u4":4,"<f4":4,"<f8":8}[S]??1}function i(S){return{"|b1":2,"<i1":256,"<u1":2,"<i2":4,"<u2":512,"<i4":8,"<u4":768,"<f4":16,"<f8":64}[S]??16}const a=new DataView(e),s=[a.getUint8(0),a.getUint8(1),a.getUint8(2),a.getUint8(3),a.getUint8(4),a.getUint8(5)],o=[147,78,85,77,80,89];if(!s.every((S,T)=>S===o[T]))throw new Error("Not a valid NPY file: Magic number mismatch");const l=a.getUint16(8,!0),u=new TextDecoder("utf-8").decode(e.slice(10,10+l)),c=u.match(/'shape': \((.*?)\)/);if(!c)throw new Error("Invalid NPY header: Shape not found");const h=c[1].split(",").map(S=>S.trim()).filter(S=>S!=="").map(Number),d=u.match(/'descr': '([^']+)'/);if(!d)throw new Error("Invalid NPY header: Data type not found");const v=d[1],m=h.reduce((S,T)=>S*T,1),y=10+l,b=e.slice(y,y+m*n(v)),x=h.length>0?h[h.length-1]:1,A=h.length>1?h[h.length-2]:1,C=h.length>2?h[h.length-3]:1;this.hdr=new Ne;const E=this.hdr;return E.dims=[3,x,A,C,0,0,0,0],E.pixDims=[1,1,1,1,1,0,0,0],E.affine=[[E.pixDims[1],0,0,-(E.dims[1]-2)*.5*E.pixDims[1]],[0,-E.pixDims[2],0,(E.dims[2]-2)*.5*E.pixDims[2]],[0,0,-E.pixDims[3],(E.dims[3]-2)*.5*E.pixDims[3]],[0,0,0,1]],E.numBitsPerVoxel=n(v)*8,E.datatypeCode=i(v),b}async readNPZ(e){const n=new dT(e);for(let i=0;i<n.entries.length;i++){const a=n.entries[i];if(a.fileName.toLowerCase().endsWith(".npy")){const s=await a.extract();return await this.readNPY(s.buffer)}}}async imageDataFromArrayBuffer(e){return new Promise((n,i)=>{const a=new Blob([e]),s=URL.createObjectURL(a),o=new Image;o.crossOrigin="Anonymous",o.src=s,o.onload=()=>{URL.revokeObjectURL(s);const l=document.createElement("canvas");l.width=o.width,l.height=o.height;const u=l.getContext("2d");if(!u){i(new Error("Failed to get 2D context"));return}u.drawImage(o,0,0),n(u.getImageData(0,0,o.width,o.height))},o.onerror=l=>{URL.revokeObjectURL(s),i(l)}})}async readBMP(e){const n=await this.imageDataFromArrayBuffer(e),{width:i,height:a,data:s}=n;this.hdr=new Ne;const o=this.hdr;o.dims=[3,i,a,1,0,0,0,0],o.pixDims=[1,1,1,1,1,0,0,0],o.affine=[[o.pixDims[1],0,0,-(o.dims[1]-2)*.5*o.pixDims[1]],[0,-o.pixDims[2],0,(o.dims[2]-2)*.5*o.pixDims[2]],[0,0,-o.pixDims[3],(o.dims[3]-2)*.5*o.pixDims[3]],[0,0,0,1]],o.numBitsPerVoxel=8,o.datatypeCode=2304;let l=!0;for(let u=0;u<s.length;u+=4)if(s[u]!==s[u+1]||s[u]!==s[u+2]){l=!1;break}if(l){o.datatypeCode=2;const u=new Uint8Array(i*a);for(let c=0,h=0;c<s.length;c+=4,h++)u[h]=s[c];return u.buffer}return s.buffer}async readZARR(e,n){let{width:i,height:a,depth:s=1,data:o}=n??{},l=i*a*s*3,u=l===o.length;if(u||(l=i*a*s,s===3&&(u=!0,s=1)),l!==o.length)throw new Error(`Expected RGB ${i}×${a}×${s}×3 =  ${l}, but ZARR length ${o.length}`);this.hdr=new Ne;const c=this.hdr;if(c.dims=[3,i,a,s,1,1,1,1],c.pixDims=[1,1,1,1,0,0,0,0],c.affine=[[c.pixDims[1],0,0,-(c.dims[1]-2)*.5*c.pixDims[1]],[0,-c.pixDims[2],0,(c.dims[2]-2)*.5*c.pixDims[2]],[0,0,-c.pixDims[3],(c.dims[3]-2)*.5*c.pixDims[3]],[0,0,0,1]],!u){if(c.numBitsPerVoxel=8,c.datatypeCode=2,o instanceof Uint8Array){const y=new ArrayBuffer(o.length);return new Uint8Array(y).set(o),y}return o}c.numBitsPerVoxel=24,c.datatypeCode=128;function h(y,b,x,A){const C=b*x,E=new Uint8Array(C*A*3),S=new Array(A);for(let D=0;D<A;D++)S[D]=C*3*D;let T=0,R=0;for(let D=0;D<C;D++){for(let B=0;B<A;B++)E[S[B]+R]=y[T++],E[S[B]+R+1]=y[T++],E[S[B]+R+2]=y[T++];R+=3}return E}const d=h(o,c.dims[1],c.dims[2],c.dims[3]),v=new ArrayBuffer(d.length);return new Uint8Array(v).set(d),v}readVMR(e){this.hdr=new Ne;const n=this.hdr;n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=new DataView(e),a=i.getUint16(0,!0);a!==4&&Q.warn("Not a valid version 4 VMR image"),n.dims[1]=i.getUint16(2,!0),n.dims[2]=i.getUint16(4,!0),n.dims[3]=i.getUint16(6,!0);const s=n.dims[1]*n.dims[2]*n.dims[3];if(a>=4){let o=8+s;const l=i.getUint32(o+88,!0);if(o=o+92,l>0){const u=e.byteLength;for(let c=0;c<l;c++){for(;o<u&&i.getUint8(o)!==0;)o++;for(o++,o+=4;o<u&&i.getUint8(o)!==0;)o++;o++;const h=i.getUint32(o,!0);o+=4;for(let d=0;d<h;d++)o+=4}}n.pixDims[1]=i.getFloat32(o+2,!0),n.pixDims[2]=i.getFloat32(o+6,!0),n.pixDims[3]=i.getFloat32(o+10,!0)}return Q.warn("Warning: VMR spatial transform not implemented"),n.affine=[[0,0,-n.pixDims[1],(n.dims[1]-2)*.5*n.pixDims[1]],[-n.pixDims[2],0,0,(n.dims[2]-2)*.5*n.pixDims[2]],[0,-n.pixDims[3],0,(n.dims[3]-2)*.5*n.pixDims[3]],[0,0,0,1]],Q.debug(n),n.numBitsPerVoxel=8,n.datatypeCode=2,e.slice(8,8+s)}async readFIB(e){this.hdr=new Ne;const n=this.hdr;n.littleEndian=!1,n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=await Oe.readMatV4(e,!0);if(!("dimension"in i)||!("dti_fa"in i))throw new Error("Not a valid DSIstudio FIB file");const a="index0"in i&&"index1"in i&&"index2"in i&&"odf_vertices"in i;n.numBitsPerVoxel=32,n.datatypeCode=16,n.dims[1]=i.dimension[0],n.dims[2]=i.dimension[1],n.dims[3]=i.dimension[2],n.dims[4]=1,n.pixDims[1]=i.voxel_size[0],n.pixDims[2]=i.voxel_size[1],n.pixDims[3]=i.voxel_size[2],n.sform_code=1;const s=(n.dims[1]-1)*.5*n.pixDims[1],o=(n.dims[2]-1)*.5*n.pixDims[2],l=(n.dims[3]-1)*.5*n.pixDims[3];n.affine=[[n.pixDims[1],0,0,-s],[0,-n.pixDims[2],0,o],[0,0,n.pixDims[2],-l],[0,0,0,1]],n.littleEndian=!0;const u=n.dims[1]*n.dims[2]*n.dims[3],c=u*Math.ceil(n.numBitsPerVoxel/8),h=c*n.dims[4],d=new Uint8Array(new ArrayBuffer(u*4*3));if(a){const b=n.dims[1]*n.dims[2]*n.dims[3],x=new Float32Array(b),A=new Float32Array(b),C=new Float32Array(b),E=i.index0,S=i.odf_vertices;for(let T=0;T<b;T++){const R=E[T]*3;x[T]=S[R+0],A[T]=S[R+1],C[T]=-S[R+2]}d.set(new Uint8Array(x.buffer,x.byteOffset,x.byteLength),0*c),d.set(new Uint8Array(A.buffer,A.byteOffset,A.byteLength),1*c),d.set(new Uint8Array(C.buffer,C.byteOffset,C.byteLength),2*c)}"report"in i&&(n.description=new TextDecoder().decode(i.report.subarray(0,Math.min(79,i.report.byteLength))));const v=new Uint8Array(new ArrayBuffer(h)),m=Float32Array.from(i.dti_fa);if("mask"in i){let b=1;"dti_fa_slope"in i&&(b=i.dti_fa_slope[0]);let x=1;"dti_fa_inter"in i&&(x=i.dti_fa_inter[0]);const A=n.dims[1]*n.dims[2]*n.dims[3],C=i.mask,E=new Float32Array(A);let S=0;for(let T=0;T<A;T++)C[T]!==0&&(E[T]=m[S]*b+x,S++);return[E.buffer,new Float32Array(d.buffer)]}const y=new Uint8Array(m.buffer,m.byteOffset,m.byteLength);return v.set(y,0),[v.buffer,new Float32Array(d.buffer)]}async readSRC(e){this.hdr=new Ne;const n=this.hdr;n.littleEndian=!1,n.dims=[3,1,1,1,0,0,0,0],n.pixDims=[1,1,1,1,1,0,0,0];const i=await Oe.readMatV4(e);if(!("dimension"in i)||!("image0"in i))throw new Error("Not a valid DSIstudio SRC file");let a=0,s=0;for(const[m,y]of Object.entries(i))if(m.startsWith("image")){if(a===0?s=y.length:s!==y.length&&(s=-1),y.constructor!==Uint16Array)throw new Error("DSIstudio SRC files always use Uint16 datatype");a++}if(s<1||a<1)throw new Error("SRC file not valid DSI Studio data. The image(s) should have the same length");n.numBitsPerVoxel=16,n.datatypeCode=512,n.dims[1]=i.dimension[0],n.dims[2]=i.dimension[1],n.dims[3]=i.dimension[2],n.dims[4]=a,n.dims[4]>1&&(n.dims[0]=4),n.pixDims[1]=i.voxel_size[0],n.pixDims[2]=i.voxel_size[1],n.pixDims[3]=i.voxel_size[2],n.sform_code=1;const o=(n.dims[1]-1)*.5*n.pixDims[1],l=(n.dims[2]-1)*.5*n.pixDims[2],u=(n.dims[3]-1)*.5*n.pixDims[3];n.affine=[[n.pixDims[1],0,0,-o],[0,-n.pixDims[2],0,l],[0,0,n.pixDims[2],-u],[0,0,0,1]],n.littleEndian=!0;const c=n.dims[1]*n.dims[2]*n.dims[3]*(n.numBitsPerVoxel/8),h=c*n.dims[4],d=new Uint8Array(new ArrayBuffer(h));let v=0;for(let m=0;m<a;m++){const y=i[`image${m}`],b=new Uint8Array(y.buffer,y.byteOffset,y.byteLength);d.set(b,v),v+=c}return"report"in i&&(n.description=new TextDecoder().decode(i.report.subarray(0,Math.min(79,i.report.byteLength)))),d.buffer}async readHEAD(e,n){this.hdr=new Ne;const i=this.hdr;i.dims[0]=3,i.pixDims=[1,1,1,1,1,0,0,0];let a=[0,0,0],s=[0,0,0],o=[1,1,1];const u=new TextDecoder().decode(e).split(/\r?\n/),c=(e.byteLength+8)%16,h=e.byteLength+(16-c);Q.debug(e.byteLength,"len",h);const d=new ArrayBuffer(h);new Uint8Array(d).set(new Uint8Array(e));const v=new tT(h+8,42,d,!0);i.addExtension(v),i.extensionCode=42,i.extensionFlag[0]=1,i.extensionSize=h+8;const m=u.length;let y=0,b=!1;for(;y<m;){let A=u[y];if(y++,!A.startsWith("type"))continue;const C=A.includes("integer-attribute"),E=A.includes("float-attribute");if(A=u[y],y++,!A.startsWith("name"))continue;let S=A.split("= ");const T=S[1];A=u[y],y++,S=A.split("= ");let R=parseInt(S[1]);if(!(R<1)){if(A=u[y],y++,S=A.trim().split(/\s+/),E||C){for(;S.length<R;){A=u[y],y++;const D=A.trim().split(/\s+/);S.push(...D)}for(let D=0;D<R;D++)S[D]=parseFloat(S[D])}switch(T){case"BYTEORDER_STRING":S[0].includes("LSB_FIRST")?i.littleEndian=!0:S[0].includes("MSB_FIRST")&&(i.littleEndian=!1);break;case"BRICK_TYPES":{i.dims[4]=R;const D=parseInt(S[0]);D===0?(i.numBitsPerVoxel=8,i.datatypeCode=2):D===1?(i.numBitsPerVoxel=16,i.datatypeCode=4):D===3?(i.numBitsPerVoxel=32,i.datatypeCode=16):Q.warn("Unknown BRICK_TYPES ",D)}break;case"IJK_TO_DICOM_REAL":if(R<12)break;b=!0,i.sform_code=2,i.affine=[[-S[0],-S[1],-S[2],-S[3]],[-S[4],-S[5],-S[6],-S[7]],[S[8],S[9],S[10],S[11]],[0,0,0,1]];break;case"DATASET_DIMENSIONS":R=Math.max(R,3);for(let D=0;D<R;D++)i.dims[D+1]=S[D];break;case"ORIENT_SPECIFIC":a=S;break;case"ORIGIN":s=S;break;case"DELTA":o=S;break;case"TAXIS_FLOATS":i.pixDims[4]=S[0];break;default:Q.warn("Unknown:",T)}}}b?this.SetPixDimFromSForm():this.THD_daxes_to_NIFTI(o,s,a);const x=i.numBitsPerVoxel/8*i.dims[1]*i.dims[2]*i.dims[3]*i.dims[4];if(!n)throw new Error("pairedImgData not set");return n.byteLength<x?await Oe.decompressToBuffer(new Uint8Array(n)):n.slice(0)}async readMHA(e,n){const i=e.byteLength;if(i<20)throw new Error("File too small to be VTK: bytes = "+e.byteLength);const a=new Uint8Array(e);let s=0;function o(b){return b===10||b===13}function l(){for(;s<i&&o(a[s]);)s++;const b=s;for(;s<i&&!o(a[s]);)s++;return s-b<2?"":new TextDecoder().decode(e.slice(b,s))}let u=l();this.hdr=new Ne;const c=this.hdr;c.pixDims=[1,1,1,1,1,0,0,0],c.dims=[1,1,1,1,1,1,1,1],c.littleEndian=!0;let h=!1,d=!1;const v=ao(NaN,0,0,0,1,0,0,0,1),m=Me(0,0,0);for(;u!=="";){let b=u.split(" ");if(b.length>2&&(b=b.slice(2)),u.startsWith("BinaryDataByteOrderMSB")&&b[0].includes("False")&&(c.littleEndian=!0),u.startsWith("BinaryDataByteOrderMSB")&&b[0].includes("True")&&(c.littleEndian=!1),u.startsWith("CompressedData")&&b[0].includes("True")&&(h=!0),u.startsWith("TransformMatrix"))for(let x=0;x<9;x++)v[x]=parseFloat(b[x]);if(u.startsWith("Offset"))for(let x=0;x<Math.min(b.length,3);x++)m[x]=parseFloat(b[x]);if(u.startsWith("ElementSpacing"))for(let x=0;x<b.length;x++)c.pixDims[x+1]=parseFloat(b[x]);if(u.startsWith("DimSize")){c.dims[0]=b.length;for(let x=0;x<b.length;x++)c.dims[x+1]=parseInt(b[x])}if(u.startsWith("ElementType"))switch(b[0]){case"MET_UCHAR":c.numBitsPerVoxel=8,c.datatypeCode=2;break;case"MET_CHAR":c.numBitsPerVoxel=8,c.datatypeCode=256;break;case"MET_SHORT":c.numBitsPerVoxel=16,c.datatypeCode=4;break;case"MET_USHORT":c.numBitsPerVoxel=16,c.datatypeCode=512;break;case"MET_INT":c.numBitsPerVoxel=32,c.datatypeCode=8;break;case"MET_UINT":c.numBitsPerVoxel=32,c.datatypeCode=768;break;case"MET_FLOAT":c.numBitsPerVoxel=32,c.datatypeCode=16;break;case"MET_DOUBLE":c.numBitsPerVoxel=64,c.datatypeCode=64;break;default:throw new Error("Unsupported MHA data type: "+b[0])}if(u.startsWith("ObjectType")&&!b[0].includes("Image")&&Q.warn("Only able to read ObjectType = Image, not "+u),u.startsWith("ElementDataFile")){b[0]!=="LOCAL"&&(d=!0);break}u=l()}const y=ao(c.pixDims[1],0,0,0,c.pixDims[2],0,0,0,c.pixDims[3]);for(z6(v,v,y),c.affine=[[-v[0],-v[3],-v[6],-m[0]],[-v[1],-v[4],-v[7],-m[1]],[v[2],v[5],v[8],m[2]],[0,0,0,1]];a[s]===10;)s++;return c.vox_offset=s,d&&n?h?await Oe.decompressToBuffer(new Uint8Array(n.slice(0))):n.slice(0):h?await Oe.decompressToBuffer(new Uint8Array(e.slice(c.vox_offset))):e.slice(c.vox_offset)}async readMIF(e,n){this.hdr=new Ne;const i=this.hdr;i.pixDims=[1,1,1,1,1,0,0,0],i.dims=[1,1,1,1,1,1,1,1];let a=e.byteLength;if(a<20)throw new Error("File too small to be MIF: bytes = "+a);let s=new Uint8Array(e);s[0]===31&&s[1]===139&&(Q.debug("MIF with GZ decompression"),e=await Oe.decompressToBuffer(new Uint8Array(e)),a=e.byteLength,s=new Uint8Array(e));let o=0;function l(){for(;o<a&&s[o]===10;)o++;const F=o;for(;o<a&&s[o]!==10;)o++;return o++,o-F<1?"":new TextDecoder().decode(e.slice(F,o-1))}let u=l();if(!u.startsWith("mrtrix image"))throw new Error("Not a valid MIF file");const c=[];let h=!1,d=0,v=0,m=!1;for(u=l();o<a&&!u.startsWith("END");){let F=u.split(":");if(u=l(),F.length<2)break;const O=F[0];F=F[1].split(",");for(let U=0;U<F.length;U++)F[U]=F[U].trim();switch(O){case"dim":i.dims[0]=F.length;for(let U=0;U<F.length;U++)i.dims[U+1]=parseInt(F[U]);break;case"vox":for(let U=0;U<F.length;U++)i.pixDims[U+1]=parseFloat(F[U]),isNaN(i.pixDims[U+1])&&(i.pixDims[U+1]=0);break;case"layout":for(let U=0;U<F.length;U++)c.push(parseInt(F[U]));break;case"datatype":{const U=F[0];U.startsWith("Bit")?(h=!0,i.datatypeCode=2):U.startsWith("Int8")?i.datatypeCode=256:U.startsWith("UInt8")?i.datatypeCode=2:U.startsWith("Int16")?i.datatypeCode=4:U.startsWith("UInt16")?i.datatypeCode=512:U.startsWith("Int32")?i.datatypeCode=8:U.startsWith("UInt32")?i.datatypeCode=768:U.startsWith("Float32")?i.datatypeCode=16:U.startsWith("Float64")?i.datatypeCode=64:Q.warn("Unsupported datatype "+U),U.includes("8")?i.numBitsPerVoxel=8:U.includes("16")?i.numBitsPerVoxel=16:U.includes("32")?i.numBitsPerVoxel=32:U.includes("64")&&(i.numBitsPerVoxel=64),i.littleEndian=!0,U.endsWith("LE")&&(i.littleEndian=!0),U.endsWith("BE")&&(i.littleEndian=!1)}break;case"transform":if(d>2||F.length!==4)break;i.affine[d][0]=parseFloat(F[0]),i.affine[d][1]=parseFloat(F[1]),i.affine[d][2]=parseFloat(F[2]),i.affine[d][3]=parseFloat(F[3]),d++;break;case"comments":i.description=F[0].substring(0,Math.min(79,F[0].length));break;case"RepetitionTime":v=parseFloat(F[0]);break;case"file":m=!F[0].startsWith(". "),m||(F=F[0].split(" "),i.vox_offset=parseInt(F[1]));break}}const y=i.dims[0];y>5&&Q.warn("reader only designed for a maximum of 5 dimensions (XYZTD)");let b=1;for(let F=0;F<y;F++)b*=Math.max(i.dims[F+1],1);for(let F=0;F<3;F++)for(let O=0;O<3;O++)i.affine[F][O]*=i.pixDims[O+1];Q.debug("mif affine:"+i.affine[0]),v>0&&(i.pixDims[4]=v),m&&!n&&Q.warn("MIH header provided without paired image data");let x;if(n&&m)x=n.slice(0);else if(h){i.numBitsPerVoxel=8;const F=new Uint8Array(b),O=e.slice(i.vox_offset,i.vox_offset+Math.ceil(b/8)),U=new Uint8Array(O);let L=0;for(let V=0;V<b;V++){const _=V%8;F[V]=U[L]>>7-_&1,_===7&&L++}x=F.buffer}else x=e.slice(i.vox_offset,i.vox_offset+b*(i.numBitsPerVoxel/8));c.length!==i.dims[0]&&Q.warn("dims does not match layout");let A=1;const C=[1,1,1,1,1],E=[!1,!1,!1,!1,!1];for(let F=0;F<c.length;F++)for(let O=0;O<c.length;O++)Math.abs(c[O])===F&&(C[O]=A,(c[O]<0||Object.is(c[O],-0))&&(E[O]=!0),A*=i.dims[O+1]);let S=Oe.range(0,i.dims[1]-1,1);E[0]&&(S=Oe.range(i.dims[1]-1,0,-1));for(let F=0;F<i.dims[1];F++)S[F]*=C[0];let T=Oe.range(0,i.dims[2]-1,1);E[1]&&(T=Oe.range(i.dims[2]-1,0,-1));for(let F=0;F<i.dims[2];F++)T[F]*=C[1];let R=Oe.range(0,i.dims[3]-1,1);E[2]&&(R=Oe.range(i.dims[3]-1,0,-1));for(let F=0;F<i.dims[3];F++)R[F]*=C[2];let D=Oe.range(0,i.dims[4]-1,1);E[3]&&(D=Oe.range(i.dims[4]-1,0,-1));for(let F=0;F<i.dims[4];F++)D[F]*=C[3];let B=Oe.range(0,i.dims[5]-1,1);E[4]&&(B=Oe.range(i.dims[5]-1,0,-1));for(let F=0;F<i.dims[5];F++)B[F]*=C[4];let N=0,I,P;switch(i.datatypeCode){case 256:I=new Int8Array(x),P=new Int8Array(b);break;case 2:I=new Uint8Array(x),P=new Uint8Array(b);break;case 4:I=new Int16Array(x),P=new Int16Array(b);break;case 512:I=new Uint16Array(x),P=new Uint16Array(b);break;case 8:I=new Int32Array(x),P=new Int32Array(b);break;case 768:I=new Uint32Array(x),P=new Uint32Array(b);break;case 16:I=new Float32Array(x),P=new Float32Array(b);break;case 64:I=new Float64Array(x),P=new Float64Array(b);break;default:throw new Error("unknown datatypeCode")}for(let F=0;F<i.dims[5];F++)for(let O=0;O<i.dims[4];O++)for(let U=0;U<i.dims[3];U++)for(let L=0;L<i.dims[2];L++)for(let V=0;V<i.dims[1];V++)P[N]=I[S[V]+T[L]+R[U]+D[O]+B[F]],N++;return P.buffer}calculateRAS(){if(!this.hdr)throw new Error("hdr not set");const e=this.hdr.affine,n=this.hdr,i=ao(Math.abs(e[0][0]),Math.abs(e[0][1]),Math.abs(e[0][2]),Math.abs(e[1][0]),Math.abs(e[1][1]),Math.abs(e[1][2]),Math.abs(e[2][0]),Math.abs(e[2][1]),Math.abs(e[2][2])),a=[1,1,1];i[3]>i[0]&&(a[0]=2),i[6]>i[0]&&i[6]>i[3]&&(a[0]=3),a[1]=1,a[0]===1?i[4]>i[7]?a[1]=2:a[1]=3:a[0]===2?i[1]>i[7]?a[1]=1:a[1]=3:i[1]>i[4]?a[1]=1:a[1]=2,a[2]=6-a[1]-a[0];let s=[1,2,3];s[a[0]-1]=1,s[a[1]-1]=2,s[a[2]-1]=3;let o=Hn(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],0,0,0,1);this.mm000=this.vox2mm([-.5,-.5,-.5],o),this.mm100=this.vox2mm([n.dims[1]-.5,-.5,-.5],o),this.mm010=this.vox2mm([-.5,n.dims[2]-.5,-.5],o),this.mm001=this.vox2mm([-.5,-.5,n.dims[3]-.5],o);const l=Tt();T_(l,o);for(let x=0;x<3;x++)for(let A=0;A<3;A++)l[x*4+A]=o[x*4+s[A]-1];const u=[0,0,0];l[0]<0&&(u[0]=1),l[5]<0&&(u[1]=1),l[10]<0&&(u[2]=1),this.dimsRAS=[n.dims[0],n.dims[s[0]],n.dims[s[1]],n.dims[s[2]]],this.pixDimsRAS=[n.pixDims[0],n.pixDims[s[0]],n.pixDims[s[1]],n.pixDims[s[2]]],this.permRAS=s.slice();for(let x=0;x<3;x++)u[x]===1&&(this.permRAS[x]=-this.permRAS[x]);if(this.arrayEquals(s,[1,2,3])&&this.arrayEquals(u,[0,0,0])){this.toRAS=Tt(),this.matRAS=Er(o),this.calculateOblique(),this.img2RASstep=[1,this.dimsRAS[1],this.dimsRAS[1]*this.dimsRAS[2]],this.img2RASstart=[0,0,0];return}q6(o),o[0]=1-u[0]*2,o[5]=1-u[1]*2,o[10]=1-u[2]*2,o[3]=(n.dims[s[0]]-1)*u[0],o[7]=(n.dims[s[1]]-1)*u[1],o[11]=(n.dims[s[2]]-1)*u[2];const c=Tt();Mn(c,o),ls(c,c,l),this.matRAS=Er(c),o=Hn(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1),o[s[0]-1+0]=-u[0]*2+1,o[s[1]-1+4]=-u[1]*2+1,o[s[2]-1+8]=-u[2]*2+1,o[3]=u[0],o[7]=u[1],o[11]=u[2],this.toRAS=Er(o),o[3]=0,o[7]=0,o[11]=0,o[12]=0,(this.permRAS[0]===-1||this.permRAS[1]===-1||this.permRAS[2]===-1)&&(o[12]=n.dims[1]-1),o[13]=0,(this.permRAS[0]===-2||this.permRAS[1]===-2||this.permRAS[2]===-2)&&(o[13]=n.dims[2]-1),o[14]=0,(this.permRAS[0]===-3||this.permRAS[1]===-3||this.permRAS[2]===-3)&&(o[14]=n.dims[3]-1),this.toRASvox=Er(o),Q.debug(this.hdr.dims),Q.debug(this.dimsRAS);const h=this.hdr;s=this.permRAS;const d=[Math.abs(s[0]),Math.abs(s[1]),Math.abs(s[2])],v=[h.dims[d[0]],h.dims[d[1]],h.dims[d[2]]],m=[1,h.dims[1],h.dims[1]*h.dims[2]],y=[m[d[0]-1],m[d[1]-1],m[d[2]-1]],b=[0,0,0];for(let x=0;x<3;x++)s[x]<0&&(b[x]=y[x]*(v[x]-1),y[x]=-y[x]);this.img2RASstep=y,this.img2RASstart=b,this.calculateOblique()}async hdr2RAS(e=1){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.hdr)throw new Error("hdr undefined");const n=h0({...this.hdr,vox_offset:352},!1),i=await xc(n.buffer,!0);e===1?(i.dims[0]=3,i.dims[4]=1):e>1&&(i.dims[0]=4,i.dims[4]=e);const a=this.permRAS.slice();if(a[0]===1&&a[1]===2&&a[2]===3)return i;i.qform_code=0;for(let o=1;o<4;o++)i.dims[o]=this.dimsRAS[o];for(let o=0;o<this.pixDimsRAS.length;o++)i.pixDims[o]=this.pixDimsRAS[o];let s=0;for(let o=0;o<4;o++)for(let l=0;l<4;l++)i.affine[o][l]=this.matRAS[s],s++;return i}img2RAS(e=0){if(!this.permRAS)throw new Error("permRAS undefined");if(!this.img)throw new Error("img undefined");if(!this.hdr)throw new Error("hdr undefined");const n=this.permRAS.slice();if(n[0]===1&&n[1]===2&&n[2]===3)return this.img;const i=this.hdr,a=i.dims[1]*i.dims[2]*i.dims[3];let s=e*a;(s+a>this.img.length||s<0)&&(s=0,Q.warn(`img2RAS nVolume (${e}) out of bounds (${e}+1)×${a} > ${this.img.length}`));const o=this.img.slice(0,a),l=[Math.abs(n[0]),Math.abs(n[1]),Math.abs(n[2])],u=[i.dims[l[0]],i.dims[l[1]],i.dims[l[2]]],c=[1,i.dims[1],i.dims[1]*i.dims[2]],h=[c[l[0]-1],c[l[1]-1],c[l[2]-1]],d=[0,0,0];for(let m=0;m<3;m++)n[m]<0&&(d[m]=h[m]*(u[m]-1),h[m]=-h[m]);let v=0;for(let m=0;m<u[2];m++){const y=d[2]+m*h[2];for(let b=0;b<u[1];b++){const x=d[1]+b*h[1];for(let A=0;A<u[0];A++){const C=d[0]+A*h[0];o[v]=this.img[C+x+y+s],v++}}}return o}vox2mm(e,n){const i=Er(n);Yn(i,i);const a=er(e[0],e[1],e[2],1);return qr(a,a,i),Me(a[0],a[1],a[2])}mm2vox(e,n=!1){if(!this.matRAS)throw new Error("matRAS undefined");const i=Er(this.matRAS),a=Er(i);Yn(a,i),Mn(a,a);const s=er(e[0],e[1],e[2],1);qr(s,s,a);const o=Me(s[0],s[1],s[2]);return n?o:[Math.round(o[0]),Math.round(o[1]),Math.round(o[2])]}arrayEquals(e,n){return Array.isArray(e)&&Array.isArray(n)&&e.length===n.length&&e.every((i,a)=>i===n[a])}setColormap(e){this._colormap=e,this.calMinMax(),this.onColormapChange&&this.onColormapChange(this)}setColormapLabel(e){this.colormapLabel=Vt.makeLabelLut(e)}async setColormapLabelFromUrl(e){this.colormapLabel=await Vt.makeLabelLutFromUrl(e)}get colormap(){return this._colormap}get colorMap(){return this._colormap}set colormap(e){this.setColormap(e)}set colorMap(e){this.setColormap(e)}get opacity(){return this._opacity}set opacity(e){this._opacity=e,this.onOpacityChange&&this.onOpacityChange(this)}calMinMax(e=Number.POSITIVE_INFINITY,n=!0){if(!this.hdr)throw new Error("hdr undefined");if(!this.img)throw new Error("img undefined");let i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=0,o=0,l=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];const u=Math.floor(this.img.length/l);e>=u&&(e=this.frame4D),e=Math.min(e,u-1);const c=e*l;let h=[];if(n){const O=[Math.floor(.25*this.hdr.dims[1]),Math.floor(.25*this.hdr.dims[2]),Math.floor(.25*this.hdr.dims[3])],U=[this.hdr.dims[1]-2*O[0],this.hdr.dims[2]-2*O[1],this.hdr.dims[3]-2*O[2]],L=[U[0]+O[0],U[1]+O[1],U[2]+O[2]];l=U[0]*U[1]*U[2],h=new this.img.constructor(l);let V=-1,_=0;for(let G=0;G<this.hdr.dims[3];G++)for(let K=0;K<this.hdr.dims[2];K++)for(let z=0;z<this.hdr.dims[1];z++)V++,!(z<O[0]||K<O[1]||G<O[2])&&(z>=L[0]||K>=L[1]||G>=L[2]||(h[_]=this.img[V+c],_++))}else{h=new this.img.constructor(l);for(let F=0;F<l;F++)h[F]=this.img[F+c]}const d=h.constructor!==Float64Array&&h.constructor!==Float32Array&&this.ignoreZeroVoxels;if(d)for(let F=0;F<l;F++)i=Math.min(h[F],i),a=Math.max(h[F],a),h[F]===0&&s++;else for(let F=0;F<l;F++){if(isNaN(h[F])){o++;continue}h[F]===0&&(s++,this.ignoreZeroVoxels)||(i=Math.min(h[F],i),a=Math.max(h[F],a))}this.ignoreZeroVoxels&&i===a&&s>0&&(i=0);const v=this.intensityRaw2Scaled(i),m=this.intensityRaw2Scaled(a),y=Vt.colormapFromKey(this._colormap);let b=0,x=0;if(y.min!==void 0&&(b=y.min),y.max!==void 0&&(x=y.max),b===x&&this.trustCalMinMax&&isFinite(this.hdr.cal_min)&&isFinite(this.hdr.cal_max)&&this.hdr.cal_max>this.hdr.cal_min)return this.cal_min=this.hdr.cal_min,this.cal_max=this.hdr.cal_max,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=v,this.global_max=m,[this.hdr.cal_min,this.hdr.cal_max,this.hdr.cal_min,this.hdr.cal_max];if(b!==x)return this.cal_min=b,this.cal_max=x,this.robust_min=this.cal_min,this.robust_max=this.cal_max,[b,x,b,x];const A=100*s/(l-0);let C=!1;A>60&&!this.ignoreZeroVoxels&&(Q.warn(`${Math.round(A)}% of voxels are zero: ignoring zeros for cal_max`),C=!0,this.ignoreZeroVoxels=!0),this.ignoreZeroVoxels||(s=0),s+=o;const E=Math.round((l-0-s)*this.percentileFrac);if(E<1||i===a)return n?this.calMinMax(e,!1):(Q.debug("no variability in image intensity?"),this.cal_min=v,this.cal_max=m,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=v,this.global_max=m,[v,m,v,m]);const S=1001,T=(S-1)/(a-i),R=new Array(S);for(let F=0;F<S;F++)R[F]=0;if(d)for(let F=0;F<l;F++)R[Math.round((h[F]-i)*T)]++;else if(this.ignoreZeroVoxels)for(let F=0;F<l;F++)h[F]!==0&&(isNaN(h[F])||R[Math.round((h[F]-i)*T)]++);else for(let F=0;F<l;F++)isNaN(h[F])||R[Math.round((h[F]-i)*T)]++;let D=0,B=0;for(;D<E;)D+=R[B],B++;B--,D=0;let N=S;for(;D<E;)N--,D+=R[N];if(B===N){let F=-1;for(;F!==0;)B>0&&(B--,R[B]>0&&(F=0)),F!==0&&N<S-1&&(N++,R[N]>0&&(F=0)),B===0&&N===S-1&&(F=0)}let I=this.intensityRaw2Scaled(B/T+i),P=this.intensityRaw2Scaled(N/T+i);return this.hdr.cal_min<this.hdr.cal_max&&this.hdr.cal_min>=v&&this.hdr.cal_max<=m&&(I=this.hdr.cal_min,P=this.hdr.cal_max),C&&(I=Math.min(I,0)),this.cal_min=I,this.cal_max=P,this.hdr.intent_code===1002&&(this.cal_min=v,this.cal_max=m),this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=v,this.global_max=m,[I,P,v,m]}intensityRaw2Scaled(e){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),e*this.hdr.scl_slope+this.hdr.scl_inter}intensityScaled2Raw(e){if(!this.hdr)throw new Error("hdr undefined");return this.hdr.scl_slope===0&&(this.hdr.scl_slope=1),(e-this.hdr.scl_inter)/this.hdr.scl_slope}async saveToUint8Array(e,n=null){return pT(this,e,n)}async saveToDisk(e="",n=null){return LG(this,e,n)}static async fetchDicomData(e,n={}){if(e==="")throw Error("url must not be empty");let a=/^(?:[a-z+]+:)?\/\//i.test(e)?e:new URL(e,window.location.href);/(?:.([^.]+))?$/.exec(a.pathname)||(a=new URL("niivue-manifest.txt",e));let l=await fetch(a,{headers:n});if(!l.ok)throw Error(l.statusText);const c=(await l.text()).split(`
`),d=/(.*\/).*/.exec(a)[0],v=[];for(const m of c){const y=new URL(m,d);if(l=await fetch(y,{headers:n}),!l.ok)throw Error(l.statusText);const b=await l.arrayBuffer();v.push({name:m,data:b})}return v}static async readFirstDecompressedBytes(e,n){const i=e.getReader(),a=new lz,s=[];let o=0,l=!1,u,c;const h=new Promise((v,m)=>{u=v,c=m});function d(){const v=new Uint8Array(o);let m=0;for(const y of s)v.set(y,m),m+=y.length;u(v)}return a.ondata=v=>{s.push(v),o+=v.length,o>=n&&(l=!0,i.cancel().catch(()=>{}),d())},(async()=>{try{for(;!l;){const{done:v,value:m}=await i.read();if(v){l=!0,a.push(new Uint8Array,!0);return}a.push(m,!1)}}catch(v){c(v)}})().catch(()=>{}),h}static extractFilenameFromUrl(e){const i=new URL(e).searchParams.get("response-content-disposition");if(i){const a=i.match(/filename\*?=(?:UTF-8'')?"?([^";]+)"?/);if(a)return decodeURIComponent(a[1])}return e.split("/").pop().split("?")[0]}static async loadInitialVolumesGz(e="",n={},i=NaN){if(isNaN(i))return null;const a=await fetch(e,{headers:n,cache:"force-cache"});let s=352,o=await this.readFirstDecompressedBytes(a.body,s);const l=new DataView(o.buffer,o.byteOffset,o.byteLength),u=l.getUint16(0,!0),c=u===348;if(!c&&!(u===23553)||(o.length>111&&(s=l.getFloat32(108,c)),s>o.length&&(o=await this.readFirstDecompressedBytes(a.body,s)),!(o[0]===92&&o[1]===1||o[1]===92&&o[0]===1)))return null;const v=await xc(o.buffer);if(!v)throw new Error("Could not read NIfTI header");const m=v.numBitsPerVoxel/8,y=[1,2,3].reduce((S,T)=>S*(v.dims[T]>1?v.dims[T]:1),1),b=[4,5,6].reduce((S,T)=>S*(v.dims[T]>1?v.dims[T]:1),1),x=Math.max(Math.min(i,b),1),A=v.vox_offset+x*y*m;if(x===b)return null;const C=await fetch(e,{headers:n,cache:"force-cache"});return(await this.readFirstDecompressedBytes(C.body,A)).buffer.slice(0,A)}static async loadInitialVolumes(e="",n={},i=NaN){if(isNaN(i))return null;const s=(await fetch(e,{headers:n,cache:"force-cache"})).body.getReader(),{value:o,done:l}=await s.read();let u=o;if(l||!u||u.length<2)throw new Error("Not enough data to determine compression");const c=new DataView(u.buffer,u.byteOffset,u.byteLength),h=c.getUint16(0,!0);if(h===35615)return await s.cancel(),this.loadInitialVolumesGz(e,n,i);const v=h===348;if(!v&&!(h===23553))return await s.cancel(),null;let y=352;for(u.length>111&&(y=c.getFloat32(108,v));u.length<y;){let B=function(P,F){const O=new Uint8Array(P.length+F.length);return O.set(P,0),O.set(F,P.length),O};const{value:N,done:I}=await s.read();if(I||!N)break;u=B(u,N)}const b=await xc(u.buffer);if(!b)throw new Error("Could not read NIfTI header");const x=b.numBitsPerVoxel/8,A=[1,2,3].reduce((B,N)=>B*(b.dims[N]>1?b.dims[N]:1),1),C=[4,5,6].reduce((B,N)=>B*(b.dims[N]>1?b.dims[N]:1),1),E=Math.max(Math.min(i,C),1),S=b.vox_offset+E*A*x,T=new Uint8Array(S),R=Math.min(u.length,S);T.set(u.subarray(0,R),0);let D=R;for(;D<S;){const{value:B,done:N}=await s.read();if(N||!B)return await s.cancel(),null;const I=Math.min(B.length,S-D);T.set(B.subarray(0,I),D),D+=I}return await s.cancel(),T.buffer}static async loadFromUrl({url:e="",urlImgData:n="",headers:i={},name:a="",colormap:s="",opacity:o=1,cal_min:l=NaN,cal_max:u=NaN,trustCalMinMax:c=!0,percentileFrac:h=.02,ignoreZeroVoxels:d=!1,useQFormNotSForm:v=!1,colormapNegative:m="",frame4D:y=0,isManifest:b=!1,limitFrames4D:x=NaN,imageType:A=ut.UNKNOWN,colorbarVisible:C=!0,buffer:E=new ArrayBuffer(0)}={}){if(e==="")throw Error("url must not be empty");let S=null,T=null,R=null;if(e instanceof Uint8Array&&(e=e.slice().buffer),E.byteLength>0&&(e=E),e instanceof ArrayBuffer)if(T=e,a!=="")e=a;else{const P=new Uint8Array(T);e=P[0]===31&&P[1]===139?"array.nii.gz":"array.nii"}function D(P){const F=P.match(/\.([^.]+)(?:\.gz|\.bz2|\.xz)?$/);return F?F[1]:""}let B="";if(a===""?B=D(e):B=D(a),A===ut.UNKNOWN&&(A=ut.parse(B)),A===ut.UNKNOWN&&typeof e=="string"){const P=await fetch(e,{});if(P.redirected){const F=this.extractFilenameFromUrl(P.url);F&&F.length>0&&a===""&&(a=F,B=D(a),A=ut.parse(B))}}if(A===ut.ZARR){const P=new URL(e).searchParams,F=P.get("z"),O=P.get("y"),U=P.get("x"),L=F?Nc(parseInt(F),parseInt(F)+1):null,V=O?Nc(parseInt(O),parseInt(O)+1):null,_=U?Nc(parseInt(U),parseInt(U)+1):null,G=e.split("?")[0],K=new Cz(G),z=Gz(K);let Y;try{Y=await ds(z.resolve(e),{kind:"array"})}catch{Y=await ds(z,{kind:"array"})}let Z;if(Y.shape.length===4){const ye=Y.shape[2],ve=Y.shape[1],re=Y.shape[0];L&&L[0]>=ye&&(L[0]=ye-1),V&&V[0]>=ve&&(V[0]=ve-1),_&&_[0]>=re&&(_[0]=re-1),Z=await gC(Y,[_,V,L,null])}else Z=await gC(Y,[_,V,L]);T=Z.data;const[J,ee,ne,oe]=Z.shape;R={data:T,width:ee,height:J,depth:ne,channels:oe}}const N=A===ut.DCM||ut.NII;if(!T&&N&&(T=await this.loadInitialVolumes(e,i,x)),!T)if(b)T=await Vd.fetchDicomData(e,i),A=ut.DCM_MANIFEST;else{const P=await fetch(e,{headers:i});if(!P.ok)throw Error(P.statusText);if(!P.body)throw new Error("No readable stream available");const F=await Zm(P.body),O=[],U=F.getReader();for(;;){const{done:G,value:K}=await U.read();if(G)break;O.push(K)}const L=O.reduce((G,K)=>G+K.length,0);T=new ArrayBuffer(L);const V=new Uint8Array(T);let _=0;for(const G of O)V.set(G,_),_+=G.length}B.toUpperCase()==="HEAD"&&n===""&&(n=e.substring(0,e.lastIndexOf("HEAD"))+"BRIK");let I=null;if(n)try{let P=await fetch(n,{headers:i});if(P.status===404&&n.includes("BRIK")&&(P=await fetch(`${n}.gz`,{headers:i})),P.ok&&P.body){const F=await Zm(P.body),O=[],U=F.getReader();for(;;){const{done:G,value:K}=await U.read();if(G)break;O.push(K)}const L=O.reduce((G,K)=>G+K.length,0);I=new ArrayBuffer(L);const V=new Uint8Array(I);let _=0;for(const G of O)V.set(G,_),_+=G.length}}catch(P){console.error("Error loading paired image data:",P)}if(!T)throw new Error("Unable to load buffer properly from volume");if(!a){let P;try{P=new URL(e).pathname.split("/")}catch{P=e.split("/")}a=P.slice(-1)[0],a.indexOf("?")>-1&&(a=a.slice(0,a.indexOf("?")))}return S=await this.new(T,a,s,o,I,l,u,c,h,d,v,m,y,A,NaN,NaN,!0,null,0,R),S.url=e,S.colorbarVisible=C,S}static async readFileAsync(e,n=NaN){let i=e.stream();if(!isNaN(n)){let d=0;const v=new TransformStream({transform(m,y){if(d>=n){y.terminate();return}const b=n-d;m.length>b?(y.enqueue(m.slice(0,b)),y.terminate()):y.enqueue(m),d+=m.length}});i=i.pipeThrough(v)}const a=await Zm(i),s=[],o=a.getReader();for(;;){const{done:d,value:v}=await o.read();if(d)break;s.push(v)}const l=s.reduce((d,v)=>d+v.length,0),u=new ArrayBuffer(l),c=new Uint8Array(u);let h=0;for(const d of s)c.set(d,h),h+=d.length;return u}static async loadFromFile({file:e,name:n="",colormap:i="",opacity:a=1,urlImgData:s=null,cal_min:o=NaN,cal_max:l=NaN,trustCalMinMax:u=!0,percentileFrac:c=.02,ignoreZeroVoxels:h=!1,useQFormNotSForm:d=!1,colormapNegative:v="",frame4D:m=0,limitFrames4D:y=NaN,imageType:b=ut.UNKNOWN}){let x=null,A=[];try{if(Array.isArray(e))A=await Promise.all(e.map(E=>this.readFileAsync(E)));else{if(isNaN(y))A=await this.readFileAsync(e);else{const E=await this.readFileAsync(e,512),S=new Uint8Array(E);if(!(S[0]===92&&S[1]===1||S[1]===92&&S[0]===1))A=await this.readFileAsync(e);else{const R=await xc(E);if(!R)throw new Error("could not read nifti header");const D=R.numBitsPerVoxel/8,B=[1,2,3].reduce((F,O)=>F*(R.dims[O]>1?R.dims[O]:1),1),N=[4,5,6].reduce((F,O)=>F*(R.dims[O]>1?R.dims[O]:1),1),I=Math.max(Math.min(y,N),1),P=R.vox_offset+I*B*D;A=await this.readFileAsync(e,P)}}n=e.name}let C=null;s&&(C=await this.readFileAsync(s)),x=await this.new(A,n,i,a,C,o,l,u,c,h,d,v,m,b,NaN,NaN,!0,null,0,null),x.fileObject=e}catch(C){throw Q.error(C),new Error("could not build NVImage")}if(x===null)throw new Error("could not build NVImage");return x}static createNiftiArray(e=[256,256,256],n=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],a=2,s=new Uint8Array){return OG(e,n,i,a,s)}static createNiftiHeader(e=[256,256,256],n=[1,1,1],i=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],a=2){return vT(e,n,i,a)}getVolumeData(e=[-1,0,0],n=[0,0,0],i="same"){return zG(this,e,n,i)}setVolumeData(e=[-1,0,0],n=[0,0,0],i=new Uint8Array){qG(this,e,n,i)}static async loadFromBase64({base64:e,name:n="",colormap:i="",opacity:a=1,cal_min:s=NaN,cal_max:o=NaN,trustCalMinMax:l=!0,percentileFrac:u=.02,ignoreZeroVoxels:c=!1,useQFormNotSForm:h=!1,colormapNegative:d="",frame4D:v=0,imageType:m=ut.UNKNOWN,cal_minNeg:y=NaN,cal_maxNeg:b=NaN,colorbarVisible:x=!0,colormapLabel:A=null}){function C(S){const T=window.atob(S),R=T.length,D=new Uint8Array(R);for(let B=0;B<R;B++)D[B]=T.charCodeAt(B);return D.buffer}let E=null;try{const S=C(e);E=await this.new(S,n,i,a,null,s,o,l,u,c,h,d,v,m,y,b,x,A,0,null)}catch(S){Q.debug(S)}if(E===null)throw new Error("could not load NVImage");return E}clone(){const e=new Vd;return e.id=Jp(),e.hdr=Object.assign({},this.hdr),e.img=this.img.slice(),e.calculateRAS(),e.calMinMax(),e}zeroImage(){this.img.fill(0)}getImageMetadata(){if(!this.hdr)throw new Error("hdr undefined");const e=this.id,n=this.hdr.datatypeCode,i=this.hdr.dims,a=i[1],s=i[2],o=i[3],l=Math.max(1,i[4]),u=this.hdr.pixDims,c=u[1],h=u[2],d=u[3],v=u[4],m=Math.floor(this.hdr.numBitsPerVoxel/8);return{id:e,datatypeCode:n,nx:a,ny:s,nz:o,nt:l,dx:c,dy:h,dz:d,dt:v,bpv:m}}static zerosLike(e,n="same"){const i=e.clone();return i.zeroImage(),n==="uint8"&&(i.img=Uint8Array.from(i.img),i.hdr.datatypeCode=2,i.hdr.numBitsPerVoxel=8),n==="float32"&&(i.img=Float32Array.from(i.img),i.hdr.datatypeCode=16,i.hdr.numBitsPerVoxel=32),i}getValue(e,n,i,a=0,s=!1){return _G(this,e,n,i,a,s)}getValues(e,n,i,a=0,s=!1){return yT(this,e,n,i,a,s)}applyOptionsUpdate(e){this.hdr.cal_min=e.cal_min,this.hdr.cal_max=e.cal_max,Object.assign(this,e)}getImageOptions(){return Ud("","",this.name,this._colormap,this.opacity,this.hdr.cal_min,this.hdr.cal_max,this.trustCalMinMax,this.percentileFrac,this.ignoreZeroVoxels,this.useQFormNotSForm,this.colormapNegative,this.frame4D,this.imageType,this.colormapType)}toUint8Array(e=null){return mT(this,e)}convertVox2Frac(e){return Me((e[0]+.5)/this.dimsRAS[1],(e[1]+.5)/this.dimsRAS[2],(e[2]+.5)/this.dimsRAS[3])}convertFrac2Vox(e){return Me(Math.round(e[0]*this.dims[1]-.5),Math.round(e[1]*this.dims[2]-.5),Math.round(e[2]*this.dims[3]-.5))}convertFrac2MM(e,n=!1){const i=er(e[0],e[1],e[2],1);return n?qr(i,i,this.frac2mm):qr(i,i,this.frac2mmOrtho),i}convertMM2Frac(e,n=!1){const i=er(e[0],e[1],e[2],1),a=this.dimsRAS,s=Me(0,0,0);if(typeof a>"u")return s;if(!n){const l=Er(this.frac2mmOrtho);return Mn(l,l),qr(i,i,l),s[0]=i[0],s[1]=i[1],s[2]=i[2],s}if(a[1]<1||a[2]<1||a[3]<1)return s;const o=Er(this.matRAS);return Mn(o,o),Yn(o,o),qr(i,i,o),s[0]=(i[0]+.5)/a[1],s[1]=(i[1]+.5)/a[2],s[2]=(i[2]+.5)/a[3],s}},ET=(r=>(r[r.none=0]="none",r[r.contrast=1]="contrast",r[r.measurement=2]="measurement",r[r.pan=3]="pan",r[r.slicer3D=4]="slicer3D",r[r.callbackOnly=5]="callbackOnly",r[r.roiSelection=6]="roiSelection",r[r.angle=7]="angle",r[r.crosshair=8]="crosshair",r[r.windowing=9]="windowing",r))(ET||{}),xi={textHeight:-1,fontSizeScaling:.4,fontMinPx:13,colorbarHeight:.05,colorbarWidth:-1,showColorbarBorder:!0,crosshairWidth:1,crosshairWidthUnit:"voxels",crosshairGap:0,rulerWidth:4,show3Dcrosshair:!1,backColor:[0,0,0,1],crosshairColor:[1,0,0,1],fontColor:[.5,.5,.5,1],selectionBoxColor:[1,1,1,.5],clipPlaneColor:[.7,0,.7,.5],paqdUniforms:[.3,.5,.5,1],clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1],rulerColor:[1,0,0,.8],colorbarMargin:.05,trustCalMinMax:!0,clipPlaneHotKey:"KeyC",viewModeHotKey:"KeyV",doubleTouchTimeout:500,longTouchTimeout:1e3,keyDebounceTime:50,isNearestInterpolation:!1,isResizeCanvas:!0,atlasOutline:0,atlasActiveIndex:0,isRuler:!1,isColorbar:!1,isOrientCube:!1,tileMargin:0,multiplanarPadPixels:0,multiplanarForceRender:!1,multiplanarEqualSize:!1,multiplanarShowRender:2,isRadiologicalConvention:!1,meshThicknessOn2D:1/0,dragMode:1,dragModePrimary:8,mouseEventConfig:void 0,touchEventConfig:void 0,yoke3Dto2DZoom:!1,isDepthPickMesh:!1,isCornerOrientationText:!1,isOrientationTextVisible:!0,showAllOrientationMarkers:!1,heroImageFraction:0,heroSliceType:4,sagittalNoseLeft:!1,isSliceMM:!1,isV1SliceShader:!1,forceDevicePixelRatio:0,logLevel:"info",loadingText:"loading ...",isForceMouseClickToVoxelCenters:!1,dragAndDropEnabled:!0,drawingEnabled:!1,penValue:1,penType:0,floodFillNeighbors:6,isFilledPen:!1,thumbnail:"",maxDrawUndoBitmaps:8,sliceType:3,meshXRay:0,isAntiAlias:null,limitFrames4D:NaN,isAdditiveBlend:!1,showLegend:!0,legendBackgroundColor:[.3,.3,.3,.5],legendTextColor:[1,1,1,1],multiplanarLayout:0,renderOverlayBlend:1,sliceMosaicString:"",centerMosaic:!1,penSize:1,interactive:!0,clickToSegment:!1,clickToSegmentRadius:3,clickToSegmentBright:!0,clickToSegmentAutoIntensity:!1,clickToSegmentIntensityMax:NaN,clickToSegmentIntensityMin:NaN,clickToSegmentPercent:0,clickToSegmentMaxDistanceMM:Number.POSITIVE_INFINITY,clickToSegmentIs2D:!1,selectionBoxLineThickness:4,selectionBoxIsOutline:!1,scrollRequiresFocus:!1,showMeasureUnits:!0,measureTextJustify:"center",measureTextColor:[1,0,0,1],measureLineColor:[1,0,0,1],measureTextHeight:.06,isAlphaClipDark:!1,gradientOrder:1,gradientOpacity:0,renderSilhouette:0,gradientAmount:0,invertScrollDirection:!1,is2DSliceShader:!1},Cc={gamma:1,azimuth:110,elevation:10,crosshairPos:Me(.5,.5,.5),clipPlane:[0,0,0,0],clipPlaneDepthAziElev:[2,0,0],volScaleMultiplier:1,pan2Dxyzmm:er(0,0,0,1),clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1]};function jG(r,e){const n={};for(const i in r){const a=r[i],s=e[i],o=Array.isArray(a)&&Array.isArray(s);(o&&a.some((l,u)=>l!==s[u])||!o&&a!==s)&&(n[i]=a)}return n}var Jm=class as{constructor(){j(this,"data",{title:"Untitled document",imageOptionsArray:[],meshOptionsArray:[],opts:{...xi},previewImageDataURL:"",labels:[],encodedImageBlobs:[],encodedDrawingBlob:""}),j(this,"scene"),j(this,"volumes",[]),j(this,"meshDataObjects"),j(this,"meshes",[]),j(this,"drawBitmap",null),j(this,"imageOptionsMap",new Map),j(this,"meshOptionsMap",new Map),j(this,"completedMeasurements",[]),j(this,"completedAngles",[]),j(this,"_optsProxy",null),j(this,"_optsChangeCallback",null),this.scene={onAzimuthElevationChange:()=>{},onZoom3DChange:()=>{},sceneData:{...Cc,pan2Dxyzmm:er(0,0,0,1),crosshairPos:Me(.5,.5,.5)},get renderAzimuth(){return this.sceneData.azimuth},set renderAzimuth(e){this.sceneData.azimuth=e,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get renderElevation(){return this.sceneData.elevation},set renderElevation(e){this.sceneData.elevation=e,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get volScaleMultiplier(){return this.sceneData.volScaleMultiplier},set volScaleMultiplier(e){this.sceneData.volScaleMultiplier=e,this.onZoom3DChange(e)},get crosshairPos(){return this.sceneData.crosshairPos},set crosshairPos(e){this.sceneData.crosshairPos=e},get clipPlane(){return this.sceneData.clipPlane},set clipPlane(e){this.sceneData.clipPlane=e},get clipPlaneDepthAziElev(){return this.sceneData.clipPlaneDepthAziElev},set clipPlaneDepthAziElev(e){this.sceneData.clipPlaneDepthAziElev=e},get pan2Dxyzmm(){return this.sceneData.pan2Dxyzmm},set pan2Dxyzmm(e){this.sceneData.pan2Dxyzmm=e},get gamma(){return this.sceneData.gamma},set gamma(e){this.sceneData.gamma=e}}}get title(){return this.data.title}get previewImageDataURL(){return this.data.previewImageDataURL}set previewImageDataURL(e){this.data.previewImageDataURL=e}set title(e){this.data.title=e}get imageOptionsArray(){return this.data.imageOptionsArray}get encodedImageBlobs(){return this.data.encodedImageBlobs}get encodedDrawingBlob(){return this.data.encodedDrawingBlob}get opts(){return this._optsProxy||this._createOptsProxy(),this._optsProxy}set opts(e){this.data.opts={...e},this._optsProxy=null}get labels(){return this.data.labels}set labels(e){this.data.labels=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}hasImage(e){return this.volumes.find(n=>n.id===e.id)!==void 0}hasImageFromUrl(e){return this.data.imageOptionsArray.find(n=>n.url===e)!==void 0}addImageOptions(e,n){if(!this.hasImage(e)&&!n.name)if(n.url){const a=/^(?:[a-z+]+:)?\/\//i.test(n.url)?new URL(n.url):new URL(n.url,window.location.href);n.name=a.pathname.split("/").pop(),n.name.toLowerCase().endsWith(".gz")&&(n.name=n.name.slice(0,-3)),n.name.toLowerCase().endsWith(".nii")||(n.name+=".nii")}else n.name="untitled.nii";n.imageType=ut.NII,this.data.imageOptionsArray.push(n),this.imageOptionsMap.set(e.id,this.data.imageOptionsArray.length-1)}removeImage(e){if(this.imageOptionsMap.has(e.id)){const n=this.imageOptionsMap.get(e.id);this.data.imageOptionsArray.length>n&&this.data.imageOptionsArray.splice(n,1),this.imageOptionsMap.delete(e.id)}this.volumes=this.volumes.filter(n=>n.id!==e.id)}async fetchLinkedData(){if(this.data.encodedImageBlobs=[],!!this.imageOptionsArray?.length){for(const e of this.imageOptionsArray)if(e.url)try{const n=await fetch(e.url);if(!n.ok){console.warn("Failed to fetch image:",e.url);continue}const i=await n.arrayBuffer(),a=new Uint8Array(i),s=Oe.uint8tob64(a);this.data.encodedImageBlobs.push(s),console.info("fetch linked data fetched from ",e.url)}catch(n){console.warn(`Failed to fetch/encode image from ${e.url}:`,n)}}}getImageOptions(e){return this.imageOptionsMap.has(e.id)?this.data.imageOptionsArray[this.imageOptionsMap.get(e.id)]:null}json(e=!0,n=!0){const i={encodedImageBlobs:[],previewImageDataURL:this.data.previewImageDataURL,imageOptionsMap:new Map},a=[];i.sceneData={...this.scene.sceneData},i.opts=jG(this.opts,xi),this.opts.meshThicknessOn2D===1/0&&(i.opts.meshThicknessOn2D="infinity"),this.opts.meshThicknessOn2D===1/0&&(i.opts.meshThicknessOn2D="infinity"),i.labels=[...this.data.labels];for(const o of i.labels)delete o.onClick;if(i.customData=this.customData,i.completedMeasurements=[...this.completedMeasurements],i.completedAngles=[...this.completedAngles],this.volumes.length)for(let o=0;o<this.volumes.length;o++){const l=this.volumes[o];let u=this.getImageOptions(l);if(u===null?(Q.warn("no options found for image, using options from the volume directly"),u={name:l?.name??"",colormap:l?._colormap??"gray",opacity:l?._opacity??1,pairedImgData:null,cal_min:l?.cal_min??NaN,cal_max:l?.cal_max??NaN,trustCalMinMax:l?.trustCalMinMax??!0,percentileFrac:l?.percentileFrac??.02,ignoreZeroVoxels:l?.ignoreZeroVoxels??!1,useQFormNotSForm:l?.useQFormNotSForm??!1,colormapNegative:l?.colormapNegative??"",colormapLabel:l?.colormapLabel??null,imageType:l?.imageType??ut.NII,frame4D:l?.frame4D??0,limitFrames4D:l?.limitFrames4D??NaN,url:l?.url??"",urlImageData:l?.urlImgData??"",alphaThreshold:!1,cal_minNeg:l?.cal_minNeg??NaN,cal_maxNeg:l?.cal_maxNeg??NaN,colorbarVisible:l?.colorbarVisible??!0}):"imageType"in u||(u.imageType=ut.NII),u.colormap=l.colormap,u.colormapLabel=l.colormapLabel,u.opacity=l.opacity,u.cal_max=l.cal_max??NaN,u.cal_min=l.cal_min??NaN,a.push(u),e){const c=Oe.uint8tob64(l.toUint8Array());i.encodedImageBlobs.push(c)}i.imageOptionsMap.set(l.id,o)}i.imageOptionsArray=[...a];const s=[];i.connectomes=[];for(const o of this.meshes){if(o.type==="connectome"){i.connectomes.push(JSON.stringify(o.json()));continue}const l={pts:o.pts,tris:o.tris,name:o.name,rgba255:Uint8Array.from(o.rgba255),opacity:o.opacity,connectome:o.connectome,dpg:o.dpg,dps:o.dps,dpv:o.dpv,meshShaderIndex:o.meshShaderIndex,layers:o.layers.map(u=>({values:u.values,nFrame4D:u.nFrame4D,frame4D:0,outlineBorder:u.outlineBorder,global_min:u.global_min,global_max:u.global_max,cal_min:u.cal_min,cal_max:u.cal_max,opacity:u.opacity,colormap:u.colormap,colormapNegative:u.colormapNegative,colormapLabel:u.colormapLabel,useNegativeCmap:u.useNegativeCmap})),hasConnectome:o.hasConnectome,edgeColormap:o.edgeColormap,edgeColormapNegative:o.edgeColormapNegative,edgeMax:o.edgeMax,edgeMin:o.edgeMin,edges:o.edges&&Array.isArray(o.edges)?[...o.edges]:[],extentsMax:o.extentsMax,extentsMin:o.extentsMin,furthestVertexFromOrigin:o.furthestVertexFromOrigin,nodeColormap:o.nodeColormap,nodeColormapNegative:o.nodeColormapNegative,nodeMaxColor:o.nodeMaxColor,nodeMinColor:o.nodeMinColor,nodeScale:o.nodeScale,legendLineThickness:o.legendLineThickness,offsetPt0:o.offsetPt0,nodes:o.nodes};o.offsetPt0&&o.offsetPt0.length>0&&(l.offsetPt0=o.offsetPt0,l.fiberGroupColormap=o.fiberGroupColormap,l.fiberColor=o.fiberColor,l.fiberDither=o.fiberDither,l.fiberRadius=o.fiberRadius,l.colormap=o.colormap),s.push(l)}return i.meshesString=JSON.stringify(Q_(s)),n&&this.drawBitmap&&(i.encodedDrawingBlob=Oe.uint8tob64(this.drawBitmap)),i}async download(e,n,i={embedImages:!0}){const a=this.json(i.embedImages),s=JSON.stringify(a),o=n?"application/gzip":"application/json",l=n?await Oe.compressStringToArrayBuffer(s):s;Oe.download(l,e,o)}static deserializeMeshDataObjects(e){if(!e.data.meshesString||e.data.meshesString==="[]"){e.meshDataObjects=[];return}if(e.data.meshesString){e.meshDataObjects=H_(JSON.parse(e.data.meshesString));for(const n of e.meshDataObjects)for(const i of n.layers)"colorMap"in i&&(i.colormap=i.colorMap,delete i.colorMap),"colorMapNegative"in i&&(i.colormapNegative=i.colorMapNegative,delete i.colorMapNegative)}}static async loadFromUrl(e){const i=await(await fetch(e)).arrayBuffer();let a;if(Oe.isArrayBufferCompressed(i)){const s=await Oe.decompressArrayBuffer(i);a=JSON.parse(s)}else{const s=new TextDecoder;a=JSON.parse(s.decode(i))}return as.loadFromJSON(a)}static async loadFromFile(e){const n=await Oe.readFileAsync(e);let i;const a=new as;return Oe.isArrayBufferCompressed(n)?i=await Oe.decompressArrayBuffer(n):i=new TextDecoder().decode(n),a.data=JSON.parse(i),a.data.opts.meshThicknessOn2D==="infinity"&&(a.data.opts.meshThicknessOn2D=1/0),a.scene.sceneData={...Cc,...a.data.sceneData},as.deserializeMeshDataObjects(a),a}static loadFromJSON(e){const n=new as;return Object.assign(n.data,{...e,imageOptionsArray:e.imageOptionsArray??[],encodedImageBlobs:e.encodedImageBlobs??[],labels:e.labels??[],meshOptionsArray:e.meshOptionsArray??[],connectomes:e.connectomes??[],encodedDrawingBlob:e.encodedDrawingBlob??"",previewImageDataURL:e.previewImageDataURL??"",customData:e.customData??"",title:e.title??"untitled"}),n.data.opts={...xi,...e.opts||{}},n.data.opts.meshThicknessOn2D==="infinity"&&(n.data.opts.meshThicknessOn2D=1/0),n.scene.sceneData={...Cc,...e.sceneData||{}},e.completedMeasurements&&(n.completedMeasurements=e.completedMeasurements.map(i=>({...i,startMM:bi(i.startMM),endMM:bi(i.endMM)}))),e.completedAngles&&(n.completedAngles=e.completedAngles.map(i=>({...i,firstLineMM:{start:bi(i.firstLineMM.start),end:bi(i.firstLineMM.end)},secondLineMM:{start:bi(i.secondLineMM.start),end:bi(i.secondLineMM.end)}}))),n.data.meshesString&&as.deserializeMeshDataObjects(n),n}static oldloadFromJSON(e){const n=new as;return n.data=e,n.data.opts.meshThicknessOn2D==="infinity"&&(n.data.opts.meshThicknessOn2D=1/0),n.scene.sceneData={...Cc,...e.sceneData},as.deserializeMeshDataObjects(n),n}setOptsChangeCallback(e){this._optsChangeCallback=e,this._optsProxy=null}removeOptsChangeCallback(){this._optsChangeCallback=null,this._optsProxy=null}_createOptsProxy(){const e=this.data.opts;this._optsProxy=new Proxy(e,{set:(n,i,a)=>{const s=n[i];return s!==a&&(n[i]=a,this._optsChangeCallback&&typeof i=="string"&&i in xi&&this._optsChangeCallback(i,a,s)),!0},get:(n,i)=>n[i]})}},KG={colormap:"gray",opacity:0,nFrame4D:0,frame4D:0,outlineBorder:0,cal_min:0,cal_max:0,cal_minNeg:0,cal_maxNeg:0,colormapType:0,values:new Array,useNegativeCmap:!1,showLegend:!0},Sl=class Oi{constructor(e,n,i="",a=new Uint8Array([255,255,255,255]),s=1,o=!0,l,u=null,c=null,h=null,d=null,v=!0,m=""){j(this,"id"),j(this,"name"),j(this,"anatomicalStructurePrimary"),j(this,"colorbarVisible"),j(this,"furthestVertexFromOrigin"),j(this,"extentsMin"),j(this,"extentsMax"),j(this,"opacity"),j(this,"visible"),j(this,"meshShaderIndex",0),j(this,"offsetPt0",null),j(this,"colormapInvert",!1),j(this,"fiberGroupColormap",null),j(this,"indexBuffer"),j(this,"vertexBuffer"),j(this,"vao"),j(this,"vaoFiber"),j(this,"pts"),j(this,"tris"),j(this,"layers"),j(this,"type","mesh"),j(this,"data_type"),j(this,"rgba255"),j(this,"fiberLength"),j(this,"fiberLengths"),j(this,"fiberDensity"),j(this,"fiberDither",.1),j(this,"fiberColor","Global"),j(this,"fiberDecimationStride",1),j(this,"fiberSides",5),j(this,"fiberRadius",0),j(this,"fiberOcclusion",0),j(this,"f32PerVertex",5),j(this,"fiberMask"),j(this,"colormap"),j(this,"dpg"),j(this,"dps"),j(this,"dpv"),j(this,"hasConnectome",!1),j(this,"connectome"),j(this,"indexCount"),j(this,"vertexCount",1),j(this,"nodeScale",4),j(this,"edgeScale",1),j(this,"legendLineThickness",0),j(this,"showLegend",!0),j(this,"nodeColormap","warm"),j(this,"edgeColormap","warm"),j(this,"nodeColormapNegative"),j(this,"edgeColormapNegative"),j(this,"nodeMinColor"),j(this,"nodeMaxColor"),j(this,"edgeMin"),j(this,"edgeMax"),j(this,"nodes"),j(this,"edges"),j(this,"points"),this.anatomicalStructurePrimary=m,this.name=i,this.colorbarVisible=v,this.id=Jp();const y=ro.getExtents(e);if(this.furthestVertexFromOrigin=y.mxDx,this.extentsMin=y.extentsMin,this.extentsMax=y.extentsMax,this.opacity=s>1?1:s,this.visible=o,this.meshShaderIndex=0,this.indexBuffer=l.createBuffer(),this.vertexBuffer=l.createBuffer(),this.vao=l.createVertexArray(),l.bindVertexArray(this.vao),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer),l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer),l.enableVertexAttribArray(0),l.enableVertexAttribArray(1),this.f32PerVertex!==7?(l.vertexAttribPointer(0,3,l.FLOAT,!1,20,0),l.vertexAttribPointer(1,4,l.BYTE,!0,20,12),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,4,l.UNSIGNED_BYTE,!0,20,16)):(l.vertexAttribPointer(0,3,l.FLOAT,!1,28,0),l.vertexAttribPointer(1,3,l.FLOAT,!1,28,12),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,4,l.UNSIGNED_BYTE,!0,28,24)),l.bindVertexArray(null),this.vaoFiber=l.createVertexArray(),this.offsetPt0=null,this.hasConnectome=!1,this.colormapInvert=!1,this.fiberGroupColormap=null,this.pts=e,this.layers=[],this.type="mesh",this.tris=n,a[3]<1){this.rgba255=a,this.fiberLength=2,this.fiberDither=.1,this.fiberColor="Global",this.fiberDecimationStride=1,this.fiberMask=[],this.colormap=u,this.dpg=c,this.dps=h,this.dpv=d,c&&this.initValuesArray(c),h&&this.initValuesArray(h),d&&this.initValuesArray(d),this.offsetPt0=new Uint32Array(n),this.tris=new Uint32Array(0),this.updateFibers(l),l.bindVertexArray(this.vaoFiber),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer),l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer),l.enableVertexAttribArray(0),l.vertexAttribPointer(0,3,l.FLOAT,!1,16,0),l.enableVertexAttribArray(1),l.vertexAttribPointer(1,4,l.UNSIGNED_BYTE,!0,16,12),l.bindVertexArray(null);return}if(u){this.connectome=u,this.hasConnectome=!0;const x=Object.keys(u);for(let A=0,C=x.length;A<C;A++)this[x[A]]=u[x[A]]}this.rgba255=a,this.updateMesh(l)}initValuesArray(e){for(let n=0;n<e.length;n++){const i=e[n].vals.reduce((s,o)=>Math.min(s,o)),a=e[n].vals.reduce((s,o)=>Math.max(s,o));e[n].global_min=i,e[n].global_max=a,e[n].cal_min=i,e[n].cal_max=a}return e}linesToCylinders(e,n,i){function a(N){return Me(N[0],N[1],N[2])}const s=Math.pow(2,32)-1,o=i.length;let l=0,u=0;for(let N=0;N<o;N++){if(i[N]===s){u++;continue}l++}const c=this.fiberSides,h=c*l,d=this.f32PerVertex;if(d!==5)throw Error("fiberSides > 1 requires f32PerVertex == 5");const v=new Float32Array(h*d),m=new Uint8Array(v.buffer);let y=0,b=Yi(),x=Yi(),A=Yi();const C=Kt();let E=Kt(),S=0;const T=this.fiberRadius;for(let N=0;N<o;N++){const I=i[N]===s;if(I&&S<1)continue;let P=i[N]*4;if(S++,S<=1){b=er(n[P+0],n[P+1],n[P+2],n[P+3]),x=hs(b),N+1<o&&i[N+1]!==s&&(P=i[N+1]*4,A=er(n[P+0],n[P+1],n[P+2],n[P+3]),$t(C,a(b),a(A)),ui(C,C),E=Ao.getFirstPerpVector(C));continue}I?A=hs(x):A=er(n[P+0],n[P+1],n[P+2],n[P+3]),$t(C,a(b),a(A)),ui(C,C);const F=Kt();Bd(F,E,C);const O=Kt();Bd(O,C,F),E=bi(E);const U=Kt();Bd(U,C,O),ui(U,U);const L=Kt();for(let V=0;V<c;V++){const _=Math.cos(V/c*2*Math.PI),G=Math.sin(V/c*2*Math.PI);L[0]=T*(_*O[0]+G*U[0]),L[1]=T*(_*O[1]+G*U[1]),L[2]=T*(_*O[2]+G*U[2]),uo(L,a(x),L);const K=y*d;v[K+0]=L[0],v[K+1]=L[1],v[K+2]=L[2];const z=Kt();$t(z,L,a(x)),ui(z,z);const Y=(K+3)*4;m[Y+0]=z[0]*127,m[Y+1]=z[1]*127,m[Y+2]=z[2]*127,v[K+4]=x[3],y++}b=hs(x),x=hs(A),I&&(S=0)}const R=(l-u)*c*2*3,D=new Uint32Array(R);let B=0;y=0;for(let N=1;N<o;N++){if(i[N]===s){y+=c;continue}if(i[N-1]===s)continue;let I=y,P=y+c;const F=P,O=P+c;for(let U=0;U<c;U++)D[B++]=I,D[B++]=P++,P===O&&(P=O-c),D[B++]=P,D[B++]=I++,I===F&&(I=F-c),D[B++]=P,D[B++]=I;y+=c}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(D),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,m,e.STATIC_DRAW),this.indexCount=R}createFiberDensityMap(){if(this.fiberDensity)return;const e=this.pts,n=e.length/3;let i=0;for(let C=0;C<3;C++){const E=this.extentsMax[C]-this.extentsMin[C];i=Math.max(i,E)}if(this.fiberDensity=new Float32Array(n),i===0)return;const a=64,o=i/(a-1)/2,l=(a-1)/i;let u=new Float32Array(a*a*a);const c=[this.extentsMin[0]-o,this.extentsMin[1]-o,this.extentsMin[2]-o],h=[0,0,0],d=-1,v=a*a;let m=0;for(let C=0;C<n;C++){h[0]=Math.round((e[m++]-c[0])*l),h[1]=Math.round((e[m++]-c[1])*l),h[2]=Math.round((e[m++]-c[2])*l);const E=h[0]+h[1]*a+h[2]*v;E!==d&&u[E]++}function y(C,E){let S=C.slice(),T=-1;const R=E-1;for(let B=0;B<E;B++)for(let N=0;N<E;N++)for(let I=0;I<E;I++)T++,!(I<1||I>=R)&&(C[T]=S[T-1]+S[T]+S[T]+S[T+1]);T=-1,S=C.slice();for(let B=0;B<E;B++)for(let N=0;N<E;N++)for(let I=0;I<E;I++)T++,!(N<1||N>=R)&&(C[T]=S[T-E]+S[T]+S[T]+S[T+E]);const D=E*E;T=-1,S=C.slice();for(let B=0;B<E;B++)for(let N=0;N<E;N++)for(let I=0;I<E;I++)T++,!(B<1||B>=R)&&(C[T]=S[T-D]+S[T]+S[T]+S[D]);return C}u=y(u,a),u=y(u,a);let b=0,x=1/0;const A=a*a*a;for(let C=0;C<A;C++)u[C]<=0||(b=Math.max(b,u[C]),x=Math.min(x,u[C]));if(!(b<=1||b<=x)){m=0;for(let C=0;C<A;C++)u[C]=Math.max(0,u[C]-x);b-=x;for(let C=0;C<n;C++){h[0]=Math.round((e[m++]-c[0])*l),h[1]=Math.round((e[m++]-c[1])*l),h[2]=Math.round((e[m++]-c[2])*l);const E=h[0]+h[1]*a+h[2]*v;this.fiberDensity[C]=u[E]/b}}}updateFibers(e){if(!this.offsetPt0||!this.fiberLength)return;const n=this.pts,i=this.offsetPt0,a=i.length-1,s=n.length/3;if(!this.fiberLengths){this.fiberLengths=new Uint32Array(a);for(let R=0;R<a;R++){const D=i[R]*3,B=(i[R+1]-1)*3;let N=0;for(let I=D;I<B;I+=3){const P=Me(n[I+0]-n[I+3],n[I+1]-n[I+4],n[I+2]-n[I+5]);N+=Zc(P)}this.fiberLengths[R]=N}}const o=new Float32Array(s*4),l=new Uint32Array(o.buffer);let u=0,c=0;for(let R=0;R<s;R++)o[c+0]=n[u+0],o[c+1]=n[u+1],o[c+2]=n[u+2],u+=3,c+=4;const h=this.fiberDither,d=h*.5;function v(R,D,B){const I=255*(h*Math.random()-d);return R=Math.max(Math.min(R+I,255),0),D=Math.max(Math.min(D+I,255),0),B=Math.max(Math.min(B+I,255),0),R+(D<<8)+(B<<16)}function m(R,D,B,N,I,P,F){const O=Me(Math.abs(R-N),Math.abs(D-I),Math.abs(B-P));ui(O,O);const U=F-d;for(let L=0;L<3;L++)O[L]=255*Math.max(Math.min(Math.abs(O[L])+U,1),0);return O[0]+(O[1]<<8)+(O[2]<<16)}const y=this.fiberColor.toLowerCase();let b=null,x=null;if(y.startsWith("dps")&&this.dps&&this.dps.length>0){const R=parseInt(y.substring(3));R<this.dps.length&&this.dps[R].vals.length===a&&(b=this.dps[R].vals)}if(y.startsWith("dpv")&&this.dpv&&this.dpv.length>0){const R=parseInt(y.substring(3));R<this.dpv.length&&this.dpv[R].vals.length===s&&(x=this.dpv[R])}const A=new Int16Array(a);if(this.dpg&&this.fiberGroupColormap!==null){const R=new Uint8ClampedArray(this.dpg.length*4),D=new Array(this.dpg.length).fill(!1),B=this.fiberGroupColormap;B.A===void 0&&(B.A=Array.from(new Uint8ClampedArray(B.I.length).fill(255)));for(let N=0;N<B.I.length;N++){let I=B.I[N];I<0||I>=this.dpg.length||B.A[N]<1||(D[I]=!0,I*=4,R[I]=B.R[N],R[I+1]=B.G[N],R[I+2]=B.B[N],R[I+3]=255)}A.fill(-1);for(let N=0;N<this.dpg.length;N++)if(D[N])for(let I=0;I<this.dpg[N].vals.length;I++)A[this.dpg[N].vals[I]]=N;for(let N=0;N<a;N++){if(A[N]<0)continue;const I=A[N]%256*4,P=v(R[I],R[I+1],R[I+2]),F=i[N],O=i[N+1]-1,U=F*4+3,L=O*4+3;for(let V=U;V<=L;V+=4)l[V]=P}}else if(x){const R=Vt.colormap(this.colormap,this.colormapInvert),D=x.cal_min,B=x.cal_max;let N=3;for(let I=0;I<s;I++){let P=Math.min(Math.max((x.vals[I]-D)/(B-D),0),1);P=Math.round(Math.max(Math.min(255,P*255)))*4;const F=R[P]+(R[P+1]<<8)+(R[P+2]<<16);l[N]=F,N+=4}}else if(b){const R=Vt.colormap(this.colormap,this.colormapInvert);let D=b[0],B=b[0];for(let N=0;N<a;N++)D=Math.min(D,b[N]),B=Math.max(B,b[N]);B===D&&(D-=1);for(let N=0;N<a;N++){let I=(b[N]-D)/(B-D);I=Math.round(Math.max(Math.min(255,I*255)))*4;const P=R[I]+(R[I+1]<<8)+(R[I+2]<<16),F=i[N],O=i[N+1]-1,U=F*4+3,L=O*4+3;for(let V=U;V<=L;V+=4)l[V]=P}}else if(y.includes("fixed"))if(h===0){const R=this.rgba255[0]+(this.rgba255[1]<<8)+(this.rgba255[2]<<16);let D=3;for(let B=0;B<s;B++)l[D]=R,D+=4}else for(let R=0;R<a;R++){const D=v(this.rgba255[0],this.rgba255[1],this.rgba255[2]),B=i[R],N=i[R+1]-1,I=B*4+3,P=N*4+3;for(let F=I;F<=P;F+=4)l[F]=D}else if(y.includes("local"))for(let R=0;R<a;R++){const D=i[R],B=i[R+1]-1;let N=D*3;const I=B*3,P=h*Math.random();let F=m(n[N],n[N+1],n[N+2],n[N+4],n[N+5],n[N+6],P),O=D*4+3;for(;N<I;)l[O]=F,O+=4,N+=3,F=m(n[N-3],n[N-2],n[N-1],n[N+3],n[N+4],n[N+5],P);l[O]=l[O-4]}else for(let R=0;R<a;R++){const D=i[R],B=i[R+1]-1,N=D*3,I=B*3,P=m(n[N],n[N+1],n[N+2],n[I],n[I+1],n[I+2],h*Math.random()),F=D*4+3,O=B*4+3;for(let U=F;U<=O;U+=4)l[U]=P}if(this.fiberOcclusion>0){let R=function(D,B){const N=B*(D&255),I=B*(D>>8&255),P=B*(D>>16&255);return N+(I<<8)+(P<<16)};this.createFiberDensityMap();for(let D=0;D<a;D++){const B=i[D],N=i[D+1]-1,I=B*4+3,P=N*4+3;let F=B;const O=Math.min(this.fiberOcclusion,.99);for(let U=I;U<=P;U+=4){let L=this.fiberDensity[F++];if(L<=0)continue;L=L/((1/O-2)*(1-L)+1);const V=1-Math.min(L,.9);let _=l[U];_=R(_,V),l[U]=_}}}const C=this.fiberLength,E=Math.pow(2,32)-1,S=[];let T=-1;for(let R=0;R<a;R++)if(!(A[R]<0)&&!(this.fiberLengths[R]<C)&&(T++,T%this.fiberDecimationStride===0)){for(let D=i[R];D<i[R+1];D++)S.push(D);S.push(E)}this.fiberSides>2&&this.fiberRadius>0?this.linesToCylinders(e,o,S):(this.indexCount=S.length,e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Uint32Array.from(l),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(S),e.STATIC_DRAW))}indexNearestXYZmm(e,n,i){const a=this.pts,s=this.pts.length/3;let o=0,l=1/0,u=0;for(let c=0;c<s;c++){const h=Math.pow(a[o]-e,2)+Math.pow(a[o+1]-n,2)+Math.pow(a[o+2]-i,2);h<l&&(l=h,u=c),o+=3}return l=Math.sqrt(l),[u,l]}unloadMesh(e){if(e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindVertexArray(null),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteVertexArray(this.vao),e.deleteVertexArray(this.vaoFiber),this.offsetPt0=null,this.tris=null,this.pts=null,this.layers&&this.layers.length>0)for(let n=0;n<this.layers.length;n++)this.layers[n].values=null;if(this.dpg&&this.dpg.length>0)for(let n=0;n<this.dpg.length;n++)this.dpg[n].vals=null;if(this.dps&&this.dps.length>0)for(let n=0;n<this.dps.length;n++)this.dps[n].vals=null}scalars2RGBA(e,n,i,a=!1){const s=i.length;if(4*s<e.length)return Q.error(`colormap2RGBA incorrectly specified ${s}*4 != ${e.length}`),e;const o=Math.round(n.opacity*255);let l=n.cal_min,u=n.cal_max,c=Vt.colormap(n.colormap,this.colormapInvert),h=1;if(a){if(!n.useNegativeCmap)return e;h=-1,c=Vt.colormap(n.colormapNegative,n.colormapInvert),l=n.cal_min,u=n.cal_max,isFinite(n.cal_minNeg)&&isFinite(n.cal_minNeg)&&(l=-n.cal_minNeg,u=-n.cal_maxNeg)}let d=l;n.isTransparentBelowCalMin||(d=Number.NEGATIVE_INFINITY);const v=n.colormapType===2;n.colormapType!==0&&(l=Math.min(l,0));const m=255/(u-l);for(let y=0;y<s;y++){let b=i[y]*h;if(isNaN(b))continue;let x=o;if(b<d)if(b>0&&v)x=Math.round(n.opacity*255*Math.pow(b/d,2));else continue;if(b=(b-l)*m,b<0&&n.isTransparentBelowCalMin)continue;b=Math.min(255,Math.max(0,Math.round(b)))*4;const A=y*4;e[A+0]=c[b+0],e[A+1]=c[b+1],e[A+2]=c[b+2],e[A+3]=x}return e}blendColormap(e,n,i,a,s,o,l=!1){const u=this.pts.length/3,c=Math.min(i.opacity,1);function h(E,S,T){return E*(1-T)+S*T}function d(E,S){return Math.min(E+S,255)}const v=l?-1:1,m=Math.min(Math.max(i.frame4D,0),i.nFrame4D-1),y=u*m;let b=a;i.isTransparentBelowCalMin||(b=Number.NEGATIVE_INFINITY),i.colormapType!==0&&(a=Math.min(a,0));const x=255/(s-a);let A=new Array(u).fill(!1);if(i.outlineBorder!==0){const E=new Uint8Array(u).fill(0);for(let S=0;S<u;S++)v*i.values[S+y]>=b&&(E[S]=1);A=ro.getClusterBoundaryU8(E,this.tris);for(let S=0;S<u;S++)v*i.values[S+y]<b&&(A[S]=!1)}const C=new Float32Array(256).fill(c);if(b>a&&i.colormapType===2){let E=Math.round((b-a)*x);E=Math.max(E,1);for(let S=1;S<E;S++)C[S]=c*Math.pow(S/E,2);C[0]=0,b=a+Number.EPSILON}for(let E=0;E<u;E++){const S=v*i.values[E+y];if(S<b)continue;let T=Math.round((S-a)*x);if(T<0&&i.isTransparentBelowCalMin)continue;T=Math.max(0,T),T=Math.min(255,T);let R=C[T];T*=4;let D=E*28+24;if(this.f32PerVertex!==7&&(D=E*20+16),i.isAdditiveBlend){const B=E*4;n[B+0]=d(n[B+0],o[T+0]),n[B+1]=d(n[B+1],o[T+1]),n[B+2]=d(n[B+2],o[T+2]),n[B+3]=d(n[B+3],255)}else{if(A[E]&&(R=i.outlineBorder,i.outlineBorder<0)){e[D+0]=0,e[D+1]=0,e[D+2]=0;continue}e[D+0]=h(e[D+0],o[T+0],R),e[D+1]=h(e[D+1],o[T+1],R),e[D+2]=h(e[D+2],o[T+2],R)}}}updateMesh(e){if(this.offsetPt0){this.updateFibers(e);return}if(this.hasConnectome)return;if(!this.pts||!this.tris||!this.rgba255){Q.warn("underspecified mesh");return}function n(c,h,d){return c*(1-d)+h*d}const i=this.generatePosNormClr(this.pts,this.tris,this.rgba255),a=this.pts.length/3,s=new Uint8Array(i.buffer);let o=0;const l=new Uint8Array(a*4);let u=this.tris;if(this.layers&&this.layers.length>0)for(let c=0;c<this.layers.length;c++){const h=this.layers[c],d=h.opacity;if(d<=0||h.cal_min>h.cal_max)continue;if(h.outlineBorder===void 0&&(h.outlineBorder=0),h.isAdditiveBlend===void 0&&(h.isAdditiveBlend=!1),h.colormapLabel&&h.colormapLabel.R&&!h.colormapLabel.lut&&(h.colormapLabel=Vt.makeLabelLut(h.colormapLabel)),h.colormapLabel&&h.colormapLabel.lut){const m=h.colormapLabel;let y=0;h.colormapLabel.min&&(y=h.colormapLabel.min);let b=m.lut;const x=Math.round(h.opacity*255);b[3]>0&&(b[3]=x);for(let D=7;D<b.length;D+=4)b[D]=x;const A=Math.floor(b.length/4);if(h.atlasValues&&A>0&&A===h.atlasValues.length&&h.colormap){const D=h.atlasValues;let B=!1,N=!0;for(let I=0;I<A;I++)isNaN(D[I])?B=!0:N=!1;if(N){Q.debug("invisible mesh: all atlasValues are NaN.");return}if(B){Q.debug("some vertices have NaN atlasValues (mesh will be decimated).");const I=new Array(a).fill(!1);for(let L=0;L<a;L++){const V=Math.round(h.values[L])-y;isNaN(D[V])&&(I[L]=!0)}const P=new Array(u.length).fill(!1);for(let L=0;L<u.length;L++)I[u[L]]&&(P[L]=!0);const F=this.tris;let O=0;for(let L=0;L<F.length;L+=3)!P[L]&&!P[L+1]&&!P[L+2]&&O++;O===0&&Q.debug("invisible mesh: all triangles of a vertex with a NaN atlasValue."),u=new Uint32Array(O*3);let U=0;for(let L=0;L<F.length;L+=3)!P[L]&&!P[L+1]&&!P[L+2]&&(u[U++]=F[L],u[U++]=F[L+1],u[U++]=F[L+2])}b.fill(0),b=this.scalars2RGBA(b,h,D),h.useNegativeCmap&&(b=this.scalars2RGBA(b,h,D,!0))}else h.atlasValues&&Q.warn(`Expected ${A} atlasValues but got ${h.atlasValues.length} for mesh layer`);if(h.showLegend&&A===h.colormapLabel.labels.length){h.labels=[];for(let D=0;D<A;D++){const B=Array.from(b.slice(D*4,D*4+4)).map(O=>O/255),N=h.colormapLabel.labels[D],I=[0,0,0];let P=0;for(let O=0;O<a;O++)if(h.values[O]===D){const U=O*3;I[0]+=this.pts[U],I[1]+=this.pts[U+1],I[2]+=this.pts[U+2],P++}if(P>0&&(I[0]/=P,I[1]/=P,I[2]/=P),B[3]===0||!N||N.startsWith("_"))continue;B[3]=1;const F=new yy(N,{textColor:B,bulletScale:1,bulletColor:B,lineWidth:0,lineColor:B,textScale:1,textAlignment:"left",lineTerminator:"none"},I);h.labels.push(F),Q.debug("label for mesh layer:",F)}}else delete h.labels;const C=Math.min(Math.max(h.frame4D,0),h.nFrame4D-1),E=a*C,S=new Uint8Array(a*4);let T=0;for(let D=0;D<a;D++){const B=h.values[D+E]-y,N=4*Math.min(Math.max(B,0),A-1);S[T+0]=b[N+0],S[T+1]=b[N+1],S[T+2]=b[N+2],S[T+3]=b[N+3],T+=4}let R=new Array(a).fill(!1);h.outlineBorder!==0&&(R=ro.getClusterBoundary(S,this.tris)),T=0;for(let D=0;D<a;D++){let B=D*28+24;this.f32PerVertex!==7&&(B=D*20+16);let N=S[T+3]/255;if(R[D]&&(N=h.outlineBorder,h.outlineBorder<0)){s[B+0]=0,s[B+1]=0,s[B+2]=0,T+=4;continue}s[B+0]=n(s[B+0],S[T+0],N),s[B+1]=n(s[B+1],S[T+1],N),s[B+2]=n(s[B+2],S[T+2],N),T+=4}continue}if(h.values instanceof Uint8Array){const m=new Uint8Array(h.values.buffer);let y=new Array(a).fill(!0);h.outlineBorder!==0&&(y=ro.getClusterBoundary(m,this.tris));let b=0;for(let x=0;x<h.values.length;x++){let A=x*28+24;this.f32PerVertex!==7&&(A=x*20+16);let C=d;if(y[x]&&(C=h.outlineBorder,h.outlineBorder<0)){s[A+0]=0,s[A+1]=0,s[A+2]=0,b+=4;continue}s[A+0]=n(s[A+0],m[b+0],C),s[A+1]=n(s[A+1],m[b+1],C),s[A+2]=n(s[A+2],m[b+2],C),b+=4}continue}h.useNegativeCmap&&(h.cal_min=Math.max(Number.EPSILON,h.cal_min),h.cal_max=Math.max(h.cal_min+1e-6,h.cal_max)),h.isTransparentBelowCalMin===void 0&&(h.isTransparentBelowCalMin=!0);const v=Vt.colormap(h.colormap,h.colormapInvert);if(h.isAdditiveBlend&&o++,this.blendColormap(s,l,h,h.cal_min,h.cal_max,v),h.useNegativeCmap){const m=Vt.colormap(h.colormapNegative,h.colormapInvert);let y=h.cal_min,b=h.cal_max;isFinite(h.cal_minNeg)&&isFinite(h.cal_minNeg)&&(y=-h.cal_minNeg,b=-h.cal_maxNeg),this.blendColormap(s,l,h,y,b,m,!0)}}if(o>0)for(let c=0;c<a;c++){let h=function(y,b){return Math.min(y*b*.00392156862745098,255)},d=c*28+24;this.f32PerVertex!==7&&(d=c*20+16);const v=c*4,m=Math.min(o,l[v+3]/255);m<=0||(s[d+0]=h(s[d+0],l[v+0]),s[d+1]=h(s[d+1],l[v+1]),s[d+2]=h(s[d+2],l[v+2]),s[d+0]=n(s[d+0],l[v+0],m),s[d+1]=n(s[d+1],l[v+1],m),s[d+2]=n(s[d+2],l[v+2],m))}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(u),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),this.indexCount=u.length,this.vertexCount=this.pts.length}reverseFaces(e){if(this.offsetPt0||this.hasConnectome)return;const n=this.tris||[];for(let i=0;i<n.length;i+=3){const a=n[i];n[i]=n[i+1],n[i+1]=a}this.updateMesh(e)}hierarchicalOrder(){const i=this.tris.length/3,a=Math.log(i/20)/Math.log(4);if(i!==Math.pow(4,a)*20)return NaN;if(this.pts.length/3!==Math.pow(4,a)*10+2)return NaN;for(let o=0;o<15;o+=3)if(this.tris[o]!==0)return NaN;for(let o=15;o<24;o+=3)if(this.tris[o]!==3)return NaN;for(let o=24;o<30;o+=3)if(this.tris[o]!==4)return NaN;return a}decimateFaces(e,n){let i=this.tris;const a=12,s=20;for(let o=e-1;o>=n;o--){const l=Math.pow(4,o+1)*(a-2)+2,u=Math.pow(4,o)*(a-2)+2,c=i.length/3,h=Math.pow(4,o)*s;console.log(`order ${o+1} -> ${o} vertices ${l} -> ${u} faces ${c} -> ${h}`);const d=Array.from({length:l},(m,y)=>y+1);for(let m=0;m<c;m++){const y=i[3*m],b=i[3*m+1],x=i[3*m+2];d[y-1]=Math.min(d[y-1],b,x)}const v=new Uint32Array(h*3);for(let m=0;m<h;m++)v[3*m]=d[i[3*m]-1],v[3*m+1]=d[i[3*m+1]-1],v[3*m+2]=d[i[3*m+2]-1];i=v}this.tris=new Uint32Array(i)}decimateHierarchicalMesh(e,n=4){const i=this.hierarchicalOrder();if(isNaN(i))return Q.warn("Unable to decimate mesh: it does not have a hierarchical structure"),!1;if(n>=i)return Q.warn(`Unable to decimate mesh: input order (${i}) must be larger than downsampled order (${n})`),!1;const a=this.pts.length/3,o=Math.pow(4,n)*(12-2)+2;if(this.pts=new Float32Array(this.pts.slice(0,o*3)),this.decimateFaces(i,n),this.layers&&this.layers.length>0)for(let l=0;l<this.layers.length;l++){const u=this.layers[l];u.values instanceof Float32Array||u.values.length!==a?u.values=new Float32Array(u.values.slice(0,o)):Q.warn("decimation logic needs to be updated")}return this.updateMesh(e),!0}async setLayerProperty(e,n,i,a){const s=this.layers[e];if(!s||!(n in s)){Q.warn("mesh does not have property ",n," for layer ",s);return}if(n==="colormapLabel")if(typeof i=="object")s[n]=Vt.makeLabelLut(i);else if(typeof i=="string"){const o=await Vt.makeLabelLutFromUrl(i);s[n]=o,this.updateMesh(a);return}else Q.error("colormapLabel requires a string or object");else s[n]=i;this.updateMesh(a)}setProperty(e,n,i){if(!(e in this)){console.warn("Mesh does not have property:",e,this);return}this[e]=n,this.updateMesh(i)}generatePosNormClr(e,n,i){(e.length<3||i.length<4)&&(Q.error("Catastrophic failure generatePosNormClr()"),Q.debug("this",this),Q.debug("pts",e),Q.debug("rgba",i));const a=ro.generateNormals(e,n),s=e.length/3,o=s===i.length/4,l=this.f32PerVertex,u=new Float32Array(s*l),c=new Uint8Array(u.buffer);let h=0,d=0,v=0,m=(l-1)*4;for(let y=0;y<s;y++)u[v+0]=e[h+0],u[v+1]=e[h+1],u[v+2]=e[h+2],l!==7?(c[m-4]=a[h+0]*127,c[m-3]=a[h+1]*127,c[m-2]=a[h+2]*127):(u[v+3]=a[h+0],u[v+4]=a[h+1],u[v+5]=a[h+2]),c[m]=i[d+0],c[m+1]=i[d+1],c[m+2]=i[d+2],c[m+3]=i[d+3],o&&(d+=4),h+=3,v+=l,m+=l*4;return u}static async readMesh(e,n,i,a=1,s=new Uint8Array([255,255,255,255]),o=!0){let l=new Uint32Array([]),u=new Float32Array([]),c="",h;const d=/(?:\.([^.]+))?$/;let v=d.exec(n)[1];if(v=v.toUpperCase(),v==="GZ"&&(v=d.exec(n.slice(0,-3))[1],v=v.toUpperCase()),v==="JCON"&&Q.error("you should never see this message: load using nvconnectome not nvmesh"),v==="JSON"&&Q.error("you should never see this message: load using nvconnectome not nvmesh"),s[3]=Math.max(1,s[3]),v==="TCK"||v==="TRK"||v==="TT"||v==="TRX"||v==="TRACT"){if(v==="TCK"?h=lr.readTCK(e):v==="TRACT"?h=lr.readTRACT(e):v==="TT"?h=await lr.readTT(e):v==="TRX"?h=await lr.readTRX(e):h=await lr.readTRK(e),typeof h>"u"){const x=new Float32Array([0,0,0,0,0,0]),A=new Uint32Array([0]);h={pts:x,offsetPt0:A},Q.error("Creating empty tracts")}return s[3]=0,new Oi(h.pts,h.offsetPt0,n,s,a,o,i,"inferno",h.dpg||null,h.dps||null,h.dpv||null)}if(v==="GII")h=await lr.readGII(e);else if(v==="MZ3")h=await lr.readMZ3(e),"positions"in h||Q.warn("MZ3 does not have positions (statistical overlay?)");else if(v==="ASC")h=lr.readASC(e);else if(v==="DFS")h=lr.readDFS(e);else if(v==="BYU"||v==="G")h=lr.readGEO(e);else if(v==="GEO")h=lr.readGEO(e,!0);else if(v==="ICO"||v==="TRI")h=lr.readICO(e);else if(v==="OFF")h=lr.readOFF(e);else if(v==="NV")h=lr.readNV(e);else if(v==="OBJ")h=await lr.readOBJ(e);else if(v==="PLY")h=lr.readPLY(e);else if(v==="WRL")h=lr.readWRL(e);else if(v==="X3D")h=lr.readX3D(e);else if(v==="FIB"||v==="VTK"){if(h=lr.readVTK(e),"offsetPt0"in h)return s[3]=0,new Oi(h.pts,h.offsetPt0,n,s,a,o,i,"inferno")}else v==="SRF"?h=await lr.readSRF(e):v==="STL"?h=lr.readSTL(e):h=lr.readFreeSurfer(e);if(h.anatomicalStructurePrimary&&(c=h.anatomicalStructurePrimary),h instanceof Float32Array)throw new Error("fatal: unknown mesh type loaded");if(!("positions"in h))throw new Error("positions not loaded");if(!h.indices)throw new Error("indices not loaded");if(u=h.positions,l=h.indices,"rgba255"in h&&h.rgba255.length>0&&(s=h.rgba255),"colors"in h&&h.colors&&h.colors.length===u.length){const x=u.length/3;s=new Uint8Array(x*4);let A=0,C=0;for(let E=0;E<x;E++)s[C++]=h.colors[A]*255,s[C++]=h.colors[A+1]*255,s[C++]=h.colors[A+2]*255,s[C++]=255,A+=3}const m=u.length/3;if(l.length/3<1||m<3)throw new Error("Mesh should have at least one triangle and three vertices");s[3]=Math.max(1,s[3]);const b=new Oi(u,l,n,s,a,o,i,null,null,null,null,!0,c);if("scalars"in h&&h.scalars.length>0){const x=await lr.readLayer(n,e,b,a,"gray");typeof x>"u"?Q.warn("readLayer() failed to convert scalars"):(b.layers.push(x),b.updateMesh(i))}return b}static async loadLayer(e,n){let i=new Uint8Array().buffer;function a(y){const b=window.atob(y),x=b.length,A=new Uint8Array(x);for(let C=0;C<x;C++)A[C]=b.charCodeAt(C);return A.buffer}if(e.base64!==void 0)i=a(e.base64);else{if(!e.url)throw new Error("layer: missing url");const y=await fetch(e.url,{headers:e.headers});if(!y.ok)throw Error(y.statusText);i=await y.arrayBuffer()}let s,o=[];if(e.name&&e.name!=="")s=e.name;else{if(!e.url)throw new Error("layer: missing url");try{o=new URL(e.url).pathname.split("/")}catch{o=e.url.split("/")}finally{s=o.slice(-1)[0]}}s.indexOf("?")>-1&&(s=s.slice(0,s.indexOf("?")));let l=.5;"opacity"in e&&(l=e.opacity);let u="warm";"colormap"in e&&(u=e.colormap);let c="winter";"colormapNegative"in e&&(c=e.colormapNegative);let h=!1;"useNegativeCmap"in e&&(h=e.useNegativeCmap);let d=null;"cal_min"in e&&(d=e.cal_min);let v=null;"cal_max"in e&&(v=e.cal_max);const m=await lr.readLayer(s,i,n,l,u,c,h,d,v);m&&n.layers.push(m)}static async loadFromUrl({url:e="",headers:n={},gl:i,name:a="",opacity:s=1,rgba255:o=[255,255,255,255],visible:l=!0,layers:u=[],buffer:c=new ArrayBuffer(0)}={}){let h=e.split("/");if(a===""){try{h=new URL(e).pathname.split("/")}catch{h=e.split("/")}a=h.slice(-1)[0],a.indexOf("?")>-1&&(a=a.slice(0,a.indexOf("?")))}if(e==="")throw Error("url must not be empty");if(!i)throw Error("gl context is null");let d;if(c.byteLength>0)d=c;else{const m=await fetch(e,{headers:n});if(!m.ok)throw Error(m.statusText);d=await m.arrayBuffer()}const v=await this.readMesh(d,a,i,s,new Uint8Array(o),l);if(!u||u.length<1)return v;for(let m=0;m<u.length;m++)await Oi.loadLayer(u[m],v);return v.updateMesh(i),v}static async readFileAsync(e){return new Promise((n,i)=>{const a=new FileReader;a.onload=()=>{n(a.result)},a.onerror=i,a.readAsArrayBuffer(e)})}static async loadFromFile({file:e,gl:n,name:i="",opacity:a=1,rgba255:s=[255,255,255,255],visible:o=!0,layers:l=[]}={}){if(!e)throw new Error("file must be set");if(!n)throw new Error("rendering context must be set");const u=await Oi.readFileAsync(e),c=await Oi.readMesh(u,i,n,a,new Uint8Array(s),o);if(!l||l.length<1)return c;for(let h=0;h<l.length;h++)await Oi.loadLayer(l[h],c);return c.updateMesh(n),c}async loadFromBase64({base64:e,gl:n,name:i="",opacity:a=1,rgba255:s=[255,255,255,255],visible:o=!0,layers:l=[]}={}){if(!e)throw new Error("base64 must bet set");if(!n)throw new Error("rendering context must be set");function u(d){const v=window.atob(d),m=v.length,y=new Uint8Array(m);for(let b=0;b<m;b++)y[b]=v.charCodeAt(b);return y.buffer}const c=u(e),h=await Oi.readMesh(c,i,n,a,new Uint8Array(s),o);if(!l||l.length<1)return h;for(let d=0;d<l.length;d++)await Oi.loadLayer(l[d],h);return h.updateMesh(n),h}},XG="data:image/jpeg;base64,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ZwAAAAAAAAALY3JvcFJlY3RUb3Bsb25nAAAAAAA4QklNA+0AAAAAABAASAAAAAEAAQBIAAAAAQABOEJJTQQmAAAAAAAOAAAAAAAAAAAAAD+AAAA4QklNBA0AAAAAAAQAAAAeOEJJTQQZAAAAAAAEAAAAHjhCSU0D8wAAAAAACQAAAAAAAAAAAQA4QklNJxAAAAAAAAoAAQAAAAAAAAABOEJJTQP1AAAAAABIAC9mZgABAGxmZgAGAAAAAAABAC9mZgABAKGZmgAGAAAAAAABADIAAAABAFoAAAAGAAAAAAABADUAAAABAC0AAAAGAAAAAAABOEJJTQP4AAAAAABwAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAADhCSU0EAAAAAAAAAgAAOEJJTQQCAAAAAAACAAA4QklNBDAAAAAAAAEBADhCSU0ELQAAAAAABgABAAAAMjhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAAM9AAAABgAAAAAAAAAAAAACAAAAAgAAAAAEAG0AYwA2ADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAAIAAAAAAFJnaHRsb25nAAACAAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElEbG9uZwAAAAAAAAAGb3JpZ2luZW51bQAAAAxFU2xpY2VPcmlnaW4AAAANYXV0b0dlbmVyYXRlZAAAAABUeXBlZW51bQAAAApFU2xpY2VUeXBlAAAAAEltZyAAAAAGYm91bmRzT2JqYwAAAAEAAAAAAABSY3QxAAAABAAA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bnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDctMTJUMjA6MDc6NDcrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0OGNjMGI3YS1iYTJkLWZmNDAtYmNkNC1jNGQzMzIyZjBiNzQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphYzFjM2NhNS1hYTg4LWI5NGMtOGE4MS05YmU4MjA3ZGZiODciPiA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8cmRmOkJhZz4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6YThjMGNhZTYtODNjYy1hYzQ4LWI2YzAtN2FiODNlOWJkMGM3PC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YWMxYzNjYTUtYWE4OC1iOTRjLThhODEtOWJlODIwN2RmYjg3IiBzdEV2dDp3aGVuPSIyMDE4LTA3LTEyVDIwOjA3OjQ3KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjYmI3MzZlZC0zOTRhLTM2NDgtYThiOC02Mzk1MmY0NDcxMjIiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTY6MTM6NTgrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RFdnQ6d2hlbj0iMjAxOC0wNy0xM1QxNzo1NDoyNyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvanBlZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9qcGVnIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTc6NTQ6MjcrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjg3NjM1NDk5LWZiMTItYWU0MC04NWEzLThkMWFiN2NkZGVhOSIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmFjMWMzY2E1LWFhODgtYjk0Yy04YTgxLTliZTgyMDdkZmI4NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAAAVAAAAAzZGVzYwAAAYQAAABsd3RwdAAAAfAAAAAUYmtwdAAAAgQAAAAUclhZWgAAAhgAAAAUZ1hZWgAAAiwAAAAUYlhZWgAAAkAAAAAUZG1uZAAAAlQAAABwZG1kZAAAAsQAAACIdnVlZAAAA0wAAACGdmlldwAAA9QAAAAkbHVtaQAAA/gAAAAUbWVhcwAABAwAAAAkdGVjaAAABDAAAAAMclRSQwAABDwAAAgMZ1RSQwAABDwAAAgMYlRSQwAABDwAAAgMdGV4dAAAAABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1Q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",xC="data:image/png;base64,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",bC={atlas:{type:"msdf",distanceRange:2,size:59.65625,width:512,height:256,yOrigin:"bottom"},metrics:{emSize:1,lineHeight:1.171875,ascender:.927734375,descender:-.244140625,underlineY:-.09765625,underlineThickness:.048828125},glyphs:[{unicode:32,advance:.24755859375},{unicode:33,advance:.25732421875,planeBounds:{left:.056159633438645884,bottom:-.02437761405677056,right:.20702396031135412,top:.7299440203067705},atlasBounds:{left:488.5,bottom:145.5,right:497.5,top:190.5}},{unicode:34,advance:.31982421875,planeBounds:{left:.049409125974004715,bottom:.48691155587022,right:.2840869677759953,top:.77187750662978},atlasBounds:{left:486.5,bottom:213.5,right:500.5,top:230.5}},{unicode:35,advance:.61572265625,planeBounds:{left:.037219103997511785,bottom:-.02169206718177056,right:.6239137085024882,top:.7326295671817705},atlasBounds:{left:66.5,bottom:51.5,right:101.5,top:96.5}},{unicode:36,advance:.5615234375,planeBounds:{left:.02956531458715296,bottom:-.12381369908983761,right:.5324464041628472,top:.8484230740898377},atlasBounds:{left:109.5,bottom:197.5,right:139.5,top:255.5}},{unicode:37,advance:.732421875,planeBounds:{left:.026481776289942378,bottom:-.030073418674698794,right:.7137525987100576,top:.7410109186746989},atlasBounds:{left:88.5,bottom:144.5,right:129.5,top:190.5}},{unicode:38,advance:.62158203125,planeBounds:{left:.03225572125458355,bottom:-.030073418674698794,right:.6357130287454166,top:.7410109186746989},atlasBounds:{left:130.5,bottom:144.5,right:166.5,top:190.5}},{unicode:39,advance:.17431640625,planeBounds:{left:.028244602049502358,bottom:.49895501673814824,right:.14558352295049765,top:.7671582645118518},atlasBounds:{left:498.5,bottom:62.5,right:505.5,top:78.5}},{unicode:40,advance:.341796875,planeBounds:{left:.042983329377291775,bottom:-.250029542422407,right:.34471198312270823,top:.8227834486724072},atlasBounds:{left:.5,bottom:191.5,right:18.5,top:255.5}},{unicode:41,advance:.34765625,planeBounds:{left:-.003159248747708225,bottom:-.250029542422407,right:.29856940499770823,top:.8227834486724072},atlasBounds:{left:19.5,bottom:191.5,right:37.5,top:255.5}},{unicode:42,advance:.4306640625,planeBounds:{left:-.011208599684062338,bottom:.27785390031593765,right:.44138438093406235,top:.7304468809340623},atlasBounds:{left:449.5,bottom:23.5,right:476.5,top:50.5}},{unicode:43,advance:.56689453125,planeBounds:{left:.01353503347629649,bottom:.053493525733368255,right:.5499415290237036,top:.6066627242666317},atlasBounds:{left:361.5,bottom:17.5,right:393.5,top:50.5}},{unicode:44,advance:.1962890625,planeBounds:{left:-.009919475797210583,bottom:-.15981695975478,right:.1744702570472106,top:.12514899100478},atlasBounds:{left:498.5,bottom:79.5,right:509.5,top:96.5}},{unicode:45,advance:.27587890625,planeBounds:{left:-.00527594412977999,bottom:.24333249267450235,right:.27969000662978,top:.36067141357549765},atlasBounds:{left:52.5,bottom:7.5,right:69.5,top:14.5}},{unicode:46,advance:.26318359375,planeBounds:{left:.051032680313645884,bottom:-.027092319686354116,right:.20189700718635412,top:.12377200718635412},atlasBounds:{left:501.5,bottom:221.5,right:510.5,top:230.5}},{unicode:47,advance:.412109375,planeBounds:{left:-.013733006073205867,bottom:-.08573505127848349,right:.4053345685732059,top:.7356373950284835},atlasBounds:{left:252.5,bottom:206.5,right:277.5,top:255.5}},{unicode:48,advance:.5615234375,planeBounds:{left:.037458384830081196,bottom:-.030073418674698794,right:.5235767714199189,top:.7410109186746989},atlasBounds:{left:167.5,bottom:144.5,right:196.5,top:190.5}},{unicode:49,advance:.5615234375,planeBounds:{left:.06023674350936354,bottom:-.01998308280677056,right:.37872810024063647,top:.7343385515567705},atlasBounds:{left:488.5,bottom:97.5,right:507.5,top:142.5}},{unicode:50,advance:.5615234375,planeBounds:{left:.025334353719224725,bottom:-.01680925468177056,right:.5449781462807752,top:.7375123796817705},atlasBounds:{left:278.5,bottom:51.5,right:309.5,top:96.5}},{unicode:51,advance:.5615234375,planeBounds:{left:.028181041080081196,bottom:-.030073418674698794,right:.5142994276699189,top:.7410109186746989},atlasBounds:{left:197.5,bottom:144.5,right:226.5,top:190.5}},{unicode:52,advance:.5615234375,planeBounds:{left:.005886103858368255,bottom:-.02169206718177056,right:.5590553023916317,top:.7326295671817705},atlasBounds:{left:310.5,bottom:51.5,right:343.5,top:96.5}},{unicode:53,advance:.5615234375,planeBounds:{left:.055524791080081196,bottom:-.02657487968177056,right:.5416431776699189,top:.7277467546817705},atlasBounds:{left:344.5,bottom:51.5,right:373.5,top:96.5}},{unicode:54,advance:.5615234375,planeBounds:{left:.046003306705081196,bottom:-.034712090549698794,right:.5321216932949189,top:.7363722467996989},atlasBounds:{left:227.5,bottom:144.5,right:256.5,top:190.5}},{unicode:55,advance:.5615234375,planeBounds:{left:.018010134969224725,bottom:-.02169206718177056,right:.5376539275307752,top:.7326295671817705},atlasBounds:{left:374.5,bottom:51.5,right:405.5,top:96.5}},{unicode:56,advance:.5615234375,planeBounds:{left:.037702525455081196,bottom:-.030073418674698794,right:.5238209120449189,top:.7410109186746989},atlasBounds:{left:257.5,bottom:144.5,right:286.5,top:190.5}},{unicode:57,advance:.5615234375,planeBounds:{left:.029401744205081196,bottom:-.025434746799698794,right:.5155201307949189,top:.7456495905496989},atlasBounds:{left:287.5,bottom:144.5,right:316.5,top:190.5}},{unicode:58,advance:.2421875,planeBounds:{left:.046394008438645884,bottom:-.029431286627488215,right:.19725833531135412,top:.5572633178774882},atlasBounds:{left:439.5,bottom:61.5,right:448.5,top:96.5}},{unicode:59,advance:.21142578125,planeBounds:{left:.001066852327789419,bottom:-.16459733294591408,right:.1854565851722106,top:.556198895445914},atlasBounds:{left:406.5,bottom:53.5,right:417.5,top:96.5}},{unicode:60,advance:.50830078125,planeBounds:{left:.016948142433865897,bottom:.0726146348300812,right:.4527784200661341,top:.5587330214199189},atlasBounds:{left:394.5,bottom:21.5,right:420.5,top:50.5}},{unicode:61,advance:.548828125,planeBounds:{left:.051535540940937666,bottom:.17620354038436353,right:.5041285215590624,top:.49469489711563647},atlasBounds:{left:477.5,bottom:31.5,right:504.5,top:50.5}},{unicode:62,advance:.5224609375,planeBounds:{left:.047629290940937666,bottom:.0731029160800812,right:.5002222715590624,top:.5592213026699189},atlasBounds:{left:421.5,bottom:21.5,right:448.5,top:50.5}},{unicode:63,advance:.47216796875,planeBounds:{left:.016704001808865897,bottom:-.027876153049698794,right:.4525342794411341,top:.7432081842996989},atlasBounds:{left:317.5,bottom:144.5,right:343.5,top:190.5}},{unicode:64,advance:.89794921875,planeBounds:{left:.034064457306783605,bottom:-.23896750384690937,right:.8721996065996072,top:.7165065663469093},atlasBounds:{left:155.5,bottom:198.5,right:205.5,top:255.5}},{unicode:65,advance:.65234375,planeBounds:{left:-.008838044092129387,bottom:-.02169206718177056,right:.6616700753421295,top:.7326295671817705},atlasBounds:{left:237.5,bottom:51.5,right:277.5,top:96.5}},{unicode:66,advance:.62255859375,planeBounds:{left:.06464099434422473,bottom:-.02169206718177056,right:.5842847869057752,top:.7326295671817705},atlasBounds:{left:205.5,bottom:51.5,right:236.5,top:96.5}},{unicode:67,advance:.65087890625,planeBounds:{left:.038439807122511785,bottom:-.030073418674698794,right:.6251344116274882,top:.7410109186746989},atlasBounds:{left:344.5,bottom:144.5,right:379.5,top:190.5}},{unicode:68,advance:.65576171875,planeBounds:{left:.06301501010836826,bottom:-.02169206718177056,right:.6161842086416317,top:.7326295671817705},atlasBounds:{left:162.5,bottom:51.5,right:195.5,top:96.5}},{unicode:69,advance:.568359375,planeBounds:{left:.0652904160800812,bottom:-.02169206718177056,right:.5514088026699189,top:.7326295671817705},atlasBounds:{left:132.5,bottom:51.5,right:161.5,top:96.5}},{unicode:70,advance:.552734375,planeBounds:{left:.059675181705081196,bottom:-.02169206718177056,right:.5457935682949189,top:.7326295671817705},atlasBounds:{left:102.5,bottom:51.5,right:131.5,top:96.5}},{unicode:71,advance:.68115234375,planeBounds:{left:.040148791497511785,bottom:-.030073418674698794,right:.6268433960024882,top:.7410109186746989},atlasBounds:{left:380.5,bottom:144.5,right:415.5,top:190.5}},{unicode:72,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:30.5,bottom:51.5,right:65.5,top:96.5}},{unicode:73,advance:.27197265625,planeBounds:{left:.06917965680657412,bottom:-.02169206718177056,right:.20328128069342588,top:.7326295671817705},atlasBounds:{left:196.5,bottom:51.5,right:204.5,top:96.5}},{unicode:74,advance:.5517578125,planeBounds:{left:.007184947330081194,bottom:-.02657487968177056,right:.4933033339199188,top:.7277467546817705},atlasBounds:{left:.5,bottom:51.5,right:29.5,top:96.5}},{unicode:75,advance:.626953125,planeBounds:{left:.061633166497511785,bottom:-.02169206718177056,right:.6483277710024882,top:.7326295671817705},atlasBounds:{left:452.5,bottom:97.5,right:487.5,top:142.5}},{unicode:76,advance:.5380859375,planeBounds:{left:.06341786132300943,bottom:-.02169206718177056,right:.5327735449269906,top:.7326295671817705},atlasBounds:{left:423.5,bottom:97.5,right:451.5,top:142.5}},{unicode:77,advance:.873046875,planeBounds:{left:.05911847969322944,bottom:-.02169206718177056,right:.8134401140567705,top:.7326295671817705},atlasBounds:{left:377.5,bottom:97.5,right:422.5,top:142.5}},{unicode:78,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:341.5,bottom:97.5,right:376.5,top:142.5}},{unicode:79,advance:.6875,planeBounds:{left:.033395854136655315,bottom:-.030073418674698794,right:.6536158646133446,top:.7410109186746989},atlasBounds:{left:416.5,bottom:144.5,right:453.5,top:190.5}},{unicode:80,advance:.630859375,planeBounds:{left:.061550166358368255,bottom:-.02169206718177056,right:.6147193648916317,top:.7326295671817705},atlasBounds:{left:273.5,bottom:97.5,right:306.5,top:142.5}},{unicode:81,advance:.6875,planeBounds:{left:.030466166636655315,bottom:-.14391866037519643,right:.6506861771133446,top:.7445045978751964},atlasBounds:{left:214.5,bottom:202.5,right:251.5,top:255.5}},{unicode:82,advance:.61572265625,planeBounds:{left:.06350329135836826,bottom:-.02169206718177056,right:.6166724898916317,top:.7326295671817705},atlasBounds:{left:186.5,bottom:97.5,right:219.5,top:142.5}},{unicode:83,advance:.59326171875,planeBounds:{left:.020778681983368255,bottom:-.030073418674698794,right:.5739478805166317,top:.7410109186746989},atlasBounds:{left:454.5,bottom:144.5,right:487.5,top:190.5}},{unicode:84,advance:.5966796875,planeBounds:{left:.005480822747511787,bottom:-.02169206718177056,right:.5921754272524882,top:.7326295671817705},atlasBounds:{left:112.5,bottom:97.5,right:147.5,top:142.5}},{unicode:85,advance:.6484375,planeBounds:{left:.049098994483368255,bottom:-.02657487968177056,right:.6022681930166317,top:.7277467546817705},atlasBounds:{left:78.5,bottom:97.5,right:111.5,top:142.5}},{unicode:86,advance:.63623046875,planeBounds:{left:-.008269192599201152,bottom:-.02169206718177056,right:.6454762238492011,top:.7326295671817705},atlasBounds:{left:38.5,bottom:97.5,right:77.5,top:142.5}},{unicode:87,advance:.88720703125,planeBounds:{left:.011923628617731797,bottom:-.02169206718177056,right:.8835841838822683,top:.7326295671817705},atlasBounds:{left:220.5,bottom:97.5,right:272.5,top:142.5}},{unicode:88,advance:.626953125,planeBounds:{left:.004098979136655316,bottom:-.02169206718177056,right:.6243189896133446,top:.7326295671817705},atlasBounds:{left:.5,bottom:97.5,right:37.5,top:142.5}},{unicode:89,advance:.6005859375,planeBounds:{left:-.010793598988344685,bottom:-.02169206718177056,right:.6094264114883446,top:.7326295671817705},atlasBounds:{left:148.5,bottom:97.5,right:185.5,top:142.5}},{unicode:90,advance:.5986328125,planeBounds:{left:.024196650733368255,bottom:-.02169206718177056,right:.5773658492666317,top:.7326295671817705},atlasBounds:{left:307.5,bottom:97.5,right:340.5,top:142.5}},{unicode:91,advance:.26513671875,planeBounds:{left:.05437250871693295,bottom:-.17280296457569408,right:.27228764753306706,top:.8329592145756942},atlasBounds:{left:59.5,bottom:195.5,right:72.5,top:255.5}},{unicode:92,advance:.41015625,planeBounds:{left:.0014037126767941326,bottom:-.08573505127848349,right:.4204712873232059,top:.7356373950284835},atlasBounds:{left:278.5,bottom:206.5,right:303.5,top:255.5}},{unicode:93,advance:.26513671875,planeBounds:{left:-.020659233400995285,bottom:-.17280296457569408,right:.2140186084009953,top:.8329592145756942},atlasBounds:{left:94.5,bottom:195.5,right:108.5,top:255.5}},{unicode:94,advance:.41796875,planeBounds:{left:.006855376669722368,bottom:.33229482979472236,right:.40916024833027764,top:.7345997014552776},atlasBounds:{left:486.5,bottom:231.5,right:510.5,top:255.5}},{unicode:95,advance:.451171875,planeBounds:{left:-.017473255794918804,bottom:-.09553469482549765,right:.4686451307949188,top:.021804226075497646},atlasBounds:{left:70.5,bottom:7.5,right:99.5,top:14.5}},{unicode:96,advance:.30908203125,planeBounds:{left:.00391839948107648,bottom:.5860277898277895,right:.2553589442689235,top:.7704175226722105},atlasBounds:{left:36.5,bottom:3.5,right:51.5,top:14.5}},{unicode:97,advance:.5439453125,planeBounds:{left:.028181041080081196,bottom:-.029187146002488215,right:.5142994276699189,top:.5575074585024882},atlasBounds:{left:30.5,bottom:15.5,right:59.5,top:50.5}},{unicode:98,advance:.56103515625,planeBounds:{left:.048932994205081196,bottom:-.032187684160555265,right:.5350513807949189,top:.7724220591605554},atlasBounds:{left:304.5,bottom:207.5,right:333.5,top:255.5}},{unicode:99,advance:.5234375,planeBounds:{left:.024518931705081196,bottom:-.029187146002488215,right:.5106373182949189,top:.5575074585024882},atlasBounds:{left:.5,bottom:15.5,right:29.5,top:50.5}},{unicode:100,advance:.56396484375,planeBounds:{left:.026227916080081196,bottom:-.032187684160555265,right:.5123463026699189,top:.7724220591605554},atlasBounds:{left:334.5,bottom:207.5,right:363.5,top:255.5}},{unicode:101,advance:.52978515625,planeBounds:{left:.026472056705081196,bottom:-.029187146002488215,right:.5125904432949189,top:.5575074585024882},atlasBounds:{left:468.5,bottom:61.5,right:497.5,top:96.5}},{unicode:102,advance:.34716796875,planeBounds:{left:.004575110905578838,bottom:-.022177918535555265,right:.3733545765944212,top:.7824318247855554},atlasBounds:{left:364.5,bottom:207.5,right:386.5,top:255.5}},{unicode:103,advance:.56103515625,planeBounds:{left:.026960337955081196,bottom:-.22888445766762702,right:.5130787245449189,top:.558962582667627},atlasBounds:{left:28.5,bottom:143.5,right:57.5,top:190.5}},{unicode:104,advance:.55078125,planeBounds:{left:.049826556565937666,bottom:-.01892352016762703,right:.5024195371840624,top:.768923520167627},atlasBounds:{left:.5,bottom:143.5,right:27.5,top:190.5}},{unicode:105,advance:.24267578125,planeBounds:{left:.046882289688645884,bottom:-.01680925468177056,right:.19774661656135412,top:.7375123796817705},atlasBounds:{left:498.5,bottom:145.5,right:507.5,top:190.5}},{unicode:106,advance:.23876953125,planeBounds:{left:-.048979545900995285,bottom:-.2324562772148376,right:.1856982959009953,top:.7397804959648377},atlasBounds:{left:140.5,bottom:197.5,right:154.5,top:255.5}},{unicode:107,advance:.5068359375,planeBounds:{left:.044294322330081196,bottom:-.01892352016762703,right:.5304127089199189,top:.768923520167627},atlasBounds:{left:58.5,bottom:143.5,right:87.5,top:190.5}},{unicode:108,advance:.24267578125,planeBounds:{left:.05428707868157412,bottom:-.01892352016762703,right:.18838870256842588,top:.768923520167627},atlasBounds:{left:477.5,bottom:208.5,right:485.5,top:255.5}},{unicode:109,advance:.87646484375,planeBounds:{left:.04430890170737297,bottom:-.024304333502488215,right:.832155942042627,top:.5623902710024882},atlasBounds:{left:116.5,bottom:15.5,right:163.5,top:50.5}},{unicode:110,advance:.5517578125,planeBounds:{left:.049826556565937666,bottom:-.024304333502488215,right:.5024195371840624,top:.5623902710024882},atlasBounds:{left:60.5,bottom:15.5,right:87.5,top:50.5}},{unicode:111,advance:.5703125,planeBounds:{left:.025090213094224725,bottom:-.029187146002488215,right:.5447340056557752,top:.5575074585024882},atlasBounds:{left:193.5,bottom:15.5,right:224.5,top:50.5}},{unicode:112,advance:.56103515625,planeBounds:{left:.048444712955081196,bottom:-.22644305141762702,right:.5345630995449189,top:.561403988917627},atlasBounds:{left:447.5,bottom:208.5,right:476.5,top:255.5}},{unicode:113,advance:.568359375,planeBounds:{left:.025983775455081196,bottom:-.22644305141762702,right:.5121021620449189,top:.561403988917627},atlasBounds:{left:417.5,bottom:208.5,right:446.5,top:255.5}},{unicode:114,advance:.33837890625,planeBounds:{left:.045180595002291775,bottom:-.024304333502488215,right:.34690924874770823,top:.5623902710024882},atlasBounds:{left:449.5,bottom:61.5,right:467.5,top:96.5}},{unicode:115,advance:.515625,planeBounds:{left:.021669814448009427,bottom:-.029187146002488215,right:.4910254980519906,top:.5575074585024882},atlasBounds:{left:164.5,bottom:15.5,right:192.5,top:50.5}},{unicode:116,advance:.32666015625,planeBounds:{left:-.019433670483564695,bottom:-.02877457520298586,right:.3158203892335647,top:.675258950202986},atlasBounds:{left:418.5,bottom:54.5,right:438.5,top:96.5}},{unicode:117,advance:.55126953125,planeBounds:{left:.048117572190937666,bottom:-.034069958502488215,right:.5007105528090624,top:.5526246460024882},atlasBounds:{left:88.5,bottom:15.5,right:115.5,top:50.5}},{unicode:118,advance:.484375,planeBounds:{left:-.002092396419918806,bottom:-.02080579450955998,right:.4840259901699188,top:.5491261070095601},atlasBounds:{left:331.5,bottom:16.5,right:360.5,top:50.5}},{unicode:119,advance:.75146484375,planeBounds:{left:-.002649098431770561,bottom:-.02080579450955998,right:.7516725359317705,top:.5491261070095601},atlasBounds:{left:225.5,bottom:16.5,right:270.5,top:50.5}},{unicode:120,advance:.49560546875,planeBounds:{left:-.0046143729128470395,bottom:-.02080579450955998,right:.4982667166628471,top:.5491261070095601},atlasBounds:{left:300.5,bottom:16.5,right:330.5,top:50.5}},{unicode:121,advance:.47314453125,planeBounds:{left:-.007219349544918806,bottom:-.23645281704262702,right:.4788990370449188,top:.551394223292627},atlasBounds:{left:387.5,bottom:208.5,right:416.5,top:255.5}},{unicode:122,advance:.49560546875,planeBounds:{left:.018007705073009427,bottom:-.02080579450955998,right:.4873633886769906,top:.5491261070095601},atlasBounds:{left:271.5,bottom:16.5,right:299.5,top:50.5}},{unicode:123,advance:.33837890625,planeBounds:{left:.011572188891435306,bottom:-.20234398020069408,right:.3468262486085647,top:.8034181989506942},atlasBounds:{left:73.5,bottom:195.5,right:93.5,top:255.5}},{unicode:124,advance:.24365234375,planeBounds:{left:.06315671142450235,bottom:-.15466084787519643,right:.18049563232549765,top:.7337624103751964},atlasBounds:{left:206.5,bottom:202.5,right:213.5,top:255.5}},{unicode:125,advance:.33837890625,planeBounds:{left:-.010156326733564695,bottom:-.20234398020069408,right:.3250977329835647,top:.8034181989506942},atlasBounds:{left:38.5,bottom:195.5,right:58.5,top:255.5}},{unicode:126,advance:.68017578125,planeBounds:{left:.046984728997511785,bottom:.1766063915990047,right:.6336793335024882,top:.4112842334009953},atlasBounds:{left:.5,bottom:.5,right:35.5,top:14.5}}],kerning:[]},od={name:"untitled connectome",nodeColormap:"warm",nodeColormapNegative:"winter",nodeMinColor:0,nodeMaxColor:4,nodeScale:3,edgeColormap:"warm",edgeColormapNegative:"winter",edgeMin:2,edgeMax:6,edgeScale:1,legendLineThickness:0,showLegend:!0},ld=class ST extends Sl{constructor(e,n){super(new Float32Array([]),new Uint32Array([]),n.name,new Uint8Array([]),1,!0,e,n),j(this,"gl"),j(this,"nodesChanged"),this.gl=e,this.type="connectome",this.nodes&&this.updateLabels(),this.nodesChanged=new EventTarget}static convertLegacyConnectome(e){const n={nodes:[],edges:[],...od};for(const a in e)if(a in od){const s=a;n[s]=e[s]}const i=e.nodes;for(let a=0;a<i.names.length;a++)n.nodes.push({name:i.names[a],x:i.X[a],y:i.Y[a],z:i.Z[a],colorValue:i.Color[a],sizeValue:i.Size[a]});for(let a=0;a<i.names.length-1;a++)for(let s=a+1;s<i.names.length;s++){const o=e.edges[a*i.names.length+s];n.edges.push({first:a,second:s,colorValue:o})}return n}static convertFreeSurferConnectome(e,n="warm"){let i=!0;if("data_type"in e?e.data_type!=="fs_pointset"&&(i=!1):i=!1,"points"in e||(i=!1),!i)throw Error("not a valid FreeSurfer json pointset");const a=e.points.map(o=>({name:Array.isArray(o.comments)&&o.comments.length>0&&"text"in o.comments[0]?o.comments[0].text:"",x:o.coordinates.x,y:o.coordinates.y,z:o.coordinates.z,colorValue:1,sizeValue:1,metadata:o.comments}));return{...od,nodeColormap:n,edgeColormap:n,nodes:a,edges:[]}}updateLabels(){const e=this.nodes;if(e&&e.length>0){const n=e.reduce((c,h)=>c.sizeValue>h.sizeValue?c:h).sizeValue;let i,a;if(typeof this.nodeMinColor<"u"&&isFinite(this.nodeMinColor))i=this.nodeMinColor;else{i=e[0].colorValue;for(let c=1;c<e.length;c++)e[c].colorValue<i&&(i=e[c].colorValue)}if(typeof this.nodeMaxColor<"u"&&isFinite(this.nodeMaxColor))a=this.nodeMaxColor;else{a=e[0].colorValue;for(let c=1;c<e.length;c++)e[c].colorValue>a&&(a=e[c].colorValue)}const s=Vt.colormap(this.nodeColormap,this.colormapInvert),o=Vt.colormap(this.nodeColormapNegative,this.colormapInvert),l="nodeColormapNegative"in this;let u=this.legendLineThickness?this.legendLineThickness:0;this.showLegend===!1&&(u=0);for(let c=0;c<e.length;c++){let h=e[c].colorValue,d=!1;if(l&&h<0&&(d=!0,h=-h),i<a){if(h<i){Q.warn("color value lower than min");continue}h=(h-i)/(a-i)}else h=1;h=Math.round(Math.max(Math.min(255,h*255)))*4;let v=[s[h],s[h+1],s[h+2],255];d&&(v=[o[h],o[h+1],o[h+2],255]),v=v.map(m=>m/255),Q.debug("adding label for ",e[c]),e[c].label=new yy(e[c].name,{textColor:v,bulletScale:e[c].sizeValue/n,bulletColor:v,lineWidth:u,lineColor:v,textScale:1,textAlignment:"left",lineTerminator:"none"},[e[c].x,e[c].y,e[c].z]),Q.debug("label for node:",e[c].label)}}}addConnectomeNode(e){if(Q.debug("adding node",e),!this.nodes)throw new Error("nodes not defined");this.nodes.push(e),this.updateLabels(),this.nodesChanged.dispatchEvent(new CustomEvent("nodeAdded",{detail:{node:e}}))}deleteConnectomeNode(e){const n=this.nodes.indexOf(e),i=this.edges;i&&(this.edges=i.filter(a=>a.first!==n&&a.second!==n)),this.nodes=this.nodes.filter(a=>a!==e),this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeDeleted",{detail:{node:e}}))}updateConnectomeNodeByIndex(e,n){this.nodes[e]=n,this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeChanged",{detail:{node:n}}))}updateConnectomeNodeByPoint(e,n){const i=this.nodes;if(!i)throw new Error("Node to update does not exist");const a=i.find(o=>Oe.arraysAreEqual([o.x,o.y,o.z],e));if(!a)throw new Error(`Node with point ${e} to update does not exist`);const s=i.findIndex(o=>o===a);this.updateConnectomeNodeByIndex(s,n)}addConnectomeEdge(e,n,i){const a=this.edges;let s=a.find(o=>(o.first===e||o.second===e)&&o.first+o.second===e+n);return s||(s={first:e,second:n,colorValue:i},a.push(s),this.updateConnectome(this.gl),s)}deleteConnectomeEdge(e,n){const i=this.edges,a=i.find(s=>(s.first===e||s.first===n)&&s.first+s.second===e+n);if(a)this.edges=i.filter(s=>s!==a);else throw new Error(`edge between ${e} and ${n} not found`);return this.updateConnectome(this.gl),a}findClosestConnectomeNode(e,n){const i=this.nodes;if(!i||i.length===0)return null;const a=i.map((s,o)=>({node:s,distance:Math.sqrt(Math.pow(s.x-e[0],2)+Math.pow(s.y-e[1],2)+Math.pow(s.z-e[2],2)),index:o})).filter(s=>s.distance<n).sort((s,o)=>s.distance-o.distance);return a.length>0?a[0].node:null}updateConnectome(e){const n=[],i=[],a=[];let s=Vt.colormap(this.nodeColormap,this.colormapInvert),o=Vt.colormap(this.nodeColormapNegative,this.colormapInvert),l="nodeColormapNegative"in this;this.nodeMinColor===void 0&&(this.nodeMinColor=NaN),this.nodeMaxColor===void 0&&(this.nodeMaxColor=NaN),this.edgeMin===void 0&&(this.edgeMin=NaN),this.edgeMax===void 0&&(this.edgeMax=NaN);let u=this.nodeMinColor,c=this.nodeMaxColor;if(!isFinite(u)||!isFinite(u)){const A=this.nodes;u=A[0].colorValue,c=A[0].colorValue;for(let C=0;C<A.length;C++)u=Math.min(u,A[C].colorValue),c=Math.max(c,A[C].colorValue)}const h=this.nodes,d=h.length;for(let A=0;A<d;A++){const C=h[A].sizeValue*this.nodeScale;if(C<=0)continue;let E=h[A].colorValue,S=!1;if(l&&E<0&&(S=!0,E=-E),u<c){if(E<u)continue;E=(E-u)/(c-u)}else E=1;E=Math.round(Math.max(Math.min(255,E*255)))*4;let T=[s[E],s[E+1],s[E+2],255];S&&(T=[o[E],o[E+1],o[E+2],255]);const R=Me(h[A].x,h[A].y,h[A].z);Ao.makeColoredSphere(i,n,a,C,R,T)}s=Vt.colormap(this.edgeColormap,this.colormapInvert),o=Vt.colormap(this.edgeColormapNegative,this.colormapInvert),l="edgeColormapNegative"in this;const v=this.edges;if(v!==void 0&&v.length>0){if(u=this.edgeMin,c=this.edgeMax,!isFinite(u)||!isFinite(u)){u=v[0].colorValue,c=v[0].colorValue;for(let A=0;A<v.length;A++)u=Math.min(u,v[A].colorValue),c=Math.max(c,v[A].colorValue)}for(const A of v){let C=A.colorValue;const E=l&&C<0;E&&(C=-C);const S=C*this.edgeScale;if(S<=0)continue;if(u<c){if(C<u)continue;C=(C-u)/(c-u)}else C=1;C=Math.round(Math.max(Math.min(255,C*255)))*4;let T=[s[C],s[C+1],s[C+2],255];E&&(T=[o[C],o[C+1],o[C+2],255]);const R=Me(h[A.first].x,h[A.first].y,h[A.first].z),D=Me(h[A.second].x,h[A.second].y,h[A.second].z);Ao.makeColoredCylinder(i,n,a,R,D,S,T)}}const m=new Float32Array(i),y=new Uint32Array(n),b=ro.getExtents(m);this.furthestVertexFromOrigin=b.mxDx,this.extentsMin=b.extentsMin,this.extentsMax=b.extentsMax;const x=this.generatePosNormClr(m,y,new Uint8Array(a));e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(y),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Float32Array.from(x),e.STATIC_DRAW),this.indexCount=n.length}updateMesh(e){this.updateConnectome(e),this.updateLabels()}json(){const e={};for(const n in this)(n in od||n==="nodes"||n==="edges")&&(e[n]=this[n]);return e}static async loadConnectomeFromUrl(e,n){const a=await(await fetch(n)).json();return new ST(e,a)}};function QG(r,e,n){if(!r.dimsRAS||!r.matRAS||!r.pixDimsRAS||!r.vox2mm)throw new Error("Cannot create NiivueObject3D: Missing required RAS properties or vox2mm access on NVImage.");const i=r.dimsRAS,a=r.matRAS,s=r.pixDimsRAS,o=-.5,l=-.5,u=-.5,c=i[1]-1+.5,h=i[2]-1+.5,d=i[3]-1+.5,v=r.vox2mm,m=v.call(r,[o,l,u],a),y=v.call(r,[o,h,u],a),b=v.call(r,[o,l,d],a),x=v.call(r,[o,h,d],a),A=v.call(r,[c,l,u],a),C=v.call(r,[c,h,u],a),E=v.call(r,[c,l,d],a),S=v.call(r,[c,h,d],a),T=[...b,0,0,1,...E,1,0,1,...S,1,1,1,...x,0,1,1,...m,0,0,0,...y,0,1,0,...C,1,1,0,...A,1,0,0],R=n.createBuffer();if(!R)throw new Error("Failed to create GL index buffer");n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,R);const D=[0,3,2,2,1,0,4,7,6,6,5,4,5,6,2,2,3,5,4,0,1,1,7,4,7,1,2,2,6,7,4,5,3,3,0,4];n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(D),n.STATIC_DRAW);const B=n.createBuffer();if(!B)throw new Error("Failed to create GL vertex buffer");n.bindBuffer(n.ARRAY_BUFFER,B),n.bufferData(n.ARRAY_BUFFER,new Float32Array(T),n.STATIC_DRAW);const N=n.createVertexArray();if(!N)throw new Error("Failed to create GL VAO");n.bindVertexArray(N),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,R),n.bindBuffer(n.ARRAY_BUFFER,B);const I=24;n.enableVertexAttribArray(0),n.vertexAttribPointer(0,3,n.FLOAT,!1,I,0),n.enableVertexAttribArray(1),n.vertexAttribPointer(1,3,n.FLOAT,!1,I,12),n.bindVertexArray(null);const P=new Ao(e,B,n.TRIANGLES,D.length,R,N),F=[...b,...E,...S,...x,...m,...y,...C,...A],O=VG(F);return P.extentsMin=O.min.slice(),P.extentsMax=O.max.slice(),P.furthestVertexFromOrigin=O.furthestVertexFromOrigin,P.originNegate=bi(O.origin),N_(P.originNegate,P.originNegate),P.fieldOfViewDeObliqueMM=[i[1]*s[1],i[2]*s[2],i[3]*s[3]],P}function WG(r){const e=r.length;let n=0;const i=new Uint8Array(e+Math.ceil(.01*e)),a=new Int8Array(i.buffer);let s=0;for(;n<e;){let o=r[n];n++;let l=1;for(;l<129&&n<e&&r[n]===o;)n++,l++;if(l>1){a[s]=-l+1,s++,i[s]=o,s++;continue}for(;n<e&&!(l>127||n+2<e&&o!==r[n]&&r[n+2]===r[n]&&r[n+1]===r[n]);)o=r[n],n++,l++;i[s]=l-1,s++;for(let u=0;u<l;u++)i[s]=r[n-l+u],s++}return Q.debug("PackBits "+e+" -> "+s+" bytes (x"+e/s+")"),i.slice(0,s)}function i2(r,e){const n=new Uint8Array(r.buffer),i=new Int8Array(n.buffer);let a=0;const s=new Uint8Array(e);let o=0;for(;a<n.length;){const l=i[a];if(a++,l<0){const u=i[a];a++;for(let c=0;c<1-l;c++)s[o]=u,o++}else for(let u=0;u<l+1;u++)s[o]=i[a],a++,o++}return s}var ZG=({drawUndoBitmaps:r,currentDrawUndoBitmap:e,drawBitmap:n})=>{const i=r.length;if(i<1){Q.debug("undo bitmaps not loaded");return}if(e--,e<0&&(e=i-1),e>=i&&(e=0),r[e].length<2){Q.debug("drawUndo is misbehaving");return}return n=i2(r[e],n.length),{drawBitmap:n,currentDrawUndoBitmap:e}};function JG(r,e,n){const{dimX:i,dimY:a,dimZ:s}=n;let o;if(r===0)o=s;else if(r===1)o=a;else if(r===2)o=i;else return null;let l=-1,u=-1;for(let c=0;c<o;c++){let h=!1;if(r===0){const d=c*i*a;for(let v=0;v<i*a;v++)if(e[d+v]>0){h=!0;break}}else if(r===1)for(let d=0;d<s;d++){for(let v=0;v<i;v++){const m=v+c*i+d*i*a;if(e[m]>0){h=!0;break}}if(h)break}else if(r===2)for(let d=0;d<s;d++){for(let v=0;v<a;v++){const m=c+v*i+d*i*a;if(e[m]>0){h=!0;break}}if(h)break}h&&(l===-1&&(l=c),u=c)}return l===-1||u===-1?null:{first:l,last:u}}function $m(r,e,n,i){const{dimX:a,dimY:s,dimZ:o}=i;let l;if(e===0){l=new Float32Array(a*s);const u=r*a*s;for(let c=0;c<a*s;c++)l[c]=n[u+c]}else if(e===1){l=new Float32Array(a*o);for(let u=0;u<o;u++)for(let c=0;c<a;c++){const h=c+r*a+u*a*s,d=c+u*a;l[d]=n[h]}}else if(e===2){l=new Float32Array(s*o);for(let u=0;u<o;u++)for(let c=0;c<s;c++){const h=r+c*a+u*a*s,d=c+u*s;l[d]=n[h]}}else throw new Error("Invalid slice type");return l}function ep(r,e,n,i,a){const{dimX:s,dimY:o,dimZ:l}=i;let u;if(e===0){u=new Float32Array(s*o);const c=r*s*o;for(let h=0;h<s*o;h++)u[h]=n[c+h]/a}else if(e===1){u=new Float32Array(s*l);for(let c=0;c<l;c++)for(let h=0;h<s;h++){const d=h+r*s+c*s*o,v=h+c*s;u[v]=n[d]/a}}else if(e===2){u=new Float32Array(o*l);for(let c=0;c<l;c++)for(let h=0;h<o;h++){const d=r+h*s+c*s*o,v=h+c*o;u[v]=n[d]/a}}else throw new Error("Invalid slice type");return u}function $G(r,e,n,i,a,s,o){const{dimX:l,dimY:u,dimZ:c}=a;if(n===0){const h=e*l*u;for(let d=0;d<r.length;d++)r[d]>=s&&(i[h+d]=o)}else if(n===1)for(let h=0;h<c;h++)for(let d=0;d<l;d++){const v=d+h*l,m=d+e*l+h*l*u;r[v]>=s&&(i[m]=o)}else if(n===2)for(let h=0;h<c;h++)for(let d=0;d<u;d++){const v=d+h*u,m=e+d*l+h*l*u;r[v]>=s&&(i[m]=o)}else throw new Error("Invalid slice type")}function wC(r,e,n){if(e<3||n<3)return;const i=new Float32Array(r.length);for(let a=0;a<n;a++)for(let s=0;s<e;s++){const o=s+a*e;s===0||s===e-1?i[o]=r[o]:i[o]=(r[o-1]+2*r[o]+r[o+1])*.25}for(let a=0;a<n;a++)for(let s=0;s<e;s++){const o=s+a*e;a===0||a===n-1?r[o]=i[o]:r[o]=(i[o-e]+2*i[o]+i[o+e])*.25}}function eY(r,e,n,i){const a=Math.abs(n-r),s=Math.abs(n-e),o=Math.exp(-a*a/(2*i*i)),l=Math.exp(-s*s/(2*i*i)),u=o+l;return u<1e-6?.5:o/u}function tY(r,e,n,i,a,s){const o=(n-i)/(a-i),l=1-o;for(let u=0;u<r.length;u++)s[u]=r[u]*l+e[u]*o}function rY(r,e,n,i,a,s,o,l,u,c){const h=(n-i)/(a-i),d=1-h;for(let v=0;v<r.length;v++)if(r[v]>0||e[v]>0){const m=eY(l[v],u[v],c[v],o.intensitySigma),y=o.intensityWeight,b=y*m+(1-y)*d,x=1-b;s[v]=r[v]*b+e[v]*x}else s[v]=r[v]*d+e[v]*h}function nY(r,e,n,i,a,s,o,l){const{dimX:u,dimY:c,dimZ:h}=e,d=o.sliceType??0;let v,m,y;if(d===0)v=u,m=c,y=h-1;else if(d===1)v=u,m=h,y=c-1;else if(d===2)v=c,m=h,y=u-1;else throw new Error("Invalid slice type. Must be AXIAL, CORONAL, or SAGITTAL");const b={intensityWeight:o.intensityWeight??.7,binaryThreshold:o.binaryThreshold??.375,intensitySigma:o.intensitySigma??.1,applySmoothingToSlices:o.applySmoothingToSlices??!0,useIntensityGuided:o.useIntensityGuided??!0};if(a!==void 0&&s!==void 0){if(a>=s)throw new Error("Low slice index must be less than high slice index");if(a<0||s>y)throw new Error(`Slice indices out of bounds [0, ${y}]`)}const x=new Map;for(let A=0;A<=y;A++){const C=$m(A,d,r,e);for(let E=0;E<C.length;E++){const S=C[E];if(S>0)if(!x.has(S))x.set(S,{min:A,max:A});else{const T=x.get(S);T.min=Math.min(T.min,A),T.max=Math.max(T.max,A)}}}for(const[A,C]of x){const E=a!==void 0?Math.max(a,C.min):C.min,S=s!==void 0?Math.min(s,C.max):C.max;if(E>=S||S-E<2)continue;const T=$m(E,d,r,e),R=$m(S,d,r,e),D=new Float32Array(T.length),B=new Float32Array(R.length);for(let N=0;N<T.length;N++)D[N]=T[N]===A?1:0,B[N]=R[N]===A?1:0;b.applySmoothingToSlices&&(wC(D,v,m),wC(B,v,m));for(let N=E+1;N<S;N++){const I=new Float32Array(v*m);if(b.useIntensityGuided&&n){const P=ep(E,d,n,e,i),F=ep(S,d,n,e,i),O=ep(N,d,n,e,i);rY(D,B,N,E,S,I,b,P,F,O)}else tY(D,B,N,E,S,I);$G(I,N,d,r,e,b.binaryThreshold,A)}}l()}var uc=`#version 300 es
#line 4
layout(location=0) in vec3 pos;
layout(location=1) in vec3 texCoords;
uniform mat4 mvpMtx;
out vec3 vColor;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vColor = texCoords;
}`,Ay=`
	vec4 drawColor(float scalar, float drawOpacity) {
		float nlayer = float(textureSize(colormap, 0).y);
		float layer = (nlayer - 0.5) / nlayer;
		vec4 dcolor = texture(colormap, vec2((scalar * 255.0)/256.0 + 0.5/256.0, layer)).rgba;
		dcolor.a *= drawOpacity;
		return dcolor;
}`,xf=`vec3 GetBackPosition(vec3 startPositionTex) {
	vec3 startPosition = startPositionTex * volScale;
	vec3 invR = 1.0 / rayDir;
	vec3 tbot = invR * (vec3(0.0)-startPosition);
	vec3 ttop = invR * (volScale-startPosition);
	vec3 tmax = max(ttop, tbot);
	vec2 t = min(tmax.xx, tmax.yz);
	vec3 endPosition = startPosition + (rayDir * min(t.x, t.y));
	//convert world position back to texture position:
	endPosition = endPosition / volScale;
	return endPosition;
}

vec4 applyClip (vec3 dir, inout vec4 samplePos, inout float len, inout bool isClip) {
	float cdot = dot(dir,clipPlane.xyz);
	isClip = false;
	if  ((clipPlane.a > 1.0) || (cdot == 0.0)) return samplePos;
	bool frontface = (cdot > 0.0);
	float dis = (-clipPlane.a - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	float thick = clipThick;
	if (thick <= 0.0) thick = 2.0;
	float  disBackFace = (-(clipPlane.a-thick) - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	if (((frontface) && (dis >= len)) || ((!frontface) && (dis <= 0.0))) {
		samplePos.a = len + 1.0;
		return samplePos;
	}
	if (frontface) {
		dis = max(0.0, dis);
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		if (dis > 0.0) isClip = true;
		len = min(disBackFace, len);
	}
	if (!frontface) {
		len = min(dis, len);
		disBackFace = max(0.0, disBackFace);
		if (len == dis) isClip = true;
		samplePos = vec4(samplePos.xyz+dir * disBackFace, disBackFace);
	}
	return samplePos;
}

void clipVolume(inout vec3 startPos, inout vec3 backPos, int dim, float frac, bool isLo) {
	vec3 dir = backPos - startPos;
	float len = length(dir);
	dir = normalize(dir);
	// Discard if both startPos and backPos are outside the clipping plane
	if (isLo && startPos[dim] < frac && backPos[dim] < frac) {
		discard;
	}
	if (!isLo && startPos[dim] > frac && backPos[dim] > frac) {
		discard;
	}
	vec4 plane = vec4(0.0, 0.0, 0.0, 0.5 - frac);
	plane[dim] = 1.0;
	float cdot = dot(dir, plane.xyz);
	float dis = (-plane.w - dot(plane.xyz, startPos - vec3(0.5))) / cdot;
	// Adjust startPos or backPos based on the intersection with the plane
	bool isFrontFace = (cdot > 0.0);
	if (!isLo)
		isFrontFace = !isFrontFace;
	if (dis > 0.0) {
		if (isFrontFace) {
				if (dis <= len) {
					startPos = startPos + dir * dis;
				}
		} else {
			if (dis < len) {
				backPos = startPos + dir * dis;
			}
		}
	}
}

void clipVolumeStart (inout vec3 startPos, inout vec3 backPos) {
	// vec3 clipLo = vec3(0.1, 0.2, 0.4);
	// vec3 clipHi = vec3(0.8, 0.7, 0.7);
	for (int i = 0; i < 3; i++) {
		if (clipLo[i] > 0.0)
			clipVolume(startPos, backPos, i, clipLo[i], true);
	}
	for (int i = 0; i < 3; i++) {
		if (clipHi[i] < 1.0)
			clipVolume(startPos, backPos, i, clipHi[i], false);
	}
}

float frac2ndc(vec3 frac) {
//https://stackoverflow.com/questions/7777913/how-to-render-depth-linearly-in-modern-opengl-with-gl-fragcoord-z-in-fragment-sh
	vec4 pos = vec4(frac.xyz, 1.0); //fraction
	vec4 dim = vec4(vec3(textureSize(volume, 0)), 1.0);
	pos = pos * dim;
	vec4 shim = vec4(-0.5, -0.5, -0.5, 0.0);
	pos += shim;
	vec4 mm = transpose(matRAS) * pos;
	float z_ndc = (mvpMtx * vec4(mm.xyz, 1.0)).z;
	return (z_ndc + 1.0) / 2.0;
}`+Ay,xy=`void main() {
	if (fColor.x > 2.0) {
		fColor = vec4(1.0, 0.0, 0.0, 0.5);
		return;
	}
	fColor = vec4(0.0,0.0,0.0,0.0);
	vec4 clipPlaneColorX = clipPlaneColor;
	//if (clipPlaneColor.a < 0.0)
	//	clipPlaneColorX.a = - 1.0;
	bool isColorPlaneInVolume = false;
	if (clipPlaneColorX.a < 0.0) {
		isColorPlaneInVolume = true;
		clipPlaneColorX.a = 0.0;
	}
	//fColor = vec4(vColor.rgb, 1.0); return;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	// fColor = vec4(backPosition, 1.0); return;
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	dir = normalize(dir);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	//if ((clipPos.a != samplePos.a) && (len < 3.0)) {
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	float drawOpacityA = renderDrawAmbientOcclusionXY.y;
	if ((samplePos.a >= len) && (((overlays < 1.0) && (drawOpacityA <= 0.0) ) || (backgroundMasksOverlays > 0)))  {
		if (isClip)
			fColor += clipPlaneColorX;
		return;
	}
	fColor = vec4(1.0, 1.0, 1.0, 1.0);
	//gl_FragDepth = frac2ndc(samplePos.xyz); //crude due to fast pass resolution
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * lenNoClip);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`,G0=`
	if (firstHit.a < len) {
		gl_FragDepth = frac2ndc(firstHit.xyz);
		vec4 paqdSample = texture(paqd, samplePos.xyz);
		if (paqdSample.a > 0.0) {
			//colAcc.rgb = paqdSample.rgb;
			float a = max(abs(paqdUniforms[2]), abs(paqdUniforms[3]));
			colAcc.rgb = mix(colAcc.rgb, paqdSample.rgb, 0.5 * paqdSample.a * a);
		}
		
	}
	colAcc.a = (colAcc.a / earlyTermination) * backOpacity;
	fColor = colAcc;
	//if (isClip) //CR
	if ((isColorPlaneInVolume) && (clipPos.a != samplePos.a) && (abs(firstHit.a - clipPos.a) < deltaDir.a))
		fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, abs(clipPlaneColor.a));
		//fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, clipPlaneColorX.a * 0.65);
	float renderDrawAmbientOcclusionX = renderDrawAmbientOcclusionXY.x;
	float drawOpacity = renderDrawAmbientOcclusionXY.y;
	if ((overlays < 1.0) && (drawOpacity <= 0.0))
		return;
	//overlay pass
	len = lenNoClip;
	samplePos = vec4(start.xyz, 0.0); //ray position
	//start: OPTIONAL fast pass: rapid traversal until first hit
	stepSizeFast = sliceSize * 1.0;
	deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (drawOpacity > 0.0)
			val = max(val, texture(drawing, samplePos.xyz).r);
		if (val > 0.001)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	if (samplePos.a >= len) {
		if (isClip && (fColor.a == 0.0))
				fColor += clipPlaneColorX;
			return;
	}
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	float overFarthest = len;
	colAcc = vec4(0.0, 0.0, 0.0, 0.0);

	samplePos += deltaDir * ran; //jitter ray
	vec4 overFirstHit = vec4(0.0,0.0,0.0,2.0 * len);
	if (backgroundMasksOverlays > 0)
		samplePos = firstHit;
	bool firstDraw = true;
	while (samplePos.a <= len) {
		vec4 colorSample = texture(overlay, samplePos.xyz);
		if ((colorSample.a < 0.01) && (drawOpacity > 0.0)) {
			float val = texture(drawing, samplePos.xyz).r;
			vec4 draw = drawColor(val, drawOpacity);
			if ((draw.a > 0.0) && (firstDraw)) {
				firstDraw = false;
				float sum = 0.0;
				const float mn = 1.0 / 256.0;
				const float sampleRadius = 1.1;
				float dx = sliceSize * sampleRadius;
				vec3 center = samplePos.xyz;
				//six neighbors that share a face
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,0.0), dir)).r, mn);
				//float proportion = (sum / mn) / 6.0;
				
				//12 neighbors that share an edge
				dx = sliceSize * sampleRadius * sqrt(2.0) * 0.5;
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,-dx,0.0), dir)).r, mn);

				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,-dx,0.0), dir)).r, mn);
				
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,+dx,0.0), dir)).r, mn);
				float proportion = (sum / mn) / 18.0; //proportion of six neighbors is non-zero
				
				//a high proportion of hits means crevice
				//since the AO term adds shadows that darken most voxels, it will result in dark surfaces
				//the term brighten adds a little illumination to balance this
				// without brighten, only the most extreme ridges will not be darker
				const float brighten = 1.2;
				vec3 ao = draw.rgb * (1.0 - proportion) * brighten;
				draw.rgb = mix (draw.rgb, ao , renderDrawAmbientOcclusionX);
			}
			colorSample = draw;
		}
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (overFirstHit.a > len)
				overFirstHit = samplePos;
			colorSample.a *= renderOverlayBlend;
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			overFarthest = samplePos.a;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
	//if (samplePos.a >= len) {
	if (colAcc.a <= 0.0) {
		if (isClip && (fColor.a == 0.0))
			fColor += clipPlaneColorX;
		return;
	}
	if (overFirstHit.a < firstHit.a)
		gl_FragDepth = frac2ndc(overFirstHit.xyz);
	float overMix = colAcc.a;
	float overlayDepth = 0.3;
	if (fColor.a <= 0.0)
		overMix = 1.0;
	else if (((overFarthest) > backNearest)) {
		float dx = (overFarthest - backNearest)/1.73;
		dx = fColor.a * pow(dx, overlayDepth);
		overMix *= 1.0 - dx;
	}
	fColor.rgb = mix(fColor.rgb, colAcc.rgb, overMix);
	fColor.a = max(fColor.a, colAcc.a);
}`,iY=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+xf+`
	void main() {
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		fColor = vec4(0.0,0.0,0.0,0.0);
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * len);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float dis = len;
	//check if axial plane is closest
	vec4 aClip = vec4(0.0, 0.0, 1.0, (1.0- clipPlane.z) - 0.5);
	float adis = (-aClip.a - dot(aClip.xyz, samplePos.xyz-0.5)) / dot(dir,aClip.xyz);
	if (adis > 0.0)
		dis = min(adis, dis);
	//check of coronal plane is closest
	vec4 cClip = vec4(0.0, 1.0, 0.0, (1.0- clipPlane.y) - 0.5);
	float cdis = (-cClip.a - dot(cClip.xyz, samplePos.xyz-0.5)) / dot(dir,cClip.xyz);
	if (cdis > 0.0)
		dis = min(cdis, dis);
	//check if coronal slice is closest
	vec4 sClip = vec4(1.0, 0.0, 0.0, (1.0- clipPlane.x) - 0.5);
	float sdis = (-sClip.a - dot(sClip.xyz, samplePos.xyz-0.5)) / dot(dir,sClip.xyz);
	if (sdis > 0.0)
		dis = min(sdis, dis);
	if ((dis > 0.0) && (dis < len)) {
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		colAcc = texture(volume, samplePos.xyz);
		colAcc.a = earlyTermination;
		firstHit = samplePos;
		backNearest = min(backNearest, samplePos.a);
	}
	//the following are only used by overlays
	vec4 clipPlaneColorX = clipPlaneColor;
	bool isColorPlaneInVolume = false;
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`+G0,aY=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+xf+xy+`while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
`+G0,Fc=192,TT=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 normMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing, gradient;
uniform highp sampler2D colormap;
uniform highp sampler2D matCap;
uniform vec2 renderDrawAmbientOcclusionXY;
uniform float gradientAmount;
uniform float silhouettePower;
uniform float gradientOpacity[${Fc}];
in vec3 vColor;
out vec4 fColor;
`,sY=TT+xf+xy+`
	float startPos = samplePos.a;
	float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	float silhouetteThreshold = 1.0 - silhouettePower;
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			grad.rgb = normalize(grad.rgb*2.0 - 1.0);
			//if (grad.a < prevGrad.a)
			//	grad.rgb = prevGrad.rgb;
			//prevGrad = grad;
			vec3 n = mat3(normMtx) * grad.rgb;
			n.y = - n.y;
			vec4 mc = vec4(texture(matCap, n.xy * 0.5 + 0.5).rgb, 1.0) * brighten;
			mc = mix(vec4(1.0), mc, gradientAmount);
			if (samplePos.a > clipClose)
				colorSample.rgb *= mc.rgb;
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			int gradIdx = int(grad.a * ${Fc}.0);
			colorSample.a *= gradientOpacity[gradIdx];
			float lightNormDot = dot(grad.rgb, rayDir);
			// n.b. "lightNormDor" is cosTheta, "silhouettePower" is Fresnel effect exponent
 			colorSample.a *= pow(1.0 - abs(lightNormDot), silhouettePower);
 			float viewAlign = abs(lightNormDot); // 0 = perpendicular, 1 = aligned
 			// linearly map silhouettePower (0..1) to a threshold range, e.g., [1.0, 0.0]
 			// Cull voxels that are too aligned with the view direction
 			if (viewAlign > silhouetteThreshold)
 				colorSample.a = 0.0;
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+G0,oY=TT+xf+xy+`
	float startPos = samplePos.a;
	float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			colorSample.rgb = abs(normalize(grad.rgb*2.0 - 1.0));
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+G0,ud=`#version 300 es
#line 392
layout(location=0) in vec3 pos;
uniform int axCorSag;
uniform mat4 mvpMtx;
uniform mat4 frac2mm;
uniform float slice;
out vec3 texPos;
void main(void) {
	texPos = vec3(pos.x, pos.y, slice);
	if (axCorSag > 1)
		texPos = vec3(slice, pos.x, pos.y);
	else if (axCorSag > 0)
		texPos = vec3(pos.x, slice, pos.y);
	vec4 mm = frac2mm * vec4(texPos, 1.0);
	gl_Position = mvpMtx * mm;
}`,MT=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform float drawRimOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;
`+Ay+`
vec4 blendRGBA(vec4 foreground, vec4 background) {
  float alphaOut = foreground.a + background.a * (1.0 - foreground.a);
  vec3 colorOut = (foreground.rgb * foreground.a + background.rgb * background.a * (1.0 - foreground.a)) / alphaOut;
  return vec4(colorOut, alphaOut);
}
float paqdEaseAlpha(float alpha) {
  // t are alpha transitions
  // <t0 -> y0
  // t0..t1  -> mix between y0..y1
  // t1..t2 -> mix between y1..y2
  // >t2 -> y2
  float t0 = paqdUniforms[0]; // 0.3;
  float t1 = 0.5 * (paqdUniforms[0] + paqdUniforms[1]); // 0.4;
  float t2 = paqdUniforms[1]; // 0.9;
  float y0 = 0.0;
  float y1 = abs(paqdUniforms[2]); // 1.0;
  float y2 = abs(paqdUniforms[3]); //0.25;
  if (alpha <= t0) {
    return y0;
  } else if (alpha <= t1) {
    return mix(y0, y1, (alpha - t0) / (t1 - t0)); // LERP 0.0 → 1.0
  } else if (alpha <= t2) {
    return mix(y1, y2, (alpha - t1) / (t2 - t1)); // LERP 1.0 → 0.2
  } else {
    return y2;
  }
}

void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 ocolor = vec4(0.0);
	float overlayAlpha = overlayAlphaShader;
	if (overlays > 0.0) {
		ocolor = texture(overlay, texPos);
		//dFdx for "boxing" issue 435 has aliasing on some implementations (coarse vs fine)
		//however, this only identifies 50% of the edges due to aliasing effects
		// http://www.aclockworkberry.com/shader-derivative-functions/
		// https://bgolus.medium.com/distinctive-derivative-differences-cce38d36797b
		//if ((ocolor.a >= 1.0) && ((dFdx(ocolor.a) != 0.0) || (dFdy(ocolor.a) != 0.0)  ))
		//	ocolor.rbg = vec3(0.0, 0.0, 0.0);
		bool isOutlineBelowNotAboveThreshold = true;
		if (isOutlineBelowNotAboveThreshold) {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a < 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				//6 voxel neighbors that share a face
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 0.0;
				if (axCorSag != 2) {
					a = max(a, texture(overlay, vxR).a);
					a = max(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = max(a, texture(overlay, vxA).a);
					a = max(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = max(a, texture(overlay, vxS).a);
					a = max(a, texture(overlay, vxI).a);
				}
				bool isCheckCorners = true;
				if (isCheckCorners) {
					//12 voxel neighbors that share an edge
					vec3 vxRA = vec3(texPos.x+vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxLA = vec3(texPos.x-vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxRP = vec3(texPos.x+vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxLP = vec3(texPos.x-vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxRS = vec3(texPos.x+vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxLS = vec3(texPos.x-vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxRI = vec3(texPos.x+vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxLI = vec3(texPos.x-vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxAS = vec3(texPos.x, texPos.y+vx.y, texPos.z+vx.z);
					vec3 vxPS = vec3(texPos.x, texPos.y-vx.y, texPos.z+vx.z);
					vec3 vxAI = vec3(texPos.x, texPos.y+vx.y, texPos.z-vx.z);
					vec3 vxPI = vec3(texPos.x, texPos.y-vx.y, texPos.z-vx.z);

					if (axCorSag == 0) { //axial corners
						a = max(a, texture(overlay, vxRA).a);
						a = max(a, texture(overlay, vxLA).a);
						a = max(a, texture(overlay, vxRP).a);
						a = max(a, texture(overlay, vxLP).a);
					}
					if (axCorSag == 1) { //coronal corners
						a = max(a, texture(overlay, vxRS).a);
						a = max(a, texture(overlay, vxLS).a);
						a = max(a, texture(overlay, vxRI).a);
						a = max(a, texture(overlay, vxLI).a);
					}
					if (axCorSag == 2) { //sagittal corners
						a = max(a, texture(overlay, vxAS).a);
						a = max(a, texture(overlay, vxPS).a);
						a = max(a, texture(overlay, vxAI).a);
						a = max(a, texture(overlay, vxPI).a);
					}
				}
				if (a >= 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}

		} else {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a >= 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 1.0;
				if (axCorSag != 2) {
					a = min(a, texture(overlay, vxR).a);
					a = min(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = min(a, texture(overlay, vxA).a);
					a = min(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = min(a, texture(overlay, vxS).a);
					a = min(a, texture(overlay, vxI).a);
				}
				if (a < 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}
		} //outline above threshold
	}

`,lY=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler2D volume, overlay;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler2D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;`+Ay+`void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos.xy);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 dcolor = drawColor(texture(drawing, texPos.xy).r, drawOpacity);
	if (dcolor.a > 0.0) {
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
}`,DT=`	ocolor.a *= overlayAlpha;
	float drawV = texture(drawing, texPos).r;
	vec4 dcolor = drawColor(drawV, drawOpacity);
	if (dcolor.a > 0.0) {
		if (drawRimOpacity >= 0.0) {
			vec3 vx = 1.0 / vec3(textureSize(drawing, 0));
			//6 voxel neighbors that share a face
			vec3 offsetX = dFdx(texPos); // left-right spacing
			vec3 offsetY = dFdy(texPos); // up-down spacing
			float L = texture(drawing, texPos - offsetX).r;
			float R = texture(drawing, texPos + offsetX).r;
			float T = texture(drawing, texPos - offsetY).r;
			float B = texture(drawing, texPos + offsetY).r;
			if (L != drawV || R != drawV || T != drawV || B != drawV)
				dcolor.a = drawRimOpacity;
		}
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
	vec4 pcolor = texture(paqd, texPos);
	if (pcolor.a > 0.0) {
		pcolor.a = paqdEaseAlpha(pcolor.a);
		if (pcolor.a > 0.0) {
			if (paqdUniforms[3] < 0.0)
				ocolor = blendRGBA(pcolor, ocolor);
			else
				ocolor = blendRGBA(ocolor, pcolor);
		}
	}
	if ((backgroundMasksOverlays > 0) && (background.a == 0.0))
		return;
	float a = color.a + ocolor.a * (1.0 - color.a); // premultiplied alpha
	if (a == 0.0) return;
	color.rgb = mix(color.rgb, ocolor.rgb, ocolor.a / a);
	color.a = a;
}`,uY=MT+DT,cY=MT+`	if (ocolor.a > 0.0) {
		//https://gamedev.stackexchange.com/questions/102889/is-it-possible-to-convert-vec4-to-int-in-glsl-using-opengl-es
		uint alpha = uint(ocolor.a * 255.0);
		vec3 xyzFlip = vec3(float((uint(1) & alpha) > uint(0)), float((uint(2) & alpha) > uint(0)), float((uint(4) & alpha) > uint(0)));
		//convert from 0 and 1 to -1 and 1
		xyzFlip = (xyzFlip * 2.0) - 1.0;
		//https://math.stackexchange.com/questions/1905533/find-perpendicular-distance-from-point-to-line-in-3d
		//v1 principle direction of tensor for this voxel
		vec3 v1 = ocolor.rgb;
		//flips encode polarity to convert from 0..1 to -1..1 (27 bits vs 24 bit precision)
		v1 = normalize( v1 * xyzFlip);
		vec3 vxl = fract(texPos * vec3(textureSize(volume, 0))) - 0.5;
		//vxl coordinates now -0.5..+0.5 so 0,0,0 is origin
		vxl.x = -vxl.x;
		float t = dot(vxl,v1);
		vec3 P = t * v1;
		float dx = length(P-vxl);
		ocolor.a = 1.0 - smoothstep(0.2,0.25, dx);
		//if modulation was applied, use that to scale alpha not color:
		ocolor.a *= length(ocolor.rgb);
		ocolor.rgb = normalize(ocolor.rgb);
		//compute distance one half voxel closer to viewer:
		float pan = 0.5;
		if (axCorSag == 0)
			vxl.z -= pan;
		if (axCorSag == 1)
			vxl.y -= pan;
		if (axCorSag == 2)
			vxl.x += pan;
		t = dot(vxl,v1);
		P = t * v1;
		float dx2 = length(P-vxl);
		ocolor.rgb += (dx2-dx-(0.5 * pan)) * 1.0;
	}
`+DT,tp=`#version 300 es
#line 480
precision highp int;
precision highp float;
uniform vec4 lineColor;
out vec4 color;
void main() {
	color = lineColor;
}`,fY=`#version 300 es
#line 723
precision highp int;
precision highp float;

uniform vec4 lineColor;
uniform vec4 leftTopWidthHeight;
uniform float thickness; // line thickness in pixels
uniform vec2 canvasWidthHeight;

out vec4 color;

void main() {
    // fragment position in screen coordinates
    vec2 fragCoord = gl_FragCoord.xy;

    // canvas height
    float canvasHeight = canvasWidthHeight.y;

    // 'top' and 'bottom' to match gl_FragCoord.y coordinate system
    float top = canvasHeight - leftTopWidthHeight.y;
    float bottom = top - leftTopWidthHeight.w;

    // left and right edges
    float left = leftTopWidthHeight.x;
    float right = left + leftTopWidthHeight.z;

    bool withinLeft = fragCoord.x >= left && fragCoord.x <= left + thickness;
    bool withinRight = fragCoord.x <= right && fragCoord.x >= right - thickness;
    bool withinTop = fragCoord.y <= top && fragCoord.y >= top - thickness;
    bool withinBottom = fragCoord.y >= bottom && fragCoord.y <= bottom + thickness;

    bool isOutline = withinLeft || withinRight || withinTop || withinBottom;

    if (isOutline) {
        color = lineColor;
    } else {
        discard; 
    }
}`,hY=`#version 300 es
#line 490
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vColor;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vColor = pos.xy;
}`,dY=`#version 300 es
#line 506
precision highp int;
precision highp float;
uniform highp sampler2D colormap;
uniform float layer;
in vec2 vColor;
out vec4 color;
void main() {
	float nlayer = float(textureSize(colormap, 0).y);
	float fmap = (0.5 + layer) / nlayer;
	color = vec4(texture(colormap, vec2(vColor.x, fmap)).rgb, 1.0);
}`,CC=`#version 300 es
#line 520
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
}`,gY=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec4 startXYendXY;
void main(void) {
	vec2 posXY = mix(startXYendXY.xy, startXYendXY.zw, pos.x);
	vec2 dir = normalize(startXYendXY.xy - startXYendXY.zw);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0
	gl_Position = vec4((posXY * 2.0) - 1.0, 0.0, 1.0);
}`,vY=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec2 startXY;
uniform vec3 endXYZ; // transformed XYZ point
void main(void) {	
	vec2 posXY = mix(startXY.xy, endXYZ.xy, pos.x);
	vec2 startDiff = endXYZ.xy - startXY.xy;
	float startDistance = length(startDiff);
	vec2 diff = endXYZ.xy - posXY;
	float currentDistance = length(diff);
	vec2 dir = normalize(startXY.xy - endXYZ.xy);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0	
	float z = endXYZ.z * ( 1.0 - abs(currentDistance/startDistance)); 
	gl_Position = vec4((posXY * 2.0) - 1.0, z, 1.0);
}`,mY=`#version 300 es
#line 549
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(pos.x, 1.0 - pos.y);
}`,pY=`#version 300 es
#line 565
precision highp int;
precision highp float;
uniform highp sampler2D bmpTexture;
in vec2 vUV;
out vec4 color;
void main() {
	color = texture(bmpTexture, vUV);
}`,yY=`#version 300 es
#line 576
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(uvLeftTopWidthHeight.x + (pos.x * uvLeftTopWidthHeight.z), uvLeftTopWidthHeight.y  + ((1.0 - pos.y) * uvLeftTopWidthHeight.w) );
}`,AY=`#version 300 es
#line 593
precision highp int;
precision highp float;
uniform highp sampler2D fontTexture;
uniform vec4 fontColor;
uniform float screenPxRange;
in vec2 vUV;
out vec4 color;
float median(float r, float g, float b) {
	return max(min(r, g), min(max(r, g), b));
}
void main() {
	vec3 msd = texture(fontTexture, vUV).rgb;
	float sd = median(msd.r, msd.g, msd.b);
	float screenPxDistance = screenPxRange*(sd - 0.5);
	float opacity = clamp(screenPxDistance + 0.5, 0.0, 1.0);
	color = vec4(fontColor.rgb , fontColor.a * opacity);
}`,xY=`#version 300 es
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = pos.xy;
}`,bY=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 circleColor;
uniform float fillPercent;
in vec2 vUV;
out vec4 color;
void main() {
	/* Check if the pixel is inside the circle
		 and color it with a gradient. Otherwise, color it 
		 transparent   */
	float distance = length(vUV-vec2(0.5,0.5));
	if ( distance < 0.5 && distance >= (1.0 - fillPercent) / 2.0){
			color = vec4(circleColor.r,circleColor.g,circleColor.b,circleColor.a) ;			
	}else{
			color = vec4(0.0,0.0,0.0,0.0);
	}
}
`,Qs=`#version 300 es
#line 613
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4( (vPos.xy-vec2(0.5,0.5)) * 2.0, 0.0, 1.0);
}`,cd=`#version 300 es
uniform highp usampler3D intensityVol;
`,EC=`#version 300 es
uniform highp isampler3D intensityVol;
`,wY=`#version 300 es
uniform highp sampler3D intensityVol;
`,SC=`#line 1042
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform bool isAdditiveBlend;
uniform float coordZ;
uniform float layer;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform uint activeIndex;
uniform vec4 xyzaFrac;
uniform mat4 mtx;
float textureWidth;
float nlayer;
float layerY;

vec4 scalar2color(uint idx) {
	float fx = (float(idx) + 0.5) / textureWidth;
	vec4 clr = texture(colormap, vec2(fx, layerY)).rgba;
	if (clr.a > 0.0)
		clr.a = 1.0;
	clr.a *= opacity;
	return clr;
}
void main(void) {
	vec4 vx = vec4(TexCoord.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint idx = uint(texture(intensityVol, vx.xyz).r);
	if (idx == uint(0)) {
		if (layer < 1.0) {
			FragColor = vec4(0.0, 0.0, 0.0, 0.0);
			return;
		}
		FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		return;
	}
	textureWidth = float(textureSize(colormap, 0).x);
	nlayer = float(textureSize(colormap, 0).y);
	layerY = ((2.0 * layer) + 1.5) / nlayer;
	//idx = ((idx - uint(1)) % uint(100))+uint(1);
	FragColor = scalar2color(idx);
	bool isBorder = false;
	vx = vec4(TexCoord.x+xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint R = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x-xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint L = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y+xyzaFrac.y, coordZ, 1.0) * mtx;
	uint A = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y-xyzaFrac.y, coordZ, 1.0) * mtx;
	uint P = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y, coordZ+xyzaFrac.z, 1.0) * mtx;
	uint S = uint(texture(intensityVol, vx.xyz).r);
	vx = vec4(TexCoord.x, TexCoord.y, coordZ-xyzaFrac.z, 1.0) * mtx;
	uint I = uint(texture(intensityVol, vx.xyz).r);
	vec4 centerColor = FragColor;
	FragColor.a += scalar2color(R).a;
	FragColor.a += scalar2color(L).a;
	FragColor.a += scalar2color(A).a;
	FragColor.a += scalar2color(P).a;
	FragColor.a += scalar2color(S).a;
	FragColor.a += scalar2color(I).a;
	FragColor.a /= 7.0;
	if ((!isBorder) &&(idx == activeIndex)) {
		if (centerColor.a > 0.5)
			FragColor.a *= 0.4;
		else
			FragColor.a =0.8;
	}
	if (xyzaFrac.a != 0.0) { //outline
		if ((idx != R) || (idx != L) || (idx != A) || (idx != P) || (idx != S) || (idx != I)) {
			isBorder = true;
			if (xyzaFrac.a > 0.0)
				FragColor.a = xyzaFrac.a;
			else
				FragColor = vec4(0.0, 0.0, 0.0, 1.0);
		}
	}
	if (layer < 1.0) return;
		vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		// https://en.wikipedia.org/wiki/Alpha_compositing
		float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
		if (aout <= 0.0) return;
		if (isAdditiveBlend)
			FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a)) / aout;
		else
			FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
		FragColor.a = aout;
}`,rp=`#line 691
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform float cal_maxNeg;
uniform float cal_minNeg;
uniform bool isAlphaThreshold;
uniform bool isColorbarFromZero;
uniform bool isAdditiveBlend;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform int modulation;
uniform highp sampler3D modulationVol;
uniform float opacity;
uniform mat4 mtx;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	if ((vx.x < 0.0) || (vx.x > 1.0) || (vx.y < 0.0) || (vx.y > 1.0) || (vx.z < 0.0) || (vx.z > 1.0)) {
		//set transparent if out of range
		//https://webglfundamentals.org/webgl/webgl-3d-textures-repeat-clamp.html
		FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		return;
	}
	float f = (scl_slope * float(texture(intensityVol, vx.xyz).r)) + scl_inter;
	float mn = cal_min;
	float mx = cal_max;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mn = 0.0;
	float r = max(0.00001, abs(mx - mn));
	mn = min(mn, mx);
	float txl = mix(0.0, 1.0, (f - mn) / r);
	if (f > mn) { //issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
	}
	//https://stackoverflow.com/questions/5879403/opengl-texture-coordinates-in-pixel-space
	float nlayer = float(textureSize(colormap, 0).y);
	//each volume has two color maps:
	// (layer*2) = negative and (layer * 2) + 1 = positive
	float y = ((2.0 * layer) + 1.5)/nlayer;
	FragColor = texture(colormap, vec2(txl, y)).rgba;
	//negative colors
	mn = cal_minNeg;
	mx = cal_maxNeg;
	if ((isAlphaThreshold) || (isColorbarFromZero))
		mx = 0.0;
	//if ((!isnan(cal_minNeg)) && ( f < mx)) {
	if ((cal_minNeg < cal_maxNeg) && ( f < mx)) {
		r = max(0.00001, abs(mx - mn));
		mn = min(mn, mx);
		txl = 1.0 - mix(0.0, 1.0, (f - mn) / r);
		//issue1139: survives threshold, so round up to opaque voxel
		txl = max(txl, 2.0/256.0);
		y = ((2.0 * layer) + 0.5)/nlayer;
		FragColor = texture(colormap, vec2(txl, y));
	}
	if (layer > 0.7)
		FragColor.a = step(0.00001, FragColor.a);
	//if (modulation > 10)
	//	FragColor.a *= texture(modulationVol, vx.xyz).r;
	//	FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (isAlphaThreshold) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = pow(-f / -cal_maxNeg, 2.0);
		else if ((f > 0.0) && (cal_min > 0.0))
			FragColor.a *= pow(f / cal_min, 2.0); //issue435:  A = (V/X)**2
		//FragColor.g = 0.0;
	} else if (isColorbarFromZero) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = 0.0;
		else if ((f > 0.0) && (cal_min > 0.0) && (f < cal_min))
			FragColor.a *= 0.0;

	}
	if (modulation == 1) {
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	} else if (modulation == 2) {
		FragColor.a = texture(modulationVol, vx.xyz).r;
	}
	FragColor.a *= opacity;
	if (layer < 1.0) return;
	vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
	// https://en.wikipedia.org/wiki/Alpha_compositing
	float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
	if (aout <= 0.0) return;
	if (isAdditiveBlend)
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a)) / aout;
	else
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
	FragColor.a = aout;
}`,CY=`#line 773
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform mat4 mtx;
uniform bool hasAlpha;
uniform int modulation;
uniform highp sampler3D modulationVol;
float textureWidth;
float nlayer;
float layerY;

vec4 scalar2color(uint idx) {
	float fx = (float(idx) + 0.5) / textureWidth;
	vec4 clr = texture(colormap, vec2(fx, layerY)).rgba;
	if (clr.a > 0.0)
		clr.a = 1.0;
	clr.a *= opacity;
	return clr;
}

vec4 paqd2color(uvec4 rgba) {
  // paqd r: max prob index, g: 2nd index, b: max prob a: 2nd prob
  float prob1 = float(rgba.b)/255.0;
  float prob2 = float(rgba.a)/255.0;
  vec4 clr1 = scalar2color(rgba.r);
  vec4 clr2 = scalar2color(rgba.g);
  float total = prob1 + prob2;
  vec4 clr = vec4(clr1.rgb, total);
  // vec4 clr = vec4(clr1.rgb, prob1);
  if (total > 0.0) {
    clr.rgb = mix(clr2.rgb, clr1.rgb, prob1 / total);
  }
  return clr;
}
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	ivec3 voxelCoord = ivec3(vx.xyz * vec3(textureSize(intensityVol, 0)));
	uvec4 rgba = texelFetch(intensityVol, voxelCoord, 0);
	FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	if (rgba.r > uint(0)) {
		textureWidth = float(textureSize(colormap, 0).x);
		nlayer = float(textureSize(colormap, 0).y);
		layerY = ((2.0 * layer) + 1.5) / nlayer;
		FragColor = paqd2color(rgba);
		return;
	}
	// if (layer > 2.0) return;
	// FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
}`,EY=`#line 773
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform mat4 mtx;
uniform bool hasAlpha;
uniform int modulation;
uniform highp sampler3D modulationVol;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	uvec4 aColor = texture(intensityVol, vx.xyz);
	FragColor = vec4(float(aColor.r) / 255.0, float(aColor.g) / 255.0, float(aColor.b) / 255.0, float(aColor.a) / 255.0);
	if (modulation == 1)
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (!hasAlpha) {
		FragColor.a = (FragColor.r * 0.21 + FragColor.g * 0.72 + FragColor.b * 0.07);
		//next line: we could binarize alpha, but see rendering of visible human
		//FragColor.a = step(0.01, FragColor.a);
	}
	if (modulation == 2)
		FragColor.a = texture(modulationVol, vx.xyz).r;
	FragColor.a *= opacity;
	if (layer < 1.0) return;
	vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
	// https://en.wikipedia.org/wiki/Alpha_compositing
	float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
	if (aout <= 0.0) return;
	FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
	FragColor.a = aout;
}`,SY=`#version 300 es
#line 808
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4((vPos.x - 0.5) * 2.0, (vPos.y - 0.5) * 2.0, 0.0, 1.0);
}`,TY=`#version 300 es
#line 829
	precision highp float;
	precision highp int;
	precision highp isampler3D;
	layout(location = 0) out int label;
	layout(location = 1) out int strength;
	in vec2 TexCoord;
	uniform int finalPass;
	uniform float coordZ;
	uniform lowp sampler3D in3D;
	uniform highp isampler3D backTex; // background
	uniform highp isampler3D labelTex; // label
	uniform highp isampler3D strengthTex; // strength
void main(void) {
	vec3 interpolatedTextureCoordinate = vec3(TexCoord.xy, coordZ);
	ivec3 size = textureSize(backTex, 0);
	ivec3 texelIndex = ivec3(floor(interpolatedTextureCoordinate * vec3(size)));
	int background = texelFetch(backTex, texelIndex, 0).r;
	label = texelFetch(labelTex, texelIndex, 0).r;
	strength = texelFetch(strengthTex, texelIndex, 0).r;
	for (int k = -1; k <= 1; k++) {
		for (int j = -1; j <= 1; j++) {
			for (int i = -1; i <= 1; i++) {
				if (i != 0 && j != 0 && k != 0) {
					ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
					int neighborBackground = texelFetch(backTex, neighborIndex, 0).r;
					int neighborStrength = texelFetch(strengthTex, neighborIndex, 0).r;
					int strengthCost = abs(neighborBackground - background);
					int takeoverStrength = neighborStrength - strengthCost;
					if (takeoverStrength > strength) {
						strength = takeoverStrength;
						label = texelFetch(labelTex, neighborIndex, 0).r;
					}
				}
			}
		}
	}
	if (finalPass < 1)
		return;
	int ok = 1;
	ivec4 labelCount = ivec4(0,0,0,0);
	for (int k = -1; k <= 1; k++)
		for (int j = -1; j <= 1; j++)
			for (int i = -1; i <= 1; i++) {
				ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
				int ilabel = texelFetch(labelTex, neighborIndex, 0).r;
				if ((ilabel < 0) || (ilabel > 3))
					ok = 0;
				else
					labelCount[ilabel]++;
			}
	if (ok != 1) {
		return;
	}
	int maxIdx = 0;
	for (int i = 1; i < 4; i++) {
		if (labelCount[i] > labelCount[maxIdx])
			maxIdx = i;
	}
	label = maxIdx;
}`,MY=`#version 300 es
layout(location=0) in vec3 pos;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
}`,DY=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 surfaceColor;
out vec4 color;
void main() {
	color = surfaceColor;
}`,RY=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 clr;
out vec4 vClr;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vClr = clr;
}`,BY=`#version 300 es
precision highp int;
precision highp float;
in vec4 vClr;
out vec4 color;
uniform float opacity;
void main() {
	color = vec4(vClr.rgb, opacity);
}`,np=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
out vec3 vN;
out vec4 vP;
out vec4 vPc;
void main(void) {
	vec3 lightPosition = vec3(0.0, 0.0, -10.0);
	vP = vec4(pos, 1.0);
	vPc = mvpMtx * vec4(pos, 1.0);
	gl_Position = vPc;
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,IY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
out vec4 color;
vec4 packFloatToVec4i(const float value) {
	const vec4 bitSh = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
	const vec4 bitMsk = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
	vec4 res = fract(value * bitSh);
	res -= res.xxyz * bitMsk;
	return res;
}
void main() {
	color = packFloatToVec4i(gl_FragCoord.z);
}`,NY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
float stepmix(float edge0, float edge1, float E, float x){
	float T = clamp(0.5 * (x - edge0 + E) / E, 0.0, 1.0);
	return mix(edge0, edge1, T);
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0);
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.5;
	float shininess = 50.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float df = max(0.0, dot(n, l));
	float sf = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	const float A = 0.1;
	const float B = 0.3;
	const float C = 0.6;
	const float D = 1.0;
	float E = fwidth(df);
	if (df > A - E && df < A + E) df = stepmix(A, B, E, df);
	else if (df > B - E && df < B + E) df = stepmix(B, C, E, df);
	else if (df > C - E && df < C + E) df = stepmix(C, D, E, df);
	else if (df < A) df = 0.0;
	else if (df < B) df = B;
	else if (df < C) df = C;
	else df = D;
	E = fwidth(sf);
	if (sf > 0.5 - E && sf < 0.5 + E)
		sf = smoothstep(0.5 - E, 0.5 + E, sf);
	else
		sf = step(0.5, sf);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(df, 0.0) * vClr.rgb * diffuse;
	color.rgb = a + d + (specular * sf);
	color.a = opacity;
}`,FY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.25;
	float shininess = 10.0;
	float PenWidth = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	float view = abs(dot(n,r)); //with respect to viewer
	if (PenWidth < view) discard;
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color.rgb = a + d + s;
	color.a = opacity;
}`,kY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	const float thresh = 0.4;
	const vec3 viewDir = vec3(0.0, 0.0, -1.0);
	vec3 n = normalize(vN);
	// use abs() for two-sided lighting, max() for one sided
	float cosTheta = abs(dot(n, viewDir));
	// float cosTheta = max(dot(n, viewDir), 0.0);
	// optional fresnel equation - adjust exponent
	// cosTheta = 1.0 - pow(1.0 - cosTheta, 2.0);
	// use step for binary edges, smoothstep for feathered edges
	// vec3 d = step(thresh, cosTheta) * vClr.rgb;
	vec3 d = smoothstep(thresh - 0.05, thresh + 0.05, cosTheta) * vClr.rgb;
	color = vec4(d, opacity);
}`,PY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
  const float edge0 = 0.1;
  const float edge1 = 0.25;
  const vec3 viewDir = vec3(0.0, 0.0, -1.0);
  vec3 n = normalize(vN);
  float cosTheta = abs(dot(n, viewDir));
  float alpha = 1.0 - smoothstep(edge0, edge1, cosTheta);
  if (alpha <= 0.0) {
    discard;
  }
  color = vec4(0.0, 0.0, 0.0, opacity * alpha);
}`,UY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float diffuse = 1.0;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 0.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d = lightNormDot * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(d + s, opacity);
}`,VY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float diffuse = 1.4;
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(normalize(vN), l), 0.0);
	color = vec4(lightNormDot * vClr.rgb * diffuse, opacity);
}`,OY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float specularRGB = 0.7;
	float specularWhite = 0.3;
	float shininess = 10.0;
	float diffuse = 1.0;
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	vec3 n = normalize(vN);
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d3 = lightNormDot * vClr.rgb * diffuse;
	float s = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 s3 = specularRGB * s * vClr.rgb;
	s *= specularWhite;
	color = vec4(d3 + s3 + s, opacity);
}`,LY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
in vec4 vPc;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	// Compute curvature
	vec3 dx = dFdx(n);
	vec3 dy = dFdy(n);
	vec3 xneg = n - dx;
	vec3 xpos = n + dx;
	vec3 yneg = n - dy;
	vec3 ypos = n + dy;
	float depth = length(vPc.xyz);
	float curv = (cross(xneg, xpos).y - cross(yneg, ypos).x) / depth;
	//at this stage 0.5 for flat, with valleys dark and ridges bright
	curv = 1.0 - (curv + 0.5);
	//clamp
	curv =  min(max(curv, 0.0), 1.0);
	// easing function
	curv = pow(curv, 0.5);
	//modulate ambient and diffuse with curvature
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.6;
	float diffuse = 0.6;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 lightPosition = vec3(0.0, 10.0, -2.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient * curv;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,_Y=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,zY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
uniform sampler2D matCap;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	vec2 uv = n.xy * 0.5 + 0.5;
	uv.y = 1.0 - uv.y;
	vec3 clr = texture(matCap,uv.xy).rgb * vClr.rgb;
	color = vec4(clr, opacity);
}`,qY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float ambient = 0.35;
	float diffuse = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	color = vec4(a + d, opacity);
}`,GY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 up = vec3(0.0, 1.0, 0.0);
	float ax = dot(n, up) * 0.5 + 0.5;  //Shreiner et al. (2013) OpenGL Programming Guide, 8th Ed., p 388. ISBN-10: 0321773039
	vec3 upClr = vec3(1.0, 1.0, 0.95);
	vec3 downClr = vec3(0.4, 0.4, 0.6);
	vec3 a = vClr.rgb * ambient;
	a *= mix(downClr, upClr, ax);
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,YY=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
//Spherical harmonics constants
const float C1 = 0.429043;
const float C2 = 0.511664;
const float C3 = 0.743125;
const float C4 = 0.886227;
const float C5 = 0.247708;
//Spherical harmonics coefficients
// Ramamoorthi, R., and P. Hanrahan. 2001b. "An Efficient Representation for Irradiance Environment Maps." In Proceedings of SIGGRAPH 2001, pp. 497–500.
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// Constants for Eucalyptus Grove lighting
const vec3 L00  = vec3( 0.3783264,  0.4260425,  0.4504587);
const vec3 L1m1 = vec3( 0.2887813,  0.3586803,  0.4147053);
const vec3 L10  = vec3( 0.0379030,  0.0295216,  0.0098567);
const vec3 L11  = vec3(-0.1033028, -0.1031690, -0.0884924);
const vec3 L2m2 = vec3(-0.0621750, -0.0554432, -0.0396779);
const vec3 L2m1 = vec3( 0.0077820, -0.0148312, -0.0471301);
const vec3 L20  = vec3(-0.0935561, -0.1254260, -0.1525629);
const vec3 L21  = vec3(-0.0572703, -0.0502192, -0.0363410);
const vec3 L22  = vec3( 0.0203348, -0.0044201, -0.0452180);
vec3 SH(vec3 vNormal) {
	vNormal = vec3(vNormal.x,vNormal.z,vNormal.y);
	vec3 diffuseColor = C1 * L22 * (vNormal.x * vNormal.x - vNormal.y * vNormal.y) +
	C3 * L20 * vNormal.z * vNormal.z +
	C4 * L00 -
	C5 * L20 +
	2.0 * C1 * L2m2 * vNormal.x * vNormal.y +
	2.0 * C1 * L21  * vNormal.x * vNormal.z +
	2.0 * C1 * L2m1 * vNormal.y * vNormal.z +
	2.0 * C2 * L11  * vNormal.x +
	2.0 * C2 * L1m1 * vNormal.y +
	2.0 * C2 * L10  * vNormal.z;
	return diffuseColor;
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.1;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 a = vClr.rgb * ambient;
	vec3 d = vClr.rgb * diffuse * SH(-reflect(n, vec3(l.x, l.y, -l.z)) );
	color = vec4(a + d + s, opacity);
}`,HY=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
flat out vec3 vN;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,TC=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
flat in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,jY=`#version 300 es
#line 1260
//precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 volScale;
uniform vec3 texVox;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform highp sampler3D paqd;
uniform vec4 paqdUniforms;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform mat4 matRAS;
uniform mat4 mvpMtx;
uniform float drawOpacity, renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform int backgroundMasksOverlays;
in vec3 vColor;
out vec4 fColor;
`+xf+`
void main() {
	int id = 254;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	fColor = vec4(0.0, 0.0, 0.0, 0.0); //assume no hit: ID = 0
	float fid = float(id & 255)/ 255.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) return;//discard; //length limit for parallel rays
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	dir = normalize(dir);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	if (isClip) fColor = vec4(samplePos.xyz, 253.0 / 255.0); //assume no hit: ID = 0
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			break;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//end: fast pass
	if ((overlays < 1.0) || (backgroundMasksOverlays > 0)) {
		return; //background hit, no overlays
	}
	//overlay pass
	len = min(lenNoClip, samplePos.a); //only find overlay closer than background
	samplePos = vec4(start.xyz, 0.0); //ray position
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			return;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//if (fColor.a == 0.0) discard; //no hit in either background or overlays
	//you only get here if there is a hit with the background that is closer than any overlay
}`,KY=`#version 300 es
// an attribute is an input (in) to a vertex shader.
// It will receive data from a buffer
layout(location=0)  in vec3 a_position;
layout(location=1)  in vec3 a_color;
// A matrix to transform the positions by
uniform mat4 u_matrix;
out vec3 vColor;
// all shaders have a main function
void main() {
	// Multiply the position by the matrix.
	vec4 pos = vec4(a_position, 1.0);
	gl_Position = u_matrix * vec4(pos);
	vColor = a_color;
}
`,XY=`#version 300 es
precision highp float;
uniform vec4 u_color;
in vec3 vColor;
out vec4 outColor;
void main() {
	outColor = vec4(vColor, 1.0);
}`,QY=`#version 300 es
#line 1359
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	vec2 viewCoord = (vPos.xy - 0.5) * 2.0;
	gl_Position = vec4((vPos.xy - 0.5) * 2.0, 0.0, 1.0);
}`,WY=`#version 300 es
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform lowp sampler3D in3D;
void main(void) {
 FragColor = texture(in3D, vec3(TexCoord.xy, coordZ));
}`,fd=`#version 300 es
#line 286
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
    TexCoord = vPos.xy;
    gl_Position = vec4( (vPos.xy-vec2(0.5,0.5))* 2.0, 0.0, 1.0);
}`,ZY=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 samp = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
 FragColor = samp*0.125;
}`,JY=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 XYZ = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 vec4 OYZ = texture(intensityVol,vx+vec3(0.0,+dY,+dZ));
 vec4 xYZ = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 vec4 XOZ = texture(intensityVol,vx+vec3(+dX,0.0,+dZ));
 vec4 OOZ = texture(intensityVol,vx+vec3(0.0,0.0,+dZ));
 vec4 xOZ = texture(intensityVol,vx+vec3(-dX,0.0,+dZ));
 vec4 XyZ = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 vec4 OyZ = texture(intensityVol,vx+vec3(0.0,-dY,+dZ));
 vec4 xyZ = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));

 vec4 XYO = texture(intensityVol,vx+vec3(+dX,+dY,0.0));
 vec4 OYO = texture(intensityVol,vx+vec3(0.0,+dY,0.0));
 vec4 xYO = texture(intensityVol,vx+vec3(-dX,+dY,0.0));
 vec4 XOO = texture(intensityVol,vx+vec3(+dX,0.0,0.0));
 vec4 OOO = texture(intensityVol,vx+vec3(0.0,0.0,0.0));
 vec4 xOO = texture(intensityVol,vx+vec3(-dX,0.0,0.0));
 vec4 XyO = texture(intensityVol,vx+vec3(+dX,-dY,0.0));
 vec4 OyO = texture(intensityVol,vx+vec3(0.0,-dY,0.0));
 vec4 xyO = texture(intensityVol,vx+vec3(-dX,-dY,0.0));

 vec4 XYz = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 vec4 OYz = texture(intensityVol,vx+vec3(0.0,+dY,-dZ));
 vec4 xYz = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 vec4 XOz = texture(intensityVol,vx+vec3(+dX,0.0,-dZ));
 vec4 OOz = texture(intensityVol,vx+vec3(0.0,0.0,-dZ));
 vec4 xOz = texture(intensityVol,vx+vec3(-dX,0.0,-dZ));
 vec4 Xyz = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 vec4 Oyz = texture(intensityVol,vx+vec3(0.0,-dY,-dZ));
 vec4 xyz = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));

 vec4 blurred = vec4 (0.0, 0.0, 0.0, 0.0);
 blurred.r = 2.0*(xOz.r +xOZ.r +xyO.r +xYO.r +xOO.r +XOz.r +XOZ.r +XyO.r +XYO.r +XOO.r) +xyz.r +xyZ.r +xYz.r +xYZ.r +Xyz.r +XyZ.r +XYz.r +XYZ.r;
 blurred.g = 2.0*(Oyz.r +OyZ.r +xyO.r +XyO.r +OyO.r +OYz.r +OYZ.r +xYO.r +XYO.r +OYO.r) +xyz.r +Xyz.r +xyZ.r +XyZ.r +xYz.r +XYz.r +xYZ.r +XYZ.r;
 blurred.b = 2.0*(Oyz.r +OYz.r +xOz.r +XOz.r +OOz.r +OyZ.r +OYZ.r +xOZ.r +XOZ.r +OOZ.r) +xyz.r +Xyz.r +xYz.r +XYz.r +xyZ.r +XyZ.r +XyZ.r +XYZ.r;
 blurred.a = 0.32*(abs(blurred.r)+abs(blurred.g)+abs(blurred.b));
 // 0.0357 = 1/28 to account for weights, rescale to 2**16,
 FragColor = 0.0357*blurred;
}`,RT=`
  gradientSample.a = log2(gradientSample.r*gradientSample.r + gradientSample.g*gradientSample.g + gradientSample.b*gradientSample.b + 1.922337562475971e-06) + 18.988706873717717;
`,$Y=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  float TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ)).r;
  float TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ)).r;
  float TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ)).r;
  float TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ)).r;
  float BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ)).r;
  float BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ)).r;
  float BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ)).r;
  float BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ)).r;
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = BAR+BAL+BPR+BPL -TAR-TAL-TPR-TPL;
  gradientSample.g = TPR+TPL+BPR+BPL -TAR-TAL-BAR-BAL;
  gradientSample.b = TAL+TPL+BAL+BPL -TAR-TPR-BAR-BPR;
${RT}
	// 0.04242020977371934 = 1/(log2(3*8) - log2(1/(255**2*8))) // 3*8 -> max for 1st order gradient
	gradientSample.a *= 0.04242020977371934;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb = (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,eH=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform float dX2;
uniform float dY2;
uniform float dZ2;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  vec4 TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
  vec4 TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
  vec4 TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
  vec4 TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
  vec4 BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
  vec4 BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
  vec4 BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
  vec4 BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
  vec4 T = texture(intensityVol,vx+vec3(+dX2,0.0,0.0));
  vec4 A = texture(intensityVol,vx+vec3(0.0,+dY2,0.0));
  vec4 R = texture(intensityVol,vx+vec3(0.0,0.0,+dZ2));
  vec4 B = texture(intensityVol,vx+vec3(-dX2,0.0,0.0));
  vec4 P = texture(intensityVol,vx+vec3(0.0,-dY2,0.0));
  vec4 L = texture(intensityVol,vx+vec3(0.0,0.0,-dZ2));
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r = -4.0*B.r +8.0*(BAR.r+BAL.r+BPR.r+BPL.r) -8.0*(TAR.r+TAL.r+TPR.r+TPL.r) +4.0*T.r;
  gradientSample.g = -4.0*P.g +8.0*(TPR.g+TPL.g+BPR.g+BPL.g) -8.0*(TAR.g+TAL.g+BAR.g+BAL.g) +4.0*A.g;
  gradientSample.b = -4.0*L.b +8.0*(TAL.b+TPL.b+BAL.b+BPL.b) -8.0*(TAR.b+TPR.b+BAR.b+BPR.b) +4.0*R.b;
${RT}
	gradientSample.a *= 0.0325;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb =  (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,tH=function(r,e,n){const i=r.createShader(r.VERTEX_SHADER);r.shaderSource(i,e),r.compileShader(i);const a=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(a,n),r.compileShader(a);const s=r.createProgram();if(r.attachShader(s,i),r.attachShader(s,a),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))throw console.log(r.getProgramInfoLog(s)),r.getShaderParameter(i,r.COMPILE_STATUS)||console.log("Vertex shader compilation error:",r.getShaderInfoLog(i)),r.getShaderParameter(a,r.COMPILE_STATUS)||console.log("Fragment shader compilation error:",r.getShaderInfoLog(a)),Q.error(r.getProgramInfoLog(s)),new Error("Shader failed to link, see console for log");return s},St=class{constructor(r,e,n){j(this,"program"),j(this,"uniforms",{}),j(this,"isMatcap"),this.program=tH(r,e,n);const i=/uniform[^;]+[ ](\w+);/g,a=/uniform[^;]+[ ](\w+);/,s=e.match(i),o=n.match(i);s&&s.forEach(l=>{const u=l.match(a);this.uniforms[u[1]]=-1}),o&&o.forEach(l=>{const u=l.match(a);this.uniforms[u[1]]=-1});for(const l in this.uniforms)this.uniforms[l]=r.getUniformLocation(this.program,l)}use(r){r.useProgram(this.program)}},MC=(r,e)=>{const n=Math.floor(Math.log(r)/Math.log(10)),i=r/Math.pow(10,n);let a;return e?i<1.5?a=1:i<3?a=2:i<7?a=5:a=10:i<=1?a=1:i<=2?a=2:i<=5?a=5:a=10,a*Math.pow(10,n)};function rH(r){return new Promise((e,n)=>{let i;r instanceof File?i=Promise.resolve(r):i=new Promise((a,s)=>{r.file(a,s)}),i.then(a=>{const s=new FileReader;s.onload=()=>{typeof s.result=="string"?e(s.result):n(new Error("Expected a string from FileReader.result"))},s.onerror=()=>{n(s.error??new Error("Unknown FileReader error"))},s.readAsDataURL(a)}).catch(a=>n(a))})}function nH(r){const e=r.hdr.dims,n=r.permRAS,i=e[1]*e[2]*e[3],a=new Int16Array(i),s=[0,0,0];for(let m=0;m<3;m++)for(let y=0;y<3;y++)Math.abs(n[m])-1===y&&(s[y]=m*Math.sign(n[m]));let o=1;const l=[1,1,1],u=[!1,!1,!1];for(let m=0;m<s.length;m++)for(let y=0;y<s.length;y++)Math.abs(s[y])===m&&(l[y]=o,(s[y]<0||Object.is(s[y],-0))&&(u[y]=!0),o*=e[y+1]);let c=Oe.range(0,e[1]-1,1);u[0]&&(c=Oe.range(e[1]-1,0,-1));for(let m=0;m<e[1];m++)c[m]*=l[0];let h=Oe.range(0,e[2]-1,1);u[1]&&(h=Oe.range(e[2]-1,0,-1));for(let m=0;m<e[2];m++)h[m]*=l[1];let d=Oe.range(0,e[3]-1,1);u[2]&&(d=Oe.range(e[3]-1,0,-1));for(let m=0;m<e[3];m++)d[m]*=l[2];let v=0;for(let m=0;m<e[3];m++)for(let y=0;y<e[2];y++)for(let b=0;b<e[1];b++)a[c[b]+h[y]+d[m]]=r.img[v],v++;return a}function iH(r){const e=[5960464477539063e-23,152587890625e-16,.00390625,1];return(r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3])/255}function DC(r,e){return r.scl_slope===0&&(r.scl_slope=1),e*r.scl_slope+r.scl_inter}function cc(r,e,n=4){const i=MC(e-r,!1),a=MC(i/(n-1),!0),s=Math.floor(r/a)*a,o=Math.ceil(e/a)*a;return[a,s,o,s===r&&o===e]}function RC(r,e){let n=cc(r,e,3);return n[3]||(n=cc(r,e,5)),n[3]||(n=cc(r,e,4)),n[3]||(n=cc(r,e,3)),n[3]||(n=cc(r,e,5)),[n[0],n[1],n[2]]}function ns(r){return r*(Math.PI/180)}function ip(r,e,n,i){let a=-r,s=-e;return isFinite(n)&&isFinite(i)&&(a=n,s=i),a>s&&([a,s]=[s,a]),[a,s]}function ap(r,e,n){return Math.min(Math.max(r,e),n)}function Ar(r,e=[0,1,2]){const n=Kt();return n[0]=r[e[0]],n[1]=r[e[1]],n[2]=r[e[2]],n}function BC(r){const e=er(1,0,0,0),n=Yi();return qr(n,e,r),n[0]}function aH(r,e,n,i){const a=er(r,e,n,1),s=Er(i);Mn(s,s),a[0]=a[0]*2-1,a[1]=a[1]*2-1,a[2]=a[2]*2-1;const o=Yi();return qr(o,a,s),o[3]===0||(o[0]/=o[3],o[1]/=o[3],o[2]/=o[3]),o}var{version:IC}=vq,Ws=["ASC","BYU","DFS","FSM","PIAL","ORIG","INFLATED","SMOOTHWM","SPHERE","WHITE","G","GEO","GII","ICO","MZ3","NV","OBJ","OFF","PLY","SRF","STL","TCK","TRACT","TRI","TRK","TT","TRX","VTK","WRL","X3D","JCON","JSON"],fc=0,sp=1,op=2,bl=33984,hd=33985,lp=33986,sH=33987,oH=33988,NC=33989,up=33990,is=33991,hc=33992,FC=33992,kC=33993,PC=33994,lH=33995,uH=33996,cH=33997,fH=33998,hH=33999,UC={filename:"",isSaveDrawing:!1,volumeByIndex:0},dH=class{constructor(r=xi){j(this,"loaders",{}),j(this,"dicomLoader",null),j(this,"canvas",null),j(this,"_gl",null),j(this,"isBusy",!1),j(this,"needsRefresh",!1),j(this,"colormapTexture",null),j(this,"colormapLists",[]),j(this,"volumeTexture",null),j(this,"gradientTexture",null),j(this,"gradientTextureAmount",0),j(this,"useCustomGradientTexture",!1),j(this,"renderGradientValues",!1),j(this,"drawTexture",null),j(this,"paqdTexture",null),j(this,"drawUndoBitmaps",[]),j(this,"drawLut",Vt.makeDrawLut("$itksnap")),j(this,"drawOpacity",.8),j(this,"drawRimOpacity",-1),j(this,"clickToSegmentIsGrowing",!1),j(this,"clickToSegmentGrowingBitmap",null),j(this,"clickToSegmentXY",[0,0]),j(this,"renderDrawAmbientOcclusion",.4),j(this,"colorbarHeight",0),j(this,"drawPenLocation",[NaN,NaN,NaN]),j(this,"drawPenAxCorSag",-1),j(this,"drawFillOverwrites",!0),j(this,"drawPenFillPts",[]),j(this,"drawShapeStartLocation",[NaN,NaN,NaN]),j(this,"drawShapePreviewBitmap",null),j(this,"overlayTexture",null),j(this,"overlayTextureID",null),j(this,"sliceMMShader"),j(this,"slice2DShader"),j(this,"sliceV1Shader"),j(this,"orientCubeShader"),j(this,"orientCubeShaderVAO",null),j(this,"rectShader"),j(this,"rectOutlineShader"),j(this,"renderShader"),j(this,"lineShader"),j(this,"line3DShader"),j(this,"passThroughShader"),j(this,"renderGradientShader"),j(this,"renderGradientValuesShader"),j(this,"renderSliceShader"),j(this,"renderVolumeShader"),j(this,"pickingMeshShader"),j(this,"pickingImageShader"),j(this,"colorbarShader"),j(this,"customSliceShader",null),j(this,"fontShader",null),j(this,"fiberShader"),j(this,"fontTexture",null),j(this,"circleShader"),j(this,"matCapTexture",null),j(this,"bmpShader",null),j(this,"bmpTexture",null),j(this,"thumbnailVisible",!1),j(this,"bmpTextureWH",1),j(this,"growCutShader"),j(this,"orientShaderAtlasU",null),j(this,"orientShaderAtlasI",null),j(this,"orientShaderU",null),j(this,"orientShaderI",null),j(this,"orientShaderF",null),j(this,"orientShaderRGBU",null),j(this,"orientShaderPAQD",null),j(this,"surfaceShader",null),j(this,"blurShader",null),j(this,"sobelBlurShader",null),j(this,"sobelFirstOrderShader",null),j(this,"sobelSecondOrderShader",null),j(this,"genericVAO",null),j(this,"unusedVAO",null),j(this,"crosshairs3D",null),j(this,"DEFAULT_FONT_GLYPH_SHEET",xC),j(this,"DEFAULT_FONT_METRICS",bC),j(this,"fontMetrics"),j(this,"fontMets",null),j(this,"fontPx",12),j(this,"legendFontScaling",1),j(this,"backgroundMasksOverlays",0),j(this,"overlayOutlineWidth",0),j(this,"overlayAlphaShader",1),j(this,"position"),j(this,"extentsMin"),j(this,"extentsMax"),j(this,"resizeObserver",null),j(this,"resizeEventListener",null),j(this,"canvasObserver",null),j(this,"syncOpts",{"3d":!1,"2d":!1,zoomPan:!1,cal_min:!1,cal_max:!1,clipPlane:!1,gamma:!1,sliceType:!1,crosshair:!1}),j(this,"readyForSync",!1),j(this,"uiData",{mousedown:!1,touchdown:!1,mouseButtonLeftDown:!1,mouseButtonCenterDown:!1,mouseButtonRightDown:!1,mouseDepthPicker:!1,clickedTile:-1,pan2DxyzmmAtMouseDown:[0,0,0,1],prevX:0,prevY:0,currX:0,currY:0,currentTouchTime:0,lastTouchTime:0,touchTimer:null,doubleTouch:!1,isDragging:!1,dragStart:[0,0],dragEnd:[0,0],dragClipPlaneStartDepthAziElev:[0,0,0],lastTwoTouchDistance:0,multiTouchGesture:!1,windowX:0,windowY:0,activeDragMode:null,activeDragButton:null,angleFirstLine:[0,0,0,0],angleState:"none"}),j(this,"back",null),j(this,"overlays",[]),j(this,"deferredVolumes",[]),j(this,"deferredMeshes",[]),j(this,"furthestVertexFromOrigin",100),j(this,"volScale",[]),j(this,"vox",[]),j(this,"mousePos",[0,0]),j(this,"screenSlices",[]),j(this,"cuboidVertexBuffer"),j(this,"otherNV",null),j(this,"volumeObject3D",null),j(this,"pivot3D",[0,0,0]),j(this,"furthestFromPivot",10),j(this,"currentClipPlaneIndex",0),j(this,"lastCalled",new Date().getTime()),j(this,"selectedObjectId",-1),j(this,"CLIP_PLANE_ID",1),j(this,"VOLUME_ID",254),j(this,"DISTANCE_FROM_CAMERA",-.54),j(this,"graph",{LTWH:[0,0,640,480],opacity:0,vols:[0],autoSizeMultiplanar:!1,normalizeValues:!1,isRangeCalMinMax:!1}),j(this,"customLayout",[]),j(this,"meshShaders",[{Name:"Phong",Frag:_Y},{Name:"Matte",Frag:qY},{Name:"Harmonic",Frag:YY},{Name:"Hemispheric",Frag:GY},{Name:"Crevice",Frag:LY},{Name:"Edge",Frag:UY},{Name:"Diffuse",Frag:VY},{Name:"Outline",Frag:FY},{Name:"Specular",Frag:OY},{Name:"Toon",Frag:NY},{Name:"Flat",Frag:TC},{Name:"Matcap",Frag:zY},{Name:"Rim",Frag:kY},{Name:"Silhouette",Frag:PY}]),j(this,"dragModes",{contrast:1,measurement:2,angle:7,none:0,pan:3,slicer3D:4,callbackOnly:5}),j(this,"sliceTypeAxial",0),j(this,"sliceTypeCoronal",1),j(this,"sliceTypeSagittal",2),j(this,"sliceTypeMultiplanar",3),j(this,"sliceTypeRender",4),j(this,"onDragRelease",()=>{}),j(this,"onMouseUp",()=>{}),j(this,"onLocationChange",()=>{}),j(this,"onIntensityChange",()=>{}),j(this,"onClickToSegment",()=>{}),j(this,"onImageLoaded",()=>{}),j(this,"onMeshLoaded",()=>{}),j(this,"onFrameChange",()=>{}),j(this,"onError",()=>{}),j(this,"onColormapChange",()=>{}),j(this,"onInfo",()=>{}),j(this,"onWarn",()=>{}),j(this,"onDebug",()=>{}),j(this,"onVolumeAddedFromUrl",()=>{}),j(this,"onVolumeWithUrlRemoved",()=>{}),j(this,"onVolumeUpdated",()=>{}),j(this,"onMeshAddedFromUrl",()=>{}),j(this,"onMeshAdded",()=>{}),j(this,"onMeshWithUrlRemoved",()=>{}),j(this,"onZoom3DChange",()=>{}),j(this,"onAzimuthElevationChange",()=>{}),j(this,"onClipPlaneChange",()=>{}),j(this,"onCustomMeshShaderAdded",()=>{}),j(this,"onMeshShaderChanged",()=>{}),j(this,"onMeshPropertyChanged",()=>{}),j(this,"onDicomLoaderFinishedWithImages",()=>{}),j(this,"onDocumentLoaded",()=>{}),j(this,"onOptsChange",()=>{}),j(this,"document",new Jm),j(this,"mediaUrlMap",new Map),j(this,"initialized",!1),j(this,"currentDrawUndoBitmap");for(const e in r)typeof r[e]=="function"?this[e]=r[e]:this.opts[e]=xi[e]===void 0?xi[e]:r[e];this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,this.opts.drawingEnabled&&this.createEmptyDrawing(),this.opts.thumbnail.length>0&&(this.thumbnailVisible=!0),Q.setLogLevel(this.opts.logLevel),this.document.setOptsChangeCallback((e,n,i)=>{this.onOptsChange(e,n,i)})}get scene(){return this.document.scene}get opts(){return this.document.opts}get sliceMosaicString(){return this.document.opts.sliceMosaicString||""}set sliceMosaicString(r){this.document.opts.sliceMosaicString=r}get isAlphaClipDark(){return this.document.opts.isAlphaClipDark}set isAlphaClipDark(r){this.document.opts.isAlphaClipDark=r}cleanup(){this.resizeEventListener&&(window.removeEventListener("resize",this.resizeEventListener),this.resizeEventListener=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.canvasObserver&&(this.canvasObserver.disconnect(),this.canvasObserver=null),this.canvas&&this.opts.interactive&&(this.canvas.removeEventListener("mousedown",this.mouseDownListener.bind(this)),this.canvas.removeEventListener("mouseup",this.mouseUpListener.bind(this)),this.canvas.removeEventListener("mousemove",this.mouseMoveListener.bind(this)),this.canvas.removeEventListener("touchstart",this.touchStartListener.bind(this)),this.canvas.removeEventListener("touchend",this.touchEndListener.bind(this)),this.canvas.removeEventListener("touchmove",this.touchMoveListener.bind(this)),this.canvas.removeEventListener("wheel",this.wheelListener.bind(this)),this.canvas.removeEventListener("contextmenu",this.mouseContextMenuListener.bind(this)),this.canvas.removeEventListener("dblclick",this.resetBriCon.bind(this)),this.canvas.removeEventListener("dragenter",this.dragEnterListener.bind(this)),this.canvas.removeEventListener("dragover",this.dragOverListener.bind(this)),this.canvas.removeEventListener("drop",this.dropListener.bind(this)),this.canvas.removeEventListener("keyup",this.keyUpListener.bind(this)),this.canvas.removeEventListener("keydown",this.keyDownListener.bind(this))),this.document.removeOptsChangeCallback()}get volumes(){return this.document.volumes}set volumes(r){this.document.volumes=r}get meshes(){return this.document.meshes}set meshes(r){this.document.meshes=r}get drawBitmap(){return this.document.drawBitmap}set drawBitmap(r){this.document.drawBitmap=r}get volScaleMultiplier(){return this.scene.volScaleMultiplier}set volScaleMultiplier(r){this.setScale(r)}async saveScene(r="niivue.png"){function e(i,a){const s=document.createElement("a");document.body.appendChild(s),s.style.display="none";const o=window.URL.createObjectURL(i);s.href=o,s.download=a,s.click(),s.remove()}const n=this.canvas;if(!n)throw new Error("canvas not defined");this.drawScene(),n.toBlob(i=>{i&&(r===""&&(r=`niivue-screenshot-${new Date().toString()}.png`,r=r.replace(/\s/g,"_")),e(i,r))})}async attachTo(r,e=null){return await this.attachToCanvas(document.getElementById(r),e),Q.debug("attached to element with id: ",r),this}async attachToCanvas(r,e=null){return this.canvas=r,e===null&&(e=navigator.hardwareConcurrency>6,Q.debug("AntiAlias ",e," Threads ",navigator.hardwareConcurrency)),this.gl=this.canvas.getContext("webgl2",{alpha:!0,antialias:e}),this.uiData.max2D=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),this.uiData.max3D=this.gl.getParameter(this.gl.MAX_3D_TEXTURE_SIZE),Q.info("NIIVUE VERSION ",IC),Q.debug(`Max texture size 2D: ${this.uiData.max2D} 3D: ${this.uiData.max3D}`),this.canvas.parentElement.style.backgroundColor="black",this.opts.isResizeCanvas&&(this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight,this.resizeEventListener=()=>{requestAnimationFrame(()=>{this.resizeListener()})},window.addEventListener("resize",this.resizeEventListener),this.resizeObserver=new ResizeObserver(()=>{requestAnimationFrame(()=>{this.resizeListener()})}),this.resizeObserver.observe(this.canvas.parentElement),this.canvasObserver=new MutationObserver(n=>{for(const i of n)if(i.type==="childList"&&i.removedNodes.length>0&&Array.from(i.removedNodes).includes(this.canvas)){this.cleanup();break}}),this.canvasObserver.observe(this.canvas.parentElement,{childList:!0})),this.opts.interactive&&this.registerInteractions(),await this.init(),this.drawScene(),this}syncWith(r,e={"2d":!0,"3d":!0}){r instanceof Array||(r=[r]),this.otherNV=r,this.syncOpts={...e}}broadcastTo(r,e={"2d":!0,"3d":!0}){r instanceof Array||(r=[r]),this.otherNV=r,this.syncOpts=e}doSync3d(r){r.scene.renderAzimuth=this.scene.renderAzimuth,r.scene.renderElevation=this.scene.renderElevation,r.scene.volScaleMultiplier=this.scene.volScaleMultiplier}doSync2d(r){const e=this.frac2mm(this.scene.crosshairPos);r.scene.crosshairPos=r.mm2frac(e),r.scene.pan2Dxyzmm=hs(this.scene.pan2Dxyzmm)}doSyncGamma(r){const e=this.scene.gamma,n=r.scene.gamma;e!==n&&r.setGamma(e)}doSyncZoomPan(r){r.scene.pan2Dxyzmm=hs(this.scene.pan2Dxyzmm)}doSyncCrosshair(r){const e=this.frac2mm(this.scene.crosshairPos);r.scene.crosshairPos=r.mm2frac(e)}doSyncCalMin(r){this.volumes[0].cal_min!==r.volumes[0].cal_min&&(r.volumes[0].cal_min=this.volumes[0].cal_min,r.updateGLVolume())}doSyncCalMax(r){this.volumes[0].cal_max!==r.volumes[0].cal_max&&(r.volumes[0].cal_max=this.volumes[0].cal_max,r.updateGLVolume())}doSyncSliceType(r){r.setSliceType(this.opts.sliceType)}doSyncClipPlane(r){r.setClipPlane(this.scene.clipPlaneDepthAziElev)}sync(){if(!(!this.gl||!this.otherNV||typeof this.otherNV>"u")&&this.gl.canvas.matches(":focus"))for(let r=0;r<this.otherNV.length;r++)this.otherNV[r]!==this&&(this.syncOpts.gamma&&this.doSyncGamma(this.otherNV[r]),this.syncOpts.crosshair&&this.doSyncCrosshair(this.otherNV[r]),this.syncOpts.zoomPan&&this.doSyncZoomPan(this.otherNV[r]),this.syncOpts.sliceType&&this.doSyncSliceType(this.otherNV[r]),this.syncOpts.cal_min&&this.doSyncCalMin(this.otherNV[r]),this.syncOpts.cal_max&&this.doSyncCalMax(this.otherNV[r]),this.syncOpts.clipPlane&&this.doSyncClipPlane(this.otherNV[r]),this.syncOpts["2d"]&&this.doSync2d(this.otherNV[r]),this.syncOpts["3d"]&&this.doSync3d(this.otherNV[r]),this.otherNV[r].drawScene(),this.otherNV[r].createOnLocationChange())}arrayEquals(r,e){return Array.isArray(r)&&Array.isArray(e)&&r.length===e.length&&r.every((n,i)=>n===e[i])}textSizePoints(){this.opts.textHeight>=0&&(Q.warn("textHeight is deprecated (use fontMinPx and fontSizeScaling)"),this.opts.fontMinPx=this.opts.textHeight*217,this.opts.fontSizeScaling=.4,this.opts.textHeight=-1);const r=this.uiData.dpr||1,e=this.opts.fontMinPx,n=this.gl.canvas.width/r,i=this.gl.canvas.height/r,a=n*i,s=800*600,o=Math.max(a/s,1),l=Math.pow(o,this.opts.fontSizeScaling),u=e*l*r;this.fontPx=u,Q.debug(`${n.toFixed(0)}x${i.toFixed(0)} pts (dpi=${r}) => areaScale=${o.toFixed(2)}, scale=${l.toFixed(2)}, minPx=${this.opts.fontMinPx} fontScale=${this.opts.fontSizeScaling} fontPx=${u.toFixed(2)}`)}resizeListener(){if(!(!this.canvas||!this.gl)){if(!this.opts.isResizeCanvas){this.opts.forceDevicePixelRatio>=0&&Q.warn("this.opts.forceDevicePixelRatio requires isResizeCanvas"),this.drawScene();return}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.opts.forceDevicePixelRatio===0?this.uiData.dpr=window.devicePixelRatio||1:this.opts.forceDevicePixelRatio<0?this.uiData.dpr=1:this.uiData.dpr=this.opts.forceDevicePixelRatio,Q.debug("devicePixelRatio: "+this.uiData.dpr),"width"in this.canvas.parentElement?(this.canvas.width=this.canvas.parentElement.width*this.uiData.dpr,this.canvas.height=this.canvas.parentElement.height*this.uiData.dpr):(this.canvas.width=this.canvas.offsetWidth*this.uiData.dpr,this.canvas.height=this.canvas.offsetHeight*this.uiData.dpr),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.textSizePoints(),this.drawScene()}}getRelativeMousePosition(r,e){if(e=e||r.target,!e)return;const n=e.getBoundingClientRect();return{x:r.clientX-n.left,y:r.clientY-n.top}}getNoPaddingNoBorderCanvasRelativeMousePosition(r,e){return e=e||r.target,this.getRelativeMousePosition(r,e)}mouseContextMenuListener(r){r.preventDefault()}mouseDownListener(r){r.preventDefault(),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawShapeStartLocation=[NaN,NaN,NaN],this.uiData.mousedown=!0,this.opts.dragMode===7&&this.uiData.angleState==="drawing_second_line"||(this.setDragStart(0,0),this.setDragEnd(0,0)),Q.debug("mouse down"),Q.debug(r);const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(r,this.gl.canvas);if(!e)return;const[n,i]=[e.x*this.uiData.dpr,e.y*this.uiData.dpr];this.opts.clickToSegment&&(this.clickToSegmentXY=[n,i]);const a=this.getLabelAtPoint([n,i]);if(a){if(a.onClick){a.onClick(a,r);return}for(const s of this.meshes){if(s.type!=="connectome"){if(Array.isArray(a.points)&&a.points.length===3&&a.points.every(Number.isFinite)){const[o,l,u]=a.points;this.scene.crosshairPos=this.mm2frac([o,l,u]),this.updateGLVolume(),this.drawScene()}continue}for(const o of s.nodes)o.label===a&&(this.scene.crosshairPos=this.mm2frac([o.x,o.y,o.z]),this.updateGLVolume(),this.drawScene())}}this.uiData.clickedTile=this.tileIndex(n,i),r.button===fc&&r.shiftKey?(this.uiData.mouseButtonCenterDown=!0,this.setActiveDragMode(fc,!0,r.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,r,e)):r.button===fc?(this.uiData.mouseButtonLeftDown=!0,this.setActiveDragMode(fc,!1,r.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,r,e)):r.button===op?(this.uiData.mouseButtonRightDown=!0,this.setActiveDragMode(op,r.shiftKey,r.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,r,e)):r.button===sp&&(this.uiData.mouseButtonCenterDown=!0,this.setActiveDragMode(sp,r.shiftKey,r.ctrlKey),this.handleMouseAction(this.uiData.activeDragMode,r,e))}getMouseButtonDragMode(r,e,n){const i=this.opts.mouseEventConfig;return r===fc?i?.leftButton?e&&i.leftButton.withShift!==void 0?i.leftButton.withShift:n&&i.leftButton.withCtrl!==void 0?i.leftButton.withCtrl:i.leftButton.primary:n?8:this.opts.dragModePrimary:r===op?i?.rightButton!==void 0?i.rightButton:this.opts.dragMode:r===sp?i?.centerButton!==void 0?i.centerButton:this.opts.dragMode:this.opts.dragMode}getTouchDragMode(r){const e=this.opts.touchEventConfig;return r?e?.doubleTouch??this.opts.dragMode:e?.singleTouch??this.opts.dragModePrimary}setActiveDragMode(r,e,n){this.uiData.activeDragMode=this.getMouseButtonDragMode(r,e,n),this.uiData.activeDragButton=r}getCurrentDragMode(){return this.uiData.activeDragMode!==null?this.uiData.activeDragMode:this.opts.dragMode}clearActiveDragMode(){this.uiData.activeDragMode=null,this.uiData.activeDragButton=null}handleMouseAction(r,e,n){if(r===8)this.mouseDown(n.x,n.y),this.mouseClick(n.x,n.y);else if(r===9)this.uiData.windowX=e.x,this.uiData.windowY=e.y;else{if(this.mousePos=[n.x*this.uiData.dpr,n.y*this.uiData.dpr],r===0)return;if(r===7)if(this.uiData.angleState==="none")this.uiData.angleState="drawing_first_line";else if(this.uiData.angleState==="drawing_second_line"){const i=[n.x*this.uiData.dpr,n.y*this.uiData.dpr],a=this.tileIndex(i[0],i[1]);let s={sliceIndex:-1,sliceType:0,slicePosition:0};if(a>=0&&a<this.screenSlices.length){const d=this.screenSlices[a].axCorSag;let v=0;d===0?v=this.scene.crosshairPos[2]:d===1?v=this.scene.crosshairPos[1]:d===2&&(v=this.scene.crosshairPos[0]),s={sliceIndex:a,sliceType:d,slicePosition:v}}const o=[this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3],i[0],i[1]],l=this.canvasPos2frac([this.uiData.angleFirstLine[0],this.uiData.angleFirstLine[1]]),u=this.canvasPos2frac([this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3]]),c=this.canvasPos2frac([o[0],o[1]]),h=this.canvasPos2frac([o[2],o[3]]);if(l[0]>=0&&u[0]>=0&&c[0]>=0&&h[0]>=0){const d=this.frac2mm(l),v=this.frac2mm(u),m=this.frac2mm(c),y=this.frac2mm(h),b={firstLineMM:{start:Me(d[0],d[1],d[2]),end:Me(v[0],v[1],v[2])},secondLineMM:{start:Me(m[0],m[1],m[2]),end:Me(y[0],y[1],y[2])},sliceIndex:s.sliceIndex,sliceType:s.sliceType,slicePosition:s.slicePosition,angle:this.calculateAngleBetweenLines(this.uiData.angleFirstLine,o)};this.document.completedAngles.push(b)}this.resetAngleMeasurement(),this.uiData.angleState="complete",this.drawScene();return}else this.uiData.angleState==="complete"&&(this.resetAngleMeasurement(),this.uiData.angleState="drawing_first_line");this.setDragStart(n.x,n.y),this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=hs(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.dragClipPlaneStartDepthAziElev=this.scene.clipPlaneDepthAziElev}}calculateMinMaxVoxIdx(r){if(r.length>2)throw new Error("array must not contain more than two values");return[Math.floor(Math.min(r[0],r[1])),Math.floor(Math.max(r[0],r[1]))]}calculateNewRange({volIdx:r=0}={}){if(this.opts.sliceType===4&&this.sliceMosaicString.length<1||this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1])return;let e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]);if(e[0]<0)return;const n=this.frac2vox(e,r);if(e=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]),e[0]<0)return;const i=this.frac2vox(e,r);let a=-Number.MAX_VALUE,s=Number.MAX_VALUE;const o=this.calculateMinMaxVoxIdx([n[0],i[0]]),l=this.calculateMinMaxVoxIdx([n[1],i[1]]),u=this.calculateMinMaxVoxIdx([n[2],i[2]]);n[0]-i[0]===0?o[1]=n[0]+1:n[1]-i[1]===0?l[1]=n[1]+1:n[2]-i[2]===0&&(u[1]=n[2]+1);const c=this.volumes[r].hdr,h=this.volumes[r].img;if(!c||!h)return;const d=c.dims[1],v=c.dims[2];for(let b=u[0];b<u[1];b++){const x=b*d*v;for(let A=l[0];A<l[1];A++){const C=A*d;for(let E=o[0];E<o[1];E++){const S=x+C+E;s>h[S]&&(s=h[S]),a<h[S]&&(a=h[S])}}}if(s>=a)return;const m=DC(c,s),y=DC(c,a);this.volumes[r].cal_min=m,this.volumes[r].cal_max=y,this.onIntensityChange(this.volumes[r])}generateMouseUpCallback(r,e){const n=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]),i=this.tileIndex(this.uiData.dragEnd[0],this.uiData.dragEnd[1]);let a=-1;n===i&&(a=i);let s=-1;a>=0&&(s=this.screenSlices[a].axCorSag);const o=this.frac2mm(r),l=this.frac2mm(e),u=Kt();W4(u,Me(o[0],o[1],o[2]),Me(l[0],l[1],l[2]));const c=Zc(u),h=this.frac2vox(r),d=this.frac2vox(e);this.onDragRelease({fracStart:r,fracEnd:e,voxStart:h,voxEnd:d,mmStart:o,mmEnd:l,mmLength:c,tileIdx:a,axCorSag:s})}mouseUpListener(){function r(a){return Object.prototype.toString.call(a).indexOf("Function")>-1}const e={mouseButtonRightDown:this.uiData.mouseButtonRightDown,mouseButtonCenterDown:this.uiData.mouseButtonCenterDown,isDragging:this.uiData.isDragging,mousePos:this.mousePos,fracPos:this.canvasPos2frac(this.mousePos)};this.uiData.mousedown=!1,this.uiData.mouseButtonRightDown=!1;const n=this.uiData.mouseButtonCenterDown;this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonLeftDown=!1;const i=this.getCurrentDragMode();if(this.drawPenFillPts.length>0?this.drawPenFilled():this.opts.drawingEnabled&&!isNaN(this.drawPenLocation[0])?this.drawAddUndoBitmap():this.opts.drawingEnabled&&!isNaN(this.drawShapeStartLocation[0])&&(this.opts.penType===1||this.opts.penType===2)&&(this.opts.penValue===0?this.drawAddUndoBitmap():this.drawAddUndoBitmap(this.drawFillOverwrites),this.drawShapePreviewBitmap=null),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawShapeStartLocation=[NaN,NaN,NaN],this.drawShapePreviewBitmap&&(this.drawBitmap=this.drawShapePreviewBitmap,this.drawShapePreviewBitmap=null,this.refreshDrawing(!0,!1)),r(this.onMouseUp)&&this.onMouseUp(e),this.uiData.isDragging){if(this.uiData.isDragging=!1,i===7){if(this.uiData.angleState==="drawing_first_line"){this.uiData.angleFirstLine=[this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],this.uiData.angleState="drawing_second_line",this.uiData.isDragging=!0,this.drawScene();return}else if(this.uiData.angleState==="drawing_second_line"){this.uiData.angleState="complete",this.clearActiveDragMode(),this.drawScene();return}}i===5&&this.drawScene();const a=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),s=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);if(this.generateMouseUpCallback(a,s),i===6){this.clearActiveDragMode();return}if(i===1){if(n){this.clearActiveDragMode();return}if(this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1]){this.clearActiveDragMode();return}this.calculateNewRange({volIdx:0}),this.refreshLayers(this.volumes[0],0)}if(i===2){const o=this.getCurrentSliceInfo(),l=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),u=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);if(l[0]>=0&&u[0]>=0){const c=this.frac2mm(l),h=this.frac2mm(u);this.document.completedMeasurements.push({startMM:Me(c[0],c[1],c[2]),endMM:Me(h[0],h[1],h[2]),sliceIndex:o.sliceIndex,sliceType:o.sliceType,slicePosition:o.slicePosition,distance:I_(Me(c[0],c[1],c[2]),Me(h[0],h[1],h[2]))})}this.clearActiveDragMode(),this.drawScene();return}}this.clearActiveDragMode(),this.drawScene()}checkMultitouch(r){if(this.uiData.touchdown&&!this.uiData.multiTouchGesture){const e=this.canvas.getBoundingClientRect();this.mouseDown(r.touches[0].clientX-e.left,r.touches[0].clientY-e.top),this.mouseClick(r.touches[0].clientX-e.left,r.touches[0].clientY-e.top)}}touchStartListener(r){r.preventDefault(),this.uiData.touchTimer||(this.uiData.touchTimer=setTimeout(()=>{this.resetBriCon(r)},this.opts.longTouchTimeout)),this.uiData.touchdown=!0,this.uiData.currentTouchTime=new Date().getTime();const e=this.uiData.currentTouchTime-this.uiData.lastTouchTime;if(e<this.opts.doubleTouchTimeout&&e>0){this.uiData.doubleTouch=!0,this.setDragStart(r.targetTouches[0].clientX-r.target.getBoundingClientRect().left,r.targetTouches[0].clientY-r.target.getBoundingClientRect().top),this.resetBriCon(r),this.uiData.lastTouchTime=this.uiData.currentTouchTime;return}else this.uiData.doubleTouch=!1,this.setDragStart(0,0),this.setDragEnd(0,0),this.uiData.lastTouchTime=this.uiData.currentTouchTime;this.uiData.touchdown&&r.touches.length<2?this.uiData.multiTouchGesture=!1:this.uiData.multiTouchGesture=!0,setTimeout(this.checkMultitouch.bind(this),1,r)}touchEndListener(r){if(r.preventDefault(),this.uiData.touchdown=!1,this.uiData.lastTwoTouchDistance=0,this.uiData.multiTouchGesture=!1,this.uiData.touchTimer&&(clearTimeout(this.uiData.touchTimer),this.uiData.touchTimer=null),this.uiData.isDragging){this.uiData.isDragging=!1,this.getCurrentDragMode()===1&&(this.calculateNewRange(),this.refreshLayers(this.volumes[0],0));const e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),n=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);this.generateMouseUpCallback(e,n)}this.mouseUpListener()}windowingHandler(r,e,n=0){const i=this.uiData.windowX,a=this.uiData.windowY;let s=this.volumes[0].cal_min,o=this.volumes[0].cal_max;const l=this.volumes[0].global_min,u=this.volumes[0].global_max;e<a?(s+=1,o+=1):e>a&&(s-=1,o-=1),r>i?(s-=1,o+=1):r<i&&(s+=1,o-=1),o-s<1&&(o=s+1),s<l&&(s=l),o>u&&(o=u),s>o&&(s=o-1),this.volumes[n].cal_min=s,this.volumes[n].cal_max=o,this.refreshLayers(this.volumes[n],0),this.uiData.windowX=r,this.uiData.windowY=e}mouseLeaveListener(){this.clickToSegmentIsGrowing&&(Q.debug("Mouse left canvas, stopping clickToSegment preview."),this.clickToSegmentIsGrowing=!1,this.refreshDrawing(!0,!1)),this.opts.drawingEnabled&&!isNaN(this.drawPenLocation[0])&&(Q.debug("Mouse left canvas during drawing, resetting pen state."),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawPenFillPts=[]),this.opts.drawingEnabled&&!isNaN(this.drawShapeStartLocation[0])&&(Q.debug("Mouse left canvas during shape drawing, resetting shape state."),this.drawShapeStartLocation=[NaN,NaN,NaN],this.drawShapePreviewBitmap&&(this.drawBitmap=this.drawShapePreviewBitmap,this.drawShapePreviewBitmap=null,this.refreshDrawing(!0,!1))),this.uiData.isDragging&&(Q.debug("Mouse left canvas during drag, resetting drag state."),this.uiData.isDragging=!1,this.uiData.mouseButtonLeftDown=!1,this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonRightDown=!1,this.uiData.mousedown=!1,this.drawScene())}mouseMoveListener(r){if(this.uiData.mousedown){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(r,this.gl.canvas);if(!e)return;const n=e.x*this.uiData.dpr,i=e.y*this.uiData.dpr;if(this.tileIndex(n,i)!==this.uiData.clickedTile)return;const s=this.getCurrentDragMode();if(s===8){this.mouseMove(e.x,e.y),this.mouseClick(e.x,e.y),this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY;return}else if(s===9){this.windowingHandler(e.x,e.y),this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY;return}else this.setDragEnd(e.x,e.y);this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY}else if(this.getCurrentDragMode()===7&&this.uiData.angleState==="drawing_second_line"){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(r,this.gl.canvas);if(!e)return;this.setDragEnd(e.x,e.y),this.drawScene()}else if(!this.uiData.mousedown&&this.opts.clickToSegment){const e=this.getNoPaddingNoBorderCanvasRelativeMousePosition(r,this.gl.canvas);if(!e)return;const n=e.x*this.uiData.dpr,i=e.y*this.uiData.dpr;this.mousePos=[n,i];const a=this.tileIndex(n,i);a>=0&&this.opts.drawingEnabled&&this.screenSlices[a].axCorSag<=2&&(this.clickToSegmentXY=[n,i],this.clickToSegmentIsGrowing=!0,this.doClickToSegment({x:n,y:i,tileIndex:a}))}}resetBriCon(r=null){if(this.uiData.isDragging)return;let e=!1;this.opts.sliceType===4&&(e=!0);let n=0,i=0;if(r!==null&&("targetTouches"in r?(n=r.targetTouches[0].clientX-r.target.getBoundingClientRect().left,i=r.targetTouches[0].clientY-r.target.getBoundingClientRect().top):(n=r.offsetX,i=r.offsetY),n*=this.uiData.dpr,i*=this.uiData.dpr,this.inRenderTile(n,i)>=0&&(e=!0)),e){this.uiData.mouseDepthPicker=!0,this.drawScene(),this.drawScene();return}this.getCurrentDragMode()!==4&&(this.volumes.length<1||this.uiData.doubleTouch||(this.volumes[0].cal_min=this.volumes[0].robust_min,this.volumes[0].cal_max=this.volumes[0].robust_max,this.onIntensityChange(this.volumes[0]),this.refreshLayers(this.volumes[0],0),this.drawScene()))}setDragStart(r,e){r*=this.uiData.dpr,e*=this.uiData.dpr,this.uiData.dragStart[0]=r,this.uiData.dragStart[1]=e}setDragEnd(r,e){r*=this.uiData.dpr,e*=this.uiData.dpr,this.uiData.dragEnd[0]=r,this.uiData.dragEnd[1]=e}touchMoveListener(r){if(this.uiData.touchdown&&r.touches.length<2){const e=this.canvas.getBoundingClientRect();if(this.uiData.isDragging||(this.uiData.pan2DxyzmmAtMouseDown=hs(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.doubleTouch&&this.uiData.isDragging){this.setDragEnd(r.targetTouches[0].clientX-r.target.getBoundingClientRect().left,r.targetTouches[0].clientY-r.target.getBoundingClientRect().top),this.drawScene();return}const n=this.getTouchDragMode(!1);n===8?(this.mouseClick(r.touches[0].clientX-e.left,r.touches[0].clientY-e.top),this.mouseMove(r.touches[0].clientX-e.left,r.touches[0].clientY-e.top)):n===9&&(this.windowingHandler(r.touches[0].pageX,r.touches[0].pageY),this.drawScene())}else this.handlePinchZoom(r)}handlePinchZoom(r){if(r.targetTouches.length===2&&r.changedTouches.length===2){const e=Math.hypot(r.touches[0].pageX-r.touches[1].pageX,r.touches[0].pageY-r.touches[1].pageY),n=this.canvas.getBoundingClientRect();this.mousePos=[r.touches[0].clientX-n.left,r.touches[0].clientY-n.top],e<this.uiData.lastTwoTouchDistance?this.sliceScroll2D(-.01,r.touches[0].clientX-n.left,r.touches[0].clientY-n.top):this.sliceScroll2D(.01,r.touches[0].clientX-n.left,r.touches[0].clientY-n.top),this.uiData.lastTwoTouchDistance=e}}keyUpListener(r){if(r.code===this.opts.clipPlaneHotKey){const e=new Date().getTime();if(e-this.lastCalled>this.opts.keyDebounceTime){switch(this.currentClipPlaneIndex=(this.currentClipPlaneIndex+1)%7,this.currentClipPlaneIndex){case 0:this.scene.clipPlaneDepthAziElev=[2,0,0];break;case 1:this.scene.clipPlaneDepthAziElev=[0,270,0];break;case 2:this.scene.clipPlaneDepthAziElev=[0,90,0];break;case 3:this.scene.clipPlaneDepthAziElev=[0,0,0];break;case 4:this.scene.clipPlaneDepthAziElev=[0,180,0];break;case 5:this.scene.clipPlaneDepthAziElev=[0,0,-90];break;case 6:this.scene.clipPlaneDepthAziElev=[0,0,90];break}this.setClipPlane(this.scene.clipPlaneDepthAziElev)}this.lastCalled=e}else if(r.code===this.opts.viewModeHotKey){const e=new Date().getTime();e-this.lastCalled>this.opts.keyDebounceTime&&(this.setSliceType((this.opts.sliceType+1)%5),this.lastCalled=e)}}keyDownListener(r){r.code==="KeyH"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth-1,this.scene.renderElevation):r.code==="KeyL"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth+1,this.scene.renderElevation):r.code==="KeyJ"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation+1):r.code==="KeyK"&&this.opts.sliceType===4?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation-1):r.code==="KeyH"&&this.opts.sliceType!==4?this.moveCrosshairInVox(-1,0,0):r.code==="KeyL"&&this.opts.sliceType!==4?this.moveCrosshairInVox(1,0,0):r.code==="KeyU"&&this.opts.sliceType!==4&&r.ctrlKey?this.moveCrosshairInVox(0,0,1):r.code==="KeyD"&&this.opts.sliceType!==4&&r.ctrlKey?this.moveCrosshairInVox(0,0,-1):r.code==="KeyJ"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,-1,0):r.code==="KeyK"&&this.opts.sliceType!==4?this.moveCrosshairInVox(0,1,0):r.code==="KeyM"&&this.opts.sliceType!==4?(this.opts.dragMode++,this.opts.dragMode>=4&&(this.opts.dragMode=0),Q.info("drag mode changed to ",ET[this.opts.dragMode])):r.code==="ArrowLeft"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D-1):r.code==="ArrowRight"?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D+1):r.code==="Slash"&&r.shiftKey&&alert(`NIIVUE VERSION: ${IC}`)}wheelListener(r){if(this.thumbnailVisible||this.opts.sliceMosaicString.length>0)return;r.preventDefault(),r.stopPropagation();const e=this.uiData.dragStart.reduce((u,c)=>u+c,0),n=this.uiData.dragEnd.reduce((u,c)=>u+c,0),i=e>0&&n>0;if(this.getCurrentDragMode()===6&&i){const u=r.deltaY>0?1:-1;this.uiData.dragStart[0]<this.uiData.dragEnd[0]?(this.uiData.dragStart[0]-=u,this.uiData.dragEnd[0]+=u):(this.uiData.dragStart[0]+=u,this.uiData.dragEnd[0]-=u),this.uiData.dragStart[1]<this.uiData.dragEnd[1]?(this.uiData.dragStart[1]-=u,this.uiData.dragEnd[1]+=u):(this.uiData.dragStart[1]+=u,this.uiData.dragEnd[1]-=u),this.uiData.isDragging=!0,this.drawScene(),this.uiData.isDragging=!1;const c=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]);c>=0?this.generateMouseUpCallback(this.screenXY2TextureFrac(this.uiData.dragStart[0],this.uiData.dragStart[1],c),this.screenXY2TextureFrac(this.uiData.dragEnd[0],this.uiData.dragEnd[1],c)):Q.warn("Could not generate drag release callback for ROI selection: Invalid tile index.");return}let a=r.deltaY<0?-.01:.01;if(this.opts.invertScrollDirection&&(a=-a),this.opts.clickToSegment){a<0?(this.opts.clickToSegmentPercent-=.01,this.opts.clickToSegmentPercent=Math.max(this.opts.clickToSegmentPercent,0)):(this.opts.clickToSegmentPercent+=.01,this.opts.clickToSegmentPercent=Math.min(this.opts.clickToSegmentPercent,1));const u=this.clickToSegmentXY[0],c=this.clickToSegmentXY[1],h=this.tileIndex(u,c);h>=0&&this.screenSlices[h].axCorSag<=2&&(Q.debug(`Adjusting clickToSegment threshold: ${this.opts.clickToSegmentPercent.toFixed(3)}`),this.clickToSegmentIsGrowing=!0,this.doClickToSegment({x:u,y:c,tileIndex:h}));return}const s=this.canvas.getBoundingClientRect(),o=r.clientX-s.left,l=r.clientY-s.top;if(this.getCurrentDragMode()===3&&this.inRenderTile(this.uiData.dpr*o,this.uiData.dpr*l)===-1){const u=a<0?1:-1;let c=this.scene.pan2Dxyzmm[3]*(1+10*(.01*u));c=Math.round(c*10)/10;const h=this.scene.pan2Dxyzmm[3]-c;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=c),this.scene.pan2Dxyzmm[3]=c;const d=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=h*d[0],this.scene.pan2Dxyzmm[1]+=h*d[1],this.scene.pan2Dxyzmm[2]+=h*d[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.sliceScroll2D(a,o,l)}registerInteractions(){if(!this.canvas)throw new Error("canvas undefined");this.canvas.addEventListener("mousedown",this.mouseDownListener.bind(this)),this.canvas.addEventListener("mouseup",this.mouseUpListener.bind(this)),this.canvas.addEventListener("mousemove",this.mouseMoveListener.bind(this)),this.canvas.addEventListener("mouseleave",this.mouseLeaveListener.bind(this)),this.canvas.addEventListener("touchstart",this.touchStartListener.bind(this)),this.canvas.addEventListener("touchend",this.touchEndListener.bind(this)),this.canvas.addEventListener("touchmove",this.touchMoveListener.bind(this)),this.canvas.addEventListener("wheel",this.wheelListener.bind(this)),this.canvas.addEventListener("contextmenu",this.mouseContextMenuListener.bind(this)),this.canvas.addEventListener("dblclick",this.resetBriCon.bind(this)),this.canvas.addEventListener("dragenter",this.dragEnterListener.bind(this),!1),this.canvas.addEventListener("dragover",this.dragOverListener.bind(this),!1),this.canvas.addEventListener("drop",r=>{this.dropListener(r).catch(console.error)},!1),this.canvas.setAttribute("tabindex","0"),this.canvas.addEventListener("keyup",this.keyUpListener.bind(this),!1),this.canvas.addEventListener("keydown",this.keyDownListener.bind(this),!1)}dragEnterListener(r){r.stopPropagation(),r.preventDefault()}dragOverListener(r){r.stopPropagation(),r.preventDefault()}getFileExt(r,e=!0){Q.debug("fullname: ",r);const n=/(?:\.([^.]+))?$/;let i=n.exec(r)[1];if(i=i.toUpperCase(),i==="GZ")i=n.exec(r.slice(0,-3))[1],i=i.toUpperCase();else if(i==="CBOR"){const a=i;i=n.exec(r.slice(0,-5))[1],i=i.toUpperCase(),i=`${i}.${a}`}return e?i:i.toLowerCase()}async addVolumeFromUrl(r){const e=await gn.loadFromUrl(r);return this.document.addImageOptions(e,r),e.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(e,r.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(r,e),this.addVolume(e),e}async addVolumesFromUrl(r){const e=r.map(async i=>{const a=this.getFileExt(i.name||i.url);if(a==="DCM")throw new Error("DICOM files must be loaded using useDicomLoader");if(this.loaders[a]){let l=i.url;const u=this.loaders[a].toExt;let c=i.name||i.url;if(c=c.split("/").pop(),typeof i.url=="string"){const d=i.url;try{const v=await fetch(d);if(!v.ok)throw new Error(`Failed to load file: ${v.statusText}`);l=await v.arrayBuffer()}catch(v){throw new Error(`Failed to load url ${d}: ${v}`)}}const h=await this.loaders[a].loader(l);i.url=h,i.name=`${c}.${u}`}const s={url:i.url,headers:i.headers,name:i.name,colormap:i.colormap?i.colormap:i.colorMap,colormapNegative:i.colormapNegative?i.colormapNegative:i.colorMapNegative,opacity:i.opacity,urlImgData:i.urlImgData,cal_min:i.cal_min,cal_max:i.cal_max,trustCalMinMax:this.opts.trustCalMinMax,isManifest:i.isManifest,frame4D:i.frame4D,limitFrames4D:i.limitFrames4D||this.opts.limitFrames4D,colorbarVisible:i.colorbarVisible},o=await gn.loadFromUrl(s);return this.document.addImageOptions(o,s),o.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(o,s.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(s,o),o}),n=await Promise.all(e);for(let i=0;i<n.length;i++)this.addVolume(n[i]);return n}getMediaByUrl(r){return[...this.mediaUrlMap.entries()].filter(e=>e[1]===r).map(e=>e[0]).pop()}removeVolumeByUrl(r){const e=this.getMediaByUrl(r);if(e)this.removeVolume(e);else throw new Error("No volume with URL present")}async traverseFileTree(r,e="",n){return new Promise(i=>{if(r.isFile)r.file(a=>{a.fullPath=e+a.name,a._webkitRelativePath=e+a.name,n.push(a),i(n)});else if(r.isDirectory){const a=r.createReader(),s=()=>{a.readEntries(o=>{if(o.length>0){const l=[];for(const u of o)l.push(this.traverseFileTree(u,e+r.name+"/",n));Promise.all(l).then(s).catch(u=>{throw u})}else i(n)})};s()}})}readDirectory(r){const e=r.createReader();let n=[];const i=async s=>{const o=[],l=async u=>new Promise((c,h)=>u.file(c,h));for(let u=0;u<s.length;u++)o.push(await l(s[u]));return o},a=()=>{e.readEntries(s=>{s.length?(n=n.concat(s),a()):i(n).then(async()=>{}).catch(o=>{throw o})})};return a(),n}isMeshExt(r){const e=this.getFileExt(r);return Q.debug("dropped ext"),Q.debug(e),Ws.includes(e)}async loadFromArrayBuffer(r,e){const n=this.getFileExt(e);if(Ws.includes(n)){await this.addMeshFromUrl({url:e,buffer:r});return}const i=Ud(e);i.buffer=r,i.name=e,await this.addVolumeFromUrl(i)}async loadFromFile(r){const e=this.getFileExt(r.name);if(Ws.includes(e)){await Sl.loadFromFile({file:r,gl:this.gl,name:r.name}).then(n=>{this.addMesh(n)});return}await gn.loadFromFile({file:r,name:r.name}).then(n=>{this.addVolume(n)})}useLoader(r,e,n){this.loaders={...this.loaders,[e.toUpperCase()]:{loader:r,toExt:n}}}useDicomLoader(r){this.dicomLoader=r}getDicomLoader(){return this.dicomLoader}async dropListener(r){if(r.stopPropagation(),r.preventDefault(),!this.opts.dragAndDropEnabled)return;const e=[],n=r.dataTransfer;if(!n)return;const i=n.getData("text/uri-list");if(i){const a=Ud(i),s=this.getFileExt(i);Q.debug("dropped ext"),Q.debug(s),Ws.includes(s)?this.addMeshFromUrl({url:i}).catch(o=>{throw o}):s==="NVD"?this.loadDocumentFromUrl(i).catch(o=>{throw o}):this.addVolumeFromUrl(a).catch(o=>{throw o})}else{const a=n.items;if(a.length>0){!r.shiftKey&&!r.altKey&&(this.volumes=[],this.overlays=[],this.meshes=[]),this.closeDrawing(),this.closePAQD();for(const s of Array.from(a)){const o=s.webkitGetAsEntry();if(Q.debug(o),!o)throw new Error("could not get entry from file");if(o.isFile){const l=this.getFileExt(o.name);let u;if(o.name.lastIndexOf("HEAD")!==-1)for(const c of Array.from(a)){const h=c.webkitGetAsEntry();if(!h)throw new Error("could not get paired entry");const d=o.name.substring(0,o.name.lastIndexOf("HEAD")),v=h.name.substring(0,h.name.lastIndexOf("BRIK"));d===v&&(u=h)}if(o.name.lastIndexOf("BRIK")!==-1)continue;if(this.loaders[l]){const c=await rH(o);await this.loadImages([{url:c,name:`${o.name}`}]);continue}if(Ws.includes(l)){o.file(c=>{(async()=>{try{const h=await Sl.loadFromFile({file:c,gl:this.gl,name:c.name});this.addMesh(h)}catch(h){console.error("Error loading mesh:",h)}})().catch(h=>console.error(h))});continue}else if(l==="NVD"){o.file(c=>{(async()=>{try{const h=await Jm.loadFromFile(c);await this.loadDocument(h),Q.debug("loaded document")}catch(h){console.error(h)}})().catch(h=>console.error(h))});break}o.file(c=>{(async()=>{try{if(u)u.file(h=>{(async()=>{try{const d=await gn.loadFromFile({file:c,urlImgData:h,limitFrames4D:this.opts.limitFrames4D});this.addVolume(d)}catch(d){console.error(d)}})().catch(console.error)});else{const h=await gn.loadFromFile({file:c,urlImgData:u,limitFrames4D:this.opts.limitFrames4D});r.altKey?(Q.debug("alt key detected: assuming this is a drawing overlay"),this.drawClearAllUndoBitmaps(),this.loadDrawing(h)):this.addVolume(h)}}catch(h){console.error(h)}})().catch(console.error)})}else o.isDirectory&&this.traverseFileTree(o,"",e).then(l=>{const u=this.getDicomLoader().loader;if(!u)throw new Error("No loader for DICOM files");u(l).then(async c=>{const h=c.map(d=>gn.loadFromUrl({url:d.data,name:d.name,limitFrames4D:this.opts.limitFrames4D}));Promise.all(h).then(async d=>{await this.onDicomLoaderFinishedWithImages(d)}).catch(d=>{throw d})}).catch(c=>{console.error("Error loading DICOM files:",c)})}).catch(l=>{throw l})}}}this.drawScene()}setMultiplanarPadPixels(r){this.opts.multiplanarPadPixels=r,this.drawScene()}setMultiplanarLayout(r){typeof r=="string"&&(r=parseInt(r)),this.opts.multiplanarLayout=r,this.drawScene()}setCornerOrientationText(r){this.opts.isCornerOrientationText=r,this.updateGLVolume()}setIsOrientationTextVisible(r){this.opts.isOrientationTextVisible=r,this.drawScene()}setShowAllOrientationMarkers(r){this.opts.showAllOrientationMarkers=r,this.drawScene()}setHeroImage(r){this.opts.heroImageFraction=r,this.drawScene()}setCustomLayout(r){for(let e=0;e<r.length;e++){const[n,i,a,s]=r[e].position,o=n+a,l=i+s;for(let u=e+1;u<r.length;u++){const[c,h,d,v]=r[u].position,m=c+d,y=h+v,b=n<m&&o>c,x=i<y&&l>h;if(b&&x)throw new Error(`Custom layout is invalid. Tile ${e} overlaps with tile ${u}.`)}}this.customLayout=r,this.drawScene()}clearCustomLayout(){this.customLayout=null,this.drawScene()}getCustomLayout(){return this.customLayout}setRadiologicalConvention(r){this.opts.isRadiologicalConvention=r,this.updateGLVolume()}setDefaults(r={},e=!1){this.document.opts={...xi},this.scene.sceneData={...Cc};for(const n in r)typeof r[n]=="function"?this[n]=r[n]:this.opts[n]=xi[n]===void 0?xi[n]:r[n];if(this.scene.pan2Dxyzmm=[0,0,0,1],e&&this.volumes&&this.volumes.length>0)for(let n=0;n<this.volumes.length;n++)this.volumes[n].cal_min=this.volumes[n].robust_min,this.volumes[n].cal_max=this.volumes[n].robust_max;this.updateGLVolume()}setMeshThicknessOn2D(r){this.opts.meshThicknessOn2D=r,this.updateGLVolume()}setSliceMosaicString(r){this.sliceMosaicString=r,this.updateGLVolume()}setSliceMM(r){this.opts.isSliceMM=r,this.updateGLVolume()}setAdditiveBlend(r){this.opts.isAdditiveBlend=r,this.updateGLVolume()}getRadiologicalConvention(){return this.opts.isRadiologicalConvention}setHighResolutionCapable(r){typeof r=="boolean"&&(r=r?0:-1),this.opts.forceDevicePixelRatio=r,this.resizeListener(),this.drawScene()}watchOptsChanges(r){this.onOptsChange=r}unwatchOptsChanges(){this.onOptsChange=()=>{}}addVolume(r){this.volumes.push(r);const e=this.volumes.length===1?0:this.volumes.length-1;this.setVolume(r,e),this.onImageLoaded(r),Q.debug("loaded volume",r.name),Q.debug(r)}addMesh(r){this.meshes.push(r);const e=this.meshes.length===1?0:this.meshes.length-1;this.setMesh(r,e),this.onMeshLoaded(r)}getVolumeIndexByID(r){const e=this.volumes.length;for(let n=0;n<e;n++)if(this.volumes[n].id===r)return n;return-1}drawAddUndoBitmap(r=!0){if(!this.drawBitmap||this.drawBitmap.length<1){Q.debug("drawAddUndoBitmap error: No drawing open");return}if(!r&&this.drawUndoBitmaps.length>0){const e=this.drawBitmap.length,n=i2(this.drawUndoBitmaps[this.currentDrawUndoBitmap],e);for(let i=0;i<e;i++)n[i]>0&&(this.drawBitmap[i]=n[i]);this.refreshDrawing(!1)}this.currentDrawUndoBitmap++,this.currentDrawUndoBitmap>=this.opts.maxDrawUndoBitmaps&&(this.currentDrawUndoBitmap=0),this.drawUndoBitmaps[this.currentDrawUndoBitmap]=WG(this.drawBitmap)}drawClearAllUndoBitmaps(){if(this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,!(!this.drawUndoBitmaps||this.drawUndoBitmaps.length<1))for(let r=this.drawUndoBitmaps.length-1;r>=0;r--)this.drawUndoBitmaps[r]=new Uint8Array}drawUndo(){const{drawBitmap:r,currentDrawUndoBitmap:e}=ZG({drawUndoBitmaps:this.drawUndoBitmaps,currentDrawUndoBitmap:this.currentDrawUndoBitmap,drawBitmap:this.drawBitmap});this.drawBitmap=r,this.currentDrawUndoBitmap=e,this.refreshDrawing(!0)}loadDrawing(r){if(this.drawBitmap&&Q.debug("Overwriting open drawing!"),!this.back)throw new Error("back undefined");this.drawClearAllUndoBitmaps();const e=r.hdr.dims;if(e[1]!==this.back.hdr.dims[1]||e[2]!==this.back.hdr.dims[2]||e[3]!==this.back.hdr.dims[3])return Q.debug("drawing dimensions do not match background image"),!1;r.img.constructor!==Uint8Array&&Q.debug("Drawings should be UINT8");const n=r.permRAS,i=e[1]*e[2]*e[3];this.drawBitmap=new Uint8Array(i),this.opts.is2DSliceShader?this.drawTexture=this.r8Tex2D(this.drawTexture,is,this.back.dims,!0):this.drawTexture=this.r8Tex(this.drawTexture,is,this.back.dims,!0);const a=[0,0,0];for(let y=0;y<3;y++)for(let b=0;b<3;b++)Math.abs(n[y])-1===b&&(a[b]=y*Math.sign(n[y]));let s=1;const o=[1,1,1],l=[!1,!1,!1];for(let y=0;y<a.length;y++)for(let b=0;b<a.length;b++)Math.abs(a[b])===y&&(o[b]=s,(a[b]<0||Object.is(a[b],-0))&&(l[b]=!0),s*=e[b+1]);let u=Oe.range(0,e[1]-1,1);l[0]&&(u=Oe.range(e[1]-1,0,-1));for(let y=0;y<e[1];y++)u[y]*=o[0];let c=Oe.range(0,e[2]-1,1);l[1]&&(c=Oe.range(e[2]-1,0,-1));for(let y=0;y<e[2];y++)c[y]*=o[1];let h=Oe.range(0,e[3]-1,1);l[2]&&(h=Oe.range(e[3]-1,0,-1));for(let y=0;y<e[3];y++)h[y]*=o[2];const d=r.img,v=this.drawBitmap;let m=0;for(let y=0;y<e[3];y++)for(let b=0;b<e[2];b++)for(let x=0;x<e[1];x++)v[u[x]+c[b]+h[y]]=d[m],m++;return this.drawAddUndoBitmap(),this.refreshDrawing(!1),this.drawScene(),!0}binarize(r){const e=r.hdr.dims,n=e[1]*e[2]*e[3],i=new Uint8Array(n);for(let a=0;a<n;a++)r.img[a]!==0&&(i[a]=1);r.img=i,r.hdr.datatypeCode=2,r.hdr.cal_min=0,r.hdr.cal_max=1}async loadDrawingFromUrl(r,e=!1){this.drawBitmap&&Q.debug("Overwriting open drawing!"),this.drawClearAllUndoBitmaps();let n=!1;try{const i=await gn.loadFromUrl(Ud(r));e&&await this.binarize(i),n=this.loadDrawing(i)}catch{Q.error("loadDrawingFromUrl() failed to load "+r),this.drawClearAllUndoBitmaps()}return n}findOtsu(r=2){if(this.volumes.length<1)return[];const e=this.volumes[0].img,n=e.length;if(n<1)return[];const i=256,a=i-1,s=new Array(i).fill(0),o=this.volumes[0].cal_min,l=this.volumes[0].cal_max;if(l<=o)return[];const u=(l-o)/i;function c(A){return A*u+o}const h=(i-1)/Math.abs(l-o),d=this.volumes[0].hdr.scl_inter,v=this.volumes[0].hdr.scl_slope;for(let A=0;A<n;A++){let C=e[A]*v+d;C=Math.min(Math.max(C,o),l),C=Math.round((C-o)*h),s[C]++}const m=Array(i).fill(0).map(()=>Array(i).fill(0)),y=Array(i).fill(0).map(()=>Array(i).fill(0));for(let A=1;A<i;++A)m[A][A]=s[A],y[A][A]=A*s[A];for(let A=1;A<i-1;++A)m[1][A+1]=m[1][A]+s[A+1],y[1][A+1]=y[1][A]+(A+1)*s[A+1];for(let A=2;A<i;A++)for(let C=A+1;C<i;C++)m[A][C]=m[1][C]-m[1][A-1],y[A][C]=y[1][C]-y[1][A-1];for(let A=1;A<i;++A)for(let C=A+1;C<i;C++)m[A][C]!==0&&(m[A][C]=y[A][C]*y[A][C]/m[A][C]);let b=0;const x=[1/0,1/0,1/0];if(r>3)for(let A=0;A<i-3;A++)for(let C=A+1;C<i-2;C++)for(let E=C+1;E<i-1;E++){const S=m[0][A]+m[A+1][C]+m[C+1][E]+m[E+1][a];S>b&&(x[0]=A,x[1]=C,x[2]=E,b=S)}else if(r===3)for(let A=0;A<i-2;A++)for(let C=A+1;C<i-1;C++){const E=m[0][A]+m[A+1][C]+m[C+1][a];E>b&&(x[0]=A,x[1]=C,b=E)}else for(let A=0;A<i-1;A++){const C=m[0][A]+m[A+1][a];C>b&&(x[0]=A,b=C)}return[c(x[0]),c(x[1]),c(x[2])]}drawOtsu(r=2){if(this.volumes.length===0)return;const e=this.volumes[0].img.length,n=this.findOtsu(r);if(n.length<3)return;this.drawBitmap||this.createEmptyDrawing();const i=this.drawBitmap,a=this.volumes[0].img;for(let s=0;s<e;s++){if(i[s]!==0)continue;const o=a[s];o>n[0]&&(i[s]=1),o>n[1]&&(i[s]=2),o>n[2]&&(i[s]=3)}this.drawAddUndoBitmap(),this.refreshDrawing(!0)}removeHaze(r=5,e=0){const n=this.volumes[e].img,i=this.volumes[e].hdr,a=n.length;let s=2;(r===5||r===1)&&(s=4),(r===4||r===2)&&(s=3);const o=this.findOtsu(s);if(o.length<3)return;let l=o[0];r===1&&(l=o[2]),r===2&&(l=o[1]);const u=i.scl_inter,c=i.scl_slope,h=this.volumes[e].global_min;for(let d=0;d<a;d++)n[d]*c+u<l&&(n[d]=h);this.refreshLayers(this.volumes[e],0),this.drawScene()}async saveImage(r=UC){const e={...UC,...r},{filename:n,isSaveDrawing:i,volumeByIndex:a}=e;if(Q.debug("saveImage",n,i,a),this.back?.dims===void 0)return Q.debug("No voxelwise image open"),!1;if(i){if(!this.drawBitmap)return Q.debug("No drawing open"),!1;const o=this.volumes[0].permRAS;if(o[0]===1&&o[1]===2&&o[2]===3)return Q.debug("saving drawing"),await this.volumes[0].saveToDisk(n,this.drawBitmap);{Q.debug("saving drawing");const l=this.volumes[0].hdr.dims,u=[0,0,0];for(let E=0;E<3;E++)for(let S=0;S<3;S++)Math.abs(o[E])-1===S&&(u[S]=E*Math.sign(o[E]));let c=1;const h=[1,1,1],d=[!1,!1,!1];for(let E=0;E<u.length;E++)for(let S=0;S<u.length;S++)Math.abs(u[S])===E&&(h[S]=c,(u[S]<0||Object.is(u[S],-0))&&(d[S]=!0),c*=l[S+1]);let v=Oe.range(0,l[1]-1,1);d[0]&&(v=Oe.range(l[1]-1,0,-1));for(let E=0;E<l[1];E++)v[E]*=h[0];let m=Oe.range(0,l[2]-1,1);d[1]&&(m=Oe.range(l[2]-1,0,-1));for(let E=0;E<l[2];E++)m[E]*=h[1];let y=Oe.range(0,l[3]-1,1);d[2]&&(y=Oe.range(l[3]-1,0,-1));for(let E=0;E<l[3];E++)y[E]*=h[2];const b=new Uint8Array(this.drawBitmap),x=new Uint8Array(l[1]*l[2]*l[3]);let A=0;for(let E=0;E<l[3];E++)for(let S=0;S<l[2];S++)for(let T=0;T<l[1];T++)x[A]=b[v[T]+m[S]+y[E]],A++;return Q.debug("saving drawing"),this.volumes[0].saveToDisk(n,x)}}return Q.debug("saving image"),this.volumes[a].saveToDisk(n)}getMeshIndexByID(r){if(typeof r=="number")return r>=this.meshes.length?-1:r;const e=this.meshes.length;for(let n=0;n<e;n++)if(this.meshes[n].id===r)return n;return-1}setMeshProperty(r,e,n){const i=this.getMeshIndexByID(r);if(i<0){Q.warn("setMeshProperty() id not loaded",r);return}this.meshes[i].setProperty(e,n,this.gl),this.updateGLVolume(),this.onMeshPropertyChanged(i,e,n)}indexNearestXYZmm(r,e,n,i){const a=this.getMeshIndexByID(r);return a<0?(Q.warn("indexNearestXYZmm() id not loaded",r),[NaN,NaN]):this.meshes[a].indexNearestXYZmm(e,n,i)}decimateHierarchicalMesh(r,e=3){const n=this.getMeshIndexByID(r);if(n<0){Q.warn("reverseFaces() id not loaded",r);return}const i=this.meshes[n].decimateHierarchicalMesh(this.gl,e);return this.updateGLVolume(),i}reverseFaces(r){const e=this.getMeshIndexByID(r);if(e<0){Q.warn("reverseFaces() id not loaded",r);return}this.meshes[e].reverseFaces(this.gl),this.updateGLVolume()}async setMeshLayerProperty(r,e,n,i){const a=this.getMeshIndexByID(r);if(a<0){Q.warn("setMeshLayerProperty() id not loaded",r);return}await this.meshes[a].setLayerProperty(e,n,i,this.gl),this.updateGLVolume()}setPan2Dxyzmm(r){this.scene.pan2Dxyzmm=r,this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=r[3]),this.drawScene()}setRenderAzimuthElevation(r,e){this.scene.renderAzimuth=r,this.scene.renderElevation=e,this.onAzimuthElevationChange(r,e),this.drawScene()}getOverlayIndexByID(r){const e=this.overlays.length;for(let n=0;n<e;n++)if(this.overlays[n].id===r)return n;return-1}setVolume(r,e=0){const n=this.volumes.length;if(e>n)return;const i=this.getVolumeIndexByID(r.id);e===0?(this.volumes.splice(i,1),this.volumes.unshift(r),this.back=this.volumes[0],this.overlays=this.volumes.slice(1)):e<0?(this.volumes.splice(this.getVolumeIndexByID(r.id),1),this.back=this.volumes[0],this.volumes.length>1?this.overlays=this.volumes.slice(1):this.overlays=[]):(this.volumes.splice(i,1),this.volumes.splice(e,0,r),this.overlays=this.volumes.slice(1),this.back=this.volumes[0]),this.updateGLVolume()}setMesh(r,e=0){this.meshes.forEach(a=>{Q.debug("MESH: ",a.name)});const n=this.meshes.length;if(e>n)return;const i=this.getMeshIndexByID(r.id);e===0?(this.meshes.splice(i,1),this.meshes.unshift(r)):e<0?this.meshes.splice(this.getMeshIndexByID(r.id),1):(this.meshes.splice(i,1),this.meshes.splice(e,0,r)),this.updateGLVolume(),this.meshes.forEach(a=>{Q.debug(a.name)})}removeVolume(r){if(this.setVolume(r,-1),this.mediaUrlMap.has(r)){const e=this.mediaUrlMap.get(r);this.onVolumeWithUrlRemoved(e),this.mediaUrlMap.delete(r)}this.drawScene()}removeVolumeByIndex(r){if(r>=this.volumes.length)throw new Error("Index of volume out of bounds");this.removeVolume(this.volumes[r])}removeMesh(r){if(r.unloadMesh(this.gl),this.setMesh(r,-1),this.mediaUrlMap.has(r)){const e=this.mediaUrlMap.get(r);this.onMeshWithUrlRemoved(e),this.mediaUrlMap.delete(r)}}removeMeshByUrl(r){const e=this.getMediaByUrl(r);e&&(this.removeMesh(e),this.mediaUrlMap.delete(e),this.onMeshWithUrlRemoved(r))}moveVolumeToBottom(r){this.setVolume(r,0)}moveVolumeUp(r){const e=this.getVolumeIndexByID(r.id);this.setVolume(r,e+1)}moveVolumeDown(r){const e=this.getVolumeIndexByID(r.id);this.setVolume(r,e-1)}moveVolumeToTop(r){this.setVolume(r,this.volumes.length-1)}mouseDown(r,e){r*=this.uiData.dpr,e*=this.uiData.dpr,this.mousePos=[r,e]}mouseMove(r,e){r*=this.uiData.dpr,e*=this.uiData.dpr;const n=(r-this.mousePos[0])/this.uiData.dpr,i=(e-this.mousePos[1])/this.uiData.dpr;this.mousePos=[r,e],!(this.inRenderTile(r,e)<0)&&(Math.abs(n)<1&&Math.abs(i)<1||(this.scene.renderAzimuth+=n,this.scene.renderElevation+=i,this.drawScene()))}sph2cartDeg(r,e){const n=-e*(Math.PI/180),i=(r-90)%360*(Math.PI/180),a=[Math.cos(n)*Math.cos(i),Math.cos(n)*Math.sin(i),Math.sin(n)],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return s<=0||(a[0]/=s,a[1]/=s,a[2]/=s),a}setClipPlane(r){const e=this.sph2cartDeg(r[1]+180,r[2]);this.scene.clipPlane=[e[0],e[1],e[2],r[0]],this.scene.clipPlaneDepthAziElev=r,this.onClipPlaneChange(this.scene.clipPlane),this.drawScene()}setCrosshairColor(r){this.opts.crosshairColor=r,this.drawScene()}setCrosshairWidth(r){this.opts.crosshairWidth=r,this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN),this.drawScene()}setDrawColormap(r){this.drawLut=Vt.makeDrawLut(r),this.updateGLVolume()}setDrawingEnabled(r){this.opts.drawingEnabled=r,this.opts.drawingEnabled?this.drawBitmap||this.createEmptyDrawing():(this.clickToSegmentIsGrowing&&(this.clickToSegmentIsGrowing=!1,this.refreshDrawing(!0,!1)),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.drawPenFillPts=[],this.drawShapeStartLocation=[NaN,NaN,NaN],this.drawShapePreviewBitmap&&(this.drawBitmap=this.drawShapePreviewBitmap,this.drawShapePreviewBitmap=null)),this.drawScene()}setPenValue(r,e=!1){this.opts.penValue=r,this.opts.isFilledPen=e,this.drawScene()}setDrawOpacity(r){this.drawOpacity=r,this.drawScene()}setSelectionBoxColor(r){this.opts.selectionBoxColor=r}sliceScroll2D(r,e,n,i=!0){if(this.opts.scrollRequiresFocus&&this.canvas!==document.activeElement){Q.warn("Canvas element does not have focus. Scroll events will not be processed.");return}if(this.inGraphTile(e,n)){let a=this.volumes[0].frame4D;r>0&&a++,r<0&&a--,this.setFrame4D(this.volumes[0].id,a);return}if(r!==0&&this.opts.dragMode===3&&this.inRenderTile(this.uiData.dpr*e,this.uiData.dpr*n)===-1){let a=this.scene.pan2Dxyzmm[3]*(1+10*r);a=Math.round(a*10)/10;const s=this.scene.pan2Dxyzmm[3]-a;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=a),this.scene.pan2Dxyzmm[3]=a;const o=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=s*o[0],this.scene.pan2Dxyzmm[1]+=s*o[1],this.scene.pan2Dxyzmm[2]+=s*o[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.mouseClick(e,n,r,i)}setSliceType(r){return this.opts.sliceType=r,this.drawScene(),this}setOpacity(r,e){this.volumes[r].opacity=e,this.updateGLVolume()}setScale(r){this.scene.volScaleMultiplier=r,this.drawScene()}setClipPlaneColor(r){this.opts.clipPlaneColor=r,this.renderShader.use(this.gl),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.drawScene()}setClipPlaneThick(r){this.opts.clipThick=r,this.renderShader.use(this.gl),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.drawScene()}setClipVolume(r,e){this.opts.clipVolumeLow=[Math.min(r[0],e[0]),Math.min(r[1],e[1]),Math.min(r[2],e[2])],this.opts.clipVolumeHigh=[Math.max(r[0],e[0]),Math.max(r[1],e[1]),Math.max(r[2],e[2])],this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.pickingImageShader.use(this.gl),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.drawScene()}async setVolumeRenderIllumination(r=0){this.renderGradientValues=Number.isNaN(r),this.renderShader=this.renderVolumeShader,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:(this.opts.gradientAmount=r,r>0||this.opts.gradientOpacity>0?this.renderShader=this.renderGradientShader:r<0&&(this.renderShader=this.renderSliceShader)),await this.refreshLayers(this.volumes[0],0),this.initRenderShader(this.renderShader,r),this.renderShader.use(this.gl),this.setClipPlaneColor(this.opts.clipPlaneColor),Number.isNaN(r)?this.gradientTextureAmount=1:this.gradientTextureAmount=r,!(this.volumes.length<1)&&this.drawScene()}async setGradientOpacity(r=0,e=0){this.opts.gradientOpacity=r,this.opts.renderSilhouette=e,this.renderGradientValues?this.renderShader=this.renderGradientValuesShader:this.gradientTextureAmount>0||r>0?this.renderShader=this.renderGradientShader:this.gradientTextureAmount<0&&(this.renderShader=this.renderSliceShader),this.initRenderShader(this.renderShader,this.gradientTextureAmount),this.renderShader.use(this.gl),this.gradientTextureAmount>0&&this.refreshLayers(this.volumes[0],0),this.drawScene()}overlayRGBA(r){const e=r.hdr,n=e.dims[1]*e.dims[2]*e.dims[3],i=new Uint8ClampedArray(n*4),a=.2*Math.min(Math.min(e.dims[1],e.dims[2]),e.dims[3]),s=.5*e.dims[1],o=.5*e.dims[2],l=.5*e.dims[3];let u=0;for(let c=0;c<e.dims[3];c++)for(let h=0;h<e.dims[2];h++)for(let d=0;d<e.dims[1];d++){const v=Math.abs(d-s),m=Math.abs(h-o),y=Math.abs(c-l),b=Math.sqrt(v*v+m*m+y*y);let x=0;b<a&&(x=255),i[u++]=0,i[u++]=x,i[u++]=0,i[u++]=x*.5}return i}vox2mm(r,e){return Oe.vox2mm(r,e)}cloneVolume(r){return this.volumes[r].clone()}async loadDocumentFromUrl(r){const e=await Jm.loadFromUrl(r);await this.loadDocument(e)}async loadDocument(r){this.volumes=[],this.meshes=[],this.document=r,this.document.labels=this.document.labels?this.document.labels:[];const e={...xi,...r.opts};this.scene.pan2Dxyzmm=r.scene.pan2Dxyzmm?r.scene.pan2Dxyzmm:[0,0,0,1],this.document.opts=e,this.setClipPlane(this.scene.clipPlaneDepthAziElev),Q.debug("load document",r),this.mediaUrlMap.clear(),this.createEmptyDrawing();const n=r.encodedImageBlobs;for(let a=0;a<r.imageOptionsArray.length;a++){const s=r.imageOptionsArray[a],o=n[a];if(o){"colorMap"in s&&(s.colormap=s.colorMap);const l=await gn.loadFromBase64({base64:o,...s});if(l){if(l.colormapLabel){const u=Object.keys(l.colormapLabel.lut).length,c=new Uint8ClampedArray(u);for(const h in l.colormapLabel.lut)c[h]=l.colormapLabel.lut[h];l.colormapLabel.lut=c}this.addVolume(l)}}}this.volumes.length>0&&(this.back=this.volumes[0]);for(const a of r.meshDataObjects??[]){const s={gl:this.gl,...a};a.offsetPt0&&(s.rgba255[3]=0,s.tris=new Uint32Array(a.offsetPt0)),Q.debug(s);const o=new Sl(s.pts,s.tris,s.name,s.rgba255,s.opacity,s.visible,this.gl,s.connectome,s.dpg,s.dps,s.dpv);a.offsetPt0&&(o.fiberGroupColormap=a.fiberGroupColormap,o.fiberColor=a.fiberColor,o.fiberDither=a.fiberDither,o.fiberRadius=a.fiberRadius,o.colormap=a.colormap),o.meshShaderIndex=s.meshShaderIndex,o.layers=s.layers,o.updateMesh(this.gl),Q.debug(o),this.addMesh(o)}if(r.data.connectomes)for(const a of r.data.connectomes){const s=JSON.parse(a),o=this.loadConnectomeAsMesh(s);o.updateMesh(this.gl),this.addMesh(o)}this.createEmptyDrawing();const i=r.encodedDrawingBlob;if(i){const a=await Oe.b64toUint8(i);if(a){const s=this.back.dims;let o=s[1]*s[2]*s[3];if(a.length-352===o&&(o+=352),a.length!==o)throw new Error(`drawBitmap size does not match the texture dimensions (${s[1]}×${s[2]}×${s[3]}) ${o} != ${s[1]*s[2]*s[3]}.`);this.drawBitmap=a,this.refreshDrawing()}}return await this.setGradientOpacity(this.opts.gradientOpacity),await this.setVolumeRenderIllumination(this.opts.gradientAmount),this.updateGLVolume(),this.drawScene(),this.onDocumentLoaded(r),this}async generateLoadDocumentJavaScript(r,e){const n=this.json(),i=await Oe.compressToBase64String(JSON.stringify(n));return`
        ${e}

        async function saveNiivueAsHtml(pageName) {
          //get new docstring
          const docString = nv1.json();
          const html =
          document.getElementsByTagName("html")[0]
              .innerHTML.replace(base64, await NVUtilities.compressToBase64String(JSON.stringify(docString)));
          NVUtilities.download(html, pageName, "application/html");
        }

        var nv1 = new Niivue();
        await nv1.attachTo("${r}");
        var base64 = "${i}";
        NVUtilities.decompressBase64String(base64).then((jsonText) => {
          var json = JSON.parse(jsonText); // string -> JSON
          var doc = NVDocument.loadFromJSON(json);
          nv1.loadDocument(doc);
          nv1.updateGLVolume();
        });

      `}async generateHTML(r="gl1",e){return`<!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="utf-8" />
            <meta http-equiv="X-UA-Compatible" content="IE=edge" />
            <meta name="viewport" content="width=device-width,initial-scale=1.0" />
            <title>Save as HTML</title>
            <style>
            html {
              height: auto;
              min-height: 100%;
              margin: 0;
            }
            body {
              display: flex;
              flex-direction: column;
              margin: 0;
              min-height: 100%;
              width: 100%;
              position: absolute;
              font-family: system-ui, Arial, Helvetica, sans-serif;
              background: #ffffff;
              color: black;
              user-select: none; /* Standard syntax */
            }
            header {
              margin: 10px;
            }
            main {
              flex: 1;
              background: #000000;
              position: relative;
            }
            footer {
              margin: 10px;
            }
            canvas {
              position: absolute;
              cursor: crosshair;
            }
            canvas:focus {
              outline: 0px;
            }
            div {
              display: table-row;
              background-color: blue;
            }
            </style>
          </head>
          <body>
            <noscript>niivue requires JavaScript.</noscript>
            <header>
            Save the current scene as HTML
            <button id="save">Save as HTML</button>
            </header>
            <main>
              <canvas id="gl1"></canvas>
            </main>
            <script type="module" async>
              ${await this.generateLoadDocumentJavaScript(r,e)}
              function saveAsHtml() {
                saveNiivueAsHtml("page.html");
              }
              // assign our event handler
              var button = document.getElementById("save");
              button.onclick = saveAsHtml;
            <\/script>
          </body>
        </html>`}async saveHTML(r="untitled.html",e="gl1",n){const i=await this.generateHTML(e,n);return Oe.download(i,r,"application/html")}json(){return this.document.opts=this.opts,this.document.scene=this.scene,this.document.volumes=this.volumes,this.document.meshes=this.meshes,this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL(),this.document.json()}async saveDocument(r="untitled.nvd",e=!0,n={}){const{embedImages:i=!0,embedPreview:a=!0}=n;this.document.title=r,this.document.volumes=this.volumes,this.document.meshes=this.meshes,a?(this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL()):this.document.previewImageDataURL="",await this.document.download(r,e,{embedImages:i})}async loadImages(r){const e=[],n=[];for(const i of r)if("url"in i){const a=this.getFileExt(i.name?i.name:i.url);if(this.loaders[a]){const s=this.loaders[a].toExt.toUpperCase();Ws.includes(s)?n.push(i):e.push(i);continue}Ws.includes(a.toUpperCase())?n.push(i):e.push(i)}return e.length>0&&await this.loadVolumes(e),n.length>0&&await this.loadMeshes(n),this}async loadDicoms(r){if(!this.getDicomLoader())throw new Error("No dicom loader set. Please set a dicom loader before loading dicoms");this.drawScene(),this.volumes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);const e=r.map(async i=>{let a=null;if(i.isManifest)a=await gn.fetchDicomData(i.url);else{const h=await fetch(i.url);if(!h.ok)throw new Error(`Failed to load file: ${h.statusText}`);const d=await h.arrayBuffer();a=[{name:i.url.split("/").pop(),data:d}]}const s=this.getDicomLoader().loader,o=await s(a),l=o[0].name,u=o[0].data;return await gn.loadFromUrl({url:u,name:l})}),n=await Promise.all(e);return n.length===1?this.addVolume(n[0]):this.onDicomLoaderFinishedWithImages(n),this}async loadVolumes(r){return this.drawScene(),this.thumbnailVisible?(this.deferredVolumes=r,this):(this.volumes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.closePAQD(),await this.addVolumesFromUrl(r),this)}async addMeshFromUrl(r){const e=this.getFileExt(r.url);if(e==="JCON"||e==="JSON"){const a=await(await fetch(r.url,{})).json(),s=this.loadConnectomeAsMesh(a);return this.mediaUrlMap.set(s,r.url),this.onMeshAddedFromUrl(r,s),this.addMesh(s),s}const n=await Sl.loadFromUrl({...r,gl:this.gl});return this.mediaUrlMap.set(n,r.url),this.onMeshAddedFromUrl(r,n),this.addMesh(n),n}async addMeshesFromUrl(r){const e=r.map(async i=>{const a=this.getFileExt(i.name||i.url);if(this.loaders[a]){let o=i.url;const l=this.loaders[a].toExt;let u=i.name||i.url;if(u=u.split("/").pop(),typeof i.url=="string"){const m=i.url;try{const y=await fetch(m);if(!y.ok)throw new Error(`Failed to load file: ${y.statusText}`);o=await y.arrayBuffer()}catch(y){throw new Error(`Failed to load url ${m}: ${y}`)}}const{positions:c,indices:h,colors:d=null}=await this.loaders[a].loader(o);i.name=`${u}.${l}`;const v=await ro.createMZ3Async(c,h,!1,d);i.buffer=v}if(a==="JCON"||a==="JSON"){const l=await(await fetch(i.url,{})).json(),u=this.loadConnectomeAsMesh(l);return this.mediaUrlMap.set(u,i.url),this.onMeshAddedFromUrl(i,u),u}const s=await Sl.loadFromUrl({...i,gl:this.gl});return this.mediaUrlMap.set(s,i.url),this.onMeshAddedFromUrl(i,s),s}),n=await Promise.all(e);for(let i=0;i<n.length;i++)this.addMesh(n[i]);return n}async loadMeshes(r){return this.drawScene(),this.thumbnailVisible?(this.deferredMeshes=r,this):(this.initialized,this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),await this.addMeshesFromUrl(r),this.updateGLVolume(),this.drawScene(),this)}async loadConnectomeFromUrl(r,e={}){const i=await(await fetch(r,{headers:e})).json();return this.loadConnectome(i)}async loadFreeSurferConnectomeFromUrl(r,e={}){const i=await(await fetch(r,{headers:e})).json();return this.loadFreeSurferConnectome(i)}async loadFreeSurferConnectome(r){const e=ld.convertFreeSurferConnectome(r);return this.loadConnectome(e)}handleNodeAdded(r){const e=r.detail.node,n=[1,1,1,1];this.addLabel(e.name,{textColor:n,bulletScale:1,bulletColor:n,lineWidth:0,lineColor:n,lineTerminator:"none",textScale:1},[e.x,e.y,e.z]),this.drawScene()}loadConnectomeAsMesh(r){let e=r;if("data_type"in r&&r.data_type==="fs_pointset")e=ld.convertFreeSurferConnectome(r),Q.warn("converted FreeSurfer connectome",e);else if("nodes"in r){const n=r.nodes;"names"in n&&"X"in n&&"Y"in n&&"Z"in n&&"Color"in n&&"Size"in n&&(e=ld.convertLegacyConnectome(r))}else throw new Error("not a known connectome format");return new ld(this.gl,e)}loadConnectome(r){this.drawScene(),this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);const e=this.loadConnectomeAsMesh(r);return this.addMesh(e),this.drawScene(),this}createEmptyDrawing(){if(this.back===null||!this.back.dims||Math.min(Math.min(this.back.dims[1],this.back.dims[2]),this.back.dims[3])<1)return;const e=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];this.drawBitmap=new Uint8Array(e),this.clickToSegmentGrowingBitmap=new Uint8Array(e),this.drawClearAllUndoBitmaps(),this.drawAddUndoBitmap(),this.opts.is2DSliceShader?this.drawTexture=this.r8Tex2D(this.drawTexture,is,this.back.dims):this.drawTexture=this.r8Tex(this.drawTexture,is,this.back.dims,!0),this.refreshDrawing(!1)}r16Tex(r,e,n,i){r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,r),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,n[1],n[2],n[3]);const a=n[1]*n[2]*n[3];return i.length!==a&&(i=new Int16Array(a)),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n[1],n[2],n[3],this.gl.RED_INTEGER,this.gl.SHORT,i),r}drawGrowCut(){if(!this.back||!this.back.dims)throw new Error("back not defined");const r=this.back.hdr,e=this.gl,n=r.dims[1]*r.dims[2]*r.dims[3];if(!this.drawBitmap||this.drawBitmap.length!==n){Q.debug("bitmap dims are wrong");return}const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.disable(e.CULL_FACE),e.viewport(0,0,this.back.dims[1],this.back.dims[2]),e.disable(e.BLEND);let a=nH(this.back);const s=this.r16Tex(null,lH,this.back.dims,a);for(let S=1;S<n;S++)a[S]=this.drawBitmap[S];const o=this.r16Tex(null,fH,this.back.dims,a),l=this.r16Tex(null,hH,this.back.dims,a),u=1e4;for(let S=1;S<n;S++)a[S]>0&&(a[S]=u);const c=this.r16Tex(null,uH,this.back.dims,a),h=this.r16Tex(null,cH,this.back.dims,a);e.bindVertexArray(this.genericVAO);const d=this.growCutShader;d.use(e);const v=128;e.uniform1i(d.uniforms.finalPass,0),e.uniform1i(d.uniforms.backTex,11);for(let S=0;S<v;S++){e.uniform1i(d.uniforms.labelTex,14),e.uniform1i(d.uniforms.strengthTex,12);for(let T=0;T<this.back.dims[3];T++){const R=1/this.back.dims[3]*(T+.5);e.uniform1f(d.uniforms.coordZ,R),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,l,0,T),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT1,h,0,T),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1]),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&Q.error("Incomplete framebuffer"),e.drawArrays(e.TRIANGLE_STRIP,0,4)}S===v-1&&e.uniform1i(d.uniforms.finalPass,1),e.uniform1i(d.uniforms.labelTex,15),e.uniform1i(d.uniforms.strengthTex,13);for(let T=0;T<this.back.dims[3];T++){const R=1/this.back.dims[3]*(T+.5);e.uniform1f(d.uniforms.coordZ,R),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,o,0,T),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT1,c,0,T),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1]),e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&Q.error("Incomplete framebuffer"),e.drawArrays(e.TRIANGLE_STRIP,0,4)}}e.drawBuffers([e.COLOR_ATTACHMENT0]);const m=e.COLOR_ATTACHMENT1,y=o;e.readBuffer(m);const b=e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT),x=e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE);(b!==e.RED_INTEGER||x!==e.SHORT)&&Q.debug("readPixels will fail."),a=new Int16Array;const A=this.back.dims[1]*this.back.dims[2],C=new Int16Array(A);for(let S=0;S<this.back.dims[3];S++)e.framebufferTextureLayer(e.FRAMEBUFFER,m,y,0,S),e.readPixels(0,0,this.back.dims[1],this.back.dims[2],b,x,C),a=Int16Array.from([...a,...C]);let E=a[0];for(let S=0;S<a.length;S++)E=Math.max(E,a[S]);for(let S=1;S<n;S++)this.drawBitmap[S]=a[S];e.deleteTexture(s),e.deleteTexture(c),e.deleteTexture(h),e.deleteTexture(o),e.deleteTexture(l),e.bindVertexArray(this.unusedVAO),e.viewport(0,0,e.canvas.width,e.canvas.height),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(i),this.drawAddUndoBitmap(),this.refreshDrawing(!0)}drawPt(r,e,n,i,a=null){if(a===null&&(a=this.drawBitmap),!this.back?.dims)throw new Error("back.dims not set");const s=this.back.dims[1],o=this.back.dims[2],l=this.back.dims[3];r=Math.min(Math.max(r,0),s-1),e=Math.min(Math.max(e,0),o-1),n=Math.min(Math.max(n,0),l-1),a[r+e*s+n*s*o]=i;const u=this.drawPenAxCorSag===0,c=this.drawPenAxCorSag===1,h=this.drawPenAxCorSag===2;if(this.opts.penSize>1){const d=Math.floor(this.opts.penSize/2);for(let v=-d;v<=d;v++)for(let m=-d;m<=d;m++)u?a[r+v+(e+m)*s+n*s*o]=i:c?a[r+v+e*s+(n+m)*s*o]=i:h&&(a[r+(e+m)*s+(n+v)*s*o]=i)}}drawPenLine(r,e,n){const i=Math.abs(r[0]-e[0]),a=Math.abs(r[1]-e[1]),s=Math.abs(r[2]-e[2]);let o=-1,l=-1,u=-1;e[0]>r[0]&&(o=1),e[1]>r[1]&&(l=1),e[2]>r[2]&&(u=1);let c=r[0],h=r[1],d=r[2];const v=e[0],m=e[1],y=e[2];if(i>=a&&i>=s){let b=2*a-i,x=2*s-i;for(;c!==v;)c+=o,b>=0&&(h+=l,b-=2*i),x>=0&&(d+=u,x-=2*i),b+=2*a,x+=2*s,this.drawPt(c,h,d,n)}else if(a>=i&&a>=s){let b=2*i-a,x=2*s-a;for(;h!==m;)h+=l,b>=0&&(c+=o,b-=2*a),x>=0&&(d+=u,x-=2*a),b+=2*i,x+=2*s,this.drawPt(c,h,d,n)}else{let b=2*a-s,x=2*i-s;for(;d!==y;)d+=u,b>=0&&(h+=l,b-=2*s),x>=0&&(c+=o,x-=2*s),b+=2*a,x+=2*i,this.drawPt(c,h,d,n)}}drawRectangleMask(r,e,n){if(!this.back?.dims)throw new Error("back.dims not set");const i=this.back.dims[1],a=this.back.dims[2],s=this.back.dims[3],o=Math.min(Math.max(Math.min(r[0],e[0]),0),i-1),l=Math.min(Math.max(Math.min(r[1],e[1]),0),a-1),u=Math.min(Math.max(Math.min(r[2],e[2]),0),s-1),c=Math.min(Math.max(Math.max(r[0],e[0]),0),i-1),h=Math.min(Math.max(Math.max(r[1],e[1]),0),a-1),d=Math.min(Math.max(Math.max(r[2],e[2]),0),s-1);for(let v=u;v<=d;v++)for(let m=l;m<=h;m++)for(let y=o;y<=c;y++)this.drawPt(y,m,v,n)}drawEllipseMask(r,e,n){if(!this.back?.dims)throw new Error("back.dims not set");const i=this.back.dims[1],a=this.back.dims[2],s=this.back.dims[3],o=Math.min(Math.max(Math.min(r[0],e[0]),0),i-1),l=Math.min(Math.max(Math.min(r[1],e[1]),0),a-1),u=Math.min(Math.max(Math.min(r[2],e[2]),0),s-1),c=Math.min(Math.max(Math.max(r[0],e[0]),0),i-1),h=Math.min(Math.max(Math.max(r[1],e[1]),0),a-1),d=Math.min(Math.max(Math.max(r[2],e[2]),0),s-1),v=(o+c)/2,m=(l+h)/2,y=(u+d)/2,b=Math.abs(c-o)/2,x=Math.abs(h-l)/2,A=Math.abs(d-u)/2;for(let C=u;C<=d;C++)for(let E=l;E<=h;E++)for(let S=o;S<=c;S++){const T=(S-v)/(b+.5),R=(E-m)/(x+.5),D=(C-y)/(A+.5);T*T+R*R+D*D<=1&&this.drawPt(S,E,C,n)}}drawingBinaryDilationWithSeed(r,e=6){try{let n=function(x){return x[0]+x[1]*l+x[2]*u};const i=this.drawBitmap,a=this.back.dims[1],s=this.back.dims[2],o=this.back.dims[3],l=a,u=a*s,c=u*o,h=n(r);if(h<0||h>=c)throw new Error("Seed index is out of bounds.");const d=i[h];if(d===0)throw new Error("Seed voxel is not part of a filled cluster.");const v=i.slice();for(let x=0;x<c;x++)v[x]=v[x]===d?1:0;this.drawFloodFillCore(v,h,e);const m=i.slice(),y=[],b=[-u,u,-a,a,-1,1];y.push(...b),e>6&&y.push(-a-1,-a+1,a-1,a+1,-u-a,-u+a,-u-1,-u+1,u-a,u+a,u-1,u+1),e>18&&y.push(-u-a-1,-u-a+1,-u+a-1,-u+a+1,u-a-1,u-a+1,u+a-1,u+a+1);for(let x=0;x<c;x++)if(v[x]===2){const A=x%a,C=Math.floor(x%u/a),E=Math.floor(x/u);for(const S of y){const T=x+S;if(T<0||T>=c)continue;const R=T%a,D=Math.floor(T%u/a),B=Math.floor(T/u);Math.abs(R-A)>1||Math.abs(D-C)>1||Math.abs(B-E)>1||i[T]===0&&(m[T]=d)}}this.drawBitmap=m,this.drawAddUndoBitmap(),this.refreshDrawing(!0)}catch(n){Q.error("Error in drawingBinaryDilationWithSeed:",n)}}drawFloodFillCore(r,e,n=6){if(!this.back?.dims)throw new Error("back.dims undefined");const i=[this.back.dims[1],this.back.dims[2],this.back.dims[3]],a=i[0],s=a*i[1];function o(c){return c[0]+c[1]*a+c[2]*s}function l(c){const h=Math.floor(c/s),d=Math.floor((c-h*s)/a);return[Math.floor(c%a),d,h]}const u=[];for(u.push(e),r[e]=2;u.length>0;){let c=function(v){const m=d.slice();if(m[0]+=v[0],m[1]+=v[1],m[2]+=v[2],m[0]<0||m[1]<0||m[2]<0||m[0]>=i[0]||m[1]>=i[1]||m[2]>=i[2])return;const y=o(m);r[y]===1&&(r[y]=2,u.push(y))};const h=u[0];u.shift();const d=l(h);c([0,0,-1]),c([0,0,1]),c([0,-1,0]),c([0,1,0]),c([-1,0,0]),c([1,0,0]),!(n<=6)&&(c([-1,-1,0]),c([1,1,0]),c([-1,1,0]),c([1,1,0]),c([0,-1,-1]),c([0,1,-1]),c([-1,0,-1]),c([1,0,-1]),c([0,-1,1]),c([0,1,1]),c([-1,0,1]),c([1,0,1]),!(n<=18)&&(c([-1,-1,-1]),c([1,-1,-1]),c([-1,1,-1]),c([1,1,-1]),c([-1,-1,1]),c([1,-1,1]),c([-1,1,1]),c([1,1,1])))}}drawFloodFill(r,e=0,n=0,i=NaN,a=NaN,s=6,o=Number.POSITIVE_INFINITY,l=!1,u=null,c=!1){if(!this.drawBitmap&&(Q.warn("drawFloodFill called without an initialized drawBitmap."),this.createEmptyDrawing(),!this.drawBitmap)){Q.error("Failed to create drawing bitmap.");return}if(this.clickToSegmentIsGrowing&&!this.clickToSegmentGrowingBitmap){if(Q.warn("drawFloodFill called in preview mode without initialized clickToSegmentGrowingBitmap."),this.drawBitmap)this.clickToSegmentGrowingBitmap=this.drawBitmap.slice();else{Q.error("Cannot initialize growing bitmap as drawBitmap is null.");return}if(!this.clickToSegmentGrowingBitmap){Q.error("Failed to create growing bitmap.");return}}if(u===null&&(u=this.drawBitmap),!u){Q.error("drawFloodFill targetBitmap is null.");return}if(!this.back?.dims)throw new Error("back.dims undefined");e=Math.abs(e);const h=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];if(r[0]<0||r[1]<0||r[2]<0||r[0]>=h[0]||r[1]>=h[1]||r[2]>=h[2])return;const d=h[0],v=d*h[1],m=v*h[2],y=this.clickToSegmentIsGrowing?this.drawBitmap:u;if(!y){Q.error("Could not determine original bitmap state.");return}const b=new Uint8Array(m).fill(0);let x=-1;l&&this.drawPenAxCorSag===0?x=2:l&&this.drawPenAxCorSag===1?x=1:l&&this.drawPenAxCorSag===2&&(x=0);function A(I){const P=Math.floor(I/v),F=Math.floor((I-P*v)/d);return[Math.floor(I%d),F,P]}function C(I){return I[0]+I[1]*d+I[2]*v}const E=I=>this.vox2mm(I,this.back.matRAS),S=E(r),T=o**2;function R(I){const P=A(I);if(x>=0&&P[x]!==r[x])return!1;const F=E(P);return(F[0]-S[0])**2+(F[1]-S[1])**2+(F[2]-S[2])**2<=T}const D=C(r),B=y[D];if(c&&B===0){Q.debug("Grow/Erase Cluster tool requires starting on a masked voxel."),this.clickToSegmentIsGrowing&&this.clickToSegmentGrowingBitmap&&this.drawBitmap&&(this.clickToSegmentGrowingBitmap.set(this.drawBitmap),this.refreshDrawing(!0,!0));return}if(n===0&&B===e&&!c&&e!==0&&(Q.debug("drawFloodFill selected voxel is already desired color"),!this.clickToSegmentIsGrowing))return;let N=NaN;if(c&&(n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)){const I=y.slice();for(let V=0;V<m;V++)I[V]=I[V]===B&&R(V)?1:0;if(I[D]!==1){Q.error("Seed voxel could not be marked for cluster ID.");return}this.drawFloodFillCore(I,D,s);const P=this.volumes[0].img2RAS();let F=0,O=0;for(let V=0;V<m;V++)I[V]===2&&(F+=P[V],O++);N=O>0?F/O:P[D],Q.debug(`Grow Cluster using mean intensity: ${N.toFixed(2)} from ${O} voxels.`);let U=-1/0,L=1/0;n===Number.POSITIVE_INFINITY&&(U=N),n===Number.NEGATIVE_INFINITY&&(L=N);for(let V=0;V<m;V++)if(I[V]===2)b[V]=1;else if(y[V]===0){const _=P[V];_>=U&&_<=L&&R(V)&&(b[V]=1)}e=B}else if(n===0)if(c&&e===0){Q.debug(`Erase Cluster: Identifying cluster with color ${B}`);for(let I=0;I<m;I++)b[I]=y[I]===B&&R(I)?1:0}else for(let I=0;I<m;I++)y[I]===B&&R(I)&&B!==0&&(b[I]=1);else{const I=this.volumes[0].img2RAS();N=I[D];let P=-1/0,F=1/0;isFinite(i)&&isFinite(a)?(P=i,F=a):n===Number.POSITIVE_INFINITY?P=N:n===Number.NEGATIVE_INFINITY&&(F=N);for(let O=0;O<m;O++){const U=I[O];U>=P&&U<=F&&R(O)&&(b[O]=1)}e=y[D],e===0&&(e=this.opts.penValue,(e<1||!isFinite(e))&&(e=1))}if(b[D]!==1){let I=!1;if(c&&n!==0?B!==0&&(I=!0):(B!==0||e===0)&&(I=!0),I&&R(D))b[D]=1,Q.debug("Forcing seed voxel to 1 in working buffer.");else{Q.debug("Seed voxel not marked as candidate '1' and not valid originally."),this.clickToSegmentIsGrowing&&this.clickToSegmentGrowingBitmap&&this.drawBitmap&&this.clickToSegmentGrowingBitmap.set(this.drawBitmap);return}}this.drawFloodFillCore(b,D,s);for(let I=0;I<m;I++)b[I]===2?u[I]=e:this.clickToSegmentIsGrowing&&u===this.clickToSegmentGrowingBitmap&&(u[I]=y[I]);this.clickToSegmentIsGrowing?this.refreshDrawing(!0,!0):(this.drawAddUndoBitmap(),this.refreshDrawing(!0,!1))}floodFillSectionFIFO(r,e,n,i){const a=e[0],[s,o]=n,[l,u]=i,c=4*(l-s+u-o+2),h=new Int32Array(c*2);let d=0,v=0;function m(x,A){if(x<s||x>l||A<o||A>u)return;const C=x+A*a;r[C]===0&&(r[C]=2,h[v]=x,h[v+1]=A,v=(v+2)%h.length)}function y(){if(d===v)return null;const x=h[d],A=h[d+1];return d=(d+2)%h.length,[x,A]}for(let x=s;x<=l;x++)m(x,o),m(x,u);for(let x=o+1;x<=u-1;x++)m(s,x),m(l,x);let b;for(;(b=y())!==null;){const[x,A]=b;m(x-1,A),m(x+1,A),m(x,A-1),m(x,A+1)}}drawPenFilled(){const r=this.drawPenFillPts.length;if(r<2){this.drawPenFillPts=[];return}const e=this.drawPenAxCorSag;let n=0,i=1;if(e===1&&(i=2),e===2&&(n=1,i=2),!this.back?.dims)throw new Error("back.dims undefined");const a=[this.back.dims[n+1],this.back.dims[i+1]],s=new Uint8Array(a[0]*a[1]);let o=1;function l(x,A){const C=Math.abs(x[0]-A[0]),E=Math.abs(x[1]-A[1]);s[x[0]+x[1]*a[0]]=o,s[A[0]+A[1]*a[0]]=o;let S=-1,T=-1;A[0]>x[0]&&(S=1),A[1]>x[1]&&(T=1);let R=x[0],D=x[1];const B=A[0],N=A[1];if(C>=E){let I=2*E-C;for(;R!==B;)R+=S,I>=0&&(D+=T,I-=2*C),I+=2*E,s[R+D*a[0]]=o}else{let I=2*C-E;for(;D!==N;)D+=T,I>=0&&(R+=S,I-=2*E),I+=2*C,s[R+D*a[0]]=o}}function u(x){const A=Math.min(Math.max(x[0],0),a[0]-1),C=Math.min(Math.max(x[1],0),a[1]-1);return[A,C]}const c=u([this.drawPenFillPts[0][n],this.drawPenFillPts[0][i]]);let h=[...c],d=[...c],v=c;for(let x=1;x<r;x++){let A=[this.drawPenFillPts[x][n],this.drawPenFillPts[x][i]];A=u(A),h=[Math.min(A[0],h[0]),Math.min(A[1],h[1])],d=[Math.max(A[0],d[0]),Math.max(A[1],d[1])],l(v,A),v=A}l(c,v);const m=1;h[0]=Math.max(0,h[0]-m),h[1]=Math.max(0,h[1]-m),d[0]=Math.min(a[0]-1,d[0]+m),d[1]=Math.min(a[1]-1,d[1]+m);for(let x=0;x<a[1];x++)for(let A=0;A<a[0];A++){if(A>=h[0]&&A<d[0]&&x>=h[1]&&x<=d[1])continue;const C=A+x*a[0];s[C]===0&&(s[C]=2)}const y=Date.now();this.floodFillSectionFIFO(s,a,h,d),Q.debug(`FloodFill ${Date.now()-y}`),o=this.opts.penValue;const b=this.drawPenFillPts[0][3-(n+i)];if(!this.drawBitmap)throw new Error("drawBitmap undefined");if(e===0){const x=b*a[0]*a[1];for(let A=0;A<a[0]*a[1];A++)s[A]!==2&&(this.drawBitmap[A+x]=o)}else{let x=1;const A=this.back.dims[1]*this.back.dims[2];let C=b*this.back.dims[1];e===2&&(x=this.back.dims[1],C=b);let E=0;for(let S=0;S<a[1];S++)for(let T=0;T<a[0];T++)s[E]!==2&&(this.drawBitmap[T*x+S*A+C]=o),E++}if(!this.drawFillOverwrites&&this.drawUndoBitmaps[this.currentDrawUndoBitmap].length>0){const x=this.drawBitmap.length,A=i2(this.drawUndoBitmaps[this.currentDrawUndoBitmap],x);for(let C=0;C<x;C++)A[C]!==0&&(this.drawBitmap[C]=A[C])}this.drawPenFillPts=[],this.drawAddUndoBitmap(),this.refreshDrawing(!1)}closeDrawing(){this.drawClearAllUndoBitmaps(),this.drawTexture=this.rgbaTex(this.drawTexture,is,[2,2,2,2],!0),this.drawBitmap=null,this.clickToSegmentGrowingBitmap=null,this.drawScene()}refreshDrawing(r=!0,e=!1){e&&(!this.opts.drawingEnabled||!this.opts.clickToSegment)&&(Q.debug("refreshDrawing: Conditions not met for clickToSegment bitmap, using drawBitmap."),e=!1);const n=e?this.clickToSegmentGrowingBitmap:this.drawBitmap;!n&&!e&&this.clickToSegmentGrowingBitmap?Q.warn("refreshDrawing: drawBitmap is null, but clickToSegmentGrowingBitmap exists. Check state."):!n&&e&&this.drawBitmap?(Q.warn("refreshDrawing: clickToSegmentGrowingBitmap is null, falling back to drawBitmap."),e=!1):n||Q.warn("refreshDrawing: Both bitmaps are null. Uploading empty data.");const i=e?this.clickToSegmentGrowingBitmap:this.drawBitmap;if(!this.back?.dims){Q.warn("refreshDrawing: back.dims undefined, cannot refresh drawing texture yet.");return}const a=this.back.dims.slice(),s=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];if(!i){Q.warn(`refreshDrawing: Bitmap data source (${e?"growing":"main"}) is null. Cannot update texture.`),r&&this.drawScene();return}if(i.length===8?(a[1]=2,a[2]=2,a[3]=2):s!==i.length&&Q.warn(`Drawing bitmap length (${i.length}) must match the background image (${s})`),this.gl.activeTexture(is),this.opts.is2DSliceShader){const o=this.frac2vox(this.scene.crosshairPos),l=Math.min(Math.max(o[2],0),a[3]-1),u=a[1]*a[2],c=l*u;Q.debug(`refresh huge 2D drawing x×y×z ${a[1]}×${a[2]}×${a[3]} slice ${c}`);const h=i.subarray(c,c+u);this.gl.bindTexture(this.gl.TEXTURE_2D,this.drawTexture),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,a[1],a[2],this.gl.RED,this.gl.UNSIGNED_BYTE,h)}else this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,a[1],a[2],a[3],this.gl.RED,this.gl.UNSIGNED_BYTE,i);if(!this.drawTexture){Q.error("refreshDrawing: drawTexture (GPU texture) is null.");return}r&&this.drawScene()}closePAQD(){!this._gl||!this.paqdTexture||(this.paqdTexture=this.rgbaTex(this.paqdTexture,hc,[2,2,2,2],!0))}r8Tex2D(r,e,n,i=!1){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.R8,n[1],n[2]),i){const a=new Uint8Array(n[1]*n[2]);this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,n[1],n[2],this.gl.RED,this.gl.UNSIGNED_BYTE,a)}return r}r8Tex(r,e,n,i=!1){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,r),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8,n[1],n[2],n[3]),i){const a=new Uint8Array(n[1]*n[2]*n[3]);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n[1],n[2],n[3],this.gl.RED,this.gl.UNSIGNED_BYTE,a)}return r}rgbaTex2D(r,e,n,i=null,a=!0){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,n[1],n[2]),i){let s=i;const o=n[1],l=n[2];if(a){s=new Uint8Array(i.length);const u=o*4;for(let c=0;c<l;c++){const h=c*u,d=(l-1-c)*u;s.set(i.subarray(h,h+u),d)}}this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,o,l,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s)}return r}rgbaTex(r,e,n,i=!1){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,r),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8,n[1],n[2],n[3]),i){const a=new Uint8Array(n[1]*n[2]*n[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n[1],n[2],n[3],this.gl.RGBA,this.gl.UNSIGNED_BYTE,a)}return r}rgba16Tex(r,e,n,i=!1){if(r&&this.gl.deleteTexture(r),r=this.gl.createTexture(),this.gl.activeTexture(e),this.gl.bindTexture(this.gl.TEXTURE_3D,r),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,2),this.gl.pixelStorei(this.gl.PACK_ALIGNMENT,2),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA16UI,n[1],n[2],n[3]),i){const a=new Uint16Array(n[1]*n[2]*n[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n[1],n[2],n[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_SHORT,a)}return r}requestCORSIfNotSameOrigin(r,e){new URL(e,window.location.href).origin!==window.location.origin&&(r.crossOrigin="")}async loadPngAsTexture(r,e){return new Promise((n,i)=>{const a=new Image;a.onload=()=>{if(!this.bmpShader)return;let s;e===4?(this.bmpTexture!==null&&this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=this.gl.createTexture(),s=this.bmpTexture,this.bmpTextureWH=a.width/a.height,this.gl.activeTexture(oH),this.bmpShader.use(this.gl),this.gl.uniform1i(this.bmpShader.uniforms.bmpTexture,4)):e===5?(this.gl.activeTexture(NC),this.matCapTexture!==null&&this.gl.deleteTexture(this.matCapTexture),this.matCapTexture=this.gl.createTexture(),s=this.matCapTexture):(this.fontShader.use(this.gl),this.gl.activeTexture(sH),this.gl.uniform1i(this.fontShader.uniforms.fontTexture,3),this.fontTexture!==null&&this.gl.deleteTexture(this.fontTexture),this.fontTexture=this.gl.createTexture(),s=this.fontTexture),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a),n(s),e!==4&&this.drawScene()},a.onerror=i,this.requestCORSIfNotSameOrigin(a,r),a.src=r})}async loadFontTexture(r){return this.loadPngAsTexture(r,3)}async loadBmpTexture(r){return this.loadPngAsTexture(r,4)}async loadMatCapTexture(r){return this.loadPngAsTexture(r,5)}initFontMets(){if(!this.fontMetrics)throw new Error("fontMetrics undefined");this.fontMets={distanceRange:this.fontMetrics.atlas.distanceRange,size:this.fontMetrics.atlas.size,mets:{}};for(let n=0;n<256;n++)this.fontMets.mets[n]={xadv:0,uv_lbwh:[0,0,0,0],lbwh:[0,0,0,0]};const r=this.fontMetrics.atlas.width,e=this.fontMetrics.atlas.height;for(let n=0;n<this.fontMetrics.glyphs.length;n++){const i=this.fontMetrics.glyphs[n],a=i.unicode;if(this.fontMets.mets[a].xadv=i.advance,i.planeBounds===void 0)continue;let s=i.atlasBounds.left/r,o=(e-i.atlasBounds.top)/e,l=(i.atlasBounds.right-i.atlasBounds.left)/r,u=(i.atlasBounds.top-i.atlasBounds.bottom)/e;this.fontMets.mets[a].uv_lbwh=[s,o,l,u],s=i.planeBounds.left,o=i.planeBounds.bottom,l=i.planeBounds.right-i.planeBounds.left,u=i.planeBounds.top-i.planeBounds.bottom,this.fontMets.mets[a].lbwh=[s,o,l,u]}}async loadFont(r=xC,e=bC){await this.loadFontTexture(r);const n=await fetch(e);if(!n.ok)throw Error(n.statusText);const i=await n.text();this.fontMetrics=JSON.parse(i),this.initFontMets(),this.fontShader.use(this.gl),this.drawScene()}async loadDefaultMatCap(){return this.loadMatCapTexture(XG)}async loadDefaultFont(){await this.loadFontTexture(this.DEFAULT_FONT_GLYPH_SHEET),this.fontMetrics=this.DEFAULT_FONT_METRICS,this.initFontMets()}async initText(){this.fontShader=new St(this.gl,yY,AY),this.fontShader.use(this.gl),await this.loadDefaultFont(),await this.loadDefaultMatCap(),this.drawLoadingText(this.opts.loadingText)}meshShaderNameToNumber(r="Phong"){const e=r.toLowerCase();for(let n=0;n<this.meshShaders.length;n++)if(this.meshShaders[n].Name.toLowerCase()===e)return n}setMeshShader(r,e=2){let n=0;if(typeof e=="number"?n=e:n=this.meshShaderNameToNumber(e),n===void 0)throw new Error("shaderIndex undefined");n=Math.min(n,this.meshShaders.length-1),n=Math.max(n,0);const i=this.getMeshIndexByID(r);if(i>=this.meshes.length){Q.debug("Unable to change shader until mesh is loaded (maybe you need async)");return}this.meshes[i].meshShaderIndex=n,this.updateGLVolume(),this.onMeshShaderChanged(i,n)}createCustomMeshShader(r,e="Custom"){if(!r)throw new Error("Need fragment shader");const n=this.meshShaderNameToNumber(e);n>=0&&(this.gl.deleteProgram(this.meshShaders[n].shader.program),this.meshShaders.splice(n,1));const i=new St(this.gl,np,r);return i.use(this.gl),{Name:e,Frag:r,shader:i}}setCustomSliceShader(r=""){const e=this.gl;if(this.customSliceShader&&(e.deleteProgram(this.customSliceShader.program),this.customSliceShader=null),!r){this.updateGLVolume();return}const n=new St(e,ud,r);n.use(e),e.uniform1i(n.uniforms.volume,0),e.uniform1i(n.uniforms.colormap,1),e.uniform1i(n.uniforms.overlay,2),e.uniform1i(n.uniforms.drawing,7),e.uniform1i(n.uniforms.paqd,8),e.uniform1f(n.uniforms.drawOpacity,this.drawOpacity),this.customSliceShader=n,this.updateGLVolume()}setCustomMeshShader(r="",e="Custom"){const n=this.createCustomMeshShader(r,e);return this.meshShaders.push(n),this.onCustomMeshShaderAdded(r,e),this.meshShaders.length-1}meshShaderNames(r=!0){const e=[];for(let n=0;n<this.meshShaders.length;n++)e.push(this.meshShaders[n].Name);return r===!0?e.sort():e}initRenderShader(r,e=0){r.use(this.gl),this.gl.uniform1i(r.uniforms.volume,0),this.gl.uniform1i(r.uniforms.colormap,1),this.gl.uniform1i(r.uniforms.overlay,2),this.gl.uniform1i(r.uniforms.drawing,7),this.gl.uniform1i(r.uniforms.paqd,8),this.gl.uniform1fv(r.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.gl.uniform1f(r.uniforms.gradientAmount,e),this.gl.uniform1f(r.uniforms.silhouettePower,this.opts.renderSilhouette);const n=new Float32Array(Fc);for(let i=0;i<Fc;i++)this.opts.gradientOpacity===0?n[i]=1:n[i]=Math.pow(i/(Fc-1),this.opts.gradientOpacity*8);this.gl.uniform1fv(this.gl.getUniformLocation(r.program,"gradientOpacity"),n)}async init(){const r=this.gl.getExtension("WEBGL_debug_renderer_info");if(r){const s=this.gl.getParameter(r.UNMASKED_VENDOR_WEBGL),o=this.gl.getParameter(r.UNMASKED_RENDERER_WEBGL);Q.info("renderer vendor: ",s),Q.info("renderer: ",o)}else Q.info("debug_renderer_info unavailable");const e=this.gl.getParameter(this.gl.RENDERER);Q.info("firefox renderer: ",e),this.gl.clearDepth(0),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.FRONT),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.volumeTexture=this.rgbaTex(this.volumeTexture,bl,[2,2,2,2],!0),this.overlayTexture=this.rgbaTex(this.overlayTexture,lp,[2,2,2,2],!0),this.drawTexture=this.r8Tex(this.drawTexture,is,[2,2,2,2],!0),this.paqdTexture=this.rgbaTex(this.paqdTexture,hc,[2,2,2,2],!0);const n=[1,1,0,1,0,0,0,1,0,0,0,0],i=this.gl;this.cuboidVertexBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.cuboidVertexBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(n),i.STATIC_DRAW),this.genericVAO=i.createVertexArray(),i.bindVertexArray(this.genericVAO),i.bindBuffer(i.ARRAY_BUFFER,this.cuboidVertexBuffer),i.enableVertexAttribArray(0),i.vertexAttribPointer(0,3,i.FLOAT,!1,0,0),i.bindVertexArray(this.unusedVAO),this.pickingMeshShader=new St(i,np,IY),this.pickingMeshShader.use(i),this.pickingImageShader=new St(i,uc,jY),this.pickingImageShader.use(i),i.uniform1i(this.pickingImageShader.uniforms.volume,0),i.uniform1i(this.pickingImageShader.uniforms.colormap,1),i.uniform1i(this.pickingImageShader.uniforms.overlay,2),i.uniform1i(this.pickingImageShader.uniforms.drawing,7),this.slice2DShader=new St(i,ud,lY),this.slice2DShader.use(i),i.uniform1i(this.slice2DShader.uniforms.volume,0),i.uniform1i(this.slice2DShader.uniforms.colormap,1),i.uniform1i(this.slice2DShader.uniforms.overlay,2),i.uniform1i(this.slice2DShader.uniforms.drawing,7),i.uniform1f(this.slice2DShader.uniforms.drawOpacity,this.drawOpacity),this.sliceMMShader=new St(i,ud,uY),this.sliceMMShader.use(i),i.uniform1i(this.sliceMMShader.uniforms.volume,0),i.uniform1i(this.sliceMMShader.uniforms.colormap,1),i.uniform1i(this.sliceMMShader.uniforms.overlay,2),i.uniform1i(this.sliceMMShader.uniforms.drawing,7),i.uniform1f(this.sliceMMShader.uniforms.drawOpacity,this.drawOpacity),this.sliceV1Shader=new St(i,ud,cY),this.sliceV1Shader.use(i),i.uniform1i(this.sliceV1Shader.uniforms.volume,0),i.uniform1i(this.sliceV1Shader.uniforms.colormap,1),i.uniform1i(this.sliceV1Shader.uniforms.overlay,2),i.uniform1i(this.sliceV1Shader.uniforms.drawing,7),i.uniform1f(this.sliceV1Shader.uniforms.drawOpacity,this.drawOpacity),this.orientCubeShader=new St(i,KY,XY),this.orientCubeShaderVAO=i.createVertexArray(),i.bindVertexArray(this.orientCubeShaderVAO);const a=i.createBuffer();i.enableVertexAttribArray(0),i.enableVertexAttribArray(1),i.bindBuffer(i.ARRAY_BUFFER,a),i.bufferData(i.ARRAY_BUFFER,mq,i.STATIC_DRAW),i.vertexAttribPointer(0,3,i.FLOAT,!1,24,0),i.enableVertexAttribArray(1),i.vertexAttribPointer(1,3,i.FLOAT,!1,24,12),i.bindVertexArray(this.unusedVAO),this.rectShader=new St(i,CC,tp),this.rectShader.use(i),this.rectOutlineShader=new St(i,CC,fY),this.rectOutlineShader.use(i),this.lineShader=new St(i,gY,tp),this.lineShader.use(i),this.line3DShader=new St(i,vY,tp),this.line3DShader.use(i),this.circleShader=new St(i,xY,bY),this.circleShader.use(i),this.renderVolumeShader=new St(i,uc,aY),this.initRenderShader(this.renderVolumeShader),this.renderSliceShader=new St(i,uc,iY),this.initRenderShader(this.renderSliceShader),this.renderGradientShader=new St(i,uc,sY),this.initRenderShader(this.renderGradientShader,.3),i.uniform1i(this.renderGradientShader.uniforms.matCap,5),i.uniform1i(this.renderGradientShader.uniforms.gradient,6),this.renderGradientValuesShader=new St(i,uc,oY),this.initRenderShader(this.renderGradientValuesShader),i.uniform1i(this.renderGradientValuesShader.uniforms.matCap,5),i.uniform1i(this.renderGradientValuesShader.uniforms.gradient,6),this.renderShader=this.renderVolumeShader,this.colorbarShader=new St(i,hY,dY),this.colorbarShader.use(i),i.uniform1i(this.colorbarShader.uniforms.colormap,1),this.blurShader=new St(i,fd,ZY),this.sobelBlurShader=new St(i,fd,JY),this.sobelFirstOrderShader=new St(i,fd,$Y),this.sobelSecondOrderShader=new St(i,fd,eH),this.growCutShader=new St(i,SY,TY),this.passThroughShader=new St(i,QY,WY),this.orientShaderAtlasU=new St(i,Qs,cd.concat(SC)),this.orientShaderAtlasI=new St(i,Qs,EC.concat(SC)),this.orientShaderU=new St(i,Qs,cd.concat(rp)),this.orientShaderI=new St(i,Qs,EC.concat(rp)),this.orientShaderF=new St(i,Qs,wY.concat(rp)),this.orientShaderRGBU=new St(i,Qs,cd.concat(EY)),this.orientShaderPAQD=new St(i,Qs,cd.concat(CY)),this.surfaceShader=new St(i,MY,DY),this.surfaceShader.use(i),this.fiberShader=new St(i,RY,BY),this.pickingImageShader.use(i);for(let s=0;s<this.meshShaders.length;s++){const o=this.meshShaders[s];o.Name==="Flat"?o.shader=new St(i,HY,TC):o.shader=new St(i,np,o.Frag),o.shader.use(i),o.shader.isMatcap=o.Name==="Matcap",o.shader.isMatcap&&i.uniform1i(o.shader.uniforms.matCap,5)}return this.bmpShader=new St(i,mY,pY),await this.initText(),this.opts.thumbnail.length>0&&(await this.loadBmpTexture(this.opts.thumbnail),this.thumbnailVisible=!0),this.updateGLVolume(),this.initialized=!0,this.resizeListener(),this.drawScene(),this}gradientGL(r){const e=this.gl;e.bindVertexArray(this.genericVAO);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.viewport(0,0,r.dims[1],r.dims[2]),e.disable(e.BLEND);const i=this.rgbaTex(null,FC,r.dims,!0),a=this.opts.gradientOrder===2?this.sobelBlurShader:this.blurShader;a.use(e),e.activeTexture(bl),e.bindTexture(e.TEXTURE_3D,this.volumeTexture),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MAG_FILTER,e.LINEAR);const s=.7;e.uniform1i(a.uniforms.intensityVol,0),e.uniform1f(a.uniforms.dX,s/r.dims[1]),e.uniform1f(a.uniforms.dY,s/r.dims[2]),e.uniform1f(a.uniforms.dZ,s/r.dims[3]);for(let u=0;u<r.dims[3]-1;u++){const c=1/r.dims[3]*(u+.5);e.uniform1f(a.uniforms.coordZ,c),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,i,0,u);const h=e.checkFramebufferStatus(e.FRAMEBUFFER);h!==e.FRAMEBUFFER_COMPLETE&&Q.error("blur shader: ",h),e.clear(e.DEPTH_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4)}const o=this.opts.gradientOrder===2?this.sobelSecondOrderShader:this.sobelFirstOrderShader;o.use(e),e.activeTexture(FC),e.bindTexture(e.TEXTURE_3D,i),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_3D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.uniform1i(o.uniforms.intensityVol,8);const l=.7;e.uniform1f(o.uniforms.dX,l/r.dims[1]),e.uniform1f(o.uniforms.dY,l/r.dims[2]),e.uniform1f(o.uniforms.dZ,l/r.dims[3]),this.opts.gradientOrder===2&&(e.uniform1f(o.uniforms.dX2,2*l/r.dims[1]),e.uniform1f(o.uniforms.dY2,2*l/r.dims[2]),e.uniform1f(o.uniforms.dZ2,2*l/r.dims[3])),e.uniform1f(o.uniforms.coordZ,.5),this.gradientTexture!==null&&e.deleteTexture(this.gradientTexture),this.gradientTexture=this.rgbaTex(this.gradientTexture,up,r.dims);for(let u=0;u<r.dims[3]-1;u++){const c=1/r.dims[3]*(u+.5);e.uniform1f(o.uniforms.coordZ,c),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,this.gradientTexture,0,u);const h=e.checkFramebufferStatus(e.FRAMEBUFFER);h!==e.FRAMEBUFFER_COMPLETE&&Q.error("sobel shader: ",h),e.clear(e.DEPTH_BUFFER_BIT),e.drawArrays(e.TRIANGLE_STRIP,0,4)}e.deleteFramebuffer(n),e.deleteTexture(i),e.bindFramebuffer(e.FRAMEBUFFER,null),e.activeTexture(hc),e.bindTexture(e.TEXTURE_3D,this.paqdTexture),this.gl.bindVertexArray(this.unusedVAO)}getGradientTextureData(){if(!this.gradientTexture||!this.back)return null;const r=this.gl,e=this.back.dims,n=e[1],i=e[2],a=e[3],s=n*i*a,o=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,o);const l=new Float32Array(s*4);try{for(let u=0;u<a;u++){r.framebufferTextureLayer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,this.gradientTexture,0,u);const c=r.checkFramebufferStatus(r.FRAMEBUFFER);if(c!==r.FRAMEBUFFER_COMPLETE){console.warn("Framebuffer not complete for gradient texture reading, slice",u,"status:",c.toString(16));continue}try{const h=new Uint8Array(n*i*4);r.readPixels(0,0,n,i,r.RGBA,r.UNSIGNED_BYTE,h);const d=new Float32Array(n*i*4);for(let m=0;m<h.length;m++)d[m]=h[m]/127.5-1;const v=u*n*i*4;l.set(d,v)}catch(h){console.warn("Failed to read pixels for slice",u,":",h);const d=u*n*i*4,v=new Float32Array(n*i*4);l.set(v,d)}}}catch(u){return console.error("Error reading gradient texture:",u),null}finally{r.deleteFramebuffer(o),r.bindFramebuffer(r.FRAMEBUFFER,null)}return l}setCustomGradientTexture(r,e){const n=this.gl;if(r===null){this.useCustomGradientTexture=!1,this.back&&this.gradientTextureAmount>0&&this.gradientGL(this.back.hdr);return}if(!e&&!this.back){console.warn("No dimensions provided and no background volume loaded");return}const i=e||this.back.dims,a=i[1],s=i[2],o=i[3],l=a*s*o*4;if(r.length!==l){console.warn(`Custom gradient data size mismatch. Expected ${l}, got ${r.length}`);return}this.useCustomGradientTexture=!0,this.gradientTexture!==null&&n.deleteTexture(this.gradientTexture),this.gradientTexture=n.createTexture(),n.activeTexture(up),n.bindTexture(n.TEXTURE_3D,this.gradientTexture),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.pixelStorei(n.UNPACK_ALIGNMENT,1);let u;if(r instanceof Float32Array){u=new Uint8Array(r.length);for(let c=0;c<r.length;c++){const h=Math.max(-1,Math.min(1,r[c]));u[c]=Math.round((h+1)*127.5)}}else u=r;n.texStorage3D(n.TEXTURE_3D,1,n.RGBA8,a,s,o),n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,a,s,o,n.RGBA,n.UNSIGNED_BYTE,u),this.drawScene()}updateGLVolume(){let r=0;const e=this.volumes.length;this.refreshColormaps(),this.closePAQD();for(let n=0;n<e;n++)this.volumes[n].toRAS&&(this.refreshLayers(this.volumes[n],r),r++);if(this.furthestVertexFromOrigin=0,e>0&&(this.furthestVertexFromOrigin=this.volumeObject3D?.furthestVertexFromOrigin??0),this.meshes)for(let n=0;n<this.meshes.length;n++)this.furthestVertexFromOrigin=Math.max(this.furthestVertexFromOrigin,this.meshes[n].furthestVertexFromOrigin);this.onVolumeUpdated&&this.onVolumeUpdated(),this.drawScene()}getDescriptives(r){const{layer:e=0,masks:n=[],drawingIsMask:i=!1,roiIsMask:a=!1,startVox:s=[0,0,0],endVox:o=[0,0,0]}=r;let l=null;const u=this.volumes[e].hdr,c=this.volumes[e].pixDimsRAS;let h=u.scl_slope;isNaN(h)&&(h=1);let d=u.scl_inter;isNaN(d)&&(d=1);const v=this.volumes[e].img,m=v.length,y=new Float32Array(m);for(let F=0;F<m;F++)y[F]=v[F]*h+d;const b=new Uint8Array(m);for(let F=0;F<m;F++)b[F]=1;if(n.length>0)for(let F=0;F<n.length;F++){const O=this.volumes[n[F]].img;if(O.length!==m){Q.debug("Mask resolution does not match image. Skipping masking layer "+n[F]);continue}for(let U=0;U<m;U++)(O[U]===0||isNaN(O[U]))&&(b[U]=0)}else if(n.length<1&&i)for(let F=0;F<m;F++)(this.drawBitmap[F]===0||isNaN(this.drawBitmap[F]))&&(b[F]=0);else if(n.length<1&&a){b.fill(0);let F=-1;if(s[0]===o[0])F=0;else if(s[1]===o[1])F=1;else if(s[2]===o[2])F=2;else{console.error("Error: No constant dimension found.");return}const U=[0,1,2].filter(ye=>ye!==F),L=[];L[F]=s[F],L[U[0]]=(s[U[0]]+o[U[0]])/2,L[U[1]]=(s[U[1]]+o[U[1]])/2;const V=Math.abs(o[U[0]]-s[U[0]])/2,_=Math.abs(o[U[1]]-s[U[1]])/2,G=u.dims[1],K=u.dims[2],z=Math.max(0,Math.floor(L[U[0]]-V)),Y=Math.min(u.dims[U[0]+1]-1,Math.ceil(L[U[0]]+V)),Z=Math.max(0,Math.floor(L[U[1]]-_)),J=Math.min(u.dims[U[1]+1]-1,Math.ceil(L[U[1]]+_)),ee=L[F];if(ee<0||ee>=u.dims[F+1]){console.error("Error: Constant dimension value is out of bounds.");return}for(let ye=z;ye<=Y;ye++)for(let ve=Z;ve<=J;ve++){const re=[];re[F]=ee,re[U[0]]=ye,re[U[1]]=ve;const ae=(re[U[0]]-L[U[0]])/V,le=(re[U[1]]-L[U[1]])/_;if(ae*ae+le*le<=1){const Re=re[0],Le=re[1],He=re[2]*G*K+Le*G+Re;b[He]=1}}const ne=V*c[U[0]+1],oe=_*c[U[1]+1];l=Math.PI*ne*oe}let x=0,A=0,C=0,E=Number.NEGATIVE_INFINITY,S=Number.POSITIVE_INFINITY,T=0,R=0,D=0;for(let F=0;F<m;F++){if(b[F]<1)continue;const O=y[F];x++;let U=A+(O-A)/x;C=C+(O-A)*(O-U),A=U,O!==0&&(T++,U=R+(O-R)/T,D=D+(O-R)*(O-U),R=U,S=Math.min(O,S),E=Math.max(O,E))}const B=Math.sqrt(C/(x-1)),N=Math.sqrt(D/(T-1)),I=S,P=E;return x!==T&&(S=Math.min(0,S),E=Math.max(0,E)),{mean:A,stdev:B,nvox:x,volumeMM3:x*u.pixDims[1]*u.pixDims[2]*u.pixDims[3],volumeML:x*u.pixDims[1]*u.pixDims[2]*u.pixDims[3]*.001,min:S,max:E,meanNot0:R,stdevNot0:N,nvoxNot0:T,minNot0:I,maxNot0:P,cal_min:this.volumes[e].cal_min,cal_max:this.volumes[e].cal_max,robust_min:this.volumes[e].robust_min,robust_max:this.volumes[e].robust_max,area:l}}refreshLayers(r,e){if(this.volumes.length<1)return;this.refreshColormaps();const n=r.hdr;let i=r.img;r.frame4D>0&&r.frame4D<r.nFrame4D&&(i=r.img.slice(r.frame4D*r.nVox3D,(r.frame4D+1)*r.nVox3D));const a=r.opacity;if(e>1&&a===0)return;let s=null;if(!this.back)throw new Error("back undefined");this.gl.bindVertexArray(this.unusedVAO),this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN);let o=Er(r.toRAS);if(e===0){this.volumeObject3D=QG(r,this.VOLUME_ID,this.gl),Mn(o,o),this.back.matRAS=r.matRAS,this.back.dims=r.dimsRAS,this.back.pixDims=r.pixDimsRAS;const{volScale:R,vox:D}=this.sliceScale(!0);this.volScale=R,this.vox=D,this.volumeObject3D.scale=R,(n.dims[1]>this.uiData.max2D||n.dims[2]>this.uiData.max2D)&&Q.error("Image dimensions exceed maximum texture size of hardware.");const N=n.dims[1]>this.uiData.max3D||n.dims[2]>this.uiData.max3D||n.dims[3]>this.uiData.max3D;if(N&&n.datatypeCode===2304&&n.dims[3]<2){Q.info(`Large RGBA image (>${this.uiData.max3D}) requires Texture2D`),this.opts.is2DSliceShader=!0,s=this.rgbaTex2D(this.volumeTexture,bl,r.dimsRAS,i);return}if(N){Q.info(`Large scalar image (>${this.uiData.max3D}) requires Texture2D (${n.dims[1]}×${n.dims[2]}×${n.dims[3]})`);const P=n.dims[1]*n.dims[2],F=this.frac2vox(this.scene.crosshairPos),U=Math.min(Math.max(F[2],0),n.dims[3]-1)*P,L=new Uint8Array(P*4),V=new Uint32Array(L.buffer),_=Math.floor(r.opacity*255),G=255*n.scl_slope/(r.cal_max-r.cal_min),K=255*(n.scl_inter-r.cal_min)/(r.cal_max-r.cal_min),z=new Uint8Array(this.colormap(r.colormap)),Y=new Uint32Array(z.buffer);let Z=-1;for(let J=0;J<P;J++){const ee=i[J+U]*G+K,ne=Math.round(Math.min(255,Math.max(0,ee)));V[J]=Y[ne],L[Z+=4]=_}this.opts.is2DSliceShader=!0,s=this.rgbaTex2D(this.volumeTexture,bl,r.dimsRAS,L,!1);return}if(N&&Q.warn(`dimensions exceed 3D limits ${n.dims}`),this.opts.is2DSliceShader=!1,s=this.rgbaTex(this.volumeTexture,bl,r.dimsRAS),!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.texVox,D),this.gl.uniform3fv(this.renderShader.uniforms.volScale,R);const I=this.pickingImageShader;I.use(this.gl),this.gl.uniform1i(I.uniforms.volume,0),this.gl.uniform1i(I.uniforms.colormap,1),this.gl.uniform1i(I.uniforms.overlay,2),this.gl.uniform3fv(I.uniforms.volScale,R),Q.debug(this.volumeObject3D)}else{this.back?.dims===void 0&&Q.error("Fatal error: Unable to render overlay: background dimensions not defined!");const R=this.mm2frac(r.mm000,0,!0);let D=this.mm2frac(r.mm100,0,!0),B=this.mm2frac(r.mm010,0,!0),N=this.mm2frac(r.mm001,0,!0);D=$t(D,D,R),B=$t(B,B,R),N=$t(N,N,R),o=Hn(D[0],B[0],N[0],R[0],D[1],B[1],N[1],R[1],D[2],B[2],N[2],R[2],0,0,0,1),Mn(o,o),e===1?(s=this.rgbaTex(this.overlayTexture,lp,this.back.dims),this.overlayTexture=s,this.overlayTextureID=s):s=this.overlayTextureID}const l=this.gl.createFramebuffer();this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,l),this.gl.disable(this.gl.CULL_FACE),this.gl.viewport(0,0,this.back.dims[1],this.back.dims[2]),this.gl.disable(this.gl.BLEND);const u=this.gl.createTexture();this.gl.activeTexture(kC),this.gl.bindTexture(this.gl.TEXTURE_3D,u),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1);let c=this.orientShaderU;if(!n)throw new Error("hdr undefined");if(!i)throw new Error("img undefined");if(n.datatypeCode===2)n.intent_code===1002&&(c=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8UI,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_BYTE,i);else if(n.datatypeCode===4)c=this.orientShaderI,n.intent_code===1002&&(c=this.orientShaderAtlasI),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED_INTEGER,this.gl.SHORT,i);else if(n.datatypeCode===16)this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED,this.gl.FLOAT,i),c=this.orientShaderF;else if(n.datatypeCode===64){let R=new Float32Array;R=Float32Array.from(i),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED,this.gl.FLOAT,R),c=this.orientShaderF}else if(n.datatypeCode===128)c=this.orientShaderRGBU,c.use(this.gl),this.gl.uniform1i(c.uniforms.hasAlpha,0),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGB8UI,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RGB_INTEGER,this.gl.UNSIGNED_BYTE,i);else if(n.datatypeCode===512)n.intent_code===1002&&(c=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16UI,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_SHORT,i);else if(n.datatypeCode===2304){if(c=this.orientShaderRGBU,r.colormapLabel){c=this.orientShaderPAQD;let R=!0;for(let D=0;D<e;D++){const B=this.volumes[D].hdr.datatypeCode===2304,N=!!this.volumes[D].colormapLabel;B&&N&&(R=!1)}R?this.paqdTexture=this.rgbaTex(this.paqdTexture,hc,this.back.dims):Q.warn("Current version only one probabilistic atlas (PAQD) at a time"),s=this.paqdTexture,this.gl.activeTexture(kC)}c.use(this.gl),this.gl.uniform1i(c.uniforms.hasAlpha,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8UI,n.dims[1],n.dims[2],n.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_BYTE,i)}r.global_min===void 0&&r.calMinMax();let h=null;if(this.gl.bindVertexArray(this.genericVAO),e>1){if(!this.back.dims)throw new Error("back.dims undefined");h=this.rgbaTex(h,PC,this.back.dims),this.gl.bindTexture(this.gl.TEXTURE_3D,h);const R=this.passThroughShader;R.use(this.gl),this.gl.uniform1i(R.uniforms.in3D,2);for(let D=0;D<this.back.dims[3];D++){const B=1/this.back.dims[3]*(D+.5);this.gl.uniform1f(R.uniforms.coordZ,B),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,h,0,D),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}else h=this.rgbaTex(h,PC,[2,2,2,2]);c.use(this.gl),this.gl.activeTexture(hd);let d=null;if(r.colormapLabel!==null&&r.colormapLabel.lut.length>7){const R=r.colormapLabel.max-r.colormapLabel.min+1;d=this.createColormapTexture(d,1,R),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,R,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r.colormapLabel.lut),this.gl.uniform1f(c.uniforms.cal_min,r.colormapLabel.min-.5),this.gl.uniform1f(c.uniforms.cal_max,r.colormapLabel.max+.5),this.gl.bindTexture(this.gl.TEXTURE_2D,d)}else this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.uniform1f(c.uniforms.cal_min,r.cal_min),this.gl.uniform1f(c.uniforms.cal_max,r.cal_max);"alphaThreshold"in r&&(Q.warn("alphaThreshold is deprecated: use colormapType"),r.alphaThreshold===!0&&(r.colormapType=2),r.alphaThreshold===!1&&(r.colormapType=1),delete r.alphaThreshold);const v=r.colormapType!==0?1:0,m=r.colormapType===2?1:0;this.gl.uniform1i(c.uniforms.isAlphaThreshold,m),this.gl.uniform1i(c.uniforms.isColorbarFromZero,v),this.gl.uniform1i(c.uniforms.isAdditiveBlend,this.opts.isAdditiveBlend?1:0);let y=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;if(r.colormapNegative.length>0&&(y=Math.min(-r.cal_min,-r.cal_max),b=Math.max(-r.cal_min,-r.cal_max),isFinite(r.cal_minNeg)&&isFinite(r.cal_maxNeg)&&(y=Math.min(r.cal_minNeg,r.cal_maxNeg),b=Math.max(r.cal_minNeg,r.cal_maxNeg))),e>0&&this.overlayOutlineWidth>0){const R=r.cal_min,D=r.cal_max;let B=Math.min(R,D)<=0&&Math.max(R,D)>=0;!B&&y<b&&(B=y<=0&&b>=0),B&&Q.error("issue1139: do not use overlayOutlineWidth when thresholds cross or touch zero")}if(!c)throw new Error("orientShader undefined");this.gl.uniform1f(c.uniforms.layer??null,e),this.gl.uniform1f(c.uniforms.cal_minNeg??null,y),this.gl.uniform1f(c.uniforms.cal_maxNeg??null,b),this.gl.bindTexture(this.gl.TEXTURE_3D,u),this.gl.uniform1i(c.uniforms.intensityVol??null,9),this.gl.uniform1i(c.uniforms.blend3D??null,10),this.gl.uniform1i(c.uniforms.colormap??null,1),this.gl.uniform1f(c.uniforms.scl_inter??null,n.scl_inter),this.gl.uniform1f(c.uniforms.scl_slope??null,n.scl_slope),this.gl.uniform1f(c.uniforms.opacity??null,a),this.gl.uniform1i(c.uniforms.modulationVol??null,7);let x=null;if(r.modulationImage!==null&&r.modulationImage>=0&&r.modulationImage<this.volumes.length){Q.debug("modulating",this.volumes);const R=this.volumes[r.modulationImage].hdr;if(R.dims[1]===n.dims[1]&&R.dims[2]===n.dims[2]&&R.dims[3]===n.dims[3]){r.modulateAlpha?(this.gl.uniform1i(c.uniforms.modulation,2),this.gl.uniform1f(c.uniforms.opacity,1)):this.gl.uniform1i(c.uniforms.modulation,1),x=this.r8Tex(x,this.gl.TEXTURE7,n.dims,!0),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_3D,x);const D=n.dims[1]*n.dims[2]*n.dims[3],B=new Uint8Array(D),N=this.volumes[r.modulationImage].cal_min,I=1/(this.volumes[r.modulationImage].cal_max-N),P=this.volumes[r.modulationImage].img.buffer;let F=new Uint8Array(P);switch(R.datatypeCode){case 4:F=new Int16Array(P);break;case 16:F=new Float32Array(P);break;case 64:F=new Float64Array(P);break;case 128:F=new Uint8Array(P);break;case 512:F=new Uint16Array(P);break}Q.debug(this.volumes[r.modulationImage]);const O=this.volumes[r.modulationImage].colormapNegative.length>0;let U=this.volumes[r.modulationImage].cal_min,L=this.volumes[r.modulationImage].cal_max;isFinite(this.volumes[r.modulationImage].cal_minNeg)&&isFinite(this.volumes[r.modulationImage].cal_maxNeg)&&(U=this.volumes[r.modulationImage].cal_minNeg,L=this.volumes[r.modulationImage].cal_minNeg),U=Math.abs(U),L=Math.abs(L),U>L&&([U,L]=[L,U]);const V=1/(L-U);let _=Math.abs(r.modulateAlpha);_=Math.max(_,1);const G=this.volumes[r.modulationImage].frame4D*D;for(let K=0;K<D;K++){const z=F[K+G]*R.scl_slope+R.scl_inter;let Y=(z-N)*I;O&&z<0&&(Y=(Math.abs(z)-U)*V),Y=Math.min(Math.max(Y,0),1),Y=Math.pow(Y,_)*255,B[K]=Y}this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,n.dims[1],n.dims[2],n.dims[3],this.gl.RED,this.gl.UNSIGNED_BYTE,B)}else Q.debug("Modulation image dimensions do not match target")}else this.gl.uniform1i(c.uniforms.modulation,0);if(this.gl.uniformMatrix4fv(c.uniforms.mtx,!1,o),!this.back.dims)throw new Error("back.dims undefined");let A=0;n.intent_code===1002&&(A=this.opts.atlasOutline,this.gl.uniform1ui(c.uniforms.activeIndex,this.opts.atlasActiveIndex|0)),this.gl.uniform4fv(c.uniforms.xyzaFrac,[1/this.back.dims[1],1/this.back.dims[2],1/this.back.dims[3],A]),Q.debug("back dims: ",this.back.dims);for(let R=0;R<this.back.dims[3];R++){const D=1/this.back.dims[3]*(R+.5);this.gl.uniform1f(c.uniforms.coordZ,D),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,s,0,R),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}if(this.gl.bindVertexArray(this.unusedVAO),this.gl.deleteTexture(u),this.gl.deleteTexture(x),this.gl.deleteTexture(h),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.deleteFramebuffer(l),e===0&&(this.volumeTexture=s,this.gradientTextureAmount>0&&!this.useCustomGradientTexture?(this.gradientGL(n),this.gl.bindVertexArray(this.genericVAO)):this.gradientTextureAmount<=0&&(this.gradientTexture!==null&&this.gl.deleteTexture(this.gradientTexture),this.gradientTexture=null)),!this.renderShader)throw new Error("renderShader undefined");this.renderShader.use(this.gl);const C=this.sliceScale(!0),E=C.vox,S=C.volScale;if(this.gl.uniform1f(this.renderShader.uniforms.overlays,this.overlays.length),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.gl.uniform1f(this.renderShader.uniforms.backOpacity,this.volumes[0].opacity),this.gl.uniform1f(this.renderShader.uniforms.renderOverlayBlend,this.opts.renderOverlayBlend),this.gl.uniform4fv(this.renderShader.uniforms.clipPlane,this.scene.clipPlane),this.gl.uniform3fv(this.renderShader.uniforms.texVox,E),this.gl.uniform3fv(this.renderShader.uniforms.volScale,S),!this.pickingImageShader)throw new Error("pickingImageShader undefined");this.pickingImageShader.use(this.gl),this.gl.uniform1f(this.pickingImageShader.uniforms.overlays,this.overlays.length),this.gl.uniform3fv(this.pickingImageShader.uniforms.texVox,E),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh);let T=this.sliceMMShader;if(this.opts.is2DSliceShader&&(T=this.slice2DShader),this.opts.isV1SliceShader&&(T=this.sliceV1Shader),this.customSliceShader&&(T=this.customSliceShader),!T)throw new Error("slice shader undefined");T.use(this.gl),this.gl.uniform1f(T.uniforms.overlays,this.overlays.length),this.gl.uniform1f(T.uniforms.drawOpacity,this.drawOpacity),d!==null&&(this.gl.deleteTexture(d),this.gl.activeTexture(hd),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture)),this.gl.uniform1i(T.uniforms.drawing,7),this.gl.activeTexture(is),this.opts.is2DSliceShader?this.gl.bindTexture(this.gl.TEXTURE_2D,this.drawTexture):this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.gl.uniform4fv(T.uniforms.paqdUniforms,this.opts.paqdUniforms),this.gl.uniform1i(T.uniforms.paqd,8),this.gl.activeTexture(hc),this.gl.bindTexture(this.gl.TEXTURE_3D,this.paqdTexture),this.updateInterpolation(e)}colormaps(){return Vt.colormaps()}addColormap(r,e){Vt.addColormap(r,e)}setColormap(r,e){const n=this.getVolumeIndexByID(r);this.volumes[n].colormap=e,this.updateGLVolume()}idx(r,e,n,i){return n*i[0]*i[1]+e*i[0]+r}check_previous_slice(r,e,n,i,a,s,o,l){const u=new Uint32Array(27);let c=0;if(!a)return 0;const h=r[this.idx(n,i,a,s)];if(o>=6){const d=this.idx(n,i,a-1,s);h===r[d]&&(u[c++]=e[d])}if(o>=18){if(n){const d=this.idx(n-1,i,a-1,s);h===r[d]&&(u[c++]=e[d])}if(i){const d=this.idx(n,i-1,a-1,s);h===r[d]&&(u[c++]=e[d])}if(n<s[0]-1){const d=this.idx(n+1,i,a-1,s);h===r[d]&&(u[c++]=e[d])}if(i<s[1]-1){const d=this.idx(n,i+1,a-1,s);h===r[d]&&(u[c++]=e[d])}}if(o===26){if(n&&i){const d=this.idx(n-1,i-1,a-1,s);h===r[d]&&(u[c++]=e[d])}if(n<s[0]-1&&i){const d=this.idx(n+1,i-1,a-1,s);h===r[d]&&(u[c++]=e[d])}if(n&&i<s[1]-1){const d=this.idx(n-1,i+1,a-1,s);h===r[d]&&(u[c++]=e[d])}if(n<s[0]-1&&i<s[1]-1){const d=this.idx(n+1,i+1,a-1,s);h===r[d]&&(u[c++]=e[d])}}return c?(this.fill_tratab(l,u,c),u[0]):0}do_initial_labelling(r,e,n){let i=1;const a=8192;let s=a,o=new Uint32Array(s).fill(0);const l=new Uint32Array(e[0]*e[1]*e[2]).fill(0),u=new Uint32Array(27);for(let c=0;c<e[2];c++)for(let h=0;h<e[1];h++)for(let d=0;d<e[0];d++){let v=0;const m=r[this.idx(d,h,c,e)];if(m!==0){if(u[0]=this.check_previous_slice(r,l,d,h,c,e,n,o),u[0]&&(v+=1),n>=6){if(d){const y=this.idx(d-1,h,c,e);m===r[y]&&(u[v++]=l[y])}if(h){const y=this.idx(d,h-1,c,e);m===r[y]&&(u[v++]=l[y])}}if(n>=18){if(h&&d){const y=this.idx(d-1,h-1,c,e);m===r[y]&&(u[v++]=l[y])}if(h&&d<e[0]-1){const y=this.idx(d+1,h-1,c,e);m===r[y]&&(u[v++]=l[y])}}if(v)l[this.idx(d,h,c,e)]=u[0],this.fill_tratab(o,u,v);else{if(l[this.idx(d,h,c,e)]=i,i>=s){s+=a;const y=new Uint32Array(s);y.set(o),o=y}o[i-1]=i,i++}}}for(let c=0;c<i-1;c++){let h=c;for(;o[h]!==h+1;)h=o[h]-1;o[c]=h+1}return[i-1,o,l]}fill_tratab(r,e,n){let i=0;const a=new Uint32Array(n+5).fill(0);let o=2147483647;for(let l=0;l<n;l++){let u=e[l];for(i=0;r[u-1]!==u;)if(u=r[u-1],i++,i>100){Q.info(`
Ooh no!!`);break}a[l]=u,o=Math.min(o,u)}for(let l=0;l<n;l++)r[a[l]-1]=o}translate_labels(r,e,n,i){const a=e[0]*e[1]*e[2];let s=0;const o=new Uint32Array(a).fill(0);for(let c=0;c<i;c++)s=Math.max(s,n[c]);const l=new Uint32Array(s).fill(0);let u=0;for(let c=0;c<a;c++)r[c]&&(l[n[r[c]-1]-1]||(u+=1,l[n[r[c]-1]-1]=u),o[c]=l[n[r[c]-1]-1]);return[u,o]}largest_original_cluster_labels(r,e,n){const i=r.length,a=new Uint32Array(e+1).fill(0),s=new Uint32Array(e+1).fill(0);for(let u=0;u<i;u++){const c=r[u],h=n[u];a[h]=c,s[h]++}let o=0;for(let u=0;u<e+1;u++){const c=a[u];o=Math.max(o,c);for(let h=0;h<e+1;h++)h!==u&&c===a[h]&&(s[u]<s[h]||s[u]===s[h]&&u<h)&&(a[u]=0)}const l=new Uint32Array(i).fill(0);for(let u=0;u<i;u++)l[u]=a[n[u]];return[o,l]}bwlabel(r,e,n=26,i=!1,a=!1){const s=Date.now(),o=e[0]*e[1]*e[2],l=new Uint32Array(o).fill(0);if(![6,18,26].includes(n))return Q.info("bwlabel: conn must be 6, 18 or 26."),[0,l];if(e[0]<2||e[1]<2||e[2]<1)return Q.info("bwlabel: img must be 2 or 3-dimensional"),[0,l];if(i)for(let m=0;m<o;m++)r[m]!==0&&(l[m]=1);else l.set(r);let[u,c,h]=this.do_initial_labelling(l,e,n);c===void 0&&(c=new Uint32Array);const[d,v]=this.translate_labels(h,e,c,u);if(Q.info(n+" neighbor clustering into "+d+" regions in "+(Date.now()-s)+"ms"),a){const[m,y]=this.largest_original_cluster_labels(l,d,v);return[m,y]}return[d,v]}async createConnectedLabelImage(r,e=26,n=!1,i=!1){const a=this.getVolumeIndexByID(r),s=Uint32Array.from(this.volumes[a].dims?.slice(1,4)??[]),o=Uint32Array.from(this.volumes[a].img?.slice()??[]),[l,u]=this.bwlabel(o,s,e,n,i),c=this.volumes[a].clone();c.opacity=.5,c.colormap="random";for(let h=0;h<c.img.length;h++)c.img[h]=u[h];return c.cal_min=0,c.cal_max=l,c}async scalecropUint8(r,e=0,n=255,i,a){const s=r.length,o=new Uint8Array(s);for(let l=0;l<s;l++){let u=r[l];u=e+a*(u-i),u=Math.max(u,e),u=Math.min(u,n),o[l]=u}return o}async scalecropFloat32(r,e=0,n=1,i,a){const s=r.length,o=new Float32Array(s);for(let l=0;l<s;l++){let u=r[l];u=e+a*(u-i),u=Math.max(u,e),u=Math.min(u,n),o[l]=u}return o}getScale(r,e=0,n=255,i=0,a=.999){let s=r.global_min,o=r.global_max;if(r.hdr.datatypeCode===2)return[s,1];if((!isFinite(i)||!isFinite(a))&&isFinite(r.cal_min)&&isFinite(r.cal_max)&&r.cal_max>r.cal_min){s=r.cal_min,o=r.cal_max;const C=(n-e)/(o-s);return Q.info(" Robust Rescale:  min: "+s+"  max: "+o+" scale: "+C),[s,C]}let l=r.img;const u=r.hdr.dims[1]*r.hdr.dims[2]*r.hdr.dims[3];if(r.hdr.scl_slope!==1||r.hdr.scl_inter!==0){const C=r.img;l=new Float32Array(r.img.length);for(let E=0;E<u;E++)l[E]=C[E]*r.hdr.scl_slope+r.hdr.scl_inter}if(s<0&&Q.warn("WARNING: Input image has value(s) below 0.0 !"),Q.info(" Input:    min: "+s+"  max: "+o),i===0&&a===1)return[s,1];let c=0;for(let C=0;C<u;C++)Math.abs(l[C])>=1e-15&&c++;const h=1e3,d=(o-s)/h,v=new Array(h).fill(0);for(let C=0;C<u;C++){const E=l[C];let S=Math.floor((E-s)/d);S=Math.min(S,h-1),v[S]++}const m=new Array(h).fill(0);m[0]=v[0];for(let C=1;C<h;C++)m[C]=m[C-1]+v[C];let y=Math.floor(i*u),b=0;for(;b<h&&!(m[b]>=y);)b++;const x=s;for(s=b*d+x,y=u-Math.floor((1-a)*c),b=0;b<h-1&&!(m[b+1]>=y);)b++;o=b*d+x;let A=1;return s!==o&&(A=(n-e)/(o-s)),Q.info(" Rescale:  min: "+s+"  max: "+o+" scale: "+A),[s,A]}conformVox2Vox(r,e,n=256,i=1,a=!1){const s=e.flat(),o=Hn(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9],s[10],s[11],s[12],s[13],s[14],s[15]),l=er(r[1]/2,r[2]/2,r[3]/2,1),u=Yi(),c=Tt();Yn(c,o),qr(u,l,c);const h=Me(u[0],u[1],u[2]),d=Me(i,i,i);let v=Hn(-1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1);a&&(v=Hn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),Yn(v,v);const m=er(n,n,n,1),y=Tt();X4(y,v,d);const b=er(m[0],m[1],m[2],1);qr(b,b,y),U_(b,b,.5);const x=Kt();$t(x,h,Me(b[0],b[1],b[2]));const A=Tt();Yn(A,y),A[3]=x[0],A[7]=x[1],A[11]=x[2];const C=Tt();Mn(C,A);const E=Tt();G6(E,o,C);const S=Tt();return Mn(S,E),[A,E,S]}async createNiftiArray(r=[256,256,256],e=[1,1,1],n=[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],i=2,a=new Uint8Array){return await gn.createNiftiArray(r,e,n,i,a)}async niftiArray2NVImage(r=new Uint8Array){return await gn.loadFromUrl({url:r})}async loadFromUrl(r){return await gn.loadFromUrl({url:r})}async conform(r,e=!1,n=!0,i=!1,a=!1){const l=this.conformVox2Vox(r.hdr.dims,r.hdr.affine.flat(),256,1,e),u=l[0],c=l[2],h=256*256*256,d=new Float32Array(h),v=new Float32Array(r.img),m=r.hdr.dims[1]*r.hdr.dims[2]*r.hdr.dims[3];if(r.hdr.scl_slope!==1||r.hdr.scl_inter!==0)for(let I=0;I<m;I++)v[I]=v[I]*r.hdr.scl_slope+r.hdr.scl_inter;const y=r.hdr.dims[1],b=r.hdr.dims[2],x=r.hdr.dims[3],A=y*b;let C=-1;function E(I,P,F){return I+P*y+F*A}const S=c[0],T=c[4],R=c[8];if(n)for(let I=0;I<256;I++)for(let P=0;P<256;P++){const F=P*c[1]+I*c[2]+c[3],O=P*c[5]+I*c[6]+c[7],U=P*c[9]+I*c[10]+c[11];for(let L=0;L<256;L++){const V=L*S+F,_=L*T+O,G=L*R+U,K=Math.floor(V),z=Math.floor(_),Y=Math.floor(G);if(C++,K<0||z<0||Y<0)continue;const Z=Math.ceil(V),J=Math.ceil(_),ee=Math.ceil(G);if(Z>=y||J>=b||ee>=x)continue;const ne=V-K,oe=_-z,me=G-Y,ye=1-ne,ve=1-oe,re=1-me,ae=E(K,z,Y);let le=0;le+=v[ae]*ye*ve*re,le+=v[ae+A]*ye*ve*me,le+=v[ae+y]*ye*oe*re,le+=v[ae+y+A]*ye*oe*me,le+=v[ae+1]*ne*ve*re,le+=v[ae+1+A]*ne*ve*me,le+=v[ae+1+y]*ne*oe*re,le+=v[ae+1+y+A]*ne*oe*me,d[C]=le}}else for(let I=0;I<256;I++)for(let P=0;P<256;P++){const F=P*c[1]+I*c[2]+c[3],O=P*c[5]+I*c[6]+c[7],U=P*c[9]+I*c[10]+c[11];for(let L=0;L<256;L++){const V=Math.round(L*S+F),_=Math.round(L*T+O),G=Math.round(L*R+U);C++,!(V<0||_<0||G<0)&&(V>=y||_>=b||G>=x||(d[C]=v[E(V,_,G)]))}}let D=0;a&&(D=NaN);let B=new Uint8Array;if(i){const I=await this.getScale(r,0,1,D),P=await this.scalecropFloat32(d,0,1,I[0],I[1]);B=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(u),16,new Uint8Array(P.buffer))}else{const I=await this.getScale(r,0,255,D),P=await this.scalecropUint8(d,0,255,I[0],I[1]);B=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(u),2,P)}return await this.niftiArray2NVImage(B)}setRenderDrawAmbientOcclusion(r){if(!this.renderShader)throw new Error("renderShader undefined");this.renderDrawAmbientOcclusion=r,this.renderShader.use(this.gl),this.gl.uniform1fv(this.renderShader.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.drawScene()}setColorMap(r,e){this.setColormap(r,e)}setColormapNegative(r,e){const n=this.getVolumeIndexByID(r);this.volumes[n].colormapNegative=e,this.updateGLVolume()}setModulationImage(r,e,n=0){const i=this.getVolumeIndexByID(r);let a=null;e.length>0&&(a=this.getVolumeIndexByID(e)),this.volumes[i].modulationImage=a,this.volumes[i].modulateAlpha=n,this.updateGLVolume()}setGamma(r=1){this.scene.gamma=r,Vt.gamma=r,this.updateGLVolume()}async loadDeferred4DVolumes(r){const e=this.getVolumeIndexByID(r),n=this.volumes[e];if(n.nTotalFrame4D<=n.nFrame4D)return;n.nTotalFrame4D=n.nFrame4D;let i;n.fileObject?i=await gn.loadFromFile({file:n.fileObject}):i=await gn.loadFromUrl({url:n.url}),i&&(n.img=i.img.slice(),n.nTotalFrame4D=i.nTotalFrame4D,n.nFrame4D=i.nFrame4D,this.updateGLVolume())}setFrame4D(r,e){const n=this.getVolumeIndexByID(r),i=this.volumes[n];e>i.nFrame4D-1&&(e=i.nFrame4D-1),e<0&&(e=0),e!==i.frame4D&&(i.frame4D=e,this.updateGLVolume(),this.onFrameChange(i,e),this.createOnLocationChange())}getFrame4D(r){const e=this.getVolumeIndexByID(r);return this.volumes[e].frame4D}colormapFromKey(r){return Vt.colormapFromKey(r)}colormap(r="",e=!1){return Vt.colormap(r,e)}createColormapTexture(r=null,e=0,n=256){return r!==null&&this.gl.deleteTexture(r),e<1||n<1?null:(r=this.gl.createTexture(),this.gl.activeTexture(hd),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,n,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),r)}addColormapList(r="",e=NaN,n=NaN,i=!1,a=!1,s=!0,o=!1){r.length<1&&(s=!1),this.colormapLists.push({name:r,min:e,max:n,isColorbarFromZero:i,negative:a,visible:s,invert:o})}refreshColormaps(){if(this.colormapLists=[],this.volumes.length<1&&this.meshes.length<1)return;const r=this.volumes.length;if(r>0)for(let s=0;s<r;s++){const o=this.volumes[s],l=ip(o.cal_min,o.cal_max,o.cal_minNeg,o.cal_maxNeg),u=o.colormapType!==0;this.addColormapList(o.colormapNegative,l[0],l[1],u,!0,o.colorbarVisible,o.colormapInvert),this.addColormapList(o.colormap,o.cal_min,o.cal_max,u,!1,o.colorbarVisible,o.colormapInvert)}const e=this.meshes.length;if(e>0)for(let s=0;s<e;s++){const o=this.meshes[s];if(!o.colorbarVisible)continue;const l=o.layers.length;if("edgeColormap"in o&&"edges"in o&&o.edges!==void 0){const u=ip(o.edgeMin,o.edgeMax,NaN,NaN);this.addColormapList(o.edgeColormapNegative,u[0],u[1],!1,!0,!0,o.colormapInvert),this.addColormapList(o.edgeColormap,o.edgeMin,o.edgeMax,!1,!1,!0,o.colormapInvert)}if(!(l<1))for(let u=0;u<l;u++){const c=this.meshes[s].layers[u];if(!c.colorbarVisible||c.colormap.length<1)continue;const h=c.colormapType!==0;if(c.useNegativeCmap){const d=ip(c.cal_min,c.cal_max,c.cal_minNeg,c.cal_maxNeg);this.addColormapList(c.colormapNegative,d[0],d[1],h,!0,!0,c.colormapInvert)}this.addColormapList(c.colormap,c.cal_min,c.cal_max,h,!1,!0,c.colormapInvert)}}const n=this.colormapLists.length;if(n<1)return;this.colormapTexture=this.createColormapTexture(this.colormapTexture,n+1);let i=new Uint8ClampedArray;function a(s){const o=new Uint8ClampedArray(i.length+s.length);o.set(i),o.set(s,i.length),i=o}for(let s=0;s<n;s++)a(Array.from(this.colormap(this.colormapLists[s].name,this.colormapLists[s].invert)));return a(Array.from(this.drawLut.lut)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,256,n+1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),this}sliceScale(r=!1){let e=this.screenFieldOfViewMM(0);r&&(e=this.screenFieldOfViewVox(0));const n=Math.max(e[0],Math.max(e[1],e[2])),i=[e[0]/n,e[1]/n,e[2]/n];if(!this.back?.dims)throw new Error("back.dims undefined");const a=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];return{volScale:i,vox:a,longestAxis:n,dimsMM:e}}tileIndex(r,e){for(let n=0;n<this.screenSlices.length;n++){const i=this.screenSlices[n].leftTopWidthHeight;if(r>i[0]&&e>i[1]&&r<i[0]+i[2]&&e<i[1]+i[3])return n}return-1}inRenderTile(r,e){const n=this.tileIndex(r,e);return n>=0&&this.screenSlices[n].axCorSag===4?n:-1}sliceScroll3D(r=0){if(r!==0){if(this.volumes.length>0&&this.scene.clipPlaneDepthAziElev[0]<1.8){const e=this.scene.clipPlaneDepthAziElev.slice();return r>0&&(e[0]=Math.min(1.5,e[0]+.025)),r<0&&(e[0]=Math.max(-1.5,e[0]-.025)),e[0]!==this.scene.clipPlaneDepthAziElev[0]?(this.scene.clipPlaneDepthAziElev=e,this.setClipPlane(this.scene.clipPlaneDepthAziElev)):void 0}r>0&&(this.scene.volScaleMultiplier=Math.min(2,this.scene.volScaleMultiplier*1.1)),r<0&&(this.scene.volScaleMultiplier=Math.max(.5,this.scene.volScaleMultiplier*.9)),this.drawScene()}}deleteThumbnail(){this.bmpTexture&&(this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=null,this.thumbnailVisible=!1)}inGraphTile(r,e){if(this.graph.opacity<=0||this.volumes.length<1||this.volumes[0].nFrame4D<1||!this.graph.plotLTWH||this.graph.plotLTWH[2]<1||this.graph.plotLTWH[3]<1)return!1;const n=[(r-this.graph.LTWH[0])/this.graph.LTWH[2],(e-this.graph.LTWH[1])/this.graph.LTWH[3]];return n[0]>0&&n[1]>0&&n[0]<=1&&n[1]<=1}updateBitmapFromClickToSegment(){if(this.clickToSegmentGrowingBitmap===null||this.drawBitmap===null||this.clickToSegmentGrowingBitmap.length!==this.drawBitmap.length)return;const r=this.drawBitmap.length;for(let e=0;e<r;e++)this.drawBitmap[e]=this.clickToSegmentGrowingBitmap[e]}sumBitmap(r){let e=0;for(let n=0;n<r.length;n++)e+=r[n];return e}doClickToSegment(r){const{tileIndex:e}=r;if(e<0||e>=this.screenSlices.length){Q.warn(`Invalid tileIndex ${e} received in doClickToSegment.`);return}const n=this.screenSlices[e].axCorSag;if(n>2){Q.warn("ClickToSegment attempted on non-2D slice tile.");return}const i=this.screenXY2TextureFrac(this.clickToSegmentXY[0],this.clickToSegmentXY[1],e,!1);if(i[0]<0){Q.debug("Click location outside valid texture fraction for the tile.");return}const a=this.frac2vox(i),s=this.opts.clickToSegmentPercent;let o=this.back.getValue(a[0],a[1],a[2]);this.opts.clickToSegmentAutoIntensity&&(s!==0&&(o===0&&(o=.01),this.opts.clickToSegmentIntensityMax=o*(1+s),this.opts.clickToSegmentIntensityMin=o*(1-s)),o>(this.back.cal_min+this.back.cal_max)*.5?this.opts.clickToSegmentBright=!0:this.opts.clickToSegmentBright=!1);const l=this.opts.clickToSegmentBright?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;this.drawPenAxCorSag=n;const u=this.clickToSegmentIsGrowing?this.clickToSegmentGrowingBitmap:this.drawBitmap;if(!u){if(Q.error("Target bitmap for flood fill is null."),this.clickToSegmentIsGrowing){if(this.drawBitmap||this.createEmptyDrawing(),!this.drawBitmap)return;this.clickToSegmentGrowingBitmap=this.drawBitmap.slice()}else if(this.createEmptyDrawing(),!this.drawBitmap)return;Q.warn("Initialized missing bitmap in doClickToSegment.")}if(this.drawFloodFill([a[0],a[1],a[2]],this.opts.penValue,l,this.opts.clickToSegmentIntensityMin,this.opts.clickToSegmentIntensityMax,this.opts.floodFillNeighbors,this.opts.clickToSegmentMaxDistanceMM,this.opts.clickToSegmentIs2D,u),!this.clickToSegmentIsGrowing&&(Q.debug("Applying clickToSegment mask to drawBitmap."),this.drawBitmap?(this.refreshDrawing(!1,!1),this.drawScene()):Q.error("Cannot refresh drawing after click-to-segment apply, drawBitmap is null."),this.drawBitmap)){const c=this.getDescriptives({layer:0,masks:[],drawingIsMask:!0});this.onClickToSegment({mL:c.volumeML,mm3:c.volumeMM3})}this.createOnLocationChange(n)}mouseClick(r,e,n=0,i=!0){if(r*=this.uiData.dpr,e*=this.uiData.dpr,this.canvas.focus(),this.thumbnailVisible){this.thumbnailVisible=!1,Promise.all([this.loadVolumes(this.deferredVolumes),this.loadMeshes(this.deferredMeshes)]).catch(a=>{throw a});return}if(this.inGraphTile(r,e)){if(!this.graph.plotLTWH)throw new Error("plotLTWH undefined");const a=[(r-this.graph.plotLTWH[0])/this.graph.plotLTWH[2],(e-this.graph.plotLTWH[1])/this.graph.plotLTWH[3]];if(a[0]>0&&a[1]>0&&a[0]<=1&&a[1]<=1){const s=Math.round(a[0]*(this.volumes[0].nFrame4D-1));this.setFrame4D(this.volumes[0].id,s);return}a[0]>.5&&a[1]>1&&this.loadDeferred4DVolumes(this.volumes[0].id).catch(s=>{throw s});return}if(this.inRenderTile(r,e)>=0){this.sliceScroll3D(n),this.drawScene();return}if(!(this.screenSlices.length<1||this.gl.canvas.height<1||this.gl.canvas.width<1))for(let a=0;a<this.screenSlices.length;a++){const s=this.screenSlices[a].axCorSag;if(this.drawPenAxCorSag>=0&&this.drawPenAxCorSag!==s||s>2&&!this.opts.clickToSegment&&n===0)continue;const o=this.screenXY2TextureFrac(r,e,a,!0);if(!(o[0]<0)){if(n!==0||!i){if(!i){s<=2&&(this.scene.crosshairPos[2-s]=n,this.drawScene(),this.createOnLocationChange(s));return}const l=n<0?-1:1,u=[0,0,0];s<=2&&(u[2-s]=l,this.moveCrosshairInVox(u[0],u[1],u[2]));return}if(this.opts.isForceMouseClickToVoxelCenters?this.scene.crosshairPos=bi(this.vox2frac(this.frac2vox(o))):this.scene.crosshairPos=bi(o),this.opts.drawingEnabled){const l=this.frac2vox(this.scene.crosshairPos);if(!isFinite(this.opts.penValue)||this.opts.penValue<0||Object.is(this.opts.penValue,-0)){let u=0,c=Math.abs(this.opts.penValue);const h=!0;Object.is(this.opts.penValue,-0)?(u=0,c=0,Q.debug("Erase Cluster selected")):(u=this.opts.penValue,Q.debug("Intensity Grow selected",u)),this.drawFloodFill(l,c,u,NaN,NaN,this.opts.floodFillNeighbors,Number.POSITIVE_INFINITY,!1,this.drawBitmap,h),this.drawScene(),this.createOnLocationChange(s);return}else if(this.opts.clickToSegment){s<=2&&(this.clickToSegmentIsGrowing=!1,this.doClickToSegment({x:this.clickToSegmentXY[0],y:this.clickToSegmentXY[1],tileIndex:a})),this.createOnLocationChange(s);return}else if(this.opts.penType===0){if(isNaN(this.drawPenLocation[0]))this.drawPenAxCorSag=s,this.drawPenFillPts=[],this.drawPt(...l,this.opts.penValue);else{if(l[0]===this.drawPenLocation[0]&&l[1]===this.drawPenLocation[1]&&l[2]===this.drawPenLocation[2]){this.drawScene(),this.createOnLocationChange(s);return}this.drawPenLine(l,this.drawPenLocation,this.opts.penValue)}this.drawPenLocation=l,this.opts.isFilledPen&&this.drawPenFillPts.push(l),this.refreshDrawing(!1,!1)}else(this.opts.penType===1||this.opts.penType===2)&&(isNaN(this.drawShapeStartLocation[0])?(this.drawPenAxCorSag=s,this.drawShapeStartLocation=[...l],this.drawBitmap&&(this.drawShapePreviewBitmap=this.drawBitmap.slice())):this.drawShapePreviewBitmap&&this.drawBitmap&&(this.drawBitmap.set(this.drawShapePreviewBitmap),this.opts.penType===1?this.drawRectangleMask(this.drawShapeStartLocation,l,this.opts.penValue):this.opts.penType===2&&this.drawEllipseMask(this.drawShapeStartLocation,l,this.opts.penValue),this.refreshDrawing(!1,!1)))}this.drawScene(),this.createOnLocationChange(s);return}}}drawRuler(){let r=[],e=[];for(let h=0;h<this.screenSlices.length;h++)if(this.screenSlices[h].axCorSag!==4&&this.screenSlices[h].fovMM.length>1){e=this.screenSlices[h].leftTopWidthHeight,r=this.screenSlices[h].fovMM;break}if(e.length<4)return;const i=100/r[0]*e[2],a=Math.max(Math.round(i*.1),2),s=Math.floor(e[0]+.5*e[2]-.5*i),o=Number(this.opts.rulerWidth),l=Math.floor(e[1]+e[3]-a)+.5*o,u=[s,l,s+i,l];let c=[0,0,0,1];this.opts.rulerColor[0]+this.opts.rulerColor[1]+this.opts.rulerColor[2]<.8&&(c=[1,1,1,1]),this.drawRuler10cm(u,c,o+1),this.drawRuler10cm(u,this.opts.rulerColor,o)}drawRuler10cm(r,e,n=1){if(!this.lineShader)throw new Error("lineShader undefined");this.gl.bindVertexArray(this.genericVAO),this.lineShader.use(this.gl),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,e),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,n),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,r),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);const i=-.1*(r[0]-r[2]),a=r[1]-Math.floor(.5*this.opts.rulerWidth),s=Math.floor(a-.35*i),o=Math.floor(a-.7*i);for(let l=0;l<11;l++){let u=r[0]+l*i;u=Math.max(u,r[0]+.5*n),u=Math.min(u,r[2]-.5*n);const c=[u,a,u,s];l%5===0&&(c[3]=o),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,c),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}this.gl.bindVertexArray(this.unusedVAO)}screenXY2mm(r,e,n=-1){let i;for(let a=0;a<this.screenSlices.length;a++){let s=a;if(n>=0&&(s=n),this.screenSlices[s].axCorSag>2)continue;const l=this.screenSlices[s].leftTopWidthHeight;if(r<l[0]||e<l[1]||r>l[0]+l[2]||e>l[1]+l[3]||(i=this.screenXY2TextureFrac(r,e,s,!1),i[0]<0))continue;const u=this.frac2mm(i);return er(u[0],u[1],u[2],s)}return er(NaN,NaN,NaN,NaN)}dragForPanZoom(r){const e=this.screenXY2mm(r[2],r[3]);if(isNaN(e[0]))return;const n=this.screenXY2mm(r[0],r[1],e[3]);if(isNaN(n[0])||isNaN(e[0])||isNaN(e[3]))return;const i=Yi(),a=this.uiData.pan2DxyzmmAtMouseDown[3];V_(i,e,n),this.scene.pan2Dxyzmm[0]=this.uiData.pan2DxyzmmAtMouseDown[0]+a*i[0],this.scene.pan2Dxyzmm[1]=this.uiData.pan2DxyzmmAtMouseDown[1]+a*i[1],this.scene.pan2Dxyzmm[2]=this.uiData.pan2DxyzmmAtMouseDown[2]+a*i[2],this.canvas.focus()}dragForCenterButton(r){this.dragForPanZoom(r)}dragForSlicer3D(r){let e=this.uiData.pan2DxyzmmAtMouseDown[3];const n=r[3]-r[1];e+=n*.01,e=Math.max(e,.1),e=Math.min(e,10);const a=this.scene.pan2Dxyzmm[3]-e;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=e),this.scene.pan2Dxyzmm[3]=e;const s=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=a*s[0],this.scene.pan2Dxyzmm[1]+=a*s[1],this.scene.pan2Dxyzmm[2]+=a*s[2]}drawMeasurementTool(r,e=!0){function n(c,h,d,v,m){const y=c-d,b=h-v;if(y===0&&b===0)return{origin:[d+m,v],terminus:[d+m,v]};const x=Math.sqrt(y*y+b*b),A=m*y/x,C=m*b/x;return{origin:[c+A,h+C],terminus:[d-A,v-C]}}const i=this.gl;if(i.bindVertexArray(this.genericVAO),i.depthFunc(i.ALWAYS),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),i.uniform4fv(this.lineShader.uniforms.lineColor,this.opts.rulerColor),i.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[i.canvas.width,i.canvas.height]),i.uniform1f(this.lineShader.uniforms.thickness,this.opts.rulerWidth),i.uniform4fv(this.lineShader.uniforms.startXYendXY,r),i.drawArrays(i.TRIANGLE_STRIP,0,4);const a=this.opts.measureLineColor;a[3]=1,i.uniform4fv(this.lineShader.uniforms.lineColor,a);const s=this.opts.rulerWidth;i.uniform1f(this.lineShader.uniforms.thickness,s*2);let o=[r[0],r[1]-s,r[0],r[1]+s];i.uniform4fv(this.lineShader.uniforms.startXYendXY,o),i.drawArrays(i.TRIANGLE_STRIP,0,4),o=[r[2],r[3]-s,r[2],r[3]+s],i.uniform4fv(this.lineShader.uniforms.startXYendXY,o),i.drawArrays(i.TRIANGLE_STRIP,0,4);let l=this.canvasPos2frac([r[0],r[1]]),u=this.canvasPos2frac([r[2],r[3]]);if(l[0]>=0&&u[0]>=0){const c=this.frac2mm(l);l=Me(c[0],c[1],c[2]);const h=this.frac2mm(u);u=Me(h[0],h[1],h[2]);const d=Kt();W4(d,l,u);const v=Zc(d);let m=2;v>9&&(m=1),v>99&&(m=0);let y=v.toFixed(m);this.opts.showMeasureUnits&&(y=`${y} mm`);let b=r;const[x,A,C,E]=r,{origin:S,terminus:T}=n(x,A,C,E,30);switch(this.opts.measureTextJustify){case"start":b=[...S,...S.map(R=>R+1)];break;case"end":b=b=[...T,...T.map(R=>R+1)];break;default:b=r;break}e&&this.drawTextBetween(b,y,this.opts.measureTextHeight/.06,this.opts.measureTextColor)}i.bindVertexArray(this.unusedVAO)}drawAngleMeasurementTool(){this.uiData.angleState==="drawing_first_line"?this.drawMeasurementTool([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],!1):this.uiData.angleState==="drawing_second_line"&&(this.drawMeasurementTool(this.uiData.angleFirstLine,!1),this.drawMeasurementTool([this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],!1),this.drawAngleText())}drawAngleText(){const r=this.uiData.angleFirstLine,e=[this.uiData.angleFirstLine[2],this.uiData.angleFirstLine[3],this.uiData.dragEnd[0],this.uiData.dragEnd[1]],n=this.calculateAngleBetweenLines(r,e),i=this.uiData.angleFirstLine[2],a=this.uiData.angleFirstLine[3],s=`${n.toFixed(1)}°`;this.drawTextBetween([i,a,i+1,a+1],s,this.opts.measureTextHeight/.06,this.opts.measureTextColor)}drawAngleTextForAngle(r){const e=this.calculateAngleBetweenLines(r.firstLine,r.secondLine),n=r.firstLine[2],i=r.firstLine[3],a=`${e.toFixed(1)}°`;this.drawTextBetween([n,i,n+1,i+1],a,this.opts.measureTextHeight/.06,this.opts.measureTextColor)}calculateAngleBetweenLines(r,e){const n=r[2],i=r[3],a=r[0]-n,s=r[1]-i,o=e[2]-n,l=e[3]-i,u=a*o+s*l,c=Math.sqrt(a*a+s*s),h=Math.sqrt(o*o+l*l);if(c===0||h===0)return 0;const d=Math.max(-1,Math.min(1,u/(c*h)));return Math.acos(d)*(180/Math.PI)}resetAngleMeasurement(){this.uiData.angleState="none",this.uiData.angleFirstLine=[0,0,0,0]}getCurrentSliceInfo(){const r=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]);if(r>=0&&r<this.screenSlices.length){const i=this.screenSlices[r].axCorSag;let a=0;return i===0?a=this.scene.crosshairPos[2]:i===1?a=this.scene.crosshairPos[1]:i===2&&(a=this.scene.crosshairPos[0]),{sliceIndex:r,sliceType:i,slicePosition:a}}const e=this.opts.sliceType;let n=0;return e===0?n=this.scene.crosshairPos[2]:e===1?n=this.scene.crosshairPos[1]:e===2?n=this.scene.crosshairPos[0]:e===3&&this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]])[0]>=0&&(n=this.scene.crosshairPos[2]),{sliceIndex:-1,sliceType:e,slicePosition:n}}getCurrentSlicePosition(r){return r===0?this.scene.crosshairPos[2]:r===1?this.scene.crosshairPos[1]:r===2?this.scene.crosshairPos[0]:0}shouldDrawOnCurrentSlice(r,e,n){if(this.opts.sliceType===3){if(e>2)return!1;for(let l=0;l<this.screenSlices.length;l++)if(this.screenSlices[l].axCorSag===e){const u=this.getCurrentSlicePosition(e);if(Math.abs(u-n)<.001)return!0}return!1}else if(this.opts.sliceType!==e)return!1;const i=this.getCurrentSlicePosition(e);return Math.abs(i-n)<.001}clearMeasurements(){this.document.completedMeasurements=[],this.drawScene()}clearAngles(){this.document.completedAngles=[],this.drawScene()}clearAllMeasurements(){this.document.completedMeasurements=[],this.document.completedAngles=[],this.drawScene()}setDragMode(r){if(typeof r=="string")switch(r){case"none":this.opts.dragMode=0;break;case"contrast":this.opts.dragMode=1;break;case"measurement":this.opts.dragMode=2;break;case"angle":this.opts.dragMode=7;break;case"pan":this.opts.dragMode=3;break;case"slicer3D":this.opts.dragMode=4;break;case"callbackOnly":this.opts.dragMode=5;break;case"roiSelection":this.opts.dragMode=6;break;default:console.warn(`Unknown drag mode: ${r}`);return}else this.opts.dragMode=r;this.opts.dragMode!==7&&this.resetAngleMeasurement(),this.clearActiveDragMode()}setMouseEventConfig(r){this.opts.mouseEventConfig=r,this.clearActiveDragMode()}setTouchEventConfig(r){this.opts.touchEventConfig=r,this.clearActiveDragMode()}getMouseEventConfig(){return this.opts.mouseEventConfig}getTouchEventConfig(){return this.opts.touchEventConfig}drawRect(r,e=[1,0,0,-1]){if(e[3]<0&&(e=this.opts.crosshairColor),!this.rectShader)throw new Error("rectShader undefined");this.opts.selectionBoxIsOutline?(this.drawCircle(r,e,.1),this.rectOutlineShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform1f(this.rectOutlineShader.uniforms.thickness,this.opts.selectionBoxLineThickness),this.gl.uniform4fv(this.rectOutlineShader.uniforms.lineColor,e),this.gl.uniform2fv(this.rectOutlineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectOutlineShader.uniforms.leftTopWidthHeight,r[0],r[1],r[2],r[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)):(this.rectShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.rectShader.uniforms.lineColor,e),this.gl.uniform2fv(this.rectShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectShader.uniforms.leftTopWidthHeight,r[0],r[1],r[2],r[3]),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO))}drawCircle(r,e=this.opts.fontColor,n=1){if(!this.circleShader)throw new Error("circleShader undefined");this.circleShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,e),this.gl.uniform2fv(this.circleShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.circleShader.uniforms.leftTopWidthHeight,r[0],r[1],r[2],r[3]),this.gl.uniform1f(this.circleShader.uniforms.fillPercent,n),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,e),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawSelectionBox(r){if(this.getCurrentDragMode()===6){this.drawCircle(r,this.opts.selectionBoxColor,.1);return}this.drawRect(r,this.opts.selectionBoxColor)}effectiveCanvasHeight(){return this.gl.canvas.height-this.colorbarHeight}effectiveCanvasWidth(){return this.gl.canvas.width-this.getLegendPanelWidth()}getAllLabels(){const i=this.meshes.filter(s=>s.type==="connectome").flatMap(s=>s.nodes).map(s=>s.label).filter(s=>s!==void 0);return[...this.document.labels,...i]}getConnectomeLabels(){const i=this.meshes.filter(l=>l.type==="connectome"&&l.showLegend!==!1).flatMap(l=>l.nodes).map(l=>l.label).filter(l=>l!==void 0&&l.text!==""),a=this.document.labels.filter(l=>l.anchor==null||l.anchor===0),s=new Set(i);for(const l of a)s.add(l);const o=this.meshes.filter(l=>l.type==="mesh");for(let l=0;l<o.length;l++)for(let u=0;u<o[l].layers.length;u++)if(o[l].layers[u].labels)for(let c=0;c<o[l].layers[u].labels.length;c++)s.add(o[l].layers[u].labels[c]);return Array.from(s)}getBulletMarginWidth(){let r=0;const e=this.getConnectomeLabels();if(e.length===0)return 0;const n=e.length===1?e[0].style.bulletScale:e.reduce((s,o)=>s.style.bulletScale>o.style.bulletScale?s:o).style.bulletScale,i=e.length===1?e[0]:e.reduce((s,o)=>{const l=this.fontPx*s.style.textScale,u=this.fontPx*o.style.textScale;return this.textHeight(l,s.text)>this.textHeight(u,o.text)?s:o}),a=this.fontPx*i.style.textScale;return r=this.textHeight(a,i.text)*n,r+=a,r}getLegendPanelWidth(){const r=this.getConnectomeLabels();if(!this.opts.showLegend||r.length===0)return 0;const n=this.fontPx*1;let i=0;const a=r.reduce((u,c)=>{const h=this.fontPx*u.style.textScale,d=this.fontPx*c.style.textScale;return this.textWidth(h,u.text)>this.textWidth(d,c.text)?u:c}),s=this.fontPx*a.style.textScale,o=this.textWidth(s,a.text),l=this.getBulletMarginWidth();return o&&(i=l+o,i+=n*2),i>=this.gl.canvas.width?0:i}getLegendPanelHeight(r=1){const e=this.getConnectomeLabels();let n=0;const i=this.fontPx;for(const a of e){const s=this.fontPx*a.style.textScale*r,o=this.textHeight(s,a.text);n+=o}return n&&(n+=i/2*(e.length+1)*r),n}reserveColorbarPanel(){const r=3*this.fontPx;if(r<0)return[0,0,0,0];const n=(this.opts.colorbarWidth>0&&this.opts.colorbarWidth<=1?this.opts.colorbarWidth:1)*this.gl.canvas.width,i=[(this.gl.canvas.width-n)/2,this.gl.canvas.height-r,n,r];return this.colorbarHeight=i[3]+1,i}drawColorbarCore(r=0,e=[0,0,0,0],n=!1,i=0,a=1,s){if(e[2]<=0||e[3]<=0)return;const o=this.fontPx;if(o<=0)return;let l=o;const u=3*o;let c=o;if(e[3]<u){if(e[3]<3)return;l=1,c=e[3]-2}this.gl.disable(this.gl.DEPTH_TEST),this.colorbarHeight=e[3]+1;const h=[e[0]+l,e[1],e[2]-2*l,c],d=[h[0]-1,h[1]-1,h[2]+2,h[3]+2];if(this.opts.showColorbarBorder&&this.drawRect(d,this.opts.crosshairColor),!this.colorbarShader)throw new Error("colorbarShader undefined");this.colorbarShader.use(this.gl),this.gl.activeTexture(hd),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);const v=r;if(this.gl.uniform1f(this.colorbarShader.uniforms.layer,v),this.gl.uniform2fv(this.colorbarShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.disable(this.gl.CULL_FACE),n){const R=[h[0]+h[2],h[1],-h[2],h[3]];this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,R)}else this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,h);this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);let m=0;if(s&&a<0&&n?(m=a,a=0):s&&i>0&&(m=i,i=0),i===a||o<1)return;const y=Math.abs(a-i);let[b,x]=RC(i,a);x<i&&(x+=b);function A(R){return R.toFixed(6).replace(/\.?0*$/,"")}let C=x;const E=[0,h[1]+h[3]-o*.5,2,o*.75],S=E[1]+E[3],T=1;for(;C<=a;){E[0]=h[0]+(C-i)/y*h[2],this.drawRect(E);const R=A(T*C);this.drawTextBelow([E[0],S],R),C+=b}if(m!==0){const R=[h[0]+(m-i)/y*h[2],h[1]-h[3]*.25,2,h[3]*1.5];this.drawRect(R)}}drawColorbar(){const r=this.colormapLists,e=r.length;if(e<1)return;let n=0;for(let o=0;o<e;o++)r[o].visible&&n++;if(n<1)return;let i=this.reserveColorbarPanel();const a=3*this.fontPx;if(a<0)return;let s=i[2]/n;(i[2]<=0||i[3]<=0)&&(s=this.gl.canvas.width/n,i=[0,this.gl.canvas.height-a,s,a]),i[2]=s;for(let o=0;o<e;o++)r[o].visible&&(this.drawColorbarCore(o,i,r[o].negative,r[o].min,r[o].max,r[o].isColorbarFromZero),i[0]+=s)}textWidth(r,e){if(!e)return 0;let n=0;const i=new TextEncoder().encode(e);for(let a=0;a<e.length;a++)n+=r*this.fontMets.mets[i[a]].xadv;return n}textHeight(r,e){if(!e)return 0;const n=new Set(Array.from(e)),i=new TextEncoder().encode(Array.from(n).join("")),s=Object.values(this.fontMets.mets).filter((o,l)=>i.includes(l)).reduce((o,l)=>o.lbwh[3]>l.lbwh[3]?o:l).lbwh[3];return r*s}drawChar(r,e,n){if(!this.fontShader)throw new Error("fontShader undefined");const i=this.fontMets.mets[n],a=r[0]+e*i.lbwh[0],s=-(e*i.lbwh[1]),o=e*i.lbwh[2],l=e*i.lbwh[3],u=r[1]+(s-l)+e;return this.gl.uniform4f(this.fontShader.uniforms.leftTopWidthHeight,a,u,o,l),this.gl.uniform4fv(this.fontShader.uniforms.uvLeftTopWidthHeight,i.uv_lbwh),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),e*i.xadv}drawLoadingText(r){if(r){if(!this.canvas)throw new Error("canvas undefined");this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.drawTextBelow([this.canvas.width/2,this.canvas.height/2],r,3)}}drawText(r,e,n=1,i=null){if(this.fontPx<=0)return;if(!this.fontShader)throw new Error("fontShader undefined");this.fontShader.use(this.gl);const a=this.fontPx*n;this.gl.enable(this.gl.BLEND),this.gl.uniform2f(this.fontShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height),i===null&&(i=this.opts.fontColor),this.gl.uniform4fv(this.fontShader.uniforms.fontColor,i);let s=a/this.fontMets.size*this.fontMets.distanceRange;s=Math.max(s,1),this.gl.uniform1f(this.fontShader.uniforms.screenPxRange,s);const o=new TextEncoder().encode(e);this.gl.bindVertexArray(this.genericVAO);for(let l=0;l<e.length;l++)r[0]+=this.drawChar(r,a,o[l]);this.gl.bindVertexArray(this.unusedVAO)}drawTextRight(r,e,n=1,i=null){this.fontPx<=0||(r[1]-=.5*this.fontPx,this.drawText(r,e,n,i))}drawTextLeft(r,e,n=1,i=null){if(this.fontPx<=0)return;const a=this.fontPx*n;r[0]-=this.textWidth(a,e),r[1]-=.5*a,this.drawText(r,e,n,i)}drawTextRightBelow(r,e,n=1,i=null){this.fontPx<=0||this.drawText(r,e,n,i)}drawTextBetween(r,e,n=1,i=null){if(this.fontPx<=0)return;const a=[(r[0]+r[2])*.5,(r[1]+r[3])*.5],s=this.fontPx*n,o=this.textWidth(s,e);a[0]-=.5*o,a[1]-=.5*s;const l=[a[0]-1,a[1]-1,o+2,s+2];let u=i;u===null&&(u=this.opts.crosshairColor),u&&u[0]+u[1]+u[2]>.8?u=[0,0,0,.5]:u=[1,1,1,.5],this.drawRect(l,u),this.drawText(a,e,n,i)}drawTextBelow(r,e,n=1,i=null){if(this.fontPx<=0)return;if(!this.canvas)throw new Error("canvas undefined");let a=this.fontPx*n,s=this.textWidth(a,e);s>this.canvas.width&&(n*=(this.canvas.width-2)/s,a=this.fontPx*n,s=this.textWidth(a,e)),r[0]-=.5*this.textWidth(a,e),r[0]=Math.max(r[0],1),r[0]=Math.min(r[0],this.canvas.width-s-1),this.drawText(r,e,n,i)}drawTextAbove(r,e,n=1,i=null){if(this.fontPx<=0)return;if(!this.canvas)throw new Error("canvas undefined");let a=this.fontPx*n,s=this.textWidth(a,e);s>this.canvas.width&&(n*=(this.canvas.width-2)/s,a=this.fontPx*n,s=this.textWidth(a,e)),r[0]-=.5*this.textWidth(a,e),r[0]=Math.max(r[0],1),r[0]=Math.min(r[0],this.canvas.width-s-1),r[1]-=a,this.drawText(r,e,n,i)}updateInterpolation(r,e=!1){let n=this.gl.LINEAR;!e&&this.opts.isNearestInterpolation&&(n=this.gl.NEAREST),r===0?this.gl.activeTexture(bl):this.gl.activeTexture(lp),this.opts.is2DSliceShader?(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,n),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,n)):(this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,n),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,n))}setAtlasOutline(r){this.opts.atlasOutline=r,this.updateGLVolume(),this.drawScene()}setInterpolation(r){this.opts.isNearestInterpolation=r;const e=this.volumes.length;if(!(e<1)){for(let n=0;n<e;n++)this.updateInterpolation(n);this.drawScene()}}calculateMvpMatrix2D(r,e,n,i=1/0,a=0,s=0,o=0,l){this.gl.viewport(r[0],this.gl.canvas.height-(r[1]+r[3]),r[2],r[3]);let c=e[0],h=n[0],d=[c,e[1]],v=[h-c,n[1]-e[1]];l&&(d=[n[0],e[1]],v=[e[0]-n[0],n[1]-e[1]],c=-n[0],h=-e[0]);const m=2*Math.max(Math.abs(e[2]),Math.abs(n[2])),y=Tt();let b=.01,x=m*8;if(i!==1/0){let R=l;o===0&&(s===0||s===180)&&(R=!R);let D=m*1.8-a;R||(D=m*1.8+a),b=D-i,x=D+i}id(y,c,h,e[1],n[1],b,x);const A=Tt();A[0]=-1;const C=Me(0,0,-m*1.8);Cl(A,A,C),rd(A,A,ns(270-o)),nd(A,A,ns(s-180));const E=Tt();Mn(E,A);const S=Tt();Yn(S,E);const T=Tt();return ls(T,y,A),{modelViewProjectionMatrix:T,modelMatrix:A,normalMatrix:S,leftTopMM:d,fovMM:v}}swizzleVec3MM(r,e){return e===1?r=Ar(r,[0,2,1]):e===2&&(r=Ar(r,[1,2,0])),r}screenFieldOfViewVox(r=0){const e=bi(this.volumeObject3D.fieldOfViewDeObliqueMM);return this.swizzleVec3MM(e,r)}screenFieldOfViewMM(r=0,e=!1){if(this.volumes.length<1){let l=Me(this.extentsMin[0],this.extentsMin[1],this.extentsMin[2]),u=Me(this.extentsMax[0],this.extentsMax[1],this.extentsMax[2]);l=this.swizzleVec3MM(l,r),u=this.swizzleVec3MM(u,r);const c=Kt();return $t(c,u,l),c}if(!e&&!this.opts.isSliceMM)return this.screenFieldOfViewVox(r);const n=this.volumeObject3D.extentsMin,i=this.volumeObject3D.extentsMax;let a=Me(n[0],n[1],n[2]),s=Me(i[0],i[1],i[2]);a=this.swizzleVec3MM(a,r),s=this.swizzleVec3MM(s,r);const o=Kt();return $t(o,s,a),o}screenFieldOfViewExtendedVox(r=0){const e=this.volumes[0].extentsMinOrtho,n=this.volumes[0].extentsMaxOrtho;let i=Me(e[0],e[1],e[2]),a=Me(n[0],n[1],n[2]);const s=Tt();i=this.swizzleVec3MM(i,r),a=this.swizzleVec3MM(a,r);const o=Kt();return $t(o,a,i),{mnMM:i,mxMM:a,rotation:s,fovMM:o}}screenFieldOfViewExtendedMM(r=0){if(this.volumes.length<1){let l=Me(this.extentsMin[0],this.extentsMin[1],this.extentsMin[2]),u=Me(this.extentsMax[0],this.extentsMax[1],this.extentsMax[2]);const c=Tt();l=this.swizzleVec3MM(l,r),u=this.swizzleVec3MM(u,r);const h=Kt();return $t(h,u,l),{mnMM:l,mxMM:u,rotation:c,fovMM:h}}if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");const e=this.volumeObject3D.extentsMin,n=this.volumeObject3D.extentsMax;let i=Me(e[0],e[1],e[2]),a=Me(n[0],n[1],n[2]);const s=Tt();i=this.swizzleVec3MM(i,r),a=this.swizzleVec3MM(a,r);const o=Kt();return $t(o,a,i),{mnMM:i,mxMM:a,rotation:s,fovMM:o}}drawSliceOrientationText(r,e,n=[NaN,NaN]){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let i="S";e===0&&(i="A");let a=this.opts.isRadiologicalConvention?"R":"L";e===2&&(a=this.opts.sagittalNoseLeft?"A":"P");let s="I";e===0&&(s="P");let o=this.opts.isRadiologicalConvention?"L":"R";if(e===2&&(o=this.opts.sagittalNoseLeft?"P":"A"),this.opts.isCornerOrientationText){this.drawTextRightBelow([r[0],r[1]],a+i);return}let l=!0,u=!0;const c=this.opts.showAllOrientationMarkers,h=this.opts.showAllOrientationMarkers;if(!isNaN(n[0])){const d=this.fontPx+2;n[1]>d&&(this.drawTextBelow([r[0]+r[2]*.5,r[1]+n[1]-d],i),l=!1);const v=this.textWidth(d,a)+2;n[0]>v&&(this.drawTextRight([r[0]+n[0]-v,r[1]+r[3]*.5],a),u=!1)}l&&this.drawTextBelow([r[0]+r[2]*.5,r[1]],i),u&&this.drawTextRight([r[0],r[1]+r[3]*.5],a),c&&this.drawTextAbove([r[0]+r[2]*.5,r[1]+r[3]],s),h&&this.drawTextLeft([r[0]+r[2],r[1]+r[3]*.5],o)}xyMM2xyzMM(r,e){let n=2;r===1&&(n=1),r===2&&(n=0);let i=[0,0,0],a=[1,1,0],s=[1,0,1];i[n]=e,a[n]=e,s[n]=e,i=this.frac2mm(i),a=this.frac2mm(a),s=this.frac2mm(s),i=this.swizzleVec3MM(Me(i[0],i[1],i[2]),r),a=this.swizzleVec3MM(Me(a[0],a[1],a[2]),r),s=this.swizzleVec3MM(Me(s[0],s[1],s[2]),r);const o=(a[0]-i[0])*(s[1]-i[1])-(s[0]-i[0])*(a[1]-i[1]);let l=(a[0]-i[0])*(s[2]-i[2])-(s[0]-i[0])*(a[2]-i[2]);l/=o;let u=(a[1]-i[1])*(s[2]-i[2])-(s[1]-i[1])*(a[2]-i[2]);u/=o;const c=[0,0,0,0,0];return c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=u,c[4]=l,c}draw2DMain(r,e,n=NaN){let i=new Float32Array([0,0,0]);this.volumes.length>0&&(i=new Float32Array(this.volumes[0].frac2mm.slice()));let a=this.screenFieldOfViewExtendedMM(e),s=Tt();!this.opts.isSliceMM&&this.volumes.length>0&&(i=new Float32Array(this.volumes[0].frac2mmOrtho.slice()),s=Er(this.volumes[0].mm2ortho),a=this.screenFieldOfViewExtendedVox(e));let o=this.opts.isRadiologicalConvention&&e<2;n===1/0||n===-1/0?(o=n!==1/0,e===1&&(o=!o)):this.opts.sagittalNoseLeft&&e===2&&(o=!o);let l=0,u=0;e===2?u=o?90:-90:e===1?u=o?180:0:(u=o?180:0,l=o?-90:90);const c=this.gl;let h=!1;if(r[2]===0||r[3]===0){h=!0;const x=c.canvas.width/a.fovMM[0],A=c.canvas.height/a.fovMM[1],C=Math.min(x,A),E=x/C,S=A/C;a.fovMM[0]*=E,a.fovMM[1]*=S;let T=(a.mnMM[0]+a.mxMM[0])*.5;a.mnMM[0]=T-a.fovMM[0]*.5,a.mxMM[0]=T+a.fovMM[0]*.5,T=(a.mnMM[1]+a.mxMM[1])*.5,a.mnMM[1]=T-a.fovMM[1]*.5,a.mxMM[1]=T+a.fovMM[1]*.5,r=[0,0,c.canvas.width,c.canvas.height]}if(isNaN(n)){const x=this.scene.pan2Dxyzmm,A=this.swizzleVec3MM(Me(x[0],x[1],x[2]),e),C=this.scene.pan2Dxyzmm[3];a.mnMM[0]-=A[0],a.mxMM[0]-=A[0],a.mnMM[1]-=A[1],a.mxMM[1]-=A[1],a.mnMM[0]/=C,a.mxMM[0]/=C,a.mnMM[1]/=C,a.mxMM[1]/=C}let d=2;e===1&&(d=1),e===2&&(d=0);let v=this.scene.crosshairPos[d],m=this.frac2mm(this.scene.crosshairPos);!isNaN(n)&&n!==1/0&&n!==-1/0&&(m=this.frac2mm([.5,.5,.5]),m[d]=n,v=this.mm2frac(m)[d]);const y=m[d];c.clear(c.DEPTH_BUFFER_BIT);let b=this.calculateMvpMatrix2D(r,a.mnMM,a.mxMM,1/0,0,u,l,o);if(n===1/0||n===-1/0){const x=r.slice();this.draw3D(r,b.modelViewProjectionMatrix,b.modelMatrix,b.normalMatrix,u,l);const A=this.screenSlices[this.screenSlices.length-1];A.leftTopWidthHeight=x,A.axCorSag=e,A.sliceFrac=1/0,A.AxyzMxy=this.xyMM2xyzMM(e,v),A.leftTopMM=b.leftTopMM,A.fovMM=b.fovMM;return}if(c.enable(c.DEPTH_TEST),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),c.disable(c.BLEND),c.depthFunc(c.GREATER),c.disable(c.CULL_FACE),this.volumes.length>0){let x=this.sliceMMShader;if(this.opts.is2DSliceShader&&(x=this.slice2DShader),this.opts.isV1SliceShader&&(x=this.sliceV1Shader),this.customSliceShader&&(x=this.customSliceShader),!x)throw new Error("slice Shader undefined");x.use(this.gl),c.uniform1f(x.uniforms.overlayOutlineWidth,this.overlayOutlineWidth),c.uniform1f(x.uniforms.overlayAlphaShader,this.overlayAlphaShader),c.uniform1i(x.uniforms.isAlphaClipDark,this.isAlphaClipDark?1:0),c.uniform1i(x.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),c.uniform1f(x.uniforms.drawOpacity,this.drawOpacity),c.uniform1f(x.uniforms.drawRimOpacity,this.drawRimOpacity),c.enable(c.BLEND),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),c.uniform1f(x.uniforms.opacity,this.volumes[0].opacity),c.uniform1i(x.uniforms.axCorSag,e),c.uniform1f(x.uniforms.slice,v),c.uniformMatrix4fv(x.uniforms.frac2mm,!1,i),c.uniformMatrix4fv(x.uniforms.mvpMtx,!1,b.modelViewProjectionMatrix.slice()),c.bindVertexArray(this.genericVAO),c.drawArrays(c.TRIANGLE_STRIP,0,4),c.bindVertexArray(this.unusedVAO),this.screenSlices.push({leftTopWidthHeight:r,axCorSag:e,sliceFrac:v,AxyzMxy:this.xyMM2xyzMM(e,v),leftTopMM:b.leftTopMM,screen2frac:[],fovMM:b.fovMM})}if(isNaN(n)&&this.drawCrosshairs3D(!0,1,b.modelViewProjectionMatrix,!0,this.opts.isSliceMM),this.opts.meshThicknessOn2D>0){this.opts.meshThicknessOn2D!==1/0&&(b=this.calculateMvpMatrix2D(r,a.mnMM,a.mxMM,this.opts.meshThicknessOn2D,y,u,l,o));const x=Er(b.modelViewProjectionMatrix);ls(x,x,s),this.drawMesh3D(!0,1,x,b.modelMatrix,b.normalMatrix)}isNaN(n)&&this.drawCrosshairs3D(!1,.15,b.modelViewProjectionMatrix,!0,this.opts.isSliceMM),h&&this.opts.isOrientationTextVisible&&this.drawSliceOrientationText(r,e),this.readyForSync=!0}draw2D(r,e,n=NaN,i=[NaN,NaN]){const a=[NaN,NaN];if(i[0]===1/0){const s=this.sliceScale().volScale;let o=this.scaleSlice(s[0],s[1],[0,0],[r[2],r[3]]);e===1&&(o=this.scaleSlice(s[0],s[2],[0,0],[r[2],r[3]])),e===2&&(o=this.scaleSlice(s[1],s[2],[0,0],[r[2],r[3]])),i[0]=o[2],i[1]=o[3]}if(isNaN(i[0]))this.draw2DMain(r,e,n);else{const s=r.slice();a[0]=Math.floor(.5*(s[2]-i[0])),a[1]=Math.floor(.5*(s[3]-i[1])),s[0]+=a[0],s[1]+=a[1],s[2]=i[0],s[3]=i[1],this.draw2DMain(s,e,n)}n===1/0||n===-1/0||e===4||r[2]!==0&&r[3]!==0&&this.opts.isOrientationTextVisible&&this.drawSliceOrientationText(r,e,a)}calculateMvpMatrix(r,e=[0,0,0,0],n,i){(e[2]===0||e[3]===0)&&(e=[0,0,this.gl.canvas.width,this.gl.canvas.height]);const a=e[2]/e[3];let s=this.furthestFromPivot;const o=this.pivot3D,l=Tt();s=.8*s/this.scene.volScaleMultiplier,a<1?id(l,-s,s,-s/a,s/a,s*.01,s*8):id(l,-s*a,s*a,-s,s,s*.01,s*8);const u=Tt();u[0]=-1;const c=Me(0,0,-s*1.8);Cl(u,u,c),this.position&&Cl(u,u,this.position),rd(u,u,ns(270-i)),nd(u,u,ns(n-180)),Cl(u,u,[-o[0],-o[1],-o[2]]);const h=Tt();Mn(h,u);const d=Tt();Yn(d,h);const v=Tt();return ls(v,l,u),[v,u,d]}calculateModelMatrix(r,e){if(!this.back)throw new Error("back undefined");const n=Tt();if(n[0]=-1,rd(n,n,ns(270-e)),nd(n,n,ns(r-180)),this.back.obliqueRAS){const i=Er(this.back.obliqueRAS);ls(n,n,i)}return n}calculateRayDirection(r,e){const n=this.calculateModelMatrix(r,e),i=Hn(1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1),a=Tt();ls(a,i,n);const s=Tt();Mn(s,a);const o=er(0,0,-1,1);qr(o,o,s);const l=Me(o[0],o[1],o[2]);ui(l,l);const u=5e-5;return Math.abs(l[0])<u&&(l[0]=u),Math.abs(l[1])<u&&(l[1]=u),Math.abs(l[2])<u&&(l[2]=u),l}sceneExtentsMinMax(r=!0){let e=Me(0,0,0),n=Me(0,0,0);if(this.volumes.length>0){if(!this.volumeObject3D)throw new Error("volumeObject3D undefined");e=Me(this.volumeObject3D.extentsMin[0],this.volumeObject3D.extentsMin[1],this.volumeObject3D.extentsMin[2]),n=Me(this.volumeObject3D.extentsMax[0],this.volumeObject3D.extentsMax[1],this.volumeObject3D.extentsMax[2]),r||(e=Me(this.volumes[0].extentsMinOrtho[0],this.volumes[0].extentsMinOrtho[1],this.volumes[0].extentsMinOrtho[2]),n=Me(this.volumes[0].extentsMaxOrtho[0],this.volumes[0].extentsMaxOrtho[1],this.volumes[0].extentsMaxOrtho[2]))}if(this.meshes.length>0){if(this.volumes.length<1){const a=this.meshes[0].extentsMin,s=this.meshes[0].extentsMax;e=Me(a[0],a[1],a[2]),n=Me(s[0],s[1],s[2])}for(let a=0;a<this.meshes.length;a++){const s=this.meshes[a].extentsMin,o=this.meshes[a].extentsMax,l=Me(s[0],s[1],s[2]);$2(e,e,l);const u=Me(o[0],o[1],o[2]);ey(n,n,u)}}const i=Kt();return $t(i,n,e),[e,n,i]}setPivot3D(){const[r,e]=this.sceneExtentsMinMax(),n=Kt();uo(n,r,e),B_(n,n,.5),this.pivot3D=[n[0],n[1],n[2]],$t(n,e,r),this.extentsMin=r,this.extentsMax=e,this.furthestFromPivot=ms(n)*.5}getMaxVols(){if(this.volumes.length<1)return 0;let r=0;for(let e=0;e<this.volumes.length;e++)r=Math.max(r,this.volumes[e].nFrame4D);return r}detectPartialllyLoaded4D(){if(this.volumes.length<1)return!1;for(let r=0;r<this.volumes.length;r++)if(this.volumes[r].nFrame4D<this.volumes[r].hdr.dims[4])return!0;return!1}drawGraph(){if(this.getMaxVols()<2)return;const r=this.graph;let e=0;if(this.graph.autoSizeMultiplanar&&this.opts.sliceType===3)for(let G=0;G<this.screenSlices.length;G++){const K=this.screenSlices[G].axCorSag;if(K===0&&(e=this.screenSlices[G].leftTopWidthHeight[1]),K!==2)continue;const z=this.screenSlices[G].leftTopWidthHeight.slice();z[1]===e?(r.LTWH[0]=z[0]+z[2],r.LTWH[1]=z[1]):(r.LTWH[0]=z[0],r.LTWH[1]=z[1]+z[3]),r.LTWH[2]=z[2],r.LTWH[3]=z[2]}if(r.opacity<=0||r.LTWH[2]<=5||r.LTWH[3]<=5||Math.floor(r.LTWH[0]+r.LTWH[2])>this.gl.canvas.width||Math.floor(r.LTWH[1]+r.LTWH[3])>this.gl.canvas.height)return;r.backColor=[.15,.15,.15,r.opacity],r.lineColor=[1,1,1,1],this.opts.backColor[0]+this.opts.backColor[1]+this.opts.backColor[2]>1.5&&(r.backColor=[.95,.95,.95,r.opacity],r.lineColor=[0,0,0,1]);const n=.2,i=.3;r.lineColor[3]=n,r.textColor=r.lineColor.slice(),r.textColor[3]=1,r.lineThickness=3,r.gridLineThickness=1,r.lineAlpha=1,r.lines=[];const a=[];if(r.vols.length<1)this.volumes[0]!=null&&a.push(0);else for(let G=0;G<r.vols.length;G++){const K=r.vols[G];this.volumes[K]==null||this.volumes[K].nFrame4D<2||a.push(K)}if(a.length<1)return;const s=this.volumes[a[0]].nFrame4D;if(this.graph.selectedColumn=this.volumes[a[0]].frame4D,s<2){Q.debug("Unable to generate a graph: Selected volume is 3D not 4D");return}for(let G=0;G<a.length;G++){r.lines[G]=[];const K=this.frac2vox(this.scene.crosshairPos),z=this.volumes[a[G]];let Y=z.nFrame4D;Y=Math.min(Y,s);for(let Z=0;Z<Y;Z++){const J=z.getValue(K[0],K[1],K[2],Z);r.lines[G].push(J)}}r.lineRGB=[[.8,0,0],[0,.7,0],[0,0,.9],[.7,.7,0],[.8,0,.8],[0,.7,.7],[.6,.6,.6],[0,0,0]];let o=r.lines[0][0],l=r.lines[0][0];for(let G=0;G<r.lines.length;G++)for(let K=0;K<r.lines[G].length;K++){const z=r.lines[G][K];o=Math.min(z,o),l=Math.max(z,l)}const u=this.volumes[a[0]].cal_min,c=this.volumes[a[0]].cal_max;if(r.isRangeCalMinMax&&u<c&&isFinite(u)&&isFinite(c)&&(o=u,l=c),r.normalizeValues&&l>o){const G=l-o;for(let K=0;K<r.lines.length;K++)for(let z=0;z<r.lines[K].length;z++){const Y=r.lines[K][z];r.lines[K][z]=(Y-o)/G}o=0,l=1}o>=l&&(l=o+1),this.drawRect(r.LTWH,r.backColor);const[h,d,v]=RC(o,l),m=Math.max(0,-1*Math.floor(Math.log(h)/Math.log(10)));o=Math.min(d,o),l=Math.max(v,l);function y(G){return G.toFixed(6).replace(/\.?0*$/,"")}let b=this.fontPx*.7;const x=this.gl.canvas.width/this.uiData.dpr,A=this.gl.canvas.height/this.uiData.dpr,C=x*A,E=800*600;C<E?b=0:b=Math.max(b,this.opts.fontMinPx);const S=b/this.fontPx;let T=0,R=d;if(b>0)for(;R<=l;){const G=R.toFixed(m),K=this.textWidth(b,G);T=Math.max(K,T),R+=h}const D=.05,B=Math.abs(r.LTWH[2]),N=Math.abs(r.LTWH[3]),I=[r.LTWH[0]+D*B+T,r.LTWH[1]+D*N,r.LTWH[2]-T-2*D*B,r.LTWH[3]-b-2.5*D*N];this.graph.LTWH=r.LTWH,this.graph.plotLTWH=I,this.drawRect(I,this.opts.backColor);const P=l-o,F=I[3]/P,O=I[2]/(r.lines[0].length-1),U=I[1]+I[3];R=d+.5*h;const L=r.lineColor.slice();for(L[3]=.5*r.lineColor[3];R<=l;){const G=U-(R-o)*F;this.drawLine([I[0],G,I[0]+I[2],G],r.gridLineThickness,L),R+=h}R=d;const V=.5*r.gridLineThickness;for(;R<=l;){const G=U-(R-o)*F;this.drawLine([I[0]-V,G,I[0]+I[2]+r.gridLineThickness,G],r.gridLineThickness,r.lineColor);const K=R.toFixed(m);b>0&&this.drawTextLeft([I[0]-6,G],K,S,r.textColor),R+=h}let _=1;for(;r.lines[0].length/_>20;)_*=5;for(let G=0;G<r.lines[0].length;G+=_){const K=G*O+I[0];let z=r.gridLineThickness;if(G%2===1)z*=.5,this.drawLine([K,I[1],K,I[1]+I[3]],z,L);else{const Y=y(G);b>0&&this.drawTextBelow([K,2+I[1]+I[3]],Y,S,r.textColor),this.drawLine([K,I[1],K,I[1]+I[3]],z,r.lineColor)}}for(let G=0;G<r.lines.length;G++){let K=[1,0,0,r.lineAlpha];G<r.lineRGB.length&&(K=[r.lineRGB[G][0],r.lineRGB[G][1],r.lineRGB[G][2],r.lineAlpha]);for(let z=1;z<r.lines[G].length;z++){const Y=(z-1)*O,Z=z*O,J=(r.lines[G][z-1]-o)*F,ee=(r.lines[G][z]-o)*F,ne=[I[0]+Y,I[1]+I[3]-J,I[0]+Z,I[1]+I[3]-ee];this.drawLine(ne,r.lineThickness,K)}}if(r.selectedColumn>=0&&r.selectedColumn<r.lines[0].length){const G=r.selectedColumn*O+I[0];this.drawLine([G,I[1],G,I[1]+I[3]],r.lineThickness,[r.lineRGB[0][0],r.lineRGB[0][1],r.lineRGB[0][2],i])}b>0&&r.LTWH[1]+r.LTWH[3]>I[1]+I[3]+b*2.4&&this.drawTextBelow([I[0]+.5*I[2],I[1]+I[3]+b*1.2],"Volume",S,r.textColor),this.detectPartialllyLoaded4D()&&this.drawTextBelow([I[0]+I[2],I[1]+I[3]+b*.5],"...",S,r.textColor)}depthPicker(r,e){if(!this.uiData.mouseDepthPicker)return;this.uiData.mouseDepthPicker=!1;const n=this.gl,i=this.mousePos[0]*r[2]/r[2],a=n.canvas.height-this.mousePos[1]*r[3]/r[3]-1,s=new Uint8Array(4);if(n.readPixels(i,a,1,1,n.RGBA,n.UNSIGNED_BYTE,s),this.selectedObjectId=s[3],this.selectedObjectId===this.VOLUME_ID){this.scene.crosshairPos=new Float32Array(s.slice(0,3)).map(d=>d/255);return}const o=iH(s);if(o>1)return;const l=(this.mousePos[0]-r[0])/r[2],u=(n.canvas.height-this.mousePos[1]-r[1])/r[3],c=aH(l,u,o,e),h=this.mm2frac(c,0,!0);h[0]<0||h[0]>1||h[1]<0||h[1]>1||h[2]<0||h[2]>1||(this.scene.crosshairPos=this.mm2frac(c,0,!0))}drawImage3D(r,e,n){if(this.volumes.length===0)return;const i=this.gl,a=this.calculateRayDirection(e,n),s=this.volumeObject3D;if(s){i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.CULL_FACE),i.cullFace(i.FRONT);let o=this.renderShader;if(this.uiData.mouseDepthPicker&&(o=this.pickingImageShader),o.use(this.gl),i.uniform1i(o.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),this.gradientTextureAmount>0&&o.uniforms.normMtx&&this.gradientTexture){i.activeTexture(up),i.bindTexture(i.TEXTURE_3D,this.gradientTexture);const l=this.calculateModelMatrix(e,n),u=Tt();Mn(u,l);const c=Tt();Yn(c,u),i.uniformMatrix4fv(o.uniforms.normMtx,!1,c)}this.drawBitmap&&this.drawBitmap.length>8?i.uniform2f(o.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,this.drawOpacity):i.uniform2f(o.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,0),this.gl.uniform4fv(o.uniforms.paqdUniforms,this.opts.paqdUniforms),i.uniformMatrix4fv(o.uniforms.mvpMtx,!1,r),i.uniformMatrix4fv(o.uniforms.matRAS,!1,this.back.matRAS),i.uniform3fv(o.uniforms.rayDir,a),this.gradientTextureAmount<0?i.uniform4fv(o.uniforms.clipPlane,[this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2],30]):i.uniform4fv(o.uniforms.clipPlane,this.scene.clipPlane),i.uniform1f(o.uniforms.drawOpacity,1),i.bindVertexArray(s.vao),i.drawElements(s.mode,s.indexCount,i.UNSIGNED_SHORT,0),i.bindVertexArray(this.unusedVAO)}}drawOrientationCube(r,e=0,n=0){if(!this.opts.isOrientCube)return;const i=.05*Math.min(r[2],r[3]);if(i<5)return;const a=this.gl;a.enable(a.CULL_FACE),a.cullFace(a.BACK),this.orientCubeShader.use(this.gl),a.bindVertexArray(this.orientCubeShaderVAO);const s=Tt(),o=Tt();id(o,0,a.canvas.width,0,a.canvas.height,-10*i,10*i);let l=0;r[1]===0&&(l=a.canvas.height-this.effectiveCanvasHeight()),Cl(s,s,[1.8*i+r[0],l+1.8*i+r[1],0]),X4(s,s,[i,i,i]),rd(s,s,ns(270-n)),nd(s,s,ns(-e));const u=Tt();ls(u,o,s),a.uniformMatrix4fv(this.orientCubeShader.uniforms.u_matrix,!1,u),a.drawArrays(a.TRIANGLE_STRIP,0,168),a.bindVertexArray(this.unusedVAO),this.gl.disable(this.gl.CULL_FACE)}createOnLocationChange(r=NaN){const[e,n,i]=this.sceneExtentsMinMax(!0),a=Math.max(Math.max(i[0],i[1]),i[2]);function s(d){return Math.max(0,-Math.ceil(Math.log10(Math.abs(d))))}let o=s(a*.001);const l=this.frac2mm(this.scene.crosshairPos,0,!0);function u(d,v=0){return parseFloat(d.toFixed(v))}let c=u(l[0],o)+"×"+u(l[1],o)+"×"+u(l[2],o);if(this.volumes.length>0&&this.volumes[0].nFrame4D>0&&(c+="×"+u(this.volumes[0].frame4D)),this.volumes.length>0){let d=" = ";for(let y=0;y<this.volumes.length;y++){const b=this.volumes[y].mm2vox(l);let x=this.volumes[y].getValue(b[0],b[1],b[2],this.volumes[y].frame4D);if(o=3,this.volumes[y].colormapLabel!==null){const A=Math.round(x);if(this.volumes[y].hdr.intent_code===1002&&this.volumes[y].hdr.datatypeCode===2304){const C=this.volumes[y].getValues(b[0],b[1],b[2],this.volumes[y].frame4D);if(C[2]>2){const E=Math.round(100*C[2]/255);if(d+=this.volumes[y].colormapLabel.labels[C[0]]+` (${E}%)`,C[3]>2){const S=Math.round(100*C[3]/255);d+=" "+this.volumes[y].colormapLabel.labels[C[1]]+` (${S}%)`}}}else A>=0&&this.volumes[y].colormapLabel.labels&&A<this.volumes[y].colormapLabel.labels.length?d+=this.volumes[y].colormapLabel.labels[A]:d+="undefined("+u(x,o)+")"}else d+=u(x,o);this.volumes[y].imaginary&&(x=this.volumes[y].getValue(b[0],b[1],b[2],this.volumes[y].frame4D,!0),x>=0&&(d+="+"),d+=u(x,o)),d+="   "}c+=d;const v=this.back.dimsRAS,m=v[1]*v[2]*v[3];if(this.drawBitmap&&this.drawBitmap.length===m){const y=this.frac2vox(this.scene.crosshairPos),b=y[0]+y[1]*v[1]+y[2]*v[1]*v[2];c+=" "+this.drawLut.labels[this.drawBitmap[b]]}}const h={mm:this.frac2mm(this.scene.crosshairPos,0,!0),axCorSag:r,vox:this.frac2vox(this.scene.crosshairPos),frac:this.scene.crosshairPos,xy:[this.mousePos[0],this.mousePos[1]],values:this.volumes.map(d=>{const v=this.frac2mm(this.scene.crosshairPos,0,!0),m=d.mm2vox(v),y=d.getValue(m[0],m[1],m[2],d.frame4D);return{name:d.name,value:y,id:d.id,mm:v,vox:m}}),string:c};this.onLocationChange(h)}addLabel(r,e,n,i,a){const s={textColor:this.opts.legendTextColor,textScale:1,textAlignment:"left",lineWidth:0,lineColor:this.opts.legendTextColor,lineTerminator:"none",bulletScale:0,bulletColor:this.opts.legendTextColor},o=e?{...s,...e}:{...s},l=new yy(r,{...o},n,i,a);return this.document.labels.push(l),l}calculateScreenPoint(r,e,n){const i=Yi();return qr(i,[...r,1],e),i[3]!==0&&(i[0]=(i[0]/i[3]+1)*.5*n[2],i[1]=(1-i[1]/i[3])*.5*n[3],i[2]/=i[3],i[0]+=n[0],i[1]+=n[1]),i}getLabelAtPoint(r){const e=this.legendFontScaling,n=this.fontPx*e,i=this.fontPx*e;for(const c of this.document.labels){if(c.anchor==null||c.anchor===0)continue;const h=this.fontPx*c.style.textScale*e,d=this.textHeight(h,c.text),v=this.textWidth(h,c.text);if(!(c.anchor&1&&r[0]>v)&&!(c.anchor&2&&(r[0]<(this.gl.canvas.width-v)/2||r[0]>(this.gl.canvas.width+v)/2))&&!(c.anchor&4&&r[0]<this.gl.canvas.width-v)&&!(c.anchor&8&&(r[1]<i/2||r[1]>d+i/2))&&!(c.anchor&16&&(r[1]<(this.gl.canvas.height-d-i)/2||r[1]>(this.gl.canvas.height+d-i/2)/2))&&!(c.anchor&32&&(r[1]<this.gl.canvas.height-d-i||r[1]>this.gl.canvas.height-i/2)))return c}Q.debug("screenPoint",r);const a=this.getLegendPanelHeight(e),s=this.getLegendPanelWidth(),o=this.gl.canvas.width-s;let l=(this.canvas.height-a)/2;if(Q.debug("panelrect",o,l,o+s,l+a),r[0]<o||r[1]<l||r[0]>o+s||r[1]>l+a)return null;const u=this.getConnectomeLabels();for(const c of u){const h=this.fontPx*c.style.textScale*e,d=this.textHeight(h,c.text);if(r[1]>=l&&r[1]<=l+d+n/2)return Q.debug(`label clicked ${c.text}`),c;l+=d,l+=n/2}return null}drawLabelLine(r,e,n,i,a=!1){const s=Array.isArray(r.points)&&Array.isArray(r.points[0])?r.points:[r.points];for(const o of s){const l=this.calculateScreenPoint(o,n,i);a?this.drawDottedLine([...e,l[0],l[1]],r.style.lineWidth,r.style.lineColor):this.draw3DLine(e,[l[0],l[1],l[2]],r.style.lineWidth,r.style.lineColor)}}draw3DLabel(r,e,n,i,a,s,o,l=1){const u=r.text,c=e[0],h=e[1],d=this.fontPx*l,v=this.textHeight(r.style.textScale,u)*d;if(r.style.lineWidth>0&&Array.isArray(r.points)&&this.drawLabelLine(r,[c,h+v],n,i,o),r.style.bulletScale){const b=r.style.bulletScale*v,x=v-b,A=h+x/2+b/2,C=c+(a-b)/2;this.drawCircle([C,A,b,b],r.style.bulletColor)}let m=c;if(s)if(r.style.textAlignment!=="left"){const b=this.textWidth(r.style.textScale,r.text)*d;if(r.style.textAlignment==="right")m=c+s-d*1.5-b;else{const x=s-(a||d);m+=(x-b)/2}}else m+=a;const y=r.style.textScale;this.drawText([m,h],u,y,r.style.textColor)}draw3DLabels(r,e,n=!1){const i=this.getConnectomeLabels();if(!this.opts.showLegend||i.length===0)return;let a=this.getLegendPanelHeight(1);if(!this.canvas||a<1)return;const s=this.gl;if(s.disable(s.CULL_FACE),s.viewport(0,0,this.canvas.width,this.canvas.height),this.legendFontScaling=1,a>this.canvas.height){const m=10*this.uiData.dpr;this.legendFontScaling=Math.max(this.canvas.height-m,1)/a,Q.debug(`Legend too large for screen, font reduction factor x${this.legendFontScaling}`),a=this.getLegendPanelHeight(this.legendFontScaling)}const o=this.fontPx*this.legendFontScaling,l=this.getBulletMarginWidth(),u=this.getLegendPanelWidth(),c=s.canvas.width-u;let h=(this.canvas.height-a)/2;this.drawRect([s.canvas.width-u,h,u-o,a],this.opts.legendBackgroundColor);const d=s.getParameter(s.BLEND),v=s.getParameter(s.DEPTH_FUNC);n||(s.disable(s.BLEND),s.depthFunc(s.GREATER));for(const m of i){this.draw3DLabel(m,[c,h],r,e,l,u,n,this.legendFontScaling);const y=this.fontPx*m.style.textScale,b=this.textHeight(y,m.text)*this.legendFontScaling;h+=b,h+=o/2}n||(s.depthFunc(v),d&&s.enable(s.BLEND))}drawAnchoredLabels(){const r=this.fontPx,e=this.document.labels.filter(n=>n.anchor!=null&&n.anchor!==0);for(const n of e){const i=n.text,a=this.textHeight(n.style.textScale,i)*r,s=this.textWidth(n.style.textScale,i)*r;let o,l;const c=this.fontPx*1,h=c;let d=c/4,v=0,m=0;n.anchor&1&&(o=0),n.anchor&4&&(o=this.canvas.width-s,v-=c/4),n.anchor&2&&(o=(this.canvas.width-s)/2,v-=c/4,d+=c/4),n.anchor&8&&(l=0),n.anchor&16&&(l=(this.canvas.height-a-c)/2,m-=c/4),n.anchor&32&&(l=this.canvas.height-a-c,m-=c/4),this.drawRect([o+v,l+m,s+d,a+h],n.style.backgroundColor),this.draw3DLabel(n,[o,l])}}draw3D(r=[0,0,0,0],e=null,n=null,i=null,a=null,s=0){const o=a!==null;this.setPivot3D(),o||(a=this.scene.renderAzimuth,s=this.scene.renderElevation);const l=this.gl;e===null&&([e,n,i]=this.calculateMvpMatrix(null,r,a,s));let u=[...r];if(r[2]===0||r[3]===0?(r=[0,0,l.canvas.width,l.canvas.height],u=[...r],this.screenSlices.push({leftTopWidthHeight:r,axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[BC(n),0]})):(this.screenSlices.push({leftTopWidthHeight:r.slice(),axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[BC(n),0]}),r[1]=l.canvas.height-r[3]-r[1]),l.enable(l.DEPTH_TEST),l.depthFunc(l.ALWAYS),l.depthMask(!0),l.clearDepth(0),this.draw3DLabels(e,u,!1),l.viewport(r[0],r[1],r[2],r[3]),this.volumes.length>0&&(this.updateInterpolation(0,!0),this.updateInterpolation(1,!0),this.drawImage3D(e,a,s)),this.updateInterpolation(0),this.updateInterpolation(1),o||this.drawCrosshairs3D(!0,1,e),this.drawMesh3D(!0,1,e,n,i),this.uiData.mouseDepthPicker){this.depthPicker(r,e),this.createOnLocationChange(),this.draw3D(r,e,n,i,a,s);return}this.opts.meshXRay>0&&this.drawMesh3D(!1,this.opts.meshXRay,e,n,i),this.draw3DLabels(e,u,!1),l.viewport(r[0],r[1],r[2],r[3]),o||this.drawCrosshairs3D(!1,.15,e),l.viewport(0,0,l.canvas.width,l.canvas.height),this.drawOrientationCube(r,a,s);const c="azimuth: "+this.scene.renderAzimuth.toFixed(0)+" elevation: "+this.scene.renderElevation.toFixed(0);return this.readyForSync=!0,this.sync(),this.draw3DLabels(e,u,!0),c}drawMesh3D(r=!0,e=1,n,i,a){if(this.meshes.length<1)return;const s=this.gl;n||([n,i,a]=this.calculateMvpMatrix(this.volumeObject3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),s.enable(s.DEPTH_TEST),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),s.disable(s.BLEND),s.depthFunc(s.GREATER),s.disable(s.CULL_FACE),r?s.depthFunc(s.GREATER):(s.enable(s.BLEND),s.depthFunc(s.ALWAYS),s.enable(s.CULL_FACE)),s.cullFace(s.BACK);let o=this.meshShaders[0].shader,l=!1;for(let u=0;u<this.meshes.length;u++){if(this.meshes[u].visible===!1||this.meshes[u].opacity<=0)continue;let c=e;if(r&&(c=this.meshes[u].opacity,s.depthFunc(s.GREATER),s.depthMask(!0),c<1?(s.depthMask(!1),s.enable(s.DEPTH_TEST),s.enable(s.BLEND),s.cullFace(s.BACK),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA)):(s.enable(s.DEPTH_TEST),s.disable(s.BLEND))),o=this.meshShaders[this.meshes[u].meshShaderIndex].shader,this.uiData.mouseDepthPicker&&(o=this.pickingMeshShader),o.use(this.gl),s.uniformMatrix4fv(o.uniforms.mvpMtx,!1,n),s.uniformMatrix4fv(o.uniforms.normMtx,!1,a),s.uniform1f(o.uniforms.opacity,c),!(this.meshes[u].indexCount<3)){if(this.meshes[u].offsetPt0&&(this.meshes[u].fiberSides<3||this.meshes[u].fiberRadius<=0)){l=!0;continue}o.isMatcap&&(s.activeTexture(NC),s.bindTexture(s.TEXTURE_2D,this.matCapTexture)),s.bindVertexArray(this.meshes[u].vao),s.drawElements(s.TRIANGLES,this.meshes[u].indexCount,s.UNSIGNED_INT,0),s.bindVertexArray(this.unusedVAO)}}if(s.depthMask(!0),!l){s.enable(s.BLEND),s.depthFunc(s.ALWAYS);return}o=this.fiberShader,o.use(this.gl),s.uniformMatrix4fv(o.uniforms.mvpMtx,!1,n),s.uniform1f(o.uniforms.opacity,e);for(let u=0;u<this.meshes.length;u++)this.meshes[u].indexCount<3||this.meshes[u].offsetPt0&&(this.meshes[u].fiberSides>=3&&this.meshes[u].fiberRadius>0||(s.bindVertexArray(this.meshes[u].vaoFiber),s.drawElements(s.LINE_STRIP,this.meshes[u].indexCount,s.UNSIGNED_INT,0),s.bindVertexArray(this.unusedVAO)));s.enable(s.BLEND),s.depthFunc(s.ALWAYS),this.readyForSync=!0}drawCrosshairs3D(r=!0,e=1,n=null,i=!1,a=!0){if(!this.opts.show3Dcrosshair&&!i||this.opts.crosshairWidth<=0&&i)return;const s=this.gl,o=this.frac2mm(this.scene.crosshairPos,0,a);let l=1;const[u,c,h]=this.sceneExtentsMinMax(a);if(this.volumes.length>0){if(!this.back)throw new Error("back undefined");l=.5*Math.min(Math.min(this.back.pixDims[1],this.back.pixDims[2]),this.back.pixDims[3])}else(h[0]<50||h[0]>1e3)&&(l=h[0]*.02);if(l*=this.opts.crosshairWidth,this.opts?.crosshairWidthUnit==="percent"&&(l=h[0]*this.opts.crosshairWidth*.5*.01),this.opts?.crosshairWidthUnit==="mm"&&(l=this.opts.crosshairWidth*.5),(this.crosshairs3D===null||this.crosshairs3D.mm[0]!==o[0]||this.crosshairs3D.mm[1]!==o[1]||this.crosshairs3D.mm[2]!==o[2])&&(this.crosshairs3D!==null&&(s.deleteBuffer(this.crosshairs3D.indexBuffer),s.deleteBuffer(this.crosshairs3D.vertexBuffer)),this.crosshairs3D=Ao.generateCrosshairs(this.gl,1,o,u,c,l,20,this.opts.crosshairGap),this.crosshairs3D.mm=o),!this.surfaceShader)throw new Error("surfaceShader undefined");const d=this.surfaceShader;d.use(this.gl),n==null&&([n]=this.calculateMvpMatrix(this.crosshairs3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),s.uniformMatrix4fv(d.uniforms.mvpMtx,!1,n),s.disable(s.CULL_FACE),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.crosshairs3D.indexBuffer),s.enable(s.DEPTH_TEST);const v=[...this.opts.crosshairColor];r?(s.disable(s.BLEND),s.depthFunc(s.GREATER)):(s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),s.depthFunc(s.ALWAYS)),v[3]=e,s.uniform4fv(d.uniforms.surfaceColor,v),s.bindVertexArray(this.crosshairs3D.vao),s.drawElements(s.TRIANGLES,this.crosshairs3D.indexCount,s.UNSIGNED_INT,0),s.bindVertexArray(this.unusedVAO)}mm2frac(r,e=0,n=!1){if(this.volumes.length<1){const i=Me(.1,.5,.5),[a,s,o]=this.sceneExtentsMinMax();return i[0]=(r[0]-a[0])/o[0],i[1]=(r[1]-a[1])/o[1],i[2]=(r[2]-a[2])/o[2],isFinite(i)||(isFinite(i[0])||(i[0]=.5),isFinite(i[1])||(i[1]=.5),isFinite(i[2])||(i[2]=.5),this.meshes.length<1&&Q.error("mm2frac() not finite: objects not (yet) loaded.")),i}return this.volumes[e].convertMM2Frac(r,n||this.opts.isSliceMM)}vox2frac(r,e=0){return this.volumes[e].convertVox2Frac(r)}frac2vox(r,e=0){return this.volumes.length<=e?[0,0,0]:this.volumes[e].convertFrac2Vox(r)}moveCrosshairInVox(r,e,n){const i=this.frac2vox(this.scene.crosshairPos),a=i[2];i[0]+=r,i[1]+=e,i[2]+=n,i[0]=ap(i[0],0,this.volumes[0].dimsRAS[1]-1),i[1]=ap(i[1],0,this.volumes[0].dimsRAS[2]-1),i[2]=ap(i[2],0,this.volumes[0].dimsRAS[3]-1),this.scene.crosshairPos=this.vox2frac(i),this.createOnLocationChange(),this.opts.is2DSliceShader&&a!==i[2]&&(this.updateGLVolume(),this.refreshDrawing(!1)),this.drawScene()}frac2mm(r,e=0,n=!1){const i=er(r[0],r[1],r[2],1);if(this.volumes.length>0)return this.volumes[e].convertFrac2MM(r,n||this.opts.isSliceMM);{const[a,s]=this.sceneExtentsMinMax(),o=(l,u,c)=>l*(1-c)+u*c;i[0]=o(a[0],s[0],r[0]),i[1]=o(a[1],s[1],r[1]),i[2]=o(a[2],s[2],r[2])}return i}screenXY2TextureFrac(r,e,n,i=!0){const a=Me(-1,-1,-1),s=this.screenSlices[n].axCorSag;if(s>2)return a;const o=this.screenSlices[n].leftTopWidthHeight.slice();let l=!1;o[2]<0&&(l=!0,o[0]+=o[2],o[2]=-o[2]);let u=(r-o[0])/o[2];l&&(u=1-u);const c=1-(e-o[1])/o[3];if(u<0||u>1||c<0||c>1||this.screenSlices[n].AxyzMxy.length<4)return a;let h=Me(0,0,0);h[0]=this.screenSlices[n].leftTopMM[0]+u*this.screenSlices[n].fovMM[0],h[1]=this.screenSlices[n].leftTopMM[1]+c*this.screenSlices[n].fovMM[1];const d=this.screenSlices[n].AxyzMxy;h[2]=d[2]+d[4]*(h[1]-d[1])-d[3]*(h[0]-d[0]),s===1&&(h=Ar(h,[0,2,1])),s===2&&(h=Ar(h,[2,0,1]));const v=this.mm2frac(h);return i&&(v[0]<0||v[0]>1||v[1]<0||v[1]>1||v[2]<0||v[2]>1)?a:v}canvasPos2frac(r){for(let e=0;e<this.screenSlices.length;e++){const n=this.screenXY2TextureFrac(r[0],r[1],e);if(n[0]>=0)return n}return[-1,-1,-1]}frac2canvasPosWithTile(r,e){const n=this.frac2mm(r);let i={distance:1/0};for(let a=0;a<this.screenSlices.length;a++){const s=this.screenSlices[a].axCorSag;if(s>2||this.screenSlices[a].AxyzMxy.length<4||e!==void 0&&s!==e)continue;let o=Me(n[0],n[1],n[2]);s===1&&(o=Ar(o,[0,2,1])),s===2&&(o=Ar(o,[1,2,0]));const l=this.screenSlices[a].AxyzMxy,u=l[2]+l[4]*(o[1]-l[1])-l[3]*(o[0]-l[0]),c=Math.abs(o[2]-u),h=this.opts.sliceType===3?1:.1;if(c<i.distance&&(i={index:a,distance:c}),c<=h){const d=(o[0]-this.screenSlices[a].leftTopMM[0])/this.screenSlices[a].fovMM[0],v=(o[1]-this.screenSlices[a].leftTopMM[1])/this.screenSlices[a].fovMM[1];if(d>=0&&d<=1&&v>=0&&v<=1){const m=this.screenSlices[a].leftTopWidthHeight.slice();let y=!1;m[2]<0&&(y=!0,m[0]+=m[2],m[2]=-m[2]);let b=d;y&&(b=1-d);const x=1-v,A=m[0]+b*m[2],C=m[1]+x*m[3];return{pos:[A,C],tileIndex:a}}}}return null}frac2canvasPos(r){const e=this.frac2mm(r);let n={index:-1,distance:1/0};for(let i=0;i<this.screenSlices.length;i++){const a=this.screenSlices[i].axCorSag;if(a>2||this.screenSlices[i].AxyzMxy.length<4)continue;let s=Me(e[0],e[1],e[2]);a===1&&(s=Ar(s,[0,2,1])),a===2&&(s=Ar(s,[1,2,0]));const o=this.screenSlices[i].AxyzMxy,l=o[2]+o[4]*(s[1]-o[1])-o[3]*(s[0]-o[0]),u=Math.abs(s[2]-l),c=this.opts.sliceType===3?1:.1;if(u<n.distance&&(n={index:i,distance:u}),u<=c){const h=(s[0]-this.screenSlices[i].leftTopMM[0])/this.screenSlices[i].fovMM[0],d=(s[1]-this.screenSlices[i].leftTopMM[1])/this.screenSlices[i].fovMM[1];if(h>=0&&h<=1&&d>=0&&d<=1){const v=this.screenSlices[i].leftTopWidthHeight.slice();let m=!1;v[2]<0&&(m=!0,v[0]+=v[2],v[2]=-v[2]);let y=h;m&&(y=1-h);const b=1-d,x=v[0]+y*v[2],A=v[1]+b*v[3];return[x,A]}}}if(n.index>=0&&n.distance<2){const i=n.index,a=this.screenSlices[i].axCorSag;let s=Me(e[0],e[1],e[2]);a===1&&(s=Ar(s,[0,2,1])),a===2&&(s=Ar(s,[1,2,0]));const o=this.screenSlices[i].AxyzMxy;s[2]=o[2]+o[4]*(s[1]-o[1])-o[3]*(s[0]-o[0]);const l=(s[0]-this.screenSlices[i].leftTopMM[0])/this.screenSlices[i].fovMM[0],u=(s[1]-this.screenSlices[i].leftTopMM[1])/this.screenSlices[i].fovMM[1];if(l>=-.1&&l<=1.1&&u>=-.1&&u<=1.1){const c=Math.max(0,Math.min(1,l)),h=Math.max(0,Math.min(1,u)),d=this.screenSlices[i].leftTopWidthHeight.slice();let v=!1;d[2]<0&&(v=!0,d[0]+=d[2],d[2]=-d[2]);let m=c;v&&(m=1-c);const y=1-h,b=d[0]+m*d[2],x=d[1]+y*d[3];return[b,x]}}return null}scaleSlice(r,e,n=[0,0],i=[0,0]){const a=i[0]===0?this.effectiveCanvasWidth()-n[0]:i[0]-n[0],s=i[1]===0?this.effectiveCanvasHeight()-n[1]:i[1]-n[1];let o=a/r;e*o>s&&(o=s/e);const l=r*o,u=e*o;return[(a-l)*.5,(s-u)*.5,l,u,o]}drawThumbnail(){if(!this.bmpShader)throw new Error("bmpShader undefined");this.bmpShader.use(this.gl),this.gl.uniform2f(this.bmpShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height);let r=this.gl.canvas.height,e=this.gl.canvas.height*this.bmpTextureWH;e>this.gl.canvas.width&&(r=this.gl.canvas.width/this.bmpTextureWH,e=this.gl.canvas.width);const n=(this.gl.canvas.width-e)/2,i=(this.gl.canvas.height-r)/2;this.gl.uniform4f(this.bmpShader.uniforms.leftTopWidthHeight,n,i,e,r),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawLine(r,e=1,n=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl),n[3]<0&&(n=this.opts.crosshairColor),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,n),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,e),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,r),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}draw3DLine(r,e,n=1,i=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.line3DShader)throw new Error("line3DShader undefined");this.line3DShader.use(this.gl),i[3]<0&&(i=this.opts.crosshairColor),this.gl.uniform4fv(this.line3DShader.uniforms.lineColor,i),this.gl.uniform2fv(this.line3DShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.line3DShader.uniforms.thickness,n),this.gl.uniform2fv(this.line3DShader.uniforms.startXY,r),this.gl.uniform3fv(this.line3DShader.uniforms.endXYZ,e),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawDottedLine(r,e=1,n=[1,0,0,-1]){if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw new Error("lineShader undefined");this.lineShader.use(this.gl);const i=n[3]<0?[...this.opts.crosshairColor]:[...n];i[3]=.3;const a=J4(r[2]-r[0],r[3]-r[1]),s=$4(a);__(a,a);const l=this.fontPx*1;L_(a,a,l/2);const u=$4(a);let c=Math.floor(s/u);s%u&&c++;const h=[r[0],r[1]];this.gl.uniform4fv(this.lineShader.uniforms.lineColor,i),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,e);for(let d=0;d<c-1;d++){if(d%2){h[0]+=a[0],h[1]+=a[1];continue}const v=[h[0],h[1],h[0]+a[0],h[1]+a[1]];this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,v),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),h[0]+=a[0],h[1]+=a[1]}this.gl.bindVertexArray(this.unusedVAO)}drawGraphLine(r,e=[1,0,0,.5],n=2){this.drawLine(r,n,e)}drawCrossLinesMM(r,e,n,i,a){if(r<0||this.screenSlices.length<=r)return;const s=this.screenSlices[r];let o=s.sliceFrac;o===1/0&&Q.debug("Rendering approximate cross lines in world view mode"),o===1/0&&(o=.5);let u=i.slice(),c=a.slice();const h=Math.max(1,this.opts.crosshairWidth);e===1&&(u=n.slice()),e===2&&(u=n.slice(),c=i.slice());function d(v){const m=J4(0,0);return m[0]=s.leftTopWidthHeight[0]+(v[0]-s.leftTopMM[0])/s.fovMM[0]*s.leftTopWidthHeight[2],m[1]=s.leftTopWidthHeight[1]+s.leftTopWidthHeight[3]-(v[1]-s.leftTopMM[1])/s.fovMM[1]*s.leftTopWidthHeight[3],m}if(u.length>0&&e===0){const v=o,m=1;for(let y=0;y<u.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=u[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([0,x,v]);A=Ar(A,[0,1,2]);let C=this.frac2mm([1,x,v]);C=Ar(C,[0,1,2]),A=d(A),C=d(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(u.length>0&&e===1){const v=o,m=2;for(let y=0;y<u.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=u[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([0,v,x]);A=Ar(A,[0,2,1]);let C=this.frac2mm([1,v,x]);C=Ar(C,[0,2,1]),A=d(A),C=d(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(u.length>0&&e===2){const v=o,m=2;for(let y=0;y<u.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=u[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([v,0,x]);A=Ar(A,[1,2,0]);let C=this.frac2mm([v,1,x]);C=Ar(C,[1,2,0]),A=d(A),C=d(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(c.length>0&&e===0){const v=o,m=0;for(let y=0;y<c.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=c[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([x,0,v]);A=Ar(A,[0,1,2]);let C=this.frac2mm([x,1,v]);C=Ar(C,[0,1,2]),A=d(A),C=d(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(c.length>0&&e===1){const v=o,m=0;for(let y=0;y<c.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=c[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([x,v,0]);A=Ar(A,[0,2,1]);let C=this.frac2mm([x,v,1]);C=Ar(C,[0,2,1]),A=d(A),C=d(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}if(c.length>0&&e===2){const v=o,m=1;for(let y=0;y<c.length;y++){const b=this.frac2mm([.5,.5,.5]);b[m]=c[y];let x=this.mm2frac(b);x=x[m];let A=this.frac2mm([v,x,0]);A=Ar(A,[1,2,0]);let C=this.frac2mm([v,x,1]);C=Ar(C,[1,2,0]),A=d(A),C=d(C),this.drawLine([A[0],A[1],C[0],C[1]],h)}}}drawCrossLines(r,e,n,i,a){if(r<0||this.screenSlices.length<=r)return;if(this.opts.isSliceMM)return this.drawCrossLinesMM(r,e,n,i,a);if(this.screenSlices[r].sliceFrac===1/0)return this.drawCrossLinesMM(r,e,n,i,a);const s=this.screenSlices[r];let o=i.slice(),l=a.slice();if(e===1&&(o=n.slice()),e===2&&(o=n.slice(),l=i.slice()),o.length>0){const u=s.leftTopWidthHeight.slice();let c=2;e===0&&(c=1);const h=this.frac2mm([.5,.5,.5]);for(let d=0;d<o.length;d++){h[c]=o[d];const v=this.mm2frac(h);this.drawRect([u[0],u[1]+u[3]-v[c]*u[3],u[2],1])}}if(l.length>0){const u=s.leftTopWidthHeight.slice(),c=s.fovMM[0]<0;let h=0;e===2&&(h=1);const d=this.frac2mm([.5,.5,.5]);for(let v=0;v<l.length;v++){d[h]=l[v];const m=this.mm2frac(d);c?this.drawRect([u[0]+(u[2]-m[h]*u[2]),u[1],1,u[3]]):this.drawRect([u[0]+m[h]*u[2],u[1],1,u[3]])}}}drawMosaic(r){this.screenSlices=[];const e=this.screenFieldOfViewMM(0,!0),n=this.screenFieldOfViewMM(0);r=r.replaceAll(";"," ;").trim();const i=[],a=[],s=[],o=r.split(/\s+/);let l=1;const u=this.fontPx;let c=0,h=0,d=0;this.volumes[0]?.dims||(d=Math.ceil(this.opts.tileMargin*.3));for(let v=0;v<2;v++){let m=!1,y=!1;m=!1;let b=0,x=0,A=0,C=0,E=!1,S=0,T=0,R=0,D=0;for(let I=0;I<o.length;I++){const P=o[I];if(P.includes("X")){y=!0;continue}if(P.includes("L")){E=!P.includes("-");continue}if(P.includes("H")){I++,T=Math.max(0,Math.min(1,parseFloat(o[I]))),T=Math.abs(T);continue}if(P.includes("V")){I++;continue}if(P.includes("A")){S=0;continue}if(P.includes("C")){S=1;continue}if(P.includes("S")){S=2;continue}if(P.includes("R")){m=!0;continue}if(P.includes(";")){A+=b,C=Math.max(C,x+R),b=0,x=0,R=0;continue}D=R,T>0&&!m&&(D=Math.round(D*(1-T))),Q.debug(`item ${I} width with overlap ${D} pixels`),x+=D,D=0;const F=parseFloat(P);if(isNaN(F))continue;let O=0,U=n;if(m&&(U=e),S===2?D=U[1]:D=U[0],S===0?O=U[1]:O=U[2],v===0)m||(S===0&&i.push(F),S===1&&a.push(F),S===2&&s.push(F));else{const L=[c+l*x,h+l*A,l*D,l*O];if(this.fontPx=E?u:0,m){let V=F<0?-1/0:1/0;Object.is(F,-0)&&(V=-1/0),this.draw2D(L,S,V)}else this.draw2D(L,S,F);y&&this.drawCrossLines(this.screenSlices.length-1,S,i,a,s),m=!1,y=!1}R=D,x+=d,b=Math.max(b,O)}if(A+=b,C=Math.max(C,x+R),C<=0||A<=0)break;const B=(this.gl.canvas.width-2*this.opts.tileMargin-d)/C,N=(this.effectiveCanvasHeight()-2*this.opts.tileMargin)/A;l=Math.min(B,N),this.opts.centerMosaic?(c=Math.floor(.5*(this.gl.canvas.width-C*l)),h=Math.floor(.5*(this.effectiveCanvasHeight()-A*l))):(c=this.opts.tileMargin,h=this.opts.tileMargin)}this.fontPx=u}calculateWidthHeight(r,e,n,i){let a,s;switch(r){case 0:a=e[0],s=e[1];break;case 1:a=e[0],s=e[2];break;case 2:a=e[1],s=e[2];break;default:return[n,i]}const o=a/s,l=n/i;let u,c;return o>l?(u=n,c=n/o):(c=i,u=i*o),[u,c]}drawSceneCore(){if(!this.initialized)return;if(this.colorbarHeight=0,this.gl.clearColor(this.opts.backColor[0],this.opts.backColor[1],this.opts.backColor[2],this.opts.backColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.bmpTexture&&this.thumbnailVisible){this.drawThumbnail();return}let r="";if(this.volumes.length===0||typeof this.volumes[0].dims>"u"){if(this.meshes.length>0){if(this.sliceMosaicString.length>0){this.opts.isColorbar&&this.reserveColorbarPanel(),this.drawMosaic(this.sliceMosaicString),this.opts.isColorbar&&this.drawColorbar();return}this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.drawLoadingText(this.opts.loadingText);return}if(this.uiData.isDragging&&this.scene.clipPlaneDepthAziElev[0]<1.8&&this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0){const a=this.uiData.dragStart[0]-this.uiData.dragEnd[0],s=this.uiData.dragStart[1]-this.uiData.dragEnd[1],o=this.uiData.dragClipPlaneStartDepthAziElev.slice();if(o[1]-=a,o[1]=o[1]%360,o[2]+=s,o[1]!==this.scene.clipPlaneDepthAziElev[1]||o[2]!==this.scene.clipPlaneDepthAziElev[2])return this.scene.clipPlaneDepthAziElev=o,this.setClipPlane(this.scene.clipPlaneDepthAziElev)}if(this.sliceMosaicString.length<1&&this.opts.sliceType===4){this.opts.isColorbar&&this.reserveColorbarPanel(),this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.opts.isColorbar&&this.reserveColorbarPanel();const e=this.getMaxVols(),n=this.opts.sliceType===3&&e>1&&this.graph.autoSizeMultiplanar&&this.graph.opacity>0;if(this.sliceMosaicString.length>0)this.drawMosaic(this.sliceMosaicString);else{const a=[0,0];let s=!1;if(this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.screenSlices=[],this.customLayout&&this.customLayout.length>0){this.screenSlices=[],this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);const{volScale:o}=this.sliceScale(),l=[this.effectiveCanvasWidth(),this.effectiveCanvasHeight()];for(const u of this.customLayout){const{sliceType:c,position:h,sliceMM:d}=u,v=h.slice();if(h[0]>=0&&h[0]<=1&&h[2]<=1&&(v[0]=h[0]*l[0],v[2]=h[2]*l[0]),h[1]>=0&&h[1]<=1&&h[3]<=1&&(v[1]=h[1]*l[1],v[3]=h[3]*l[1]),v[0]+v[2]>l[0]&&(Q.warn("adjusting slice width because it would have been clipped"),v[2]=l[0]-v[0]),v[1]+v[3]>l[1]&&(Q.warn("adjusting slice height because it would have been clipped"),v[3]=l[1]-v[1]),c===4)this.draw3D(v);else if(c===0||c===1||c===2){const m=this.calculateWidthHeight(c,o,v[2],v[3]);this.draw2D(v,c,d??NaN,m)}}}else if(this.opts.sliceType===0)this.draw2D([0,0,0,0],0);else if(this.opts.sliceType===1)this.draw2D([0,0,0,0],1);else if(this.opts.sliceType===2)this.draw2D([0,0,0,0],2);else{let o=function(L,V){return[(L-1)*d+L*v,(V-1)*d+V*v]},l=!1;this.opts.multiplanarForceRender?(l=!0,this.opts.multiplanarForceRender?this.opts.multiplanarShowRender=1:this.opts.multiplanarShowRender=2,delete this.opts.multiplanarForceRender):this.opts.multiplanarShowRender===1&&(l=!0);const u=isFinite(this.drawPenLocation[0])&&this.opts.drawingEnabled,{volScale:c}=this.sliceScale(),h=c.slice();this.opts.multiplanarEqualSize&&(c[0]=1,c[1]=1,c[2]=1),typeof this.opts.multiplanarPadPixels!="number"&&Q.debug("multiplanarPadPixels must be numeric");const d=parseFloat(`${this.opts.multiplanarPadPixels}`)*this.uiData.dpr;let v=this.opts.tileMargin*this.uiData.dpr;v<0&&(v=2*(2+Math.ceil(this.fontPx)));let m=[this.effectiveCanvasWidth(),this.effectiveCanvasHeight()];this.opts.heroImageFraction>0&&this.opts.heroImageFraction<1&&(l=!1,s=!0,m[0]>m[1]&&this.opts.multiplanarLayout!==3?a[0]=m[0]*this.opts.heroImageFraction:a[1]=m[1]*this.opts.heroImageFraction,m=[m[0]-a[0],m[1]-a[1]]);const y=this.scaleSlice(c[0]+c[1],c[1]+c[2],o(2,2),m),b=Math.max(Math.max(c[1],c[2]),c[0]),x=this.scaleSlice(c[0]+c[0]+c[1],Math.max(c[1],c[2]),o(3,1),m),A=this.scaleSlice(c[0]+c[0]+c[1]+b,Math.max(c[1],c[2]),o(4,1),m),C=this.scaleSlice(b,c[1]+c[2]+c[2],o(1,3),m),E=this.scaleSlice(b,c[1]+c[2]+c[2]+b,o(1,4),m);let S=!u&&(e<2||!n),T=!1,R=!1,D=!1;this.opts.multiplanarLayout===1?T=!0:this.opts.multiplanarLayout===2?R=!0:this.opts.multiplanarLayout===3?D=!0:C[4]>x[4]&&C[4]>y[4]?T=!0:x[4]>y[4]?D=!0:R=!0;let B=y;if(T?(B=C,!s&&(l||this.opts.multiplanarShowRender===2&&E[4]>=C[4])?B=E:S=!1):D&&(B=x,!s&&(l||this.opts.multiplanarShowRender===2&&A[4]>=x[4])?B=A:S=!1),s){const L=a[0]===0?this.effectiveCanvasWidth():a[0],V=a[1]===0?this.effectiveCanvasHeight():a[1];if(this.opts?.heroSliceType===0||this.opts?.heroSliceType===1||this.opts?.heroSliceType===2)this.draw2D([0,0,L,V],this.opts.heroSliceType,NaN,[1/0,1/0]);else{const _=B.slice(),G=this.effectiveCanvasWidth();L===G&&(_[0]=0),this.draw3D([_[0],0,L,V])}B[0]+=a[0],B[1]+=a[1],S=!1}const N=c[0]*B[4]+v,I=c[1]*B[4]+v,P=c[2]*B[4]+v,F=h[0]*B[4],O=h[1]*B[4],U=h[2]*B[4];if(T){if(this.draw2D([B[0],B[1],N,I],0,NaN,[F,O]),this.draw2D([B[0],B[1]+I+d,N,P],1,NaN,[F,U]),this.draw2D([B[0],B[1]+I+d+P+d,I,P],2,NaN,[O,U]),S){const L=b*B[4];this.draw3D([B[0],B[1]+I+P+P+d*3,L,L])}}else if(D){if(this.draw2D([B[0],B[1],N,I],0,NaN,[F,O]),this.draw2D([B[0]+N+d,B[1],N,P],1,NaN,[F,U]),this.draw2D([B[0]+N+N+d*2,B[1],I,P],2,NaN,[O,U]),S){const L=b*B[4];this.draw3D([B[0]+N+N+I+d*3,B[1],L,L])}}else R&&(l||(S=!1),this.opts.multiplanarShowRender===2&&(S=!0),s&&(S=!1),this.draw2D([B[0],B[1]+P+d,N,I],0,NaN,[F,O]),this.draw2D([B[0],B[1],N,P],1,NaN,[F,U]),this.draw2D([B[0]+N+d,B[1],I,P],2,NaN,[O,U]),S&&this.draw3D([B[0]+N+d,B[1]+P+d,I,I]))}}if(this.opts.isRuler&&this.drawRuler(),this.opts.isColorbar&&this.drawColorbar(),n&&this.drawGraph(),this.uiData.isDragging){if(this.uiData.mouseButtonCenterDown){this.dragForCenterButton([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.getCurrentDragMode()===4){this.dragForSlicer3D([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.getCurrentDragMode()===3){this.dragForPanZoom([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0)return;this.getCurrentDragMode()===2&&this.drawMeasurementTool([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]),this.getCurrentDragMode()===7&&this.drawAngleMeasurementTool();const a=this.getCurrentDragMode();if(a===1||a===6){const s=Math.abs(this.uiData.dragStart[0]-this.uiData.dragEnd[0]),o=Math.abs(this.uiData.dragStart[1]-this.uiData.dragEnd[1]);this.drawSelectionBox([Math.min(this.uiData.dragStart[0],this.uiData.dragEnd[0]),Math.min(this.uiData.dragStart[1],this.uiData.dragEnd[1]),s,o])}}for(const a of this.document.completedMeasurements)if(this.shouldDrawOnCurrentSlice(a.sliceIndex,a.sliceType,a.slicePosition)){const s=this.mm2frac(a.startMM),o=this.mm2frac(a.endMM),l=this.frac2canvasPosWithTile(s,a.sliceType),u=this.frac2canvasPosWithTile(o,a.sliceType);l&&u&&l.tileIndex===u.tileIndex&&this.drawMeasurementTool([l.pos[0],l.pos[1],u.pos[0],u.pos[1]])}for(let a=0;a<this.document.completedAngles.length;a++){const s=this.document.completedAngles[a];if(this.shouldDrawOnCurrentSlice(s.sliceIndex,s.sliceType,s.slicePosition)){const l=this.mm2frac(s.firstLineMM.start),u=this.mm2frac(s.firstLineMM.end),c=this.mm2frac(s.secondLineMM.start),h=this.mm2frac(s.secondLineMM.end),d=this.frac2canvasPosWithTile(l,s.sliceType),v=this.frac2canvasPosWithTile(u,s.sliceType),m=this.frac2canvasPosWithTile(c,s.sliceType),y=this.frac2canvasPosWithTile(h,s.sliceType);if(d&&v&&m&&y&&d.tileIndex===v.tileIndex&&d.tileIndex===m.tileIndex&&d.tileIndex===y.tileIndex){this.drawMeasurementTool([d.pos[0],d.pos[1],v.pos[0],v.pos[1]],!1),this.drawMeasurementTool([m.pos[0],m.pos[1],y.pos[0],y.pos[1]],!1);const b={firstLine:[d.pos[0],d.pos[1],v.pos[0],v.pos[1]],secondLine:[m.pos[0],m.pos[1],y.pos[0],y.pos[1]],sliceIndex:s.sliceIndex,sliceType:s.sliceType,slicePosition:s.slicePosition};this.drawAngleTextForAngle(b)}}}const i=this.frac2mm([this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2]]);return r=i[0].toFixed(2)+"×"+i[1].toFixed(2)+"×"+i[2].toFixed(2),this.readyForSync=!0,this.sync(),this.drawAnchoredLabels(),r}drawScene(){if(this.isBusy){this.needsRefresh=!0;return}this.isBusy=!1,this.needsRefresh=!1;let r=this.drawSceneCore();return this._gl!==null&&this.gl.finish(),this.needsRefresh&&(r=this.drawScene()),r}get gl(){if(!this._gl)throw new Error("unable to get WebGL context. Maybe the browser doesn't support WebGL2.");return this._gl}set gl(r){this._gl=r}findDrawingBoundarySlices(r){if(!this.back||!this.back.dims||!this.drawBitmap)return null;const e={dimX:this.back.dims[1],dimY:this.back.dims[2],dimZ:this.back.dims[3]};return JG(r,this.drawBitmap,e)}interpolateMaskSlices(r,e,n={}){if(!this.back||!this.back.dims||!this.drawBitmap)throw new Error("Background image and drawing bitmap must be loaded");const i={dimX:this.back.dims[1],dimY:this.back.dims[2],dimZ:this.back.dims[3]},a=this.back.img,s=this.back.global_max;nY(this.drawBitmap,i,a,s,r,e,n,()=>this.refreshDrawing(!0))}};function gH(r){if(!r)return{x:0,y:0,z:0};let e=0;for(let i=0;i<r.length;i+=1)e=e*31+r.charCodeAt(i)>>>0;const n=i=>i%180-90;return{x:n(e),y:n(e>>3),z:n(e>>5)}}function cp(r,e,n){return Math.min(Math.max(r,e),n)}const vH={url:"https://niivue.github.io/niivue/images/mni152.nii.gz",name:"MNI152"};function by({focusKey:r,overlays:e}){const n=Ye.useRef(null),i=Ye.useRef(null);return Ye.useEffect(()=>{const a=n.current;if(!a)return()=>{};let s;try{s=new dH({loadingText:"Loading atlas…",show3Dcrosshair:!0,show3Dcursor:!0})}catch(l){return console.error("Failed to initialise NiiVue",l),()=>{}}i.current=s,s.attachToCanvas(a),s.setSliceType(s.sliceTypeAxial),s.opts.isColorbar=!0;const o=[vH,...e||[]].filter(l=>l&&l.url);return Promise.resolve(s.loadVolumes(o)).catch(l=>{console.error("Failed to load NIfTI volumes",l)}),()=>{if(i.current=null,s&&typeof s.destroy=="function")s.destroy();else if(s?.gl?.canvas)try{s.gl.canvas.width=0,s.gl.canvas.height=0}catch(l){console.error("Failed to tear down NiiVue canvas",l)}}},[e]),Ye.useEffect(()=>{const a=i.current;if(!a||!r)return;const{x:s,y:o,z:l}=gH(r),u=a.voxDims?.[0]??{x:1,y:1,z:1},c=cp(s,-u.x*90,u.x*90),h=cp(o,-u.y*90,u.y*90),d=cp(l,-u.z*90,u.z*90);typeof a.setCrosshairLocation=="function"&&a.setCrosshairLocation(c,h,d)},[r]),ie.jsx("canvas",{ref:n,className:"niivue-canvas","data-testid":"niivue-canvas"})}by.propTypes={focusKey:W.string,overlays:W.arrayOf(W.shape({url:W.string.isRequired,name:W.string}))};by.defaultProps={focusKey:null,overlays:void 0};function mH(r){return r==null||Number.isNaN(r)?"unknown":r<.2?"low":r<.5?"moderate":r<.75?"elevated":"high"}function pH(r){return r==null||Number.isNaN(r)?"n/a":`${Math.round(r*100)}%`}function Jc({value:r,label:e="Uncertainty"}){const n=mH(r);return ie.jsxs("span",{className:`uncertainty-badge uncertainty-${n}`,"data-testid":"uncertainty-badge",children:[ie.jsx("span",{className:"uncertainty-label",children:e}),ie.jsx("span",{className:"uncertainty-value",children:pH(r)})]})}Jc.propTypes={value:W.number,label:W.string};function yH(r){return r.trim()?r.split(/\n|,/).map(e=>e.trim()).filter(Boolean).map(e=>({name:e})):[]}function wy({onPredict:r,prediction:e,onExplain:n,explanation:i,defaultReceptors:a,onReceptorFocus:s}){const[o,l]=Ye.useState(a.join(", ")),[u,c]=Ye.useState(a[0]??""),[h,d]=Ye.useState("both"),[v,m]=Ye.useState(12);Ye.useEffect(()=>{a.length&&(l(a.join(", ")),c(A=>A||a[0]))},[a]);const y=Ye.useMemo(()=>yH(o),[o]),b=A=>{A.preventDefault(),y.length&&(r({receptors:y}),s&&y[0]&&s(y[0].name))},x=A=>{A.preventDefault(),u&&(n({receptor:u,direction:h,limit:Number(v)}),s&&s(u))};return ie.jsxs("section",{className:"panel","data-testid":"effect-workbench",children:[ie.jsxs("header",{children:[ie.jsx("h2",{children:"Receptor evidence & explanations"}),ie.jsx("p",{className:"panel-subtitle",children:"Generate provenance cards and inspect upstream/downstream edges for receptors of interest."})]}),ie.jsxs("form",{className:"form-grid",onSubmit:b,children:[ie.jsx("label",{htmlFor:"receptor-list",children:"Receptors"}),ie.jsx("textarea",{id:"receptor-list",rows:"2",value:o,onChange:A=>l(A.target.value),"data-testid":"receptor-input",placeholder:"DRD2, HTR1A, SLC6A4"}),ie.jsx("button",{type:"submit",className:"primary",disabled:e.status==="loading","data-testid":"predict-button",children:e.status==="loading"?"Scoring…":"Score receptor evidence"})]}),e.error&&ie.jsx("p",{className:"form-error",role:"alert",children:e.error.message}),e.data?.items?.length>0&&ie.jsx("div",{className:"provenance-grid","data-testid":"provenance-cards",children:e.data.items.map(A=>ie.jsxs("article",{className:"provenance-card",children:[ie.jsxs("header",{children:[ie.jsx("h3",{children:A.receptor}),ie.jsx(Jc,{value:A.uncertainty})]}),ie.jsxs("dl",{children:[ie.jsxs("div",{children:[ie.jsx("dt",{children:"Knowledge graph weight"}),ie.jsx("dd",{children:A.kg_weight.toFixed(2)})]}),ie.jsxs("div",{children:[ie.jsx("dt",{children:"Evidence score"}),ie.jsx("dd",{children:A.evidence.toFixed(2)})]}),ie.jsxs("div",{children:[ie.jsx("dt",{children:"Affinity"}),ie.jsx("dd",{children:A.affinity!=null?A.affinity.toFixed(2):"n/a"})]}),ie.jsxs("div",{children:[ie.jsx("dt",{children:"Expression"}),ie.jsx("dd",{children:A.expression!=null?A.expression.toFixed(2):"n/a"})]}),ie.jsxs("div",{children:[ie.jsx("dt",{children:"Sources"}),ie.jsx("dd",{children:A.evidence_sources.join(", ")||"—"})]})]})]},A.receptor))}),ie.jsxs("form",{className:"form-grid secondary",onSubmit:x,children:[ie.jsx("label",{htmlFor:"explain-target",children:"Explain receptor"}),ie.jsx("input",{id:"explain-target",value:u,onChange:A=>c(A.target.value),placeholder:"DRD2","data-testid":"explain-input"}),ie.jsx("label",{htmlFor:"direction",children:"Direction"}),ie.jsxs("select",{id:"direction",value:h,onChange:A=>d(A.target.value),"data-testid":"explain-direction",children:[ie.jsx("option",{value:"both",children:"Both"}),ie.jsx("option",{value:"upstream",children:"Upstream"}),ie.jsx("option",{value:"downstream",children:"Downstream"})]}),ie.jsx("label",{htmlFor:"edge-limit",children:"Edge limit"}),ie.jsx("input",{id:"edge-limit",type:"number",min:"1",max:"50",value:v,onChange:A=>m(A.target.value),"data-testid":"explain-limit"}),ie.jsx("button",{type:"submit",className:"primary",disabled:i.status==="loading","data-testid":"explain-button",children:i.status==="loading"?"Fetching…":"Explain receptor"})]}),i.error&&ie.jsx("p",{className:"form-error",role:"alert",children:i.error.message}),i.data?.edges?.length>0&&ie.jsx("div",{className:"explanation-list","data-testid":"explanation-list",children:i.data.edges.map(A=>ie.jsxs("article",{className:"explanation-card",children:[A.direction&&ie.jsx("p",{className:"edge-direction",children:A.direction}),ie.jsxs("header",{children:[ie.jsxs("h4",{children:[A.direction==="upstream"?"⬆️":"⬇️"," ",A.edge.subject," → ",A.edge.object]}),ie.jsx(Jc,{value:A.edge.uncertainty,label:"Edge uncertainty"})]}),ie.jsx("p",{className:"edge-meta",children:A.edge.predicate}),ie.jsxs("p",{className:"edge-context",children:[A.provenance.length," provenance items"]})]},`${A.edge.subject}-${A.edge.object}-${A.direction}`))})]})}wy.propTypes={onPredict:W.func.isRequired,prediction:W.shape({status:W.string,error:W.instanceOf(Error),data:W.shape({items:W.arrayOf(W.shape({receptor:W.string.isRequired,kg_weight:W.number.isRequired,evidence:W.number.isRequired,affinity:W.number,expression:W.number,evidence_sources:W.arrayOf(W.string),uncertainty:W.number}))})}).isRequired,onExplain:W.func.isRequired,explanation:W.shape({status:W.string,error:W.instanceOf(Error),data:W.shape({edges:W.arrayOf(W.shape({direction:W.string,edge:W.shape({subject:W.string,object:W.string,predicate:W.string,uncertainty:W.number})}))})}).isRequired,defaultReceptors:W.arrayOf(W.string),onReceptorFocus:W.func};wy.defaultProps={defaultReceptors:[],onReceptorFocus:void 0};function AH(r){return r.split(/\n|,/).map(e=>e.trim()).filter(Boolean)}function Cy({onAnalyse:r,status:e,error:n,items:i,suggestions:a}){const[s,o]=Ye.useState(a.join(", ")),l=u=>{u.preventDefault();const c=AH(s);c.length&&r({focus_nodes:c})};return ie.jsxs("section",{className:"panel","data-testid":"gap-dashboard",children:[ie.jsxs("header",{children:[ie.jsx("h2",{children:"Gap surfacing"}),ie.jsx("p",{className:"panel-subtitle",children:"Identify missing links amongst focus nodes to steer curation."})]}),ie.jsxs("form",{className:"form-grid",onSubmit:l,children:[ie.jsx("label",{htmlFor:"gap-focus",children:"Focus nodes"}),ie.jsx("textarea",{id:"gap-focus",rows:"2",value:s,onChange:u=>o(u.target.value),placeholder:"Node A, Node B","data-testid":"gap-input"}),ie.jsx("button",{type:"submit",className:"primary",disabled:e==="loading","data-testid":"gap-button",children:e==="loading"?"Analysing…":"Find gaps"})]}),n&&ie.jsx("p",{className:"form-error",role:"alert",children:n.message}),i.length>0&&ie.jsx("ul",{className:"gap-list","data-testid":"gap-results",children:i.map(u=>ie.jsxs("li",{children:[ie.jsxs("span",{className:"gap-pair",children:[u.subject," → ",u.object]}),ie.jsx("span",{className:"gap-reason",children:u.reason})]},`${u.subject}-${u.object}`))})]})}Cy.propTypes={onAnalyse:W.func.isRequired,status:W.string,error:W.instanceOf(Error),items:W.arrayOf(W.shape({subject:W.string.isRequired,object:W.string.isRequired,reason:W.string})),suggestions:W.arrayOf(W.string)};Cy.defaultProps={status:"idle",error:null,items:[],suggestions:[]};const xH=["agonist","antagonist","partial","inverse"];function VC(r){return`${Math.round(r*100)}%`}function Ey({effects:r,simulation:e,onSimulate:n,timeIndex:i,onTimeIndexChange:a}){const[s,o]=Ye.useState({}),[l,u]=Ye.useState("chronic"),[c,h]=Ye.useState(!1),[d,v]=Ye.useState(!1),[m,y]=Ye.useState(!1),[b,x]=Ye.useState(.5),[A,C]=Ye.useState(!0),[E,S]=Ye.useState(!1);Ye.useEffect(()=>{r?.length&&o(L=>{const V={...L};return r.forEach(_=>{V[_.receptor]||(V[_.receptor]={enabled:!0,occ:.5,mech:"agonist"})}),V})},[r]);const T=e.data?.details?.timepoints??[];e.data?.details?.trajectories;const R=e.data?.details?.receptor_context??{},D=e.data?.details?.modules??{},B=e.data?.behavioral_tags??{},N=T[i]??T[T.length-1]??0,I=Ye.useMemo(()=>!D||!N?[]:Object.entries(D).map(([L,V])=>{const _=V.timeline?.[i]??V.score??0;return{key:L,description:V.description??L,score:Number(_)||0}}),[D,i,N]),P=L=>{o(V=>({...V,[L]:{...V[L],enabled:!V[L].enabled}}))},F=(L,V,_)=>{const G=V==="occ"?Number(_):_;o(K=>({...K,[L]:{...K[L],[V]:G}}))},O=L=>{L.preventDefault();const V={};Object.entries(s).forEach(([_,G])=>{G.enabled&&(V[_]={occ:Number(G.occ),mech:G.mech})}),Object.keys(V).length&&n({receptors:V,dosing:l,acute_1a:c,adhd:d,gut_bias:m,pvt_weight:Number(b),assumptions:{trkB_facilitation:!!A,alpha2a_hcn_closure:!!E}})},U=Object.values(s).filter(L=>L.enabled).length;return ie.jsxs("section",{className:"panel","data-testid":"simulation-panel",children:[ie.jsxs("header",{children:[ie.jsx("h2",{children:"Simulation cockpit"}),ie.jsx("p",{className:"panel-subtitle",children:"Configure receptor engagements and run the simulation engine with time slider playback."})]}),ie.jsxs("form",{className:"simulation-grid",onSubmit:O,children:[ie.jsxs("div",{className:"receptor-table","data-testid":"simulation-receptors",children:[ie.jsxs("header",{children:[ie.jsx("h3",{children:"Receptors"}),ie.jsxs("span",{className:"receptor-count",children:[U," selected"]})]}),ie.jsx("div",{className:"receptor-rows",children:r?.length?r.map(L=>{const V=s[L.receptor];return V?ie.jsxs("div",{className:"receptor-row",children:[ie.jsxs("label",{className:"toggle",children:[ie.jsx("input",{type:"checkbox",checked:V.enabled,onChange:()=>P(L.receptor)}),ie.jsx("span",{children:L.receptor})]}),ie.jsxs("div",{className:"receptor-controls",children:[ie.jsxs("label",{children:["Occupancy",ie.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:V.occ,onChange:_=>F(L.receptor,"occ",_.target.value),"data-testid":`occupancy-${L.receptor}`}),ie.jsx("span",{className:"slider-value",children:VC(V.occ)})]}),ie.jsxs("label",{children:["Mechanism",ie.jsx("select",{value:V.mech,onChange:_=>F(L.receptor,"mech",_.target.value),"data-testid":`mechanism-${L.receptor}`,children:xH.map(_=>ie.jsx("option",{value:_,children:_},_))})]}),ie.jsx(Jc,{value:R[L.receptor]?.uncertainty})]})]},L.receptor):null}):ie.jsx("p",{className:"empty",children:"Run receptor scoring to populate simulation inputs."})})]}),ie.jsxs("div",{className:"simulation-controls",children:[ie.jsxs("label",{className:"toggle",children:[ie.jsx("input",{type:"checkbox",checked:c,onChange:L=>h(L.target.checked)}),ie.jsx("span",{children:"Acute 5-HT1A clamp"})]}),ie.jsxs("label",{className:"toggle",children:[ie.jsx("input",{type:"checkbox",checked:d,onChange:L=>v(L.target.checked)}),ie.jsx("span",{children:"ADHD cohort"})]}),ie.jsxs("label",{className:"toggle",children:[ie.jsx("input",{type:"checkbox",checked:m,onChange:L=>y(L.target.checked)}),ie.jsx("span",{children:"Gut-brain bias"})]}),ie.jsxs("label",{className:"toggle",children:[ie.jsx("input",{type:"checkbox",checked:A,onChange:L=>C(L.target.checked)}),ie.jsx("span",{children:"Enable TrkB plasticity"})]}),ie.jsxs("label",{className:"toggle",children:[ie.jsx("input",{type:"checkbox",checked:E,onChange:L=>S(L.target.checked)}),ie.jsx("span",{children:"α2A HCN closure"})]}),ie.jsxs("label",{children:["Dosing regime",ie.jsxs("select",{value:l,onChange:L=>u(L.target.value),"data-testid":"dosing-select",children:[ie.jsx("option",{value:"chronic",children:"Chronic"}),ie.jsx("option",{value:"acute",children:"Acute"})]})]}),ie.jsxs("label",{children:["PVT weight",ie.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:b,onChange:L=>x(Number(L.target.value)),"data-testid":"pvt-weight"}),ie.jsx("span",{className:"slider-value",children:VC(b)})]}),ie.jsx("button",{type:"submit",className:"primary",disabled:e.status==="loading","data-testid":"simulate-button",children:e.status==="loading"?"Simulating…":"Run simulation"}),e.error&&ie.jsx("p",{className:"form-error",role:"alert",children:e.error.message})]})]}),T.length>0&&ie.jsxs("div",{className:"timeline","data-testid":"simulation-timeline",children:[ie.jsx("label",{htmlFor:"time-slider",children:"Time"}),ie.jsx("input",{id:"time-slider",type:"range",min:"0",max:T.length-1,value:i,onChange:L=>a(Number(L.target.value))}),ie.jsxs("span",{className:"timeline-value",children:[N.toFixed(2)," h"]})]}),e.data&&ie.jsxs("div",{className:"simulation-summary","data-testid":"simulation-summary",children:[ie.jsx("div",{className:"scoreboard",children:Object.entries(e.data.scores??{}).map(([L,V])=>ie.jsxs("div",{className:"score-item",children:[(()=>{const _=B[L],G=_?.label??L,K=_?.domain??_?.rdoc?.label,z=_?.rdoc?.id??_?.cogatlas?.id;return ie.jsxs(ie.Fragment,{children:[ie.jsx("span",{className:"metric",children:G}),K&&ie.jsx("span",{className:"metric-subtitle",children:K}),z&&ie.jsx("span",{className:"metric-code",children:z})]})})(),ie.jsx("span",{className:"value",children:V.toFixed(2)}),ie.jsx(Jc,{value:e.data.uncertainty?.[L]})]},L))}),ie.jsxs("div",{className:"module-table",children:[ie.jsx("h3",{children:"Module trajectories"}),ie.jsxs("table",{children:[ie.jsx("thead",{children:ie.jsxs("tr",{children:[ie.jsx("th",{children:"Module"}),ie.jsx("th",{children:"Score"})]})}),ie.jsx("tbody",{children:I.map(L=>ie.jsxs("tr",{children:[ie.jsx("td",{children:L.description}),ie.jsx("td",{children:L.score.toFixed(2)})]},L.key))})]})]})]})]})}Ey.propTypes={effects:W.arrayOf(W.shape({receptor:W.string.isRequired})),simulation:W.shape({status:W.string,error:W.instanceOf(Error),data:W.shape({scores:W.object,details:W.object,uncertainty:W.object,behavioral_tags:W.object})}).isRequired,onSimulate:W.func.isRequired,timeIndex:W.number,onTimeIndexChange:W.func.isRequired};Ey.defaultProps={effects:[],timeIndex:0};const bH=15e3;function wH(){return""}const CH=wH();async function EH(r,e=bH){if(!e)return r;let n;const i=new Promise((a,s)=>{n=setTimeout(()=>{s(new Error("Request timed out"))},e)});try{return await Promise.race([r,i])}finally{clearTimeout(n)}}async function SH(r,{method:e="POST",payload:n,headers:i={},timeout:a}={}){const s=r.startsWith("http")?r:`${CH}${r}`,o=await EH(fetch(s,{method:e,headers:{"Content-Type":"application/json",...i},body:e==="GET"?void 0:JSON.stringify(n??{}),credentials:"include"}),a),l=o.headers.get("content-type"),u=l&&l.includes("application/json"),c=u?await o.json():await o.text();if(!o.ok){const h=u&&c?.message?c.message:o.statusText||"Request failed",d=u&&c?.context?c.context:void 0,v=new Error(h||"Request failed");throw v.status=o.status,v.code=c?.code,d&&(v.context=d),v}return c}function TH(r,e,n={}){return SH(r,{...n,method:"POST",payload:e})}const bf={expand:"/graph/expand",predict:"/predict/effects",explain:"/explain",gaps:"/gaps",simulate:"/simulate"};function MH(r){return r?r instanceof Error?r:new Error(typeof r=="string"?r:"Request failed"):null}function wf(r){const[e,n]=Ye.useState(null),[i,a]=Ye.useState(null),[s,o]=Ye.useState("idle"),l=Ye.useCallback(async c=>{o("loading"),a(null);try{const h=await TH(r,c);return n(h),o("success"),h}catch(h){const d=MH(h);throw a(d),o("error"),d}},[r]),u=Ye.useCallback(()=>{o("idle"),a(null),n(null)},[]);return{data:e,error:i,status:s,execute:l,reset:u}}function DH(){return wf(bf.expand)}function RH(){return wf(bf.predict)}function BH(){return wf(bf.explain)}function IH(){return wf(bf.gaps)}function NH(){return wf(bf.simulate)}function FH(r){if(!r)return{nodes:[],links:[]};const e=r.nodes?.map(i=>({id:i.id,name:i.name||i.id,category:i.category,value:(i.attributes?.degree??1)+1}))??[],n=r.edges?.map((i,a)=>({id:`${i.subject}-${i.object}-${a}`,source:i.subject,target:i.object,label:i.predicate,confidence:i.confidence??.5,uncertainty:i.uncertainty??(i.confidence!=null?1-i.confidence:.5)}))??[];return{nodes:e,links:n}}function kH(r){if(!r)return[];const e=r.nodes?.map(i=>({data:{id:i.id,label:i.name||i.id,category:i.category}}))??[],n=r.edges?.map((i,a)=>({data:{id:`${i.subject}-${i.object}-${a}`,source:i.subject,target:i.object,label:i.predicate,confidence:i.confidence,uncertainty:i.uncertainty}}))??[];return[...e,...n]}function PH(r){return Ye.useMemo(()=>({nodes:r?.nodes??[],edges:r?.edges??[]}),[r])}function UH(){const r=DH(),e=RH(),n=BH(),i=IH(),a=NH(),[s,o]=Ye.useState(""),[l,u]=Ye.useState(""),[c,h]=Ye.useState(0),d=PH(r.data),v=Ye.useMemo(()=>kH(r.data),[r.data]),m=Ye.useMemo(()=>FH(r.data),[r.data]);Ye.useEffect(()=>{r.data?.centre&&(o(r.data.centre),u(r.data.centre))},[r.data]),Ye.useEffect(()=>{!s&&d.nodes.length&&o(d.nodes[0].id)},[d.nodes,s]),Ye.useEffect(()=>{a.data?.details?.timepoints?.length&&h(a.data.details.timepoints.length-1)},[a.data]);const y=Ye.useMemo(()=>d.nodes.slice(0,5).map(T=>T.id),[d.nodes]),b=Ye.useMemo(()=>e.data?.items?.length?e.data.items.map(T=>T.receptor):l?[l]:[],[e.data,l]),x=T=>{r.execute(T).catch(()=>{})},A=T=>{e.execute(T).catch(()=>{})},C=T=>{n.execute(T).catch(()=>{})},E=T=>{i.execute(T).catch(()=>{})},S=T=>{a.execute(T).catch(()=>{})};return ie.jsxs("div",{className:"app-shell",children:[ie.jsxs("header",{className:"app-header",children:[ie.jsx("h1",{children:"Neuropharm Simulation Lab"}),ie.jsx("p",{className:"tagline",children:"Top-down atlas overlays meet bottom-up receptor simulations."})]}),ie.jsxs("main",{className:"app-main",children:[ie.jsxs("section",{className:"left-column",children:[ie.jsx(o2,{onExpand:x,status:r.status,error:r.error,nodes:d.nodes,onSelectNode:T=>{o(T),u(T)}}),ie.jsx(wy,{onPredict:A,prediction:e,onExplain:C,explanation:n,defaultReceptors:b,onReceptorFocus:T=>u(T)}),ie.jsx(Cy,{onAnalyse:E,status:i.status,error:i.error,items:i.data?.items??[],suggestions:y}),ie.jsx(Ey,{effects:e.data?.items??[],simulation:a,onSimulate:S,timeIndex:c,onTimeIndexChange:h})]}),ie.jsx("section",{className:"right-column",children:ie.jsxs("div",{className:"atlas-stack",children:[ie.jsxs("div",{className:"atlas-panel",children:[ie.jsx("h2",{children:"Top-down atlas view"}),ie.jsx(by,{focusKey:l})]}),ie.jsxs("div",{className:"atlas-panel",children:[ie.jsx("h2",{children:"Knowledge graph (Cytoscape)"}),ie.jsx(F2,{elements:v,selectedId:s,onSelect:T=>{o(T),u(T)}})]}),ie.jsxs("div",{className:"atlas-panel",children:[ie.jsx("h2",{children:"Bottom-up force graph"}),ie.jsx(J2,{graph:m,onNodeSelect:T=>{o(T),u(T)}})]})]})})]})]})}GD.createRoot(document.getElementById("root")).render(ie.jsx(Ye.StrictMode,{children:ie.jsx(UH,{})}));
