# Blueprint alignment status

This note compares the current Neuropharm Simulation Lab stack with the "brain OS" blueprint so we can target the remaining investment. Each section lists the capabilities that already ship in this repo and the blueprint items that still need work.

## Summary matrix

| Area | Delivered today | Gaps to close |
| --- | --- | --- |
| **Knowledge graph & evidence** | Biolink-native nodes/edges with LinkML exports underpin the store, ingestion jobs cover ChEMBL, IUPHAR, BindingDB, PDSP Ki and INDRA statements with provenance, and the text-mining stack now rides spaCy 3.7/scispaCy 0.5.4 with an in-repo logistic evidence classifier that tags each edge with probability-weighted quality labels alongside heuristic scores.【F:backend/graph/models.py†L1-L148】【F:backend/graph/ingest_chembl.py†L1-L246】【F:backend/graph/ingest_pdsp.py†L1-L164】【F:backend/graph/ingest_indra.py†L1-L140】【F:backend/graph/evidence_quality.py†L1-L214】【F:backend/graph/evidence_classifier.py†L1-L139】【F:backend/pyproject.toml†L30-L45】 | Focus next on broader bibliometrics (e.g., citation networks, cohort metadata) and long-horizon evaluation runs so the classifier’s thresholds stay calibrated beyond the seed corpus.【F:docs/roadmap.md†L20-L45】 |
| **Literature search & gap surfacing** | Gap finding runs a RotatE-style embedding, wraps causal diagnostics, and fans out literature suggestions across OpenAlex and Semantic Scholar, which the UI renders with ranked tables and a heatmap. The GraphService now always instantiates the dual-provider aggregator and only falls back to a single OpenAlex client when aggregation fails, ensuring combined coverage by default.【F:backend/graph/gaps.py†L89-L171】【F:backend/graph/service.py†L233-L384】【F:backend/graph/literature.py†L1-L174】【F:frontend/src/components/GapDashboard.jsx†L1-L200】 | Collaboration tooling, richer prioritisation controls, and inline readers proposed in the blueprint are still to be implemented (tracked in Workstream 4).【F:docs/roadmap.md†L210-L250】 |
| **Simulation stack** | The SimulationEngine links PySB cascades, OSPSuite PBPK profiles, and TVB-style circuit dynamics with analytic fallbacks when optional dependencies are absent. Social-processing pathways now include μ-opioid bonding, oxytocin prosocial loops, basolateral amygdala cholinergic salience, and vasopressin threat gating with cockpit toggles and backend assumptions to match.【F:backend/simulation/molecular.py†L1-L200】【F:backend/simulation/pkpd.py†L1-L200】【F:backend/simulation/circuit.py†L1-L188】【F:backend/simulation/engine.py†L218-L502】【F:backend/engine/receptors.py†L240-L320】【F:backend/api/schemas.py†L400-L455】【F:frontend/src/components/SimulationPanel.jsx†L20-L310】【F:frontend/tests/simulation-panel.test.jsx†L1-L120】 | Remaining gaps focus on cross-scale calibration, cohort parameter sweeps, and packaging the high-fidelity toolchain/benchmarks from Workstream 3 for reproducible deployments.【F:docs/roadmap.md†L120-L185】 |
| **Atlas & geometry** | AtlasOverlayService now loads Harvard-Oxford, NeuroVault, Allen, Human Connectome Project, and Julich-Brain assets, normalises coordinates, and runs a geometry QA harness that flags missing metadata before surfacing overlays to the UI.【F:backend/atlas/__init__.py†L1-L220】【F:backend/atlas/assets/hcp_atlas_sample.json†L1-L120】【F:backend/atlas/assets/julich_atlas_sample.json†L1-L130】【F:backend/atlas/qa.py†L1-L80】【F:backend/graph/ingest_atlases.py†L1-L220】【F:backend/tests/test_atlas_geometry.py†L1-L120】【F:backend/tests/test_atlas_overlays.py†L1-L140】 | Next milestones include wiring the QA verdicts into cockpit visual alerts, broadening volumetric coverage for deep nuclei, and automating provenance refreshes across releases.【F:docs/roadmap.md†L70-L118】 |
| **API surface for agents** | The REST surface matches the blueprint (`/evidence/search`, `/graph/expand`, `/predict/effects`, `/simulate`, `/explain`, `/gaps`) and is wrapped by the `/assistant` capability catalogue for GPT-style clients.【F:backend/api/routes.py†L110-L420】 | None noted—the endpoints exist—but the blueprint’s call for more granular error telemetry now feeds into the observability workstream below. |
| **Causal reasoning** | The causal estimator integrates DoWhy/EconML when available and falls back to a bootstrap-scored difference-in-means summary, feeding counterfactuals into the gap finder and `/explain` routes.【F:backend/reasoning/causal.py†L1-L200】【F:backend/graph/service.py†L201-L232】 | Formal assumption graphs and dataset lineage checks should be expanded as part of the governance workstream so reviewers can audit causal runs.【F:docs/roadmap.md†L186-L209】 |
| **Operations & deployment** | Cloudflare Workers, Hugging Face Spaces, and Render recipes already exist in the deployment guide, and the backend now emits OpenTelemetry metrics while the governance registry exposes datasource checklists over the API for compliance dashboards.【F:docs/deployment-guide.md†L1-L170】【F:backend/graph/service.py†L60-L120】【F:backend/graph/governance.py†L1-L120】【F:backend/api/routes.py†L360-L430】【F:backend/tests/test_api_integration.py†L150-L240】 | Expand runbooks into automated alert routing and keep the governance registry synced with infrastructure secrets/retention reviews to satisfy blueprint guardrails.【F:docs/roadmap.md†L251-L310】 |

## Notable blueprint deltas

1. **Social-processing pathways.** μ-opioid bonding now chains into oxytocin, basolateral amygdala cholinergic, and vasopressin loops so `/simulate` exposes the blueprint’s social-affiliation, salience, and vigilance controls end-to-end in the cockpit.【F:backend/engine/receptors.py†L240-L320】【F:backend/simulation/engine.py†L218-L502】【F:frontend/src/components/SimulationPanel.jsx†L20-L310】 Remaining simulation deltas centre on calibrated cohort defaults and high-fidelity packaging (Workstream 3).
2. **Evidence quality signals.** Metadata-driven heuristics now normalise species, chronicity, design, and provenance into confidence scores, while the new logistic classifier enriches every edge with learned quality probabilities exposed through the API and simulation adapter.【F:backend/graph/evidence_quality.py†L1-L214】【F:backend/graph/evidence_classifier.py†L1-L139】【F:backend/api/schemas.py†L360-L455】 Next iterations will incorporate citation network statistics and periodic re-training jobs.
3. **Atlas breadth and QA.** Human Connectome Project and Julich-Brain overlays join the existing atlas catalogue, and the geometry QA harness flags coordinate or metadata gaps before assets reach the cockpit, bringing the “Google Maps for neuromodulation” vision much closer to reality.【F:backend/atlas/assets/hcp_atlas_sample.json†L1-L120】【F:backend/atlas/assets/julich_atlas_sample.json†L1-L130】【F:backend/atlas/qa.py†L1-L80】【F:backend/tests/test_atlas_geometry.py†L1-L120】 Work ahead: integrate QA status into UI affordances and widen deep nuclei coverage.
4. **Operational guardrails.** Governance metrics now capture datasource audits, OpenTelemetry metrics wrap evidence lookups and research-queue events, and the collaboration endpoints expose assignments, due dates, and checklists for curators.【F:backend/graph/governance.py†L1-L120】【F:backend/graph/service.py†L60-L120】【F:backend/graph/gap_state.py†L1-L220】【F:backend/tests/test_api_integration.py†L150-L240】 Remaining blueprint scope emphasises automated alert routing and compliance workflows beyond the baseline registry.

## Next steps

1. Deepen Workstream 1 evaluation: expand bibliometric enrichment (cohort metadata, citation graph features) and schedule classifier re-training so evidence probabilities stay trustworthy as new corpora land.【F:docs/roadmap.md†L20-L69】
2. Carry forward Workstream 3 by calibrating cohort defaults, benchmarking cross-scale social-behaviour outputs, and shipping the reproducible high-fidelity toolchain packages for heavy deployments.【F:docs/roadmap.md†L120-L185】
3. Surface atlas QA in the cockpit, broaden volumetric coverage for deep nuclei, and automate provenance refreshes so atlas expansion keeps pace with blueprint expectations (Workstream 2).【F:docs/roadmap.md†L70-L118】
4. Automate observability guardrails—alert routing, governance registry sync, and runbook publication—so the Workstream 4–5 scaffolding matures into operational practice.【F:docs/roadmap.md†L210-L310】

This alignment snapshot should make it easier to scope the remaining blueprint promises and plan incremental pull requests that burn down the gaps.
