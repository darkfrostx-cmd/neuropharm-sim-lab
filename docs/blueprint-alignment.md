# Blueprint alignment status

This note compares the current Neuropharm Simulation Lab stack with the "brain OS" blueprint so we can target the remaining investment. Each section lists the capabilities that already ship in this repo and the blueprint items that still need work.

## Summary matrix

| Area | Delivered today | Gaps to close |
| --- | --- | --- |
| **Knowledge graph & evidence** | Biolink-native nodes/edges with LinkML exports underpin the store, ingestion jobs cover ChEMBL, IUPHAR, BindingDB, PDSP Ki and INDRA statements with provenance, and metadata-aware quality scoring now weights species, chronicity, and study design for every edge.【F:backend/graph/models.py†L1-L148】【F:backend/graph/ingest_chembl.py†L1-L246】【F:backend/graph/ingest_pdsp.py†L1-L164】【F:backend/graph/ingest_indra.py†L1-L140】【F:backend/graph/evidence_quality.py†L1-L214】 | Next up is layering richer bibliometrics and ML reliability classifiers on top of the heuristics shipped here (Workstream 1), plus expanding the ingestion catalogue beyond the current receptor set.【F:docs/roadmap.md†L11-L29】 |
| **Literature search & gap surfacing** | Gap finding runs a RotatE-style embedding, wraps causal diagnostics, and fans out literature suggestions across OpenAlex and Semantic Scholar, which the UI renders with ranked tables and a heatmap.【F:backend/graph/gaps.py†L89-L171】【F:backend/graph/service.py†L24-L200】【F:backend/graph/literature.py†L1-L174】【F:frontend/src/components/GapDashboard.jsx†L1-L200】 | Collaboration tooling, richer prioritisation controls, and inline readers proposed in the blueprint are still to be implemented (tracked in Workstream 4).【F:docs/roadmap.md†L69-L88】 |
| **Simulation stack** | The SimulationEngine links PySB cascades, OSPSuite PBPK profiles, and TVB-style circuit dynamics with analytic fallbacks when optional dependencies are absent, exposing cockpit controls for the acute 5-HT1A clamp (mapped to the acute regimen), ADHD cohort, gut-brain bias, TrkB facilitation, α2A HCN closure, dosing mode, and the PVT weighting slider rendered in the UI.【F:backend/simulation/molecular.py†L1-L200】【F:backend/simulation/pkpd.py†L1-L200】【F:backend/simulation/circuit.py†L1-L188】【F:backend/simulation/engine.py†L121-L338】【F:backend/api/routes.py†L212-L332】【F:frontend/src/components/SimulationPanel.jsx†L12-L203】 | Additional blueprint modules (e.g., μ-opioid social bonding, adenosine A2A/D2 heteromer signalling, and α2C striatal gating) are not wired yet—the engine and UI still top out at the current clamp/cohort/bias toggles plus TrkB and α2A assumptions, dosing selection, and the PVT slider—so new receptor schemas and behavioural axes are required.【F:backend/simulation/engine.py†L180-L338】【F:frontend/src/components/SimulationPanel.jsx†L12-L203】 High-fidelity toolchain packaging and benchmarking also remain open items in Workstream 3.【F:docs/roadmap.md†L50-L68】 |
| **Atlas & geometry** | AtlasOverlayService stitches curated Harvard-Oxford, NeuroVault, Allen, and EBRAINS assets into the API, and the cockpit renders top-down NiiVue, Cytoscape, and force-graph panes for the Google-Maps-style navigation described in the blueprint.【F:backend/atlas/__init__.py†L1-L200】【F:frontend/src/App.jsx†L1-L170】 | Expanding to Human Connectome and Julich-Brain atlases, normalising coordinates, and adding automated QA remain future milestones.【F:docs/roadmap.md†L31-L48】 |
| **API surface for agents** | The REST surface matches the blueprint (`/evidence/search`, `/graph/expand`, `/predict/effects`, `/simulate`, `/explain`, `/gaps`) and is wrapped by the `/assistant` capability catalogue for GPT-style clients.【F:backend/api/routes.py†L110-L320】【F:backend/api/routes.py†L326-L420】 | None noted—the endpoints exist—but the blueprint’s call for more granular error telemetry ties into the observability workstream below. |
| **Causal reasoning** | The causal estimator integrates DoWhy/EconML when available and falls back to a bootstrap-scored difference-in-means summary, feeding counterfactuals into the gap finder and `/explain` routes.【F:backend/reasoning/causal.py†L1-L200】【F:backend/graph/service.py†L131-L200】 | Formal assumption graphs and dataset lineage checks should be expanded as part of the governance workstream so reviewers can audit causal runs.【F:docs/roadmap.md†L88-L110】 |
| **Operations & deployment** | Cloudflare Workers, Hugging Face Spaces, and Render recipes already exist in the deployment guide, covering the free-tier blueprint scenario.【F:docs/deployment-guide.md†L1-L104】 | Observability, automated alerts, and compliance reviews described in the blueprint are still outstanding (Workstream 5).【F:docs/roadmap.md†L88-L110】 |

## Notable blueprint deltas

1. **Behavioural module coverage.** The current simulator ships toggles for the acute 5-HT1A clamp (implemented by forcing the acute regimen), ADHD cohort framing, gut-brain bias, TrkB plasticity, α2A HCN closure, dosing mode, and the PVT weighting slider, so adding μ-opioid bonding, adenosine A2A/D2 heteromer, and α2C-specific pathways will require new receptor weight tables, behavioural axes, and cockpit controls beyond what exists today.【F:backend/simulation/engine.py†L180-L338】【F:backend/api/routes.py†L212-L332】【F:frontend/src/components/SimulationPanel.jsx†L12-L203】  Adding these will also demand fresh evidence ingestion (e.g., opioid receptor ligands) to feed the receptor adapter.
2. **Evidence quality metrics.** Metadata-driven heuristics now normalise species, chronicity, design, and provenance into confidence scores exposed via the API and simulation adapter, closing the blueprint gap for study-quality signals. The remaining Workstream 1 scope covers spaCy/scispaCy upgrades and classifier training for deeper reliability tags.【F:backend/graph/evidence_quality.py†L1-L214】【F:backend/api/schemas.py†L1-L220】【F:docs/roadmap.md†L11-L29】
3. **Atlas breadth and QA.** The curated atlas set leans on a handful of limbic and cortical regions. Scaling to the multi-atlas coverage in the blueprint means extending ingestion to HCP/Julich sources and building the visual regression harness referenced in Workstream 2.【F:backend/atlas/__init__.py†L22-L200】【F:docs/roadmap.md†L31-L48】
4. **Operational guardrails.** The blueprint’s emphasis on telemetry, governance, and collaboration workflows is not yet reflected in code. The roadmap enumerates these deliverables, but no OpenTelemetry hooks, alerting pipelines, or curator assignment features ship today.【F:docs/roadmap.md†L69-L110】

## Next steps

1. Finish Workstream 1 by layering the planned spaCy/scispaCy upgrades and classifier training on top of the new evidence quality heuristics so ingestion confidence aligns with the blueprint’s long-term uncertainty plumbing.【F:docs/roadmap.md†L11-L29】
2. Extend the simulation engine with the remaining neuromodulator modules (μ-opioid, A2A/D2 heteromer, α2C striatal loops) and expose matching controls in the cockpit to cover the social-behaviour focus areas called out in the blueprint.【F:backend/simulation/engine.py†L180-L333】【F:frontend/src/components/SimulationPanel.jsx†L12-L196】
3. Execute Workstream 2 by expanding atlas ingestion (HCP, Julich) and implementing the geometry QA harness so the “Google Maps for neuromodulation” view stays grounded in real coordinates.【F:backend/atlas/__init__.py†L22-L200】【F:docs/roadmap.md†L31-L48】
4. Deliver the observability and collaboration capabilities listed in Workstreams 4–5 to close the loop on curator workflows, telemetry, and governance before layering additional research features.【F:docs/roadmap.md†L69-L110】

This alignment snapshot should make it easier to scope the remaining blueprint promises and plan incremental pull requests that burn down the gaps.
